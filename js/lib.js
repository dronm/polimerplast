/*! jQuery v1.11.3 | (c) 2005, 2015 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l="1.11.3",m=function(a,b){return new m.fn.init(a,b)},n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,o=/^-ms-/,p=/-([\da-z])/gi,q=function(a,b){return b.toUpperCase()};m.fn=m.prototype={jquery:l,constructor:m,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=m.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return m.each(this,a,b)},map:function(a){return this.pushStack(m.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},m.extend=m.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||m.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(m.isPlainObject(c)||(b=m.isArray(c)))?(b?(b=!1,f=a&&m.isArray(a)?a:[]):f=a&&m.isPlainObject(a)?a:{},g[d]=m.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},m.extend({expando:"jQuery"+(l+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===m.type(a)},isArray:Array.isArray||function(a){return"array"===m.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!m.isArray(a)&&a-parseFloat(a)+1>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==m.type(a)||a.nodeType||m.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(k.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(b){b&&m.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(o,"ms-").replace(p,q)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=r(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(n,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(r(Object(a))?m.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=r(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(f=a[b],b=a,a=f),m.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||m.guid++,e):void 0},now:function(){return+new Date},support:k}),m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function r(a){var b="length"in a&&a.length,c=m.type(a);return"function"===c||m.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var s=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,aa=/[+~]/,ba=/'|\\/g,ca=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),da=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ea=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(fa){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(ba,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+ra(o[l]);w=aa.test(a)&&pa(b.parentNode)||b,x=o.join(",")}if(x)try{return H.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function pa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",ea,!1):e.attachEvent&&e.attachEvent("onunload",ea)),p=!f(g),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?la(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},g):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ca,da),a[3]=(a[3]||a[4]||a[5]||"").replace(ca,da),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ca,da).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(ca,da),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return W.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(ca,da).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:oa(function(){return[0]}),last:oa(function(a,b){return[b-1]}),eq:oa(function(a,b,c){return[0>c?c+b:c]}),even:oa(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:oa(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:oa(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:oa(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function qa(){}qa.prototype=d.filters=d.pseudos,d.setFilters=new qa,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function ra(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function sa(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function ta(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ua(a,b,c){for(var d=0,e=b.length;e>d;d++)ga(a,b[d],c);return c}function va(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function wa(a,b,c,d,e,f){return d&&!d[u]&&(d=wa(d)),e&&!e[u]&&(e=wa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ua(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:va(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=va(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=va(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function xa(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sa(function(a){return a===b},h,!0),l=sa(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[sa(ta(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return wa(i>1&&ta(m),i>1&&ra(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xa(a.slice(i,e)),f>e&&xa(a=a.slice(e)),f>e&&ra(a))}m.push(c)}return ta(m)}function ya(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=F.call(i));s=va(s)}H.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&ga.uniqueSort(i)}return k&&(w=v,j=t),r};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=xa(b[c]),f[u]?d.push(f):e.push(f);f=A(a,ya(e,d)),f.selector=a}return f},i=ga.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(ca,da),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(ca,da),aa.test(j[0].type)&&pa(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&ra(j),!a)return H.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,aa.test(a)&&pa(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);m.find=s,m.expr=s.selectors,m.expr[":"]=m.expr.pseudos,m.unique=s.uniqueSort,m.text=s.getText,m.isXMLDoc=s.isXML,m.contains=s.contains;var t=m.expr.match.needsContext,u=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,v=/^.[^:#\[\.,]*$/;function w(a,b,c){if(m.isFunction(b))return m.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return m.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(v.test(b))return m.filter(b,a,c);b=m.filter(b,a)}return m.grep(a,function(a){return m.inArray(a,b)>=0!==c})}m.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?m.find.matchesSelector(d,a)?[d]:[]:m.find.matches(a,m.grep(b,function(a){return 1===a.nodeType}))},m.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(m(a).filter(function(){for(b=0;e>b;b++)if(m.contains(d[b],this))return!0}));for(b=0;e>b;b++)m.find(a,d[b],c);return c=this.pushStack(e>1?m.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(w(this,a||[],!1))},not:function(a){return this.pushStack(w(this,a||[],!0))},is:function(a){return!!w(this,"string"==typeof a&&t.test(a)?m(a):a||[],!1).length}});var x,y=a.document,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=m.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||x).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof m?b[0]:b,m.merge(this,m.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:y,!0)),u.test(c[1])&&m.isPlainObject(b))for(c in b)m.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=y.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return x.find(a);this.length=1,this[0]=d}return this.context=y,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):m.isFunction(a)?"undefined"!=typeof x.ready?x.ready(a):a(m):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),m.makeArray(a,this))};A.prototype=m.fn,x=m(y);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};m.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!m(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),m.fn.extend({has:function(a){var b,c=m(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(m.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=t.test(a)||"string"!=typeof a?m(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&m.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?m.unique(f):f)},index:function(a){return a?"string"==typeof a?m.inArray(this[0],m(a)):m.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(m.unique(m.merge(this.get(),m(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}m.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return m.dir(a,"parentNode")},parentsUntil:function(a,b,c){return m.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return m.dir(a,"nextSibling")},prevAll:function(a){return m.dir(a,"previousSibling")},nextUntil:function(a,b,c){return m.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return m.dir(a,"previousSibling",c)},siblings:function(a){return m.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return m.sibling(a.firstChild)},contents:function(a){return m.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:m.merge([],a.childNodes)}},function(a,b){m.fn[a]=function(c,d){var e=m.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=m.filter(d,e)),this.length>1&&(C[a]||(e=m.unique(e)),B.test(a)&&(e=e.reverse())),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return m.each(a.match(E)||[],function(a,c){b[c]=!0}),b}m.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):m.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){m.each(b,function(b,c){var d=m.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&m.each(arguments,function(a,c){var d;while((d=m.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?m.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},m.extend({Deferred:function(a){var b=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return m.Deferred(function(c){m.each(b,function(b,f){var g=m.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&m.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?m.extend(a,d):d}},e={};return d.pipe=d.then,m.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&m.isFunction(a.promise)?e:0,g=1===f?a:m.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&m.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;m.fn.ready=function(a){return m.ready.promise().done(a),this},m.extend({isReady:!1,readyWait:1,holdReady:function(a){a?m.readyWait++:m.ready(!0)},ready:function(a){if(a===!0?!--m.readyWait:!m.isReady){if(!y.body)return setTimeout(m.ready);m.isReady=!0,a!==!0&&--m.readyWait>0||(H.resolveWith(y,[m]),m.fn.triggerHandler&&(m(y).triggerHandler("ready"),m(y).off("ready")))}}});function I(){y.addEventListener?(y.removeEventListener("DOMContentLoaded",J,!1),a.removeEventListener("load",J,!1)):(y.detachEvent("onreadystatechange",J),a.detachEvent("onload",J))}function J(){(y.addEventListener||"load"===event.type||"complete"===y.readyState)&&(I(),m.ready())}m.ready.promise=function(b){if(!H)if(H=m.Deferred(),"complete"===y.readyState)setTimeout(m.ready);else if(y.addEventListener)y.addEventListener("DOMContentLoaded",J,!1),a.addEventListener("load",J,!1);else{y.attachEvent("onreadystatechange",J),a.attachEvent("onload",J);var c=!1;try{c=null==a.frameElement&&y.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!m.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}I(),m.ready()}}()}return H.promise(b)};var K="undefined",L;for(L in m(k))break;k.ownLast="0"!==L,k.inlineBlockNeedsLayout=!1,m(function(){var a,b,c,d;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",k.inlineBlockNeedsLayout=a=3===b.offsetWidth,a&&(c.style.zoom=1)),c.removeChild(d))}),function(){var a=y.createElement("div");if(null==k.deleteExpando){k.deleteExpando=!0;try{delete a.test}catch(b){k.deleteExpando=!1}}a=null}(),m.acceptData=function(a){var b=m.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var M=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,N=/([A-Z])/g;function O(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(N,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:M.test(c)?m.parseJSON(c):c}catch(e){}m.data(a,b,c)}else c=void 0}return c}function P(a){var b;for(b in a)if(("data"!==b||!m.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;

return!0}function Q(a,b,d,e){if(m.acceptData(a)){var f,g,h=m.expando,i=a.nodeType,j=i?m.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b)return k||(k=i?a[h]=c.pop()||m.guid++:h),j[k]||(j[k]=i?{}:{toJSON:m.noop}),("object"==typeof b||"function"==typeof b)&&(e?j[k]=m.extend(j[k],b):j[k].data=m.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[m.camelCase(b)]=d),"string"==typeof b?(f=g[b],null==f&&(f=g[m.camelCase(b)])):f=g,f}}function R(a,b,c){if(m.acceptData(a)){var d,e,f=a.nodeType,g=f?m.cache:a,h=f?a[m.expando]:m.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){m.isArray(b)?b=b.concat(m.map(b,m.camelCase)):b in d?b=[b]:(b=m.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;while(e--)delete d[b[e]];if(c?!P(d):!m.isEmptyObject(d))return}(c||(delete g[h].data,P(g[h])))&&(f?m.cleanData([a],!0):k.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}m.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?m.cache[a[m.expando]]:a[m.expando],!!a&&!P(a)},data:function(a,b,c){return Q(a,b,c)},removeData:function(a,b){return R(a,b)},_data:function(a,b,c){return Q(a,b,c,!0)},_removeData:function(a,b){return R(a,b,!0)}}),m.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=m.data(f),1===f.nodeType&&!m._data(f,"parsedAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=m.camelCase(d.slice(5)),O(f,d,e[d])));m._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){m.data(this,a)}):arguments.length>1?this.each(function(){m.data(this,a,b)}):f?O(f,a,m.data(f,a)):void 0},removeData:function(a){return this.each(function(){m.removeData(this,a)})}}),m.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=m._data(a,b),c&&(!d||m.isArray(c)?d=m._data(a,b,m.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=m.queue(a,b),d=c.length,e=c.shift(),f=m._queueHooks(a,b),g=function(){m.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return m._data(a,c)||m._data(a,c,{empty:m.Callbacks("once memory").add(function(){m._removeData(a,b+"queue"),m._removeData(a,c)})})}}),m.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?m.queue(this[0],a):void 0===b?this:this.each(function(){var c=m.queue(this,a,b);m._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&m.dequeue(this,a)})},dequeue:function(a){return this.each(function(){m.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=m.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=m._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var S=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=["Top","Right","Bottom","Left"],U=function(a,b){return a=b||a,"none"===m.css(a,"display")||!m.contains(a.ownerDocument,a)},V=m.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===m.type(c)){e=!0;for(h in c)m.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,m.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(m(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},W=/^(?:checkbox|radio)$/i;!function(){var a=y.createElement("input"),b=y.createElement("div"),c=y.createDocumentFragment();if(b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",k.leadingWhitespace=3===b.firstChild.nodeType,k.tbody=!b.getElementsByTagName("tbody").length,k.htmlSerialize=!!b.getElementsByTagName("link").length,k.html5Clone="<:nav></:nav>"!==y.createElement("nav").cloneNode(!0).outerHTML,a.type="checkbox",a.checked=!0,c.appendChild(a),k.appendChecked=a.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,c.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,k.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){k.noCloneEvent=!1}),b.cloneNode(!0).click()),null==k.deleteExpando){k.deleteExpando=!0;try{delete b.test}catch(d){k.deleteExpando=!1}}}(),function(){var b,c,d=y.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(k[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),k[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var X=/^(?:input|select|textarea)$/i,Y=/^key/,Z=/^(?:mouse|pointer|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=/^([^.]*)(?:\.(.+)|)$/;function aa(){return!0}function ba(){return!1}function ca(){try{return y.activeElement}catch(a){}}m.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=m.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof m===K||a&&m.event.triggered===a.type?void 0:m.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(E)||[""],h=b.length;while(h--)f=_.exec(b[h])||[],o=q=f[1],p=(f[2]||"").split(".").sort(),o&&(j=m.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=m.event.special[o]||{},l=m.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&m.expr.match.needsContext.test(e),namespace:p.join(".")},i),(n=g[o])||(n=g[o]=[],n.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?n.splice(n.delegateCount++,0,l):n.push(l),m.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m.hasData(a)&&m._data(a);if(r&&(k=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=_.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=m.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,n=k[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=n.length;while(f--)g=n[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(n.splice(f,1),g.selector&&n.delegateCount--,l.remove&&l.remove.call(a,g));i&&!n.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||m.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)m.event.remove(a,o+b[j],c,d,!0);m.isEmptyObject(k)&&(delete r.handle,m._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,n,o=[d||y],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];if(h=l=d=d||y,3!==d.nodeType&&8!==d.nodeType&&!$.test(p+m.event.triggered)&&(p.indexOf(".")>=0&&(q=p.split("."),p=q.shift(),q.sort()),g=p.indexOf(":")<0&&"on"+p,b=b[m.expando]?b:new m.Event(p,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:m.makeArray(c,[b]),k=m.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!m.isWindow(d)){for(i=k.delegateType||p,$.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||y)&&o.push(l.defaultView||l.parentWindow||a)}n=0;while((h=o[n++])&&!b.isPropagationStopped())b.type=n>1?i:k.bindType||p,f=(m._data(h,"events")||{})[b.type]&&m._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&m.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&m.acceptData(d)&&g&&d[p]&&!m.isWindow(d)){l=d[g],l&&(d[g]=null),m.event.triggered=p;try{d[p]()}catch(r){}m.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=m.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(m._data(this,"events")||{})[a.type]||[],k=m.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=m.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((m.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?m(c,this).index(i)>=0:m.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[m.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=Z.test(e)?this.mouseHooks:Y.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new m.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||y),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||y,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ca()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===ca()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return m.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return m.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=m.extend(new m.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?m.event.trigger(e,null,b):m.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},m.removeEvent=y.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===K&&(a[d]=null),a.detachEvent(d,c))},m.Event=function(a,b){return this instanceof m.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?aa:ba):this.type=a,b&&m.extend(this,b),this.timeStamp=a&&a.timeStamp||m.now(),void(this[m.expando]=!0)):new m.Event(a,b)},m.Event.prototype={isDefaultPrevented:ba,isPropagationStopped:ba,isImmediatePropagationStopped:ba,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=aa,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=aa,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=aa,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){m.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!m.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.submitBubbles||(m.event.special.submit={setup:function(){return m.nodeName(this,"form")?!1:void m.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=m.nodeName(b,"input")||m.nodeName(b,"button")?b.form:void 0;c&&!m._data(c,"submitBubbles")&&(m.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),m._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&m.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return m.nodeName(this,"form")?!1:void m.event.remove(this,"._submit")}}),k.changeBubbles||(m.event.special.change={setup:function(){return X.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(m.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),m.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),m.event.simulate("change",this,a,!0)})),!1):void m.event.add(this,"beforeactivate._change",function(a){var b=a.target;X.test(b.nodeName)&&!m._data(b,"changeBubbles")&&(m.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||m.event.simulate("change",this.parentNode,a,!0)}),m._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return m.event.remove(this,"._change"),!X.test(this.nodeName)}}),k.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){m.event.simulate(b,a.target,m.event.fix(a),!0)};m.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=m._data(d,b);e||d.addEventListener(a,c,!0),m._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=m._data(d,b)-1;e?m._data(d,b,e):(d.removeEventListener(a,c,!0),m._removeData(d,b))}}}),m.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=ba;else if(!d)return this;return 1===e&&(g=d,d=function(a){return m().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=m.guid++)),this.each(function(){m.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,m(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=ba),this.each(function(){m.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){m.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?m.event.trigger(a,b,c,!0):void 0}});function da(a){var b=ea.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var ea="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",fa=/ jQuery\d+="(?:null|\d+)"/g,ga=new RegExp("<(?:"+ea+")[\\s/>]","i"),ha=/^\s+/,ia=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ja=/<([\w:]+)/,ka=/<tbody/i,la=/<|&#?\w+;/,ma=/<(?:script|style|link)/i,na=/checked\s*(?:[^=]|=\s*.checked.)/i,oa=/^$|\/(?:java|ecma)script/i,pa=/^true\/(.*)/,qa=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ra={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:k.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},sa=da(y),ta=sa.appendChild(y.createElement("div"));ra.optgroup=ra.option,ra.tbody=ra.tfoot=ra.colgroup=ra.caption=ra.thead,ra.th=ra.td;function ua(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==K?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==K?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||m.nodeName(d,b)?f.push(d):m.merge(f,ua(d,b));return void 0===b||b&&m.nodeName(a,b)?m.merge([a],f):f}function va(a){W.test(a.type)&&(a.defaultChecked=a.checked)}function wa(a,b){return m.nodeName(a,"table")&&m.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function xa(a){return a.type=(null!==m.find.attr(a,"type"))+"/"+a.type,a}function ya(a){var b=pa.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function za(a,b){for(var c,d=0;null!=(c=a[d]);d++)m._data(c,"globalEval",!b||m._data(b[d],"globalEval"))}function Aa(a,b){if(1===b.nodeType&&m.hasData(a)){var c,d,e,f=m._data(a),g=m._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)m.event.add(b,c,h[c][d])}g.data&&(g.data=m.extend({},g.data))}}function Ba(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!k.noCloneEvent&&b[m.expando]){e=m._data(b);for(d in e.events)m.removeEvent(b,d,e.handle);b.removeAttribute(m.expando)}"script"===c&&b.text!==a.text?(xa(b).text=a.text,ya(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),k.html5Clone&&a.innerHTML&&!m.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&W.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}m.extend({clone:function(a,b,c){var d,e,f,g,h,i=m.contains(a.ownerDocument,a);if(k.html5Clone||m.isXMLDoc(a)||!ga.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(ta.innerHTML=a.outerHTML,ta.removeChild(f=ta.firstChild)),!(k.noCloneEvent&&k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||m.isXMLDoc(a)))for(d=ua(f),h=ua(a),g=0;null!=(e=h[g]);++g)d[g]&&Ba(e,d[g]);if(b)if(c)for(h=h||ua(a),d=d||ua(f),g=0;null!=(e=h[g]);g++)Aa(e,d[g]);else Aa(a,f);return d=ua(f,"script"),d.length>0&&za(d,!i&&ua(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,l,n=a.length,o=da(b),p=[],q=0;n>q;q++)if(f=a[q],f||0===f)if("object"===m.type(f))m.merge(p,f.nodeType?[f]:f);else if(la.test(f)){h=h||o.appendChild(b.createElement("div")),i=(ja.exec(f)||["",""])[1].toLowerCase(),l=ra[i]||ra._default,h.innerHTML=l[1]+f.replace(ia,"<$1></$2>")+l[2],e=l[0];while(e--)h=h.lastChild;if(!k.leadingWhitespace&&ha.test(f)&&p.push(b.createTextNode(ha.exec(f)[0])),!k.tbody){f="table"!==i||ka.test(f)?"<table>"!==l[1]||ka.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)m.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j)}m.merge(p,h.childNodes),h.textContent="";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),k.appendChecked||m.grep(ua(p,"input"),va),q=0;while(f=p[q++])if((!d||-1===m.inArray(f,d))&&(g=m.contains(f.ownerDocument,f),h=ua(o.appendChild(f),"script"),g&&za(h),c)){e=0;while(f=h[e++])oa.test(f.type||"")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=m.expando,j=m.cache,l=k.deleteExpando,n=m.event.special;null!=(d=a[h]);h++)if((b||m.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)n[e]?m.event.remove(d,e):m.removeEvent(d,e,g.handle);j[f]&&(delete j[f],l?delete d[i]:typeof d.removeAttribute!==K?d.removeAttribute(i):d[i]=null,c.push(f))}}}),m.fn.extend({text:function(a){return V(this,function(a){return void 0===a?m.text(this):this.empty().append((this[0]&&this[0].ownerDocument||y).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wa(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wa(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?m.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||m.cleanData(ua(c)),c.parentNode&&(b&&m.contains(c.ownerDocument,c)&&za(ua(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&m.cleanData(ua(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&m.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return m.clone(this,a,b)})},html:function(a){return V(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(fa,""):void 0;if(!("string"!=typeof a||ma.test(a)||!k.htmlSerialize&&ga.test(a)||!k.leadingWhitespace&&ha.test(a)||ra[(ja.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(ia,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(m.cleanData(ua(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,m.cleanData(ua(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,n=this,o=l-1,p=a[0],q=m.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&na.test(p))return this.each(function(c){var d=n.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(i=m.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=m.map(ua(i,"script"),xa),f=g.length;l>j;j++)d=i,j!==o&&(d=m.clone(d,!0,!0),f&&m.merge(g,ua(d,"script"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,m.map(g,ya),j=0;f>j;j++)d=g[j],oa.test(d.type||"")&&!m._data(d,"globalEval")&&m.contains(h,d)&&(d.src?m._evalUrl&&m._evalUrl(d.src):m.globalEval((d.text||d.textContent||d.innerHTML||"").replace(qa,"")));i=c=null}return this}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){m.fn[a]=function(a){for(var c,d=0,e=[],g=m(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),m(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Ca,Da={};function Ea(b,c){var d,e=m(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:m.css(e[0],"display");return e.detach(),f}function Fa(a){var b=y,c=Da[a];return c||(c=Ea(a,b),"none"!==c&&c||(Ca=(Ca||m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(Ca[0].contentWindow||Ca[0].contentDocument).document,b.write(),b.close(),c=Ea(a,b),Ca.detach()),Da[a]=c),c}!function(){var a;k.shrinkWrapBlocks=function(){if(null!=a)return a;a=!1;var b,c,d;return c=y.getElementsByTagName("body")[0],c&&c.style?(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",b.appendChild(y.createElement("div")).style.width="5px",a=3!==b.offsetWidth),c.removeChild(d),a):void 0}}();var Ga=/^margin/,Ha=new RegExp("^("+S+")(?!px)[a-z%]+$","i"),Ia,Ja,Ka=/^(top|right|bottom|left)$/;a.getComputedStyle?(Ia=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)},Ja=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ia(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||m.contains(a.ownerDocument,a)||(g=m.style(a,b)),Ha.test(g)&&Ga.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):y.documentElement.currentStyle&&(Ia=function(a){return a.currentStyle},Ja=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ia(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Ha.test(g)&&!Ka.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"});function La(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h;if(b=y.createElement("div"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=d&&d.style){c.cssText="float:left;opacity:.5",k.opacity="0.5"===c.opacity,k.cssFloat=!!c.cssFloat,b.style.backgroundClip="content-box",b.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===b.style.backgroundClip,k.boxSizing=""===c.boxSizing||""===c.MozBoxSizing||""===c.WebkitBoxSizing,m.extend(k,{reliableHiddenOffsets:function(){return null==g&&i(),g},boxSizingReliable:function(){return null==f&&i(),f},pixelPosition:function(){return null==e&&i(),e},reliableMarginRight:function(){return null==h&&i(),h}});function i(){var b,c,d,i;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),b.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",e=f=!1,h=!0,a.getComputedStyle&&(e="1%"!==(a.getComputedStyle(b,null)||{}).top,f="4px"===(a.getComputedStyle(b,null)||{width:"4px"}).width,i=b.appendChild(y.createElement("div")),i.style.cssText=b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",b.style.width="1px",h=!parseFloat((a.getComputedStyle(i,null)||{}).marginRight),b.removeChild(i)),b.innerHTML="<table><tr><td></td><td>t</td></tr></table>",i=b.getElementsByTagName("td"),i[0].style.cssText="margin:0;border:0;padding:0;display:none",g=0===i[0].offsetHeight,g&&(i[0].style.display="",i[1].style.display="none",g=0===i[0].offsetHeight),c.removeChild(d))}}}(),m.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Ma=/alpha\([^)]*\)/i,Na=/opacity\s*=\s*([^)]*)/,Oa=/^(none|table(?!-c[ea]).+)/,Pa=new RegExp("^("+S+")(.*)$","i"),Qa=new RegExp("^([+-])=("+S+")","i"),Ra={position:"absolute",visibility:"hidden",display:"block"},Sa={letterSpacing:"0",fontWeight:"400"},Ta=["Webkit","O","Moz","ms"];function Ua(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ta.length;while(e--)if(b=Ta[e]+c,b in a)return b;return d}function Va(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=m._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&U(d)&&(f[g]=m._data(d,"olddisplay",Fa(d.nodeName)))):(e=U(d),(c&&"none"!==c||!e)&&m._data(d,"olddisplay",e?c:m.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Wa(a,b,c){var d=Pa.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Xa(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=m.css(a,c+T[f],!0,e)),d?("content"===c&&(g-=m.css(a,"padding"+T[f],!0,e)),"margin"!==c&&(g-=m.css(a,"border"+T[f]+"Width",!0,e))):(g+=m.css(a,"padding"+T[f],!0,e),"padding"!==c&&(g+=m.css(a,"border"+T[f]+"Width",!0,e)));return g}function Ya(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ia(a),g=k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Ja(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ha.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Xa(a,b,c||(g?"border":"content"),d,f)+"px"}m.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Ja(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":k.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=m.camelCase(b),i=a.style;if(b=m.cssProps[h]||(m.cssProps[h]=Ua(i,h)),g=m.cssHooks[b]||m.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=Qa.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(m.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||m.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=m.camelCase(b);return b=m.cssProps[h]||(m.cssProps[h]=Ua(a.style,h)),g=m.cssHooks[b]||m.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Ja(a,b,d)),"normal"===f&&b in Sa&&(f=Sa[b]),""===c||c?(e=parseFloat(f),c===!0||m.isNumeric(e)?e||0:f):f}}),m.each(["height","width"],function(a,b){m.cssHooks[b]={get:function(a,c,d){return c?Oa.test(m.css(a,"display"))&&0===a.offsetWidth?m.swap(a,Ra,function(){return Ya(a,b,d)}):Ya(a,b,d):void 0},set:function(a,c,d){var e=d&&Ia(a);return Wa(a,c,d?Xa(a,b,d,k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,e),e):0)}}}),k.opacity||(m.cssHooks.opacity={get:function(a,b){return Na.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=m.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===m.trim(f.replace(Ma,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Ma.test(f)?f.replace(Ma,e):f+" "+e)}}),m.cssHooks.marginRight=La(k.reliableMarginRight,function(a,b){return b?m.swap(a,{display:"inline-block"},Ja,[a,"marginRight"]):void 0}),m.each({margin:"",padding:"",border:"Width"},function(a,b){m.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+T[d]+b]=f[d]||f[d-2]||f[0];return e}},Ga.test(a)||(m.cssHooks[a+b].set=Wa)}),m.fn.extend({css:function(a,b){return V(this,function(a,b,c){var d,e,f={},g=0;if(m.isArray(b)){for(d=Ia(a),e=b.length;e>g;g++)f[b[g]]=m.css(a,b[g],!1,d);return f}return void 0!==c?m.style(a,b,c):m.css(a,b)},a,b,arguments.length>1)},show:function(){return Va(this,!0)},hide:function(){return Va(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){U(this)?m(this).show():m(this).hide()})}});function Za(a,b,c,d,e){
return new Za.prototype.init(a,b,c,d,e)}m.Tween=Za,Za.prototype={constructor:Za,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(m.cssNumber[c]?"":"px")},cur:function(){var a=Za.propHooks[this.prop];return a&&a.get?a.get(this):Za.propHooks._default.get(this)},run:function(a){var b,c=Za.propHooks[this.prop];return this.options.duration?this.pos=b=m.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Za.propHooks._default.set(this),this}},Za.prototype.init.prototype=Za.prototype,Za.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=m.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){m.fx.step[a.prop]?m.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[m.cssProps[a.prop]]||m.cssHooks[a.prop])?m.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Za.propHooks.scrollTop=Za.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},m.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},m.fx=Za.prototype.init,m.fx.step={};var $a,_a,ab=/^(?:toggle|show|hide)$/,bb=new RegExp("^(?:([+-])=|)("+S+")([a-z%]*)$","i"),cb=/queueHooks$/,db=[ib],eb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=bb.exec(b),f=e&&e[3]||(m.cssNumber[a]?"":"px"),g=(m.cssNumber[a]||"px"!==f&&+d)&&bb.exec(m.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,m.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function fb(){return setTimeout(function(){$a=void 0}),$a=m.now()}function gb(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=T[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function hb(a,b,c){for(var d,e=(eb[b]||[]).concat(eb["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function ib(a,b,c){var d,e,f,g,h,i,j,l,n=this,o={},p=a.style,q=a.nodeType&&U(a),r=m._data(a,"fxshow");c.queue||(h=m._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,n.always(function(){n.always(function(){h.unqueued--,m.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=m.css(a,"display"),l="none"===j?m._data(a,"olddisplay")||Fa(a.nodeName):j,"inline"===l&&"none"===m.css(a,"float")&&(k.inlineBlockNeedsLayout&&"inline"!==Fa(a.nodeName)?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",k.shrinkWrapBlocks()||n.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],ab.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){if("show"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||m.style(a,d)}else j=void 0;if(m.isEmptyObject(o))"inline"===("none"===j?Fa(a.nodeName):j)&&(p.display=j);else{r?"hidden"in r&&(q=r.hidden):r=m._data(a,"fxshow",{}),f&&(r.hidden=!q),q?m(a).show():n.done(function(){m(a).hide()}),n.done(function(){var b;m._removeData(a,"fxshow");for(b in o)m.style(a,b,o[b])});for(d in o)g=hb(q?r[d]:0,d,n),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function jb(a,b){var c,d,e,f,g;for(c in a)if(d=m.camelCase(c),e=b[d],f=a[c],m.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=m.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function kb(a,b,c){var d,e,f=0,g=db.length,h=m.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=$a||fb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:m.extend({},b),opts:m.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:$a||fb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=m.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(jb(k,j.opts.specialEasing);g>f;f++)if(d=db[f].call(j,a,k,j.opts))return d;return m.map(k,hb,j),m.isFunction(j.opts.start)&&j.opts.start.call(a,j),m.fx.timer(m.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}m.Animation=m.extend(kb,{tweener:function(a,b){m.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],eb[c]=eb[c]||[],eb[c].unshift(b)},prefilter:function(a,b){b?db.unshift(a):db.push(a)}}),m.speed=function(a,b,c){var d=a&&"object"==typeof a?m.extend({},a):{complete:c||!c&&b||m.isFunction(a)&&a,duration:a,easing:c&&b||b&&!m.isFunction(b)&&b};return d.duration=m.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in m.fx.speeds?m.fx.speeds[d.duration]:m.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){m.isFunction(d.old)&&d.old.call(this),d.queue&&m.dequeue(this,d.queue)},d},m.fn.extend({fadeTo:function(a,b,c,d){return this.filter(U).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=m.isEmptyObject(a),f=m.speed(b,c,d),g=function(){var b=kb(this,m.extend({},a),f);(e||m._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=m.timers,g=m._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&cb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&m.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=m._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=m.timers,g=d?d.length:0;for(c.finish=!0,m.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),m.each(["toggle","show","hide"],function(a,b){var c=m.fn[b];m.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(gb(b,!0),a,d,e)}}),m.each({slideDown:gb("show"),slideUp:gb("hide"),slideToggle:gb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){m.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),m.timers=[],m.fx.tick=function(){var a,b=m.timers,c=0;for($a=m.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||m.fx.stop(),$a=void 0},m.fx.timer=function(a){m.timers.push(a),a()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){_a||(_a=setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){clearInterval(_a),_a=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(a,b){return a=m.fx?m.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e;b=y.createElement("div"),b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=y.createElement("select"),e=c.appendChild(y.createElement("option")),a=b.getElementsByTagName("input")[0],d.style.cssText="top:1px",k.getSetAttribute="t"!==b.className,k.style=/top/.test(d.getAttribute("style")),k.hrefNormalized="/a"===d.getAttribute("href"),k.checkOn=!!a.value,k.optSelected=e.selected,k.enctype=!!y.createElement("form").enctype,c.disabled=!0,k.optDisabled=!e.disabled,a=y.createElement("input"),a.setAttribute("value",""),k.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),k.radioValue="t"===a.value}();var lb=/\r/g;m.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=m.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,m(this).val()):a,null==e?e="":"number"==typeof e?e+="":m.isArray(e)&&(e=m.map(e,function(a){return null==a?"":a+""})),b=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=m.valHooks[e.type]||m.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(lb,""):null==c?"":c)}}}),m.extend({valHooks:{option:{get:function(a){var b=m.find.attr(a,"value");return null!=b?b:m.trim(m.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&m.nodeName(c.parentNode,"optgroup"))){if(b=m(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=m.makeArray(b),g=e.length;while(g--)if(d=e[g],m.inArray(m.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),m.each(["radio","checkbox"],function(){m.valHooks[this]={set:function(a,b){return m.isArray(b)?a.checked=m.inArray(m(a).val(),b)>=0:void 0}},k.checkOn||(m.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var mb,nb,ob=m.expr.attrHandle,pb=/^(?:checked|selected)$/i,qb=k.getSetAttribute,rb=k.input;m.fn.extend({attr:function(a,b){return V(this,m.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){m.removeAttr(this,a)})}}),m.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===K?m.prop(a,b,c):(1===f&&m.isXMLDoc(a)||(b=b.toLowerCase(),d=m.attrHooks[b]||(m.expr.match.bool.test(b)?nb:mb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=m.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void m.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=m.propFix[c]||c,m.expr.match.bool.test(c)?rb&&qb||!pb.test(c)?a[d]=!1:a[m.camelCase("default-"+c)]=a[d]=!1:m.attr(a,c,""),a.removeAttribute(qb?c:d)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&m.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),nb={set:function(a,b,c){return b===!1?m.removeAttr(a,c):rb&&qb||!pb.test(c)?a.setAttribute(!qb&&m.propFix[c]||c,c):a[m.camelCase("default-"+c)]=a[c]=!0,c}},m.each(m.expr.match.bool.source.match(/\w+/g),function(a,b){var c=ob[b]||m.find.attr;ob[b]=rb&&qb||!pb.test(b)?function(a,b,d){var e,f;return d||(f=ob[b],ob[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,ob[b]=f),e}:function(a,b,c){return c?void 0:a[m.camelCase("default-"+b)]?b.toLowerCase():null}}),rb&&qb||(m.attrHooks.value={set:function(a,b,c){return m.nodeName(a,"input")?void(a.defaultValue=b):mb&&mb.set(a,b,c)}}),qb||(mb={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},ob.id=ob.name=ob.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},m.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:mb.set},m.attrHooks.contenteditable={set:function(a,b,c){mb.set(a,""===b?!1:b,c)}},m.each(["width","height"],function(a,b){m.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),k.style||(m.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var sb=/^(?:input|select|textarea|button|object)$/i,tb=/^(?:a|area)$/i;m.fn.extend({prop:function(a,b){return V(this,m.prop,a,b,arguments.length>1)},removeProp:function(a){return a=m.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),m.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!m.isXMLDoc(a),f&&(b=m.propFix[b]||b,e=m.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=m.find.attr(a,"tabindex");return b?parseInt(b,10):sb.test(a.nodeName)||tb.test(a.nodeName)&&a.href?0:-1}}}}),k.hrefNormalized||m.each(["href","src"],function(a,b){m.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),k.optSelected||(m.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){m.propFix[this.toLowerCase()]=this}),k.enctype||(m.propFix.enctype="encoding");var ub=/[\t\r\n\f]/g;m.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ub," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=m.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ub," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?m.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(m.isFunction(a)?function(c){m(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=m(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===K||"boolean"===c)&&(this.className&&m._data(this,"__className__",this.className),this.className=this.className||a===!1?"":m._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ub," ").indexOf(b)>=0)return!0;return!1}}),m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){m.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),m.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var vb=m.now(),wb=/\?/,xb=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;m.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=m.trim(b+"");return e&&!m.trim(e.replace(xb,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():m.error("Invalid JSON: "+b)},m.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+b),c};var yb,zb,Ab=/#.*$/,Bb=/([?&])_=[^&]*/,Cb=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Db=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Eb=/^(?:GET|HEAD)$/,Fb=/^\/\//,Gb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Hb={},Ib={},Jb="*/".concat("*");try{zb=location.href}catch(Kb){zb=y.createElement("a"),zb.href="",zb=zb.href}yb=Gb.exec(zb.toLowerCase())||[];function Lb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(m.isFunction(c))while(d=f[e++])"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Mb(a,b,c,d){var e={},f=a===Ib;function g(h){var i;return e[h]=!0,m.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Nb(a,b){var c,d,e=m.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&m.extend(!0,a,c),a}function Ob(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Pb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zb,type:"GET",isLocal:Db.test(yb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Jb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Nb(Nb(a,m.ajaxSettings),b):Nb(m.ajaxSettings,a)},ajaxPrefilter:Lb(Hb),ajaxTransport:Lb(Ib),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=m.ajaxSetup({},b),l=k.context||k,n=k.context&&(l.nodeType||l.jquery)?m(l):m.event,o=m.Deferred(),p=m.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Cb.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||zb)+"").replace(Ab,"").replace(Fb,yb[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=m.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(c=Gb.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===yb[1]&&c[2]===yb[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(yb[3]||("http:"===yb[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=m.param(k.data,k.traditional)),Mb(Hb,k,b,v),2===t)return v;h=m.event&&k.global,h&&0===m.active++&&m.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Eb.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(wb.test(e)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=Bb.test(e)?e.replace(Bb,"$1_="+vb++):e+(wb.test(e)?"&":"?")+"_="+vb++)),k.ifModified&&(m.lastModified[e]&&v.setRequestHeader("If-Modified-Since",m.lastModified[e]),m.etag[e]&&v.setRequestHeader("If-None-Match",m.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Jb+"; q=0.01":""):k.accepts["*"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Mb(Ib,k,b,v)){v.readyState=1,h&&n.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Ob(k,v,c)),u=Pb(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(m.lastModified[e]=w),w=v.getResponseHeader("etag"),w&&(m.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&n.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(n.trigger("ajaxComplete",[v,k]),--m.active||m.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return m.get(a,b,c,"json")},getScript:function(a,b){return m.get(a,void 0,b,"script")}}),m.each(["get","post"],function(a,b){m[b]=function(a,c,d,e){return m.isFunction(c)&&(e=e||d,d=c,c=void 0),m.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),m._evalUrl=function(a){return m.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},m.fn.extend({wrapAll:function(a){if(m.isFunction(a))return this.each(function(b){m(this).wrapAll(a.call(this,b))});if(this[0]){var b=m(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(m.isFunction(a)?function(b){m(this).wrapInner(a.call(this,b))}:function(){var b=m(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=m.isFunction(a);return this.each(function(c){m(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)}).end()}}),m.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!k.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||m.css(a,"display"))},m.expr.filters.visible=function(a){return!m.expr.filters.hidden(a)};var Qb=/%20/g,Rb=/\[\]$/,Sb=/\r?\n/g,Tb=/^(?:submit|button|image|reset|file)$/i,Ub=/^(?:input|select|textarea|keygen)/i;function Vb(a,b,c,d){var e;if(m.isArray(b))m.each(b,function(b,e){c||Rb.test(a)?d(a,e):Vb(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==m.type(b))d(a,b);else for(e in b)Vb(a+"["+e+"]",b[e],c,d)}m.param=function(a,b){var c,d=[],e=function(a,b){b=m.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(a)||a.jquery&&!m.isPlainObject(a))m.each(a,function(){e(this.name,this.value)});else for(c in a)Vb(c,a[c],b,e);return d.join("&").replace(Qb,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=m.prop(this,"elements");return a?m.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!m(this).is(":disabled")&&Ub.test(this.nodeName)&&!Tb.test(a)&&(this.checked||!W.test(a))}).map(function(a,b){var c=m(this).val();return null==c?null:m.isArray(c)?m.map(c,function(a){return{name:b.name,value:a.replace(Sb,"\r\n")}}):{name:b.name,value:c.replace(Sb,"\r\n")}}).get()}}),m.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Zb()||$b()}:Zb;var Wb=0,Xb={},Yb=m.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Xb)Xb[a](void 0,!0)}),k.cors=!!Yb&&"withCredentials"in Yb,Yb=k.ajax=!!Yb,Yb&&m.ajaxTransport(function(a){if(!a.crossDomain||k.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Wb;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Xb[g],b=void 0,f.onreadystatechange=m.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Xb[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function Zb(){try{return new a.XMLHttpRequest}catch(b){}}function $b(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return m.globalEval(a),a}}}),m.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),m.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=y.head||m("head")[0]||y.documentElement;return{send:function(d,e){b=y.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var _b=[],ac=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=_b.pop()||m.expando+"_"+vb++;return this[a]=!0,a}}),m.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(ac.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&ac.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=m.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(ac,"$1"+e):b.jsonp!==!1&&(b.url+=(wb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||m.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,_b.push(e)),g&&m.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),m.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||y;var d=u.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=m.buildFragment([a],b,e),e&&e.length&&m(e).remove(),m.merge([],d.childNodes))};var bc=m.fn.load;m.fn.load=function(a,b,c){if("string"!=typeof a&&bc)return bc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=m.trim(a.slice(h,a.length)),a=a.slice(0,h)),m.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&m.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?m("<div>").append(m.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){m.fn[b]=function(a){return this.on(b,a)}}),m.expr.filters.animated=function(a){return m.grep(m.timers,function(b){return a===b.elem}).length};var cc=a.document.documentElement;function dc(a){return m.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}m.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=m.css(a,"position"),l=m(a),n={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=m.css(a,"top"),i=m.css(a,"left"),j=("absolute"===k||"fixed"===k)&&m.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),m.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(n.top=b.top-h.top+g),null!=b.left&&(n.left=b.left-h.left+e),"using"in b?b.using.call(a,n):l.css(n)}},m.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){m.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,m.contains(b,e)?(typeof e.getBoundingClientRect!==K&&(d=e.getBoundingClientRect()),c=dc(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===m.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),m.nodeName(a[0],"html")||(c=a.offset()),c.top+=m.css(a[0],"borderTopWidth",!0),c.left+=m.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-m.css(d,"marginTop",!0),left:b.left-c.left-m.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||cc;while(a&&!m.nodeName(a,"html")&&"static"===m.css(a,"position"))a=a.offsetParent;return a||cc})}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);m.fn[a]=function(d){return V(this,function(a,d,e){var f=dc(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?m(f).scrollLeft():e,c?e:m(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),m.each(["top","left"],function(a,b){m.cssHooks[b]=La(k.pixelPosition,function(a,c){return c?(c=Ja(a,b),Ha.test(c)?m(a).position()[b]+"px":c):void 0})}),m.each({Height:"height",Width:"width"},function(a,b){m.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){m.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return V(this,function(b,c,d){var e;return m.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?m.css(b,c,g):m.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),m.fn.size=function(){return this.length},m.fn.andSelf=m.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return m});var ec=a.jQuery,fc=a.$;return m.noConflict=function(b){return a.$===m&&(a.$=fc),b&&a.jQuery===m&&(a.jQuery=ec),m},typeof b===K&&(a.jQuery=a.$=m),m});
 /*!
 * Bootstrap v3.3.5 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */

/*!
 * Generated using the Bootstrap Customizer (http://getbootstrap.com/customize/?id=e8f0d0b3b92b40af0268)
 * Config saved to config.json and https://gist.github.com/e8f0d0b3b92b40af0268
 */
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(t){"use strict";var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),n=i.data("bs.alert");n||i.data("bs.alert",n=new o(this)),"string"==typeof e&&n[e].call(i)})}var i='[data-dismiss="alert"]',o=function(e){t(e).on("click",i,this.close)};o.VERSION="3.3.5",o.TRANSITION_DURATION=150,o.prototype.close=function(e){function i(){a.detach().trigger("closed.bs.alert").remove()}var n=t(this),s=n.attr("data-target");s||(s=n.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,""));var a=t(s);e&&e.preventDefault(),a.length||(a=n.closest(".alert")),a.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(a.removeClass("in"),t.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",i).emulateTransitionEnd(o.TRANSITION_DURATION):i())};var n=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=o,t.fn.alert.noConflict=function(){return t.fn.alert=n,this},t(document).on("click.bs.alert.data-api",i,o.prototype.close)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),n=o.data("bs.button"),s="object"==typeof e&&e;n||o.data("bs.button",n=new i(this,s)),"toggle"==e?n.toggle():e&&n.setState(e)})}var i=function(e,o){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,o),this.isLoading=!1};i.VERSION="3.3.5",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(e){var i="disabled",o=this.$element,n=o.is("input")?"val":"html",s=o.data();e+="Text",null==s.resetText&&o.data("resetText",o[n]()),setTimeout(t.proxy(function(){o[n](null==s[e]?this.options[e]:s[e]),"loadingText"==e?(this.isLoading=!0,o.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,o.removeClass(i).removeAttr(i))},this),0)},i.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")?(i.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==i.prop("type")&&(i.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),i.prop("checked",this.$element.hasClass("active")),t&&i.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var o=t.fn.button;t.fn.button=e,t.fn.button.Constructor=i,t.fn.button.noConflict=function(){return t.fn.button=o,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var o=t(i.target);o.hasClass("btn")||(o=o.closest(".btn")),e.call(o,"toggle"),t(i.target).is('input[type="radio"]')||t(i.target).is('input[type="checkbox"]')||i.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),n=o.data("bs.carousel"),s=t.extend({},i.DEFAULTS,o.data(),"object"==typeof e&&e),a="string"==typeof e?e:s.slide;n||o.data("bs.carousel",n=new i(this,s)),"number"==typeof e?n.to(e):a?n[a]():s.interval&&n.pause().cycle()})}var i=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};i.VERSION="3.3.5",i.TRANSITION_DURATION=600,i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},i.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},i.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},i.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e),o="prev"==t&&0===i||"next"==t&&i==this.$items.length-1;if(o&&!this.options.wrap)return e;var n="prev"==t?-1:1,s=(i+n)%this.$items.length;return this.$items.eq(s)},i.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",this.$items.eq(t))},i.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){return this.sliding?void 0:this.slide("next")},i.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},i.prototype.slide=function(e,o){var n=this.$element.find(".item.active"),s=o||this.getItemForDirection(e,n),a=this.interval,r="next"==e?"left":"right",l=this;if(s.hasClass("active"))return this.sliding=!1;var h=s[0],d=t.Event("slide.bs.carousel",{relatedTarget:h,direction:r});if(this.$element.trigger(d),!d.isDefaultPrevented()){if(this.sliding=!0,a&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var p=t(this.$indicators.children()[this.getItemIndex(s)]);p&&p.addClass("active")}var c=t.Event("slid.bs.carousel",{relatedTarget:h,direction:r});return t.support.transition&&this.$element.hasClass("slide")?(s.addClass(e),s[0].offsetWidth,n.addClass(r),s.addClass(r),n.one("bsTransitionEnd",function(){s.removeClass([e,r].join(" ")).addClass("active"),n.removeClass(["active",r].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(c)},0)}).emulateTransitionEnd(i.TRANSITION_DURATION)):(n.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(c)),a&&this.cycle(),this}};var o=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=i,t.fn.carousel.noConflict=function(){return t.fn.carousel=o,this};var n=function(i){var o,n=t(this),s=t(n.attr("data-target")||(o=n.attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,""));if(s.hasClass("carousel")){var a=t.extend({},s.data(),n.data()),r=n.attr("data-slide-to");r&&(a.interval=!1),e.call(s,a),r&&s.data("bs.carousel").to(r),i.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",n).on("click.bs.carousel.data-api","[data-slide-to]",n),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var i=t(this);e.call(i,i.data())})})}(jQuery),+function(t){"use strict";function e(e){var i=e.attr("data-target");i||(i=e.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var o=i&&t(i);return o&&o.length?o:e.parent()}function i(i){i&&3===i.which||(t(n).remove(),t(s).each(function(){var o=t(this),n=e(o),s={relatedTarget:this};n.hasClass("open")&&(i&&"click"==i.type&&/input|textarea/i.test(i.target.tagName)&&t.contains(n[0],i.target)||(n.trigger(i=t.Event("hide.bs.dropdown",s)),i.isDefaultPrevented()||(o.attr("aria-expanded","false"),n.removeClass("open").trigger("hidden.bs.dropdown",s))))}))}function o(e){return this.each(function(){var i=t(this),o=i.data("bs.dropdown");o||i.data("bs.dropdown",o=new a(this)),"string"==typeof e&&o[e].call(i)})}var n=".dropdown-backdrop",s='[data-toggle="dropdown"]',a=function(e){t(e).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.5",a.prototype.toggle=function(o){var n=t(this);if(!n.is(".disabled, :disabled")){var s=e(n),a=s.hasClass("open");if(i(),!a){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",i);var r={relatedTarget:this};if(s.trigger(o=t.Event("show.bs.dropdown",r)),o.isDefaultPrevented())return;n.trigger("focus").attr("aria-expanded","true"),s.toggleClass("open").trigger("shown.bs.dropdown",r)}return!1}},a.prototype.keydown=function(i){if(/(38|40|27|32)/.test(i.which)&&!/input|textarea/i.test(i.target.tagName)){var o=t(this);if(i.preventDefault(),i.stopPropagation(),!o.is(".disabled, :disabled")){var n=e(o),a=n.hasClass("open");if(!a&&27!=i.which||a&&27==i.which)return 27==i.which&&n.find(s).trigger("focus"),o.trigger("click");var r=" li:not(.disabled):visible a",l=n.find(".dropdown-menu"+r);if(l.length){var h=l.index(i.target);38==i.which&&h>0&&h--,40==i.which&&h<l.length-1&&h++,~h||(h=0),l.eq(h).trigger("focus")}}}};var r=t.fn.dropdown;t.fn.dropdown=o,t.fn.dropdown.Constructor=a,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=r,this},t(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,a.prototype.toggle).on("keydown.bs.dropdown.data-api",s,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery),+function(t){"use strict";function e(e,o){return this.each(function(){var n=t(this),s=n.data("bs.modal"),a=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);s||n.data("bs.modal",s=new i(this,a)),"string"==typeof e?s[e](o):a.show&&s.show(o)})}var i=function(e,i){this.options=i,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.3.5",i.TRANSITION_DURATION=300,i.BACKDROP_TRANSITION_DURATION=150,i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},i.prototype.show=function(e){var o=this,n=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){o.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(o.$element)&&(o.ignoreBackdropClick=!0)})}),this.backdrop(function(){var n=t.support.transition&&o.$element.hasClass("fade");o.$element.parent().length||o.$element.appendTo(o.$body),o.$element.show().scrollTop(0),o.adjustDialog(),n&&o.$element[0].offsetWidth,o.$element.addClass("in"),o.enforceFocus();var s=t.Event("shown.bs.modal",{relatedTarget:e});n?o.$dialog.one("bsTransitionEnd",function(){o.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(i.TRANSITION_DURATION):o.$element.trigger("focus").trigger(s)}))},i.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(i.TRANSITION_DURATION):this.hideModal())},i.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},i.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},i.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(e){var o=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=t.support.transition&&n;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+n).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;s?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){o.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):a()}else e&&e()},i.prototype.handleUpdate=function(){this.adjustDialog()},i.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},i.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},i.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},i.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},i.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},i.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var o=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=i,t.fn.modal.noConflict=function(){return t.fn.modal=o,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var o=t(this),n=o.attr("href"),s=t(o.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),a=s.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(n)&&n},s.data(),o.data());o.is("a")&&i.preventDefault(),s.one("show.bs.modal",function(t){t.isDefaultPrevented()||s.one("hidden.bs.modal",function(){o.is(":visible")&&o.trigger("focus")})}),e.call(s,a,this)})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),n=o.data("bs.tooltip"),s="object"==typeof e&&e;(n||!/destroy|hide/.test(e))&&(n||o.data("bs.tooltip",n=new i(this,s)),"string"==typeof e&&n[e]())})}var i=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};i.VERSION="3.3.5",i.TRANSITION_DURATION=150,i.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(e,i,o){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(o),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var n=this.options.trigger.split(" "),s=n.length;s--;){var a=n[s];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var r="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},i.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,o){i[t]!=o&&(e[t]=o)}),e},i.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusin"==e.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState?void(i.hoverState="in"):(clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show())},i.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},i.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusout"==e.type?"focus":"hover"]=!1),i.isInStateTrue()?void 0:(clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide())},i.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var o=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!o)return;var n=this,s=this.tip(),a=this.getUID(this.type);this.setContent(),s.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&s.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,h=l.test(r);h&&(r=r.replace(l,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var d=this.getPosition(),p=s[0].offsetWidth,c=s[0].offsetHeight;if(h){var f=r,u=this.getPosition(this.$viewport);r="bottom"==r&&d.bottom+c>u.bottom?"top":"top"==r&&d.top-c<u.top?"bottom":"right"==r&&d.right+p>u.width?"left":"left"==r&&d.left-p<u.left?"right":r,s.removeClass(f).addClass(r)}var g=this.getCalculatedOffset(r,d,p,c);this.applyPlacement(g,r);var m=function(){var t=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,"out"==t&&n.leave(n)};t.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",m).emulateTransitionEnd(i.TRANSITION_DURATION):m()}},i.prototype.applyPlacement=function(e,i){var o=this.tip(),n=o[0].offsetWidth,s=o[0].offsetHeight,a=parseInt(o.css("margin-top"),10),r=parseInt(o.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(r)&&(r=0),e.top+=a,e.left+=r,t.offset.setOffset(o[0],t.extend({using:function(t){o.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),o.addClass("in");var l=o[0].offsetWidth,h=o[0].offsetHeight;"top"==i&&h!=s&&(e.top=e.top+s-h);var d=this.getViewportAdjustedDelta(i,e,l,h);d.left?e.left+=d.left:e.top+=d.top;var p=/top|bottom/.test(i),c=p?2*d.left-n+l:2*d.top-s+h,f=p?"offsetWidth":"offsetHeight";o.offset(e),this.replaceArrow(c,o[0][f],p)},i.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},i.prototype.hide=function(e){function o(){"in"!=n.hoverState&&s.detach(),n.$element.removeAttr("aria-describedby").trigger("hidden.bs."+n.type),e&&e()}var n=this,s=t(this.$tip),a=t.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",o).emulateTransitionEnd(i.TRANSITION_DURATION):o(),this.hoverState=null,this)},i.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(e){e=e||this.$element;var i=e[0],o="BODY"==i.tagName,n=i.getBoundingClientRect();null==n.width&&(n=t.extend({},n,{width:n.right-n.left,height:n.bottom-n.top}));var s=o?{top:0,left:0}:e.offset(),a={scroll:o?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},r=o?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},n,a,r,s)},i.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},i.prototype.getViewportAdjustedDelta=function(t,e,i,o){var n={top:0,left:0};if(!this.$viewport)return n;var s=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var r=e.top-s-a.scroll,l=e.top+s-a.scroll+o;r<a.top?n.top=a.top-r:l>a.top+a.height&&(n.top=a.top+a.height-l)}else{var h=e.left-s,d=e.left+s+i;h<a.left?n.left=a.left-h:d>a.right&&(n.left=a.left+a.width-d)}return n},i.prototype.getTitle=function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},i.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},i.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(e){var i=this;e&&(i=t(e.currentTarget).data("bs."+this.type),i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),e?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},i.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null})};var o=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=i,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=o,this}}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),n=o.data("bs.popover"),s="object"==typeof e&&e;(n||!/destroy|hide/.test(e))&&(n||o.data("bs.popover",n=new i(this,s)),"string"==typeof e&&n[e]())})}var i=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");i.VERSION="3.3.5",i.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),i.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),i.prototype.constructor=i,i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof i?"html":"append":"text"](i),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},i.prototype.hasContent=function(){return this.getTitle()||this.getContent()},i.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var o=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=i,t.fn.popover.noConflict=function(){return t.fn.popover=o,this}}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),n=o.data("bs.tab");n||o.data("bs.tab",n=new i(this)),"string"==typeof e&&n[e]()})}var i=function(e){this.element=t(e)};i.VERSION="3.3.5",i.TRANSITION_DURATION=150,i.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),o=e.data("target");if(o||(o=e.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var n=i.find(".active:last a"),s=t.Event("hide.bs.tab",{relatedTarget:e[0]}),a=t.Event("show.bs.tab",{relatedTarget:n[0]});if(n.trigger(s),e.trigger(a),!a.isDefaultPrevented()&&!s.isDefaultPrevented()){var r=t(o);this.activate(e.closest("li"),i),this.activate(r,r.parent(),function(){n.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:n[0]})})}}},i.prototype.activate=function(e,o,n){function s(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),r?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),n&&n()}var a=o.find("> .active"),r=n&&t.support.transition&&(a.length&&a.hasClass("fade")||!!o.find("> .fade").length);a.length&&r?a.one("bsTransitionEnd",s).emulateTransitionEnd(i.TRANSITION_DURATION):s(),a.removeClass("in")};var o=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=i,t.fn.tab.noConflict=function(){return t.fn.tab=o,this};var n=function(i){i.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',n).on("click.bs.tab.data-api",'[data-toggle="pill"]',n)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),n=o.data("bs.affix"),s="object"==typeof e&&e;n||o.data("bs.affix",n=new i(this,s)),"string"==typeof e&&n[e]()})}var i=function(e,o){this.options=t.extend({},i.DEFAULTS,o),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.3.5",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getState=function(t,e,i,o){var n=this.$target.scrollTop(),s=this.$element.offset(),a=this.$target.height();if(null!=i&&"top"==this.affixed)return i>n?"top":!1;if("bottom"==this.affixed)return null!=i?n+this.unpin<=s.top?!1:"bottom":t-o>=n+a?!1:"bottom";var r=null==this.affixed,l=r?n:s.top,h=r?a:e;return null!=i&&i>=n?"top":null!=o&&l+h>=t-o?"bottom":!1},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},i.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),o=this.options.offset,n=o.top,s=o.bottom,a=Math.max(t(document).height(),t(document.body).height());"object"!=typeof o&&(s=n=o),"function"==typeof n&&(n=o.top(this.$element)),"function"==typeof s&&(s=o.bottom(this.$element));var r=this.getState(a,e,n,s);if(this.affixed!=r){null!=this.unpin&&this.$element.css("top","");var l="affix"+(r?"-"+r:""),h=t.Event(l+".bs.affix");if(this.$element.trigger(h),h.isDefaultPrevented())return;this.affixed=r,this.unpin="bottom"==r?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==r&&this.$element.offset({top:a-e-s})}};var o=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=i,t.fn.affix.noConflict=function(){return t.fn.affix=o,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var i=t(this),o=i.data();o.offset=o.offset||{},null!=o.offsetBottom&&(o.offset.bottom=o.offsetBottom),null!=o.offsetTop&&(o.offset.top=o.offsetTop),e.call(i,o)})})}(jQuery),+function(t){"use strict";function e(e){var i,o=e.attr("data-target")||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return t(o)}function i(e){return this.each(function(){var i=t(this),n=i.data("bs.collapse"),s=t.extend({},o.DEFAULTS,i.data(),"object"==typeof e&&e);!n&&s.toggle&&/show|hide/.test(e)&&(s.toggle=!1),n||i.data("bs.collapse",n=new o(this,s)),"string"==typeof e&&n[e]()})}var o=function(e,i){this.$element=t(e),this.options=t.extend({},o.DEFAULTS,i),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};o.VERSION="3.3.5",o.TRANSITION_DURATION=350,o.DEFAULTS={toggle:!0},o.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},o.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,n=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(n&&n.length&&(e=n.data("bs.collapse"),e&&e.transitioning))){var s=t.Event("show.bs.collapse");if(this.$element.trigger(s),!s.isDefaultPrevented()){n&&n.length&&(i.call(n,"hide"),e||n.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var r=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return r.call(this);var l=t.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",t.proxy(r,this)).emulateTransitionEnd(o.TRANSITION_DURATION)[a](this.$element[0][l]);
}}}},o.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[i](0).one("bsTransitionEnd",t.proxy(n,this)).emulateTransitionEnd(o.TRANSITION_DURATION):n.call(this)}}},o.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},o.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(i,o){var n=t(o);this.addAriaAndCollapsedClass(e(n),n)},this)).end()},o.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var n=t.fn.collapse;t.fn.collapse=i,t.fn.collapse.Constructor=o,t.fn.collapse.noConflict=function(){return t.fn.collapse=n,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(o){var n=t(this);n.attr("data-target")||o.preventDefault();var s=e(n),a=s.data("bs.collapse"),r=a?"toggle":n.data();i.call(s,r)})}(jQuery),+function(t){"use strict";function e(i,o){this.$body=t(document.body),this.$scrollElement=t(t(i).is(document.body)?window:i),this.options=t.extend({},e.DEFAULTS,o),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function i(i){return this.each(function(){var o=t(this),n=o.data("bs.scrollspy"),s="object"==typeof i&&i;n||o.data("bs.scrollspy",n=new e(this,s)),"string"==typeof i&&n[i]()})}e.VERSION="3.3.5",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,i="offset",o=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(i="position",o=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),n=e.data("target")||e.attr("href"),s=/^#./.test(n)&&t(n);return s&&s.length&&s.is(":visible")&&[[s[i]().top+o,n]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),o=this.options.offset+i-this.$scrollElement.height(),n=this.offsets,s=this.targets,a=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),e>=o)return a!=(t=s[s.length-1])&&this.activate(t);if(a&&e<n[0])return this.activeTarget=null,this.clear();for(t=n.length;t--;)a!=s[t]&&e>=n[t]&&(void 0===n[t+1]||e<n[t+1])&&this.activate(s[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var i=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',o=t(i).parents("li").addClass("active");o.parent(".dropdown-menu").length&&(o=o.closest("li.dropdown").addClass("active")),o.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var o=t.fn.scrollspy;t.fn.scrollspy=i,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=o,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);i.call(e,e.data())})})}(jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}t.fn.emulateTransitionEnd=function(e){var i=!1,o=this;t(this).one("bsTransitionEnd",function(){i=!0});var n=function(){i||t(o).trigger(t.support.transition.end)};return setTimeout(n,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){return t(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery); /*!
 * Datepicker for Bootstrap v1.5.0 (https://github.com/eternicode/bootstrap-datepicker)
 *
 * Copyright 2012 Stefan Petre
 * Improvements by Andrew Rowls
 * Licensed under the Apache License v2.0 (http://www.apache.org/licenses/LICENSE-2.0)
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a,b){function c(){return new Date(Date.UTC.apply(Date,arguments))}function d(){var a=new Date;return c(a.getFullYear(),a.getMonth(),a.getDate())}function e(a,b){return a.getUTCFullYear()===b.getUTCFullYear()&&a.getUTCMonth()===b.getUTCMonth()&&a.getUTCDate()===b.getUTCDate()}function f(a){return function(){return this[a].apply(this,arguments)}}function g(a){return a&&!isNaN(a.getTime())}function h(b,c){function d(a,b){return b.toLowerCase()}var e,f=a(b).data(),g={},h=new RegExp("^"+c.toLowerCase()+"([A-Z])");c=new RegExp("^"+c.toLowerCase());for(var i in f)c.test(i)&&(e=i.replace(h,d),g[e]=f[i]);return g}function i(b){var c={};if(q[b]||(b=b.split("-")[0],q[b])){var d=q[b];return a.each(p,function(a,b){b in d&&(c[b]=d[b])}),c}}var j=function(){var b={get:function(a){return this.slice(a)[0]},contains:function(a){for(var b=a&&a.valueOf(),c=0,d=this.length;d>c;c++)if(this[c].valueOf()===b)return c;return-1},remove:function(a){this.splice(a,1)},replace:function(b){b&&(a.isArray(b)||(b=[b]),this.clear(),this.push.apply(this,b))},clear:function(){this.length=0},copy:function(){var a=new j;return a.replace(this),a}};return function(){var c=[];return c.push.apply(c,arguments),a.extend(c,b),c}}(),k=function(b,c){this._process_options(c),this.dates=new j,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=a(b),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.hasClass("date")?this.element.find(".add-on, .input-group-addon, .btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=a(r.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot .today, tfoot .clear").attr("colspan",function(a,b){return parseInt(b)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.setDaysOfWeekHighlighted(this.o.daysOfWeekHighlighted),this.setDatesDisabled(this.o.datesDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};k.prototype={constructor:k,_process_options:function(e){this._o=a.extend({},this._o,e);var f=this.o=a.extend({},this._o),g=f.language;switch(q[g]||(g=g.split("-")[0],q[g]||(g=o.language)),f.language=g,f.startView){case 2:case"decade":f.startView=2;break;case 1:case"year":f.startView=1;break;default:f.startView=0}switch(f.minViewMode){case 1:case"months":f.minViewMode=1;break;case 2:case"years":f.minViewMode=2;break;default:f.minViewMode=0}switch(f.maxViewMode){case 0:case"days":f.maxViewMode=0;break;case 1:case"months":f.maxViewMode=1;break;default:f.maxViewMode=2}f.startView=Math.min(f.startView,f.maxViewMode),f.startView=Math.max(f.startView,f.minViewMode),f.multidate!==!0&&(f.multidate=Number(f.multidate)||!1,f.multidate!==!1&&(f.multidate=Math.max(0,f.multidate))),f.multidateSeparator=String(f.multidateSeparator),f.weekStart%=7,f.weekEnd=(f.weekStart+6)%7;var h=r.parseFormat(f.format);if(f.startDate!==-(1/0)&&(f.startDate?f.startDate instanceof Date?f.startDate=this._local_to_utc(this._zero_time(f.startDate)):f.startDate=r.parseDate(f.startDate,h,f.language):f.startDate=-(1/0)),f.endDate!==1/0&&(f.endDate?f.endDate instanceof Date?f.endDate=this._local_to_utc(this._zero_time(f.endDate)):f.endDate=r.parseDate(f.endDate,h,f.language):f.endDate=1/0),f.daysOfWeekDisabled=f.daysOfWeekDisabled||[],a.isArray(f.daysOfWeekDisabled)||(f.daysOfWeekDisabled=f.daysOfWeekDisabled.split(/[,\s]*/)),f.daysOfWeekDisabled=a.map(f.daysOfWeekDisabled,function(a){return parseInt(a,10)}),f.daysOfWeekHighlighted=f.daysOfWeekHighlighted||[],a.isArray(f.daysOfWeekHighlighted)||(f.daysOfWeekHighlighted=f.daysOfWeekHighlighted.split(/[,\s]*/)),f.daysOfWeekHighlighted=a.map(f.daysOfWeekHighlighted,function(a){return parseInt(a,10)}),f.datesDisabled=f.datesDisabled||[],!a.isArray(f.datesDisabled)){var i=[];i.push(r.parseDate(f.datesDisabled,h,f.language)),f.datesDisabled=i}f.datesDisabled=a.map(f.datesDisabled,function(a){return r.parseDate(a,h,f.language)});var j=String(f.orientation).toLowerCase().split(/\s+/g),k=f.orientation.toLowerCase();if(j=a.grep(j,function(a){return/^auto|left|right|top|bottom$/.test(a)}),f.orientation={x:"auto",y:"auto"},k&&"auto"!==k)if(1===j.length)switch(j[0]){case"top":case"bottom":f.orientation.y=j[0];break;case"left":case"right":f.orientation.x=j[0]}else k=a.grep(j,function(a){return/^left|right$/.test(a)}),f.orientation.x=k[0]||"auto",k=a.grep(j,function(a){return/^top|bottom$/.test(a)}),f.orientation.y=k[0]||"auto";else;if(f.defaultViewDate){var l=f.defaultViewDate.year||(new Date).getFullYear(),m=f.defaultViewDate.month||0,n=f.defaultViewDate.day||1;f.defaultViewDate=c(l,m,n)}else f.defaultViewDate=d();f.showOnFocus=f.showOnFocus!==b?f.showOnFocus:!0,f.zIndexOffset=f.zIndexOffset!==b?f.zIndexOffset:10},_events:[],_secondaryEvents:[],_applyEvents:function(a){for(var c,d,e,f=0;f<a.length;f++)c=a[f][0],2===a[f].length?(d=b,e=a[f][1]):3===a[f].length&&(d=a[f][1],e=a[f][2]),c.on(e,d)},_unapplyEvents:function(a){for(var c,d,e,f=0;f<a.length;f++)c=a[f][0],2===a[f].length?(e=b,d=a[f][1]):3===a[f].length&&(e=a[f][1],d=a[f][2]),c.off(d,e)},_buildEvents:function(){var b={keyup:a.proxy(function(b){-1===a.inArray(b.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:a.proxy(this.keydown,this),paste:a.proxy(this.paste,this)};this.o.showOnFocus===!0&&(b.focus=a.proxy(this.show,this)),this.isInput?this._events=[[this.element,b]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),b],[this.component,{click:a.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:a.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:a.proxy(function(a){this._focused_from=a.target},this)}],[this.element,{blur:a.proxy(function(a){this._focused_from=a.target},this)}]),this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":a.proxy(function(a){this.update(a.date)},this)}]),this._secondaryEvents=[[this.picker,{click:a.proxy(this.click,this)}],[a(window),{resize:a.proxy(this.place,this)}],[a(document),{mousedown:a.proxy(function(a){this.element.is(a.target)||this.element.find(a.target).length||this.picker.is(a.target)||this.picker.find(a.target).length||this.picker.hasClass("datepicker-inline")||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(b,c){var d=c||this.dates.get(-1),e=this._utc_to_local(d);this.element.trigger({type:b,date:e,dates:a.map(this.dates,this._utc_to_local),format:a.proxy(function(a,b){0===arguments.length?(a=this.dates.length-1,b=this.o.format):"string"==typeof a&&(b=a,a=this.dates.length-1),b=b||this.o.format;var c=this.dates.get(a);return r.formatDate(c,b,this.o.language)},this)})},show:function(){return this.element.attr("readonly")&&this.o.enableOnReadonly===!1?void 0:(this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&a(this.element).blur(),this)},hide:function(){return this.isInline?this:this.picker.is(":visible")?(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"),this):this},remove:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function(b){var c;if(b.originalEvent.clipboardData&&b.originalEvent.clipboardData.types&&-1!==a.inArray("text/plain",b.originalEvent.clipboardData.types))c=b.originalEvent.clipboardData.getData("text/plain");else{if(!window.clipboardData)return;c=window.clipboardData.getData("Text")}this.setDate(c),this.update(),b.preventDefault()},_utc_to_local:function(a){return a&&new Date(a.getTime()+6e4*a.getTimezoneOffset())},_local_to_utc:function(a){return a&&new Date(a.getTime()-6e4*a.getTimezoneOffset())},_zero_time:function(a){return a&&new Date(a.getFullYear(),a.getMonth(),a.getDate())},_zero_utc_time:function(a){return a&&new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()))},getDates:function(){return a.map(this.dates,this._utc_to_local)},getUTCDates:function(){return a.map(this.dates,function(a){return new Date(a)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var a=this.dates.get(-1);return"undefined"!=typeof a?new Date(a):null},clearDates:function(){var a;this.isInput?a=this.element:this.component&&(a=this.element.find("input")),a&&a.val(""),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function(){var b=a.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,b),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var b=a.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,a.map(b,this._utc_to_local)),this._trigger("changeDate"),this.setValue(),this},setDate:f("setDates"),setUTCDate:f("setUTCDates"),setValue:function(){var a=this.getFormattedDate();return this.isInput?this.element.val(a):this.component&&this.element.find("input").val(a),this},getFormattedDate:function(c){c===b&&(c=this.o.format);var d=this.o.language;return a.map(this.dates,function(a){return r.formatDate(a,c,d)}).join(this.o.multidateSeparator)},setStartDate:function(a){return this._process_options({startDate:a}),this.update(),this.updateNavArrows(),this},setEndDate:function(a){return this._process_options({endDate:a}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(a){return this._process_options({daysOfWeekDisabled:a}),this.update(),this.updateNavArrows(),this},setDaysOfWeekHighlighted:function(a){return this._process_options({daysOfWeekHighlighted:a}),this.update(),this},setDatesDisabled:function(a){this._process_options({datesDisabled:a}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return this;var b=this.picker.outerWidth(),c=this.picker.outerHeight(),d=10,e=a(this.o.container),f=e.width(),g=e.scrollTop(),h=e.offset(),i=[];this.element.parents().each(function(){var b=a(this).css("z-index");"auto"!==b&&0!==b&&i.push(parseInt(b))});var j=Math.max.apply(Math,i)+this.o.zIndexOffset,k=this.component?this.component.parent().offset():this.element.offset(),l=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),m=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),n=k.left-h.left,o=k.top-h.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(n-=b-m)):k.left<0?(this.picker.addClass("datepicker-orient-left"),n-=k.left-d):n+b>f?(this.picker.addClass("datepicker-orient-right"),n=k.left+m-b):this.picker.addClass("datepicker-orient-left");var p,q=this.o.orientation.y;if("auto"===q&&(p=-g+o-c,q=0>p?"bottom":"top"),this.picker.addClass("datepicker-orient-"+q),"top"===q?o-=c+parseInt(this.picker.css("padding-top")):o+=l,this.o.rtl){var r=f-(n+m);this.picker.css({top:o,right:r,zIndex:j})}else this.picker.css({top:o,left:n,zIndex:j});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var b=this.dates.copy(),c=[],d=!1;return arguments.length?(a.each(arguments,a.proxy(function(a,b){b instanceof Date&&(b=this._local_to_utc(b)),c.push(b)},this)),d=!0):(c=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),c=c&&this.o.multidate?c.split(this.o.multidateSeparator):[c],delete this.element.data().date),c=a.map(c,a.proxy(function(a){return r.parseDate(a,this.o.format,this.o.language)},this)),c=a.grep(c,a.proxy(function(a){return a<this.o.startDate||a>this.o.endDate||!a},this),!0),this.dates.replace(c),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=this.o.defaultViewDate,d?this.setValue():c.length&&String(b)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&b.length&&this._trigger("clearDate"),this.fill(),this.element.change(),this},fillDow:function(){var a=this.o.weekStart,b="<tr>";for(this.o.calendarWeeks&&(this.picker.find(".datepicker-days .datepicker-switch").attr("colspan",function(a,b){return parseInt(b)+1}),b+='<th class="cw">&#160;</th>');a<this.o.weekStart+7;)b+='<th class="dow">'+q[this.o.language].daysMin[a++%7]+"</th>";b+="</tr>",this.picker.find(".datepicker-days thead").append(b)},fillMonths:function(){for(var a="",b=0;12>b;)a+='<span class="month">'+q[this.o.language].monthsShort[b++]+"</span>";this.picker.find(".datepicker-months td").html(a)},setRange:function(b){b&&b.length?this.range=a.map(b,function(a){return a.valueOf()}):delete this.range,this.fill()},getClassNames:function(b){var c=[],d=this.viewDate.getUTCFullYear(),f=this.viewDate.getUTCMonth(),g=new Date;return b.getUTCFullYear()<d||b.getUTCFullYear()===d&&b.getUTCMonth()<f?c.push("old"):(b.getUTCFullYear()>d||b.getUTCFullYear()===d&&b.getUTCMonth()>f)&&c.push("new"),this.focusDate&&b.valueOf()===this.focusDate.valueOf()&&c.push("focused"),this.o.todayHighlight&&b.getUTCFullYear()===g.getFullYear()&&b.getUTCMonth()===g.getMonth()&&b.getUTCDate()===g.getDate()&&c.push("today"),-1!==this.dates.contains(b)&&c.push("active"),(b.valueOf()<this.o.startDate||b.valueOf()>this.o.endDate||-1!==a.inArray(b.getUTCDay(),this.o.daysOfWeekDisabled))&&c.push("disabled"),-1!==a.inArray(b.getUTCDay(),this.o.daysOfWeekHighlighted)&&c.push("highlighted"),this.o.datesDisabled.length>0&&a.grep(this.o.datesDisabled,function(a){return e(b,a)}).length>0&&c.push("disabled","disabled-date"),this.range&&(b>this.range[0]&&b<this.range[this.range.length-1]&&c.push("range"),-1!==a.inArray(b.valueOf(),this.range)&&c.push("selected"),b.valueOf()===this.range[0]&&c.push("range-start"),b.valueOf()===this.range[this.range.length-1]&&c.push("range-end")),c},fill:function(){var d,e=new Date(this.viewDate),f=e.getUTCFullYear(),g=e.getUTCMonth(),h=this.o.startDate!==-(1/0)?this.o.startDate.getUTCFullYear():-(1/0),i=this.o.startDate!==-(1/0)?this.o.startDate.getUTCMonth():-(1/0),j=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,k=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,l=q[this.o.language].today||q.en.today||"",m=q[this.o.language].clear||q.en.clear||"",n=q[this.o.language].titleFormat||q.en.titleFormat;if(!isNaN(f)&&!isNaN(g)){this.picker.find(".datepicker-days thead .datepicker-switch").text(r.formatDate(new c(f,g),n,this.o.language)),this.picker.find("tfoot .today").text(l).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot .clear").text(m).toggle(this.o.clearBtn!==!1),this.picker.find("thead .datepicker-title").text(this.o.title).toggle(""!==this.o.title),this.updateNavArrows(),this.fillMonths();var o=c(f,g-1,28),p=r.getDaysInMonth(o.getUTCFullYear(),o.getUTCMonth());o.setUTCDate(p),o.setUTCDate(p-(o.getUTCDay()-this.o.weekStart+7)%7);var s=new Date(o);o.getUTCFullYear()<100&&s.setUTCFullYear(o.getUTCFullYear()),s.setUTCDate(s.getUTCDate()+42),s=s.valueOf();for(var t,u=[];o.valueOf()<s;){if(o.getUTCDay()===this.o.weekStart&&(u.push("<tr>"),this.o.calendarWeeks)){var v=new Date(+o+(this.o.weekStart-o.getUTCDay()-7)%7*864e5),w=new Date(Number(v)+(11-v.getUTCDay())%7*864e5),x=new Date(Number(x=c(w.getUTCFullYear(),0,1))+(11-x.getUTCDay())%7*864e5),y=(w-x)/864e5/7+1;u.push('<td class="cw">'+y+"</td>")}if(t=this.getClassNames(o),t.push("day"),this.o.beforeShowDay!==a.noop){var z=this.o.beforeShowDay(this._utc_to_local(o));z===b?z={}:"boolean"==typeof z?z={enabled:z}:"string"==typeof z&&(z={classes:z}),z.enabled===!1&&t.push("disabled"),z.classes&&(t=t.concat(z.classes.split(/\s+/))),z.tooltip&&(d=z.tooltip)}t=a.unique(t),u.push('<td class="'+t.join(" ")+'"'+(d?' title="'+d+'"':"")+">"+o.getUTCDate()+"</td>"),d=null,o.getUTCDay()===this.o.weekEnd&&u.push("</tr>"),o.setUTCDate(o.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(u.join(""));var A=this.picker.find(".datepicker-months").find(".datepicker-switch").text(this.o.maxViewMode<2?"Months":f).end().find("span").removeClass("active");if(a.each(this.dates,function(a,b){b.getUTCFullYear()===f&&A.eq(b.getUTCMonth()).addClass("active")}),(h>f||f>j)&&A.addClass("disabled"),f===h&&A.slice(0,i).addClass("disabled"),f===j&&A.slice(k+1).addClass("disabled"),this.o.beforeShowMonth!==a.noop){var B=this;a.each(A,function(b,c){if(!a(c).hasClass("disabled")){var d=new Date(f,b,1),e=B.o.beforeShowMonth(d);e===!1&&a(c).addClass("disabled")}})}u="",f=10*parseInt(f/10,10);var C=this.picker.find(".datepicker-years").find(".datepicker-switch").text(f+"-"+(f+9)).end().find("td");f-=1;for(var D,E=a.map(this.dates,function(a){return a.getUTCFullYear()}),F=-1;11>F;F++){if(D=["year"],d=null,-1===F?D.push("old"):10===F&&D.push("new"),-1!==a.inArray(f,E)&&D.push("active"),(h>f||f>j)&&D.push("disabled"),this.o.beforeShowYear!==a.noop){var G=this.o.beforeShowYear(new Date(f,0,1));G===b?G={}:"boolean"==typeof G?G={enabled:G}:"string"==typeof G&&(G={classes:G}),G.enabled===!1&&D.push("disabled"),G.classes&&(D=D.concat(G.classes.split(/\s+/))),G.tooltip&&(d=G.tooltip)}u+='<span class="'+D.join(" ")+'"'+(d?' title="'+d+'"':"")+">"+f+"</span>",f+=1}C.html(u)}},updateNavArrows:function(){if(this._allow_update){var a=new Date(this.viewDate),b=a.getUTCFullYear(),c=a.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-(1/0)&&b<=this.o.startDate.getUTCFullYear()&&c<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&b>=this.o.endDate.getUTCFullYear()&&c>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-(1/0)&&b<=this.o.startDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&b>=this.o.endDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(b){b.preventDefault(),b.stopPropagation();var d,e,f,g=a(b.target).closest("span, td, th");if(1===g.length)switch(g[0].nodeName.toLowerCase()){case"th":switch(g[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var h=r.modes[this.viewMode].navStep*("prev"===g[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,h),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,h),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var i=new Date;i=c(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0),this.showMode(-2);var j="linked"===this.o.todayBtn?null:"view";this._setDate(i,j);break;case"clear":this.clearDates()}break;case"span":g.hasClass("disabled")||(this.viewDate.setUTCDate(1),g.hasClass("month")?(f=1,e=g.parent().find("span").index(g),d=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(e),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode?(this._setDate(c(d,e,f)),this.showMode()):this.showMode(-1)):(f=1,e=0,d=parseInt(g.text(),10)||0,this.viewDate.setUTCFullYear(d),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(c(d,e,f)),this.showMode(-1)),this.fill());break;case"td":g.hasClass("day")&&!g.hasClass("disabled")&&(f=parseInt(g.text(),10)||1,d=this.viewDate.getUTCFullYear(),e=this.viewDate.getUTCMonth(),g.hasClass("old")?0===e?(e=11,d-=1):e-=1:g.hasClass("new")&&(11===e?(e=0,d+=1):e+=1),this._setDate(c(d,e,f)))}this.picker.is(":visible")&&this._focused_from&&a(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(a){var b=this.dates.contains(a);if(a||this.dates.clear(),-1!==b?(this.o.multidate===!0||this.o.multidate>1||this.o.toggleActive)&&this.dates.remove(b):this.o.multidate===!1?(this.dates.clear(),this.dates.push(a)):this.dates.push(a),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(a,b){b&&"date"!==b||this._toggle_multidate(a&&new Date(a)),b&&"view"!==b||(this.viewDate=a&&new Date(a)),this.fill(),this.setValue(),b&&"view"===b||this._trigger("changeDate");var c;this.isInput?c=this.element:this.component&&(c=this.element.find("input")),c&&c.change(),!this.o.autoclose||b&&"date"!==b||this.hide()},moveMonth:function(a,b){if(!g(a))return this.o.defaultViewDate;if(!b)return a;var c,d,e=new Date(a.valueOf()),f=e.getUTCDate(),h=e.getUTCMonth(),i=Math.abs(b);if(b=b>0?1:-1,1===i)d=-1===b?function(){return e.getUTCMonth()===h}:function(){return e.getUTCMonth()!==c},c=h+b,e.setUTCMonth(c),(0>c||c>11)&&(c=(c+12)%12);else{for(var j=0;i>j;j++)e=this.moveMonth(e,b);c=e.getUTCMonth(),e.setUTCDate(f),d=function(){return c!==e.getUTCMonth()}}for(;d();)e.setUTCDate(--f),e.setUTCMonth(c);return e},moveYear:function(a,b){return this.moveMonth(a,12*b)},dateWithinRange:function(a){return a>=this.o.startDate&&a<=this.o.endDate},keydown:function(a){if(!this.picker.is(":visible"))return void((40===a.keyCode||27===a.keyCode)&&(this.show(),a.stopPropagation()));var b,c,e,f=!1,g=this.focusDate||this.viewDate;switch(a.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),a.preventDefault(),a.stopPropagation();break;case 37:case 39:if(!this.o.keyboardNavigation)break;b=37===a.keyCode?-1:1,a.ctrlKey?(c=this.moveYear(this.dates.get(-1)||d(),b),e=this.moveYear(g,b),this._trigger("changeYear",this.viewDate)):a.shiftKey?(c=this.moveMonth(this.dates.get(-1)||d(),b),e=this.moveMonth(g,b),this._trigger("changeMonth",this.viewDate)):(c=new Date(this.dates.get(-1)||d()),c.setUTCDate(c.getUTCDate()+b),e=new Date(g),e.setUTCDate(g.getUTCDate()+b)),this.dateWithinRange(e)&&(this.focusDate=this.viewDate=e,this.setValue(),this.fill(),a.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;b=38===a.keyCode?-1:1,a.ctrlKey?(c=this.moveYear(this.dates.get(-1)||d(),b),e=this.moveYear(g,b),this._trigger("changeYear",this.viewDate)):a.shiftKey?(c=this.moveMonth(this.dates.get(-1)||d(),b),e=this.moveMonth(g,b),this._trigger("changeMonth",this.viewDate)):(c=new Date(this.dates.get(-1)||d()),c.setUTCDate(c.getUTCDate()+7*b),e=new Date(g),e.setUTCDate(g.getUTCDate()+7*b)),this.dateWithinRange(e)&&(this.focusDate=this.viewDate=e,this.setValue(),this.fill(),a.preventDefault());break;case 32:break;case 13:if(!this.o.forceParse)break;g=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(g),f=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(a.preventDefault(),"function"==typeof a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(f){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var h;this.isInput?h=this.element:this.component&&(h=this.element.find("input")),h&&h.change()}},showMode:function(a){a&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,this.viewMode+a))),this.picker.children("div").hide().filter(".datepicker-"+r.modes[this.viewMode].clsName).show(),this.updateNavArrows()}};var l=function(b,c){this.element=a(b),this.inputs=a.map(c.inputs,function(a){return a.jquery?a[0]:a}),delete c.inputs,n.call(a(this.inputs),c).on("changeDate",a.proxy(this.dateUpdated,this)),this.pickers=a.map(this.inputs,function(b){return a(b).data("datepicker")}),this.updateDates()};l.prototype={updateDates:function(){this.dates=a.map(this.pickers,function(a){return a.getUTCDate()}),this.updateRanges()},updateRanges:function(){var b=a.map(this.dates,function(a){return a.valueOf()});a.each(this.pickers,function(a,c){c.setRange(b)})},dateUpdated:function(b){if(!this.updating){this.updating=!0;var c=a(b.target).data("datepicker");if("undefined"!=typeof c){var d=c.getUTCDate(),e=a.inArray(b.target,this.inputs),f=e-1,g=e+1,h=this.inputs.length;if(-1!==e){if(a.each(this.pickers,function(a,b){b.getUTCDate()||b.setUTCDate(d)}),d<this.dates[f])for(;f>=0&&d<this.dates[f];)this.pickers[f--].setUTCDate(d);else if(d>this.dates[g])for(;h>g&&d>this.dates[g];)this.pickers[g++].setUTCDate(d);this.updateDates(),delete this.updating}}}},remove:function(){a.map(this.pickers,function(a){a.remove()}),delete this.element.data().datepicker}};var m=a.fn.datepicker,n=function(c){var d=Array.apply(null,arguments);d.shift();var e;if(this.each(function(){var b=a(this),f=b.data("datepicker"),g="object"==typeof c&&c;if(!f){var j=h(this,"date"),m=a.extend({},o,j,g),n=i(m.language),p=a.extend({},o,n,j,g);if(b.hasClass("input-daterange")||p.inputs){var q={inputs:p.inputs||b.find("input").toArray()};b.data("datepicker",f=new l(this,a.extend(p,q)))}else b.data("datepicker",f=new k(this,p))}"string"==typeof c&&"function"==typeof f[c]&&(e=f[c].apply(f,d))}),e===b||e instanceof k||e instanceof l)return this;if(this.length>1)throw new Error("Using only allowed for the collection of a single element ("+c+" function)");return e};a.fn.datepicker=n;var o=a.fn.datepicker.defaults={autoclose:!1,beforeShowDay:a.noop,beforeShowMonth:a.noop,beforeShowYear:a.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:2,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-(1/0),startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,container:"body",immediateUpdates:!1,title:""},p=a.fn.datepicker.locale_opts=["format","rtl","weekStart"];a.fn.datepicker.Constructor=k;var q=a.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},r={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(a){return a%4===0&&a%100!==0||a%400===0},getDaysInMonth:function(a,b){return[31,r.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(a){if("function"==typeof a.toValue&&"function"==typeof a.toDisplay)return a;var b=a.replace(this.validParts,"\x00").split("\x00"),c=a.match(this.validParts);if(!b||!b.length||!c||0===c.length)throw new Error("Invalid date format.");return{separators:b,parts:c}},parseDate:function(d,e,f){function g(){var a=this.slice(0,m[j].length),b=m[j].slice(0,a.length);return a.toLowerCase()===b.toLowerCase()}if(!d)return b;if(d instanceof Date)return d;if("string"==typeof e&&(e=r.parseFormat(e)),e.toValue)return e.toValue(d,e,f);var h,i,j,l=/([\-+]\d+)([dmwy])/,m=d.match(/([\-+]\d+)([dmwy])/g);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(d)){for(d=new Date,j=0;j<m.length;j++)switch(h=l.exec(m[j]),i=parseInt(h[1]),h[2]){case"d":d.setUTCDate(d.getUTCDate()+i);break;case"m":d=k.prototype.moveMonth.call(k.prototype,d,i);break;case"w":d.setUTCDate(d.getUTCDate()+7*i);break;case"y":d=k.prototype.moveYear.call(k.prototype,d,i)}return c(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),0,0,0)}m=d&&d.match(this.nonpunctuation)||[],d=new Date;var n,o,p={},s=["yyyy","yy","M","MM","m","mm","d","dd"],t={yyyy:function(a,b){return a.setUTCFullYear(b)},yy:function(a,b){return a.setUTCFullYear(2e3+b)},m:function(a,b){if(isNaN(a))return a;for(b-=1;0>b;)b+=12;for(b%=12,a.setUTCMonth(b);a.getUTCMonth()!==b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}};t.M=t.MM=t.mm=t.m,t.dd=t.d,d=c(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0);var u=e.parts.slice();if(m.length!==u.length&&(u=a(u).filter(function(b,c){return-1!==a.inArray(c,s)}).toArray()),m.length===u.length){var v;for(j=0,v=u.length;v>j;j++){if(n=parseInt(m[j],10),h=u[j],isNaN(n))switch(h){case"MM":o=a(q[f].months).filter(g),n=a.inArray(o[0],q[f].months)+1;break;case"M":o=a(q[f].monthsShort).filter(g),n=a.inArray(o[0],q[f].monthsShort)+1}p[h]=n}var w,x;for(j=0;j<s.length;j++)x=s[j],x in p&&!isNaN(p[x])&&(w=new Date(d),t[x](w,p[x]),isNaN(w)||(d=w))}return d},formatDate:function(b,c,d){if(!b)return"";if("string"==typeof c&&(c=r.parseFormat(c)),c.toDisplay)return c.toDisplay(b,c,d);var e={d:b.getUTCDate(),D:q[d].daysShort[b.getUTCDay()],DD:q[d].days[b.getUTCDay()],m:b.getUTCMonth()+1,M:q[d].monthsShort[b.getUTCMonth()],MM:q[d].months[b.getUTCMonth()],yy:b.getUTCFullYear().toString().substring(2),yyyy:b.getUTCFullYear()};e.dd=(e.d<10?"0":"")+e.d,e.mm=(e.m<10?"0":"")+e.m,b=[];for(var f=a.extend([],c.separators),g=0,h=c.parts.length;h>=g;g++)f.length&&b.push(f.shift()),b.push(e[c.parts[g]]);return b.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">&#171;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&#187;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};r.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+r.headTemplate+"<tbody></tbody>"+r.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+r.headTemplate+r.contTemplate+r.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+r.headTemplate+r.contTemplate+r.footTemplate+"</table></div></div>",a.fn.datepicker.DPGlobal=r,a.fn.datepicker.noConflict=function(){return a.fn.datepicker=m,this},a.fn.datepicker.version="1.5.0",a(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(b){var c=a(this);c.data("datepicker")||(b.preventDefault(),n.call(c,"show"))}),a(function(){n.call(a('[data-provide="datepicker-inline"]'))})}); !function(a){a.fn.datepicker.dates.ru={days:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],daysShort:["Вск","Пнд","Втр","Срд","Чтв","Птн","Суб"],daysMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],today:"Сегодня",clear:"Очистить",format:"dd.mm.yyyy",weekStart:1}}(jQuery); (function(e,i){"use strict";function t(t,a){var s=this;s.$el=e(t),s.el=t,s.id=o++,s.$el.bind("destroyed",e.proxy(s.teardown,s)),s.$clonedHeader=null,s.$originalHeader=null,s.isSticky=!1,s.hasBeenSticky=!1,s.leftOffset=null,s.topOffset=null,s.init=function(){s.options=e.extend({},n,a),s.$el.each(function(){var i=e(this);i.css("padding",0),s.$scrollableArea=e(s.options.scrollableArea),s.$originalHeader=e("thead:first",this),s.$clonedHeader=s.$originalHeader.clone(),i.trigger("clonedHeader."+l,[s.$clonedHeader]),s.$clonedHeader.addClass("tableFloatingHeader"),s.$clonedHeader.css("display","none"),s.$originalHeader.addClass("tableFloatingHeaderOriginal"),s.$originalHeader.after(s.$clonedHeader),s.$printStyle=e('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),e("head").append(s.$printStyle)}),s.updateWidth(),s.toggleHeaders(),s.bind()},s.destroy=function(){s.$el.unbind("destroyed",s.teardown),s.teardown()},s.teardown=function(){s.isSticky&&s.$originalHeader.css("position","static"),e.removeData(s.el,"plugin_"+l),s.unbind(),s.$clonedHeader.remove(),s.$originalHeader.removeClass("tableFloatingHeaderOriginal"),s.$originalHeader.css("visibility","visible"),s.$printStyle.remove(),s.el=null,s.$el=null},s.bind=function(){s.$scrollableArea.on("scroll."+l,s.toggleHeaders),s.isWindowScrolling()||(e(i).on("scroll."+l+s.id,s.setPositionValues),e(i).on("resize."+l+s.id,s.toggleHeaders)),s.$scrollableArea.on("resize."+l,s.toggleHeaders),s.$scrollableArea.on("resize."+l,s.updateWidth)},s.unbind=function(){s.$scrollableArea.off("."+l,s.toggleHeaders),s.isWindowScrolling()||(e(i).off("."+l+s.id,s.setPositionValues),e(i).off("."+l+s.id,s.toggleHeaders)),s.$scrollableArea.off("."+l,s.updateWidth),s.$el.off("."+l),s.$el.find("*").off("."+l)},s.toggleHeaders=function(){s.$el&&s.$el.each(function(){var i,t=e(this),l=s.isWindowScrolling()?isNaN(s.options.fixedOffset)?s.options.fixedOffset.outerHeight():s.options.fixedOffset:s.$scrollableArea.offset().top+(isNaN(s.options.fixedOffset)?0:s.options.fixedOffset),o=t.offset(),n=s.$scrollableArea.scrollTop()+l,a=s.$scrollableArea.scrollLeft(),d=s.isWindowScrolling()?n>o.top:l>o.top,r=(s.isWindowScrolling()?n:0)<o.top+t.height()-s.$clonedHeader.height()-(s.isWindowScrolling()?0:l);d&&r?(i=o.left-a+s.options.leftOffset,s.$originalHeader.css({position:"fixed","margin-top":0,left:i,"z-index":1}),s.isSticky=!0,s.leftOffset=i,s.topOffset=l,s.$clonedHeader.css("display",""),s.setPositionValues(),s.updateWidth()):s.isSticky&&(s.$originalHeader.css("position","static"),s.$clonedHeader.css("display","none"),s.isSticky=!1,s.resetWidth(e("td,th",s.$clonedHeader),e("td,th",s.$originalHeader)))})},s.isWindowScrolling=function(){return s.$scrollableArea[0]===i},s.setPositionValues=function(){var t=e(i).scrollTop(),l=e(i).scrollLeft();!s.isSticky||0>t||t+e(i).height()>e(document).height()||0>l||l+e(i).width()>e(document).width()||s.$originalHeader.css({top:s.topOffset-(s.isWindowScrolling()?0:t),left:s.leftOffset-(s.isWindowScrolling()?0:l)})},s.updateWidth=function(){if(s.isSticky){s.$originalHeaderCells||(s.$originalHeaderCells=e("th,td",s.$originalHeader)),s.$clonedHeaderCells||(s.$clonedHeaderCells=e("th,td",s.$clonedHeader));var i=s.getWidth(s.$clonedHeaderCells);s.setWidth(i,s.$clonedHeaderCells,s.$originalHeaderCells),s.$originalHeader.css("width",s.$clonedHeader.width())}},s.getWidth=function(i){var t=[];return i.each(function(i){var l,o=e(this);if("border-box"===o.css("box-sizing"))l=o.outerWidth();else{var n=e("th",s.$originalHeader);if("collapse"===n.css("border-collapse"))if(document.defaultView&&document.defaultView.getComputedStyle)l=parseFloat(document.defaultView.getComputedStyle(this,null).width);else{var a=parseFloat(o.css("padding-left")),d=parseFloat(o.css("padding-right")),r=parseFloat(o.css("border-width"));l=o.outerWidth()-a-d-r}else l=o.width()}t[i]=l}),t},s.setWidth=function(e,i,t){i.each(function(i){var l=e[i];t.eq(i).css({"min-width":l,"max-width":l})})},s.resetWidth=function(i,t){i.each(function(i){var l=e(this);t.eq(i).css({"min-width":l.css("min-width"),"max-width":l.css("max-width")})})},s.updateOptions=function(i){s.options=e.extend({},n,i),s.updateWidth(),s.toggleHeaders()},s.init()}var l="stickyTableHeaders",o=0,n={fixedOffset:0,leftOffset:0,scrollableArea:i};e.fn[l]=function(i){return this.each(function(){var o=e.data(this,"plugin_"+l);o?"string"==typeof i?o[i].apply(o):o.updateOptions(i):"destroy"!==i&&e.data(this,"plugin_"+l,new t(this,i))})}})(jQuery,window); /*
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */
var hexcase=0;function hex_md5(a){return rstr2hex(rstr_md5(str2rstr_utf8(a)))}function hex_hmac_md5(a,b){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function md5_vm_test(){return hex_md5("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function rstr_md5(a){return binl2rstr(binl_md5(rstr2binl(a),a.length*8))}function rstr_hmac_md5(c,f){var e=rstr2binl(c);if(e.length>16){e=binl_md5(e,c.length*8)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=binl_md5(a.concat(rstr2binl(f)),512+f.length*8);return binl2rstr(binl_md5(d.concat(g),512+128))}function rstr2hex(c){try{hexcase}catch(g){hexcase=0}var f=hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=f.charAt((a>>>4)&15)+f.charAt(a&15)}return b}function str2rstr_utf8(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function rstr2binl(b){var a=Array(b.length>>2);for(var c=0;c<a.length;c++){a[c]=0}for(var c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(c%32)}return a}function binl2rstr(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(c%32))&255)}return a}function binl_md5(p,k){p[k>>5]|=128<<((k)%32);p[(((k+64)>>>9)<<4)+14]=k;var o=1732584193;var n=-271733879;var m=-1732584194;var l=271733878;for(var g=0;g<p.length;g+=16){var j=o;var h=n;var f=m;var e=l;o=md5_ff(o,n,m,l,p[g+0],7,-680876936);l=md5_ff(l,o,n,m,p[g+1],12,-389564586);m=md5_ff(m,l,o,n,p[g+2],17,606105819);n=md5_ff(n,m,l,o,p[g+3],22,-1044525330);o=md5_ff(o,n,m,l,p[g+4],7,-176418897);l=md5_ff(l,o,n,m,p[g+5],12,1200080426);m=md5_ff(m,l,o,n,p[g+6],17,-1473231341);n=md5_ff(n,m,l,o,p[g+7],22,-45705983);o=md5_ff(o,n,m,l,p[g+8],7,1770035416);l=md5_ff(l,o,n,m,p[g+9],12,-1958414417);m=md5_ff(m,l,o,n,p[g+10],17,-42063);n=md5_ff(n,m,l,o,p[g+11],22,-1990404162);o=md5_ff(o,n,m,l,p[g+12],7,1804603682);l=md5_ff(l,o,n,m,p[g+13],12,-40341101);m=md5_ff(m,l,o,n,p[g+14],17,-1502002290);n=md5_ff(n,m,l,o,p[g+15],22,1236535329);o=md5_gg(o,n,m,l,p[g+1],5,-165796510);l=md5_gg(l,o,n,m,p[g+6],9,-1069501632);m=md5_gg(m,l,o,n,p[g+11],14,643717713);n=md5_gg(n,m,l,o,p[g+0],20,-373897302);o=md5_gg(o,n,m,l,p[g+5],5,-701558691);l=md5_gg(l,o,n,m,p[g+10],9,38016083);m=md5_gg(m,l,o,n,p[g+15],14,-660478335);n=md5_gg(n,m,l,o,p[g+4],20,-405537848);o=md5_gg(o,n,m,l,p[g+9],5,568446438);l=md5_gg(l,o,n,m,p[g+14],9,-1019803690);m=md5_gg(m,l,o,n,p[g+3],14,-187363961);n=md5_gg(n,m,l,o,p[g+8],20,1163531501);o=md5_gg(o,n,m,l,p[g+13],5,-1444681467);l=md5_gg(l,o,n,m,p[g+2],9,-51403784);m=md5_gg(m,l,o,n,p[g+7],14,1735328473);n=md5_gg(n,m,l,o,p[g+12],20,-1926607734);o=md5_hh(o,n,m,l,p[g+5],4,-378558);l=md5_hh(l,o,n,m,p[g+8],11,-2022574463);m=md5_hh(m,l,o,n,p[g+11],16,1839030562);n=md5_hh(n,m,l,o,p[g+14],23,-35309556);o=md5_hh(o,n,m,l,p[g+1],4,-1530992060);l=md5_hh(l,o,n,m,p[g+4],11,1272893353);m=md5_hh(m,l,o,n,p[g+7],16,-155497632);n=md5_hh(n,m,l,o,p[g+10],23,-1094730640);o=md5_hh(o,n,m,l,p[g+13],4,681279174);l=md5_hh(l,o,n,m,p[g+0],11,-358537222);m=md5_hh(m,l,o,n,p[g+3],16,-722521979);n=md5_hh(n,m,l,o,p[g+6],23,76029189);o=md5_hh(o,n,m,l,p[g+9],4,-640364487);l=md5_hh(l,o,n,m,p[g+12],11,-421815835);m=md5_hh(m,l,o,n,p[g+15],16,530742520);n=md5_hh(n,m,l,o,p[g+2],23,-995338651);o=md5_ii(o,n,m,l,p[g+0],6,-198630844);l=md5_ii(l,o,n,m,p[g+7],10,1126891415);m=md5_ii(m,l,o,n,p[g+14],15,-1416354905);n=md5_ii(n,m,l,o,p[g+5],21,-57434055);o=md5_ii(o,n,m,l,p[g+12],6,1700485571);l=md5_ii(l,o,n,m,p[g+3],10,-1894986606);m=md5_ii(m,l,o,n,p[g+10],15,-1051523);n=md5_ii(n,m,l,o,p[g+1],21,-2054922799);o=md5_ii(o,n,m,l,p[g+8],6,1873313359);l=md5_ii(l,o,n,m,p[g+15],10,-30611744);m=md5_ii(m,l,o,n,p[g+6],15,-1560198380);n=md5_ii(n,m,l,o,p[g+13],21,1309151649);o=md5_ii(o,n,m,l,p[g+4],6,-145523070);l=md5_ii(l,o,n,m,p[g+11],10,-1120210379);m=md5_ii(m,l,o,n,p[g+2],15,718787259);n=md5_ii(n,m,l,o,p[g+9],21,-343485551);o=safe_add(o,j);n=safe_add(n,h);m=safe_add(m,f);l=safe_add(l,e)}return Array(o,n,m,l)}function md5_cmn(h,e,d,c,g,f){return safe_add(bit_rol(safe_add(safe_add(e,h),safe_add(c,f)),g),d)}function md5_ff(g,f,k,j,e,i,h){return md5_cmn((f&k)|((~f)&j),g,f,e,i,h)}function md5_gg(g,f,k,j,e,i,h){return md5_cmn((f&j)|(k&(~j)),g,f,e,i,h)}function md5_hh(g,f,k,j,e,i,h){return md5_cmn(f^k^j,g,f,e,i,h)}function md5_ii(g,f,k,j,e,i,h){return md5_cmn(k^(f|(~j)),g,f,e,i,h)}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}function bit_rol(a,b){return(a<<b)|(a>>>(32-b))}; 
VKeyCode={VK_LBUTTON:0x01,VK_RBUTTON:0x02,VK_CANCEL:0x03,VK_MBUTTON:0x04,VK_BACK:0x08,VK_TAB:0x09,VK_CLEAR:0x0C,VK_RETURN:0x0D,VK_SHIFT:0x10,VK_CONTROL:0x11,VK_MENU:0x12,VK_PAUSE:0x13,VK_CAPITAL:0x14,VK_ESCAPE:0x1B,VK_SPACE:0x20,VK_PRIOR:0x21,VK_NEXT:0x22,VK_END:0x23,VK_HOME:0x24,VK_LEFT:0x25,VK_UP:0x26,VK_RIGHT:0x27,VK_DOWN:0x28,VK_SELECT:0x29,VK_PRINT:0x2A,VK_EXECUTE:0x2B,VK_SNAPSHOT:0x2C,VK_INSERT:0x2D,VK_DELETE:0x2E,VK_HELP:0x2F,VK_0:0x30,VK_1:0x31,VK_2:0x32,VK_3:0x33,VK_4:0x34,VK_5:0x35,VK_6:0x36,VK_7:0x37,VK_8:0x38,VK_9:0x39,VK_A:0x41,VK_B:0x42,VK_C:0x43,VK_D:0x44,VK_E:0x45,VK_F:0x46,VK_G:0x47,VK_H:0x48,VK_I:0x49,VK_J:0x4A,VK_K:0x4B,VK_L:0x4C,VK_M:0x4D,VK_N:0x4E,VK_O:0x4F,VK_P:0x50,VK_Q:0x51,VK_R:0x52,VK_S:0x53,VK_T:0x54,VK_U:0x55,VK_V:0x56,VK_W:0x57,VK_X:0x58,VK_Y:0x59,VK_Z:0x5A,VK_NUMPAD0:0x60,VK_NUMPAD1:0x61,VK_NUMPAD2:0x62,VK_NUMPAD3:0x63,VK_NUMPAD4:0x64,VK_NUMPAD5:0x65,VK_NUMPAD6:0x66,VK_NUMPAD7:0x67,VK_NUMPAD8:0x68,VK_NUMPAD9:0x69,VK_SEPARATOR:0x6C,VK_SUBTRACT:0x6D,VK_DECIMAL:0x6E,VK_DIVIDE:0x6F,VK_F1:0x70,VK_F2:0x71,VK_F3:0x72,VK_F4:0x73,VK_F5:0x74,VK_F6:0x75,VK_F7:0x76,VK_F8:0x77,VK_F9:0x78,VK_F10:0x79,VK_F11:0x7A,VK_F12:0x7B,VK_NUMLOCK:0x90,VK_SCROLL:0x91,VK_LSHIFT:0xA0,VK_RSHIFT:0xA1,VK_LCONTROL:0xA2,VK_RCONTROL:0xA3,VK_LMENU:0xA4,VK_RMENU:0xA5,VK_PLAY:0xFA,VK_ZOOM:0xFB,VK_OEM_MINUS:0xBD,VK_OEM_PERIOD:0xBE}; 
function __EnableKeys(evt,keyCodes)
{for(var i=0;i<keyCodes.length;i++)
{if(parseInt(keyCodes[i],10)==__GetKeyCode(evt))
return true;}
if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;}
function __DisableKeys(evt,keyCodes)
{for(var i=0;i<keyCodes.length;i++)
{if(parseInt(keyCodes[i],10)==__GetKeyCode(evt))
{if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;}}
return true;}
function __SaveKeyCode(evt)
{var obj=evt.srcElement==null?evt.target:evt.srcElement;obj.setAttribute("keyCode",evt.keyCode);}
function __GetKeyCode(evt)
{var obj=evt.srcElement==null?evt.target:evt.srcElement;return parseInt(obj.getAttribute("keyCode"),10);}
function __GetCursorStartPos(evt)
{var obj=evt.srcElement==null?evt.target:evt.srcElement;var nPosition=parseInt(obj.getAttribute("position"),10);if(nPosition>=0)
return nPosition;if(document.selection!=null)
{var cur=document.selection.createRange();var pos=0;if(obj&&cur)
{var tr=obj.createTextRange();if(tr)
{while(cur.compareEndPoints("StartToStart",tr)>0)
{tr.moveStart("character",1);pos++;}
return pos;}}
return-1;}
else if(obj.selectionStart!=null)
{return obj.selectionStart;}
else
{return-1;}}
function __GetCursorEndPos(evt)
{var obj=evt.srcElement==null?evt.target:evt.srcElement;var nPosition=parseInt(obj.getAttribute("position"),10);if(nPosition>=0)
return nPosition;if(document.selection!=null)
{var cur=document.selection.createRange();var pos=0;if(obj&&cur)
{var tr=obj.createTextRange();if(tr)
{while(cur.compareEndPoints("EndToStart",tr)>0)
{tr.moveStart("character",1);pos++;}
return pos;}}
return-1;}
else if(obj.selectionStart!=null)
{return obj.selectionEnd;}
else
{return-1;}}
function __SetCursorPosition(evt)
{var obj=evt.srcElement==null?evt.target:evt.srcElement;var nPosition=parseInt(obj.getAttribute("position"),10);if(nPosition<0)
return true;obj.setAttribute("position",-1);if(document.selection!=null)
{var cur=document.selection.createRange();var pos=0;if(obj&&cur)
{var range=obj.createTextRange();range.move("character",nPosition);range.select();return true;}}
else if(obj.selectionStart!=null)
{obj.setSelectionRange(nPosition,nPosition);obj.selectionStart=nPosition;obj.selectionEnd=nPosition;}
else
{window.status="Unsupport browser!";}
return true;}
function __ReplaceText(evt,strText,nStart,nEnd)
{var obj=evt.srcElement==null?evt.target:evt.srcElement;if(document.all)
{var tr=obj.createTextRange();tr.moveEnd("character",nEnd-obj.value.length);tr.moveStart("character",nStart);tr.text=strText;tr.select();}
else
{var strBefore=obj.value.substr(0,nStart);var strSelected=obj.value.substr(nStart,(nEnd-nStart));var strAfter=obj.value.substr(nEnd,(obj.value.length-nEnd));obj.value=strBefore+strText+strAfter;}} 
String.prototype.trimLeft=function()
{return this.replace(/(^\s*)/g,"");}
String.prototype.trimRight=function()
{return this.replace(/(\s*$)/g,"");}
String.prototype.trim=function()
{return this.replace(/(^\s*)|(\s*$)/g,"");} 
InputType={NonnegativeInteger:0,WholeNumber:1,Currency:2,Float:3};function RemoveTextbox(ctrl){if(ctrl.f_onkeydown){EventHandler.removeEvent(ctrl,"keydown",ctrl.f_onkeydown);ctrl.f_onkeydown=undefined;}
if(ctrl.f_onkeypress){EventHandler.removeEvent(ctrl,"keypress",ctrl.f_onkeypress);ctrl.f_onkeypress=undefined;}
if(ctrl.f_onblur){EventHandler.removeEvent(ctrl,"blur",ctrl.f_onblur);ctrl.f_onfocus=undefined;}}
function InitializeTextbox(ctrl,emType,floatPrecision,unsigned){var obj=typeof(ctrl)=="string"?document.getElementById(ctrl):ctrl;if(obj==null)
{alert("Error:ctrl {"+ctrl+"} does not exist!");return false;}
RemoveTextbox(obj);obj.f_onkeydown=function(event){__SaveKeyCode(event);}
EventHandler.addEvent(obj,"keydown",obj.f_onkeydown);if(document.all)
{obj.setAttribute("autocomplete","off");obj.onpaste=function(){return false;};obj.ondrag=function(){return false;};obj.ondrop=function(){return false;};}
unsigned=(unsigned!=undefined)?unsigned:true;switch(emType)
{case InputType.NonnegativeInteger:obj.f_onkeypress=function(event){return __AcceptNonnegativeInteger(event);}
break;case InputType.WholeNumber:obj.f_onkeypress=function(event){return __AcceptWholeNumber(event);}
break;case InputType.FloatNumber:obj.f_onkeypress=function(event){return __AcceptFloatNumber(event,floatPrecision,unsigned);}
if(floatPrecision){obj.f_onblur=function(p){return function(){var frac_zer="000000000000000".substring(0,floatPrecision);if(p.value.length==0)
p.value="0."+frac_zer;else{var nIndex=p.value.indexOf('.');if(nIndex==0){p.value="0"+p.value;p.value=p.value.substring(0,nIndex+floatPrecision+1);}
else if(nIndex>0){p.value=p.value.substring(0,nIndex+floatPrecision+1);}
else{p.value=p.value+"."+frac_zer;}
var offset=p.value.length-p.value.lastIndexOf('.')-1;for(var k=offset;k<floatPrecision;k++){p.value=p.value+"0";};}};};}
break;case InputType.Currency:obj.f_onkeypress=function(event){return __AcceptCurrency(event,2,unsigned);}
obj.f_onblur=function(p){return function(){if(p.value.length==0)
p.value="0.00";else
{var nIndex=p.value.indexOf('.');if(nIndex==0)
{p.value="0"+p.value;p.value=p.value.substring(0,nIndex+3);}
else if(nIndex>0)
{p.value=p.value.substring(0,nIndex+3);}
else
{p.value=p.value+".00";}
var offset=p.value.length-p.value.lastIndexOf('.')-1;for(var k=offset;k<2;k++)
{p.value=p.value+"0";};}};};break;default:alert("Error:unknown input type {"+emType+"}!");return false;};if(obj.f_onkeypress){EventHandler.addEvent(obj,"keypress",obj.f_onkeypress);}
if(obj.f_onblur){EventHandler.addEvent(obj,"blur",obj.f_onblur);}
return true;}
function __AcceptNonnegativeInteger(evt)
{if(evt.shiftKey)
{__EnableKeys(evt,[VKeyCode.VK_LEFT,VKeyCode.VK_RIGHT,VKeyCode.VK_BACK,VKeyCode.VK_DELETE,VKeyCode.VK_NUMLOCK,VKeyCode.VK_HOME,VKeyCode.VK_END,VKeyCode.VK_TAB]);}
else{__EnableKeys(evt,[VKeyCode.VK_0,VKeyCode.VK_1,VKeyCode.VK_2,VKeyCode.VK_3,VKeyCode.VK_4,VKeyCode.VK_5,VKeyCode.VK_6,VKeyCode.VK_7,VKeyCode.VK_8,VKeyCode.VK_9,VKeyCode.VK_NUMPAD0,VKeyCode.VK_NUMPAD1,VKeyCode.VK_NUMPAD2,VKeyCode.VK_NUMPAD3,VKeyCode.VK_NUMPAD4,VKeyCode.VK_NUMPAD5,VKeyCode.VK_NUMPAD6,VKeyCode.VK_NUMPAD7,VKeyCode.VK_NUMPAD8,VKeyCode.VK_NUMPAD9,VKeyCode.VK_LEFT,VKeyCode.VK_RIGHT,VKeyCode.VK_BACK,VKeyCode.VK_DELETE,VKeyCode.VK_NUMLOCK,VKeyCode.VK_HOME,VKeyCode.VK_END,VKeyCode.VK_TAB]);}}
function __AcceptWholeNumber(evt)
{var obj=evt.srcElement==null?evt.target:evt.srcElement;var key_code=__GetKeyCode(evt);if(evt.ctrlKey&&(key_code==67||key_code==90)){return true;}
else if(evt.ctrlKey&&key_code==86){obj.select();return true;}
if(key_code==VKeyCode.VK_SUBTRACT||key_code==VKeyCode.VK_OEM_MINUS||key_code==173){if(__GetCursorStartPos(evt)==0&&__GetCursorEndPos(evt)==0&&obj.value.indexOf('-')<0&&!evt.shiftKey){return true;};if(__GetCursorStartPos(evt)==0&&__GetCursorEndPos(evt)>0&&!evt.shiftKey){return true;};if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;}
return __AcceptNonnegativeInteger(evt);}
function __AcceptFloatNumber(evt,floatPrecision,unsigned)
{return __AcceptCurrency(evt,floatPrecision,unsigned);}
function __AcceptCurrency(evt,floatPrecision,unsigned){var obj=evt.srcElement==null?evt.target:evt.srcElement;var sep_ind=obj.value.indexOf('.');var evt_key_code=__GetKeyCode(evt);if(evt_key_code==VKeyCode.VK_OEM_PERIOD||evt_key_code==VKeyCode.VK_DECIMAL||evt_key_code==191||evt_key_code==110||evt_key_code==190){if(sep_ind<0){obj.value=obj.value+'.';evt.returnValue=false;if(evt.preventDefault){evt.preventDefault();}
return false;}
if(sep_ind>=0)
{if(__GetCursorStartPos(evt)<=sep_ind&&__GetCursorEndPos(evt)>=sep_ind)
{return true;};if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;}
else{return true;}}
else if((evt_key_code>=VKeyCode.VK_0)&&sep_ind>=0&&!selectedText(obj)&&(obj.value.length+1-sep_ind-1)>floatPrecision){if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;}
if(unsigned){return __AcceptNonnegativeInteger(evt);}
else{return __AcceptWholeNumber(evt);}} 
var UPPER="\n";var LOWER="\r";var NUM="\t";function RemoveMaskEdit(ctrl){if(ctrl.f_onkeydown){EventHandler.removeEvent(ctrl,"keydown",ctrl.f_onkeydown);ctrl.f_onkeydown=undefined;}
if(ctrl.f_onkeyup){EventHandler.removeEvent(ctrl,"keyup",ctrl.f_onkeyup);ctrl.f_onkeyup=undefined;}
if(ctrl.f_onkeypress){EventHandler.removeEvent(ctrl,"keypress",ctrl.f_onkeypress);ctrl.f_onkeypress=undefined;}
if(ctrl.f_onfocus){EventHandler.removeEvent(ctrl,"focus",ctrl.f_onfocus);ctrl.f_onfocus=undefined;}}
function InitializeMaskEdit(ctrl,strMaskPattern)
{var strTemp=strMaskPattern;strMaskPattern="";for(var i=0;i<strTemp.length;i++)
{if(strTemp.charAt(i)=='$')
{i++;if(strTemp.charAt(i)=='$')
strMaskPattern+="$";else
{if(strTemp.charAt(i)=='A')
strMaskPattern+=UPPER;else if(strTemp.charAt(i)=='a')
strMaskPattern+=LOWER;else if(strTemp.charAt(i)=='d')
strMaskPattern+=NUM;else
alert("Unknown escape character {$"+strTemp.charAt(i)+"}");}}
else
{strMaskPattern+=strTemp.charAt(i);}}
var obj=typeof(ctrl)=="string"?document.getElementById(ctrl):ctrl;if(obj==null)
{alert("Error:ctrl {"+ctrl+"} does not exist!");return false;}
var strValue=obj.value;obj.setAttribute("maskPattern",strMaskPattern);obj.value="";for(var i=0;i<strMaskPattern.length;i++)
{if(strMaskPattern.charCodeAt(i)==UPPER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==LOWER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==NUM.charCodeAt(0))
{obj.value+=strValue.length>i?strValue.charAt(i):"_";continue;}
obj.value+=strMaskPattern.charAt(i);}
RemoveMaskEdit(obj);obj.f_onkeydown=function(evt){__MaskEditDispatcher(evt);};EventHandler.addEvent(obj,"keydown",obj.f_onkeydown);obj.f_onkeyup=function(evt){__SetCursorPosition(evt);};EventHandler.addEvent(obj,"keyup",obj.f_onkeyup);obj.f_onkeypress=function(evt){__OnMaskEditUpdated(evt);};EventHandler.addEvent(obj,"keypress",obj.f_onkeypress);obj.f_onfocus=function(evt){__OnMaskEditFocus(evt);};EventHandler.addEvent(obj,"focus",obj.f_onfocus);obj.setAttribute("position",-1);if(document.all)
{obj.setAttribute("autocomplete","off");}}
function __OnMaskEditFocus(evt)
{var obj=evt.srcElement==null?evt.target:evt.srcElement;var strValue=obj.value;for(var i=0;i<strValue.length;i++)
{if(strValue.charCodeAt(i)=="_".charCodeAt(0))
{obj.setAttribute("position",i);__SetCursorPosition(evt);return true;}}
return true;}
function __MaskEditDispatcher(evt)
{__SaveKeyCode(evt);switch(__GetKeyCode(evt))
{case VKeyCode.VK_DELETE:__OnMaskEditDelKey(evt);break;case VKeyCode.VK_BACK:__OnMaskEditBackKey(evt);break;default:break;}}
function __OnMaskEditBackKey(evt)
{var obj=evt.srcElement==null?evt.target:evt.srcElement;var strMaskPattern=obj.getAttribute("maskPattern");var nStart=__GetCursorStartPos(evt);var nEnd=__GetCursorEndPos(evt);if(nStart!=nEnd)
{__OnMaskEditDelKey(evt);}
else
{for(var i=nStart-1;i>=0;i--)
{if(strMaskPattern.charCodeAt(i)==UPPER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==LOWER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==NUM.charCodeAt(0))
{__ReplaceText(evt,"_",i,i+1);obj.setAttribute("position",i);break;}}}
if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;}
function __OnMaskEditDelKey(evt)
{var obj=evt.srcElement==null?evt.target:evt.srcElement;var strMaskPattern=obj.getAttribute("maskPattern");var strValue="";var nStart=__GetCursorStartPos(evt);var nEnd=__GetCursorEndPos(evt);if(nStart!=nEnd)
{for(var i=nStart;i<nEnd;i++)
{if(strMaskPattern.charCodeAt(i)==UPPER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==LOWER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==NUM.charCodeAt(0))
{strValue+="_";continue;}
strValue+=strMaskPattern.charAt(i);}
__ReplaceText(evt,strValue,nStart,nEnd);obj.setAttribute("position",nStart);}
else
{for(var i=nStart;i<strMaskPattern.length;i++)
{if(strMaskPattern.charCodeAt(i)==UPPER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==LOWER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==NUM.charCodeAt(0))
{__ReplaceText(evt,"_",i,i+1);break;}}}
if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;}
function __OnMaskEditUpdated(evt)
{var key_code=__GetKeyCode(evt);var obj=evt.srcElement==null?evt.target:evt.srcElement;if(evt.ctrlKey&&(key_code==67||key_code==90)){return true;}
else if(evt.ctrlKey&&key_code==86){obj.select();return true;}
if(key_code==VKeyCode.VK_LEFT||key_code==VKeyCode.VK_RIGHT||key_code==VKeyCode.VK_NUMLOCK||key_code==VKeyCode.VK_HOME||key_code==VKeyCode.VK_END||key_code==VKeyCode.VK_TAB||key_code==VKeyCode.VK_LEFT)
{return true;}
var strMaskPattern=obj.getAttribute("maskPattern");var nStart=__GetCursorStartPos(evt);var nEnd=__GetCursorEndPos(evt);if(nStart!=nEnd)
{__OnMaskEditDelKey(evt);nStart=__GetCursorStartPos(evt);}
var nIndex=-1;for(var i=nStart;i<strMaskPattern.length;i++)
{if(strMaskPattern.charCodeAt(i)==UPPER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==LOWER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==NUM.charCodeAt(0))
{nIndex=i;break;}}
if(nIndex==-1)
{if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;}
if(strMaskPattern.charCodeAt(nIndex)==UPPER.charCodeAt(0)||strMaskPattern.charCodeAt(nIndex)==LOWER.charCodeAt(0))
{if(!__EnableKeys(evt,[VKeyCode.VK_A,VKeyCode.VK_B,VKeyCode.VK_C,VKeyCode.VK_D,VKeyCode.VK_E,VKeyCode.VK_F,VKeyCode.VK_G,VKeyCode.VK_H,VKeyCode.VK_I,VKeyCode.VK_J,VKeyCode.VK_K,VKeyCode.VK_L,VKeyCode.VK_M,VKeyCode.VK_N,VKeyCode.VK_O,VKeyCode.VK_P,VKeyCode.VK_Q,VKeyCode.VK_R,VKeyCode.VK_S,VKeyCode.VK_T,VKeyCode.VK_U,VKeyCode.VK_V,VKeyCode.VK_W,VKeyCode.VK_X,VKeyCode.VK_Y,VKeyCode.VK_Z,]))
{if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;}}
else if(strMaskPattern.charCodeAt(nIndex)==NUM.charCodeAt(0))
{if(!__EnableKeys(evt,[VKeyCode.VK_0,VKeyCode.VK_1,VKeyCode.VK_2,VKeyCode.VK_3,VKeyCode.VK_4,VKeyCode.VK_5,VKeyCode.VK_6,VKeyCode.VK_7,VKeyCode.VK_8,VKeyCode.VK_9,VKeyCode.VK_NUMPAD0,VKeyCode.VK_NUMPAD1,VKeyCode.VK_NUMPAD2,VKeyCode.VK_NUMPAD3,VKeyCode.VK_NUMPAD4,VKeyCode.VK_NUMPAD5,VKeyCode.VK_NUMPAD6,VKeyCode.VK_NUMPAD7,VKeyCode.VK_NUMPAD8,VKeyCode.VK_NUMPAD9,])||evt.shiftKey)
{if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;}}
var strChar=String.fromCharCode(evt.keyCode==0?evt.which:evt.keyCode);if(strMaskPattern.charCodeAt(nIndex)==UPPER.charCodeAt(0))
strChar=strChar.toUpperCase();else if(strMaskPattern.charCodeAt(nIndex)==LOWER.charCodeAt(0))
strChar=strChar.toLowerCase();__ReplaceText(evt,strChar,nIndex,nIndex+1);var bLast=true;for(var i=nIndex+1;i<strMaskPattern.length;i++)
{if(strMaskPattern.charCodeAt(i)==UPPER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==LOWER.charCodeAt(0)||strMaskPattern.charCodeAt(i)==NUM.charCodeAt(0))
{nIndex=i;bLast=false;break;}}
obj.setAttribute("position",bLast?nIndex+1:nIndex);if(obj.selectionStart!=null)
{obj.selectionStart=bLast?nIndex+1:nIndex;obj.selectionEnd=bLast?nIndex+1:nIndex;}
if(evt.preventDefault){evt.preventDefault();}
evt.returnValue=false;return false;} 
function InitializeTrimBox(ctrl)
{if(ctrl!=null)
{var obj=typeof(ctrl)=="string"?document.getElementById(ctrl):ctrl;if(obj==null)
{alert("Error:ctrl {"+ctrl+"} does not exist!");return false;}
__TrimBoxAddEventHandler(obj);return true;}
var aryObject=document.getElementsByTagName("input");for(var i=0;i<aryObject.length;i++)
{var obj=aryObject[i];__TrimBoxAddEventHandler(obj);}
return true;}
function __TrimBoxAddEventHandler(obj)
{if(obj.type!="text")
return;obj.f_onchange=function(p)
{return function()
{p.value=p.value.trim();};};EventHandler.addEvent(obj,"change",obj.f_onchange);} 
function RemoveTipBox(ctrl){if(ctrl.f_onfocus){EventHandler.removeEvent(ctrl,"focus",ctrl.f_onfocus);ctrl.f_onfocus=undefined;}
if(ctrl.f_onblur){EventHandler.removeEvent(ctrl,"blur",ctrl.f_onblur);ctrl.f_onfocus=undefined;}}
function InitializeTipBox(ctrl,strTip)
{var obj=typeof(ctrl)=="string"?document.getElementById(ctrl):ctrl;if(obj==null)
{alert("Error:ctrl {"+ctrl+"} does not exist!");return false;}
obj.outerHTML+="<input type='text' id='"+ctrl+"_brother'/>";obj=document.getElementById(ctrl);var objBrother=document.getElementById(ctrl+"_brother");__CloneStyle(obj.style,objBrother.style);objBrother.className=obj.className;objBrother.disabled=obj.disabled;objBrother.size=obj.size;objBrother.style.color="#666666";objBrother.value=strTip;RemoveTipBox(objBrother);obj.f_onfocus=function(p)
{return function()
{var obj=document.getElementById(ctrl);var objBrother=document.getElementById(ctrl+"_brother");obj.style.display="";objBrother.style.display="none";obj.focus();};};EventHandler.addEvent(obj,"focus",obj.f_onfocus);obj.f_onfocus=function(p)
{return function()
{var obj=document.getElementById(ctrl);var objBrother=document.getElementById(ctrl+"_brother");if(obj.value.length>0)
return;objBrother.style.display="";obj.style.display="none";};};EventHandler.addEvent(obj,"blur",obj.f_ononblur);if(obj.value.length==0)
{obj.style.display="none";objBrother.style.display="";}
else
{obj.style.display="";objBrother.style.display="none";}}
function __CloneStyle(objSrc,objDest)
{for(obj in objSrc)
{if(obj==null||objSrc[obj]==null||objSrc[obj]==""||obj=="display")
{continue;}
if(typeof(obj)=='function')
continue;try
{objDest[obj]=objSrc[obj];}
catch(e){}}} 
function extend(Child,Parent){var F=function(){};F.prototype=Parent.prototype;Child.prototype=new F();Child.prototype.constructor=Child;Child.superclass=Parent.prototype;}
function nd(x,docum){if(docum==undefined){docum=window.document;}
return(x)?docum.getElementById(x):null;}
function findPosX(obj){var curleft=0;if(obj.offsetParent){while(1){curleft+=obj.offsetLeft;if(!obj.offsetParent){break;}
obj=obj.offsetParent;}}else if(obj.x){curleft+=obj.x;}
return curleft;}
function findPosY(obj){var curtop=0;if(obj.offsetParent){while(1){curtop+=obj.offsetTop;if(!obj.offsetParent){break;}
obj=obj.offsetParent;}}else if(obj.y){curtop+=obj.y;}
return curtop;}
function findPos(obj){var curleft=curtop=0;if(obj.offsetParent){do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop;}while(obj=obj.offsetParent);}
return[curleft,curtop];}
function getViewportHeight(){if(window.innerHeight!=window.undefined)return window.innerHeight;if(document.compatMode=='CSS1Compat')return document.documentElement.clientHeight;if(document.body)return document.body.clientHeight;return window.undefined;}
function getViewportWidth(){var offset=17;var width=null;if(window.innerWidth!=window.undefined)return window.innerWidth;if(document.compatMode=='CSS1Compat')return document.documentElement.clientWidth;if(document.body)return document.body.clientWidth;}
function format(str,params){return str.replace("%s",params[0]);}
function isEmpty(x,p){for(p in x)return!1;return!0;};function isIE(){return(navigator.appName=="Microsoft Internet Explorer");}
function createRequestObject(){var request_o;if(isIE()){request_o=new ActiveXObject("Microsoft.XMLHTTP");}
else{request_o=new XMLHttpRequest();}
return request_o;}
function clone(obj){return $.extend(true,{},obj);}
function clone2(obj){if(obj===null||typeof(obj)!=='object'||'isActiveClone'in obj)
return obj;if(obj instanceof Date)
var temp=new obj.constructor();else
var temp=obj.constructor();for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){obj['isActiveClone']=null;temp[key]=clone(obj[key]);delete obj['isActiveClone'];}}
return temp;}
function uuid()
{var chars='0123456789abcdef'.split('');var uuid=[],rnd=Math.random,r;uuid[8]=uuid[13]=uuid[18]=uuid[23]='-';uuid[14]='4';for(var i=0;i<36;i++)
{if(!uuid[i])
{r=0|rnd()*16;uuid[i]=chars[(i==19)?(r&0x3)|0x8:r&0xf];}}
return uuid.join('');}
function minToStr(min){var h=Math.floor(min/60);var m=min%60;h=((h<10)?'0':'')+h;m=((m<10)?'0':'')+m;return(h+':'+m);}
function array2json(arr){return JSON.stringify(arr);}
function json2obj(json_string){return JSON.parse(json_string);}
function toFloat(v){var r=parseFloat(v);return((isNaN(r))?0:r);}
function toInt(v){var r=parseInt(v);return((isNaN(r))?0:r);}
function selectedText(input){var startPos=input.selectionStart;var endPos=input.selectionEnd;var doc=document.selection;if(doc&&doc.createRange().text.length!=0){return(doc.createRange().text);}
else if(!doc&&input.value.substring(startPos,endPos).length!=0){return(input.value.substring(startPos,endPos));}}
function getBrowser(){var res="unknown";if(navigator.userAgent.indexOf("Chrome")!=-1){res="chrome";}
else if(navigator.userAgent.indexOf("Opera")!=-1){res="opera";}
else if(navigator.userAgent.indexOf("Firefox")!=-1){res="firefox";}
else if((navigator.userAgent.indexOf("MSIE")!=-1)||(!!document.documentMode==true)){res="ie";}
return res;}
function is_array(o){return(Object.prototype.toString.call(o)==='[object Array]');}
function get_bs_col(){return BS_COL;}
function numberFormat(number,decimals,dec_point,thousands_sep){var i,j,kw,kd,km;if(isNaN(decimals=Math.abs(decimals))){decimals=2;}
if(dec_point==undefined){dec_point=",";}
if(thousands_sep==undefined){thousands_sep=".";}
i=parseInt(number=(+number||0).toFixed(decimals))+"";if((j=i.length)>3){j=j%3;}else{j=0;}
km=(j?i.substr(0,j)+thousands_sep:"");kw=i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+thousands_sep);kd=(decimals?dec_point+Math.abs(number-i).toFixed(decimals).replace(/-/,0).slice(2):"");return km+kw+kd;} 
var DateHandler={addZeroTodate:function(arg){var s=arg.toString();return((s.length<2)?'0':'')+s;},timeToSeconds:function(timeStr){if(timeStr==undefined){return 0;}
var h,m;var time_ar=timeStr.split(":");var h=0;var m=0;var s=0;if(time_ar.length>=1){h=parseInt(time_ar[0][0],10)*10+
parseInt(time_ar[0][1],10)}
if(time_ar.length>=2){m=parseInt(time_ar[1][0],10)*10+
parseInt(time_ar[1][1],10)}
if(time_ar.length>=3){s=parseInt(time_ar[2][0],10)*10+
parseInt(time_ar[2][1],10)}
return(h*60*60+m*60+s);},timeToMS:function(timeStr){if(timeStr==undefined){return 0;}
var h,m;var time_ar=timeStr.split(":");var h=0;var m=0;var s=0;if(time_ar.length>=1){h=parseInt(time_ar[0][0],10)*10+
parseInt(time_ar[0][1],10);}
if(time_ar.length>=2){m=parseInt(time_ar[1][0],10)*10+
parseInt(time_ar[1][1],10);}
if(time_ar.length>=3){s=parseInt(time_ar[2][0],10)*10+
parseInt(time_ar[2][1],10);}
return(h*60*60*1000+m*60*1000+s*1000);},dateToStr:function(dt,pattern){if(dt==undefined){dt=new Date();}
if(pattern!=undefined){var mon_str=[];mon_str[0]="Января";mon_str[1]="Февраля";mon_str[2]="Марта";mon_str[3]="Апреля";mon_str[4]="Мая";mon_str[5]="Июня";mon_str[6]="Июля";mon_str[7]="Августа";mon_str[8]="Сентября";mon_str[9]="Октября";mon_str[10]="Ноября";mon_str[11]="Декабря";var s=pattern.replace(/dd/,this.addZeroTodate(dt.getDate()));s=s.replace(/d/,dt.getDate());s=s.replace(/M/,mon_str[dt.getMonth()]);s=s.replace(/mmin/,this.addZeroTodate(dt.getMinutes()));s=s.replace(/mm/,this.addZeroTodate(dt.getMonth()+1));s=s.replace(/min/,dt.getMinutes());s=s.replace(/m/,dt.getMonth()+1);s=s.replace(/yy/,dt.getFullYear());s=s.replace(/y/,dt.getFullYear()-2000);s=s.replace(/hh/,this.addZeroTodate(dt.getHours()));s=s.replace(/ss/,this.addZeroTodate(dt.getSeconds()));return s;}},getLastDateOfMonth:function(theYear,theMonth){if(theYear==undefined||theMonth==undefined){var d=new Date();theMonth=(theMonth==undefined)?d.getMonth():theMonth;theYear=(theYear==undefined)?d.getFullYear():theYear;}
var last_day=this.getMonthLen(theYear,theMonth);return new Date(theYear,theMonth,last_day,23,59,59,999);},getEndOfDate:function(date){if(date==undefined){date=new Date();}
return new Date(date.getFullYear(),date.getMonth(),date.getDate(),23,59,59,999);},getStartOfDate:function(date){if(!date){date=new Date();}
return new Date(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0,0);},getFirstDateOfMonth:function(theYear,theMonth){if(theYear==undefined||theMonth==undefined){var d=new Date();theMonth=(theMonth==undefined)?d.getMonth():theMonth;theYear=(theYear==undefined)?d.getFullYear():theYear;}
return new Date(theYear,theMonth,1);},getFirstDateOfQuater:function(theYear,theMonth){if(theYear==undefined||theMonth==undefined){var d=new Date();theMonth=(theMonth==undefined)?0:theMonth;theYear=(theYear==undefined)?d.getFullYear():theYear;}
if(theMonth==1||theMonth==2){theMonth=0;}
else if(theMonth==4||theMonth==5){theMonth=3;}
else if(theMonth==7||theMonth==8){theMonth=6;}
else if(theMonth==10||theMonth==11){theMonth=9;};return new Date(theYear,theMonth,1);},getLastDateOfQuater:function(theYear,theMonth){if(theYear==undefined||theMonth==undefined){var d=new Date();theMonth=(theMonth==undefined)?0:theMonth;theYear=(theYear==undefined)?d.getFullYear():theYear;}
if(theMonth==0||theMonth==1){theMonth=2;}
else if(theMonth==3||theMonth==4){theMonth=5;}
else if(theMonth==6||theMonth==7){theMonth=8;}
else if(theMonth==9||theMonth==10){theMonth=11;};var last_day=this.getMonthLen(theYear,theMonth);return new Date(theYear,theMonth,last_day,23,59,59,999);},getFirstDay:function(theYear,theMonth){var firstDate=this.getFirstDateOfMonth(theYear,theMonth);var day=firstDate.getDay();day--;if(day<0)day=6;return day;},getMonthLen:function(theYear,theMonth){var oneDay=1000*60*60*24;var thisMonth=new Date(theYear,theMonth,1);var nextMonth=new Date(theYear,theMonth+1,1);var len=Math.ceil((nextMonth.getTime()-
thisMonth.getTime())/oneDay);return len;},str_replace_delim:function(str,delim_ar,new_delim){if(str&&str.length){for(var i=0;i<delim_ar.length;i++){while(str.search(delim_ar[i])>=00){str=str.replace(delim_ar[i],new_delim);}}}
return str;},strToDate:function(date_str){var SHORT_YEAR_LEN=8;var FULL_YEAR_LEN=10;var time=new Array(0,0,0);var date=new Array(0,0,0);var time_part='',date_part='';var TIME_DELIM=':';var DATE_DELIM='.';var PARTS_DELIM=' ';var date_str_copy=DateHandler.str_replace_delim(date_str,new Array(/T/),PARTS_DELIM);var separ=date_str_copy.indexOf(PARTS_DELIM);if(separ>=0){time_part=date_str_copy.substr(separ+1);date_part=date_str_copy.slice(0,separ);}
else{date_part=date_str_copy;}
date_part=DateHandler.str_replace_delim(date_part,new Array(/\//,/-/,/:/),DATE_DELIM);time_part=DateHandler.str_replace_delim(time_part,new Array(/ /,/-/,/\//),TIME_DELIM);if(date_part.length>0){date=date_part.split(DATE_DELIM);}
if(time_part.length>0){time=time_part.split(TIME_DELIM);}
if(date[2].length==2){date[2]=parseInt(date[2],10)+2000;}
if(time[2]==undefined){time[2]=0;}
date[1]=(date[1]==0)?0:date[1]-1;return new Date(date[2],date[1],date[0],time[0],time[1],time[2]);},dateObjFromSQL:function(date_str){var time=new Array(0,0,0);var date=new Array(0,0,0);var TIME_DELIM=':';var DATE_DELIM='.';var PARTS_DELIM=' ';var str=DateHandler.str_replace_delim(date_str,new Array(/T/),PARTS_DELIM);var separ=str.indexOf(PARTS_DELIM);if(separ>=0){time=str.substr(separ+1).split(TIME_DELIM);str=date_str.substr(0,separ);}
str=DateHandler.str_replace_delim(str,new Array(/-/),DATE_DELIM);date=str.split(DATE_DELIM);return new Date(date[0],(date[1]==0)?0:date[1]-1,date[2],time[0],time[1],time[2]);},weekStart:function(d){return new Date(d.getFullYear(),d.getMonth(),d.getDate()-(7-d.getDay()));},weekEnd:function(d){return new Date(d.getFullYear(),d.getMonth(),d.getDate()+(8-d.getDay()));}} 
var DOMHandler={getBoolValue:function(str){if(typeof str=='string'){l_str=str.toLowerCase();return(l_str=='1'||l_str=='yes'||l_str=='true'||l_str=='да');}
else if(typeof str=='boolean'){return str;}},createImgElement:function(src,alt,h,w){var element=document.createElement('img');element.src=src;if(alt!=undefined)element.alt=alt;if(h!=undefined)element.setAttribute("height",h);if(w!=undefined)element.setAttribute("width",w);return element;},createAnchorImgElement:function(href,text,src,alt){var element=document.createElement("a");element.href=href;if(text!=undefined){element.appendChild(document.createTextNode(text));}
if(src!=undefined){element.appendChild(this.createImgElement(src,alt));}
return element;},createHrefElement:function(href,text,src,alt){var element=document.createElement("a");element.href=href;if(text!=undefined){element.appendChild(document.createTextNode(text));}
if(src!=undefined){element.appendChild(this.createImgElement(src,alt));}
return element;},setAttr:function(node,attrName,attrValue){if(node&&attrName&&attrValue){node.setAttribute(attrName,attrValue);}},getAttr:function(node,name){if(node){return node.getAttribute(name);}},removeAttr:function(node,name){if(node){return node.removeAttribute(name);}},addAttr:function(node,name,val){this.setAttr(node,name,val);},getAttrBool:function(node,name){return this.getBoolValue(getAttr(node,name));},removeAllNodesOnClass:function(class_val){var body=document.getElementsByTagName('body')[0];var list=this.getElementsByAttr(class_val,body,"class");for(var i=0;i<list.length;i++){body.removeChild(list[i]);}},getElementsByAttr:function(classStr,node,attrName,uniq,tag){tag=tag||"*";var node=node||document;var list=node.getElementsByTagName(tag);var length=list.length;var classArray=classStr.split(/\s+/);var classes=classArray.length;var result=new Array();for(var i=0;i<length;i++){if(uniq&&result.length>0)break;for(var j=0;j<classes;j++){if(((attrName=='class')&&(list[i].className!=undefined&&typeof list[i].className=='string')&&(list[i].className.search('\\b'+classArray[j]+'\\b')!=-1))||((list[i].attributes!=undefined)&&(list[i].getAttribute(attrName)!=undefined)&&(list[i].getAttribute(attrName).search('\\b'+classArray[j]+'\\b')!=-1))){result.push(list[i]);break;}}}
return result;},swapClassesOfANode:function(node,new_class,old_class){node.className=node.className.replace(old_class,new_class);},swapClassesOfChildrenOfANode:function(node,new_class,old_class){var list=getElementsByAttr(old_class,node,'class');for(var i=0;i<list.length;i++){this.swapClassesOfANode(list[i],new_class,old_class)}},addClass:function(node,classToAdd){var re=new RegExp("(^|\\s)"+classToAdd+"(\\s|$)","g");if(re.test(node.className))return;node.className=(node.className+" "+classToAdd).replace(/\s+/g," ").replace(/(^ | $)/g,"");},removeClass:function(node,classToRemove){var re=new RegExp("(^|\\s)"+classToRemove+"(\\s|$)","g");node.className=node.className.replace(re,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,"");},hasClass:function(node,classToCheck){return(node)?(node.className&&new RegExp("(^|\\s)"+classToCheck+"(\\s|$)").test(node.className)):null;},removeNode:function(node){if(node&&node.parentNode)
node.parentNode.removeChild(node);},removeAttr:function(node,attr){if(node.attributes&&node.attributes.length>0){node.removeAttribute(attr);}},getParentByTagName:function(node,tagName){var p=node.parentNode;if(p){var tn=tagName.toLowerCase();while(p&&p.nodeName.toLowerCase()!=tn){p=p.parentNode;}
return((p&&p.nodeName.toLowerCase()==tn)?p:null);}},getElementIndex:function(n){var i=0;while(n=n.previousSibling){if(n.nodeType===1){i++;}}
return i;},xmlDocFromString:function(txt){var xmlDoc;if(window.DOMParser){xmlDoc=(new DOMParser()).parseFromString(txt,"text/xml");}
else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async=false;xmlDoc.loadXML(txt);}
return xmlDoc;},delAttr:function(node,name){if(node){return node.removeAttribute(name);}},setAttr:function(node,attrName,attrValue){if(node){node.setAttribute(attrName,attrValue);}}} 
var EventHandler={addEvent:function(obj,evType,fn,capture){if(typeof obj=='string'){obj=$(obj);}
if(obj&&obj.addEventListener){obj.addEventListener(evType,fn,capture);return true;}else if(obj&&obj.attachEvent){var r=obj.attachEvent("on"+evType,fn);return r;}else{return false;}},removeEvent:function(obj,evType,fn,useCapture){if(obj.removeEventListener){obj.removeEventListener(evType,fn,useCapture);return true;}else if(obj.detachEvent){var r=obj.detachEvent("on"+evType,fn);return r;}else{alert("Handler could not be removed");}},fixMouseEvent:function(e){e=e||window.event;if(e.target===undefined){e.target=e.srcElement;}
if(e.pageX==null&&e.clientX!=null){var html=document.documentElement;var body=document.body;e.pageX=e.clientX+(html&&html.scrollLeft||body&&body.scrollLeft||0)-(html.clientLeft||0);e.pageY=e.clientY+(html&&html.scrollTop||body&&body.scrollTop||0)-(html.clientTop||0);}
if(!e.which&&e.button){e.which=e.button&1?1:(e.button&2?3:(e.button&4?2:0));}
return(e);},fixKeyEvent:function(e){e=e||window.event;if(e.target===undefined){e.target=e.srcElement;}
e.keyCode=(e.charCode)?e.charCode:e.keyCode;return(e);}}; 
function AppWin(options){options=options||{};this.m_msg=new WindowMessage();this.m_tempMsg=new WindowTempMessage();var self=this;window.onerror=function(msg,url,line,col,error){self.onError(msg,url,line,col,error);};window.getApp=function(){return options.app;}
window.getWidthType=function(){return options.widthType?options.widthType:"sm";}
window.getBsCol=function(v){return(options.bsCol?(options.bsCol+((v!=undefined)?v.toString():"")):("col-"+this.getWidthType()+"-"+((v!=undefined)?v.toString():"")));};window.showMsg=function(opts){opts.bsCol=window.getBsCol();self.m_msg.show(opts);};window.showError=function(msg,callBack,timeout){window.showMsg({"type":self.m_msg.TP_ER,"text":msg,"callBack":callBack,"timeout":timeout});};window.showWarn=function(msg,callBack,timeout){window.showMsg({"type":self.m_msg.TP_WARN,"text":msg,"callBack":callBack,"timeout":timeout});};window.showNote=function(msg,callBack,timeout){window.showMsg({"type":self.m_msg.TP_NOTE,"text":msg,"callBack":callBack,"timeout":timeout});};window.showOk=function(msg,callBack,timeout){window.showMsg({"type":self.m_msg.TP_OK,"text":msg,"callBack":callBack,"timeout":timeout});};window.showTempMsg=function(opts){self.m_tempMsg.show(opts);};window.showTempNote=function(msg,callBack,timeout){window.showTempMsg({"type":self.m_tempMsg.TP_NOTE,"content":msg,"callBack":callBack,"timeout":timeout});};window.showTempOk=function(msg,callBack,timeout){window.showTempMsg({"type":self.m_tempMsg.TP_OK,"content":msg,"callBack":callBack,"timeout":timeout});};window.showTempError=function(msg,callBack,timeout){window.showTempMsg({"type":self.m_tempMsg.TP_ER,"content":msg,"callBack":callBack,"timeout":timeout});};window.showTempWarn=function(msg,callBack,timeout){window.showTempMsg({"type":self.m_tempMsg.TP_WARN,"content":msg,"callBack":callBack,"timeout":timeout})};window.resetError=function(){};window.setGlobalWait=function(isWait){var n=document.getElementById("waiting");if(n)n.style=isWait?"display:block;":"display:none;"}}
AppWin.prototype.onError=function(msg,url,line,col,error){let app;let d=SERV_VARS["DEBUG"];var m_debug=(d=="1"||d===true||d===undefined);if(error instanceof FatalException){error.show();}
else{var str=msg;if(m_debug){str=str+"\nurl: "+url+"\nline: "+line;if(console){console.log(str);if(error&&error.stack)console.log(error.stack);if(console.trace)console.trace();}}
else{var er_pref="Error: ";if(str.substr(0,er_pref.length)==er_pref){str=str.substr(er_pref.length);}
er_pref="Uncaught Error";if(str.substr(0,er_pref.length)==er_pref){str=str.substr(er_pref.length);}
var er_postf=" (SQLSTATE P0001)";if(str.substr(str.length-er_postf.length+1)==er_postf){str=str.substr(0,str.length-er_postf.length+1);}}
window.showError(str);}
if(!m_debug&&app&&app.onGUIError){app.onGUIError({"msg":msg,"url":url,"col":col,"error":error});}
return false;} 
function Controller(id,servConnector){this.setId(id);this.setServConnector(servConnector);this.m_publicMethods={};}
Controller.prototype.ER_NO_METHOD="Public method %s not found.";Controller.prototype.m_servConnector;Controller.prototype.m_id;Controller.prototype.m_publicMethods;Controller.prototype.publicMethodExists=function(id){return(this.m_publicMethods[id]!=undefined);}
Controller.prototype.addPublicMethod=function(pm){this.m_publicMethods[pm.getId()]=pm;}
Controller.prototype.checkPublicMethod=function(id){if(!this.publicMethodExists(id)){throw new Error(format(this.ER_NO_METHOD,Array(id))+" Controller:"+this.getId());}
return true;}
Controller.prototype.getPublicMethodById=function(id){this.checkPublicMethod(id);return this.m_publicMethods[id];}
Controller.prototype.getServConnector=function(){return this.m_servConnector;}
Controller.prototype.setServConnector=function(servConnector){this.m_servConnector=servConnector;}
Controller.prototype.getId=function(){return this.m_id;}
Controller.prototype.setId=function(id){this.m_id=id;}
Controller.prototype.runPublicMethod=function(methodName,paramObj,async,retFunc,retCont,retOnError,xmlResponse,isGet,enctype){isGet=(isGet==undefined)?true:isGet;xmlResponse=(xmlResponse==undefined)?true:xmlResponse;var pm=this.getPublicMethodById(methodName);paramObj=paramObj||{};for(var name in paramObj){pm.getParamById(name).setValue(paramObj[name]);};var self=this;var param_str,con_func;var conn=this.getServConnector();if(isGet){param_str=this.getQueryString(pm);con_func=conn.sendGet;}
else{con_func=conn.sendPost;param_str=this.getQueryStruc(pm);}
this.m_resp=null;con_func.call(conn,param_str,async,function(errCode,errStr,resp,requestId){if(errCode!=0){if(retOnError){retOnError.call(retCont,resp,errCode,errStr);}
else{throw new Error(errStr);}}
else if(retFunc){self.m_resp=requestId;retFunc.call(retCont,resp,requestId);}
else{self.m_resp=resp;}},this,xmlResponse,enctype);return this.m_resp;}
Controller.prototype.run=function(methId,options){options=options||{};var def_err_func=function(resp,errCode,errStr){throw new Error(errStr);}
var params=options.params||{};var async=(options.async==undefined)?true:options.async;var retFunc=options.func||null;var retCont=options.cont||null;var retOnError=options.err||def_err_func;var xml=(options.xml==undefined)?true:options.xml;var isGet=(options.get==undefined)?true:options.get;if(options.errControl){options.errControl.setValue("");retOnError=function(resp,errCode,errStr){options.errControl.setValue(errStr);}}
return this.runPublicMethod(methId,params,async,retFunc,retCont,retOnError,xml,isGet,options.enctype);}
Controller.prototype.getQuery=function(publicMethod,resultString){var params_result;if(resultString){params_result="";}
else{params_result={};}
var param_pare;var params=publicMethod.getParams();var error="";var this_error;var valid=true;for(var param in params){if(params[param]){if(!params[param].isValid(this_error)){valid=false;error+=(error=="")?"":" ";error+=this_error;}
else{if(resultString){param_pare=params[param].getQueryString();if(param_pare){params_result+=(params_result=="")?"":"&";params_result+=param_pare;}}
else{if(!params[param].isEmpty()){params_result[params[param].getId()]=params[param].getValueForQuery();}}}}};if(!valid){throw new Error(error);}
return params_result;}
Controller.prototype.getQueryString=function(publicMethod){return this.getQuery(publicMethod,true);}
Controller.prototype.getQueryStruc=function(publicMethod){return this.getQuery(publicMethod,false);}
Controller.prototype.openHref=function(methId,viewId,winParams){var pm=this.getPublicMethodById(methId);let params=pm.getParams();this.getServConnector().openHref(params,winParams);}
Controller.prototype.download=function(methId,viewId,ind,callBack){ind=(ind!=undefined)?ind:"";var n_id="file_downloader"+ind;var n=document.getElementById(n_id);if(!n){n=document.createElement("iframe");n.id=n_id;n.style="display:none;";n.onerror=window.onerror;n.onload=function(){if(this.contentDocument&&this.contentDocument.body&&this.contentDocument.body.innerHTML&&this.contentDocument.body.innerHTML.length){if(callBack){callBack(1,this.contentDocument.body.innerHTML);}
else{throw new Error(this.contentDocument.body.innerHTML);}}else if(this.contentDocument){let resp=new ServResponse();resp.parse(this.contentDocument);error_n=resp.getRespResult();if(error_n!=0){if(callBack){callBack(error_n,resp.getRespDescr());}
else{throw new Error(resp.getRespDescr());}}
else if(callBack){callBack(0);}}
else if(callBack){callBack(0);}};document.body.appendChild(n);}
var pm=this.getPublicMethodById(methId);var params=pm.getParams();var par_str="";for(var id in params){par_str+=(par_str=="")?"":"&";par_str+=params[id].getQueryString();}
n.src=this.getServConnector().getScript()+"?"+par_str;} 
function ControllerDb(id,servConnector,options){ControllerDb.superclass.constructor.call(this,id,servConnector);options=options||{};if(options.listModelId){this.setListModelId(options.listModelId);}
if(options.objModelId){this.setObjModelId(options.objModelId);}}
extend(ControllerDb,Controller);ControllerDb.prototype.METH_INSERT="insert";ControllerDb.prototype.METH_UPDATE="update";ControllerDb.prototype.METH_GET_OBJ="get_object";ControllerDb.prototype.METH_GET_LIST="get_list";ControllerDb.prototype.METH_DELETE="delete";ControllerDb.prototype.METH_COMPLETE="complete";ControllerDb.prototype.PARAM_VIEW_VALUE="ViewXML";ControllerDb.prototype.PARAM_CONTROLLER="c";ControllerDb.prototype.PARAM_METH="f";ControllerDb.prototype.PARAM_VIEW="v";ControllerDb.prototype.PARAM_OLD_ID="old_id";ControllerDb.prototype.PARAM_COUNT="count";ControllerDb.prototype.PARAM_FROM="from";ControllerDb.prototype.PARAM_IC="ic";ControllerDb.prototype.PARAM_MID="mid";ControllerDb.prototype.PARAM_ORD_FIELDS="ord_fields";ControllerDb.prototype.PARAM_ORD_DIRECTS="ord_directs";ControllerDb.prototype.PARAM_COND_FIELDS="cond_fields";ControllerDb.prototype.PARAM_COND_SGNS="cond_sgns";ControllerDb.prototype.PARAM_COND_VALS="cond_vals";ControllerDb.prototype.PARAM_COND_ICASE="cond_ic";ControllerDb.prototype.PARAM_SGN_EQUAL="e";ControllerDb.prototype.PARAM_SGN_LESS="l";ControllerDb.prototype.PARAM_SGN_GREATER="g";ControllerDb.prototype.PARAM_SGN_LESS_EQUAL="le";ControllerDb.prototype.PARAM_SGN_GREATER_EQUAL="ge";ControllerDb.prototype.PARAM_SGN_LIKE="lk";ControllerDb.prototype.PARAM_SGN_NOT_EQUAL="ne";ControllerDb.prototype.PARAM_ORD_ASC="a";ControllerDb.prototype.PARAM_ORD_DESC="d";ControllerDb.prototype.PARAM_GRP_FIELDS="grp_fields";ControllerDb.prototype.PARAM_AGG_FIELDS="agg_fields";ControllerDb.prototype.PARAM_AGG_TYPES="agg_types";ControllerDb.prototype.PARAM_GROUPS="groups";ControllerDb.prototype.PARAM_RET_ID="ret_id";ControllerDb.prototype.PARAM_FIELD_SEP="field_sep";ControllerDb.prototype.m_listModelId;ControllerDb.prototype.m_objModelId;ControllerDb.prototype.addDefParams=function(pm){pm.addParam(new FieldSys(this.PARAM_CONTROLLER,this.getId()));pm.addParam(new FieldSys(this.PARAM_METH,pm.getId()));pm.addParam(new FieldSys(this.PARAM_VIEW,this.PARAM_VIEW_VALUE));}
ControllerDb.prototype.addInsert=function(){return this.addMethodById(this.METH_INSERT);}
ControllerDb.prototype.getInsert=function(){return this.getPublicMethodById(this.METH_INSERT);}
ControllerDb.prototype.addUpdate=function(){return this.addMethodById(this.METH_UPDATE);}
ControllerDb.prototype.getUpdate=function(){return this.getPublicMethodById(this.METH_UPDATE);}
ControllerDb.prototype.addDelete=function(){return this.addMethodById(this.METH_DELETE);}
ControllerDb.prototype.getDelete=function(){return this.getPublicMethodById(this.METH_DELETE);}
ControllerDb.prototype.addGetObject=function(){return this.addMethodById(this.METH_GET_OBJ);}
ControllerDb.prototype.getGetObject=function(){return this.getPublicMethodById(this.METH_GET_OBJ);}
ControllerDb.prototype.addGetList=function(){var pm=this.addMethodById(this.METH_GET_LIST);pm.addParam(new FieldInt(this.PARAM_COUNT));pm.addParam(new FieldInt(this.PARAM_FROM));pm.addParam(new Field(this.PARAM_ORD_FIELDS));pm.addParam(new Field(this.PARAM_ORD_DIRECTS));pm.addParam(new Field(this.PARAM_COND_FIELDS));pm.addParam(new Field(this.PARAM_COND_SGNS));pm.addParam(new Field(this.PARAM_COND_VALS));pm.addParam(new Field(this.PARAM_COND_ICASE));pm.addParam(new Field(this.PARAM_FIELD_SEP));return pm;}
ControllerDb.prototype.getGetList=function(){return this.getPublicMethodById(this.METH_GET_LIST);}
ControllerDb.prototype.setObjModelId=function(objModelId){this.m_objModelId=objModelId;}
ControllerDb.prototype.getObjModelId=function(){return this.m_objModelId;}
ControllerDb.prototype.setListModelId=function(listModelId){this.m_listModelId=listModelId;}
ControllerDb.prototype.getListModelId=function(){return this.m_listModelId;}
ControllerDb.prototype.addComplete=function(){var pm=this.addMethodById(this.METH_COMPLETE);pm.addParam(new FieldInt(this.PARAM_COUNT));pm.addParam(new FieldInt(this.PARAM_IC));pm.addParam(new FieldInt(this.PARAM_MID));pm.addParam(new Field(this.PARAM_ORD_FIELDS));return pm;}
ControllerDb.prototype.getComplete=function(){return this.getPublicMethodById(this.METH_COMPLETE);}
ControllerDb.prototype.addMethodById=function(methId){var pm=new PublicMethod(methId);this.addDefParams(pm);this.addPublicMethod(pm);return pm;} 
function Field(id,options){options=options||{};this.setId(id);if(options.alias){this.setAlias(options.alias);};if(options.value){this.setValue(options.value);};this.setDataType(options.dataType||this.DT_STRING);this.setPrimaryKey((options.primaryKey!=undefined)?options.primaryKey:this.DEF_PRIMARY_KEY);if(options.len){this.setLength(options.len);}
this.setRequired((options.required!=undefined)?options.required:this.DEF_REQUIRED);this.setReadOnly((options.readOnly!=undefined)?options.readOnly:this.DEF_READ_ONLY);this.setMinLength(options.minLength||this.DEF_MIN_LENGTH);if(options.validator){this.setValidator(options.validator);};if(options.defValue){this.setDefValue(options.defValue);};}
Field.prototype.DT_STRING=0;Field.prototype.DT_INT=1;Field.prototype.DT_FLOAT=2;Field.prototype.DT_DATE=3;Field.prototype.DT_DATETIME=4;Field.prototype.DT_TIME=5;Field.prototype.DT_TEXT=6;Field.prototype.DT_ENUM=7;Field.prototype.DT_GEOM_POINT=8;Field.prototype.DT_GEOM_POLYGON=9;Field.prototype.DEF_PRIMARY_KEY=false;Field.prototype.DEF_REQUIRED=false;Field.prototype.DEF_READ_ONLY=false;Field.prototype.DEF_MIN_LENGTH=0;Field.prototype.ER_NO_VALUE="поле '%s' - пустое значение";Field.prototype.ER_TOO_LONG_VALUE="поле '%s' - значение слишком длинное";Field.prototype.ER_TOO_SHORT_VALUE="поле '%s' - значение слишком короткое";Field.prototype.ER_INVALID_VALUE="поле '%s' - не верное значение";Field.prototype.m_id;Field.prototype.m_alias;Field.prototype.m_value;Field.prototype.m_dataType;Field.prototype.m_primaryKey;Field.prototype.m_length;Field.prototype.m_required;Field.prototype.m_defValue;Field.prototype.m_readOnly;Field.prototype.m_minLength;Field.prototype.m_validator;Field.prototype.correctValue=function(value){return value;}
Field.prototype.getValueForQuery=function(){var v=this.getValue();if(typeof v!="object"){v=encodeURIComponent(v);}
return(v);}
Field.prototype.setId=function(id){this.m_id=id;}
Field.prototype.getId=function(){return this.m_id;}
Field.prototype.setAlias=function(alias){this.m_alias=alias;}
Field.prototype.getAlias=function(){return this.m_alias||this.m_id;}
Field.prototype.setValue=function(value){this.m_value=this.correctValue(value);}
Field.prototype.getValue=function(arInd){if(arInd!=undefined){if(this.m_value.length>arInd){return this.m_value[arInd];}}
else{return this.m_value;}}
Field.prototype.setDefValue=function(value){this.m_value=this.correctValue(value);}
Field.prototype.getDefValue=function(){return this.m_defValue;}
Field.prototype.setDataType=function(dataType){this.m_dataType=dataType;}
Field.prototype.getDataType=function(){return this.m_dataType;}
Field.prototype.setPrimaryKey=function(primaryKey){this.m_primaryKey=primaryKey;}
Field.prototype.getPrimaryKey=function(){return this.m_primaryKey;}
Field.prototype.setLength=function(len){this.m_length=len;}
Field.prototype.getLength=function(){return this.m_length;}
Field.prototype.setRequired=function(required){this.m_required=required;}
Field.prototype.getRequired=function(){return this.m_required;}
Field.prototype.setReadOnly=function(readOnly){this.m_readOnly=readOnly;}
Field.prototype.getReadOnly=function(){return this.m_readOnly;}
Field.prototype.setMinLength=function(minLength){this.m_minLength=minLength;}
Field.prototype.getMinLength=function(){return this.m_minLength;}
Field.prototype.setValidator=function(validator){this.m_validator=validator;}
Field.prototype.getValidator=function(){return this.m_validator;}
Field.prototype.isEmpty=function(){var val=this.getValue();var def_val=this.getDefValue();return(val==undefined&&def_val==undefined);}
Field.prototype.isTooLong=function(){var len=this.getLength();return(len!=undefined&&this.getValue()&&len<this.getValue().length);}
Field.prototype.isTooShort=function(){var min_len=this.getMinLength();return(min_len!=undefined&&this.getValue()&&min_len>this.getValue().length);}
Field.prototype.isValid=function(comment){var valid=true;var no_val=this.isEmpty();var er;if(no_val&&this.getRequired()){er=this.ER_NO_VALUE;valid=false;}
else if(this.isTooLong()){er=this.ER_TOO_LONG_VALUE;valid=false;}
else if(this.isTooShort()){er=this.ER_TOO_SHORT_VALUE;valid=false;}
else if(!no_val){var v=this.getValidator();if(v){valid=v.isValid(this.getValue());if(!valid){er=this.ER_INVALID_VALUE;}}}
if(!valid&&er){comment=format(er,Array(this.getAlias()));alert(comment);}
return valid;}
Field.prototype.getQueryString=function(){if(!this.isEmpty()){return(this.getId()+"="+this.getValueForQuery());}} 
function FieldSys(id,value){FieldSys.superclass.constructor.call(this,id,{"value":value});}
extend(FieldSys,Field);FieldSys.prototype.isValid=function(){return true;} 
function FieldString(id,options){options=options||{};options.dataType=this.DT_STRING;options.validator=new ValidatorString();FieldString.superclass.constructor.call(this,id,options);}
extend(FieldString,Field);FieldString.prototype.correctValue=function(value){if(value==null){return"";};return value;} 
function FieldInt(id,options){options=options||{};options.dataType=this.DT_INT;options.validator=new ValidatorInt();FieldInt.superclass.constructor.call(this,id,options);}
extend(FieldInt,Field);FieldInt.prototype.correctValue=function(value){if(value!=undefined&&typeof value!="number"){var val=parseInt(value,10);return(isNaN(val))?"null":val;}
else{return(value==undefined)?"null":value;}} 
function FieldBool(id,options){options=options||{};options.dataType=this.DT_BOOL;options.validator=new ValidatorBool();FieldBool.superclass.constructor.call(this,id,options);}
extend(FieldBool,Field);FieldBool.prototype.correctValue=function(value){return value;} 
function FieldFloat(id,options){options=options||{};options.dataType=this.DT_FLOAT;options.validator=new ValidatorFloat();FieldFloat.superclass.constructor.call(this,id,options);}
extend(FieldFloat,Field); 
function FieldDate(id,options){options=options||{};options.dataType=this.DT_DATE;options.validator=new ValidatorDate();FieldDate.superclass.constructor.call(this,id,options);}
extend(FieldDate,Field); 
function FieldDateTime(id,options){options=options||{};options.dataType=this.DT_DATETIME;options.validator=new ValidatorDateTime();FieldDateTime.superclass.constructor.call(this,id,options);}
extend(FieldDateTime,Field); 
function FieldDate(id,options){options=options||{};options.dataType=this.DT_DATE;options.validator=new ValidatorDate();FieldDate.superclass.constructor.call(this,id,options);}
extend(FieldDate,Field); 
function FieldTime(id,options){options=options||{};options.dataType=this.DT_TIME;options.validator=new ValidatorTime();FieldTime.superclass.constructor.call(this,id,options);}
extend(FieldTime,Field); 
function FieldEnum(id,options){options=options||{};FieldEnum.superclass.constructor.call(this,id);if(options.values){this.m_values=options.values;}}
extend(FieldEnum,Field);FieldEnum.prototype.m_values;FieldEnum.prototype.isValid=function(){return true;} 
function FieldText(id,options){options=options||{};options.dataType=this.DT_TEXT;options.validator=new ValidatorString();FieldText.superclass.constructor.call(this,id,options);}
extend(FieldText,Field); 
function FieldPassword(id,options){options=options||{};options.dataType=this.DT_PWD;options.validator=new ValidatorString();FieldPassword.superclass.constructor.call(this,id,options);}
extend(FieldPassword,Field); 
function FieldGeomPoint(id,options){options=options||{};options.dataType=this.DT_GEOM_POINT;options.validator=new Validator();FieldGeomPoint.superclass.constructor.call(this,id,options);}
extend(FieldGeomPoint,Field); 
function FieldGeomPolygon(id,options){options=options||{};options.dataType=this.DT_GEOM_POLYGON;options.validator=new Validator();FieldGeomPolygon.superclass.constructor.call(this,id,options);}
extend(FieldGeomPolygon,Field); 
function FieldJSON(id,options){options=options||{};options.validator=options.validator||new ValidatorJSON(options);options.dataType=this.DT_JSON;FieldJSON.superclass.constructor.call(this,id,options);}
extend(FieldJSON,Field);FieldJSON.prototype.getValueXHR=function(){return(CommonHelper.serialize(this.getValue()));}
FieldJSON.prototype.setValue=function(id,v){if(!v&&typeof(id)=="object"){this.m_value=id;}
else if(!v&&typeof(id)=="string"&&id.length){this.m_value=CommonHelper.unserialize(id);}
else if(v){this.m_value=this.m_value||{};this.m_value[id]=v;}}
FieldJSON.prototype.isEmpty=function(val,checkNull){val=(val&&val.getKeys)?val.getKeys():val;var r=(val==undefined);if(!r){r=true;for(v in val){if(checkNull&&val[v]!==null||!checkNull&&val[v]!==undefined){r=false;break;}}}
return r;}
FieldJSON.prototype.isNull=function(){var r=this.isEmpty(this.getValue(),true);if(r){r=this.isEmpty(this.getDefValue(),true);}
return r;}
FieldJSON.prototype.isSet=function(){var r=this.isEmpty(this.getValue(),false);if(r){r=this.isEmpty(this.getDefValue(),false);}
return!r;} 
function FieldJSONB(id,options){options=options||{};options.dataType=this.DT_JSONB;FieldJSONB.superclass.constructor.call(this,id,options);}
extend(FieldJSONB,FieldJSON); 
function DataSource(controller,options){options=options||{};this.setRefreshTime(options.refreshTime||this.DEF_REFRESH_TIME);this.m_controller=controller;this.m_publicMethodId=options.publicMethodId||controller.METH_GET_LIST;this.m_modelId=options.modelId;this.m_maxWaitForQuery=options.maxWaitForQuery||this.MAX_WAIT_FOR_QUERY;this.setTopBufferRecCount(options.topBufferRecCount||this.DEF_TOP_BUF_REC_COUNT);this.setBottomBufferRecCount(options.bottomBufferRecCount||this.DEF_BOTTOM_BUF_REC_COUNT);this.setVisibleRecCount(options.visibleRecCount||this.DEF_VIS_REC_COUNT);this.m_keyFieldArray=[];this.m_keysDefined=false;this.m_queryParams={};this.m_queryParams[this.QUERY_TYPES.start]={"count":this.getTotalRecCount(),"from":0};this.m_queryParams[this.QUERY_TYPES.top]={"count":this.getTopBufferRecCount(),"from":null};this.m_queryParams[this.QUERY_TYPES.bottom]={"count":this.getBottomBufferRecCount(),"from":null};this.m_queryParams[this.QUERY_TYPES.all]={"count":this.getTotalRecCount(),"from":null};var pm=this.m_controller.getPublicMethodById(this.m_publicMethodId);var ord_fields_str=pm.getParamValue(controller.PARAM_ORD_FIELDS);if(ord_fields_str){var ord_directs_str=pm.getParamValue(controller.PARAM_ORD_DIRECTS);this.defineCondFields(ord_fields_str.split(","),(ord_directs_str)?ord_directs_str.split(","):[]);}
else if(this.m_modelId){this.defineCondFieldsOnModelId();}
if(options.model){this.setModel(options.model);}
this.m_parCondValues=pm.getParamById(controller.PARAM_COND_VALS);this.m_parCondSignes=pm.getParamById(controller.PARAM_COND_SGNS);this.m_parCondFields=pm.getParamById(controller.PARAM_COND_FIELDS);var cond_fields_str=this.m_parCondFields.getValue();this.m_condParamIndex=(cond_fields_str)?cond_fields_str.split(",").length:0;}
DataSource.prototype.DEF_REFRESH_TIME=0;DataSource.prototype.DEF_TOP_BUF_REC_COUNT=10;DataSource.prototype.DEF_BOTTOM_BUF_REC_COUNT=10;DataSource.prototype.DEF_VIS_REC_COUNT=30;DataSource.prototype.DEF_NO_BUFFER=false;DataSource.prototype.MAX_WAIT_FOR_QUERY=10*1000;DataSource.prototype.ER_REQUEST_NOT_DEFINED="Request not found.";DataSource.prototype.ER_NOT_ACTIVE="Not active.";DataSource.prototype.ER_COND_FIELDS_NOT_DEFINED="Не смогли определить поля условий.";DataSource.prototype.QUERY_TYPES={"start":0,"top":1,"bottom":2,"all":3};DataSource.prototype.m_maxWaitForQuery;DataSource.prototype.m_refreshTime;DataSource.prototype.m_bottomBufferRecCount;DataSource.prototype.m_topBufferRecCount;DataSource.prototype.m_model;DataSource.prototype.m_modelId;DataSource.prototype.m_visibleRecCount;DataSource.prototype.m_timerId;DataSource.prototype.m_keyFieldArray;DataSource.prototype.m_parCondValues;DataSource.prototype.m_parCondSignes;DataSource.prototype.m_parCondFields;DataSource.prototype.m_requests;DataSource.prototype.m_queryParams;DataSource.prototype.m_condParamIndex;DataSource.prototype.defineCondFields=function(fieldAr,dirAr){var dir_asc;for(var i=0;i<fieldAr.length;i++){this.m_keyFieldArray.push(fieldAr[i]);dir_asc=(dirAr&&dirAr.length>i)?(dirAr[i]==this.m_controller.PARAM_ORD_ASC):true;this.m_queryParams[this.QUERY_TYPES.top][fieldAr[i]]={"sgn":(dir_asc)?this.m_controller.PARAM_SGN_LESS:this.m_controller.PARAM_SGN_GREATER,"value":null};this.m_queryParams[this.QUERY_TYPES.bottom][fieldAr[i]]={"sgn":(dir_asc)?this.m_controller.PARAM_SGN_GREATER:this.m_controller.PARAM_SGN_LESS,"value":null};this.m_queryParams[this.QUERY_TYPES.all][fieldAr[i]]={"sgn":(dir_asc)?this.m_controller.PARAM_SGN_GREATER_EQUAL:this.m_controller.PARAM_SGN_LESS_EQUAL,"value":null};}
this.m_keysDefined=true;}
DataSource.prototype.defineCondFieldsOnModelId=function(){if(eval("typeof "+this.m_modelId+"== 'function'")){var fields_ar=[];var model=eval("new "+this.m_modelId+"()");var fields=model.getFields();for(var field_id in fields){if(fields[field_id].getPrimaryKey()){fields_ar.push(field_id);}}
this.defineCondFields(fields_ar);}}
DataSource.prototype.updateFirstRecCondVals=function(){var pos=this.m_model.getRowPos();this.m_model.setFirstRow();var val,field_id;for(var i=0;i<this.m_keyFieldArray.length;i++){field_id=this.m_keyFieldArray[i];val=this.m_model.getFieldById(field_id).getValue();this.m_queryParams[this.QUERY_TYPES.top][field_id].value=val;this.m_queryParams[this.QUERY_TYPES.all][field_id].value=val;}
this.m_model.setRowPos(pos);}
DataSource.prototype.updateLastRecCondVals=function(){var pos=this.m_model.getRowPos();this.m_model.setLastRow();var val,field_id;for(var i=0;i<this.m_keyFieldArray.length;i++){field_id=this.m_keyFieldArray[i];val=this.m_model.getFieldById(field_id).getValue();this.m_queryParams[this.QUERY_TYPES.bottom][field_id].value=val;}
this.m_model.setRowPos(pos);}
DataSource.prototype.clear=function(){if(this.m_timerId){clearInterval(this.m_timerId);delete this.m_timerId;}
if(this.m_model){delete this.m_model;}
if(this.m_requests){delete this.m_requests;}
this.m_requests={};}
DataSource.prototype.onGetData=function(resp,reqId){if(!this.m_requests[reqId]){throw new Error(this.ER_REQUEST_NOT_DEFINED);}
var query_type=this.m_requests[reqId].queryType;var resp_model=resp.getModelById(this.m_modelId);var whole_model=(query_type==this.QUERY_TYPES.start||query_type==this.QUERY_TYPES.all);resp_model.setActive(true);if(!this.m_keysDefined){}
if(!this.m_keysDefined){throw new Error(this.ER_COND_FIELDS_NOT_DEFINED);}
if(whole_model&&this.m_model){delete this.m_model;}
if(whole_model){this.m_model=resp_model;this.updateFirstRecCondVals();this.updateLastRecCondVals();}
else if(query_type==this.QUERY_TYPES.top){var count=resp_model.getRowCount();var from=this.getTotalRecCount()-
this.getBottomBufferRecCount();this.m_model.deleteRows(from,count);var fields=this.m_model.getFields();resp_model.setLastRow();while(resp_model.getPreviousRow()){this.m_model.insertRow(0);for(var field_id in fields){var val;if(resp_model.fieldExists(field_id)){val=resp_model.getFieldById(field_id).getValue();}
this.m_model.getFieldById(field_id).setValue(val);}
this.m_model.post();}
this.updateFirstRecCondVals();}
else if(query_type==this.QUERY_TYPES.bottom){var count=resp_model.getRowCount();var row_pos=this.m_model.getRowPos();var deleted_rows=0;try{deleted_rows=this.m_model.deleteRows(0,count);var fields=this.m_model.getFields();while(resp_model.getNextRow()){this.m_model.appendRow();for(var field_id in fields){var val;if(resp_model.fieldExists(field_id)){val=resp_model.getFieldById(field_id).getValue();}
this.m_model.getFieldById(field_id).setValue(val);}
this.m_model.post();}
this.updateLastRecCondVals();}
finally{this.m_model.setRowPos(row_pos-deleted_rows);}}
if(this.m_refreshTime&&!this.m_timerId){this.m_timerId=setInterval(this.refreshDataOnTimer,this.m_refreshTime);}
var ret=this.m_requests[reqId].ret;delete this.m_requests[reqId];if(ret&&ret.func){ret.func.call(ret.context);}}
DataSource.prototype.refreshData=function(queryType,retFunc,retContext){var ASYNC=true;var params={};params[this.m_controller.PARAM_FROM]=this.m_queryParams[queryType].from;params[this.m_controller.PARAM_COUNT]=this.m_queryParams[queryType].count;if(queryType!=this.QUERY_TYPES.start){var cond_fields=this.m_parCondFields.getValue();var cond_values=this.m_parCondValues.getValue();var cond_signes=this.m_parCondSignes.getValue();cond_fields=(cond_fields)?cond_fields.split(","):[];cond_values=(cond_values)?cond_values.split(","):[];cond_signes=(cond_signes)?cond_signes.split(","):[];var field_id;var ind=this.m_condParamIndex;for(var i=0;i<this.m_keyFieldArray.length;i++){field_id=this.m_keyFieldArray[i];cond_fields[ind]=field_id;cond_signes[ind]=this.m_queryParams[queryType][field_id].sgn;cond_values[ind]=this.m_queryParams[queryType][field_id].value;ind++;}
this.m_parCondFields.setValue(cond_fields.join());this.m_parCondSignes.setValue(cond_signes.join());this.m_parCondValues.setValue(cond_values.join());}
if(!this.m_keysDefined){}
var req_id=this.m_controller.runPublicMethod(this.m_publicMethodId,params,ASYNC,this.onGetData,this);this.m_requests[req_id]={"queryType":queryType,"ret":{"func":retFunc,"context":retContext}};}
DataSource.prototype.refreshDataOnTimer=function(){this.refreshData(this.QUERY_TYPES.all);}
DataSource.prototype.setRefreshTime=function(refreshTime){this.m_refreshTime=refreshTime;}
DataSource.prototype.getRefreshTime=function(){return this.m_refreshTime;}
DataSource.prototype.setTopBufferRecCount=function(count){this.m_topBufferRecCount=count;}
DataSource.prototype.getTopBufferRecCount=function(){return this.m_topBufferRecCount;}
DataSource.prototype.setBottomBufferRecCount=function(count){this.m_bottomBufferRecCount=count;}
DataSource.prototype.getBottomBufferRecCount=function(){return this.m_bottomBufferRecCount;}
DataSource.prototype.setVisibleRecCount=function(count){this.m_visibleRecCount=count;}
DataSource.prototype.getVisibleRecCount=function(){return this.m_visibleRecCount;}
DataSource.prototype.setActive=function(active,retFunc,retContext){this.clear();if(active){this.refreshData(this.QUERY_TYPES.start,retFunc,retContext);}
this.m_active=active;}
DataSource.prototype.getActive=function(){return this.m_active;}
DataSource.prototype.getModel=function(){return this.m_model;}
DataSource.prototype.setModel=function(model){this.m_model=model;this.m_modelId=model.getId();if(!this.m_queryParams){this.defineCondFieldsOnModelId();}}
DataSource.prototype.getNextRow=function(){if(!this.getActive()||!this.m_model||!this.m_model.getActive()){throw new Error(this.ER_NOT_ACTIVE);}
if(!this.m_model.isLastRow()){var new_pos=this.m_model.getRowPos()+1;this.m_model.setRowPos(new_pos);var buf_start=this.m_topBufferRecCount+this.m_visibleRecCount;if(new_pos==buf_start){this.refreshData(this.QUERY_TYPES.bottom);}
return true;}
return false;}
DataSource.prototype.getTotalRecCount=function(){return this.getTopBufferRecCount()+
this.getVisibleRecCount()+
this.getBottomBufferRecCount();} 
function Model(node){if(node){this.setNode(node);}
this.m_fields={};}
Model.prototype.ATTR_READ_ONLY="readOnly";Model.prototype.ATTR_LIST_COUNT="listCount";Model.prototype.ATTR_LIST_FROM="listFrom";Model.prototype.ATTR_TOT_COUNT="totalCount";Model.prototype.ATTR_ID="id";Model.prototype.ROW_TAG="row";Model.prototype.ER_NO_FIELD="Field '%s' not found.";Model.prototype.ER_IND_OUT_OF_BOUNDS="Index out of bounds.";Model.prototype.ER_NO_ROWS="No rows.";Model.prototype.ER_NO_STRUCT="Field structure not defined.";Model.prototype.m_node;Model.prototype.m_rowPos;Model.prototype.m_row;Model.prototype.m_rows;Model.prototype.m_fields;Model.prototype.m_active=false;Model.prototype.m_rowCount=-1;Model.prototype.m_flagCleared=true;Model.prototype.getFieldId=function(fieldNode){return fieldNode.nodeName.split('.').join('_');}
Model.prototype.fetchRow=function(){if(this.m_rowPos>=0){var fields=this.m_rows[this.m_rowPos].childNodes;var id;for(var i=0;i<fields.length;i++){if(fields[i].nodeType==1){id=this.getFieldId(fields[i]);var t_val=null;if(fields[i].childNodes.length){for(var t_ind=0;t_ind<fields[i].childNodes.length;t_ind++){if(fields[i].childNodes[t_ind].nodeType==3){if(!t_val){t_val="";}
t_val+=fields[i].childNodes[t_ind].nodeValue;}
else if(fields[i].childNodes[t_ind].nodeType==1){var ar_node=fields[i].childNodes[t_ind];for(var j=0;j<ar_node.childNodes.length;j++){if(ar_node.childNodes[j].nodeType==3){if(!t_val){t_val=[];}
t_val.push(ar_node.childNodes[j].nodeValue);}}}}}
if(this.m_fields[id])this.m_fields[id].setValue(t_val);}}
this.m_flagCleared=false;}
else if(!this.m_flagCleared){for(var id in this.m_fields){this.m_fields[id].setValue(null);}
this.m_flagCleared=true;}}
Model.prototype.fieldExists=function(id){return(this.m_fields[id]!=undefined);}
Model.prototype.createFields=function(){this.m_rows=this.m_node.getElementsByTagName(this.ROW_TAG);if(this.getRowCount()){var fields=this.m_rows[0].childNodes;var id;for(var i=0;i<fields.length;i++){if(fields[i].nodeType==1){id=this.getFieldId(fields[i]);this.addField(new Field(id));}}}}
Model.prototype.destructFields=function(){for(var id in this.m_fields){delete this.m_fields[id];}
this.m_fields={};this.m_flagCleared=true;}
Model.prototype.getNewRow=function(){if(!this.m_fields){throw new Error(this.ER_NO_STRUCT);}
var row=document.createElement(this.ROW_TAG);var field;for(var id in this.m_fields){}
return row;}
Model.prototype.checkField=function(id){if(!this.fieldExists(id)){console.trace();throw new Error(format(this.ER_NO_FIELD,Array(id)));}
return true;}
Model.prototype.getFieldCount=function(){return this.m_fields.length;}
Model.prototype.addField=function(field){var id=field.getId();this.m_fields[id]=field;this[id]=this.m_fields[id];}
Model.prototype.setNode=function(node){this.m_node=node;}
Model.prototype.getNode=function(){return this.m_node;}
Model.prototype.getActive=function(){return this.m_active;}
Model.prototype.setActive=function(active){if(active){this.createFields();this.setRowBOF();}
else{this.destructFields();}
this.m_active=active;}
Model.prototype.getId=function(){return DOMHandler.getAttr(this.m_node,this.ATTR_ID);}
Model.prototype.getFieldById=function(id){this.checkField(id);return this.m_fields[id];}
Model.prototype.getFieldValue=function(id){this.checkField(id);return this.m_fields[id].getValue();}
Model.prototype.getRow=function(){var row={};for(var id in this.m_fields){row[id]=this.m_fields[id].getValue();}
return row;}
Model.prototype.getFieldByIndex=function(ind){if(this.getFieldCount()>=ind){throw new Error(this.ER_IND_OUT_OF_BOUNDS);}
return null;}
Model.prototype.getReadOnly=function(){return DOMHandler.getAttrBool(this.m_node,this.ATTR_READ_ONLY);}
Model.prototype.getListCount=function(){return DOMHandler.getAttr(this.m_node,this.ATTR_LIST_COUNT);}
Model.prototype.getListFrom=function(){return DOMHandler.getAttr(this.m_node,this.ATTR_LIST_FROM);}
Model.prototype.getTotCount=function(){return DOMHandler.getAttr(this.m_node,this.ATTR_TOT_COUNT);}
Model.prototype.getRowCount=function(){return this.m_rows.length;}
Model.prototype.isLastRow=function(){return((this.getRowPos()+1)==this.getRowCount());}
Model.prototype.isFirstRow=function(){return(this.getRowPos()==0);}
Model.prototype.getNextRow=function(){if(this.m_active&&!this.isLastRow()){this.setRowPos(this.getRowPos()+1);return true;}
return false;}
Model.prototype.getPreviousRow=function(){if(!this.isFirstRow()){this.setRowPos(this.getRowPos()-1);return true;}
return false;}
Model.prototype.getRowPos=function(){return this.m_rowPos;}
Model.prototype.setRowPos=function(rowPos){if(rowPos<this.getRowCount()){this.m_rowPos=rowPos;this.fetchRow();}
else{throw new Error(this.ER_OUT_OF_ROW_BOUNDS);}}
Model.prototype.setRowBOF=function(){this.setRowPos(-1);}
Model.prototype.setLastRow=function(){if(this.getRowCount()==0){throw new Error(this.ER_NO_ROWS);}
this.setRowPos(this.getRowCount()-1);}
Model.prototype.setFirstRow=function(){if(this.getRowCount()==0){throw new Error(this.ER_NO_ROWS);}
this.setRowPos(0);}
Model.prototype.deleteRows=function(ind,count){var row_count=this.getRowCount();if(ind<0||ind>=row_count){throw new Error(this.ER_IND_OUT_OF_BOUNDS);}
count=count||1;count=(count<=row_count)?count:row_count;var row;for(var i=0;i<count;i++){row=this.m_rows[i+ind];row.parentNode.removeChild(row);}
var last_pos=this.getRowCount()-1;var pos=this.getRowPos();pos=(pos>last_pos)?last_pos:pos;this.m_flagCleared=false;this.setRowPos(pos);return count;}
Model.prototype.appendRow=function(){var row=this.getNewRow();this.m_node.appendChild(row);this.m_rowPos=this.getRowCount()-1;}
Model.prototype.insertRow=function(ind){if(ind<0||ind>=this.getRowCount()){throw new Error(this.ER_IND_OUT_OF_BOUNDS);}
var sibl_node=this.m_rows[ind];var row=this.getNewRow();this.m_node.insertBefore(row,sibl_node);this.setRowPos(ind);}
Model.prototype.post=function(){var row_node=this.m_rows[this.m_rowPos];var ind=0;var node,val;for(var id in this.m_fields){val=this.m_fields[id].getValue();;node=row_node.childNodes[ind].childNodes[0];node.nodeValue=val;ind++;}}
Model.prototype.getFields=function(){return this.m_fields;} 
function ModelSingleRow(node){ModelSingleRow.superclass.constructor.call(this,node);}
extend(ModelSingleRow,Model);ModelSingleRow.prototype.setActive=function(active){if(active){this.createFields();this.setFirstRow();}
else{this.destructFields();}
this.m_active=active;}
ModelSingleRow.prototype.setNode=function(node){this.m_node=node;this.setActive(true);} 
function ModelServResponse(node){ModelServResponse.superclass.constructor.call(this,node);}
extend(ModelServResponse,ModelSingleRow);ModelServResponse.prototype.createFields=function(){this.m_rows=this.m_node.getElementsByTagName(this.ROW_TAG);this.m_rowCount=this.m_rows.length;if(this.m_rowCount){this.addField(new FieldInt("result"));this.addField(new Field("descr"));}} 
function PublicMethod(id){this.setId(id);this.m_params={};}
PublicMethod.prototype.ER_PARAM_NOT_FOUND="Поле '%' метода '%' не найден.";PublicMethod.prototype.m_id;PublicMethod.prototype.m_params;PublicMethod.prototype.paramExists=function(paramName){return(this.m_params[paramName]!=undefined);}
PublicMethod.prototype.getId=function(){return this.m_id;}
PublicMethod.prototype.setId=function(id){this.m_id=id;}
PublicMethod.prototype.addParam=function(param){this.m_params[param.getId()]=param;}
PublicMethod.prototype.removeParam=function(paramId){delete this.m_params[paramId];this.m_params[paramId]=undefined;}
PublicMethod.prototype.setParam=function(param){this.addParam(param);}
PublicMethod.prototype.checkParam=function(paramName){if(!this.paramExists(paramName)){throw new Error(CommonHelper.format(this.ER_PARAM_NOT_FOUND,Array(paramName,this.getId())));}
return true;}
PublicMethod.prototype.getParamById=function(paramId){this.checkParam(paramId);return this.m_params[paramId];}
PublicMethod.prototype.getParams=function(){return this.m_params;}
PublicMethod.prototype.setParamValue=function(paramName,value){try{this.m_params[paramName].setValue(value);}
catch(e){throw new Error("Public method: '"+this.getId()+"', param '"+paramName+"' not found.");}}
PublicMethod.prototype.getParamValue=function(paramName){return this.getParamById(paramName).getValue();} 
function ServConnector(host,script){this.setHost(host);this.setScript(script||this.DEF_SCRIPT);}
ServConnector.prototype.DEF_SCRIPT='index.php';ServConnector.prototype.ER_NO_RET_FUNC='Return function is not defined.';ServConnector.prototype.ENCTYPES={ENCODED:"application/x-www-form-urlencoded",MULTIPART:"multipart/form-data",TEXT:"text-plain"};ServConnector.prototype.m_host;ServConnector.prototype.m_script;ServConnector.prototype.m_http;ServConnector.prototype.getHost=function(){return this.m_host;}
ServConnector.prototype.setHost=function(host){this.m_host=host;}
ServConnector.prototype.getScript=function(){return this.m_script;}
ServConnector.prototype.setScript=function(script){this.m_script=script;}
ServConnector.prototype.queryParamsAsStr=function(params,encode){var paramStr="";for(var par_id in params){paramStr+=(paramStr=="")?"":"&";paramStr+=par_id+"=";paramStr+=(encode)?encodeURIComponent(params[par_id]):params[par_id];}
return paramStr;}
ServConnector.prototype.sendRequest=function(isGet,paramStr,async,onReturn,retContext,xmlResponse,enctype){xmlResponse=(xmlResponse==undefined)?true:xmlResponse;var request_id=uuid();async=(async==undefined)?true:async;if(onReturn==undefined){throw new Error(this.ER_NO_RET_FUNC);}
var self=this;this.m_http=createRequestObject();var ready_func=function(){if(self.m_http.readyState==4){var status=self.m_http.status;var error_n=(status>=200&&status<300)?0:status;var error_s;var resp;if(error_n==0){try{if(xmlResponse){resp=new ServResponse();resp.parse(self.m_http.responseXML);error_n=resp.getRespResult();if(error_n!=0){error_s=resp.getRespDescr();}}
else{resp=self.m_http.responseText;}}
catch(e){error_n=-1;error_s=e.message;}}
else{error_s=self.m_http.statusText;}
onReturn.call(retContext,error_n,error_s,resp,request_id);}};if(async){this.m_http.onreadystatechange=ready_func;}
var url=this.getHost()+this.getScript();var send_param=null;if(isGet){if(paramStr&&paramStr.length)
url=url+"?"+paramStr;}
this.m_http.open(isGet?"GET":"POST",url,async);if(!isGet){enctype=enctype||this.ENCTYPES.ENCODED;if(enctype==this.ENCTYPES.ENCODED){this.m_http.setRequestHeader("Content-Type",enctype);send_param=this.queryParamsAsStr(paramStr,false);}else if(enctype==this.ENCTYPES.MULTIPART){if(typeof FormData!=='undefined'){send_param=new FormData();for(var par_id in paramStr){if(paramStr[par_id]&&typeof paramStr[par_id]=="object"){for(var fi=0;fi<paramStr[par_id].length;fi++){send_param.append(par_id+"[]",paramStr[par_id][fi]);}}
else{send_param.append(par_id,paramStr[par_id]);}}}
else{var boundary=String(Math.random()).slice(2);var boundaryMiddle='--'+boundary+'\r\n';var boundaryLast='--'+boundary+'--\r\n';send_param=['\r\n'];for(var key in paramStr){send_param.push('Content-Disposition: form-data; name="'+key+'"\r\n\r\n'+paramStr[key]+'\r\n');}
send_param=send_param.join(boundaryMiddle)+boundaryLast;this.m_http.setRequestHeader('Content-Type','multipart/form-data; boundary='+boundary);}}}
this.m_http.send(send_param);if(!async){ready_func.call(this);}
return request_id;}
ServConnector.prototype.sendPost=function(paramStr,async,onReturn,retContext,xmlResponse,enctype){return this.sendRequest(false,paramStr,async,onReturn,retContext,xmlResponse,enctype);}
ServConnector.prototype.sendGet=function(paramStr,async,onReturn,retContext,xmlResponse,enctype){return this.sendRequest(true,paramStr,async,onReturn,retContext,xmlResponse,enctype);}
ServConnector.prototype.openHref=function(params,winParams){window.open(this.getHost()+this.getScript()+"?"+this.queryParamsAsStr(params,true),"_blank",winParams?winParams:"location=0,menubar=0,status=0,titlebar=0");} 
function ServResponse(){}
ServResponse.prototype.RESP_MODEL_ID='ModelServResponse';ServResponse.prototype.ERR_INDEX_OUT_OF_BOUNDS='Index out of bounds.';ServResponse.prototype.ERR_NO_MODEL='Model %s not found.';ServResponse.prototype.MODEL_TAG='model';ServResponse.prototype.MODEL_ATTR_ID="id";ServResponse.prototype.ER_EMPTY_RESPONSE="Server response string is empty.";ServResponse.prototype.m_xml;ServResponse.prototype.m_respResult;ServResponse.prototype.m_respDescr;ServResponse.prototype.m_models;ServResponse.prototype.parse=function(xml){if(xml==undefined){throw new Error(this.ER_EMPTY_RESPONSE);}
this.m_models={};this.m_xml=xml;var nodes=this.m_xml.documentElement.getElementsByTagName(this.MODEL_TAG);var id,new_model,obj_exists;for(var i=0;i<nodes.length;i++){id=DOMHandler.getAttr(nodes[i],this.MODEL_ATTR_ID);if(id){if(eval("typeof "+id+"== 'function'")){this.m_models[id]=eval("new "+id+"()");}
else{this.m_models[id]=new Model();}
this.m_models[id].setNode(nodes[i]);}}
var resp_model=this.getModelById(this.RESP_MODEL_ID);this.m_respResult=resp_model.result.getValue();this.m_respDescr=resp_model.descr.getValue();}
ServResponse.prototype.getRespResult=function(){return this.m_respResult;}
ServResponse.prototype.getRespDescr=function(){return this.m_respDescr;}
ServResponse.prototype.getModelCount=function(){return this.m_models.length;}
ServResponse.prototype.getModelByIndex=function(ind){if(ind>=this.getModelCount()){throw new Error(this.ERR_INDEX_OUT_OF_BOUNDS);}
return-1;}
ServResponse.prototype.modelExists=function(id){return(this.m_models[id]!=undefined);}
ServResponse.prototype.getModelById=function(id,active){if(!this.modelExists(id)){throw new Error(format(this.ERR_NO_MODEL,Array(id)));}
if(active){this.m_models[id].setActive(true);}
return this.m_models[id];} 
function Validator(){}
Validator.prototype.validate=function(val){return val;}
Validator.prototype.isValid=function(val){return true;} 
function ValidatorInt(){ValidatorInt.superclass.constructor.call(this);}
extend(ValidatorInt,Validator);ValidatorInt.prototype.isValid=function(val){return true;}
ValidatorInt.prototype.validate=function(val){if(val!=undefined&&typeof val!="number"){return parseInt(val,10);}
else{return val;}} 
function ValidatorString(){ValidatorInt.superclass.constructor.call(this);}
extend(ValidatorString,Validator);ValidatorString.prototype.isValid=function(val){return true;} 
function ValidatorFloat(){ValidatorFloat.superclass.constructor.call(this);}
extend(ValidatorFloat,Validator); 
function ValidatorDate(){ValidatorDate.superclass.constructor.call(this);}
extend(ValidatorDate,Validator);ValidatorDate.prototype.isValid=function(val){return true;} 
function ValidatorBool(){ValidatorBool.superclass.constructor.call(this);}
extend(ValidatorBool,Validator); 
function ValidatorTime(){ValidatorTime.superclass.constructor.call(this);}
extend(ValidatorTime,Validator);ValidatorTime.prototype.isValid=function(val){return true;} 
function ValidatorDateTime(){ValidatorDateTime.superclass.constructor.call(this);}
extend(ValidatorDateTime,Validator);ValidatorDateTime.prototype.isValid=function(val){return true;} 
function ValidatorCellPhone(){ValidatorCellPhone.superclass.constructor.call(this);}
extend(ValidatorCellPhone,Validator);ValidatorCellPhone.prototype.isValid=function(val){return true;} 
function ValidatorJSON(options){ValidatorJSON.superclass.constructor.call(this,options);}
extend(ValidatorJSON,Validator);ValidatorJSON.prototype.correctValue=function(v){return CommonHelper.unserialize(v);} 
function ListFilter(){this.m_params={};}
ListFilter.prototype.m_params;ListFilter.prototype.addFilter=function(id,filter){this.m_params[id]={};this.m_params[id]["iniValue"]=(filter.iniValue==undefined)?'':filter.iniValue;this.m_params[id]["sign"]=filter.sign;this.m_params[id]["l_wcards"]=(filter.l_wcards==undefined)?false:filter.l_wcards;this.m_params[id]["r_wcards"]=(filter.r_wcards==undefined)?false:filter.r_wcards;this.m_params[id]["keyFieldIds"]=filter.keyFieldIds;this.m_params[id]["valueFieldId"]=filter.valueFieldId;this.m_params[id]["icase"]=(filter.icase==undefined)?false:filter.icase;this.m_params[id]["descr"]=filter.descr;this.m_params[id]["key"]=filter.key;}
ListFilter.prototype.setParamValue=function(id,paramId,ParamValue){this.m_params[id][paramId]=ParamValue;}
ListFilter.prototype.getParamValue=function(id,paramId){return this.m_params[id][paramId];}
ListFilter.prototype.getParams=function(struc){struc.field_sep=struc.field_sep||"@";for(var ctrl_id in this.m_params){var val;if(this.m_params[ctrl_id].valueFieldId){val=this.m_params[ctrl_id].descr;if(val&&val!="undefined"){if(this.m_params[ctrl_id].sign=='lk'){if(this.m_params[ctrl_id].l_wcards){val='%'+val;}
if(this.m_params[ctrl_id].r_wcards){val+='%';}}
struc.fields=(struc.fields==null)?"":struc.fields;struc.fields+=(struc.fields=="")?"":struc.field_sep;struc.fields+=this.m_params[ctrl_id].valueFieldId;struc.signs=(struc.signs==null)?"":struc.signs;struc.signs+=(struc.signs=="")?"":struc.field_sep;struc.signs+=this.m_params[ctrl_id].sign;struc.vals=(struc.vals==null)?"":struc.vals;struc.vals+=(struc.vals=="")?"":struc.field_sep;struc.vals+=val;struc.icase=(struc.icase==null)?"":struc.icase;struc.icase+=(struc.icase=="")?"":struc.field_sep;struc.icase+=(this.m_params[ctrl_id].icase==true)?'1':'0';}}
if(this.m_params[ctrl_id].keyFieldIds){for(var i=0;i<this.m_params[ctrl_id].keyFieldIds.length;i++){var key=this.m_params[ctrl_id].keyFieldIds[i];val=this.m_params[ctrl_id].key;if(val&&val!="undefined"){struc.fields=(struc.fields==null)?"":struc.fields;struc.fields+=(struc.fields=="")?"":struc.field_sep;struc.fields+=key;struc.signs=(struc.signs==null)?"":struc.signs;struc.signs+=(struc.signs=="")?"":struc.field_sep;struc.signs+=this.m_params[ctrl_id].sign;struc.vals=(struc.vals==null)?"":struc.vals;struc.vals+=(struc.vals=="")?"":struc.field_sep;struc.vals+=val;struc.icase=(struc.icase==null)?"":struc.icase;struc.icase+=(struc.icase=="")?"":struc.field_sep;struc.icase+=(this.m_params[ctrl_id].icase==true)?'1':'0';}}}}}
ListFilter.prototype.setClickContext=function(){}
ListFilter.prototype.setOnRefresh=function(){}
ListFilter.prototype.toDOM=function(){}
ListFilter.prototype.removeDOM=function(){} 
function ListGroupper(){this.m_params=[];}
ListGroupper.prototype.m_params;ListGroupper.prototype.FIELD_SEPAR=",";ListGroupper.prototype.addGroup=function(id,group){group.ind=this.m_params.length;this.m_params.push(group);}
ListGroupper.prototype.moveUp=function(ind){if(ind>0&&this.m_params.length>=2){var tmp=this.m_params[ind-1];this.m_params[ind-1]=this.m_params[ind];this.m_params[ind]=tmp;return true;}}
ListGroupper.prototype.moveDown=function(ind){if(ind<this.m_params.length&&this.m_params.length>=2){var tmp=this.m_params[ind+1];this.m_params[ind+1]=this.m_params[ind];this.m_params[ind]=tmp;return true;}}
ListGroupper.prototype.getParams=function(){str='';for(var i=0;i<this.m_params.length;i++){if(this.m_params[i].isset){str+=(str=='')?'':this.FIELD_SEPAR;str+=this.m_params[i].field;}}
return str;}
ListGroupper.prototype.setClickContext=function(){}
ListGroupper.prototype.setOnRefresh=function(){}
ListGroupper.prototype.toDOM=function(){}
ListGroupper.prototype.removeDOM=function(){} 
function ConstantManager(options){options=options||{};this.m_values=options.values||{};}
ConstantManager.prototype.m_values;ConstantManager.prototype.setValFromModel=function(m){var v_t=m.getFieldValue("val_type");var v=m.getFieldValue("val");var v_class;var v_id=m.getFieldValue("id");if(v_t=="Int"){v_class=FieldInt;}
else if(v_t=="Float"){v_class=FieldFloat;}
else if(v_t=="DateTime"){v_class=FieldDateTime;}
else if(v_t=="Date"){v_class=FieldDate;}
else if(v_t=="Bool"){v_class=FieldBool;}
else{v_class=FieldString;}
this.m_values[v_id]=new v_class(v_id,{"value":v});}
ConstantManager.prototype.get=function(constants,callBack){var not_found="";var not_found_ar=[];var QUERY_SEP=",";for(var id in constants){if(this.m_values[id]){constants[id]=this.m_values[id];}
else{not_found+=(not_found=="")?"":QUERY_SEP;not_found+=id;not_found_ar.push(id);}}
if(not_found!=""){var self=this;var contr=new Constant_Controller(new ServConnector(HOST_NAME))
contr.run("get_values",{"async":(callBack!=undefined),"params":{"id_list":not_found},"func":function(resp){var m=resp.getModelById("ConstantValueList_Model");m.setActive(true);if(m.getNextRow()){self.setValFromModel(m)
m.getFieldValue('id')}
for(var i=0;i<not_found_ar.length;i++){constants[not_found_ar[i]]=self.m_values[not_found_ar[i]];}
if(callBack){callBack(constants)}}});}else if(callBack){callBack(constants)}}
ConstantManager.prototype.set=function(id,val,callBack){var self=this;var contr=new Constant_Controller(new ServConnector(HOST_NAME))
contr.run("set_value",{"params":{"id":id,"val":JSON.stringify(val)},"func":function(resp){if(self.m_values[id]){self.m_values[id]=val;}
if(callBack){callBack();}}});} 
var CommonHelper={format:function(str,params){if(!str)return"";var r=str;if(typeof(params)=="string"){params=[params];}
debugger
for(var i=0;i<params.length;i++){r=r.replace("%",params[i]);}
return r;},numberFormat:function(number,decimals,dec_point,thousands_sep){var i,j,kw,kd,km;if(isNaN(decimals=Math.abs(decimals))){decimals=2;}
if(dec_point==undefined){dec_point=",";}
if(thousands_sep==undefined){thousands_sep=".";}
i=parseInt(number=(+number||0).toFixed(decimals))+"";if((j=i.length)>3){j=j%3;}else{j=0;}
km=(j?i.substr(0,j)+thousands_sep:"");kw=i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+thousands_sep);kd=(decimals?dec_point+Math.abs(number-i).toFixed(decimals).replace(/-/,0).slice(2):"");if(number<0&&km==""&&kw=="0"&&kd.length){km="-"+km;}
return km+kw+kd;},byteForamt:function(size,precision){return this.byteFormat(size,precision);},byteFormat:function(size,precision,rightPad){precision=(precision==undefined)?2:precision;var i=Math.floor(Math.log(size)/Math.log(1024));return(size/Math.pow(1024,i)).toFixed(precision)*1+(rightPad?" ":"")+['B','kB','MB','GB','TB'][i];},dateFormat:function(dt,fs,localeId){var add_zero=function(arg){var s=arg.toString();return((s.length<2)?"0":"")+s;};if(!dt||!dt.getDate){return"";}
if(!fs){fs="Y-m-dTH:i:s";}
var s;s=fs.replace(/d/,add_zero(dt.getDate()));s=s.replace(/j/,dt.getDate());s=s.replace(/FF/,DateHelper.MON_LIST[dt.getMonth()]);s=s.replace(/F/,DateHelper.MON_DATE_LIST[dt.getMonth()]);s=s.replace(/l/,DateHelper.WEEK_LIST[dt.getDay()]);s=s.replace(/m/,add_zero(dt.getMonth()+1));s=s.replace(/n/,dt.getMonth()+1);s=s.replace(/Y/,dt.getFullYear());s=s.replace(/y/,dt.getFullYear()-2000);s=s.replace(/H/,add_zero(dt.getHours()));s=s.replace(/i/,add_zero(dt.getMinutes()));s=s.replace(/s/,add_zero(dt.getSeconds()));s=s.replace(/u/,add_zero(dt.getMilliseconds()));return s;},maskFormat:function(val,mask){var input=new Control(null,"INPUT",{"attrs":{"value":val},"visible":false});$(input.getNode()).mask(mask);return input.m_node.value;},nd:function(x,docum){if(docum==undefined){docum=window.document;}
return(x)?docum.getElementById(x):null;},isIE:function(){var browserSpecs=this.getBrowser();return(browserSpecs.name=='IE'||browserSpecs.name=='MSIE');},getIEVersion:function(){var browserSpecs=this.getBrowser();return browserSpecs.version;},getBrowser:function(){var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|yabrowser|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];return{name:'IE',version:(tem[1]||'')};}
if(M[1]==='Chrome'){tem=ua.match(/\b(OPR|Edge)\/(\d+)/);if(tem!=null)return{name:tem[1].replace('OPR','Opera'),version:tem[2]};}
M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,'-?'];if((tem=ua.match(/version\/(\d+)/i))!=null)M.splice(1,1,tem[1]);return{name:M[0],version:M[1]};},createXHR:function(){var xhr;if(window.XMLHttpRequest){xhr=new XMLHttpRequest();}
else{xhr=new ActiveXObject("Microsoft.XMLHTTP");}
return xhr;},createCORS:function(){var xhr=new XMLHttpRequest();if("withCredentials"in xhr){}
else if(typeof XDomainRequest!="undefined"){xhr=new XDomainRequest();}
else{xhr=null;throw new Error("CORS is not supported by the browser");}
return xhr;},isEmpty:function(x,p){for(p in x)return!1;return!0;},isArray:function(o){if(Array.isArray){return Array.isArray(o);}
else{return(Object.prototype.toString.call(o)==='[object Array]');}},clone:function(obj){var F=function(){};F.prototype=obj;return new F();},uniqid:function(){var chars='0123456789abcdef'.split('');var uuid=[],rnd=Math.random,r;uuid[8]=uuid[13]=uuid[18]=uuid[23]='-';uuid[14]='4';for(var i=0;i<36;i++){if(!uuid[i]){r=0|rnd()*16;uuid[i]=chars[(i==19)?(r&0x3)|0x8:r&0xf];}}
return uuid.join('');},array2json:function(arr){return JSON.stringify(arr);},json2obj:function(json_string){return(json_string)?JSON.parse(json_string):json_string;},serialize:function(o){if(typeof(o)==="string"){return o;}
else if(typeof(o)==="number"||typeof(o)==="boolean"){return o.toString();}
else if(typeof(o)==="object"&&DateHelper.isValidDate(o)){if(window["FieldDateTimeTZ"]){return(FieldDateTimeTZ({"value":o})).getValueXHR();}
else{return o;}}
else{return JSON.stringify(o);}},unserialize:function(json_string){return(json_string&&typeof(json_string)=="string"&&json_string.length&&(json_string.substring(0,1)=="{"||json_string.substring(0,1)=="["))?JSON.parse(json_string,function(key,val){if(val&&typeof val=="object"&&"descr"in val&&"keys"in val){if("dataType"in val&&window[val.dataType]){val=new window[val.dataType](val);}
else{val=new RefType(val);}}
return val;}):json_string;},findPosX:function(obj){var curleft=0;if(obj.offsetParent){while(1){curleft+=obj.offsetLeft;if(!obj.offsetParent){break;}
obj=obj.offsetParent;}}else if(obj.x){curleft+=obj.x;}
return curleft;},findPosY:function(obj){var curtop=0;if(obj.offsetParent){while(1){curtop+=obj.offsetTop;if(!obj.offsetParent){break;}
obj=obj.offsetParent;}}else if(obj.y){curtop+=obj.y;}
return curtop;},getDecimalSeparator:function(){var n=1.1;n=n.toLocaleString().substring(1,2);return n;},escapeDoubleQuotes:function(str){return str.replace(/\\([\s\S])|(")/g,"\\$1$2");},longString:function(funcWrapper){var funcString=funcWrapper.toString();var funcDefinitionRe=/^function\s*[a-zA-Z0-9_$]*\s*\(\s*\)\s*{\s*\/\*([\s\S]*)\*\/\s*}\s*$/g;var wantedString=funcString.replace(funcDefinitionRe,"$1").trim();return wantedString;},merge:function(o1,o2){for(var id in o2){o1[id]=o2[id];}},getClassName:function(o){return Object.prototype.toString.call(o).match(/^\[object\s(.*)\]$/)[1];},md5:function(s){return hex_md5(s);},dateInArray:function(needle,haystack){for(var i=0;i<haystack.length;i++){if(needle.getTime()===haystack[i].getTime()){return i;}}
return-1;},getElementsByAttr:function(classStr,node,attrName,uniq,tag){if(typeof(node)=="string"){node=document.getElementById(node);}
tag=tag||"*";var node=node||document;var list=node.getElementsByTagName(tag);var length=list.length;var classArray=classStr.split(/\s+/);var classes=classArray.length;var result=new Array();for(var i=0;i<length;i++){if(uniq&&result.length>0)break;for(var j=0;j<classes;j++){if(((attrName=='class')&&(list[i].className!=undefined&&typeof list[i].className=='string')&&(list[i].className.search('\\b'+classArray[j]+'\\b')!=-1))||((list[i].attributes!=undefined)&&(list[i].getAttribute(attrName)!=undefined)&&(list[i].getAttribute(attrName).search('\\b'+classArray[j]+'\\b')!=-1))){result.push(list[i]);break;}}}
return result;},inArray:function(v,ar){var res;if(typeof(v)=="object"&&DateHelper.isValidDate(v)){res=this.dateInArray(v,ar);}
else{res=$.inArray(v,ar);}
return res;},var_export:function(o){var output="";if(typeof(o)=="object"){for(var property in o){output+=property+": "+o[property]+"; ";}}
else{output=(o)?o.toString():"<undefined>";}
return output;},log:function(msg){if(console&&console.log){console.log(CommonHelper.var_export(msg));}},include_js:function(fl){var h=document.getElementsByTagName("head")[0];if(DOMHelper.getElementsByAttr(fl,h,"src",true,"script").length)
return;var fileref=document.createElement("script");fileref.setAttribute("type","text/javascript");fileref.setAttribute("src",fl);alert("appending "+fl)
h.appendChild(fileref);console.dir(fileref)},functionName:function(func){var result=/^function\s+([\w\$]+)\s*\(/.exec(func.toString());return result?result[1]:undefined;},hash:function(str){var hash=0,i,chr;if(str.length===0)return hash;for(i=0;i<str.length;i++){chr=str.charCodeAt(i);hash=((hash<<5)-hash)+chr;hash|=0;}
return hash;},ID:function(){return'_'+Math.random().toString(36).substr(2,9);},getCookie:function(c_name){var c_value=" "+document.cookie;var c_start=c_value.indexOf(" "+c_name+"=");if(c_start==-1){c_value=null;}
else{c_start=c_value.indexOf("=",c_start)+1;var c_end=c_value.indexOf(";",c_start);if(c_end==-1){c_end=c_value.length;}
c_value=unescape(c_value.substring(c_start,c_end));}
return c_value;},delNode:function(node){if(typeof(node)=="string"){node=document.getElementById(node);}
if(node&&node.parentNode)
node.parentNode.removeChild(node);}} 
var DateHelper={DEF_FORMAT:"Y-m-dTH:i:s",time:function(){return new Date();},strtotime:function(dateStr){if(typeof(dateStr)==="object"&&this.isValidDate(dateStr)){return dateStr;}
else if(!dateStr||!dateStr.length){return;}
var parsed=Date.parse(dateStr);if(isNaN(parsed)){var parts=dateStr.match(/^(\d{4})[\.|\\/|-](\d{2})[\.|\\/|-](\d{2})[T|\s](\d{2})\:(\d{2})\:?(\d{0,2})\.?(\d{0,6})([+-])(\d{2})\:?(\d{2})?$/);if(parts){if(parts[5]==undefined||parts[5]=="")parts[5]="00";if(parts[6]==undefined||parts[6]=="")parts[6]="00";if(parts[7]==undefined||parts[7]=="")parts[7]="0";if(parts[10]==undefined)parts[10]="00";parsed=Date.parse(parts[1]+"-"+parts[2]+"-"+parts[3]+"T"+parts[4]+":"+parts[5]+":"+parts[6]+"."+parts[7]+parts[8]+parts[9]+":"+parts[10]);}
else{var parts=dateStr.split(/\D+/);for(i=0;i<parts.length;i++){if(parts[i]==undefined)parts[i]="00";}
if(parts.length<7)parts[6]="0000";parsed=Date.parse(parts[0]+"-"+parts[1]+"-"+parts[2]+"T"+parts[3]+":"+parts[4]+":"+parts[5]+"."+parts[6]);}}
return new Date(parsed);},getTimeZoneOffsetStr:function(){if(!this.m_timeZoneOffsetStr){var h_offset=-(new Date()).getTimezoneOffset()/60;var h_offset_h=Math.floor(h_offset);function to_str(a){return((a.toString().length==1)?"0":"")+a.toString();}
this.m_timeZoneOffsetStr=((h_offset_h<0)?"-":"+")+to_str(Math.abs(h_offset_h))+":"+to_str(Math.abs((h_offset-h_offset_h)*60));}
return this.m_timeZoneOffsetStr;},userStrToDate:function(dateStr){var SHORT_YEAR_LEN=8;var FULL_YEAR_LEN=10;var time=new Array(0,0,0);var date=new Array(0,0,0);var time_part='',date_part='';var TIME_DELIM=':';var DATE_DELIM='.';var PARTS_DELIM=' ';var NEXT_MIL_BOUND=40;var str_replace_delim=function(str,delim_ar,new_delim){if(str&&str.length){for(var i=0;i<delim_ar.length;i++){while(str.search(delim_ar[i])>=00){str=str.replace(delim_ar[i],new_delim);}}}
return str;};var date_str_copy=str_replace_delim(dateStr,new Array(/T/),PARTS_DELIM);var separ=date_str_copy.indexOf(PARTS_DELIM);if(separ>=0){date_part=date_str_copy.slice(0,separ);time_part=date_str_copy.substr(separ+1);}
else{if(date_str_copy.indexOf(TIME_DELIM)==-1){date_part=date_str_copy;}
else{time_part=date_str_copy;}}
date_part=str_replace_delim(date_part,new Array(/\//,/-/,/:/),DATE_DELIM);time_part=str_replace_delim(time_part,new Array(/ /,/-/,/\//),TIME_DELIM);if(date_part.length>0){date=date_part.split(DATE_DELIM);}
if(time_part.length>0){time=time_part.split(TIME_DELIM);}
if(date.length&&date[0].length==4){var y=date[0];date[0]=date[2];date[2]=y;}
else if(date.length>=3&&date[2].length==2){date[2]=parseInt(date[2],10);date[2]+=(date[2]<=NEXT_MIL_BOUND)?2000:1900;}
if(time[2]==undefined){time[2]=0;}
date[1]=(date[1]==0)?0:date[1]-1;return(new Date(date[2],date[1],date[0],time[0],time[1],time[2]));},format:function(dt,fs,localeId){var add_zero=function(arg){var s=arg.toString();return((s.length<2)?"0":"")+s;};if(!dt||!dt.getDate){return"";}
if(!fs){fs=this.DEF_FORMAT;}
var s;s=fs.replace(/d/,add_zero(dt.getDate()));s=s.replace(/j/,dt.getDate());s=s.replace(/FF/,DateHelper.MON_LIST[dt.getMonth()]);s=s.replace(/F/,DateHelper.MON_DATE_LIST[dt.getMonth()]);s=s.replace(/l/,DateHelper.WEEK_LIST[dt.getDay()]);s=s.replace(/m/,add_zero(dt.getMonth()+1));s=s.replace(/n/,dt.getMonth()+1);s=s.replace(/Y/,dt.getFullYear());s=s.replace(/y/,dt.getFullYear()-2000);s=s.replace(/H/,add_zero(dt.getHours()));s=s.replace(/i/,add_zero(dt.getMinutes()));s=s.replace(/s/,add_zero(dt.getSeconds()));s=s.replace(/u/,add_zero(dt.getMilliseconds()));return s;},timeToMS:function(timeStr){if(timeStr==undefined||!timeStr.split){return 0;}
var h,m;var time_ar=timeStr.split(":");var h=0;var m=0;var s=0;var ms=0;if(time_ar.length>=1){h=parseInt(time_ar[0][0],10)*10+
parseInt(time_ar[0][1],10);h=(isNaN(h)?0:h);}
if(time_ar.length>=2){m=parseInt(time_ar[1][0],10)*10+
parseInt(time_ar[1][1],10);m=(isNaN(m)?0:m);}
if(time_ar.length>=3){s=parseInt(time_ar[2][0],10)*10+
parseInt(time_ar[2][1],10);s=(isNaN(s)?0:s);}
return(h*60*60*1000+m*60*1000+s*1000+ms);},dateEnd:function(dt){if(!dt)dt=this.time();return new Date(dt.getFullYear(),dt.getMonth(),dt.getDate(),23,59,59,999);},dateStart:function(dt){if(!dt)dt=this.time();return new Date(dt.getFullYear(),dt.getMonth(),dt.getDate(),0,0,0,0);},weekStart:function(dt){if(!dt)dt=this.time();var dow=dt.getDay();var dif=dow-1;if(dif<0)dif=6;return(new Date(dt.getTime()-dif*24*60*60*1000));},weekEnd:function(dt){return new Date(this.weekStart(dt).getTime()+6*24*60*60*1000);},monthStart:function(dt){if(!dt)dt=this.time();return(new Date(dt.getFullYear(),dt.getMonth(),1));},monthEnd:function(dt){if(!dt)dt=this.time();return(new Date(dt.getFullYear(),dt.getMonth()+1,0));},daysInMonth:function(dt){return new Date(dt.getFullYear(),dt.getMonth()+1,0).getDate();},quarterStart:function(dt){if(!dt)dt=this.time();var m=dt.getMonth();if(m==1||m==2){m=0;}
else if(m==4||m==5){m=3;}
else if(m==7||m==8){m=6;}
else if(m==10||m==11){m=9;};return(new Date(dt.getFullYear(),m,1));},quarterEnd:function(dt){if(!dt)dt=this.time();var m=dt.getMonth();if(m==0||m==1){m=2;}
else if(m==3||m==4){m=5;}
else if(m==6||m==7){m=8;}
else if(m==9||m==10){m=11;};return this.monthEnd(new Date(dt.getFullYear(),m,1));},yearStart:function(dt){if(!dt)dt=this.time();return new Date(dt.getFullYear(),0,1);},yearEnd:function(dt){if(!dt)dt=this.time();return(new Date(dt.getFullYear(),12,0));},addBusinessDays:function(d,n){d=new Date(d.getTime());var day=d.getDay();d.setDate(d.getDate()+n+((day===6)?2:(+!day))+(Math.floor((n-1+(day%6||1))/5)*2));return d;},isValidDate:function(d){return d instanceof Date&&!isNaN(d);},isLeapYear:function(d){var year=(typeof(d)=="object")?d.getFullYear():d;return year%400===0||(year%100!==0&&year%4===0);},daysOfAYear:function(d){return this.isLeapYear(d)?366:365;},formatInterval(v){}}
DateHelper.MON_DATE_LIST=Array("Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря");DateHelper.MON_LIST=Array("Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь");DateHelper.WEEK_LIST=Array("Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота");DateHelper.FORMAT_STR="d/m/Y H:i:s"; 
var DOMHelper={INVIS_CLASS:"hidden",elem:function(tagName,opts){var e=document.createElement(tagName);opts=opts||{};for(var i in opts){e.setAttribute(i,opts[i]);}
return(e);},setAttr:function(node,attrName,attrValue){if(typeof(node)=="string"){node=document.getElementById(node);}
if(node){node.setAttribute(attrName,attrValue);}},getAttr:function(node,name){if(typeof(node)=="string"){node=document.getElementById(node);}
if(node&&node.attributes){return node.getAttribute(name);}},delAttr:function(node,name){if(typeof(node)=="string"){node=document.getElementById(node);}
if(node){return node.removeAttribute(name);}},addAttr:function(node,name,val){this.setAttr(node,name,val);},delNode:function(node){if(typeof(node)=="string"){node=document.getElementById(node);}
if(node&&node.parentNode)
node.parentNode.removeChild(node);},delNodesOnClass:function(classVal){this.delNodesOnAttr("class",classVal)},delNodesOnAttr:function(attrName,attrVal){var body=document.getElementsByTagName("body")[0];var list=this.getElementsByAttr(attrVal,body,attrName);for(var i=0;i<list.length;i++){this.delNode(list[i]);}},delAllChildren:function(node){if(typeof(node)=="string"){node=document.getElementById(node);}
while(node&&node.firstChild){node.removeChild(node.firstChild);}},getElementsByAttr:function(classStr,node,attrName,uniq,tag){if(typeof(node)=="string"){node=document.getElementById(node);}
tag=tag||"*";var node=node||document;var list=node.getElementsByTagName(tag);var length=list.length;var classArray=classStr.split(/\s+/);var classes=classArray.length;var result=new Array();for(var i=0;i<length;i++){if(uniq&&result.length>0)break;for(var j=0;j<classes;j++){if(((attrName=='class')&&(list[i].className!=undefined&&typeof list[i].className=='string')&&(list[i].className.search('\\b'+classArray[j]+'\\b')!=-1))||((list[i].attributes!=undefined)&&(list[i].getAttribute(attrName)!=undefined)&&(list[i].getAttribute(attrName).search('\\b'+classArray[j]+'\\b')!=-1))){result.push(list[i]);break;}}}
return result;},swapClasses:function(node,new_class,old_class){if(typeof(node)=="string"){node=document.getElementById(node);}
if(node)node.className=node.className.replace(old_class,new_class);},addClass:function(node,classToAdd){var re=new RegExp("(^|\\s)"+classToAdd+"(\\s|$)","g");if(!node||re.test(node.className))return;node.className=(node.className+" "+classToAdd).replace(/\s+/g," ").replace(/(^ | $)/g,"");},delClass:function(node,classToRemove){if(typeof(node)=="string"){node=document.getElementById(node);}
if(!node||!node.className)return;var re=new RegExp("(^|\\s)"+classToRemove+"(\\s|$)","g");node.className=node.className.replace(re,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,"");},hasClass:function(node,classToCheck){return(node)?(node.className&&new RegExp("(^|\\s)"+classToCheck+"(\\s|$)").test(node.className)):null;},getParentByTagName:function(node,tagName){if(typeof(node)=="string"){node=document.getElementById(node);}
var p=node.parentNode;if(p){var tn=tagName.toLowerCase();while(p&&p.nodeName.toLowerCase()!=tn){p=p.parentNode;}
return((p&&p.nodeName.toLowerCase()==tn)?p:null);}},getParentByAttrValue:function(node,attrName,attrVal){if(typeof(node)=="string"){node=document.getElementById(node);}
var p=node;if(p){while(p&&p.attributes&&p.getAttribute(attrName)!=attrVal){p=p.parentNode;}
return((p&&p.attributes&&p.getAttribute(attrName)==attrVal)?p:null);}},getElementIndex:function(node){var i=0;while(node=node.previousSibling){if(node.nodeType===1){i++;}}
return i;},xmlDocFromString:function(txt){return $.parseXML(txt);},htmlDocFromString:function(txt){return $.parseHTML(txt);},setTagName:function(node,tag){if(typeof(node)=="string"){node=document.getElementById(node);}
var oHTML=node.outerHTML;var tempTag=document.createElement(tag);var tName={original:node.tagName.toUpperCase(),change:tag.toUpperCase()};if(tName.original==tName.change)return;oHTML=oHTML.replace(RegExp("(^\<"+tName.original+")|("+tName.original+"\>$)","gi"),function(x){return(x.toUpperCase().replace(tName.original,tName.change));});tempTag.innerHTML=oHTML;if(tempTag.firstChild)node.parentElement.replaceChild(tempTag.firstChild,node);},swapNodes:function(a,b){var aParent=a.parentNode;var bParent=b.parentNode;var aHolder=document.createElement("div");var bHolder=document.createElement("div");aParent.replaceChild(aHolder,a);bParent.replaceChild(bHolder,b);aParent.replaceChild(b,aHolder);bParent.replaceChild(a,bHolder);},setParent:function(el,newParent){newParent.appendChild(el);},inViewport:function(el,fullyInView){var pageTop=$(window).scrollTop();var pageBottom=pageTop+$(window).height();var elementTop=$(el).offset().top;var elementBottom=elementTop+$(el).height();if(fullyInView===true){return((pageTop<elementTop)&&(pageBottom>elementBottom));}else{return((elementTop<=pageBottom)&&(elementBottom>=pageTop));}},getViewportHeight:function(){if(window.innerHeight!=window.undefined)return window.innerHeight;if(document.compatMode=='CSS1Compat')return document.documentElement.clientHeight;if(document.body)return document.body.clientHeight;return window.undefined;},getViewportWidth:function(){var offset=17;var width=null;if(window.innerWidth!=window.undefined)return window.innerWidth;if(document.compatMode=='CSS1Compat')return document.documentElement.clientWidth;if(document.body)return document.body.clientWidth;},getOffset:function(elem){if(elem.getBoundingClientRect){return this.getOffsetRect(elem);}
else{return this.getOffsetSum(elem);}},getOffsetRect:function(elem){var box=elem.getBoundingClientRect();var body=document.body;var docElem=document.documentElement;var scrollTop=window.pageYOffset||docElem.scrollTop||body.scrollTop;var scrollLeft=window.pageXOffset||docElem.scrollLeft||body.scrollLeft;var clientTop=docElem.clientTop||body.clientTop||0;var clientLeft=docElem.clientLeft||body.clientLeft||0;var top=box.top+scrollTop-clientTop;var left=box.left+scrollLeft-clientLeft;return{top:Math.round(top),left:Math.round(left)};},getOffsetSum:function(elem){var top=0,left=0;while(elem){top=top+parseInt(elem.offsetTop);left=left+parseInt(elem.offsetLeft);elem=elem.offsetParent;}
return{top:top,left:left};},parseTemplate:function(t,nId){var res=t.replace(/{{id}}/g,nId);var matches=res.match(/{{.*}}/g);if(matches){for(var i=0;i<matches.length;i++){res=res.split(matches[i]).join(eval(matches[i].substring(2,matches[i].length-2)));}}
return res;},firstChildElement:function(n,nodeType){if(typeof(n)=="string"){n=document.getElementById(n);}
if(n&&n.childNodes){nodeType=(nodeType==undefined)?1:nodeType;for(var i=0;i<n.childNodes.length;i++){if(n.childNodes[i].nodeType==nodeType){return n.childNodes[i];}}}},lastChildElement:function(n){if(typeof(n)=="string"){n=document.getElementById(n);}
if(n&&n.childNodes){for(var i=n.childNodes.length-1;i>=0;i--){if(n.childNodes[i].nodeType==1){return n.childNodes[i];}}}},lastText:function(n){return this.getText(n);},getText:function(n){if(typeof(n)=="string"){n=document.getElementById(n);}
if(n&&n.tagName=="INPUT"){return n.value;}else if(n&&n.childNodes){for(var i=n.childNodes.length-1;i>=0;i--){if(n.childNodes[i].nodeType==3){return n.childNodes[i].nodeValue;}}}},setText:function(n,t){if(typeof(n)=="string"){n=document.getElementById(n);}
var v_set=false;var t_n;if(n&&n.tagName=="INPUT"){n.value=t;v_set=true;}else if(n&&n.childNodes){for(var i=n.childNodes.length-1;i>=0;i--){if(n.childNodes[i].nodeType==3){n.childNodes[i].nodeValue=t;v_set=true;t_n=n.childNodes[i];break;}}}
if(n&&!v_set){t_n=document.createTextNode(t);n.appendChild(t_n);}
return t_n;},insertAfter:function(elem,refElem){if(!refElem)return;var parent=refElem.parentNode;var next=refElem.nextSibling;if(next){return parent.insertBefore(elem,next);}else{return parent.appendChild(elem);}},show:function(n){if(typeof(n)=="string"){n=document.getElementById(n);}
if(n){this.delClass(n,this.INVIS_CLASS);}},hide:function(n){if(typeof(n)=="string"){n=document.getElementById(n);}
if(n){this.addClass(n,this.INVIS_CLASS);}},visible:function(n){if(typeof(n)=="string"){n=document.getElementById(n);}
return!this.hasClass(n,this.INVIS_CLASS);},toggle:function(n){if(typeof(n)=="string"){n=document.getElementById(n);}
if(this.visible(n)){this.hide(n);}
else{this.show(n);}},init:function(){Node=Node||{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12};},previewImage:function(fileInput,imgNode){if(fileInput.files&&fileInput.files[0]){var reader=new FileReader();reader.onload=function(e){DOMHelper.addAttr(imgNode,"src",e.target.result);}
reader.readAsDataURL(fileInput.files[0]);}},tableToExcel:function(table,name,fileName){var uri='data:application/vnd.ms-excel;base64,',template='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table>{table}</table></body></html>',base64=function(s){return window.btoa(unescape(encodeURIComponent(s)))},format=function(s,c){return s.replace(/{(\w+)}/g,function(m,p){return c[p];})},downloadURI=function(uri,name){var link=document.createElement("a");link.download=name;link.href=uri;link.click();}
if(!table.nodeType)table=document.getElementById(table);var ctx={worksheet:name||'Worksheet',table:table.innerHTML};var resuri=uri+base64(format(template,ctx));downloadURI(resuri,fileName);}} 
function FatalException(options){this.m_code=options.code;this.m_message=options["message"];this.m_cmdOk=options.cmdOk;this.m_templateOptions=options.templateOptions;this.m_viewAddElement=options.viewAddElement;}
FatalException.prototype.TEMPLATE_ID="FatalException";FatalException.prototype.show=function(){if(document.getElementById("ex_"+this.m_code+":form")){return;}
var p=window.location.href.indexOf("?");var redir;if(p>=0){redir=JSON.stringify({"ref":window.location.href.substr(p+1)});}
var opts=this.m_templateOptions||{};if(this.m_code){opts.code=this.m_code;}
if(this.m_message){opts["message"]=this.m_message;}
var app=window.getApp();opts.url=app.getServVar("basePath")+(redir?"?redir="+redir:"");var view_opts={"template":app.getTemplate(this.TEMPLATE_ID),"templateOptions":opts};var self=this;if(this.m_viewAddElement){view_opts.addElement=function(){self.m_viewAddElement.call(this);}}
app.m_dbExceptionForm=new WindowFormModalBS("ex_"+this.m_code+":form",{"cmdCancel":false,"cmdOk":this.m_cmdOk,"content":new ControlContainer("ex_"+this.m_code+":view:body:view","TEMPLATE",view_opts),"contentHead":this.HEADER,"onClickOk":!this.m_cmdOk?null:(function(form){return function(){form.close();}})(app.m_dbExceptionForm)});app.m_dbExceptionForm.open();} 
function DbException(options){options.cmdOk=true;DbException.superclass.constructor.call(this,options);}
extend(DbException,FatalException);DbException.prototype.TEMPLATE_ID="DbException"; 
function VersException(){options={};options.cmdOk=false;options.cmdCancel=false;var self=this;options.viewAddElement=function(){var delay=window.getApp().getUpdateInstPostponeDelay();this.addElement(new ButtonCmd("versException:postpone",{"caption":CommonHelper.format(self.CAP_POSTPONE,[delay/1000/60])+" ","onClick":function(){var app=window.getApp();app.setUpdateInstPostponed(true,delay);if(app.m_dbExceptionForm){app.m_dbExceptionForm.close();}
window.showTempNote(self.NOTE,null,self.NOTE_DISAPPEAR);},"glyph":"glyphicon-time","title":CommonHelper.format(self.TITLE_POSTPONE,[delay/1000/60])}));this.addElement(new ButtonCmd("versException:reload",{"caption":self.CAP_RELOAD+" ","onClick":function(){document.location.reload(true);},"glyph":"glyphicon-ok","title":self.TITLE_RELOAD}))}
VersException.superclass.constructor.call(this,options);}
extend(VersException,FatalException);VersException.prototype.TEMPLATE_ID="VersException";VersException.prototype.NOTE_DISAPPEAR=4000; 
function WindowForm(options){options=options||{};if(options.id){this.m_id=options.id;}
options.height=options.height||this.DEF_HEIGHT;options.width=options.width||this.DEF_WIDTH;this.setDirectories(options.directories||this.DEF_DIRECTORIES);this.setChannelMode(options.channelMode||this.DEF_CHANNEL_MODE);this.setFullScreen(options.fullScreen||this.DEF_FULL_SCREEN);this.setHeight(options.height);if(options.center){this.m_center=true;this.setCenter(options.height||this.DEF_HEIGHT,options.width||this.DEF_WIDTH);}
else{if(options.centerLeft){this.setLeftCenter(options.width||this.DEF_WIDTH);}
else{this.setLeft(options.left||this.DEF_LEFT);}
if(options.centerTop){this.setTopCenter(options.height||this.DEF_HEIGHT);}
else{this.setTop(options.top||this.DEF_TOP);}}
this.setLocation(options.location||this.DEF_LOCATION);this.setMenuBar(options.menuBar||this.DEF_MENU_BAR);this.setResizable(options.resizable||this.DEF_RESIZABLE);this.setScrollBars(options.scrollBars||this.DEF_SCROLL_BARS);this.setStatus(options.status||this.DEF_STATUS);this.setTitleBar(options.titleBar||this.DEF_TITLE_BAR);this.setWidth(options.width);this.setName(options.name||this.DEF_WIN_NAME);if(options.host){this.setHost(options.host);this.setScript(options.script||this.DEF_SCRIPT);this.setURLParams(options.URLParams);}
this.setCaption(options.caption||options.title||"");this.m_content=options.content;if(options.onBeforeClose){this.setOnBeforeClose(options.onBeforeClose);}
this.m_view=options.view;}
WindowForm.prototype.DEF_DIRECTORIES="0";WindowForm.prototype.DEF_CHANNEL_MODE="0";WindowForm.prototype.DEF_FULL_SCREEN=0;WindowForm.prototype.DEF_HEIGHT="500";WindowForm.prototype.DEF_LEFT="0";WindowForm.prototype.DEF_LOCATION="0";WindowForm.prototype.DEF_MENU_BAR=0;WindowForm.prototype.DEF_RESIZABLE="1";WindowForm.prototype.DEF_SCROLL_BARS="1";WindowForm.prototype.DEF_STATUS="0";WindowForm.prototype.DEF_TITLE_BAR="0";WindowForm.prototype.DEF_TOP="0";WindowForm.prototype.DEF_WIDTH="600";WindowForm.prototype.DEF_WIN_NAME="_blank";WindowForm.prototype.DEF_SCRIPT="index.php";WindowForm.prototype.DEF_CENTER_TOP_OFFSET="20";WindowForm.prototype.m_directories;WindowForm.prototype.m_channelMode;WindowForm.prototype.m_fullScreen;WindowForm.prototype.m_height;WindowForm.prototype.m_left;WindowForm.prototype.m_location;WindowForm.prototype.m_menuBar;WindowForm.prototype.m_resizable;WindowForm.prototype.m_scrollBars;WindowForm.prototype.m_status;WindowForm.prototype.m_titleBar;WindowForm.prototype.m_top;WindowForm.prototype.m_width;WindowForm.prototype.m_name;WindowForm.prototype.m_host;WindowForm.prototype.m_script;WindowForm.prototype.m_URLParams;WindowForm.prototype.m_WindowForm;WindowForm.prototype.open=function(){var win_opts="directories="+this.m_directories+","+"channelMode="+this.m_channelMode+","+"fullScreen="+this.m_fullScreen+","+"height="+this.m_height+","+"left="+this.m_left+","+"location="+this.m_location+","+"menubar="+this.m_menuBar+","+"resizable="+this.m_resizable+","+"scrollbars="+this.m_scrollBars+","+"status="+this.m_status+","+"titlebar="+this.m_titleBar+","+"top="+this.m_top+","+"width="+this.m_width;var url='';if(this.m_host){url=this.getURL();}
this.m_WindowForm=window.open(url,this.m_name,win_opts);if(url==''&&this.m_content){this.m_WindowForm.document.write(this.m_content);}
return this.m_WindowForm;}
WindowForm.prototype.close=function(){if(this.m_WindowForm){this.m_WindowForm.close();}}
WindowForm.prototype.setDirectories=function(directories){this.m_directories=directories;}
WindowForm.prototype.setChannelMode=function(channelMode){this.m_channelMode=channelMode;}
WindowForm.prototype.setFullScreen=function(fullScreen){this.m_fullScreen=fullScreen;}
WindowForm.prototype.setHeight=function(height){if(height){this.m_height=height;}}
WindowForm.prototype.setLeft=function(left){this.m_left=left;}
WindowForm.prototype.setLocation=function(location){this.m_location=location;}
WindowForm.prototype.setMenuBar=function(menuBar){this.m_menuBar=menuBar;}
WindowForm.prototype.setResizable=function(resizable){this.m_resizable=resizable;}
WindowForm.prototype.setScrollBars=function(scrollBars){this.m_scrollBars=scrollBars;}
WindowForm.prototype.setStatus=function(status){this.m_status=status;}
WindowForm.prototype.setTitleBar=function(titleBar){this.m_titleBar=titleBar;}
WindowForm.prototype.setTop=function(top){if(top){this.m_top=top;}}
WindowForm.prototype.setWidth=function(width){if(width){this.m_width=width;}}
WindowForm.prototype.setSize=function(w,h){this.m_w=width;this.m_h=h;}
WindowForm.prototype.setName=function(name){this.m_name=name;}
WindowForm.prototype.getScript=function(){return this.m_script;}
WindowForm.prototype.setScript=function(script){this.m_script=script;}
WindowForm.prototype.getHost=function(){var host=this.m_host;if(host&&host.length&&host.substring(host.length-1,host.length)!="/"){host+="/";}
return host;}
WindowForm.prototype.setHost=function(host){this.m_host=host;}
WindowForm.prototype.getURL=function(){var h=this.getHost();if(!h){return;}
var s=this.getScript();if(!s){return;}
var p=this.getURLParams();if(p){p="?"+p;}
else{p="";}
return(h+s+p);}
WindowForm.prototype.setURLParams=function(URLParams){this.m_URLParams=URLParams;}
WindowForm.prototype.getURLParams=function(){return this.m_URLParams;}
WindowForm.prototype.setLeftCenter=function(width){var l=Math.floor(getViewportWidth()/2)-Math.floor(width/2);this.setLeft(l);}
WindowForm.prototype.setTopCenter=function(height){var t=Math.floor(getViewportHeight()/2)-Math.floor(height/2);this.setTop(t+this.DEF_CENTER_TOP_OFFSET);}
WindowForm.prototype.setCenter=function(height,width){this.setLeftCenter(width);this.setTopCenter(height);}
WindowForm.prototype.getWindowForm=function(){return this.m_WindowForm;}
WindowForm.prototype.getContentParent=function(){return this.m_WindowForm.document.body;}
WindowForm.prototype.setFocus=function(){return this.m_WindowForm.focus();}
WindowForm.prototype.setTitle=function(title){this.m_title=title;}
WindowForm.prototype.setCaption=function(caption){this.setTitle(caption);}
WindowForm.prototype.setOnBeforeClose=function(f){this.m_onBeforeClose=f;} 
var dhtmlwindow={imagefiles:['img/windowfiles/min.gif','img/windowfiles/close.gif','img/windowfiles/restore.gif','img/windowfiles/resize.gif'],ajaxbustcache:true,ajaxloadinghtml:'<b>Loading Page. Please wait...</b>',minimizeorder:0,zIndexvalue:100,tobjects:[],lastactivet:{},init:function(t){var domwindow=document.createElement("div")
domwindow.id=t
domwindow.className="dhtmlwindow panel"
var domwindowdata=''
domwindowdata='<div class="drag-handle">'
domwindowdata+='DHTML Window <div class="drag-controls"><img src="'+this.imagefiles[0]+'" title="Minimize" /><img src="'+this.imagefiles[1]+'" title="Close" /></div>'
domwindowdata+='</div>'
domwindowdata+='<div class="drag-contentarea panel-body"></div>'
domwindowdata+='<div class="drag-statusarea"><div class="drag-resizearea" style="background: transparent url('+this.imagefiles[3]+') top right no-repeat;">&nbsp;</div></div>'
domwindowdata+='</div>'
domwindow.innerHTML=domwindowdata
document.getElementById("dhtmlwindowholder").appendChild(domwindow)
var t=document.getElementById(t)
var divs=t.getElementsByTagName("div")
for(var i=0;i<divs.length;i++){if(/drag-/.test(divs[i].className)){var prop=divs[i].className.replace(/drag-/,"");var pos=prop.indexOf(" ");if(pos>=0){prop=prop.substring(0,pos);}
t[prop]=divs[i];}}
t.handle._parent=t
t.resizearea._parent=t
t.controls._parent=t
t.onclose=function(){return true}
t.onmousedown=function(){dhtmlwindow.setfocus(this)}
t.handle.onmousedown=dhtmlwindow.setupdrag
t.resizearea.onmousedown=dhtmlwindow.setupdrag
t.controls.onclick=dhtmlwindow.enablecontrols
t.show=function(){dhtmlwindow.show(this)}
t.hide=function(){dhtmlwindow.hide(this)}
t.close=function(){dhtmlwindow.close(this)}
t.setSize=function(w,h){dhtmlwindow.setSize(this,w,h)}
t.moveTo=function(x,y){dhtmlwindow.moveTo(this,x,y)}
t.isResize=function(bol){dhtmlwindow.isResize(this,bol)}
t.isScrolling=function(bol){dhtmlwindow.isScrolling(this,bol)}
t.load=function(contenttype,contentsource,title){dhtmlwindow.load(this,contenttype,contentsource,title)}
this.tobjects[this.tobjects.length]=t
return t},open:function(t,contenttype,contentsource,title,attr,recalonload){var d=dhtmlwindow
function getValue(Name){var config=new RegExp(Name+"=([^,]+)","i")
return(config.test(attr))?parseInt(RegExp.$1):0}
if(document.getElementById(t)==null)
t=this.init(t)
else
t=document.getElementById(t)
this.setfocus(t)
t.setSize(getValue(("width")),(getValue("height")))
var xpos=getValue("center")?"middle":getValue("left")
var ypos=getValue("center")?"middle":getValue("top")
if(typeof recalonload!="undefined"&&recalonload=="recal"&&this.scroll_top==0){if(window.attachEvent&&!window.opera)
this.addEvent(window,function(){setTimeout(function(){t.moveTo(xpos,ypos)},400)},"load")
else
this.addEvent(window,function(){t.moveTo(xpos,ypos)},"load")}
t.isResize(getValue("resize"))
t.isScrolling(getValue("scrolling"))
t.style.visibility="visible"
t.style.display="block"
t.contentarea.style.display="block"
t.moveTo(xpos,ypos)
t.load(contenttype,contentsource,title)
if(t.state=="minimized"&&t.controls.firstChild.title=="Restore"){t.controls.firstChild.setAttribute("src",dhtmlwindow.imagefiles[0])
t.controls.firstChild.setAttribute("title","Minimize")
t.state="fullview"}
return t},setSize:function(t,w,h){t.style.width=Math.max(parseInt(w),150)+"px"
t.contentarea.style.height=Math.max(parseInt(h),100)+"px"},moveTo:function(t,x,y){this.getviewpoint()
t.style.left=(x=="middle")?this.scroll_left+(this.docwidth-t.offsetWidth)/2+"px":this.scroll_left+parseInt(x)+"px"
t.style.top=(y=="middle")?this.scroll_top+(this.docheight-t.offsetHeight)/2+"px":this.scroll_top+parseInt(y)+"px"},isResize:function(t,bol){t.statusarea.style.display=(bol)?"block":"none"
t.resizeBool=(bol)?1:0},isScrolling:function(t,bol){t.contentarea.style.overflow=(bol)?"auto":"hidden"},load:function(t,contenttype,contentsource,title){if(t.isClosed){alert("DHTML Window has been closed, so no window to load contents into. Open/Create the window again.")
return}
var contenttype=contenttype.toLowerCase()
if(typeof title!="undefined")
t.handle.firstChild.nodeValue=title
if(contenttype=="inline")
t.contentarea.innerHTML=contentsource
else if(contenttype=="div"){var inlinedivref=document.getElementById(contentsource)
t.contentarea.innerHTML=(inlinedivref.defaultHTML||inlinedivref.innerHTML)
if(!inlinedivref.defaultHTML)
inlinedivref.defaultHTML=inlinedivref.innerHTML
inlinedivref.innerHTML=""
inlinedivref.style.display="none"}
else if(contenttype=="iframe"){t.contentarea.style.overflow="hidden"
if(!t.contentarea.firstChild||t.contentarea.firstChild.tagName!="IFRAME")
t.contentarea.innerHTML='<iframe src="" style="margin:0; padding:0; width:100%; height: 100%" name="_iframe-'+t.id+'"></iframe>'
window.frames["_iframe-"+t.id].location.replace(contentsource)}
else if(contenttype=="ajax"){this.ajax_connect(contentsource,t)}
t.contentarea.datatype=contenttype},setupdrag:function(e){var d=dhtmlwindow
var t=this._parent
d.etarget=this
e=EventHandler.fixMouseEvent(e);d.initmousex=e.clientX
d.initmousey=e.clientY
d.initx=parseInt(t.offsetLeft)
d.inity=parseInt(t.offsetTop)
d.width=parseInt(t.offsetWidth)
d.contentheight=parseInt(t.contentarea.offsetHeight)
if(t.contentarea.datatype=="iframe"){t.style.backgroundColor="#F8F8F8"
t.contentarea.style.visibility="hidden"}
document.onmousemove=d.getdistance
document.onmouseup=function(){if(t.contentarea.datatype=="iframe"){t.contentarea.style.backgroundColor="white"
t.contentarea.style.visibility="visible"}
d.stop()}
return false},getdistance:function(e){var d=dhtmlwindow
var etarget=d.etarget
e=EventHandler.fixMouseEvent(e);d.distancex=e.clientX-d.initmousex
d.distancey=e.clientY-d.initmousey
if(etarget.className=="drag-handle")
d.move(etarget._parent,e)
else if(etarget.className=="drag-resizearea")
d.resize(etarget._parent,e)
return false},getviewpoint:function(){var ie=document.all&&!window.opera
var domclientWidth=document.documentElement&&parseInt(document.documentElement.clientWidth)||100000
this.standardbody=(document.compatMode=="CSS1Compat")?document.documentElement:document.body
this.scroll_top=(ie)?this.standardbody.scrollTop:window.pageYOffset
this.scroll_left=(ie)?this.standardbody.scrollLeft:window.pageXOffset
this.docwidth=(ie)?this.standardbody.clientWidth:(/Safari/i.test(navigator.userAgent))?window.innerWidth:Math.min(domclientWidth,window.innerWidth-16)
this.docheight=(ie)?this.standardbody.clientHeight:window.innerHeight},rememberattrs:function(t){this.getviewpoint()
t.lastx=parseInt((t.style.left||t.offsetLeft))-dhtmlwindow.scroll_left
t.lasty=parseInt((t.style.top||t.offsetTop))-dhtmlwindow.scroll_top
t.lastwidth=parseInt(t.style.width)},move:function(t,e){t.style.left=dhtmlwindow.distancex+dhtmlwindow.initx+"px"
t.style.top=dhtmlwindow.distancey+dhtmlwindow.inity+"px"},resize:function(t,e){t.style.width=Math.max(dhtmlwindow.width+dhtmlwindow.distancex,150)+"px"
t.contentarea.style.height=Math.max(dhtmlwindow.contentheight+dhtmlwindow.distancey,100)+"px"},enablecontrols:function(e){var d=dhtmlwindow
e=EventHandler.fixMouseEvent(e);var sourceobj=e.target;if(/Minimize/i.test(sourceobj.getAttribute("title")))
d.minimize(sourceobj,this._parent)
else if(/Restore/i.test(sourceobj.getAttribute("title")))
d.restore(sourceobj,this._parent)
else if(/Close/i.test(sourceobj.getAttribute("title"))){if(this._parent.onCancel){this._parent.onCancel();}
else{d.close(this._parent)}}
return false},minimize:function(button,t){dhtmlwindow.rememberattrs(t)
button.setAttribute("src",dhtmlwindow.imagefiles[2])
button.setAttribute("title","Restore")
t.state="minimized"
t.contentarea.style.display="none"
t.statusarea.style.display="none"
if(typeof t.minimizeorder=="undefined"){dhtmlwindow.minimizeorder++
t.minimizeorder=dhtmlwindow.minimizeorder}
t.style.left="10px"
t.style.width="200px"
var windowspacing=t.minimizeorder*10
t.style.top=dhtmlwindow.scroll_top+dhtmlwindow.docheight-(t.handle.offsetHeight*t.minimizeorder)-windowspacing+"px"},restore:function(button,t){dhtmlwindow.getviewpoint()
button.setAttribute("src",dhtmlwindow.imagefiles[0])
button.setAttribute("title","Minimize")
t.state="fullview"
t.style.display="block"
t.contentarea.style.display="block"
if(t.resizeBool)
t.statusarea.style.display="block"
t.style.left=parseInt(t.lastx)+dhtmlwindow.scroll_left+"px"
t.style.top=parseInt(t.lasty)+dhtmlwindow.scroll_top+"px"
t.style.width=parseInt(t.lastwidth)+"px"},close:function(t){try{var closewinbol=t.onclose()}
catch(err){var closewinbol=true}
finally{if(typeof closewinbol=="undefined"){alert("An error has occured somwhere inside your \"onclose\" event handler")
var closewinbol=true}}
if(closewinbol){if(t.state!="minimized")
dhtmlwindow.rememberattrs(t)
if(window.frames["_iframe-"+t.id])
window.frames["_iframe-"+t.id].location.replace("about:blank")
else
t.contentarea.innerHTML=""
t.style.display="none"
t.isClosed=true}
return closewinbol},setopacity:function(targetobject,value){if(!targetobject)
return
if(targetobject.filters&&targetobject.filters[0]){if(typeof targetobject.filters[0].opacity=="number")
targetobject.filters[0].opacity=value*100
else
targetobject.style.filter="alpha(opacity="+value*100+")"}
else if(typeof targetobject.style.MozOpacity!="undefined")
targetobject.style.MozOpacity=value
else if(typeof targetobject.style.opacity!="undefined")
targetobject.style.opacity=value},setfocus:function(t){this.zIndexvalue++
t.style.zIndex=this.zIndexvalue
t.isClosed=false
this.setopacity(this.lastactivet.handle,0.5)
this.setopacity(t.handle,1)
this.lastactivet=t},show:function(t){if(t.isClosed){alert("DHTML Window has been closed, so nothing to show. Open/Create the window again.")
return}
if(t.lastx)
dhtmlwindow.restore(t.controls.firstChild,t)
else
t.style.display="block"
this.setfocus(t)
t.state="fullview"},hide:function(t){t.style.display="none"},ajax_connect:function(url,t){var page_request=false
var bustcacheparameter=""
if(window.XMLHttpRequest)
page_request=new XMLHttpRequest()
else if(window.ActiveXObject){try{page_request=new ActiveXObject("Msxml2.XMLHTTP")}
catch(e){try{page_request=new ActiveXObject("Microsoft.XMLHTTP")}
catch(e){}}}
else
return false
t.contentarea.innerHTML=this.ajaxloadinghtml
page_request.onreadystatechange=function(){dhtmlwindow.ajax_loadpage(page_request,t)}
if(this.ajaxbustcache)
bustcacheparameter=(url.indexOf("?")!=-1)?"&"+new Date().getTime():"?"+new Date().getTime()
page_request.open('GET',url+bustcacheparameter,true)
page_request.send(null)},ajax_loadpage:function(page_request,t){if(page_request.readyState==4&&(page_request.status==200||window.location.href.indexOf("http")==-1)){t.contentarea.innerHTML=page_request.responseText}},stop:function(){dhtmlwindow.etarget=null
document.onmousemove=null
document.onmouseup=null},addEvent:function(target,functionref,tasktype){var tasktype=(window.addEventListener)?tasktype:"on"+tasktype
if(target.addEventListener)
target.addEventListener(tasktype,functionref,false)
else if(target.attachEvent)
target.attachEvent(tasktype,functionref)},cleanup:function(){for(var i=0;i<dhtmlwindow.tobjects.length;i++){dhtmlwindow.tobjects[i].handle._parent=dhtmlwindow.tobjects[i].resizearea._parent=dhtmlwindow.tobjects[i].controls._parent=null}
window.onload=null}}
document.write('<div id="dhtmlwindowholder"><span style="display:none">.</span></div>')
window.onunload=dhtmlwindow.cleanup 
var OPENED_FORMS={};function WindowFormDD(id,options){if(typeof id==="object"){options=id;id=options.id}
options=options||{};WindowFormDD.superclass.constructor.call(this,options);this.m_noMinimize=(options.noMinimize!=undefined&&options.noMinimize);this.m_noClose=(options.noClose!=undefined&&options.noClose);this.m_resizable=(options.resizable==undefined)?true:options.resizable;this.m_formClass=dhtmlwindow;}
extend(WindowFormDD,WindowForm);WindowFormDD.prototype.m_divWin;WindowFormDD.prototype.m_divId;WindowFormDD.prototype.getWindowForm=function(){return window;}
WindowFormDD.prototype.open=function(){this.m_divId=(this.m_id)?this.m_id:uuid();var cap=(this.m_caption)?this.m_caption:"     ";var opts="";if((!this.m_top||this.m_top==0)&&(!this.m_left||this.m_left==0)&&(!this.m_center||this.m_center==0)){for(var id in OPENED_FORMS){if(OPENED_FORMS[id]){var v=toInt(OPENED_FORMS[id].top)+30;v=(v>150)?0:v;this.m_top=v;v=toInt(OPENED_FORMS[id].left)+30;v=(v>150)?0:v;this.m_left=v;}}}
if(this.m_scrollBars){opts+=(opts=="")?"":",";opts+="scrolling=1";}
if(this.m_resizable){opts+=(opts=="")?"":",";opts+="resize=1";}
if(this.m_left){opts+=(opts=="")?"":",";opts+="left="+this.m_left+"px";}
if(this.m_top){opts+=(opts=="")?"":",";opts+="top="+this.m_top+"px";}
if(this.m_width){opts+=(opts=="")?"":",";opts+="width="+this.m_width+"px";}
if(this.m_height){opts+=(opts=="")?"":",";opts+="height="+this.m_height+"px";}
if(this.m_center){opts+=(opts=="")?"":",";opts+="center=1";}
OPENED_FORMS[this.m_divId]={};OPENED_FORMS[this.m_divId].top=this.m_top;OPENED_FORMS[this.m_divId].left=this.m_left;this.m_divWin=this.m_formClass.open(this.m_divId,"inline","",cap,opts,"recal");if(this.m_center){this.m_divWin.moveTo("middle","middle");}
var self=this;if(this.m_view&&!this.m_view.m_onSelect){this.m_divWin.onCancel=function(){if(self.m_view.onCancel){self.m_view.onCancel();}};}
this.m_divWin.onclose=function(){var compl_n=nd("tat_table");if(compl_n){DOMHandler.removeNode(compl_n);}
delete OPENED_FORMS[self.m_divId];return true;}
if(this.m_noClose){var n=DOMHandler.getElementsByAttr("Close",this.m_divWin,"title",true,"img");if(n&&n.length){n[0].style.display="none";}}
if(this.m_noMinimize){var n=DOMHandler.getElementsByAttr("Minimize",this.m_divWin,"title",true,"img");if(n&&n.length){n[0].style.display="none";}}}
WindowFormDD.prototype.close=function(){if(this.m_divWin){this.m_formClass.close(this.m_divWin);delete this.m_divWin;}}
WindowFormDD.prototype.getContentParent=function(){var n=DOMHandler.getElementsByAttr("drag-contentarea",nd(this.m_divId),"class");if(n&&n.length){return n[0];}}
WindowFormDD.prototype.setCaption=function(caption){this.m_caption=caption;}
WindowForm.prototype.setFocus=function(){}
WindowFormDD.prototype.setSize=function(w,h){this.m_formClass.setSize(this.m_divWin,w,h);} 
var WindowQuestion={RES_YES:0,RES_NO:1,RES_CANCEL:2,show:function(options){options=options||{};var yes=(options.yes!=undefined)?options.yes:true;var no=(options.no!=undefined)?options.no:true;var cancel=(options.cancel!=undefined)?options.cancel:true;var timeout=options.timeout||0;this.m_callBack=options.callBack;this.m_modalId=uuid();this.m_modal=new WindowFormModalBS(this.m_modalId,{content:new Control(uuid(),"div",{value:options.text})});var self=this;if(yes){this.m_modal.m_footer.addElement(new ButtonCmd(uuid(),{"caption":"Да","attrs":{"title":"ответить утвердительно"},"onClick":function(){self.m_callBack(self.RES_YES);self.m_modal.close();}}));}
if(no){this.m_modal.m_footer.addElement(new ButtonCmd(uuid(),{"caption":"Нет","attrs":{"title":"ответить отрицательно"},"onClick":function(){self.m_callBack(self.RES_NO);self.m_modal.close();}}));}
if(cancel){this.m_modal.m_footer.addElement(new ButtonCmd(uuid(),{"caption":"Отмена","attrs":{"data-dismiss":"modal","title":"отменить действие"}}));}
this.m_modal.open();return this.RES_NO;}} 
function WindowMessage(options){options=options||{};this.m_messages=[];this.m_window=null;this.m_model=null;this.m_flashTime=options.flashTime||this.FLASH_TIME;}
WindowMessage.prototype.ID="windowMessage";WindowMessage.prototype.FLASH_TIME=1000;WindowMessage.prototype.BS_COL=2;WindowMessage.prototype.TP_ER="danger";WindowMessage.prototype.TP_WARN="warning";WindowMessage.prototype.TP_INFO="info";WindowMessage.prototype.TP_OK="success";WindowMessage.prototype.m_messages;WindowMessage.prototype.m_window;WindowMessage.prototype.m_model;WindowMessage.prototype.show=function(options){options=options||{};var mes_id=CommonHelper.uniqid();options.type=options.type||this.TP_INFO;debugger
if(this.m_messages.length&&(this.m_messages[this.m_messages.length-1]&&this.m_messages[this.m_messages.length-1].content&&this.m_messages[this.m_messages.length-1].content.trim&&options.text&&options.text.trim&&this.m_messages[this.m_messages.length-1].content.trim()==options.text.trim()&&this.m_messages[this.m_messages.length-1].message_type==options.type)){this.m_messages[this.m_messages.length-1].date_time=DateHelper.time();}else{this.m_messages.push({id:mes_id,date_time:DateHelper.time(),subject:null,content:options.text,user_descr:null,message_type:options.type,importance_level:null,require_view:null});}
this.toDOM();if(options.callBack){options.callBack();}
return mes_id;};WindowMessage.prototype.toDOM=function(){var self=this;var mw_st=WIN_MESSAGE_STYLE;var mw_overlap=(mw_st.win_position=="overlap");var mw_class="",win_style="";if(window.getWidthType()!="sm"){mw_class=(mw_overlap?"windowMessageOverlap":"windowMessageStick");win_style="left:"+(100-mw_st.win_width)+"%;width:"+mw_st.win_width+"%;";}
else{mw_class="windowMessageMobile";}
var mw_col;if(!mw_overlap){mw_col=this.getMessageWindowCol(mw_st);mw_class+=(mw_class=="")?"":" ";mw_class+=window.getBsCol(mw_col);}
if(!this.m_window){var n=CommonHelper.getElementsByAttr("windowMessage",window.body,"class",true);if(!n.length){throw Error("Message window not found!");}
if(!n[0].id){n[0].id=CommonHelper.uniqid();}
this.m_window=new ControlContainer(n[0].id,"DIV",{"className":"panel panel-default windowMessage"+((mw_class!="")?" "+mw_class:""),"attrs":mw_overlap?{"style":win_style}:null});var head=new ControlContainer(this.ID+":head","DIV",{});var head_cont=new ControlContainer(this.ID+":head-cont","DIV");head_cont.addElement(new ButtonCtrl(this.ID+":close",{"title":"закрыть","glyph":"glyphicon-remove","onClick":function(){self.m_messages=[];self.delDOM();}}));head.addElement(head_cont);this.m_content=new ControlContainer(this.ID+":content","DIV");var body=new ControlContainer(this.ID+":body","DIV",{});body.addElement(this.m_content);this.m_window.addElement(head);this.m_window.addElement(body);}
else if(mw_overlap){this.m_window.getNode().style=win_style;}
this.m_window.setVisible(true);if(!mw_overlap){this.setWinDataClass(mw_col);}
this.m_content.delDOM();this.m_content.clear();var t=0;for(var i=this.m_messages.length-1;i>=0;i--){var item_class="message-item alert alert-"+this.m_messages[i].message_type;item_class+=(i==this.m_messages.length-1)?" flashit":"";var cont=new ControlContainer(this.m_messages[i].id,"P",{"className":item_class});if(i==this.m_messages.length-1){this.m_flashCont=cont;try{setTimeout(function(){DOMHelper.delClass(self.m_flashCont.getNode(),"flashit");},this.m_flashTime);}
catch(e){}}
cont.addElement(new Control(this.m_messages[i].id+":head","DIV",{"value":CommonHelper.dateFormat(this.m_messages[i].date_time,"H:i:s")}));cont.addElement(new ControlContainer(this.m_messages[i].id+":title","DIV",(typeof(this.m_messages[i].content)=="string")?{"value":this.m_messages[i].content}:this.m_messages[i].content));this.m_content.addElement(cont);t++;}
this.m_window.setClassName("panel panel-default windowMessage "+mw_class);this.m_window.toDOM();};WindowMessage.prototype.getMessageWindowCol=function(mesWindStyle){var col=parseInt(mesWindStyle.win_width,10);if(!col){col=1;}
return Math.ceil(col*12/100);}
WindowMessage.prototype.setWinDataClass=function(mwCol){var dwin=document.getElementById("windowData");if(dwin){DOMHelper.setAttr(dwin,"class",window.getBsCol(12-mwCol));}}
WindowMessage.prototype.delDOM=function(){if(this.m_window){this.m_window.setVisible(false);var mw_st=WIN_MESSAGE_STYLE;if(mw_st.win_position=="stick"){this.setWinDataClass(0);}}} 
function WindowTempMessage(options){options=options||{}
this.m_messages=[];this.m_flashTime=options.flashTime||this.FLASH_TIME;this.m_timeout=options.timeout||this.TIMEOUT;this.m_margin=options.margin||this.MARGIN;this.m_width=options.width||this.WIDTH;this.m_interval=options.interval||this.INTERVAL;}
WindowTempMessage.prototype.TP_ER="danger";WindowTempMessage.prototype.TP_WARN="warning";WindowTempMessage.prototype.TP_INFO="info";WindowTempMessage.prototype.TP_OK="success";WindowTempMessage.prototype.FLASH_TIME=1000;WindowTempMessage.prototype.TIMEOUT=1000*10;WindowTempMessage.prototype.MARGIN="50";WindowTempMessage.prototype.WIDTH="300px";WindowTempMessage.prototype.INTERVAL="10";WindowTempMessage.prototype.show=function(options){options=options||{};options.type=options.type||this.TP_INFO;var item_class="hidden message-item alert flashit alert-"+options.type;var mes_id;var self=this;var last_top,last_left,deleted_top,deleted_left,last_height,last_width;for(id in this.m_messages){if(this.m_messages[id]){last_top=this.m_messages[id].top;last_left=this.m_messages[id].left;last_height=this.m_messages[id].height;last_width=this.m_messages[id].width;}
else if(!mes_id){mes_id=this.m_messages[id].control.getId();deleted_top=this.m_messages[id].top;deleted_left=this.m_messages[id].left;}}
mes_id=mes_id?mes_id:CommonHelper.uniqid();this.m_messages[mes_id]={"callBack":options.callBack};this.m_messages[mes_id].control=new ControlContainer(mes_id,"DIV",{"className":item_class,"attrs":{"style":"position:fixed;display:block;z-index:9999;width:"+(options.width||this.m_width)},"elements":[new Control(mes_id+":head","DIV",{"attrs":{"type":"button","class":"close","aria-hidden":"true","messageid":mes_id},"value":"×","events":{"click":options.onClickCancel||function(e){self.close(e.target.getAttribute("messageid"));}}}),new ControlContainer(mes_id+":title","DIV",(typeof(options.content)=="string")?{"value":options.content}:options.content)]});this.m_messages[mes_id].control.toDOM(document.body);var n=this.m_messages[mes_id].control.getNode();console.log("n:",n,"mes_id:",mes_id)
var top,left;if(!last_top){left=$(window).width()-300-(options.margin||this.m_margin);top=$(window).height()-100-(options.margin||this.m_margin);}
else{var top=last_top-this.m_interval-last_height;var left=last_left;if(top<document.documentElement.clientHeight/2){top=document.documentElement.clientHeight-n.offsetHeight-(options.margin||this.m_margin);left=last_left-this.m_interval-last_width;if(!left){top=deleted_top;left=deleted_left;}}}
console.log("top:",top,"left:",left)
console.log("document.documentElement.clientWidth=",document.documentElement.clientWidth)
console.log("document.body.clientHeight=",document.body.clientHeight)
console.log("n.offsetWidth",n.offsetWidth)
console.log("n.offsetHeight",n.offsetHeight)
console.log("margin",(options.margin||this.m_margin))
console.log($(window).height())
n.style.top=top+"px";n.style.left=left+"px";this.m_messages[mes_id].top=top;this.m_messages[mes_id].height=n.offsetHeight;this.m_messages[mes_id].left=left;this.m_messages[mes_id].width=n.offsetWidth;try{this.m_messages[mes_id].flashTmerId=setTimeout(function(mesId){self.stopFlash(mesId);},(options.flashTime||this.m_flashTime),mes_id);this.m_messages[mes_id].timerId=setTimeout(function(mesId){self.close(mesId);},(options.timeout||this.m_timeout),mes_id);}
catch(e){}
DOMHelper.show(n);}
WindowTempMessage.prototype.stopFlash=function(mesId){if(this.m_messages[mesId]){DOMHelper.delClass(this.m_messages[mesId].control.getNode(),"flashit");}}
WindowTempMessage.prototype.close=function(mesId){if(this.m_messages[mesId]){if(this.m_messages[mesId].flashTmerId)clearTimeout(this.m_messages[mesId].flashTmerId);if(this.m_messages[mesId].timerId)clearTimeout(this.m_messages[mesId].timerId);if(this.m_messages[mesId].control){var self=this;$(this.m_messages[mesId].control.getNode()).fadeOut("slow",function(){self.deleteObj(mesId);});}}}
WindowTempMessage.prototype.deleteObj=function(mesId){if(this.m_messages&&this.m_messages[mesId]){if(this.m_messages[mesId].control){this.m_messages[mesId].control.delDOM();delete this.m_messages[mesId].control;}
if(this.m_messages[mesId].callBack)this.m_messages[mesId].callBack();delete this.m_messages[mesId];}} 
var WindowPrint={show:function(options){options=options||{};var newWin=window.open("");if(newWin){var print_and_close=((options.print==undefined)||(options.print!=undefined&&options.print==true));newWin.document.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">'+'<html>'+'<head>'+'<meta http-equiv="content-type" content="text/html; charset=UTF-8">'+'<link rel="stylesheet" href="css/print.css?'+uuid()+'" type="text/css" media="all">'+'<title>'+((options.title!=undefined)?options.title:"Печать")+'</title>'+'</head>'+'<body>'+options.content+'</body></html>');newWin.document.close();var win_del=setInterval(check_state,10);function check_state(){if(newWin.document.readyState=="complete"){clearInterval(win_del);newWin.focus();if(print_and_close){newWin.print();newWin.close();}}}}}} 
function Control(id,tagName,options){options=options||{};tagName=tagName||this.DEF_TAG_NAME;if(!tagName){throw new Error("Control id='"+id+"' tagName is undefined!");}
this.m_node=document.createElement(tagName);this.m_idPrefix=options.idPrefix;this.setId(id);if(options.className){this.setClassName(options.className);}
if(options.value){this.setValue(options.value);}
options.attrs=options.attrs||{};if(options.attrs.disabled&&options.attrs.disabled=="disabled"){options.enabled=false;}
this.setEnabled((options.enabled!=undefined)?options.enabled:this.DEF_ENABLED);this.setVisible((options.visible!=undefined)?options.visible:this.DEF_VISIBLE);this.setReadOnly((options.readOnly!=undefined)?options.readOnly:this.DEF_READ_ONLY);if(options.required!=undefined&&options.required){this.setRequired(true);}
this.setAlwaysUpdate(options.alwaysUpdate);for(var attr in options.attrs){if(attr!="disabled"){this.setAttr(attr,options.attrs[attr]);}}
this.m_winObj=options.winObj;this.m_eventFuncs={};this.m_events=options.events;}
Control.prototype.DEF_TAG_NAME="div";Control.prototype.CLASS_DISABLED="disabled";Control.prototype.CLASS_READ_ONLY="readOnly";Control.prototype.CLASS_NOT_VISIBLE="invisible";Control.prototype.DEF_READ_ONLY=false;Control.prototype.DEF_ENABLED=true;Control.prototype.DEF_VISIBLE=true;Control.prototype.m_node;Control.prototype.m_eventFuncs;Control.prototype.setId=function(id){if(id){this.m_node.id=((this.m_idPrefix)?(this.m_idPrefix+"_"):"")+id;}}
Control.prototype.getId=function(){return DOMHandler.getAttr(this.m_node,'id');}
Control.prototype.getName=function(){return DOMHandler.getAttr(this.m_node,"name");}
Control.prototype.setEnabled=function(enabled){if(enabled){DOMHandler.removeAttr(this.m_node,"disabled");}
else{DOMHandler.setAttr(this.m_node,"disabled","disabled");}}
Control.prototype.getEnabled=function(){return!(DOMHandler.getAttr(this.m_node,"disabled"));}
Control.prototype.setVisible=function(visible){if(visible){DOMHandler.removeClass(this.m_node,this.CLASS_NOT_VISIBLE);}
else{DOMHandler.addClass(this.m_node,this.CLASS_NOT_VISIBLE);}}
Control.prototype.setRequired=function(required){if(!required){DOMHandler.removeAttr(this.m_node,"required");}
else{DOMHandler.addAttr(this.m_node,"required","required");}}
Control.prototype.getVisible=function(){return!DOMHandler.hasClass(this.m_node,this.CLASS_NOT_VISIBLE);}
Control.prototype.setReadOnly=function(readOnly){if(readOnly){DOMHandler.addClass(this.m_node,this.CLASS_READ_ONLY);}
else{DOMHandler.removeClass(this.m_node,this.CLASS_READ_ONLY);}}
Control.prototype.getReadOnly=function(){return DOMHandler.hasClass(this.m_node,this.CLASS_READ_ONLY);}
Control.prototype.getNode=function(){return this.m_node;}
Control.prototype.appendToNode=function(parent){parent.appendChild(this.m_node);}
Control.prototype.setValue=function(val){if(this.m_node.childNodes!=undefined&&this.m_node.childNodes.length){this.m_node.childNodes[0].nodeValue=val;}
else{this.m_node.appendChild(document.createTextNode(val));}}
Control.prototype.getValue=function(){if(this.m_node.childNodes&&this.m_node.childNodes.length){return this.m_node.childNodes[0].nodeValue;}}
Control.prototype.getValueStr=function(){return this.getValue();}
Control.prototype.correctEvId=function(ev){var id=ev.toLowerCase();if(id.substring(0,2)=="on"){id=id.substring(2);}
return id;}
Control.prototype.eventsToDOM=function(){for(var ev in this.m_events){var id=this.correctEvId(ev);var self=this;if(this.m_eventFuncs[id]){EventHandler.removeEvent(this.m_node,id,this.m_eventFuncs[id],false);}
this.m_eventFuncs[id]=(function(self,ev){return function(e){self.m_events[ev].call(self,e);}})(self,ev);EventHandler.addEvent(this.m_node,id,this.m_eventFuncs[id],false);}}
Control.prototype.removeEventsFromDOM=function(){for(var ev in this.m_events){var id=this.correctEvId(ev);if(this.m_eventFuncs[id]){EventHandler.removeEvent(this.m_node,id,this.m_eventFuncs[id],true);}}}
Control.prototype.toDOMAfter=function(node){var sibl=node.nextSibling;var p=node.parentNode;if(sibl){p.insertBefore(this.m_node,sibl);}
else{p.appendChild(this.m_node);}
this.eventsToDOM();}
Control.prototype.toDOMBefore=function(node){var sibl=node.previousSibling;var p=node.parentNode;if(sibl){p.insertBefore(this.m_node,sibl);}
else{p.appendChild(this.m_node);}
this.eventsToDOM();}
Control.prototype.nodeToDOM=function(parent){var sibl;var n=nd(this.getId(),this.getWinObjDocum());if(n){parent=n.parentNode;sibl=n.nextSibling;parent.removeChild(n);}
if(!parent){console.trace();throw new Error("Control id="+this.getId()+", parent is not defined");}
if(sibl){parent.insertBefore(this.m_node,sibl);}
else{parent.appendChild(this.m_node);}}
Control.prototype.toDOM=function(parent){this.nodeToDOM(parent);this.eventsToDOM();}
Control.prototype.delDOM=function(){CommonHelper.delNode(this.m_node);}
Control.prototype.setAttr=function(name,value){DOMHandler.setAttr(this.m_node,name,value);}
Control.prototype.getAttr=function(name){return DOMHandler.getAttr(this.m_node,name);}
Control.prototype.removeAttr=function(name){DOMHandler.removeAttr(name);}
Control.prototype.setClassName=function(className){if(className&&className.length>0){this.m_node.className=className;}}
Control.prototype.getClassName=function(){return this.m_node.className;}
Control.prototype.removeDOM=function(){this.removeEventsFromDOM();DOMHandler.removeNode(this.m_node);}
Control.prototype.setWinObj=function(winObj){this.m_winObj=winObj;}
Control.prototype.getWinObjDocum=function(){if(this.m_winObj){try{return this.m_winObj.getWindowForm().document;}
catch(e){alert(e.stack);}}
else{return window.document;}}
Control.prototype.$=function(n){return nd(n,this.getWinObjDocum());}
Control.prototype.getValueAsObj=function(){return{"descr":this.getValue()};}
Control.prototype.setValueFromObj=function(obj){this.setValue(obj.descr);}
Control.prototype.getAlwaysUpdate=function(){return this.m_alwaysUpdate;}
Control.prototype.setAlwaysUpdate=function(v){this.m_alwaysUpdate=v;}
Control.prototype.setGlobalWait=function(isWait){var n=this.$("waiting");if(n&&isWait){DOMHandler.removeClass(n,"invisible");}
else if(n){DOMHandler.addClass(n,"invisible");}}
Control.prototype.serialize=function(o){var o=o||{};o.value=this.getValue();for(var a in this.m_node.attributes){if(typeof this.m_node.attributes[a]!="object"&&typeof this.m_node.attributes[a]!="function"){o[a]=this.m_node.attributes[a];}}
return array2json(o);}
Control.prototype.unserialize=function(str){var o=json2obj(str);for(var a in o){if(a=="value")continue;this.m_node.attributes[a]=o[a];}
if(o.value){this.setValue(o.value);}
return o;} 
function ControlContainer(id,tagName,options){options=options||{};ControlContainer.superclass.constructor.call(this,id,tagName,options);if(options.elements&&is_array(options.elements)){this.m_elements={};for(var i=0;i<options.elements.length;i++){this.addElement(options.elements[i]);}}
else{this.m_elements=options.elements||{};}
if(options.addElement){options.addElement.call(this);}}
extend(ControlContainer,Control);ControlContainer.prototype.ER_NO_ELEMENT="Elemnt '%s' not found.";ControlContainer.prototype.m_elements;ControlContainer.prototype.elementExists=function(id){return(this.m_elements[id]!=undefined);}
ControlContainer.prototype.checkElement=function(id){if(!this.elementExists(id)){throw new Error(format(this.ER_NO_ELEMENT,Array(id)));}
return true;}
ControlContainer.prototype.isEmpty=function(){return isEmpty(this.m_elements);}
ControlContainer.prototype.getElementById=function(id){return this.getElement(id);}
ControlContainer.prototype.getElement=function(id){this.checkElement(id);return this.m_elements[id];}
ControlContainer.prototype.getElementByIndex=function(ind){var i=0;for(var k in this.m_elements){if(i==ind){return this.m_elements[k];}
i++;}}
ControlContainer.prototype.setElementById=function(id,elem){this.m_elements[id]=elem;}
ControlContainer.prototype.addElement=function(new_elem){var id=new_elem.getId();if(!id){id=uuid();}
this.setElementById(id,new_elem);}
ControlContainer.prototype.appendToNode=function(parent){for(var elem_id in this.m_elements){if(this.m_elements[elem_id]){this.m_elements[elem_id].appendToNode(this.m_node);}}
parent.appendChild(this.m_node);}
ControlContainer.prototype.elementsToDOM=function(){var elem;for(var elem_id in this.m_elements){elem=this.m_elements[elem_id];if(elem){elem.toDOM(this.m_node);}}}
ControlContainer.prototype.toDOMAfter=function(node){ControlContainer.superclass.toDOMAfter.call(this,node);this.elementsToDOM();}
ControlContainer.prototype.toDOM=function(parent){this.elementsToDOM();this.nodeToDOM(parent);this.eventsToDOM();}
ControlContainer.prototype.clear=function(){for(var elem_id in this.m_elements){if(this.m_elements[elem_id])this.m_elements[elem_id].delDOM();}
this.m_elements={};}
ControlContainer.prototype.getCount=function(){var len=0;for(var k in this.m_elements)
len++;return len;}
ControlContainer.prototype.removeDOM=function(){for(var elem_id in this.m_elements){if(this.m_elements[elem_id]){this.m_elements[elem_id].removeDOM();}}
ControlContainer.superclass.removeDOM.call(this);}
ControlContainer.prototype.getValueAsObj=function(){var data={};for(var elem_id in this.m_elements){data[elem_id]=this.m_elements[elem_id].getValueAsObj();}
return data;}
ControlContainer.prototype.setValueFromObj=function(obj){for(var elem_id in obj){if(this.m_elements[elem_id]){this.m_elements[elem_id].setValueFromObj(obj);}}}
ControlContainer.prototype.setEnabled=function(en){for(var elem_id in this.m_elements){if(this.m_elements[elem_id]){this.m_elements[elem_id].setEnabled(en);}}
ControlContainer.superclass.setEnabled.call(this,en);}
ControlContainer.prototype.setVisible=function(v){for(var elem_id in this.m_elements){if(this.m_elements[elem_id]){this.m_elements[elem_id].setVisible(v);}}
ControlContainer.superclass.setVisible.call(this,v);}
ControlContainer.prototype.serialize=function(){var o={};o.elements={};for(var elem_id in this.m_elements){if(this.m_elements[elem_id]){o.elements[elem_id]=this.m_elements[elem_id].serialize();}}
return ControlContainer.superclass.serialize.call(this,o);}
ControlContainer.prototype.unserialize=function(str){var o=ControlContainer.superclass.unserialize.call(this,str);for(var id in o.elements){if(this.m_elements[id]){this.m_elements[id].unserialize(o.elements[id]);}}}
ControlContainer.prototype.delElement=function(elId){var res=false;for(var elem_id in this.m_elements){if(this.m_elements[elem_id]){if(this.m_elements[elem_id].getId()==elId){this.m_elements[elem_id].removeDOM();delete this.m_elements[elem_id];this.m_elements[elem_id]=undefined;res=true;break;}}}
return res;} 
function MaskEdit(id,editMask){InitializeMaskEdit(id,editMask);}
function TipEdit(id,strTip){InitializeTipBox(id,strTip);} 
function Kalendar(inputId,options){options=options||{};var DEF_PATTERN='dd/mm/yy hh:mmin:ss';this.formatPattern=(options.formatPattern==undefined)?DEF_PATTERN:options.formatPattern;this.m_timeSeconds=DateHandler.timeToSeconds(options.time||"00:00:00");this.m_winObj=options.winObj;if(inputId!=undefined){this.inputId=inputId;var node=nd(this.inputId,this.getWinObjDocum());if(node!=undefined){var dt;if(node.value&&node.value.length>0){dt=DateHandler.strToDate(node.value);if(dt=='Invalid Date'||dt=='NaN'){dt=new Date();}}
else{dt=new Date();}
this.setCurDate(dt);}}}
Kalendar.prototype.PIC_PREV_MONTH='img/pagination/page-prev.png';Kalendar.prototype.PIC_PREV_YEAR='img/pagination/page-first.png';Kalendar.prototype.PIC_NEXT_MONTH='img/pagination/page-next.png';Kalendar.prototype.PIC_NEXT_YEAR='img/pagination/page-last.png';Kalendar.prototype.KALENDAR_CLASS='pop_up_kalendar';Kalendar.prototype.curDate;Kalendar.prototype.theMonths=["Январь","Февраль","Март","Апрель","Maй","Июнь","Июль","Август","Сентябрь","Oктябрь","Ноябрь","Декабрь"]
Kalendar.prototype.kalendNode;Kalendar.prototype.evOnBoxOpen;Kalendar.prototype.evOnBoxClose;Kalendar.prototype.evOnSelectDate;Kalendar.prototype.setCurDate=function(str_or_date){if(typeof str_or_date=='string'){this.curDate=DateHandler.strToDate(str_or_date);}
else{this.curDate=str_or_date;}}
Kalendar.prototype.getCurDate=function(){return DateHandler.dateToStr(this.curDate,this.formatPattern);}
Kalendar.prototype.getHTML=function(){var cur_date=new Date();var cur_month=cur_date.getMonth();var cur_year=cur_date.getFullYear();var cur_day=cur_date.getDate();var days_descr=['Пн','Вт','Ср','Чт','Пт','Сб','Вс'];var year=this.curDate.getFullYear();var sel_day=this.curDate.getDate();var date_my=this.theMonths[this.curDate.getMonth()]+' '+year;var month=this.curDate.getMonth();var first_day=DateHandler.getFirstDay(year,month);var days_in_month=DateHandler.getMonthLen(year,month);if(first_day>0){var days_in_prev_month=DateHandler.getMonthLen(year,month-1);}
kal_html='<table class="dialogWindow kalendar">'+'<tbody>'+'<tr><th colSpan="7"><span style="float:left">Календарь</span><img id="kl_cancel" style="float:right" class="form_close" src="img/windowfiles/close.gif" alt="X"></th></tr>'+'<tr><td colSpan="3" align="center"><img class="kl_ctrl" id="kl_y_back" src="'+this.PIC_PREV_YEAR+'" alt="<<"></img><img id="kl_m_back" class="kl_ctrl" src="'+this.PIC_PREV_MONTH+'" alt="<"></img></td>'+'<td align="center"><a id="kl_menu" class="kl_ctrl">...</a></td>'+'<td colSpan="3" align="center"><img id="kl_m_forw" class="kl_ctrl" src="'+this.PIC_NEXT_MONTH+'" alt=">>"></img><img id="kl_y_forw" class="kl_ctrl" src="'+this.PIC_NEXT_YEAR+'" alt=">"></img></td>'+'</tr>'+'<tr><td colspan="7" align="center">'+date_my+'</td></tr>'+'<tr>';var day_class;for(var i=0;i<7;i++){day_class=(i>=5)?'kl_week_days_off':'kl_week_days';kal_html+='<td class="'+day_class+'">'+days_descr[i]+'</td>';}
kal_html+='</tr>';var class_name='';var day=1,day_n,id,day_next_m=1;for(var col=0;col<6&&day<=days_in_month;col++){kal_html+='<tr>';for(var row=0;row<7;row++){if((col==0)&&(row<first_day)){class_name='out_date';day_n=days_in_prev_month-first_day+row+1;id='';}
else if(day>days_in_month){class_name='out_date';day_n=day_next_m;day_next_m++;id='';}
else{var off=(row>=5)?'_off':'';class_name='act_day'+off;id=' id="kl_day_'+day+'"';day_n=day;if(year==cur_year&&month==cur_month&&day==cur_day){class_name+=" cur_date";}
if(year==cur_year&&month==cur_month&&day==sel_day){class_name+=" sel_date";}
day++;}
kal_html+='<td><div style="text-align:center;" class="'+class_name+'"'+id+'>'+day_n+'</div></td>';}
kal_html+='</tr>';}
kal_html+='</tbody>'+'</table>';return kal_html;}
Kalendar.prototype.hide=function(){this.closePopUp();}
Kalendar.prototype.closePopUp=function(){var node=nd('kl_'+this.inputId,this.getWinObjDocum());if(node!=undefined){var body=document.getElementsByTagName('body')[0];body.removeChild(node);if(this.evOnBoxClose!=undefined){this.evOnBoxClose();}}}
Kalendar.prototype.assignControls=function(){var self=this;nd("kl_y_back",this.getWinObjDocum()).onclick=function(){self.curDate.setFullYear(self.curDate.getFullYear()-1);self.refresh();};nd("kl_y_forw",this.getWinObjDocum()).onclick=function(){self.curDate.setFullYear(self.curDate.getFullYear()+1);self.refresh();};nd("kl_m_back",this.getWinObjDocum()).onclick=function(){self.curDate.setMonth(self.curDate.getMonth()-1);self.refresh();};nd("kl_m_forw",this.getWinObjDocum()).onclick=function(){self.curDate.setMonth(self.curDate.getMonth()+1);self.refresh();};nd("kl_menu",this.getWinObjDocum()).onclick=function(){alert("ToDo");};nd("kl_cancel",this.getWinObjDocum()).onclick=function(){self.closePopUp();};var days_in_month=DateHandler.getMonthLen(this.curDate.getFullYear(),this.curDate.getMonth());var day_node;for(var i=1;i<=days_in_month;i++){day_node=nd("kl_day_"+i,this.getWinObjDocum());if(day_node!=undefined){day_node.onclick=function(event){event=EventHandler.fixMouseEvent(event);self.selectDate(event.target.id.replace(/kl_day_/,""));};}}}
Kalendar.prototype.selectDate=function(day_num){this.setCurDate(new Date(this.curDate.getFullYear(),this.curDate.getMonth(),day_num));if(this.evOnSelectDate!=undefined){this.evOnSelectDate();}
if(this.inputId!=undefined){var input_node=nd(this.inputId,this.getWinObjDocum());if(input_node!=undefined){input_node.value=this.getCurDate();input_node.focus();this.closePopUp();}}}
Kalendar.prototype.show=function(parent){var node;if(parent){node=parent;}
else{node=nd(this.inputId,this.getWinObjDocum());}
if(node!=undefined){this.closePopUp();this.kalendNode=document.createElement('div');this.kalendNode.id='kl_'+node.id;this.kalendNode.className=this.KALENDAR_CLASS;with(this.kalendNode.style){border="1px solid gray";background="#FFFFFF";color="#000000";position="absolute";display="block";padding="2px";cursor="default";zIndex="999999";}
this.kalendNode.innerHTML=this.getHTML();this.kalendNode.style.top=(findPosY(node)+node.offsetHeight+2)+"px";this.kalendNode.style.left=(findPosX(node)+node.offsetWidth+2)+"px";this.getWinObjDocum().body.appendChild(this.kalendNode);this.assignControls();if(this.evOnBoxOpen!=undefined){this.evOnBoxOpen();}}}
Kalendar.prototype.refresh=function(){if(this.kalendNode!=undefined){this.kalendNode.innerHTML=this.getHTML();this.assignControls();}}
Kalendar.prototype.getWinObjDocum=function(){if(this.m_winObj){return this.m_winObj.getWindowForm().document;}
else{return window.document;}} 
function Calculator(inputId,options){options=options||{};this.m_winObj=options.winObj;this.inputId=inputId;this.resetVars();}
Calculator.prototype.CALC_CLASS='calc';Calculator.prototype.getVal=function(){return nd("ekran",this.getWinObjDocum()).value;}
Calculator.prototype.setVal=function(val){nd("ekran",this.getWinObjDocum()).value=val;}
Calculator.prototype.close=function(cancel){if(!cancel){var node=nd(this.inputId,this.getWinObjDocum());if(node!=undefined){node.value=this.getVal();node.focus();}}
var n=nd(this.inputId+"_calc",this.getWinObjDocum());if(n){n.parentNode.removeChild(n);}}
Calculator.prototype.wynik=0;Calculator.prototype.op;Calculator.prototype.nowe=0;Calculator.prototype.nowe2=0;Calculator.prototype.done=1;Calculator.prototype.oset=0;Calculator.prototype.kropka;Calculator.prototype.temp;Calculator.prototype.resetVars=function(){this.wynik=0,this.op=0,this.nowe=0,this.nowe2=0,this.done=1,this.oset=0;}
Calculator.prototype.reset=function(value){this.setVal(value);this.resetVars();}
Calculator.prototype.wspolna=function(new_temp){this.kropka=1;if(this.nowe||this.done){this.nowe=0;this.done=0;this.temp=new_temp;}
for(var i=0;i<this.temp.length;i++)if(this.temp[i]=='.')this.kropka=0;}
Calculator.prototype.calcButton=function(ktory,ktory2){this.temp=this.getVal();if(ktory2=='.'){this.wspolna('0');if(this.kropka){this.temp+=ktory2;this.setVal(this.temp);this.oset=0;}}
if(ktory>=0&&ktory<=9){this.wspolna('');if(this.temp==0&&this.kropka==1)this.temp='';this.temp+=ktory;this.setVal(this.temp);this.oset=1;}
if(ktory2=='-'||ktory2=='+'||ktory2=='/'||ktory2=='*'){if(this.nowe)this.op=ktory2
else{if(!this.nowe2){this.op=ktory2;this.wynik=this.temp;this.nowe2=1;}
else{this.wynik=eval(this.wynik+this.op+this.temp);this.op=ktory2;this.setVal(wynik);}
this.oset=0;this.nowe=1;}}
if(ktory2=='1/x'){this.wynik=eval(1/this.temp);this.reset(this.wynik);}
if(ktory2=='sqrt'){this.wynik=Math.sqrt(this.temp);this.reset(this.wynik);}
if(ktory2=='exp'){this.wynik=Math.exp(this.temp);this.reset(this.wynik);}
if(ktory2=='+/-')this.setVal(eval(-this.temp));if(ktory2=='='&&this.oset&&this.op!='0')this.reset(eval(this.wynik+this.op+this.temp));if(ktory2=='C')this.reset(0);if(this.getVal()[0]=='.')
this.setVal('0')+this.getVal();}
Calculator.prototype.getHTML=function(){var calc_html='<table cellPadding="0" cellSpacing="5">'+'<tbody>'+'<tr align="left">'+'<td colSpan="5" align="right"><div id="'+this.inputId+'_calc_cancel"><img src="img/modal/close.gif"></div></td></tr>'+'<td colSpan="5"><input style="width:100%;" id="ekran" value="0" size="20"/></td></tr>'+'<tr align="middle">'+'<td colSpan="3">Калькулятор</td>'+'<td><input id="'+this.inputId+'_calc_btn_C" type="button" value="C"/></td>'+'<td><input id="'+this.inputId+'_calc_btn_OK" type="button" value="OK"/></td></tr>'+'<tr align="middle">'+'<td><input id="calc_btn_7" class="calc_ctrl" type="button" value="  7  "/></td>'+'<td><input id="calc_btn_8" class="calc_ctrl" type="button" value="  8  "/></td>'+'<td><input id="calc_btn_9" class="calc_ctrl" type="button" value="  9  "/></td>'+'<td><input id="calc_btn_/" class="calc_ctrl" type="button" value="  /  "/></td>'+'<td><input id="calc_btn_sqrt" class="calc_ctrl" type="button" value="sqrt"/></td></tr>'+'<tr align="middle">'+'<td><input id="calc_btn_4" class="calc_ctrl" type="button" value="  4  "/></td>'+'<td><input id="calc_btn_5" class="calc_ctrl" type="button" value="  5  "/></td>'+'<td><input id="calc_btn_6" class="calc_ctrl" type="button" value="  6  "/></td>'+'<td><input id="calc_btn_*" class="calc_ctrl" type="button" value=" *  "/></td>'+'<td><input id="calc_btn_exp" class="calc_ctrl" type="button" value="exp"/></td></tr>'+'<tr align="middle">'+'<td><input id="calc_btn_1" class="calc_ctrl" type="button" value="  1  "/></td>'+'<td><input id="calc_btn_2" class="calc_ctrl" type="button" value="  2  "/></td>'+'<td><input id="calc_btn_3" class="calc_ctrl" type="button" value="  3  "/></td>'+'<td><input id="calc_btn_-" class="calc_ctrl" type="button" value="  -  "/></td>'+'<td><input id="calc_btn_1/x" class="calc_ctrl" type="button" value="1/x "/></td></tr>'+'<tr align="middle">'+'<td><input id="calc_btn_0" class="calc_ctrl" type="button" value="  0  "/></td>'+'<td><input id="calc_btn_+/-" class="calc_ctrl" class="calc_ctrl" type="button" value=" +/- "/></td>'+'<td><input id="calc_btn_." class="calc_ctrl" type="button" value="  ,  "/></td>'+'<td><input id="calc_btn_+" class="calc_ctrl" type="button" value="  +  "/></td>'+'<td><input id="calc_btn_=" class="calc_ctrl" type="button" value="  =  "/></td>'+'</tr>'+'</tbody>'+'</table>';return calc_html;}
Calculator.prototype.assignControls=function(){var self=this;nd(this.inputId+"_calc_cancel",this.getWinObjDocum()).onclick=function(){self.close(true);};nd(this.inputId+"_calc_btn_OK",this.getWinObjDocum()).onclick=function(){self.close(false);};nd(this.inputId+"_calc_btn_C",this.getWinObjDocum()).onclick=function(){self.calcButton(11,"C");};var list=DOMHandler.getElementsByAttr('calc_ctrl',this.calcNode,'class');var id;for(var i=0;i<list.length;i++){list[i].onclick=function(event){event=EventHandler.fixMouseEvent(event);id=event.target.id.replace(/calc_btn_/,'');self.calcButton(id,id);};}}
Calculator.prototype.show=function(){var node=nd(this.inputId,this.getWinObjDocum());if(node!=undefined&&nd(this.inputId+"_calc",this.getWinObjDocum())==undefined){this.calcNode=document.createElement('div');this.calcNode.id=this.inputId+"_calc";this.calcNode.className=this.CALC_CLASS;with(this.calcNode.style){border="1px solid gray";background='#FFFFFF';color='#000000';position='absolute';display='block';padding='2px';cursor='default';}
this.calcNode.innerHTML=this.getHTML();this.calcNode.style.top=(findPosY(node)+node.offsetHeight+2)+"px";this.calcNode.style.left=(findPosX(node)+node.offsetWidth+2)+"px";this.getWinObjDocum().body.appendChild(this.calcNode);this.assignControls();this.setVal(node.value);}}
Calculator.prototype.refresh=function(){if(this.calcNode!=undefined){this.calcNode.innerHTML=this.getHTML();this.assignControls();}}
Calculator.prototype.getWinObjDocum=function(){if(this.m_winObj){return this.m_winObj.getWindowForm().document;}
else{return window.document;}} 
function Label(oldOpts,options){var id;if(!options){options=oldOpts;id=options.id;}
else{id=oldOpts;}
options=options||{};var tagName=options.tagName||this.DEF_TAG_NAME;options.className=options.className||("control-label "+get_bs_col()+"4");Label.superclass.constructor.call(this,id,tagName,options);if(options.caption!=undefined){this.setCaption(options.caption);}}
extend(Label,Control);Label.prototype.DEF_TAG_NAME="label";Label.prototype.setCaption=function(caption){this.setValue(caption);}
Label.prototype.getCaption=function(){return this.getValue();} 
function LabelField(fieldId,caption,options){options=options||{};options.tagName=options.tagName||"label";options.attrs=options.attrs||{};options.attrs["for"]=fieldId;options.caption=caption;options.id="label"+fieldId;LabelField.superclass.constructor.call(this,options);}
extend(LabelField,Label); 
function Button(id,options){options=options||{};options.className=options.className||this.DEF_CLASS;Button.superclass.constructor.call(this,id,options.tag||options.tagName||this.DEF_TAG_NAME,options);if(options.caption!=undefined){this.setCaption(options.caption);}
if(options.image!=undefined){this.setImage(options.image);}
if(options.glyph){this.setGlyph(options.glyph);}
var self=this;this.m_clickFunc=function(e){if(self.getEnabled()&&self.m_onClick){self.m_onClick(e);}}
if(options.onClick!=undefined){this.setOnClick(options.onClick);}}
extend(Button,Control);Button.prototype.DEF_TAG_NAME="div";Button.prototype.DEF_IMAGE_CLASS="btnImg";Button.prototype.DEF_CLASS="btn btn-default";Button.prototype.setCaption=function(caption){if(this.m_node.childNodes.length==0){this.m_node.appendChild(document.createTextNode(caption));}
else{this.m_node.childNodes[0].nodeValue=caption;}}
Button.prototype.getCaption=function(){return this.m_node.childNodes[0].nodeValue;}
Button.prototype.setImage=function(image){this.m_image=image;var img=DOMHandler.createImgElement(image.src,image.alt,image.h,image.w);img.className=this.DEF_IMAGE_CLASS;this.m_node.appendChild(img);}
Button.prototype.getImage=function(){return this.m_image;}
Button.prototype.getGlyph=function(){return this.m_glyph;}
Button.prototype.setGlyph=function(glyph){this.m_glyph=glyph;var n=document.createElement("i");n.className="glyphicon "+glyph;this.m_node.appendChild(n);}
Button.prototype.setOnClick=function(onClick){this.m_onClick=onClick;this.addClick();}
Button.prototype.getOnClick=function(){return this.m_onClick;}
Button.prototype.addClick=function(){var self=this;EventHandler.addEvent(this.m_node,"click",this.m_clickFunc,false);}
Button.prototype.removeClick=function(){var self=this;EventHandler.removeEvent(this.m_node,"click",this.m_clickFunc,false);} 
function ButtonCtrl(id,options){options=options||{};options.className="btn btn-default";ButtonCtrl.superclass.constructor.call(this,id,options);}
extend(ButtonCtrl,Button); 
function ButtonSmall(id,options){options=options||{};options.className="btn btn-xs";ButtonSmall.superclass.constructor.call(this,id,options);}
extend(ButtonSmall,Button); 
function ButtonCmd(id,options){options=options||{};options.className="btn btn-primary btn-cmd";ButtonCmd.superclass.constructor.call(this,id,options);}
extend(ButtonCmd,Button); 
function ButtonToggle(id,options){options=options||{};options.className="btn btn-link";options.glyph="glyphicon-triangle-bottom";options.attrs=options.attrs||{};options.attrs["data-toggle"]="collapse";options.attrs["data-target"]=("#"+options.dataTarget);ButtonToggle.superclass.constructor.call(this,id,options);}
extend(ButtonToggle,Button); 
function ButtonCalc(id,options){options=options||{};options.glyph="glyphicon-th";options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||options.attrs.hint||this.DEF_HINT;options.onClick=options.onClick||function(event){event=EventHandler.fixMouseEvent(event);var id=event.target.parentNode.parentNode.previousSibling.id;var kal=new Calculator(id);kal.show();};ButtonCalc.superclass.constructor.call(this,id,options);}
extend(ButtonCalc,ButtonCtrl);ButtonCalc.prototype.DEF_HINT="открыть калькулятор";ButtonCalc.prototype.DEF_ALT="клк."; 
function ButtonClear(id,options){options=options||{};options.glyph="glyphicon-remove";options.onClick=options.onClick||function(event){if(options.editControl){options.editControl.resetValue();}};ButtonClear.superclass.constructor.call(this,id,options);}
extend(ButtonClear,ButtonCtrl);ButtonClear.prototype.DEF_HINT="очистить значение"; 
function ButtonExpToExcel(id,options){options=options||{};options.caption=options.caption||this.DEF_CAPTION;options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||this.DEF_HINT;ButtonExpToExcel.superclass.constructor.call(this,id,options);}
extend(ButtonExpToExcel,ButtonCmd);ButtonExpToExcel.prototype.DEF_HINT="экспорт в Excel";ButtonExpToExcel.prototype.DEF_CAPTION="Excel"; 
function ButtonExpToPDF(id,options){options=options||{};options.caption=options.caption||this.DEF_CAPTION;options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||this.DEF_HINT;ButtonExpToPDF.superclass.constructor.call(this,id,options);}
extend(ButtonExpToPDF,ButtonCmd);ButtonExpToPDF.prototype.DEF_HINT="экспорт в PDF";ButtonExpToPDF.prototype.DEF_CAPTION="PDF"; 
function ButtonKalendar(id,options){options=options||{};options.glyph="glyphicon-calendar";this.m_inputId=options.inputId;options.attrs=options.attrs||{};options.attrs.hint=options.attrs.hint||this.DEF_HINT;this.m_datePattern=options.datePattern;this.m_time=DateHandler.timeToMS(options.timeValueStr||"00:00:00");this.m_onSelected=options.onSelected;var self=this;options.onClick=options.onClick||function(event){var p=$("#"+self.m_inputId);p.datepicker({format:self.m_datePattern,language:"ru",daysOfWeekHighlighted:"0,6",autoclose:true,todayHighlight:true,orientation:"bottom right",showOnFocus:false});p.datepicker().on("hide",function(e){if(self.m_onSelected){self.m_onSelected.call(self,e);}});p.datepicker("show");};ButtonKalendar.superclass.constructor.call(this,id,options);}
extend(ButtonKalendar,ButtonCtrl);ButtonKalendar.prototype.DEF_HINT="открыть календарь";ButtonKalendar.prototype.DEF_ALT="кал."; 
function ButtonOpen(id,options){options=options||{};options.glyph=options.glyph||"glyphicon-pencil";options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||this.DEF_HINT;options.onClick=options.onClick||function(event){event=EventHandler.fixMouseEvent(event);alert(event.value);};ButtonOpen.superclass.constructor.call(this,id,options);}
extend(ButtonOpen,ButtonCtrl);ButtonOpen.prototype.DEF_HINT="открыть";ButtonOpen.prototype.DEF_ALT="откр."; 
function ButtonSelect(id,options){options=options||{};options.glyph=options.glyph||"glyphicon-menu-hamburger";options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||options.attrs.hint||this.DEF_HINT;ButtonSelect.superclass.constructor.call(this,id,options);}
extend(ButtonSelect,ButtonCtrl);ButtonSelect.prototype.DEF_HINT="выбрать";ButtonSelect.prototype.DEF_ALT="выбр."; 
function ButtonSelectObject(id,options){var self=this;options=options||{};options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||"выбрать из списка";this.m_methParams=options.methParams;this.m_controller=options.controller;this.m_multySelect=(options.multySelect==undefined)?false:options.multySelect;options.onClick=options.onClick||function(event){var node=nd(options.controlId);self.m_form=new WIN_CLASS(self.getId()+"_form",{"title":"Выбор"});self.m_form.open();if(options.onBeforeViewCreate){options.onBeforeViewCreate.call(self);}
var editViewObj=new options.listView(self.getId()+"EditView",{"onClose":function(res){self.m_form.close();node.focus();},"onSelect":function(keys,descrs,extraFields){if(!self.m_multySelect&&self.m_form){self.m_form.close();delete self.m_form;}
if(options.lookupKeyFieldIds&&options.keyFieldIds){var ind;for(var key_id in keys){ind=options.lookupKeyFieldIds.indexOf(key_id);if(ind>=0){DOMHandler.setAttr(node,"fkey_"+options.keyFieldIds[ind],keys[key_id]);DOMHandler.setAttr(node,"last_fkey_"+options.keyFieldIds[ind],keys[key_id]);}}
var val="";;for(var key_id in descrs){val+=(val=="")?"":" ";val+=descrs[key_id];}
node.value=val;if(extraFields){for(var f in extraFields){DOMHandler.addAttr(node,f,extraFields[f]);}}
node.focus();}
if(options.onSelected){if(options.onSelectContext){options.onSelected.call(options.onSelectContext,keys,descrs,extraFields);}
else{options.onSelected(keys,descrs,extraFields);}}},"readController":options.controller,"readModelId":options.modelId,"readMethodId":options.methodId,"connect":new ServConnector(HOST_NAME),"winObj":self.m_form,"methParams":self.m_methParams,"extraFields":options.extraFields});if(options.onBeforeSelect){options.onBeforeSelect.call(self,editViewObj);}
self.m_form.setCaption(editViewObj.getTitle());self.m_form.setSize(editViewObj.getFormWidth(),editViewObj.getFormHeight());editViewObj.toDOM(self.m_form.getContentParent());self.m_form.setFocus();};ButtonSelectObject.superclass.constructor.call(this,id,options);}
extend(ButtonSelectObject,ButtonSelect);ButtonSelectObject.prototype.m_form; 
function ButtonClearObject(id,options){options=options||{};options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||"очистить";options.onClick=options.onClick||function(event){event=EventHandler.fixMouseEvent(event);var node=nd(options.controlId);node.value="";node.focus();for(var i=0;i<options.keyFieldIds.length;i++){DOMHandler.setAttr(node,"fkey_"+options.keyFieldIds[i],"null");DOMHandler.setAttr(node,"last_fkey_"+options.keyFieldIds[i],"null");}};options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||options.attrs.hint||this.DEF_HINT;ButtonClearObject.superclass.constructor.call(this,id,options);}
extend(ButtonClearObject,ButtonClear);ButtonClearObject.prototype.DEF_HINT="очистить"; 
function ButtonOpenObject(id,options){options=options||{};var self=this;options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||"открыть";options.glyph="glyphicon-pencil";options.onClick=options.onClick||function(event){event=EventHandler.fixMouseEvent(event);var node=event.target.parentNode.parentNode.previousSibling;var KEY_PREF="fkey_";var KEY_PREF_LEN=5;var keys={};var key_count=0;if(node.attributes){for(var i=0;i<options.keyFieldIds.length;i++){if(node.attributes[KEY_PREF+options.keyFieldIds[i]]!=undefined&&node.attributes[KEY_PREF+options.keyFieldIds[i]].nodeValue!=undefined&&node.attributes[KEY_PREF+options.keyFieldIds[i]].nodeValue!=''&&node.attributes[KEY_PREF+options.keyFieldIds[i]].nodeValue!='undefined'){keys[options.lookupKeyFieldIds[i]]=node.attributes[KEY_PREF+options.keyFieldIds[i]].nodeValue;key_count++;}}}
if(key_count==0){return;}
self.m_form=new WIN_CLASS({"caption":"Справочник"});self.m_form.open();var editViewObj=new options.objectView(self.getId()+"EditView",{"onClose":function(res){self.m_form.close();node.focus();},"readController":options.controller,"readModelId":options.modelId,"connect":options.controller.getServConnector(),"winObj":self.m_form});for(var key_id in keys){editViewObj.setReadIdValue(key_id,keys[key_id]);}
self.m_form.setWidth(editViewObj.getFormWidth());self.m_form.setHeight(editViewObj.getFormHeight());self.m_form.setCaption(editViewObj.getFormCaption());editViewObj.toDOM(self.m_form.getContentParent());editViewObj.readData();self.m_form.setFocus();};ButtonOpenObject.superclass.constructor.call(this,id,options);}
extend(ButtonOpenObject,ButtonOpen);ButtonOpenObject.prototype.m_winObj; 
function ButtonPrint(id,options){options=options||{};options.caption=options.caption||this.DEF_CAPTION;var self=this;options.onClick=options.onClick||function(){self.onClick();};options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||this.DEF_HINT;this.m_params=options.params;this.m_paramId=options.paramId;this.m_DOMId=options.DOMId;this.m_controller=options.controller;this.m_errorControl=options.errorControl;this.m_methodId=options.methodId;ButtonPrint.superclass.constructor.call(this,id,options);}
extend(ButtonPrint,ButtonCmd);ButtonPrint.prototype.onClick=function(){if(this.m_DOMId){this.m_params[this.m_paramId]=nd(this.m_DOMId).getAttribute("old_id");}
this.m_controller.run(this.m_methodId||"get_print",{xml:false,async:true,errControl:this.m_errorControl,params:this.m_params,func:function(resp){WindowPrint.show({content:resp});}});}
ButtonPrint.prototype.DEF_HINT="напечатать";ButtonPrint.prototype.DEF_CAPTION="Печать"; 
function ButtonInsertObject(id,options){options=options||{};var self=this;options.attrs=options.attrs||{};options.attrs.title=options.attrs.title||"создать новую запись";options.glyph="glyphicon-plus";this.m_binds=options.binds||{};this.m_controller=options.controller;this.m_methodId=options.methodId||this.m_controller.METH_INSERT;this.m_afterInsert=options.afterInsert;options.onClick=options.onClick||function(event){var pm=this.m_controller.getPublicMethodById(this.m_methodId);pm.setParamValue(this.m_controller.PARAM_RET_ID,"1");var params={};for(var param_id in this.m_binds){params[param_id]=this.m_binds[param_id].getValue();}
var self=this;this.m_controller.run(this.m_methodId,{"params":params,"func":function(resp){WindowMessage.show({"text":"Запись добавлена.","type":WindowMessage.TP_MESSAGE,"callBack":function(){var m=resp.getModelById("LastIds",true);if(m.getNextRow()){for(var param_id in self.m_binds){self.m_binds[param_id].setFieldValue(null,m.getFieldValue("id"));}}
if(self.m_afterInsert){self.m_afterInsert.call(self,m);}}});}})};ButtonInsertObject.superclass.constructor.call(this,id,options);}
extend(ButtonInsertObject,ButtonOpen);ButtonInsertObject.prototype.addBind=function(contrParam,ctrl){this.m_binds[contrParam]=ctrl;} 
function Edit(id,options){options=options||{};options.className=options.className||this.DEF_CLASS;options.attrs=options.attrs||{};var disabled=(options.attrs.disabled);Edit.superclass.constructor.call(this,id,this.DEF_TAG_NAME,options);if(options.editMask!=undefined){this.setEditMask(options.editMask);}
var name=options.name;if(name==undefined&&options.attrs&&options.attrs.name){name=options.attrs.name;}
this.setAttr("name",name||id);this.m_tableLayout=(options.tableLayout==undefined)?true:options.tableLayout;if(options.label){this.setLabel(options.label);}
else if(options.labelCaption){this.setLabel(new LabelField(this.getId(),options.labelCaption,{"className":options.labelClassName,"visible":this.getVisible(),"enabled":this.getEnabled(),"readOnly":this.getVisible()}));}
this.m_buttons=new ControlContainer(this.getId()+this.BTNS_CONTAINER_ID,"span",{"className":this.BTNS_CONTAINER_CLASS,"visible":this.getVisible(),"enabled":this.getEnabled()});if(options.buttonOpen){this.m_buttons.addElement(options.buttonOpen);}
if(!disabled&&options.buttonSelect){this.m_buttons.addElement(options.buttonSelect);}
if(!disabled&&options.buttonClear){this.m_buttons.addElement(options.buttonClear);}
if(options.attrs.maxlength){this.m_maxLength=options.attrs.maxlength;}
if(options.minLength){this.m_minLength=options.minLength;}
if(options.fixedLength){this.m_maxLength=options.attrs.maxlength;this.m_fixedLength=options.attrs.maxlength;}
if(options.validator){this.setValidator(options.validator);}
if(options.value){this.setValue(options.value);}
this.setInputType(options.inputType||this.DEF_INPUT_TYPE);this.m_winObj=options.winObj;this.m_contClassName=options.contClassName||this.DEF_CONT_CLASS;this.m_editContClassName=options.editContClassName||("input-group "+get_bs_col()+"8");}
extend(Edit,Control);Edit.prototype.DEF_TAG_NAME='input';Edit.prototype.DEF_INPUT_TYPE='text';Edit.prototype.DEF_CLASS="form-control";Edit.prototype.BTNS_CONTAINER_ID="Btns";Edit.prototype.BTNS_CONTAINER_CLASS="input-group-btn";Edit.prototype.INCORRECT_VAL_CLASS="incorrect_val";Edit.prototype.DEF_CONT_CLASS="form-group";Edit.prototype.m_editMask;Edit.prototype.m_buttons;Edit.prototype.m_validator;Edit.prototype.m_value;Edit.prototype.m_label;Edit.prototype.m_container;Edit.prototype.setEditMask=function(editMask){this.m_editMask=editMask;}
Edit.prototype.getEditMask=function(){return this.m_editMask;}
Edit.prototype.setMaxLength=function(maxLength){this.setAttr("maxlength",maxLength);}
Edit.prototype.getMaxLength=function(){return this.getAttr("maxlength");}
Edit.prototype.setInputType=function(inputType){this.setAttr("type",inputType);}
Edit.prototype.getInputType=function(){return this.getAttr("type");}
Edit.prototype.getButtons=function(){return this.m_buttons;}
Edit.prototype.setValidator=function(validator){this.m_validator=validator;}
Edit.prototype.getValidator=function(){return this.m_validator;}
Edit.prototype.getValue=function(){if(this.m_node){var mask=this.getEditMask();var val=this.m_node.value;if(mask){var mask_view=mask.replace(/\$d/g,"_");if(mask_view==val){val="";}
else{val=val.replace(/_/g,"");}}
return val;}}
Edit.prototype.setValue=function(newValue){var v=(newValue!=undefined)?newValue:"";if(v.length||(!v.length&&!this.m_editMask)){this.m_node.value=v;}}
Edit.prototype.isEmpty=function(val){return(val==undefined||val.length==0);}
Edit.prototype.isTooLong=function(val){return(val&&this.m_maxLength&&val.length&&val.length>this.m_maxLength);}
Edit.prototype.isTooShort=function(val){return(val&&this.m_minLength&&val.length&&val.length<this.m_minLength);}
Edit.prototype.isNotFixed=function(val){return(val&&this.m_fixedLength&&val.length&&val.length!=this.m_maxLength);}
Edit.prototype.setNotValid=function(erStr){DOMHandler.addClass(this.m_node,this.INCORRECT_VAL_CLASS);throw new Error(erStr);}
Edit.prototype.setValid=function(){DOMHandler.removeClass(this.m_node,this.INCORRECT_VAL_CLASS);}
Edit.prototype.validate=function(val){this.setValid();if(this.m_node.getAttribute("required")=="required"&&this.isEmpty(val)){this.setNotValid("Пустое значение");}
if(this.isTooLong(val)){this.setNotValid("Слишком длинное значение");}
if(this.isTooShort(val)){this.setNotValid("Слишком короткое значение");}
if(this.isNotFixed(val)){this.setNotValid("Не равно "+this.m_maxLength+" симв.");}
return val;}
Edit.prototype.toDOM=function(parent){var edit_container_node=parent;if(this.m_label){this.m_container=new Control(uuid(),"div",{"className":this.m_contClassName,visible:this.getVisible()});if(!parent){var dom_n=nd(this.getId());if(!dom_n){throw new Exception("DOM node not found!");}
var par=dom_n.parentNode;par.replaceChild(this.m_container.m_node,dom_n);}
else{this.m_container.toDOM(parent);}
this.m_label.toDOM(this.m_container.m_node);this.m_edit_container=new Control(uuid(),"div",{"className":this.m_editContClassName});this.m_edit_container.setVisible(this.getVisible());this.m_edit_container.setEnabled(this.getEnabled());this.m_edit_container.toDOM(this.m_container.m_node);edit_container_node=this.m_edit_container.m_node;}
Edit.superclass.toDOM.call(this,edit_container_node);if(this.m_editMask){MaskEdit(this.m_node,this.m_editMask);}
if(this.m_buttons&&!this.m_buttons.isEmpty()){this.m_buttons.toDOMAfter(this.m_node);}}
Edit.prototype.setLabel=function(label){this.m_label=label;}
Edit.prototype.getLabel=function(){return this.m_label;}
Edit.prototype.removeDOM=function(){if(this.m_container){this.m_container.removeDOM();}
if(this.m_buttons){this.m_buttons.removeDOM();}
if(this.m_editMask){RemoveMaskEdit(this.m_node);}
Edit.superclass.removeDOM.call(this);}
Edit.prototype.getValueForDb=function(){return this.validate(this.getValue());}
Edit.prototype.setVisible=function(visible){if(this.m_label){this.m_label.setVisible(visible);if(this.m_container){this.m_container.setVisible(visible);}
if(this.m_edit_container){this.m_edit_container.setVisible(visible);}}
if(this.m_buttons){this.m_buttons.setVisible(visible);}
Edit.superclass.setVisible.call(this,visible);}
Edit.prototype.setReadOnly=function(readOnly){if(this.m_label){this.m_label.setReadOnly(readOnly);}
if(this.m_buttons){this.m_buttons.setReadOnly(readOnly);}
Edit.superclass.setReadOnly.call(this,readOnly);}
Edit.prototype.setEnabled=function(enabled){if(this.m_label){this.m_label.setEnabled(enabled);}
if(this.m_buttons){this.m_buttons.setEnabled(enabled);}
Edit.superclass.setEnabled.call(this,enabled);}
Edit.prototype.setFormerValue=function(id,value){if(value==null){v="";}
else{v=value;}
DOMHandler.setAttr(this.m_node,"old_"+id,v);}
Edit.prototype.setComment=function(com){if(this.m_comment==undefined){this.m_comment=new Control(this.getId()+"_comment_","div",{visible:true,"className":"form-control-static ctrl_comment"});this.m_comment.toDOM(this.m_container?this.m_container.getNode():this.m_node.parentNode);}
this.m_comment.setValue(com);this.m_comment.setVisible(true);}
Edit.prototype.getFormerFieldValue=function(id){return DOMHandler.getAttr(this.m_node,id);}
Edit.prototype.setFocus=function(){this.m_node.focus();}
Edit.prototype.resetValue=function(){this.m_node.value="";this.setFocus();var mask=this.getEditMask();if(mask){MaskEdit(this.m_node,mask);}} 
function EditString(id,options){options=options||{};options.validator=options.validator||new ValidatorString();if(options.buttonClear==undefined&&(options.noClear==undefined||options.noClear===false)){options.buttonClear=new ButtonClear(id+"_btn_clear",{"editControl":this});}
EditString.superclass.constructor.call(this,id,options);}
extend(EditString,Edit); 
function stopEvent(evt){evt||window.event;if(evt.stopPropagation){evt.stopPropagation();evt.preventDefault();}else if(typeof evt.cancelBubble!="undefined"){evt.cancelBubble=true;evt.returnValue=false;}
return false;}
function getElement(evt){if(window.event){return window.event.srcElement;}else{return evt.currentTarget;}}
function getTargetElement(evt){if(window.event){return window.event.srcElement;}else{return evt.target;}}
function stopSelect(obj){if(typeof obj.onselectstart!='undefined'){EventHandler.addEvent(obj,"selectstart",function(){return false;});}}
function getCaretEnd(obj,winDocum){if(typeof obj.selectionEnd!="undefined"){return obj.selectionEnd;}else if(winDocum.selection&&winDocum.selection.createRange){var M=winDocum.selection.createRange();try{var Lp=M.duplicate();Lp.moveToElementText(obj);}catch(e){var Lp=obj.createTextRange();}
Lp.setEndPoint("EndToEnd",M);var rb=Lp.text.length;if(rb>obj.value.length){return-1;}
return rb;}}
function getCaretStart(obj,winDocum){if(typeof obj.selectionStart!="undefined"){return obj.selectionStart;}else if(winDocum.selection&&winDocum.selection.createRange){var M=winDocum.selection.createRange();try{var Lp=M.duplicate();Lp.moveToElementText(obj);}catch(e){var Lp=obj.createTextRange();}
Lp.setEndPoint("EndToStart",M);var rb=Lp.text.length;if(rb>obj.value.length){return-1;}
return rb;}}
function setCaret(obj,l){obj.focus();if(obj.setSelectionRange){obj.setSelectionRange(l,l);}else if(obj.createTextRange){m=obj.createTextRange();m.moveStart('character',l);m.collapse();m.select();}}
function setSelection(obj,s,e){obj.focus();if(obj.setSelectionRange){obj.setSelectionRange(s,e);}else if(obj.createTextRange){m=obj.createTextRange();m.moveStart('character',s);m.moveEnd('character',e);m.select();}}
String.prototype.addslashes=function(){return this.replace(/(["\\\.\|\[\]\^\*\+\?\$\(\)])/g,'\\$1');}
String.prototype.trim=function(){return this.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1");};function curTop(obj){toreturn=0;while(obj){toreturn+=obj.offsetTop;obj=obj.offsetParent;}
return toreturn;}
function curLeft(obj){toreturn=0;while(obj){toreturn+=obj.offsetLeft;obj=obj.offsetParent;}
return toreturn;}
function isNumber(a){return typeof a=='number'&&isFinite(a);}
function replaceHTML(obj,text,winDocum){while(el=obj.childNodes[0]){obj.removeChild(el);};obj.appendChild(winDocum.createTextNode(text));}
function actbAJX(options){options=options||{};if(options.controller){this.m_controller=options.controller;}
this.m_methodId=options.methodId||this.DEF_METHOD;if(options.modelId){this.m_modelId=options.modelId;}
this.m_patternParamId=options.patternParamId||this.DEF_PATTERN_PARAM;if(options.lookupValueFieldId){this.m_acValueFieldId=options.lookupValueFieldId;}
if(options.resultFieldId){this.m_acResFieldId=options.resultFieldId;}
this.m_keyFieldIds=options.keyFieldIds||[];this.m_acKeyFieldIds=options.lookupKeyFieldIds||[];this.m_extraFields=options.extraFields||[];this.m_ic=(options.ic==undefined)?'1':(options.ic)?'1':'0';this.m_mid=(options.mid==undefined)?'0':(options.mid)?'1':'0';this.m_isObject=(this.m_keyFieldIds.length>0);this.m_minLengthForQuery=options.minLengthForQuery||this.MIN_LEN_FOR_QUERY;this.m_onSelected=options.onSelected;this.m_queryDelay=options.queryDelay||this.SERV_Q_DELAY;this.m_resultFieldIdsToAttr=options.resultFieldIdsToAttr;this.m_fullTextSearch=options.fullTextSearch;this.m_updateInputOnCursor=options.updateInputOnCursor;}
actbAJX.prototype.DEF_PATTERN_PARAM='pattern';actbAJX.prototype.DEF_METHOD='complete';actbAJX.prototype.MIN_LEN_FOR_QUERY=4;actbAJX.prototype.SERV_Q_DELAY=0;actbAJX.prototype.m_controller;actbAJX.prototype.m_patternParamId;actbAJX.prototype.m_minLengthForQuery;actbAJX.prototype.m_acValueFieldId;actbAJX.prototype.m_keyFieldIds;actbAJX.prototype.m_extraFields;actbAJX.prototype.m_resultClasses;actbAJX.prototype.m_acKeyFieldIds;actbAJX.prototype.m_isObject;actbAJX.prototype.m_respModel;actbAJX.prototype.m_ic;actbAJX.prototype.m_mid;actbAJX.prototype.m_updateInputOnCursor;actbAJX.prototype.m_queryDelay;actbAJX.prototype.resultFieldIdsToAttr;actbAJX.prototype.resultFieldsToAttr;actbAJX.prototype.getMinLengthForQuery=function(){return this.m_minLengthForQuery;}
actbAJX.prototype.getIsObject=function(){return this.m_isObject;}
actbAJX.prototype.getQueryDelay=function(){return this.m_queryDelay;}
actbAJX.prototype.fillArrayOnPattern=function(inputNode){var currValue=inputNode.value;for(var i=0;i<this.m_acKeyFieldIds.length;i++){DOMHandler.setAttr(inputNode,"fkey_"+this.m_keyFieldIds[i],'');}
this.m_array=[];if(this.m_resultFieldIdsToAttr)this.m_resultFieldsToAttr=[];if(this.m_acResFieldId){this.m_resArray=[];}
if(currValue.length<this.getMinLengthForQuery()){this.onFillArrayEnd();return;}
var self=this;var params={};var pm=this.m_controller.getPublicMethodById(this.m_methodId);params[this.m_patternParamId]=currValue;if(pm.paramExists("ic")){params["ic"]=this.m_ic;}
if(pm.paramExists("mid")){params["mid"]=this.m_mid;}
self.m_controller.runPublicMethod(self.m_methodId,params,true,function(resp){self.m_respModel=resp.getModelById(self.m_modelId);self.m_respModel.setActive(true);var descr_field_val;while(self.m_respModel.getNextRow()){descr_field_val=self.m_respModel.getFieldById(self.m_acValueFieldId).getValue();if($.inArray(descr_field_val,self.m_array)==-1){self.m_array.push(descr_field_val);if(self.m_acResFieldId){self.m_resArray.push(self.m_respModel.getFieldById(self.m_acResFieldId).getValue());}
if(self.m_resultFieldIdsToAttr){for(var rfi=0;rfi<self.m_resultFieldIdsToAttr.length;rfi++){self.m_resultFieldsToAttr.push({"attr":self.m_resultFieldIdsToAttr[rfi],"val":self.m_respModel.getFieldById(self.m_resultFieldIdsToAttr[rfi]).getValue()});}}}}
self.onFillArrayEnd();});}
actbAJX.prototype.setObjectId=function(inputNode,closeDisp){this.m_respModel.setRowBOF();var id_found=false;var val=inputNode.value.replace(/\s+$/g,'');while(!id_found&&this.m_respModel.getNextRow()){var fid=(this.m_acResFieldId)?this.m_acResFieldId:this.m_acValueFieldId;var f_val=this.m_respModel.getFieldById(fid).getValue().replace(/\s+$/g,'');id_found=(f_val==val);if(id_found){for(var i=0;i<this.m_acKeyFieldIds.length;i++){DOMHandler.setAttr(inputNode,"fkey_"+this.m_keyFieldIds[i],this.m_respModel.getFieldValue(this.m_acKeyFieldIds[i]));DOMHandler.setAttr(inputNode,"last_fkey_"+this.m_keyFieldIds[i],this.m_respModel.getFieldValue(this.m_acKeyFieldIds[i]));}
for(var i=0;i<this.m_extraFields.length;i++){DOMHandler.setAttr(inputNode,this.m_extraFields[i],this.m_respModel.getFieldValue(this.m_extraFields[i]));}
DOMHandler.removeClass(inputNode,"error");}}
if(closeDisp&&!id_found){WindowMessage.show({text:"Значение не выбрано",callBack:function(){inputNode.value='';}});}
else if(closeDisp&&this.m_onSelected){this.m_onSelected.call(this,inputNode);console.log("this.m_onSelected.call focus")}}
actbAJX.prototype.unsetObjectId=function(inputNode){for(var i=0;i<this.m_acKeyFieldIds.length;i++){DOMHandler.setAttr(inputNode,"fkey_"+this.m_keyFieldIds[i],"");}
for(var i=0;i<this.m_extraFields.length;i++){DOMHandler.setAttr(inputNode,this.m_extraFields[i],"");}}
actbAJX.prototype.isObjectIdSet=function(inputNode){var res=true;for(var i=0;i<this.m_acKeyFieldIds.length;i++){if(DOMHandler.getAttr(inputNode,"fkey_"+this.m_keyFieldIds[i])==""){res=false;break;}}
return res;}
actbAJX.prototype.setOnSelected=function(onSelected){this.m_onSelected=onSelected;}
function actb(obj,winObj,servConnect){var winDocum=(winObj==undefined)?window.document:(winObj.getWindowForm==undefined)?window.document:winObj.getWindowForm().document;var obj=typeof(obj)=="string"?nd(obj,winDocum):obj;if(obj==null){alert("Error:ctrl {"+obj+"} does not exist!");return false;}
var ajxCon=servConnect;var slef=this;ajxCon.onFillArrayEnd=function(){DOMHandler.addClass(actb_curr,"error");_actb_tocomplete();if(!actb_display){actb_generate();actb_display=true;}}
this.actb_timeOut=-1;this.actb_lim=4;this.actb_firstText=false;this.actb_mouse=true;this.actb_delimiter=new Array(';',',');this.actb_startcheck=1;this.actb_bgColor='#888888';this.actb_textColor='#FFFFFF';this.actb_hColor='#000000';this.actb_fFamily='Verdana';this.actb_fSize='11px';this.actb_hStyle='text-decoration:underline;font-weight="bold"';var actb_delimwords=new Array();var actb_cdelimword=0;var actb_delimchar=new Array();var actb_display=false;var actb_pos=0;var actb_total=0;var actb_curr=null;var actb_rangeu=0;var actb_ranged=0;var actb_bool=new Array();var actb_pre=0;var actb_toid;var actb_tomake=false;var actb_getpre="";var actb_mouse_on_list=1;var actb_kwcount=0;var actb_caretmove=false;this.actb_keywords=new Array();this.actb_keywords=[];var actb_self=this;var timeoutId;actb_curr=obj;actb_curr.setAttribute("autocomplete","off");EventHandler.addEvent(actb_curr,"focus",function(){EventHandler.addEvent(winDocum,"keydown",actb_checkkey,false);EventHandler.addEvent(winDocum,"keypress",actb_keypress,false);},false);EventHandler.addEvent(actb_curr,"blur",function(){removeWinEvents();actb_removedisp();},false);function removeWinEvents(){EventHandler.removeEvent(winDocum,"keydown",actb_checkkey,false);EventHandler.removeEvent(winDocum,"keypress",actb_keypress,false);}
function actb_clear(evt){if(!evt)evt=event;removeWinEvents();actb_removedisp();}
function actb_parse(n){if(actb_self.actb_delimiter.length>0){var t=actb_delimwords[actb_cdelimword].trim().addslashes();var plen=actb_delimwords[actb_cdelimword].trim().length;}else{var t=actb_curr.value.addslashes();var plen=actb_curr.value.length;}
var tobuild='';var i;if(actb_self.actb_firstText){var re=new RegExp("^"+t,"i");}else{var re=new RegExp(t,"i");}
var p=n.search(re);for(i=0;i<p;i++){tobuild+=n.substr(i,1);}
tobuild+="<font style='"+(actb_self.actb_hStyle)+"'>"
for(i=p;i<plen+p;i++){tobuild+=n.substr(i,1);}
tobuild+="</font>";for(i=plen+p;i<n.length;i++){tobuild+=n.substr(i,1);}
return tobuild;}
function unfocus_cur_table(){var tables=winDocum.getElementsByTagName("table");if(tables&&tables.length){for(var i=0;i<tables.length;i++){if(DOMHandler.hasClass(tables[i],"focused")){DOMHandler.removeClass(tables[i],"focused");break;}}}}
function actb_generate(){var node=nd('tat_table',winDocum);if(node){actb_display=false;node.parentNode.removeChild(node);}
if(actb_kwcount==0){actb_display=false;return;}
unfocus_cur_table();var a_cont=winDocum.createElement("div");a_cont.id='tat_table';a_cont.className="popover";a_cont.setAttribute("role","tooltip");a_cont.style.position="absolute";a_cont.style.top=eval(curTop(actb_curr)+actb_curr.offsetHeight)+"px";a_cont.style.left=curLeft(actb_curr)+"px";a_cont.style.display="block";a_cont_t=document.createElement("div");a_cont_t.className="tooltip-arrow";a_cont_c=document.createElement('div');a_cont_c.className="popover-content";a=winDocum.createElement("table");a.className="table table-hover act";a_cont_c.appendChild(a);a_cont.appendChild(a_cont_t);a_cont.appendChild(a_cont_c);winDocum.body.appendChild(a_cont);var i;var first=true;var j=1;if(actb_self.actb_mouse){a.onmouseout=actb_table_unfocus;a.onmouseover=actb_table_focus;}
var counter=0;for(i=0;i<actb_self.actb_keywords.length;i++){if(actb_bool[i]){counter++;r=a.insertRow(-1);if(ajxCon&&ajxCon.m_resultFieldsToAttr){r.setAttribute(ajxCon.m_resultFieldsToAttr[i].attr,ajxCon.m_resultFieldsToAttr[i].val);}
var ref_cl=null;if(first&&!actb_tomake){first=false;actb_pos=counter;ref_cl="acCurrent";}else if(actb_pre==i){first=false;actb_pos=counter;}else{}
r.id='tat_tr'+(j);c=r.insertCell(-1);if(ref_cl){c.setAttribute("class",ref_cl);}
if(ajxCon&&ajxCon.m_fullTextSearch){c.innerHTML=actb_self.actb_keywords[i];}
else{c.innerHTML=actb_parse(actb_self.actb_keywords[i]);}
c.id='tat_td'+(j);c.setAttribute('pos',j);if(actb_self.actb_mouse){c.style.cursor='pointer';c.onclick=actb_mouseclick;c.onmouseover=actb_table_highlight;}
j++;}
if(j-1==actb_self.actb_lim&&j<actb_total){r=a.insertRow(-1);c=r.insertCell(-1);c.align='center';replaceHTML(c,'\\/',winDocum);if(actb_self.actb_mouse){c.style.cursor='pointer';c.onclick=actb_mouse_down;}
break;}}
actb_rangeu=1;actb_ranged=j-1;actb_display=true;if(actb_pos<=0)actb_pos=1;}
function actb_remake(){actb_generate();return;}
function actb_goup(){if(!actb_display)return;if(actb_pos==1)return;DOMHandler.removeClass(winDocum.getElementById("tat_td"+actb_pos),"acCurrent");actb_pos--;if(actb_pos<actb_rangeu)actb_moveup();DOMHandler.addClass(winDocum.getElementById("tat_td"+actb_pos),"acCurrent");if(actb_toid)clearTimeout(actb_toid);if(actb_self.actb_timeOut>0)actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp();},actb_self.actb_timeOut);if(ajxCon&&ajxCon.m_updateInputOnCursor){actb_caretmove=1;actb_penter(null,false);}}
function actb_godown(){if(!actb_display)return;if(actb_pos==actb_total)return;var nd=winDocum.getElementById("tat_td"+actb_pos);DOMHandler.removeClass(nd,"acCurrent");actb_pos++;if(actb_pos>actb_ranged)actb_movedown();DOMHandler.addClass(winDocum.getElementById("tat_td"+actb_pos),"acCurrent");if(actb_toid)clearTimeout(actb_toid);if(actb_self.actb_timeOut>0)actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp();},actb_self.actb_timeOut);if(ajxCon&&ajxCon.m_updateInputOnCursor){actb_caretmove=1;actb_penter(null,false);}}
function actb_movedown(){actb_rangeu++;actb_ranged++;actb_remake();}
function actb_moveup(){actb_rangeu--;actb_ranged--;actb_remake();}
function actb_mouse_down(){actb_pos++;actb_movedown();actb_curr.focus();actb_mouse_on_list=0;if(actb_toid)clearTimeout(actb_toid);if(actb_self.actb_timeOut>0)actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp();},actb_self.actb_timeOut);}
function actb_mouse_up(evt){if(!evt)evt=event;if(evt.stopPropagation){evt.stopPropagation();}else{evt.cancelBubble=true;}
actb_pos--;actb_moveup();actb_curr.focus();actb_mouse_on_list=0;if(actb_toid)clearTimeout(actb_toid);if(actb_self.actb_timeOut>0)actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp();},actb_self.actb_timeOut);}
function actb_mouseclick(evt){if(!evt)evt=event;if(!actb_display)return;actb_mouse_on_list=0;actb_pos=this.getAttribute('pos');actb_penter(null,true);}
function actb_table_focus(){actb_mouse_on_list=1;if(ajxCon&&ajxCon.m_updateInputOnCursor){actb_penter(null,false);}}
function actb_table_unfocus(){actb_mouse_on_list=0;if(actb_toid)clearTimeout(actb_toid);if(actb_self.actb_timeOut>0)actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp();},actb_self.actb_timeOut);}
function actb_table_highlight(){actb_mouse_on_list=1;actb_pos=this.getAttribute('pos');while(actb_pos<actb_rangeu)actb_moveup();while(actb_pos>actb_ranged)actb_movedown();if(actb_toid)clearTimeout(actb_toid);if(actb_self.actb_timeOut>0)actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp();},actb_self.actb_timeOut);}
function actb_insertword(a,closeDisp){if(ajxCon){actb_curr.value=a;actb_curr.focus();}
else{if(actb_self.actb_delimiter.length>0){str='';l=0;for(i=0;i<actb_delimwords.length;i++){if(actb_cdelimword==i){prespace=postspace='';gotbreak=false;for(j=0;j<actb_delimwords[i].length;++j){if(actb_delimwords[i].charAt(j)!=' '){gotbreak=true;break;}
prespace+=' ';}
for(j=actb_delimwords[i].length-1;j>=0;--j){if(actb_delimwords[i].charAt(j)!=' ')break;postspace+=' ';}
str+=prespace;str+=a;l=str.length;if(gotbreak)str+=postspace;}else{str+=actb_delimwords[i];}
if(i!=actb_delimwords.length-1){str+=actb_delimchar[i];}}
actb_curr.value=str;setCaret(actb_curr,l);}else{actb_curr.value=a;}}
if(ajxCon!=undefined&&ajxCon.getIsObject()){ajxCon.setObjectId(actb_curr,closeDisp);removeWinEvents();}
else{DOMHandler.removeClass(actb_curr,"error");}
if(closeDisp){actb_mouse_on_list=0;actb_removedisp();}}
function actb_penter(evt,closeDisp){if(!actb_display)return;if(closeDisp)
actb_display=false;var word='';var c=0;for(var i=0;i<=actb_self.actb_keywords.length;i++){if(actb_bool[i])c++;if(c==actb_pos){if(ajxCon&&ajxCon.m_resArray&&ajxCon.m_resArray.length){word=ajxCon.m_resArray[i];}
else{word=actb_self.actb_keywords[i];}
break;}}
actb_insertword(word,closeDisp);l=getCaretStart(actb_curr,winDocum);}
function actb_removedisp(){if(actb_mouse_on_list==0){actb_display=0;if(winDocum.getElementById('tat_table')){winDocum.body.removeChild(winDocum.getElementById('tat_table'));}
if(actb_toid)clearTimeout(actb_toid);}}
function actb_keypress(e){if(actb_caretmove)stopEvent(e);if(timeoutId){window.clearTimeout(timeoutId);}
return!actb_caretmove;}
function actb_checkkey(evt){if(!evt)evt=event;a=evt.keyCode;caret_pos_start=getCaretStart(actb_curr,winDocum);actb_caretmove=0;switch(a){case 38:actb_goup();actb_caretmove=1;return false;break;case 40:actb_godown();actb_caretmove=1;return false;break;case 13:case 9:if(actb_display){actb_caretmove=1;actb_penter(evt,true);return false;}else{return true;}
break;case 8:case 46:if(ajxCon!=undefined&&actb_curr.value!=""){ajxCon.fillArrayOnPattern(actb_curr);}
return true;case 27:return false;default:setTimeout(function(){actb_tocomplete(a)},50);break;}}
function actb_tocomplete(kc){if(ajxCon!=undefined&&actb_curr.value!=""){ajxCon.unsetObjectId(actb_curr);ajxCon.fillArrayOnPattern(actb_curr);}
_actb_tocomplete();}
function _actb_tocomplete(){if(ajxCon!=undefined&&actb_curr.value!=""){actb_keywords=ajxCon.m_array;}
var i;if(actb_display){var word=0;var c=0;for(var i=0;i<=actb_self.actb_keywords.length;i++){if(actb_bool[i])c++;if(c==actb_pos){word=i;break;}}
actb_pre=word;}else{actb_pre=-1};if(actb_curr.value==''){actb_mouse_on_list=0;actb_removedisp();return;}
if(actb_self.actb_delimiter.length>0){caret_pos_start=getCaretStart(actb_curr,winDocum);caret_pos_end=getCaretEnd(actb_curr,winDocum);delim_split='';for(i=0;i<actb_self.actb_delimiter.length;i++){delim_split+=actb_self.actb_delimiter[i];}
delim_split=delim_split.addslashes();delim_split_rx=new RegExp("(["+delim_split+"])");c=0;actb_delimwords=new Array();actb_delimwords[0]='';for(i=0,j=actb_curr.value.length;i<actb_curr.value.length;i++,j--){if(actb_curr.value.substr(i,j).search(delim_split_rx)==0){ma=actb_curr.value.substr(i,j).match(delim_split_rx);actb_delimchar[c]=ma[1];c++;actb_delimwords[c]='';}else{actb_delimwords[c]+=actb_curr.value.charAt(i);}}
var l=0;actb_cdelimword=-1;for(i=0;i<actb_delimwords.length;i++){if(caret_pos_end>=l&&caret_pos_end<=l+actb_delimwords[i].length){actb_cdelimword=i;}
l+=actb_delimwords[i].length+1;}
var ot=actb_delimwords[actb_cdelimword].trim();var t=actb_delimwords[actb_cdelimword].addslashes().trim();}else{var ot=actb_curr.value;var t=actb_curr.value.addslashes();}
if(ot.length==0){actb_mouse_on_list=0;actb_removedisp();}
if(ot.length<actb_self.actb_startcheck)return this;if(actb_self.actb_firstText){var re=new RegExp("^"+t,"i");}else{var re=new RegExp(t,"i");}
actb_total=0;actb_tomake=false;actb_kwcount=0;for(i=0;i<actb_self.actb_keywords.length;i++){actb_bool[i]=false;actb_total++;actb_bool[i]=true;actb_kwcount++;if(actb_pre==i)actb_tomake=true;}
if(actb_toid)clearTimeout(actb_toid);if(actb_self.actb_timeOut>0)actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp();},actb_self.actb_timeOut);actb_generate();}
return this;} 
function EditObject(id,options){options=options||{};var self=this;options.noInsert=(options.noInsert==undefined)?true:options.noInsert;options.noUpdate=(options.noUpdate==undefined)?true:options.noUpdate;if(options.buttonSelect==undefined&&(options.noSelect==undefined||options.noSelect===false)){options.buttonSelect=new ButtonSelectObject(id+'_btn_select',{"controller":options.controller,"modelId":options.modelId,"listView":options.listView,"keyFieldIds":options.keyFieldIds,"lookupKeyFieldIds":options.lookupKeyFieldIds,"onSelected":options.onSelected,"multySelect":options.multySelect,"extraFields":options.extraFields,"controlId":id});}
if(options.buttonOpen==undefined&&(options.noOpen==undefined||options.noOpen===false)&&options.objectView){options.buttonOpen=new ButtonOpenObject(id+'_btn_open',{"controller":options.controller,"modelId":options.modelId,"connect":options.connect,"objectView":options.objectView,"keyFieldIds":options.keyFieldIds,"lookupKeyFieldIds":options.lookupKeyFieldIds});}
if(options.buttonClear==undefined&&(options.noClear==undefined||options.noClear===false)){options.buttonClear=new ButtonClearObject(id+'_btn_clear',{"keyFieldIds":options.keyFieldIds,"controlId":id});}
if(options.buttonInsert==undefined&&!options.noInsert){options.buttonInsert=new ButtonInsertObject(id+'_btn_insert',{"controller":options.controller,"binds":options.insertBinds,"afterInsert":options.afterInsert});}
if(options.buttonUpdate==undefined&&!options.noUpdate){options.buttonUpdate=new ButtonUpdateObject(id+'_btn_update',{"controller":options.controller,"binds":options.updateBinds});}
EditObject.superclass.constructor.call(this,id,options);if(options.buttonInsert){this.setButtonInsert(options.buttonInsert);this.m_buttons.addElement(options.buttonInsert);}
if(options.buttonUpdate){this.setButtonUpdate(options.buttonUpdate);this.m_buttons.addElement(options.buttonUpdate);}
if(options.controller){this.setController(options.controller);}
if(options.methodId){this.setMethodId(options.methodId);}
if(options.modelId){this.setModelId(options.modelId);}
if(options.valueFieldId){this.setValueFieldId(options.valueFieldId);}
if(options.keyFieldIds){this.setKeyFieldIds(options.keyFieldIds);}
if(options.noAutoComplete==undefined||options.noAutoComplete!==false&&options.keyFieldIds){this.m_autoComplete=new actbAJX({"controller":options.lookupController||options.controller,"modelId":options.lookupModelId||options.modelId,"lookupValueFieldId":options.lookupValueFieldId,"methodId":options.lookupMethodId||options.methodId,"lookupKeyFieldIds":options.lookupKeyFieldIds,"keyFieldIds":options.keyFieldIds,"minLengthForQuery":options.minLengthForQuery,"patternParamId":options.patternParamId||options.lookupValueFieldId,"ic":options.ic,"mid":options.mid,"onSelected":options.onSelected,"extraFields":options.extraFields,"resultFieldId":options.resultFieldId,"fullTextSearch":options.fullTextSearch,"resultFieldIdsToAttr":options.resultFieldIdsToAttr,"queryDelay":options.queryDelay,"updateInputOnCursor":options.acUpdateInputOnCursor});actb(this.m_node,this.m_winObj,this.m_autoComplete);}}
extend(EditObject,Edit);EditObject.prototype.NOT_SELECTED_DESCR="";EditObject.prototype.m_autoComplete;EditObject.prototype.m_keyFieldIds;EditObject.prototype.m_valueFieldId;EditObject.prototype.m_modelId;EditObject.prototype.m_controller;EditObject.prototype.setValueFieldId=function(valueFieldId){this.m_valueFieldId=valueFieldId;}
EditObject.prototype.getValueFieldId=function(){return this.m_valueFieldId;}
EditObject.prototype.setKeyFieldIds=function(keyFieldIds){this.m_keyFieldIds=keyFieldIds;}
EditObject.prototype.getKeyFieldIds=function(){return this.m_keyFieldIds;}
EditObject.prototype.setModelId=function(modelId){this.m_modelId=modelId;}
EditObject.prototype.getModelId=function(){return this.m_modelId;}
EditObject.prototype.setMethodId=function(methodId){this.m_methodId=methodId;}
EditObject.prototype.getMethodId=function(){return this.m_methodId;}
EditObject.prototype.setController=function(controller){this.m_controller=controller;}
EditObject.prototype.getFieldId=function(){if(!this.m_keyFieldIds||this.m_keyFieldIds.length==0){throw new Error("Ключевые поля не определены!");}
else if(this.m_keyFieldIds.length==1){for(var id in this.m_keyFieldIds){return this.m_keyFieldIds[id];break;}}
else{throw new Error("Объект имеет несколько ключевых полей!");}}
EditObject.prototype.setFieldValue=function(id,value){if(id==undefined){id=this.getFieldId();}
DOMHandler.setAttr(this.m_node,"fkey_"+id,value);DOMHandler.setAttr(this.m_node,"last_fkey_"+id,value);if(value){DOMHandler.removeAttr(this.m_node,"incorrect_obj");}}
EditObject.prototype.setFormerFieldValue=function(id,value){if(id==undefined){id=this.getFieldId();}
DOMHandler.setAttr(this.m_node,"old_"+id,value);}
EditObject.prototype.getFieldValue=function(id){if(id==undefined){id=this.getFieldId();}
return DOMHandler.getAttr(this.m_node,"fkey_"+id);}
EditObject.prototype.getFormerFieldValue=function(id){if(id==undefined){id=this.getFieldId();}
return DOMHandler.getAttr(this.m_node,"old_"+id);}
EditObject.prototype.getValueAsObj=function(){var data=EditObject.superclass.getValueAsObj.call(this);var k_vals={};for(var id in this.m_keyFieldIds){k_vals[this.m_keyFieldIds[id]]=this.getFieldValue(this.m_keyFieldIds[id]);}
data["keys"]=k_vals;return data;}
EditObject.prototype.setValueFromObj=function(obj){EditObject.superclass.setValueFromObj.call(this,obj);if(obj["keys"]){for(var id in this.m_keyFieldIds){if(obj["keys"][this.m_keyFieldIds[id]]){this.setFieldValue(this.m_keyFieldIds[id],obj["keys"][this.m_keyFieldIds[id]]);this.setFormerFieldValue(this.m_keyFieldIds[id],obj["keys"][this.m_keyFieldIds[id]]);}}}}
EditObject.prototype.resetValue=function(){EditObject.superclass.resetValue.call(this);this.setFieldValue(null,"");}
EditObject.prototype.setOnSelected=function(onSelected){if(this.m_autoComplete){this.m_autoComplete.setOnSelected(onSelected);}}
EditObject.prototype.setButtonUpdate=function(btn){this.m_buttonUpdate=btn;}
EditObject.prototype.getButtonUpdate=function(){return this.m_buttonUpdate;}
EditObject.prototype.setButtonInsert=function(btn){this.m_buttonInsert=btn;}
EditObject.prototype.getButtonInsert=function(){return this.m_buttonInsert;} 
function EditDate(id,options){options=options||{};options.validator=options.validator||new ValidatorDate();options.editMask=options.editMask||this.DEF_EDIT_MASK;options.editKalendarMask=options.editKalendarMask||this.DEF_KALEND_MASK;options.attrs=options.attrs||{};options.attrs.maxlength=options.attrs.maxlength||this.DEF_MAX_LENGTH;options.editContClassName=options.editContClassName||"input-group "+get_bs_col()+"2";if(options.noSelect==undefined||(options.noSelect!=undefined&&options.noSelect==false)){options.buttonSelect=options.buttonSelect||new ButtonKalendar(id+'_btn_kal',{"datePattern":options.editKalendarMask,"inputId":id,"onSelected":options.onSelected});}
EditDate.superclass.constructor.call(this,id,options);}
extend(EditDate,EditString);EditDate.prototype.DEF_EDIT_MASK='$d$d/$d$d/$d$d';EditDate.prototype.DEF_KALEND_MASK="dd/mm/yy";EditDate.prototype.DEF_MAX_LENGTH=8; 
function EditCellPhone(id,options){options=options||{};options.validator=options.validator||new ValidatorCellPhone();options.editMask=options.editMask||this.DEF_EDIT_MASK;options.attrs=options.attrs||{};options.attrs.maxlength=options.attrs.maxlength||this.DEF_MAX_LEN;options.attrs.size=options.attrs.size||this.DEF_SIZE;options.events={"paste":function(e){e.stopPropagation();e.preventDefault();var clipboard_data=e.clipboardData||window.clipboardData;var pasted_data=clipboard_data.getData("Text").match(/\d+/g).map(Number).join("");if(pasted_data.length>10&&(pasted_data[0]=="8"||pasted_data[0]=="7")){pasted_data=pasted_data.substring(1);}
if(pasted_data.length>10){pasted_data=pasted_data.substring(0,10);}
if(pasted_data.length==10){this.m_node.value="8-"+pasted_data.substring(0,3)+"-"+pasted_data.substring(3,6)+"-"+pasted_data.substring(6,8)+"-"+pasted_data.substring(8);}
else if(pasted_data.length==6){this.m_node.value="8-345-2"+pasted_data.substring(0,2)+"-"+pasted_data.substring(2,4)+"-"+pasted_data.substring(4);}
else{}}}
EditCellPhone.superclass.constructor.call(this,id,options);}
extend(EditCellPhone,EditString);EditCellPhone.prototype.DEF_EDIT_MASK="8-9$d$d-$d$d$d-$d$d-$d$d";EditCellPhone.prototype.DEF_MAX_LEN=15;EditCellPhone.prototype.DEF_SIZE=15; 
function EditDateTime(id,options){options=options||{};options.validator=options.validator||new ValidatorDateTime();options.editMask=options.editMask||this.DEF_EDIT_MASK;options.editKalendarMask=options.editKalendarMask||this.DEF_KALEND_MASK;options.editKalendarTime=options.editKalendarTime||" 00:00:00";options.editContClassName=options.editContClassName||"input-group "+get_bs_col()+"2";if(options.buttonSelect==undefined&&(options.noKalendar==undefined||options.noKalendar===false)){options.buttonSelect=new ButtonKalendar(id+'_btn_kal',{"datePattern":options.editKalendarMask,"inputId":id,"time":options.editKalendarTime});}
EditDateTime.superclass.constructor.call(this,id,options);}
extend(EditDateTime,EditDate);EditDateTime.prototype.DEF_EDIT_MASK="$d$d/$d$d/$d$d $d$d:$d$d:$d$d";EditDateTime.prototype.DEF_MAX_LENGTH=17; 
function EditTime(id,options){options=options||{};options.validator=options.validator||new ValidatorTime();options.editMask=options.editMask||this.DEF_EDIT_MASK;options.attrs=options.attrs||{};options.attrs.size=options.attrs.size||this.DEF_SIZE;options.attrs.maxlength=options.attrs.maxlength||this.DEF_MAX_LENGTH;EditTime.superclass.constructor.call(this,id,options);}
extend(EditTime,Edit);EditTime.prototype.DEF_EDIT_MASK='$d$d:$d$d:$d$d';EditTime.prototype.DEF_SIZE=8;EditTime.prototype.DEF_MAX_LENGTH=8; 
function EditNum(id,options){options=options||{};options.validator=options.validator||new ValidatorInt();if(options.calc&&(options.noSelect==undefined||(options.noSelect!=undefined&&options.noSelect==false))){options.buttonSelect=new ButtonCalc(id+"_btn_open",{"winObj":options.winObj,"enabled":options.enabled});}
if(options.maxValue){this.setMaxValue(options.maxValue);}
if(options.minValue){this.setMinValue(options.minValue);}
if(options.notZero!=undefined){this.setNotZero(options.notZero);}
this.m_unsigned=!(options.unsigned!=undefined&&!options.unsigned);EditNum.superclass.constructor.call(this,id,options);}
extend(EditNum,Edit);EditNum.prototype.toDOM=function(parent){EditNum.superclass.toDOM.call(this,parent);var dig_type=(this.m_unsigned)?InputType.NonnegativeInteger:InputType.WholeNumber;InitializeTextbox(this.m_node,dig_type);}
EditNum.prototype.validate=function(val){var v=Number(val);if(this.m_maxValue&&v>Number(this.m_maxValue)){this.setNotValid("Значение больше максимального "+this.m_maxValue);}
if(this.m_minValue&&v<Number(this.m_minValue)){this.setNotValid("Значение меньше минимального "+this.m_minValue);}
if(this.m_notZero&&v==0){this.setNotValid("Значение равно нулю");}
return EditNum.superclass.validate.call(this,val);}
EditNum.prototype.setMinValue=function(val){this.m_minValue=val;}
EditNum.prototype.setMaxValue=function(val){this.m_maxValue=val;}
EditNum.prototype.setNotZero=function(val){this.m_notZero=val;} 
function EditFloat(id,options){options=options||{};options.validator=options.validator||new ValidatorFloat();options.editMask=options.editMask||"";this.m_precision=options.precision;EditFloat.superclass.constructor.call(this,id,options);}
extend(EditFloat,EditNum);EditFloat.prototype.DEF_PRECISION=2;EditFloat.prototype.toDOM=function(parent){EditFloat.superclass.toDOM.call(this,parent);if(this.m_precision==2&&this.m_editMask==""){InitializeTextbox(this.m_node,InputType.Currency,2,this.m_unsigned);}
else if(this.m_editMask==""){InitializeTextbox(this.m_node,InputType.FloatNumber,this.m_precision,this.m_unsigned);}} 
function EditMoney(id,options){options=options||{};options.attrs=options.attrs||{};options.attrs.size=options.attrs.size||"8";options.attrs.maxlength=options.attrs.maxlength||"15";options.attrs.precision=options.attrs.precision||"2";EditMoney.superclass.constructor.call(this,id,options);}
extend(EditMoney,EditFloat); 
function EditText(id,options){options=options||{};options.inputType=this.DEF_INPUT_TYPE;EditText.superclass.constructor.call(this,id,options);this.setRows(options.rows||this.DEF_ROWS);}
extend(EditText,Edit);EditText.prototype.DEF_TAG_NAME='textarea';EditText.prototype.DEF_ROWS="5";EditText.prototype.setRows=function(rows){DOMHandler.setAttr(this.m_node,"rows",rows);}
EditText.prototype.getRows=function(){return DOMHandler.getAttr(this.m_node,"rows");} 
function EditSelect(id,options){options=options||{};options.className=options.className||this.DEF_CLASS;EditSelect.superclass.constructor.call(this,id,this.DEF_TAG_NAME,options);if(options.label){this.setLabel(options.label);}
else if(options.labelCaption){this.setLabel(new LabelField(this.getId(),options.labelCaption,{"className":options.labelClassName,"visible":this.getVisible(),"enabled":this.getEnabled(),"readOnly":this.getVisible()}));}
this.m_buttons=new ControlContainer(this.getId()+this.BTNS_CONTAINER_ID,"div",{"className":this.BTNS_CONTAINER_CLASS,"visible":this.getVisible(),"enabled":this.getEnabled(),"readOnly":this.getVisible()});this.m_contClassName=options.contClassName||this.DEF_CONT_CLASS;this.m_editContClassName=options.editContClassName||("input-group "+get_bs_col()+"8");}
extend(EditSelect,ControlContainer);EditSelect.prototype.m_label;EditSelect.prototype.m_buttons;EditSelect.prototype.DEF_TAG_NAME="select";EditSelect.prototype.DEF_CLASS="form-control";EditSelect.prototype.DEF_CONT_CLASS="form-group";EditSelect.prototype.BTNS_CONTAINER_CLASS="input-group-btn";EditSelect.prototype.setLabel=function(label){this.m_label=label;}
EditSelect.prototype.getLabel=function(){return this.m_label;}
EditSelect.prototype.toDOM=function(parent){var edit_container_node=parent;if(this.m_label){this.m_container=new Control(null,"div",{"className":this.m_contClassName,visible:this.getVisible()});this.m_container.toDOM(parent);this.m_label.toDOM(this.m_container.m_node);this.m_edit_container=new Control(null,"div",{"className":this.m_editContClassName});this.m_edit_container.toDOM(this.m_container.m_node);edit_container_node=this.m_edit_container.m_node;}
EditSelect.superclass.toDOM.call(this,edit_container_node);if(this.m_buttons&&!this.m_buttons.isEmpty()){this.m_buttons.toDOMAfter(this.m_node);}}
EditSelect.prototype.removeDOM=function(){if(this.m_container){this.m_container.removeDOM();}
if(this.m_buttons){this.m_buttons.removeDOM();}
EditSelect.superclass.removeDOM.call(this);}
EditSelect.prototype.clear=function(){for(var elem_id in this.m_elements){DOMHandler.removeNode(this.m_elements[elem_id].m_node);}
this.m_elements={};}
EditSelect.prototype.setById=function(id){this.setByFieldId(id);}
EditSelect.prototype.setByIndex=function(ind){var i=0;for(var id in this.m_elements){if(i==ind){this.m_elements[id].m_node.selected="selected";this.m_elements[id].m_node.selectedIndex=ind;break;}
i++;}}
EditSelect.prototype.setByFieldId=function(id){this.m_node.value=id;}
EditSelect.prototype.setValue=function(value){this.setByFieldId(value);}
EditSelect.prototype.validate=function(val){return val;}
EditSelect.prototype.getValue=function(){if(this.m_node.options&&this.m_node.options.length&&this.m_node.selectedIndex>=0){return this.m_node.options[this.m_node.selectedIndex].value;}}
EditSelect.prototype.setComment=function(com){if(this.m_comment==undefined){this.m_comment=new Control(this.getId()+"_comment_","div",{visible:true,"className":"form-control-static ctrl_comment"});this.m_comment.toDOM(this.m_node.parentNode);}
this.m_comment.setValue(com);this.m_comment.setVisible(true);}
EditSelect.prototype.getValueAsObj=function(){return{"value":this.getValue()};}
EditSelect.prototype.setValueFromObj=function(obj){this.setByFieldId(obj.value);}
EditSelect.prototype.setFocus=function(){this.m_node.focus();}
EditSelect.prototype.resetValue=function(){this.setByIndex(0);}
EditSelect.prototype.setVisible=function(visible){if(this.m_label){this.m_label.setVisible(visible);if(this.m_container){this.m_container.setVisible(visible);}
if(this.m_edit_container){this.m_edit_container.setVisible(visible);}}
if(this.m_buttons){this.m_buttons.setVisible(visible);}
EditSelect.superclass.setVisible.call(this,visible);}
EditSelect.prototype.getButtons=function(){return this.m_buttons;} 
function EditSelectOption(id,options){options=options||{};if(options.optionSelected!=undefined&&options.optionSelected==true){options.attrs=options.attrs||{};options.attrs[this.SELECT_ATTR_NAME]=this.SELECT_ATTR_NAME;}
EditSelectOption.superclass.constructor.call(this,id,this.DEF_TAG_NAME,options);if(options.optionDescr){this.setOptionDescr(options.optionDescr);}
if(options.optionId){this.setOptionId(options.optionId);}}
extend(EditSelectOption,Control);EditSelectOption.prototype.DEF_TAG_NAME='option';EditSelectOption.prototype.SELECT_ATTR_NAME='selected';EditSelectOption.prototype.getOptionId=function(){return this.getAttr("value");}
EditSelectOption.prototype.setOptionId=function(id){this.setAttr("value",id);}
EditSelectOption.prototype.getOptionDescr=function(){return this.getValue();}
EditSelectOption.prototype.setOptionDescr=function(descr){this.setValue(descr);} 
function EditRadio(id,options){options=options||{};options.inputType="radio";if(options.descr){options.labelCaption=options.descr;}
EditRadio.superclass.constructor.call(this,id,options);}
extend(EditRadio,Edit);EditRadio.prototype.getDecsr=function(){return this.getValue();}
EditRadio.prototype.setDescr=function(value){if(this.m_node.childNodes&&this.m_node.childNodes.length>0){this.m_node.childNodes[0].nodeValue=value;}
else{this.m_node.appendChild(document.createTextNode(value));}}
EditRadio.prototype.resetValue=function(){this.m_node.checked=(this.getAttr("initValue")=="checked");} 
function EditRadioGroup(id,options){options=options||{};EditRadioGroup.superclass.constructor.call(this,id,options.tagName||this.DEF_TAG_NAME,options);if(options.label){this.setLabel(options.label);}
else if(options.labelCaption){var tagName=(options.tableLayout==undefined||options.tableLayout)?"td":"div";this.setLabel(new LabelField(this.getId(),options.labelCaption,{"tagName":tagName}));}}
extend(EditRadioGroup,ControlContainer);EditSelect.prototype.m_label;EditRadioGroup.prototype.DEF_TAG_NAME='div';EditRadioGroup.prototype.DEF_CLASS="ctrlEdit";EditRadioGroup.prototype.setLabel=function(label){this.m_label=label;}
EditRadioGroup.prototype.getLabel=function(){return this.m_label;}
EditRadioGroup.prototype.toDOM=function(parent){if(this.m_label){this.m_label.toDOM(parent);}
EditRadioGroup.superclass.toDOM.call(this,parent);}
EditRadioGroup.prototype.clear=function(){for(var elem_id in this.m_elements){DOMHandler.removeNode(this.m_elements[elem_id].m_node);}
this.m_elements={};}
EditRadioGroup.prototype.setValue=function(value){for(var elem_id in this.m_elements){if(this.m_elements[elem_id].m_node.nodeName.toLowerCase()=="input"&&this.m_elements[elem_id].m_node.value==value){this.m_elements[elem_id].m_node.checked=true;}}}
EditRadioGroup.prototype.getCheckedValue=function(){for(var elem_id in this.m_elements){if(this.m_elements[elem_id].m_node.nodeName.toLowerCase()=="input"&&this.m_elements[elem_id].m_node.checked){return this.m_elements[elem_id].m_node.value;}}}
EditRadioGroup.prototype.getValue=function(){return this.getCheckedValue();}
EditRadioGroup.prototype.getAttr=function(name){if(name.substr(0,5)=="fkey_"){return this.getCheckedValue();}
else{return DOMHandler.getAttr(this.m_node,name);}}
EditRadioGroup.prototype.resetValue=function(){for(var id in this.m_elements){this.m_elements[id].resetValue();}} 
function EditCheckBox(id,options){options=options||{};options.inputType="checkbox";options.labelClassName=options.labelClassName||("control-label "+(get_bs_col()+"11"));options.editContClassName="input-group "+get_bs_col()+"1";EditCheckBox.superclass.constructor.call(this,id,options);if(options.checked){this.setChecked(options.checked);}
this.m_labelAlign=options.labelAlign||"right";}
extend(EditCheckBox,Edit);EditCheckBox.prototype.setChecked=function(checked){this.m_node.checked=checked;}
EditCheckBox.prototype.getChecked=function(){return this.m_node.checked;}
EditCheckBox.prototype.getValue=function(){return(this.m_node.checked)?"true":"false";}
EditCheckBox.prototype.setValue=function(val){this.setChecked((val=="true"));}
EditCheckBox.prototype.DEF_CLASS="checkbox"; 
function EditHTML(id,options){EditHTML.superclass.constructor.call(this,id,this.TAG_NAME);}
extend(EditHTML,Control);EditHTML.prototype.TAG_NAME='div';EditHTML.prototype.toDOM=function(parent){EditHTML.superclass.toDOM.call(this,parent);CKEDITOR.replace(this.getId(),{});} 
function EditPassword(id,options){options=options||{};options.inputType=this.DEF_INPUT_TYPE;EditPassword.superclass.constructor.call(this,id,options);}
extend(EditPassword,Edit);EditPassword.prototype.DEF_INPUT_TYPE='password'; 
function EditSelectObject(id,options){options=options||{};options.noAutoRefresh=options.noAutoRefresh||false;EditSelectObject.superclass.constructor.call(this,id,options);if(options.controller){this.setController(options.controller);}
this.m_keyFieldIds=options.keyFieldIds;if(options.methodId){this.setMethodId(options.methodId);}
if(options.modelId){this.setModelId(options.modelId);}
if(options.lookupValueFieldId){this.m_lookupValueFieldId=options.lookupValueFieldId;}
if(options.lookupKeyFieldIds){this.m_lookupKeyFieldIds=options.lookupKeyFieldIds;}
if(options.errorControl){this.m_errorControl=options.m_errorControl;}
if(options.refreshInterval){this.setRefreshInterval(options.refreshInterval);}
if(options.methParams){this.m_methParams=options.methParams;}
if(options.defaultId){this.m_defaultId=options.defaultId;}
if(options.noAutoRefresh==undefined||(options.noAutoRefresh!=undefined&&options.noAutoRefresh==false)){this.onRefresh();}
else{this.addElement(new EditSelectOption(this.getId()+"_enum_val_not_selected",{"optionId":"","optionDescr":this.NOT_SELECTED_DESCR,"optionSelected":true,"attrs":{"value":"undefined"}}));}}
extend(EditSelectObject,EditSelect);EditSelectObject.prototype.NOT_SELECTED_DESCR="<не выбран>";EditSelectObject.prototype.INCORRECT_VAL_CLASS="incorrect_val";EditSelectObject.prototype.m_modelId;EditSelectObject.prototype.m_controller;EditSelectObject.prototype.m_errorControl;EditSelectObject.prototype.setModelId=function(modelId){this.m_modelId=modelId;}
EditSelectObject.prototype.getModelId=function(){return this.m_modelId;}
EditSelectObject.prototype.setMethodId=function(methodId){this.m_methodId=methodId;}
EditSelectObject.prototype.getMethodId=function(){return this.m_methodId;}
EditSelectObject.prototype.setController=function(controller){this.m_controller=controller;}
EditSelectObject.prototype.toDOM=function(parent){EditSelectObject.superclass.toDOM.call(this,parent);if(!this.m_oldSelectedValue&&this.m_defaultId){this.setByFieldId(this.m_defaultId);}
else if(this.m_oldSelectedValue){this.setByFieldId(this.m_oldSelectedValue);}}
EditSelectObject.prototype.onRefresh=function(){var self=this;this.m_wasEnabled=this.getEnabled();this.setEnabled(false);this.m_controller.run(this.getMethodId(),{func:function(resp){self.onGetData(resp);},async:false,params:this.m_methParams,errControl:this.m_errorControl});}
EditSelectObject.prototype.onGetData=function(resp){if(this.m_wasEnabled){this.setEnabled(true);}
this.m_oldSelectedValue=this.getValue();var cur_val=this.getAttr("fkey_"+this.getFieldId());this.clear();this.addElement(new EditSelectOption(this.getId()+"_enum_val_not_selected",{"optionId":"","optionDescr":this.NOT_SELECTED_DESCR,"attrs":{"value":"undefined"}}));var listModel=resp.getModelById(this.getModelId());listModel.setActive(true);var key_field_val,descr_field_val;var ind=0;var other_fields={};while(listModel.getNextRow()){key_field_val=listModel.getFieldById(this.m_lookupKeyFieldIds[0]).getValue();descr_field_val=listModel.getFieldById(this.m_lookupValueFieldId).getValue();for(var field_id in listModel.m_fields){if(field_id!=this.m_lookupKeyFieldIds[0]&&field_id!=this.m_lookupValueFieldId){other_fields[field_id]=listModel.getFieldValue(field_id);}}
delete other_fields.selected;this.addElement(new EditSelectOption(this.getId()+"_"+key_field_val,{"optionId":key_field_val,"optionDescr":descr_field_val,"attrs":other_fields,"optionSelected":((this.m_oldSelectedValue&&this.m_oldSelectedValue==key_field_val)||(!this.m_oldSelectedValue&&cur_val==key_field_val))}));ind++;}
for(var elem_id in this.m_elements){this.m_elements[elem_id].toDOM(this.m_node);}}
EditSelectObject.prototype.setValue=function(value){}
EditSelectObject.prototype.setRefreshInterval=function(refreshInterval){this.m_interval=refreshInterval;if(refreshInterval==0&&this.m_intervalObj!=undefined){window.clearInterval(this.m_intervalObj);}
else if(refreshInterval>0){var self=this;this.m_intervalObj=setInterval(function(){self.onRefresh();},refreshInterval);}}
EditSelectObject.prototype.getRefreshInterval=function(){return this.m_interval;}
EditSelectObject.prototype.removeDOM=function(){this.setRefreshInterval(0);EditSelectObject.superclass.removeDOM.call(this);}
EditSelectObject.prototype.setDefaultId=function(){this.m_oldSelectedValue=undefined;this.setByFieldId(this.m_defaultId);}
EditSelectObject.prototype.getFieldId=function(){if(this.m_node.selectedIndex>0){return this.m_node.options[this.m_node.selectedIndex].value;}}
EditSelectObject.prototype.setFieldId=function(id,value){this.m_oldSelectedValue=value;this.m_node.setAttribute("fkey_"+id,value);this.setByFieldId(value);}
EditSelectObject.prototype.setFormerFieldId=function(id,value){DOMHandler.setAttr(this.m_node,"old_"+id,value);}
EditSelectObject.prototype.getFieldId=function(){if(!this.m_keyFieldIds||this.m_keyFieldIds.length==0){throw new Error("Ключевые поля не определены!");}
else if(this.m_keyFieldIds.length==1){for(var id in this.m_keyFieldIds){return this.m_keyFieldIds[id];break;}}
else{throw new Error("Объект имеет несколько ключевых полей!");}}
EditSelectObject.prototype.setFieldValue=function(id,value){if(id==undefined){id=this.getFieldId();}
this.setFieldId(id,value);}
EditSelectObject.prototype.setFormerFieldValue=function(id,value){if(id==undefined){id=this.getFieldId();}
DOMHandler.setAttr(this.m_node,"old_"+id,value);}
EditSelectObject.prototype.getFieldValue=function(id){if(this.m_node.selectedIndex>=1){return this.m_node.options[this.m_node.selectedIndex].value;}}
EditSelectObject.prototype.getFieldAttr=function(attr){if(this.m_node.selectedIndex>=1){return this.m_node.options[this.m_node.selectedIndex].getAttribute(attr);}}
EditSelectObject.prototype.getFormerFieldValue=function(id){if(id==undefined){id=this.getFieldId();}
return DOMHandler.getAttr(this.m_node,"old_"+id);}
EditSelectObject.prototype.isEmpty=function(val){return(this.m_node.options[this.m_node.selectedIndex].id==this.getId()+"_enum_val_not_selected");}
EditSelectObject.prototype.setNotValid=function(erStr){DOMHandler.addClass(this.m_node,this.INCORRECT_VAL_CLASS);throw new Error(erStr);}
EditSelectObject.prototype.setValid=function(){DOMHandler.removeClass(this.m_node,this.INCORRECT_VAL_CLASS);}
EditSelectObject.prototype.validate=function(val){this.setValid();if(this.m_node.getAttribute("required")=="required"&&this.isEmpty(val)){this.setNotValid("Не выбрано значение");}
return val;}
EditSelectObject.prototype.resetValue=function(){this.setDefaultId();}
EditSelectObject.prototype.setByIndex=function(ind){EditSelectObject.superclass.setByIndex.call(this,ind);} 
function EditPeriod(id,options){options=options||{};var tagName=options.tagName||this.DEF_TAG_NAME;EditPeriod.superclass.constructor.call(this,id,tagName,options);this.setControlFrom(options.controlFrom);this.setControlTo(options.controlTo);}
extend(EditPeriod,ControlContainer);EditPeriod.prototype.DEF_TAG_NAME="div";EditPeriod.prototype.LABEL_FROM="Период с:";EditPeriod.prototype.LABEL_TO="по:";EditPeriod.prototype.m_controlFrom;EditPeriod.prototype.m_controlTo;EditPeriod.prototype.setControlFrom=function(ctrl){this.m_controlFrom=ctrl;}
EditPeriod.prototype.getControlFrom=function(){return this.m_controlFrom;}
EditPeriod.prototype.setControlTo=function(ctrl){this.m_controlTo=ctrl;}
EditPeriod.prototype.getControlTo=function(){return this.m_controlTo;} 
function EditPeriodDate(id,options){options=options||{};var date_mask=options.editMask||"dd/mm/y";var d_opts={};var dt=DateHandler.getStartOfDate(options.date||new Date());d_opts.value=options.valueFrom||DateHandler.dateToStr(dt,date_mask);d_opts.labelCaption=options.labelCaptionFrom||this.LABEL_FROM;d_opts.attrs=options.attrs||{};d_opts.attrs.required=d_opts.attrs.required||"required";d_opts.contClassName="form-group";if((options.enabled!=undefined&&!options.enabled)||d_opts.attrs.disabled=="disabled"){d_opts.attrs.disabled="disabled";}
options.controlFrom=new EditDate(id+"_from",d_opts);var d_opts={};var dt=DateHandler.getEndOfDate(options.date||new Date());d_opts.value=options.valueTo||DateHandler.dateToStr(dt,date_mask);d_opts.labelCaption=options.labelCaptionTo||this.LABEL_TO;d_opts.attrs=options.attrs||{};d_opts.attrs.required=d_opts.attrs.required||"required";d_opts.contClassName="form-group";if((options.enabled!=undefined&&!options.enabled)||d_opts.attrs.disabled=="disabled"){d_opts.attrs.disabled="disabled";}
options.controlTo=new EditDate(id+"_to",d_opts);EditPeriodDate.superclass.constructor.call(this,id,options);}
extend(EditPeriodDate,EditPeriod); 
function EditPeriodMonth(id,options){options=options||{};var date_mask=options.editMask||"dd/mm/y";var d=options.date||new Date();var dy=d.getFullYear();var dm=d.getMonth();var d_opts={};var dt=DateHandler.getStartOfDate(DateHandler.getFirstDateOfMonth(dy,dm));d_opts.value=DateHandler.dateToStr(dt,date_mask);d_opts.labelCaption=options.labelCaptionFrom||this.LABEL_FROM;d_opts.attrs=options.attrs||{};d_opts.attrs.required=d_opts.attrs.required||"required";if((options.enabled!=undefined&&!options.enabled)||d_opts.attrs.disabled=="disabled"){d_opts.attrs.disabled="disabled";}
options.controlFrom=new EditDate(id+"_from",d_opts);var d_opts={};var dt=DateHandler.getEndOfDate(DateHandler.getLastDateOfMonth(dy,dm));d_opts.value=DateHandler.dateToStr(dt,date_mask);d_opts.labelCaption=options.labelCaptionTo||this.LABEL_TO;d_opts.attrs=options.attrs||{};d_opts.attrs.required=d_opts.attrs.required||"required";if((options.enabled!=undefined&&!options.enabled)||d_opts.attrs.disabled=="disabled"){d_opts.attrs.disabled="disabled";}
options.controlTo=new EditDate(id+"_to",d_opts);EditPeriodMonth.superclass.constructor.call(this,id,options);}
extend(EditPeriodMonth,EditPeriod); 
function EditPeriodQuater(id,options){options=options||{};var date_mask=options.editMask||"dd/mm/y";var d=options.date||new Date();var dy=d.getFullYear();var dm=d.getMonth();var d_opts={};var dt=DateHandler.getStartOfDate(DateHandler.getFirstDateOfQuater(dy,dm));d_opts.value=DateHandler.dateToStr(dt,date_mask);d_opts.labelCaption=options.labelCaptionFrom||this.LABEL_FROM;d_opts.attrs=options.attrs||{};d_opts.attrs.required=d_opts.attrs.required||"required";if((options.enabled!=undefined&&!options.enabled)||d_opts.attrs.disabled=="disabled"){d_opts.attrs.disabled="disabled";}
options.controlFrom=new EditDate(id+"_from",d_opts);var d_opts={};var dt=DateHandler.getEndOfDate(DateHandler.getLastDateOfQuater(dy,dm));d_opts.value=DateHandler.dateToStr(dt,date_mask);d_opts.labelCaption=options.labelCaptionTo||this.LABEL_TO;d_opts.attrs=options.attrs||{};d_opts.attrs.required=d_opts.attrs.required||"required";if((options.enabled!=undefined&&!options.enabled)||d_opts.attrs.disabled=="disabled"){d_opts.attrs.disabled="disabled";}
options.controlTo=new EditDate(id+"_to",d_opts);EditPeriodQuater.superclass.constructor.call(this,id,options);}
extend(EditPeriodQuater,EditPeriod); 
function EditReportVariant(id,options){options=options||{};options.enabled=false;options.labelCaption="Вариант отчета:";options.noOpen=true;options.noClear=true;var contr=new ReportVariant_Controller(new ServConnector(HOST_NAME));var pm=contr.getPublicMethodById("get_list");pm.setParamValue("report_type",options.report_type);this.m_reportType=options.report_type;options.buttonSelect=new ButtonSelectObject(id+'_btn_select',{"attrs":{"title":"выбрать настройку отчета"},"controller":contr,"controlId":id,"methParams":{"insert":{"report_type":options.report_type}},"modelId":"ReportVariantList_Model","listView":ReportVariantList_View,"keyFieldIds":["variant_id"],"lookupKeyFieldIds":["id"],"onSelected":function(keys,descr){options.onRestoreVariant(keys,descr);}});options.keyFieldIds=["variant_id"];EditReportVariant.superclass.constructor.call(this,id,options);var self=this;this.getButtons().addElement(new Button(id+'_btn_store',{"glyph":"glyphicon-save","attrs":{"title":"сохранить настройку отчета"},"onClick":function(){var id=self.getFieldValue();if(id){options.onStoreVariant(id);}}}));}
extend(EditReportVariant,EditObject); 
function EditDow(id,options){options=options||{};options.className=options.className||"btn-group";options.attrs=options.attrs||{};var disabled=(options.attrs.disabled);EditDow.superclass.constructor.call(this,id,"div",options);var name=options.name;if(name==undefined&&options.attrs&&options.attrs.name){name=options.attrs.name;}
this.setAttr("name",name||id);var self=this;this.m_onClick=function(e){e=EventHandler.fixMouseEvent(e);self.selectDow(e.target.id);}
this.m_days=options.days;for(var i=0;i<this.m_days.length;i++){this.m_days[i].control=new Control(id+"_dow_"+i,"div",{"attrs":{"val":this.m_days[i].value},"value":this.m_days[i].descr,"className":"btn btn-default dow_day"});}}
extend(EditDow,Control);EditDow.prototype.CLASS_SELECTED="btn-success";EditDow.prototype.CLASS_NOT_SELECTED="btn-default";EditDow.prototype.toDOM=function(parent){EditDow.superclass.toDOM.call(this,parent);this.setEnabled(this.getEnabled());}
EditDow.prototype.removeDOM=function(){for(var i=0;i<this.m_days.length;i++){EventHandler.removeEvent(this.m_node,"click",this.m_onClick);this.m_days[i].control.removeDOM();}
EditDow.superclass.removeDOM.call(this);}
EditDow.prototype.selectDow=function(nodeId){var n=nd(nodeId);if(n){if(DOMHandler.hasClass(n,this.CLASS_SELECTED)){DOMHandler.removeClass(n,this.CLASS_SELECTED);DOMHandler.addClass(n,this.CLASS_NOT_SELECTED);}
else{DOMHandler.removeClass(n,this.CLASS_NOT_SELECTED);DOMHandler.addClass(n,this.CLASS_SELECTED);}}}
EditDow.prototype.setValue=function(newValue){if(newValue){for(var i=0;i<this.m_days.length;i++){for(var j=0;j<newValue.length;j++){if(this.m_days[i].control.getAttr("val")==newValue[j]){this.selectDow(this.m_days[i].control.getId());}}}}}
EditDow.prototype.getValue=function(){var sel=DOMHandler.getElementsByAttr(this.CLASS_SELECTED,this.m_node,"class",false,"div");var val="";for(var i=0;i<sel.length;i++){val+=((val=="")?"":",")+DOMHandler.getAttr(sel[i],"val");}
return"{"+val+"}";}
EditDow.prototype.validate=function(val){return val;}
EditDow.prototype.setEnabled=function(val){EditDow.superclass.setEnabled.call(this,val);if(this.m_days){if(val){EventHandler.addEvent(this.m_node,"click",this.m_onClick);}
else{EventHandler.removeEvent(this.m_node,"click",this.m_onClick);}
for(var i=0;i<this.m_days.length;i++){this.m_days[i].control.toDOM(this.m_node);if(val){DOMHandler.removeClass(this.m_days[i].control.m_node,"disabled");}
else{DOMHandler.addClass(this.m_days[i].control.m_node,"disabled");}}}} 
function View(id,options){options=options||{};options.tagName=options.tagName||this.DEF_TAG_NAME;View.superclass.constructor.call(this,id,options.tagName,options);if(options.readController){this.setReadController(options.readController);}
if(options.readMethodId){this.setReadMethodId(options.readMethodId);}
if(options.titleControl){this.setTitle(options.titleControl);}
else if(options.title){this.setTitle(new Control(this.getId()+"_title","h1",{"value":options.title}));}
options.writeController=options.writeController||options.readController;if(options.writeController){this.setWriteController(options.writeController);}
if(options.writeMethodId){this.setWriteMethodId(options.writeMethodId);}
if(options.errorControl){this.setErrorControl(options.errorControl);}
if(options.formHeight){this.m_formHeight=options.formHeight;}
if(options.formWidth){this.m_formWidth=options.formWidth;}
if(options.formCaption){this.m_formCaption=options.formCaption;}
if(options.focussedControlId){this.m_FocussedControlId=options.focussedControlId;}
this.m_writeAsync=(options.writeAsync==undefined)?false:options.writeAsync;this.m_winObj=options.winObj;this.m_bindings={};this.m_readModels={};this.m_params=options.params;}
extend(View,ControlContainer);View.prototype.DEF_TAG_NAME="div";View.prototype.DEF_CALSS="view";View.prototype.FORMER_KEY_VAL="old_";View.prototype.m_bindings;View.prototype.m_readModels;View.prototype.m_readMethodId;View.prototype.m_writeMethodId;View.prototype.m_errorControl;View.prototype.m_titleControl;View.prototype.m_lastWriteResult;View.prototype.m_formHeight;View.prototype.m_formWidth;View.prototype.m_FocussedControlId;View.prototype.m_objModified;View.prototype.bindControl=function(control,readBind,writeBind,options){this.m_bindings[control.getId()]={"control":control,"readBind":readBind,"writeBind":writeBind,"options":options};if(readBind){if(this.m_readModels[readBind.modelId]==undefined){this.m_readModels[readBind.modelId]=[];}
this.m_readModels[readBind.modelId].push(control.getId());}}
View.prototype.addControl=function(control){this.addElement(control);}
View.prototype.getControl=function(controlId){return this.m_elements[controlId];}
View.prototype.getBind=function(controlId){if(!this.m_bindings[controlId]){throw new Error("View::getDataBinding control not found "+controlId);}
return this.m_bindings[controlId];}
View.prototype.getDataControl=function(controlId){return this.getDataBinding(controlId);}
View.prototype.getDataBinding=function(controlId){if(!this.m_bindings[controlId]){throw new Error("View::getDataBinding control not found "+controlId);}
return this.m_bindings[controlId];}
View.prototype.getViewControl=function(controlId){return this.getDataBinding(controlId).control;}
View.prototype.viewControlExists=function(controlId){return(this.m_bindings[controlId])?true:false;}
View.prototype.getViewControlValue=function(controlId){return this.getDataControlValue(controlId);}
View.prototype.getDataControlValue=function(controlId){return this.getViewControl(controlId).getValue();}
View.prototype.setDataControlValue=function(controlId,val){return this.getViewControl(controlId).setValue(val);}
View.prototype.setViewControlValue=function(controlId,val){this.setDataControlValue(controlId,val);}
View.prototype.getViewControlFieldValue=function(controlId,fieldId){return this.getViewControl(controlId).getFieldValue(fieldId);}
View.prototype.addDataControl=function(control,readBind,writeBind,options){this.addElement(control);this.bindControl(control,readBind,writeBind,options);}
View.prototype.setReadController=function(readController){this.m_readController=readController;}
View.prototype.getReadController=function(){return this.m_readController;}
View.prototype.setWriteController=function(writeController){this.m_writeController=writeController;}
View.prototype.getWriteController=function(){return this.m_writeController;}
View.prototype.setReadMethodId=function(readMethodId){this.m_readMethodId=readMethodId;}
View.prototype.getReadMethodId=function(){return this.m_readMethodId;}
View.prototype.setWriteMethodId=function(writeMethodId){this.m_writeMethodId=writeMethodId;}
View.prototype.getWriteMethodId=function(){return this.m_writeMethodId;}
View.prototype.getErrorControl=function(){return this.m_errorControl;}
View.prototype.setErrorControl=function(errorControl){this.m_errorControl=errorControl;}
View.prototype.setTitle=function(titleControl){this.m_titleControl=titleControl;}
View.prototype.getTitleControl=function(){return this.m_titleControl;}
View.prototype.getTitle=function(){if(this.m_titleControl){return this.m_titleControl.getValue();}}
View.prototype.set_temp_disabled=function(cont){for(var id in cont){if(cont[id]){if(cont[id].m_elements){this.set_temp_disabled(cont[id].m_elements);}
else{this.m_changedControls.push({"ctrl":cont[id],"enabled":cont[id].getEnabled()});cont[id].setEnabled(false);}}}}
View.prototype.setTempDisabled=function(){this.m_changedControls=[];this.set_temp_disabled(this.m_elements);}
View.prototype.setTempEnabled=function(){if(this.m_changedControls){for(var i=0;i<this.m_changedControls.length;i++){if(this.m_changedControls[i].enabled){this.m_changedControls[i].ctrl.setEnabled(true);}}}}
View.prototype.readData=function(async){this.setTempDisabled();var self=this;this.getReadController().run(this.getReadMethodId(),{"func":function(resp){self.onGetData(resp);},"async":(async==undefined)?true:async,"err":function(resp,errCode,errStr){self.onWriteError(resp,errCode,errStr);}});}
View.prototype.onWriteError=function(resp,errCode,errStr){var ctrl=this.getErrorControl();if(ctrl){ctrl.setValue(errStr);}}
View.prototype.onGetData=function(resp,isNew){isNew=(isNew==undefined)?true:isNew;this.setTempEnabled();var model,ctrl_id,ctrl_bind,val,val_key,keys;for(var model_id in this.m_readModels){model=resp.getModelById(model_id);model.setActive(true);if(model.getNextRow()){for(var i=0;i<this.m_readModels[model_id].length;i++){ctrl_id=this.m_readModels[model_id][i];ctrl_bind=this.m_bindings[ctrl_id];if(ctrl_bind.readBind.valueFieldId==undefined){continue;}
val=model.getFieldValue(ctrl_bind.readBind.valueFieldId);ctrl_bind.control.setValue(val);keys=ctrl_bind.readBind.keyFieldIds;if(keys){for(var key_ind=0;key_ind<keys.length;key_ind++){val_key=model.getFieldValue(keys[key_ind]);ctrl_bind.control.setFieldValue(keys[key_ind],val_key);if(!isNew){ctrl_bind.control.setFormerFieldValue(keys[key_ind],val_key);}}}
else{if(ctrl_bind.control.setFormerValue){if(!isNew){ctrl_bind.control.setFormerValue(ctrl_bind.writeBind.valueFieldId,val);}}
else{if(!isNew){ctrl_bind.control.setAttr(this.FORMER_KEY_VAL+ctrl_bind.readBind.valueFieldId,val);}}}}}}}
View.prototype.getModified=function(){var contr=this.getWriteController();if(!contr)return;var meth_id=this.getWriteMethodId();var pm=contr.getPublicMethodById(meth_id);var ctrl,modif=false;for(var ctrl_id in this.m_bindings){ctrl=this.m_bindings[ctrl_id].control;if(!ctrl.getEnabled())continue;var key_field_ids=this.m_bindings[ctrl_id].writeBind.keyFieldIds;var field_id=this.m_bindings[ctrl_id].writeBind.valueFieldId;var former_val,val;if(key_field_ids){for(var i=0;i<key_field_ids.length;i++){former_val=ctrl.getFormerFieldValue(key_field_ids[i]);val=ctrl.getFieldValue(key_field_ids[i]);if((pm.paramExists(key_field_ids[i]))&&(former_val!=val||ctrl.getAlwaysUpdate())&&!(former_val=="null"&&val&&val.length==0)&&!(former_val=="null"&&val==undefined)){modif=true;break;}}}
else if(field_id){val=ctrl.getValue();former_val=ctrl.getAttr(this.FORMER_KEY_VAL+field_id);if((pm.paramExists(field_id))&&(former_val!=val||ctrl.getAlwaysUpdate())&&!(former_val==null&&val.length==0)&&!(former_val==null&&val=="null")){modif=true;break;}}}
return modif;}
View.prototype.setMethodParams=function(pm,checkRes){for(var ctrl_id in this.m_bindings){var ctrl=this.m_bindings[ctrl_id].control;if(!this.m_bindings[ctrl_id].writeBind)continue;var key_field_ids=this.m_bindings[ctrl_id].writeBind.keyFieldIds;var field_id=this.m_bindings[ctrl_id].writeBind.valueFieldId;var former_val,val;if(key_field_ids){for(var i=0;i<key_field_ids.length;i++){former_val=ctrl.getFormerFieldValue(key_field_ids[i]);val=ctrl.getFieldValue(key_field_ids[i]);if(ctrl.validate){try{val=ctrl.validate(val);if(ctrl.setComment){ctrl.setComment("");}}
catch(e){if(ctrl.setComment){ctrl.setComment(e.message);}
checkRes.incorrect_vals=true;}}
if(pm.paramExists(this.FORMER_KEY_VAL+key_field_ids)){pm.setParamValue(this.FORMER_KEY_VAL+key_field_ids[i],former_val);}
if((pm.paramExists(key_field_ids[i]))&&(former_val!=val||ctrl.getAlwaysUpdate())){pm.setParamValue(key_field_ids[i],val);checkRes.modif=true;}}}
else if(field_id){val=ctrl.getValue();if(ctrl.validate){try{val=ctrl.validate(val);if(ctrl.setComment){ctrl.setComment("");}}
catch(e){if(ctrl.setComment){ctrl.setComment(e.message);}
checkRes.incorrect_vals=true;}}
former_val=ctrl.getAttr(this.FORMER_KEY_VAL+field_id);if(pm.paramExists(this.FORMER_KEY_VAL+field_id)){pm.setParamValue(this.FORMER_KEY_VAL+field_id,former_val);}
if((pm.paramExists(field_id))&&(former_val!=val||ctrl.getAlwaysUpdate())){pm.setParamValue(field_id,val);checkRes.modif=true;}}}}
View.prototype.writeData=function(async){var contr=this.getWriteController();if(!contr)return;var meth_id=this.getWriteMethodId();var check_res={"incorrect_vals":false,"modif":false};this.setMethodParams(contr.getPublicMethodById(meth_id),check_res);if(!check_res.incorrect_vals&&check_res.modif){this.setTempDisabled();contr.runPublicMethod(meth_id,{},(async!=undefined)?async:this.getWriteAsync(),this.onWriteOk,this,this.onError,this.getWriteRespXML());}
else if(check_res.incorrect_vals){this.m_errorControl.setValue("Обнаружены ошибки!");}
else if(!check_res.modif){this.onWriteOk();}}
View.prototype.removeDOM=function(){if(this.m_titleControl){this.m_titleControl.removeDOM();}
if(this.m_errorControl){this.m_errorControl.removeDOM();}
View.superclass.removeDOM.call(this);}
View.prototype.onWriteOk=function(resp){this.m_objModified=true;this.m_lastWriteResult=true;this.setTempEnabled();}
View.prototype.onError=function(resp,erCode,erStr){this.m_lastWriteResult=false;this.setTempEnabled();if(this.m_errorControl){this.m_errorControl.setValue(erStr);}
else{throw new Error("AJAX error: "+erStr);}}
View.prototype.toDOM=function(parent){if(this.m_titleControl){this.m_titleControl.toDOM(parent);}
View.superclass.toDOM.call(this,parent);if(this.m_errorControl){this.m_errorControl.toDOM(parent);}
if(this.m_FocussedControlId){this.m_bindings[this.m_FocussedControlId].control.m_node.focus();}
else{for(var bind in this.m_bindings){if((this.m_bindings[bind].options==undefined||!this.m_bindings[bind].options.autoFillOnInsert)&&this.m_bindings[bind].control.getVisible()&&this.m_bindings[bind].control.getEnabled()){this.m_bindings[bind].control.m_node.focus();break;}}}}
View.prototype.getFormWidth=function(){return this.m_formWidth;}
View.prototype.setFormWidth=function(formWidth){this.m_formWidth=formWidth;}
View.prototype.getFormHeight=function(){return this.m_formHeight;}
View.prototype.setFormHeight=function(formHeight){this.m_formHeight=formHeight;}
View.prototype.getFormCaption=function(){return this.m_formCaption;}
View.prototype.setFormCaption=function(s){this.m_formCaption=s;}
View.prototype.getDocument=function(){if(this.m_winObj){return this.m_winObj.getWindowForm().document;}
else{return window.document;}}
View.prototype.getWriteAsync=function(){return this.m_writeAsync;}
View.prototype.getWriteRespXML=function(){return this.m_writeRespXML;}
View.prototype.setWriteRespXML=function(writeRespXML){this.m_writeRespXML=writeRespXML;} 
function ViewDialog(id,options){options=options||{};options.errorControl=options.errorControl||new ErrorControl(id+"_errors");options.tagName=options.tagName||"form";options.className="form-horizontal";options.readMethodId=options.readMethodId||this.DEF_READ_METH_ID;options.writeController=options.writeController||options.readController;options.formWidth=1000;options.formHeight=1000;ViewDialog.superclass.constructor.call(this,id,options);if(options.onClose){this.setOnClose(options.onClose);}
if(options.noWaitControl==undefined||options.waitControl==false){this.m_waitControl=new WaitControl(id);}
var self=this;if(options.noOk==undefined||(options.noOk!=undefined&&options.noOk==false)){this.m_ctrlOk=new ButtonCmd(id+"btnOk",{"caption":"ОК","onClick":function(){self.onClickOk();},"attrs":{"title":"записать,закрыть"}});}
if(options.noCancel==undefined||(options.noCancel!=undefined&&options.noCancel==false)){this.m_ctrlCancel=new ButtonCmd(id+"btnCancel",{"caption":"Закрыть","onClick":function(){self.onCancel();},"attrs":{"title":"закрыть без сохранения"}});}
this.setIsNew(true);this.m_insertMethId=options.insertMethodId||this.DEF_INSERT_METH_ID;this.m_updateMethId=options.updateMethodId||this.DEF_UPDATE_METH_ID;this.m_keyEvent=options.keyEvent||function(event){event=EventHandler.fixMouseEvent(event);var key_code=(event.charCode)?event.charCode:event.keyCode;if(key_code==27){event.preventDefault();self.onCancel();return false;}};this.m_customWriteMethod=options.customWriteMethod;this.m_cmdControls=options.cmdControls;}
extend(ViewDialog,View);ViewDialog.prototype.m_isNew;ViewDialog.prototype.m_insertMethId;ViewDialog.prototype.m_updateMethId;ViewDialog.prototype.m_onClose;ViewDialog.prototype.m_ctrlOk;ViewDialog.prototype.m_ctrlSave;ViewDialog.prototype.m_ctrlCancel;ViewDialog.prototype.DEF_READ_METH_ID='get_object';ViewDialog.prototype.DEF_INSERT_METH_ID='insert';ViewDialog.prototype.DEF_UPDATE_METH_ID='update';ViewDialog.prototype.getOnClose=function(){return this.m_onClose;}
ViewDialog.prototype.setOnClose=function(onClose){this.m_onClose=onClose;}
ViewDialog.prototype.getIsNew=function(){return this.m_isNew;}
ViewDialog.prototype.setIsNew=function(isNew){this.m_isNew=isNew;}
ViewDialog.prototype.toDOM=function(parent){ViewDialog.superclass.toDOM.call(this,parent);this.m_cmdContainer=new Control(null,"div",{"className":"view_cmd_cont"});if(this.m_waitControl){this.m_waitControl.toDOM(this.m_cmdContainer.m_node);}
if(this.m_ctrlOk){this.m_ctrlOk.toDOM(this.m_cmdContainer.m_node);}
if(this.m_ctrlSave){this.m_ctrlSave.toDOM(this.m_cmdContainer.m_node);}
if(this.m_ctrlCancel){this.m_ctrlCancel.toDOM(this.m_cmdContainer.m_node);}
if(this.m_cmdControls){if(is_array(this.m_cmdControls)){for(var i=0;i<this.m_cmdControls.length;i++){this.m_cmdControls[i].toDOM(this.m_cmdContainer.m_node);}}
else{for(var id in this.m_cmdControls){this.m_cmdControls[id].toDOM(this.m_cmdContainer.m_node);}}}
this.m_cmdContainer.toDOM(parent);if(this.m_keyEvent){EventHandler.addEvent(this.getWinObjDocum(),'keydown',this.m_keyEvent,false);}
this.m_node.scrollIntoView();}
ViewDialog.prototype.removeDOM=function(){if(this.m_waitControl){this.m_waitControl.removeDOM();}
if(this.m_ctrlOk){this.m_ctrlOk.removeDOM();}
if(this.m_ctrlSave){this.m_ctrlSave.removeDOM();}
if(this.m_ctrlCancel){this.m_ctrlCancel.removeDOM();}
if(this.m_cmdContainer){this.m_cmdContainer.removeDOM();}
if(this.m_keyEvent){EventHandler.removeEvent(this.getWinObjDocum(),'keydown',this.m_keyEvent,false);}
ViewDialog.superclass.removeDOM.call(this);}
ViewDialog.prototype.readData=function(async,isCopy){this.m_isCopy=(isCopy==undefined)?false:isCopy;this.setIsNew(this.m_isCopy);ViewDialog.superclass.readData.call(this,async);if(this.m_beforeOpen){this.m_beforeOpen(this.getReadController(),false,isCopy);}}
ViewDialog.prototype.onGetData=function(resp){ViewDialog.superclass.onGetData.call(this,resp,this.m_isCopy);if(this.m_isCopy){if(this.afterCopyData){this.afterCopyData();}}}
ViewDialog.prototype.getWriteMethodId=function(){if(this.m_customWriteMethod){return this.m_writeMethodId;}
else{return(this.getIsNew()||this.m_isCopy)?this.m_insertMethId:this.m_updateMethId;}}
ViewDialog.prototype.setReadIdValue=function(fieldId,value){this.getReadController().getPublicMethodById(this.getReadMethodId()).setParamValue(fieldId,value);}
ViewDialog.prototype.onWriteOk=function(resp){ViewDialog.superclass.onWriteOk.call(this,resp);if(this.getIsNew()&&resp){var contr=this.getWriteController();var meth_id=this.getWriteMethodId();var pm=contr.getPublicMethodById(meth_id);if(pm.paramExists(contr.PARAM_RET_ID)){if(resp.modelExists("InsertedId_Model")){var model=resp.getModelById("InsertedId_Model",true);if(model.getNextRow()){for(var id in model.m_fields){this.setReadIdValue(id,model.getFieldById(id).getValue());}
this.setIsNew(false);}}}}}
ViewDialog.prototype.onClickOk=function(){this.writeData(false);if(this.m_lastWriteResult&&this.getOnClose()){this.getOnClose().call(this,1);}
return true;}
ViewDialog.prototype.onClickSave=function(){if(this.getIsNew()){var contr=this.getWriteController();var meth_id=this.getWriteMethodId();var pm=contr.getPublicMethodById(meth_id);if(pm.paramExists(contr.PARAM_RET_ID)){pm.setParamValue(contr.PARAM_RET_ID,1);}}
this.writeData(false);if(this.m_lastWriteResult)this.readData(false);}
ViewDialog.prototype.onCancel=function(){if(this.getModified()){var self=this;WindowQuestion.show({text:"Сохранить изменения?",yes:true,cancel:true,no:true,timeout:30000,winObj:this.m_winObj,callBack:function(res){if(res==WindowQuestion.RES_YES){self.onClickOk();}
else if(self.getOnClose){self.getOnClose().call(self,0);}}});}
else if(this.getOnClose){this.getOnClose().call(this,0);}
return true;}
ViewDialog.prototype.setEnabled=function(enabled){ViewDialog.superclass.setEnabled.call(this,enabled);if(this.m_ctrlOk){this.m_ctrlOk.setEnabled(enabled);}
if(this.m_ctrlCancel){this.m_ctrlCancel.setEnabled(enabled);}}
ViewDialog.prototype.setTempDisabled=function(){ViewDialog.superclass.setTempDisabled.call(this);if(this.m_waitControl){this.m_waitControl.setVisible(true);}}
ViewDialog.prototype.setTempEnabled=function(){ViewDialog.superclass.setTempEnabled.call(this);if(this.m_waitControl){this.m_waitControl.setVisible(false);}} 
function ViewList(id,options){options=options||{};options.tagName=options.tagName||this.DEF_TAG_NAME;options.className=options.className||"panel-body";ViewList.superclass.constructor.call(this,id,options.tagName,options);if(options.onClose){this.setOnClose(options.onClose);}
if(options.titleControl){this.setTitle(options.titleControl);}
else if(options.title){this.setTitle(new Control(this.getId()+"_title","div",{"attrs":{"class":"panel-heading"},"value":options.title}));}
var self=this;if(options.formHeight){this.m_formHeight=options.formHeight;}
if(options.formWidth){this.m_formWidth=options.formWidth;}
this.m_winObj=options.winObj;this.m_viewContClassName=options.viewContClassName||"panel panel-primary";}
extend(ViewList,ControlContainer);ViewList.prototype.m_onClose;ViewList.prototype.m_btnClose;ViewList.prototype.m_titleControl;ViewList.prototype.m_formHeight;ViewList.prototype.m_formWidth;ViewList.prototype.DEF_TAG_NAME="div";ViewList.prototype.setTitle=function(titleControl){this.m_titleControl=titleControl;}
ViewList.prototype.getTitle=function(){if(this.m_titleControl){return this.m_titleControl.getValue();}}
ViewList.prototype.getTitleControl=function(){return this.m_titleControl;}
ViewList.prototype.getOnClose=function(){return this.m_onClose;}
ViewList.prototype.setOnClose=function(onClose){this.m_onClose=onClose;}
ViewList.prototype.toDOM=function(parent){this.m_cont=new Control(this.getId()+"_cont","div",{"attrs":{"class":this.m_viewContClassName}});this.m_cont.toDOM(parent);if(this.m_titleControl){this.m_titleControl.toDOM(this.m_cont.getNode());}
ViewList.superclass.toDOM.call(this,this.m_cont.getNode());}
ViewList.prototype.removeDOM=function(){if(this.m_titleControl){this.m_titleControl.removeDOM();}
ViewList.superclass.removeDOM.call(this);this.m_cont.removeDOM();}
ViewList.prototype.getFormWidth=function(){return this.m_formWidth;}
ViewList.prototype.setFormWidth=function(formWidth){this.m_formWidth=formWidth;}
ViewList.prototype.getFormHeight=function(){return this.m_formHeight;}
ViewList.prototype.setFormHeight=function(formHeight){this.m_formHeight=formHeight;} 
function ViewDocument(id,options){options=options||{};ViewDocument.superclass.constructor.call(this,id,options);var self=this;this.m_beforeOpen=function(contr,isInsert){var doc_id=0;if(!isInsert){doc_id=self.getViewControl(self.getId()+"_id").getValue();}
contr.run("before_open",{async:false,params:{"doc_id":doc_id}});}
this.addDataControl(new EditNum(id+"_id",{"attrs":{"name":"id","value":"0"},"visible":false}),{"modelId":options.readModelId,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new EditCheckBox(id+"_processed",{"attrs":{"name":"processed"},"visible":false}),{"modelId":options.readModelId,"valueFieldId":"processed","keyFieldIds":null},{"valueFieldId":"processed","keyFieldIds":null});this.addDataControl(new EditNum(id+"_number",{"labelCaption":"Номер:","name":"number","attrs":{"maxlength":5,"size":5,"disabled":"disabled"}}),{"modelId":options.readModelId,"valueFieldId":"number","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new EditDateTime(id+"_date_time",{"labelCaption":"Дата:","name":"date_time","attrs":{"required":"required"},"value":DateHandler.dateToStr(null,"dd/mm/y hh:mmin:ss")}),{"modelId":options.readModelId,"valueFieldId":"date_time_descr","keyFieldIds":null},{"valueFieldId":"date_time","keyFieldIds":null});}
extend(ViewDocument,ViewDialog);ViewDocument.prototype.m_detailContainer;ViewDocument.prototype.addDetailControl=function(detailControl){if(this.m_details==undefined){var detail_row=new ControlContainer(this.getId()+"_det_row","tr");var td=new ControlContainer(this.getId()+"_det_row_col","td",{"attrs":{"colspan":"2"}});detail_row.addElement(td);this.m_details=new ControlContainer(this.getId()+"_details","div",{"attrs":{"class":"tabber"}});td.addElement(this.m_details);this.addElement(detail_row);}
this.m_details.addElement(detailControl);}
ViewDocument.prototype.getDetailControl=function(controlId){return this.m_details.getElementById(controlId);}
ViewDocument.prototype.readData=function(async,isCopy){ViewDocument.superclass.readData.call(this,false,isCopy);}
ViewDocument.prototype.onClickSave=function(){var cmd_insert=this.getIsNew();if(cmd_insert){var contr=this.getWriteController();var meth_id=this.getWriteMethodId();var pm=contr.getPublicMethodById(meth_id);if(pm.paramExists(contr.PARAM_RET_ID)){pm.setParamValue(contr.PARAM_RET_ID,1);}}
this.writeData(false);}
ViewDocument.prototype.getModified=function(){var modif=ViewDocument.superclass.getModified.call(this);if(!modif){modif=true;}
return modif;}
ViewDocument.prototype.setMethodParams=function(pm,checkRes){pm.setParamValue("processed","true");ViewDocument.superclass.setMethodParams.call(this,pm,checkRes);if(!checkRes.modif){checkRes.modif=true;}} 
function ViewDocumentDetail(id,options){options=options||{};options.tagName=options.tagName||this.DEF_TAG_NAME;ViewDocumentDetail.superclass.constructor.call(this,id,options.tagName,options);if(options.formHeight){this.m_formHeight=options.formHeight;}
if(options.formWidth){this.m_formWidth=options.formWidth;}
this.m_errorControl=options.errorControl;this.m_winObj=options.winObj;}
extend(ViewDocumentDetail,ControlContainer);ViewDocumentDetail.prototype.DEF_TAG_NAME="div";ViewDocumentDetail.prototype.getFormWidth=function(){return this.m_formWidth;}
ViewDocumentDetail.prototype.setFormWidth=function(formWidth){this.m_formWidth=formWidth;}
ViewDocumentDetail.prototype.getFormHeight=function(){return this.m_formHeight;}
ViewDocumentDetail.prototype.setFormHeight=function(formHeight){this.m_formHeight=formHeight;}
ViewDocumentDetail.prototype.getGridControl=function(){return this.m_gridControl;}
ViewDocumentDetail.prototype.setGridControl=function(gridControl){this.addElement(gridControl);this.m_gridControl=gridControl;}
ViewDocumentDetail.prototype.getErrorControl=function(){return this.m_errorControl;}
ViewDocumentDetail.prototype.setErrorControl=function(errorControl){this.m_errorControl=errorControl;}
ViewDocumentDetail.prototype.getModified=function(){return this.getGridControl().m_modified;} 
function ViewInlineGridEdit(id,options){options=options||{};options.tagName=options.tagName||this.DEF_TAG_NAME;this.m_tagName=options.tagName;ViewInlineGridEdit.superclass.constructor.call(this,id,options);this.m_containerClassName=options.containerClassName||"input-group";if(options.onClose){this.setOnClose(options.onClose);}
var self=this;var onOk=function(){self.writeData();if(self.m_lastWriteResult){self.getOnClose().call(self,1);}}
var onCancel=function(){self.setWriteMethodId((self.getIsNew())?self.m_insertMethId:self.m_updateMethId);if(self.getModified()){WindowQuestion.show({text:"Сохранить изменения?",yes:true,cancel:true,no:true,timeout:30000,winObj:this.m_winObj,callBack:function(res){if(res==WindowQuestion.RES_YES){self.onClickOk();}
else if(self.getOnClose){self.getOnClose().call(self,0);}}});}
else{self.getOnClose().call(self,0);}}
this.m_ctrlOk=new ButtonCmd(id+"btnOk",{"caption":"ОК","onClick":onOk,"attrs":{"title":"записать"}});this.m_ctrlCancel=new ButtonCmd(id+"btnCancel",{"caption":"Отмена","onClick":onCancel,"attrs":{"title":"отмена"}});this.m_ctrlContainer=new ControlContainer(null,(this.m_tagName=="tr")?"td":this.m_tagName);this.m_ctrlContainer.setElementById("ok",this.m_ctrlOk);this.m_ctrlContainer.setElementById("cancel",this.m_ctrlCancel);this.setIsNew(true);this.m_insertMethId=options.insertMethodId||this.DEF_INSERT_METH_ID;this.m_updateMethId=options.updateMethodId||this.DEF_UPDATE_METH_ID;this.setReadMethodId(options.readMethodId||this.DEF_READ_METH_ID);this.m_dataControls=[];}
extend(ViewInlineGridEdit,View);ViewInlineGridEdit.prototype.m_isNew;ViewInlineGridEdit.prototype.m_insertMethId;ViewInlineGridEdit.prototype.m_updateMethId;ViewInlineGridEdit.prototype.m_onClose;ViewInlineGridEdit.prototype.m_ctrlOk;ViewInlineGridEdit.prototype.m_ctrlCancel;ViewInlineGridEdit.prototype.m_ctrlContainer;ViewInlineGridEdit.prototype.m_tagName;ViewInlineGridEdit.prototype.DEF_INSERT_METH_ID='insert';ViewInlineGridEdit.prototype.DEF_UPDATE_METH_ID='update';ViewInlineGridEdit.prototype.DEF_READ_METH_ID="get_object";ViewInlineGridEdit.prototype.DEF_TAG_NAME="tr";ViewInlineGridEdit.prototype.m_dataControls;ViewInlineGridEdit.prototype.getOnClose=function(){return this.m_onClose;}
ViewInlineGridEdit.prototype.setOnClose=function(onClose){this.m_onClose=onClose;}
ViewInlineGridEdit.prototype.getIsNew=function(){return this.m_isNew;}
ViewInlineGridEdit.prototype.setIsNew=function(isNew){this.m_isNew=isNew;}
ViewInlineGridEdit.prototype.toDOM=function(parent,replacedNode){var elem;for(var elem_id in this.m_elements){elem=this.m_elements[elem_id];elem.toDOM(this.m_node);}
this.m_ctrlContainer.toDOM(this.m_node);if(replacedNode){parent.replaceChild(this.m_node,replacedNode);}
else{var rows=parent.getElementsByTagName(this.m_node.nodeName);if(rows.length==0){parent.appendChild(this.m_node);}
else{parent.insertBefore(this.m_node,rows[0]);}}
for(var bind in this.m_bindings){if(this.m_bindings[bind].options==undefined||!this.m_bindings[bind].options.autoFillOnInsert){this.m_bindings[bind].control.m_node.focus();break;}}}
ViewInlineGridEdit.prototype.removeDOM=function(){this.m_ctrlContainer.removeDOM();ViewInlineGridEdit.superclass.removeDOM.call(this);}
ViewInlineGridEdit.prototype.readData=function(async,isCopy){this.m_isCopy=(isCopy==undefined)?false:isCopy;this.setIsNew(this.m_isCopy);ViewInlineGridEdit.superclass.readData.call(this,async);}
ViewInlineGridEdit.prototype.onGetData=function(resp){ViewInlineGridEdit.superclass.onGetData.call(this,resp,this.m_isCopy);if(this.m_isCopy){if(this.afterCopyData){this.afterCopyData();}}}
ViewInlineGridEdit.prototype.getWriteMethodId=function(){return(this.getIsNew()||this.m_isCopy)?this.m_insertMethId:this.m_updateMethId;}
ViewInlineGridEdit.prototype.writeData=function(){this.setWriteMethodId((this.getIsNew())?this.m_insertMethId:this.m_updateMethId);ViewInlineGridEdit.superclass.writeData.call(this);}
ViewInlineGridEdit.prototype.setReadIdValue=function(fieldId,value){this.getReadController().getPublicMethodById(this.getReadMethodId()).setParamValue(fieldId,value);}
ViewInlineGridEdit.prototype.addDataControl=function(control,readBind,writeBind,options){var container=new ControlContainer(uuid(),"div",{className:this.m_containerClassName});this.m_dataControls[control.getId()]=control;var container_td=new ControlContainer(uuid(),"td");container_td.setVisible(control.getVisible());container_td.setEnabled(control.getEnabled());container_td.addElement(container);container.addElement(control);this.bindControl(control,readBind,writeBind,options);this.addElement(container_td);} 
function ViewInlineGridEditDOCT(id,options){options=options||{};ViewInlineGridEditDOCT.superclass.constructor.call(this,id,options);this.addDataControl(new Edit(id+"view_id",{"attrs":{"value":0},"name":"view_id","visible":false}),{"modelId":options.readModelId,"valueFieldId":"view_id","keyFieldIds":null},{"valueFieldId":"view_id","keyFieldIds":null});this.addDataControl(new Edit(id+"_line_number",{"attrs":{"disabled":"disabled","value":0,"size":"3"},"name":"line_number"}),{"modelId":options.readModelId,"valueFieldId":"line_number","keyFieldIds":null},{"valueFieldId":"line_number","keyFieldIds":null});}
extend(ViewInlineGridEditDOCT,ViewInlineGridEdit); 
function ViewDialogGridEditDOCT(id,options){options=options||{};ViewDialogGridEditDOCT.superclass.constructor.call(this,id,options);options.methParams=options.methParams||{};this.addDataControl(new Edit(id+"view_id",{"attrs":{"value":options.methParams.view_id},"name":"view_id","visible":false}),{"modelId":options.readModelId,"valueFieldId":"view_id","keyFieldIds":null},{"valueFieldId":"view_id","keyFieldIds":null});this.addDataControl(new Edit(id+"_line_number",{"name":"line_number","visible":false}),{"modelId":options.readModelId,"valueFieldId":"line_number","keyFieldIds":null},{"valueFieldId":"line_number","keyFieldIds":null});}
extend(ViewDialogGridEditDOCT,ViewDialog); 
function ViewReport(id,options){options=options||{};options.className=options.className||"panel panel-primary";ViewReport.superclass.constructor.call(this,id,"div",options);if(options.title){this.m_title=new Control(id+"_title","div",{"value":options.title,"className":"panel-heading"});}
this.m_tuneContainer=new ControlContainer(id+"_tune","div",{"className":"panel-group collapse in"});this.setWaitControl(options.waitControl||new WaitControl(id+"_wait"));this.setErrorControl(options.errorControl||new ErrorControl(id+"_error"));this.m_methodId=options.methodId;this.m_viewId=options.viewId;this.m_controller=options.controller;this.m_reportControl=options.reportControl||new Control(id+"_report","div");this.m_commandPanel=options.commandPanel||new ControlContainer(id+"_cmd","div",{"repView":this,"className":"grid_commands"});this.m_winObj=options.winObj;var self=this;this.setOnClose(options.onClose);if(options.reportType){this.m_variant=new EditReportVariant(id+"_variant",{"report_type":options.reportType,"onStoreVariant":function(id){self.storeControls(id);},"onRestoreVariant":function(keys,descr){self.restoreControls(keys,descr);}});}
this.m_storingControl={};}
extend(ViewReport,ControlContainer);ViewReport.prototype.EXCEL_VIEW="ViewExcel";ViewReport.prototype.PDF_VIEW="ViewPDF";ViewReport.prototype.m_controller;ViewReport.prototype.m_methodId;ViewReport.prototype.m_viewId;ViewReport.prototype.m_title;ViewReport.prototype.m_waitControl;ViewReport.prototype.m_filterContainer;ViewReport.prototype.m_condFieldContainer;ViewReport.prototype.m_aggFieldContainer;ViewReport.prototype.m_groupFieldContainer;ViewReport.prototype.m_reportControl;ViewReport.prototype.m_errorControl;ViewReport.prototype.m_commandPanel;ViewReport.prototype.m_tuneContainer;ViewReport.prototype.getFilterContainer=function(){return this.m_filterContainer;}
ViewReport.prototype.setFilterContainer=function(ctrl){this.m_filterContainer=ctrl;}
ViewReport.prototype.setGroupContainer=function(ctrl){return this.m_groupFieldContainer=ctrl;}
ViewReport.prototype.getWaitControl=function(){return this.m_waitControl;}
ViewReport.prototype.toDOM=function(parent){ViewReport.superclass.toDOM.call(this,parent);if(this.m_title){this.m_title.toDOM(this.m_node);}
if(this.m_variant){this.m_variant.toDOM(this.m_node);}
if(this.m_waitControl){this.m_waitControl.toDOM(this.m_node);}
if(this.m_errorControl){this.m_errorControl.toDOM(this.m_node);}
if(this.m_filterContainer){this.m_filterContainer.toDOM(this.m_node);}
if(this.m_commandPanel){this.m_commandPanel.toDOM(this.m_node);}
if(this.m_groupFieldContainer){this.m_groupFieldContainerCont=new ControlContainer(uuid(),"div",{"className":"panel panel-default "+get_bs_col()+"3"});this.m_groupFieldContainerCont.addElement(new Control(uuid(),"div",{"className":"panel-heading","value":"Группировки и поля"}));this.m_groupFieldContainerCont.addElement(this.m_groupFieldContainer);this.m_groupFieldContainerCont.toDOM(this.m_tuneContainer.m_node);}
if(this.m_condFieldContainer){this.m_condFieldContainerCont=new ControlContainer(uuid(),"div",{"className":"panel panel-default "+get_bs_col()+"6"});this.m_condFieldContainerCont.addElement(new Control(uuid(),"div",{"className":"panel-heading","value":"Условия отбора"}));this.m_condFieldContainerCont.addElement(this.m_condFieldContainer);this.m_condFieldContainerCont.toDOM(this.m_tuneContainer.m_node);}
if(this.m_aggFieldContainer){this.m_aggFieldContainerCont=new ControlContainer(uuid(),"div",{"className":"panel panel-default "+get_bs_col()+"3"});this.m_aggFieldContainerCont.addElement(new Control(uuid(),"div",{"className":"panel-heading","value":"Показатели"}));this.m_aggFieldContainerCont.addElement(this.m_aggFieldContainer);this.m_aggFieldContainerCont.toDOM(this.m_tuneContainer.m_node);}
this.m_tuneContainer.toDOM(this.m_node);if(this.m_reportControl){this.m_reportControl.toDOM(this.m_node);}}
ViewReport.prototype.removeDOM=function(){if(this.m_title){this.m_title.removeDOM();}
if(this.m_variant){this.m_variant.removeDOM();}
if(this.m_waitControl){this.m_waitControl.removeDOM();}
if(this.m_errorControl){this.m_errorControl.removeDOM();}
if(this.m_filterContainer){this.m_filterContainer.removeDOM();}
if(this.m_condFieldContainer){this.m_condFieldContainer.removeDOM();this.m_condFieldContainerCont.removeDOM();}
if(this.m_groupFieldContainer){this.m_groupFieldContainer.removeDOM();this.m_groupFieldContainerCont.removeDOM();}
if(this.m_aggFieldContainer){this.m_aggFieldContainer.removeDOM();this.m_aggFieldContainerCont.removeDOM();}
this.m_tuneContainer.removeDOM();if(this.m_reportControl){this.m_reportControl.removeDOM();}
ViewReport.superclass.removeDOM.call(this);}
ViewReport.prototype.setReportControl=function(reportControl){this.m_reportControl=reportControl;}
ViewReport.prototype.getReportControl=function(){return this.m_reportControl;}
ViewReport.prototype.setErrorControl=function(ctrl){this.m_errorControl=ctrl;}
ViewReport.prototype.getErrorControl=function(){return this.m_errorControl;}
ViewReport.prototype.setWaitControl=function(ctrl){this.m_waitControl=ctrl;}
ViewReport.prototype.getWaitControl=function(){return this.m_waitControl;}
ViewReport.prototype.fillParams=function(contr){var pm=contr.getPublicMethodById(this.m_methodId);pm.setParamValue("v",this.m_viewId);var params_struc={"fields":null,"signs":null,"vals":null,"icase":null,"groups":null,"agg_fields":null,"agg_types":null};this.getFilterParams(params_struc);if(params_struc.fields){pm.setParamValue(contr.PARAM_COND_FIELDS,params_struc.fields);pm.setParamValue(contr.PARAM_COND_SGNS,params_struc.signs);pm.setParamValue(contr.PARAM_COND_VALS,params_struc.vals);pm.setParamValue(contr.PARAM_COND_ICASE,params_struc.icase);}
if(this.m_aggFieldContainer){this.m_aggFieldContainer.getParams(params_struc);if(params_struc.agg_fields){pm.setParamValue(contr.PARAM_AGG_FIELDS,params_struc.agg_fields);pm.setParamValue(contr.PARAM_AGG_TYPES,params_struc.agg_types);}}
if(this.m_groupFieldContainer){this.m_groupFieldContainer.getParams(params_struc);if(params_struc.groups){pm.setParamValue(contr.PARAM_GROUPS,params_struc.groups);}}
pm.setParamValue("field_sep","@");return true;}
ViewReport.prototype.downloadReport=function(view){var contr=new this.m_controller(new ServConnector(HOST_NAME));if(!this.fillParams(contr)){return;}
var meth=contr.getPublicMethodById(this.m_methodId);meth.setParamValue(contr.PARAM_VIEW,view);var params={};this.addExtraParamsForDownload(params);var form=$('<form></form>').attr('action',"index.php").attr('method','post');for(var id in meth.m_params){form.append($("<input></input>").attr('type','hidden').attr('name',id).attr('value',meth.m_params[id].getValue()));}
for(var id in params){form.append($("<input></input>").attr('type','hidden').attr('name',id).attr('value',params[id].getValue()));}
form.appendTo('body').submit().remove();}
ViewReport.prototype.makeReport=function(async){this.m_repResultOk=false;this.m_errorControl.m_node.innerHTML="";if(this.m_reportControl==undefined){return;}
if(this.m_aggFieldContainer&&!this.m_aggFieldContainer.getSelectedCount()){this.m_errorControl.setValue("Не выбран ни один показательт!");return;}
if(this.m_groupFieldContainer&&!this.m_groupFieldContainer.getSelectedCount()){this.m_errorControl.setValue("Не задана ни одна группировка!");return;}
var qm_async=(async==undefined)?false:async;var self=this;var contr=new this.m_controller(new ServConnector(HOST_NAME));if(!this.fillParams(contr)){return;}
this.m_reportControl.m_node.innerHTML="";if(this.m_commandPanel){this.m_commandPanel.setEnabled(false);}
if(this.m_waitControl){this.m_waitControl.setVisible(true);}
var params={};this.addExtraParams(params);contr.runPublicMethod(this.m_methodId,params,qm_async,function(respText){self.m_reportControl.m_node.innerHTML=respText;if(self.m_waitControl){self.m_waitControl.setVisible(false);}
if(self.m_commandPanel){self.m_commandPanel.setEnabled(true);}
this.m_repResultOk=true;},this,this.onError,false,false);}
ViewReport.prototype.onError=function(resp,erCode,erStr){if(this.m_errorControl){this.m_errorControl.setValue(erCode+" "+erStr);}
if(this.m_waitControl){this.m_waitControl.setVisible(false);}
this.m_commandPanel.setEnabled(true);this.m_repResultOk=false;}
ViewReport.prototype.addExtraParams=function(struc){}
ViewReport.prototype.addExtraParamsForDownload=function(struc){}
ViewReport.prototype.addStoringControl=function(control){this.m_storingControl[control.getId()]=control;}
ViewReport.prototype.storeControls=function(variantId){var data={};var cnt=0;for(var id in this.m_storingControl){data[id]=this.m_storingControl[id].getValueAsObj();cnt++;}
if(cnt){var contr=new ReportVariant_Controller(new ServConnector(HOST_NAME));contr.run("update",{"params":{"old_id":variantId,"data":array2json(data)},"get":false,"func":function(){WindowMessage.show({"text":"Сохранение настроек выполнено.","type":WindowMessage.TP_NOTE});}});}}
ViewReport.prototype.restoreControls=function(keys,descrs){var self=this;var contr=new ReportVariant_Controller(new ServConnector(HOST_NAME));contr.run("get_object",{"params":{"id":keys.id},"func":function(resp){var m=resp.getModelById("ReportVariant_Model",true);if(m.getNextRow()){var data=json2obj(m.getFieldValue("data"));for(var id in data){if(self.m_storingControl[id]){self.m_storingControl[id].setValueFromObj(data[id]);}}}}});}
ViewReport.prototype.addCmdMakeReport=function(opts){opts=opts||{};var self=this;this.m_commandPanel.addElement(new ButtonCmd(this.getId()+"_btn_make",{"caption":opts.caption||"Сформировать","onClick":function(){self.makeReport(true);}}));}
ViewReport.prototype.addCmdPrint=function(){var self=this;this.m_commandPanel.addElement(new ButtonCmd(this.getId()+"_btn_print",{"glyph":"glyphicon-print","onClick":function(e){if(self.getEnabled()){var ctrl=self.getReportControl();if(ctrl&&ctrl.m_node){WindowPrint.show({"content":ctrl.m_node.outerHTML});}}},"attrs":{"title":"печать"}}));}
ViewReport.prototype.addCmdFilter=function(opts){opts=opts||{};this.m_commandPanel.addElement(new ButtonCmd(this.getId()+"_btn_filter",{"attrs":{"data-toggle":"collapse","data-target":("#"+this.m_tuneContainer.getId()),"aria-expanded":"true"},"caption":opts.caption||"Настройка","glyph":"glyphicon-triangle-bottom"}));}
ViewReport.prototype.addCmdExcel=function(){var self=this;this.m_commandPanel.addElement(new ButtonExpToExcel(this.getId()+"_btn_exp_to_excel",{"onClick":function(){self.downloadReport(self.EXCEL_VIEW);}}));}
ViewReport.prototype.addCmdPDF=function(){var self=this;this.m_commandPanel.addElement(new ButtonExpToPDF(this.getId()+"_btn_exp_to_pdf",{"onClick":function(){self.downloadReport(self.PDF_VIEW);}}));}
ViewReport.prototype.addFilterContainer=function(filters){filters=filters||[];this.m_filter=new ListFilter();this.m_filterContainer=new ControlContainer(this.getId()+"_filter","div",{"className":"form-horizontal"});for(var i=0;i<filters.length;i++){this.m_filter.addFilter(filters[i].control.getId(),filters[i].filter);this.m_filterContainer.addElement(filters[i].control);}}
ViewReport.prototype.getOnClose=function(){return this.m_onClose;}
ViewReport.prototype.setOnClose=function(onClose){this.m_onClose=onClose;}
ViewReport.prototype.getFilterParams=function(struc){if(this.m_filter){for(var ctrl_id in this.m_filterContainer.m_elements){var ctrl=this.m_filterContainer.m_elements[ctrl_id];if(this.m_filter.m_params[ctrl_id]){var keys=this.m_filter.m_params[ctrl_id].keyFieldIds;if(keys){for(var i=0;i<keys.length;i++){var key;if(ctrl.getFieldValue){key=ctrl.getFieldValue(keys[i]);}
else{key=ctrl.getAttr("fkey_"+keys[i]);}
this.m_filter.m_params[ctrl_id].key=key;}}
this.m_filter.m_params[ctrl_id].descr=ctrl.getValue();}}
this.m_filter.getParams(struc);}
if(this.m_condFieldContainer){this.m_condFieldContainer.getParams(struc);}} 
function ViewMenu(id,options){options=options||{};options.title=options.title;ViewMenu.superclass.constructor.call(this,id,options);this.m_winObj=options.winObj;var self=this;this.m_itemView=null;this.m_itemClose=function(res){if(self.m_itemView!=undefined){self.m_itemView.removeDOM();delete self.m_itemView;}};this.m_menu=new ControlContainer("page_menu","ul",{"className":"nav nav-tabs"});this.addElement(this.m_menu);this.m_content=new Control("page_content","div",{"className":"panel panel-default"});this.addElement(this.m_content);}
extend(ViewMenu,ViewList);ViewMenu.prototype.addItem=function(options){var self=this;this.m_menu.addElement(new MenuItem({"id":options.id+"_menu","caption":options.caption,"attrs":{"role":"presentation"},"onClickContext":this,"viewClassId":options.viewClassId,"onClick":function(viewClassId){self.onClick(viewClassId,options.id,options.viewParams);}}));}
ViewMenu.prototype.onClick=function(viewClassId,id,viewParams){this.m_itemClose();this.m_itemView=new viewClassId(id,{"onClose":this.m_itemClose,"connect":new ServConnector(HOST_NAME),"winObj":this.m_winObj,"viewParams":viewParams});this.m_itemView.toDOM(this.m_content.m_node);} 
function Grid(id,options){options=options||{};options.className=options.className||"";if(options.className){options.className+=" ";}
options.className+="table table-bordered table-responsive table-striped";options.tagName=options.tagName||this.DEF_TAG_NAME;if(options.commandPanel){options.commandPanel.setClickContext(this);options.commandPanel.setOnClickInsert(this.onInsert);options.commandPanel.setOnClickEdit(this.onEdit);options.commandPanel.setOnClickCopy(this.onCopy);options.commandPanel.setOnClickDelete(this.onDelete);options.commandPanel.setOnClickRefresh(this.onRefresh);this.setCommandPanel(options.commandPanel);}
Grid.superclass.constructor.call(this,id,options.tagName,options);if(options.editViewClass){this.m_editViewClass=options.editViewClass;}
if(options.editInline){this.m_editInline=options.editInline;}
if(options.editWinClass){this.m_editWinClass=options.editWinClass;}
if(options.refreshInterval){this.setRefreshInterval(options.refreshInterval);}
if(options.rowCommandPanelClass){this.m_rowCommandPanelClass=options.rowCommandPanelClass;}
this.m_rowCommandPanelClassParams=options.rowCommandPanelClassParams;if(options.onSelect){this.m_onSelect=options.onSelect;}
this.m_multySelect=options.multySelect;this.m_autoRefresh=(options.noAutoRefresh==undefined||(options.noAutoRefresh!=undefined&&options.noAutoRefresh==false));this.m_editViewParams=options.editViewParams||{};if(options.filter){this.setFilter(options.filter);options.filter.setClickContext(this);options.filter.setOnRefresh(this.onRefresh);}
if(options.head){this.setHead(options.head);}
if(options.body){this.setBody(options.body);}
if(options.foot){this.setFoot(options.foot);}
this.m_extraFields=options.extraFields;options.errorControl=options.errorControl||new ErrorControl(id);if(options.errorControl){this.setErrorControl(options.errorControl);}
if(options.pagination){this.setPagination(options.pagination);options.pagination.setOnGridRefresh(this.onRefresh);options.pagination.setClickContext(this);}
if(options.popUpMenu){this.setPopUpMenu(options.popUpMenu);}
if(options.eventContext){this.m_eventContext=options.eventContext;}
if(options.onEventRefresh){this.m_onEventRefresh=options.onEventRefresh;}
this.m_resize=false;this.m_navigate=(options.noNavigation==undefined||(options.noNavigation!=undefined&&options.noNavigation==false));if(this.m_navigate){options.attrs=options.attrs||{};this.setAttr("tabindex",options.attrs.tabindex||"100");this.m_rowSelect=(options.rowSelect==undefined||(options.rowSelect!=undefined&&options.rowSelect==true));}
var self=this;this.m_keyEvent=function(event){if(self.getEnabled()){event=EventHandler.fixMouseEvent(event);var key_code=(event.charCode)?event.charCode:event.keyCode;if(self.keyPressEvent(key_code,event)){event.preventDefault();return false;}}};this.m_focusEvent=function(){self.setFocused(true);}
this.m_blurEvent=function(){self.setFocused(false);}
this.m_clickEvent=function(event){event=EventHandler.fixMouseEvent(event);if(self.getEnabled()&&event.target.nodeName.toLowerCase()=="td"){if(!self.getFocused()){self.setFocused(true);}
if(self.m_rowSelect&&self.getRowSelectable(event.target.parentNode)){self.selectRow(event.target.parentNode,self.getSelectedNode());}
else if(!self.m_rowSelect&&self.getCellSelectable(event.target)){self.selectCell(event.target,self.getSelectedNode());}}};this.m_dblClickEvent=function(event){self.onDblClick(event);};this.m_lastRowFooter=options.lastRowFooter;var head=this.getHead();if(head){var name=this.getName();var custom_sort=(name&&TEMPLATE_PARAMS[name]&&TEMPLATE_PARAMS[name].order&&is_array(TEMPLATE_PARAMS[name].order)&&TEMPLATE_PARAMS[name].order.length);var custom_order=(name&&TEMPLATE_PARAMS[name]&&TEMPLATE_PARAMS[name].visibility&&is_array(TEMPLATE_PARAMS[name].visibility)&&TEMPLATE_PARAMS[name].visibility.length);this.m_sortCols={};var col_names={};for(var row in head.m_elements){var head_row=head.m_elements[row];for(var col in head_row.m_elements){if(head_row.m_elements[col].getSortable()){var f_name=head_row.m_elements[col].getName();if(f_name){col_names[f_name]=head_row.m_elements[col];}
this.m_sortCols[col]=head_row.m_elements[col];head_row.m_elements[col].m_onRefresh=function(){self.onRefresh();}
head_row.m_elements[col].m_grid=this;if(custom_sort){head_row.m_elements[col].unsetSort();}}}
if(custom_order){head_row.setInitColumnOrder();head_row.setColumnOrder(TEMPLATE_PARAMS[name].visibility);}}
if(custom_sort){this.m_sortCols={};for(var id in TEMPLATE_PARAMS[name].order){var f_name=TEMPLATE_PARAMS[name].order[id].id;if(col_names[f_name]){this.m_sortCols[col_names[f_name].getId()]=col_names[f_name];if(TEMPLATE_PARAMS[name].order[id].checked&&TEMPLATE_PARAMS[name].order[id].direct!="undefined"&&col_names[f_name]){col_names[f_name].setSort(TEMPLATE_PARAMS[name].order[id].direct);}}}}}
if(options.fixedHeader){this.m_fixedHeader=true;this.m_fixedOffset=options.fixedOffset||0;}}
extend(Grid,Control);Grid.prototype.DEF_TAG_NAME="table";Grid.prototype.SELECTED_CLASS="success";Grid.prototype.FOCUSED_CLASS="focused";Grid.prototype.m_commandPanel;Grid.prototype.m_pagination;Grid.prototype.m_head;Grid.prototype.m_body;Grid.prototype.m_foot;Grid.prototype.m_filter;View.prototype.m_errorControl;Grid.prototype.m_editInline;Grid.prototype.m_editWinClass;Grid.prototype.m_editViewClass;Grid.prototype.m_editViewObj;Grid.prototype.m_rowCommandPanelClass;Grid.prototype.m_parent;Grid.prototype.m_interval;Grid.prototype.m_intervalObj;Grid.prototype.m_onSelect;Grid.prototype.m_multySelect;Grid.prototype.m_eventContext;Grid.prototype.m_onEventRefresh;Grid.prototype.m_onEventDelete;Grid.prototype.m_onEventInsert;Grid.prototype.setCommandPanel=function(commandPanel){this.m_commandPanel=commandPanel;}
Grid.prototype.getCommandPanel=function(){return this.m_commandPanel;}
Grid.prototype.setPagination=function(pagination){this.m_pagination=pagination;}
Grid.prototype.getPagination=function(){return this.m_pagination;}
Grid.prototype.setFilter=function(filter){this.m_filter=filter;}
Grid.prototype.getFilter=function(){return this.m_filter;}
Grid.prototype.setFoot=function(foot){this.m_foot=foot;}
Grid.prototype.getFoot=function(){return this.m_foot;}
Grid.prototype.setHead=function(head){this.m_head=head;}
Grid.prototype.getHead=function(){return this.m_head;}
Grid.prototype.setBody=function(body){this.m_body=body;}
Grid.prototype.getBody=function(){return this.m_body;}
Grid.prototype.getEditViewClass=function(){return this.m_editViewClass;}
Grid.prototype.getRowCommandPanelClass=function(){return this.m_rowCommandPanelClass;}
Grid.prototype.filterToDOM=function(parent){if(this.getFilter()){this.getFilter().toDOM(parent);}}
Grid.prototype.toDOM=function(parent){this.m_cont=new Control(uuid(),"div",{className:"scrollable-area "+this.getId()});if(this.getErrorControl()){this.getErrorControl().toDOM(parent);}
var flt_parent;if(this.getCommandPanel()){this.getCommandPanel().toDOM(parent);flt_parent=this.getCommandPanel().getNode();}
else{flt_parent=this.m_node;}
this.filterToDOM(flt_parent);Grid.superclass.toDOM.call(this,this.m_cont.getNode());var head=this.getHead();if(head){head.toDOM(this.m_node);}
var body=this.getBody();if(body)
body.toDOM(this.m_node);var foot=this.getFoot();if(foot)
foot.toDOM(this.m_node);this.m_cont.toDOM(parent);var pagin=this.getPagination()
if(pagin){pagin.toDOM(parent);}
this.m_parent=parent;if(this.m_autoRefresh){this.onRefresh();}
if(this.m_resize){ColumnResize(this.m_node);}
if(this.m_navigate){this.initNavigation();this.setSelection();}
if(this.getPopUpMenu()!=undefined){this.getPopUpMenu().bind(body.getNode());}
this.fixHeader();this.m_rendered=true;}
Grid.prototype.removeDOM=function(){this.setRefreshInterval(0);if(this.m_filter){this.m_filter.removeDOM();}
if(this.m_errorControl){this.m_errorControl.removeDOM();}
if(this.m_commandPanel){this.m_commandPanel.removeDOM();}
var head=this.getHead();if(head){head.removeDOM();}
var body=this.getBody();if(body){body.removeDOM();}
var foot=this.getFoot();if(foot){foot.removeDOM();}
EventHandler.removeEvent(this.m_node,'focus',this.m_focusEvent,false);EventHandler.removeEvent(this.m_node,'blur',this.m_blurEvent,false);Grid.superclass.removeDOM.call(this);this.m_cont.removeDOM();if(this.m_pagination){this.m_pagination.removeDOM();}
this.m_rendered=false;}
Grid.prototype.onError=function(erStr){if(this.m_errorControl){this.m_errorControl.setValue(erStr);}else{throw new Error(erStr);}}
Grid.prototype.getErrorControl=function(){return this.m_errorControl;}
Grid.prototype.setErrorControl=function(errorControl){this.m_errorControl=errorControl;}
Grid.prototype.getEditInline=function(){return this.m_editInline;}
Grid.prototype.onEdit=function(rowId,keys){if(this.m_onEventEdit){}}
Grid.prototype.onCopy=function(rowId,keys){}
Grid.prototype.onDelete=function(rowId,keys){var self=this;WindowQuestion.show({"cancel":false,"text":"Удалить запись?","callBack":function(r){if(r==WindowQuestion.RES_YES){var n=nd(rowId);if(n){self.getBody().getNode().removeChild(n);}}}});}
Grid.prototype.onInsert=function(){}
Grid.prototype.onRefresh=function(){if(this.m_onEventRefresh){this.m_onEventRefresh.call(this.m_eventContext);}
if(this.m_navigate){this.setSelection();}}
Grid.prototype.onUp=function(){var selected_node=this.getSelectedNode();if(selected_node&&selected_node.previousSibling){selected_node.parentNode.insertBefore(selected_node,selected_node.previousSibling);}}
Grid.prototype.onDown=function(){var selected_node=this.getSelectedNode();if(selected_node){var n_up=selected_node.nextSibling;if(n_up){n_up.parentNode.insertBefore(n_up,n_up.previousSibling);}}}
Grid.prototype.setRefreshInterval=function(refreshInterval){this.m_interval=refreshInterval;if(refreshInterval==0&&this.m_intervalObj!=undefined){window.clearInterval(this.m_intervalObj);}
else if(refreshInterval>0){var self=this;this.m_intervalObj=setInterval(function(){self.onRefresh();},refreshInterval);}}
Grid.prototype.getRefreshInterval=function(){return this.m_interval;}
Grid.prototype.setAutoRefresh=function(autoRefresh){this.m_autoRefresh=autoRefresh;}
Grid.prototype.getAutoRefresh=function(){return this.m_autoRefresh;}
Grid.prototype.initNavigation=function(){this.setFocused(true);EventHandler.addEvent(this.m_node,'focus',this.m_focusEvent,false);EventHandler.addEvent(this.m_node,'blur',this.m_blurEvent,false);}
Grid.prototype.selectFirstSelectableCell=function(row){var cells=row.getElementsByTagName("td");for(var i=0;i<cells.length;i++){if(this.getCellSelectable(cells[i])){this.selectCell(cells[i]);break;}}}
Grid.prototype.setSelection=function(){var selected=false;if(this.m_selectedRowKeys){var rows=this.m_node.getElementsByTagName("tr");for(var i=0;i<rows.length;i++){if(rows[i].getAttribute("key_values")==this.m_selectedRowKeys){if(this.m_rowSelect){this.selectRow(rows[i]);selected=true;}
else{if(rows[i].childNodes.length>this.m_selectedCellInd){this.selectCell(rows[i].childNodes[this.m_selectedCellInd]);}
else{this.selectFirstSelectableCell(rows[i]);}
selected=true;}
break;}}}
if(!selected&&this.getHead()){var rows=this.m_node.getElementsByTagName("tr");if(rows&&rows.length>1){if(this.m_rowSelect){var row_body_ind=this.getHead().getCount();for(var i=row_body_ind;i<rows.length;i++){if(this.getRowSelectable(rows[i])){this.selectRow(rows[i]);break;}}}
else{this.selectFirstSelectableCell(rows[this.getHead().getCount()]);}}}}
Grid.prototype.keyPressEvent=function(keyCode,event){var res=false;if(this.getFocused()){switch(keyCode){case 40:res=this.onKeyDown();break;case 38:res=this.onKeyUp();break;case 39:this.onKeyRight();break;case 37:res=this.onKeyLeft();break;case 13:res=this.onKeyEnter(event);break;case 46:res=this.onKeyDelete();break;case 45:res=this.onKeyInsert();break;}}
return res;}
Grid.prototype.onKeyLeft=function(){res=false;if(!this.m_rowSelect){var selected_node=this.getSelectedNode();if(selected_node&&selected_node.previousSibling&&this.getCellSelectable(selected_node.previousSibling)){this.selectCell(selected_node.previousSibling,selected_node);}
res=true;}
return res;}
Grid.prototype.onKeyRight=function(){var res=false;if(!this.m_rowSelect){var selected_node=this.getSelectedNode();if(selected_node&&selected_node.nextSibling&&this.getCellSelectable(selected_node.nextSibling)){this.selectCell(selected_node.nextSibling,selected_node);}
res=true;}
return res;}
Grid.prototype.onKeyUp=function(){var res=false;var selected_node=this.getSelectedNode();if(selected_node&&this.m_rowSelect&&selected_node.previousSibling&&(selected_node.previousSibling.nodeName==selected_node.nodeName)&&this.getRowSelectable(selected_node.previousSibling)){this.selectRow(selected_node.previousSibling,selected_node);res=true;}
else if(selected_node&&!this.m_rowSelect&&selected_node.parentNode.previousSibling&&(selected_node.parentNode.previousSibling.nodeName==selected_node.parentNode.nodeName)&&this.getCellSelectable(selected_node.parentNode.previousSibling)){var ind=DOMHandler.getElementIndex(selected_node);this.selectCell(selected_node.parentNode.previousSibling.childNodes[ind],selected_node);res=true;}
return res;}
Grid.prototype.onKeyDown=function(){var res=false;var selected_node=this.getSelectedNode();if(selected_node&&this.m_rowSelect&&selected_node.nextSibling&&(selected_node.nextSibling.nodeName==selected_node.nodeName)&&this.getRowSelectable(selected_node.nextSibling)){this.selectRow(selected_node.nextSibling,selected_node);res=true;}
else if(selected_node&&!this.m_rowSelect&&selected_node.parentNode.nextSibling&&(selected_node.parentNode.nextSibling.nodeName==selected_node.parentNode.nodeName)&&this.getCellSelectable(selected_node.parentNode.nextSibling)){var ind=DOMHandler.getElementIndex(selected_node);this.selectCell(selected_node.parentNode.nextSibling.childNodes[ind],selected_node);res=true;}
return res;}
Grid.prototype.onKeyInsert=function(){var res=false;if(this.m_commandPanel&&this.m_commandPanel.m_cmdInsert){this.onInsert();res=true;}
return res;}
Grid.prototype.onKeyDelete=function(){var res=false;if(this.m_commandPanel&&this.m_commandPanel.m_cmdDelete){var selected_node=this.getSelectedNode();if(selected_node){this.onDelete(selected_node.getAttribute("id"),json2obj(selected_node.getAttribute("key_values")));res=true;}}
return res;}
Grid.prototype.onKeyEnter=function(event){var res=false;if((!this.m_onSelect||(this.m_onSelect&&event.ctrlKey))&&(this.m_commandPanel&&this.m_commandPanel.m_cmdEdit))
{this.onEdit(this.m_selectedRowId,json2obj(this.m_selectedRowKeys));res=true;}
else if(this.m_onSelect&&!event.ctrlKey){var extraValues={};var descrValues={};var head_cells={};var ind=0;var row_n=nd(this.m_selectedRowId,this.getWinObjDocum());if(row_n){this.getHead().getFields(head_cells);for(var head_id in head_cells){ind+=1;field_val="";bind=head_cells[head_id].getReadBind();if(!bind)continue;if(head_cells[head_id].getDescrCol()){descrValues[bind.valueFieldId]=row_n.cells[ind-1].innerHTML;}}};this.m_onSelect(json2obj(this.m_selectedRowKeys),descrValues,extraValues,this.m_multySelect);res=true;}
return res;}
Grid.prototype.onDblClick=function(event){event=EventHandler.fixMouseEvent(event);if(this.getEnabled()&&event.target.nodeName.toLowerCase()=="td"){var selected_node=this.getSelectedNode();if(selected_node&&this.m_rowSelect){this.onEdit(selected_node.getAttribute("id"),json2obj(selected_node.getAttribute("key_values")));}}}
Grid.prototype.getRowSelectable=function(row){return(!DOMHandler.hasClass(row,"grid_foot")&&!DOMHandler.hasClass(row,"grid_details"));}
Grid.prototype.getCellSelectable=function(cell){return(!DOMHandler.hasClass(cell,"grid_sys_col")&&!DOMHandler.hasClass(cell.parentNode,"grid_foot"));}
Grid.prototype.selectNode=function(newNode,oldNode){if(oldNode){DOMHandler.removeClass(oldNode,this.SELECTED_CLASS);}
if(newNode){DOMHandler.addClass(newNode,this.SELECTED_CLASS);}}
Grid.prototype.selectRow=function(newRow,oldRow){if(newRow){this.m_selectedRowKeys=newRow.getAttribute("key_values");this.m_selectedRowId=newRow.getAttribute("id");this.selectNode(newRow,oldRow);}}
Grid.prototype.selectCell=function(newCell,oldCell){if(newCell){this.m_selectedRowKeys=newCell.parentNode.getAttribute("key_values");this.m_selectedRowId=newCell.parentNode.getAttribute("id");this.m_selectedCellInd=DOMHandler.getElementIndex(newCell);this.selectNode(newCell,oldCell);}}
Grid.prototype.getSelectedNode=function(){var sel=DOMHandler.getElementsByAttr(this.SELECTED_CLASS,this.m_body.m_node,"class",true,(this.m_rowSelect)?"tr":"td");return(sel.length)?sel[0]:null;}
Grid.prototype.getFocused=function(){return DOMHandler.hasClass(this.m_node,this.FOCUSED_CLASS);}
Grid.prototype.setFocused=function(focused){if(focused){var tables=this.getWinObjDocum().getElementsByTagName('table');for(var i=0;i<tables.length;i++){DOMHandler.removeClass(tables[i],this.FOCUSED_CLASS);}
DOMHandler.addClass(this.m_node,this.FOCUSED_CLASS);EventHandler.addEvent(this.m_node,'keydown',this.m_keyEvent,false);EventHandler.addEvent(this.m_node,"click",this.m_clickEvent,false);EventHandler.addEvent(this.m_node,"contextmenu",this.m_clickEvent,false);if(this.m_commandPanel&&this.m_commandPanel.m_cmdEdit){EventHandler.addEvent(this.m_node,'dblclick',this.m_dblClickEvent,false);}}
else{DOMHandler.removeClass(this.m_node,this.FOCUSED_CLASS);EventHandler.removeEvent(this.m_node,'keydown',this.m_keyEvent,false);EventHandler.removeEvent(this.m_node,"click",this.m_clickEvent,false);EventHandler.removeEvent(this.m_node,"contextevent",this.m_clickEvent,false);if(this.m_commandPanel&&this.m_commandPanel.m_cmdEdit){EventHandler.removeEvent(this.m_node,'dblclick',this.m_dblClickEvent,false);}}}
Grid.prototype.setEnabled=function(enabled){if(this.m_commandPanel){this.m_commandPanel.setEnabled(enabled);}
Grid.superclass.setEnabled.call(this,enabled);}
Grid.prototype.getSelectedNodeKeys=function(){var selected_node=this.getSelectedNode();if(selected_node){return json2obj(selected_node.getAttribute("key_values"));}}
Grid.prototype.setEditViewParam=function(par,val){this.m_editViewParams[par]=val;}
Grid.prototype.setPopUpMenu=function(menu){this.m_popUpMenu=menu;}
Grid.prototype.getPopUpMenu=function(){return this.m_popUpMenu;}
Grid.prototype.fixHeader=function(){}
Grid.prototype.serialize=function(o){var o=o||{};if(this.m_head){o.head=this.m_head.serialize();}
if(this.m_body){o.body=this.m_body.m_node.innerHTML;}
if(this.m_foot){o.foot=this.m_foot.serialize();}
for(var a in this.m_node.attributes){if(typeof this.m_node.attributes[a]!="object"&&typeof this.m_node.attributes[a]!="function"&&a!="value"){o[a]=this.m_node.attributes[a];}}
return array2json(o);}
Grid.prototype.unserialize=function(str){var o=json2obj(str);for(var a in o){if(a=="head"){this.m_head=o.head;}
else if(a=="body"){this.m_body.m_node.innerHTML=o.body;}
else if(a=="foot"){this.m_foot=o.foot;}
else{this.m_node.attributes[a]=o[a];}}}
Grid.prototype.getValueAsObj=function(){return{"head":this.m_head,"body":this.m_body.m_node.innerHTML,"foot":this.m_foot};}
Grid.prototype.setValueFromObj=function(obj){if(obj.head){this.m_head=obj.head;}
if(obj.body){this.m_body.m_node.innerHTML=obj.body;}
if(obj.foot){this.m_ащще=obj.foot;}} 
function GridRowCommands(id,options){options=options||{};var tagName=options.tagName||this.DEF_TAG_NAME;options.attrs=options.attrs||{};options.attrs["class"]=options.attrs["class"]||this.DEF_CLASS;GridRowCommands.superclass.constructor.call(this,id,tagName,options);var self=this;if(options.onClickEdit&&(options.noEdit==undefined||options.noEdit==false)){this.setElementById("edit",new Button(null,{"image":{"src":this.IMG_EDIT},"onClick":function(){options.onClickEdit.call(options.clickContext,options.rowId,options.keys);},"attrs":{"title":"изменить"}}));}
if(options.onClickDelete&&(options.noDelete==undefined||options.noDelete==false)){this.setElementById("del",new Button(null,{"image":{"src":this.IMG_DEL},"onClick":function(){options.onClickDelete.call(options.clickContext,options.rowId,options.keys);},"attrs":{"title":"удалить"}}));}}
extend(GridRowCommands,ControlContainer);GridRowCommands.prototype.DEF_TAG_NAME="td";GridRowCommands.prototype.IMG_EDIT="img/cat/cat_edit.png";GridRowCommands.prototype.IMG_DEL="img/cat/cat_erase.png";GridRowCommands.prototype.DEF_CLASS="grid_sys_col"; 
function GridRowCommandsDOC(id,options){options=options||{};GridRowCommandsDOC.superclass.constructor.call(this,id,options);var btn=new ButtonPrint(null,{image:{"src":this.IMG_PRINT},caption:"",className:"ctrlBtn",params:options.params,paramId:options.paramId,controller:options.controller,errorControl:options.errorControl});this.setElementById(id+"_print",btn);btn.setOnClick(function(){var tr=nd(options.rowId);if(tr){btn.m_params[btn.m_paramId]=tr.getElementsByTagName("td")[0].firstChild.nodeValue;btn.onClick();}});}
extend(GridRowCommandsDOC,GridRowCommands);GridRowCommands.prototype.IMG_PRINT="img/cat/print.png"; 
function GridRowCommandsConst(id,options){options=options||{};options.onClickDelete=null;GridRowCommandsConst.superclass.constructor.call(this,id,options);}
extend(GridRowCommandsConst,GridRowCommands); 
function GridCommands(id,options){options=options||{};options.className=options.className||this.DEF_CLASS_NAME;var tagName=options.tagName||this.DEF_TAG_NAME;GridCommands.superclass.constructor.call(this,id,tagName,options);this.m_btnClass=options.btnClass||ButtonCtrl;this.m_publicMethodId=options.publicMethodId;this.m_controller=options.controller;var self=this;if(options.onClickInsert){this.setOnClickInsert(options.onClickInsert);}
if(options.noInsert==undefined||options.noInsert==false){this.addInsert();}
if(options.noEdit==undefined||options.noEdit==false){this.addEdit();}
if(options.noCopy==undefined||options.noCopy==false){this.addCopy();}
if(options.noDelete==undefined||options.noDelete==false){this.addDelete();}
if(options.noPrint==undefined||options.noPrint==false){this.addPrint();}
if(options.controller&&(options.noExport==undefined||options.noExport==false)){this.addExport();}
if(options.onClickRefresh){this.setOnClickRefresh(options.onClickRefresh);}
if(options.noRefresh==undefined||options.noRefresh==false){this.addRefresh();}
if(options.cmdColumnManager){this.addColumnManager();}}
extend(GridCommands,ControlContainer);GridCommands.prototype.DEF_TAG_NAME="div";GridCommands.prototype.DEF_CLASS_NAME="grid_commands";GridCommands.prototype.m_onClickInsert;GridCommands.prototype.m_onClickRefresh;GridCommands.prototype.m_onClickExport;GridCommands.prototype.m_clickContext;GridCommands.prototype.setOnClickInsert=function(onClickInsert){this.m_onClickInsert=onClickInsert;}
GridCommands.prototype.setOnClickEdit=function(onClickEdit){this.m_onClickEdit=onClickEdit;}
GridCommands.prototype.setOnClickCopy=function(onClickCopy){this.m_onClickCopy=onClickCopy;}
GridCommands.prototype.setOnClickDelete=function(onClickDelete){this.m_onClickDelete=onClickDelete;}
GridCommands.prototype.setOnClickExport=function(onClickExport){this.m_onClickExport=onClickExport;}
GridCommands.prototype.setOnClickRefresh=function(onClickRefresh){this.m_onClickRefresh=onClickRefresh;}
GridCommands.prototype.setClickContext=function(clickContext){this.m_clickContext=clickContext;}
GridCommands.prototype.addInsert=function(){var self=this;this.m_btnInsert=new this.m_btnClass(null,{"glyph":"glyphicon-plus","onClick":function(){if(self.getEnabled()){self.m_onClickInsert.call(self.m_clickContext);}},"attrs":{"title":"Добавить"}});this.setElementById(this.getId()+"_insert",this.m_btnInsert);this.m_cmdInsert=true;}
GridCommands.prototype.addEdit=function(){var self=this;this.m_btnEdit=new this.m_btnClass(null,{"glyph":"glyphicon-pencil","onClick":function(event){if(self.m_clickContext.m_selectedRowId&&self.m_clickContext.m_selectedRowKeys&&self.getEnabled()){self.m_onClickEdit.call(self.m_clickContext,self.m_clickContext.m_selectedRowId,json2obj(self.m_clickContext.m_selectedRowKeys));}},"attrs":{"title":"Изменить"}});this.setElementById(this.getId()+"_edit",this.m_btnEdit);this.m_cmdEdit=true;}
GridCommands.prototype.addCopy=function(){var self=this;this.m_btnCopy=new this.m_btnClass(null,{"glyph":"glyphicon-copy","onClick":function(event){if(self.m_clickContext.m_selectedRowId&&self.m_clickContext.m_selectedRowKeys&&self.getEnabled()){self.m_onClickCopy.call(self.m_clickContext,self.m_clickContext.m_selectedRowId,json2obj(self.m_clickContext.m_selectedRowKeys));}},"attrs":{"title":"Копировать"}});this.setElementById(this.getId()+"_copy",this.m_btnCopy);this.m_cmdCopy=true;}
GridCommands.prototype.addDelete=function(){var self=this;this.m_btnDelete=new this.m_btnClass(null,{"glyph":"glyphicon-remove","onClick":function(){if(self.m_clickContext.m_selectedRowId&&self.getEnabled()){self.m_onClickDelete.call(self.m_clickContext,self.m_clickContext.m_selectedRowId,json2obj(self.m_clickContext.m_selectedRowKeys));}},"attrs":{"title":"Удалить"}});this.setElementById(this.getId()+"_delete",this.m_btnDelete);this.m_cmdDelete=true;}
GridCommands.prototype.addColumnManager=function(){var self=this;this.m_btnColumnManager=new this.m_btnClass(null,{"glyph":"glyphicon-th-list","onClick":function(){var btnCont=this;this.m_form=new WindowFormModalBS(uuid(),{"content":new ViewGridColumnManager(uuid(),{"grid":self.m_clickContext,"onClose":function(){btnCont.m_form.close();self.m_clickContext.onRefresh.call(self.m_clickContext);}})});this.m_form.open();},"attrs":{"title":"Открыть настройку колонок"}});this.setElementById(this.getId()+"_btnColManager",this.m_btnColumnManager);this.m_cmdColumnManager=true;}
GridCommands.prototype.addPrint=function(){var self=this;this.m_btnPrint=new this.m_btnClass(null,{"glyph":"glyphicon-print","onClick":function(e){if(self.getEnabled()){WindowPrint.show({content:self.m_clickContext.getNode().outerHTML});}},"attrs":{"title":"Печать"}});this.setElementById(this.getId()+"_print",this.m_btnPrint);this.m_cmdPrint=true;}
GridCommands.prototype.addExport=function(){var self=this;this.m_btnExport=new this.m_btnClass(null,{"glyph":"glyphicon-download-alt","onClick":function(){if(self.getEnabled()){var methId=self.m_publicMethodId||"get_list";var meth=self.m_controller.getPublicMethodById(methId);meth.setParamValue(self.m_controller.PARAM_VIEW,'ViewExcel');if(meth.paramExists(self.m_controller.PARAM_FROM)){meth.removeParam(self.m_controller.PARAM_FROM);}
if(meth.paramExists(self.m_controller.PARAM_COUNT)){meth.removeParam(self.m_controller.PARAM_COUNT);}
var params=self.m_controller.getQueryString(meth);meth.setParamValue(self.m_controller.PARAM_VIEW,'ViewXML');top.location.href=HOST_NAME+"index.php?"+params;}},"attrs":{"title":"Экспорт в Excel"}});this.setElementById(this.getId()+"_export",this.m_btnExport);this.m_cmdExcel=true;}
GridCommands.prototype.addRefresh=function(){var self=this;this.m_btnRefresh=new this.m_btnClass(null,{"glyph":"glyphicon-refresh","onClick":function(){if(self.getEnabled()){self.m_onClickRefresh.call(self.m_clickContext);}},"attrs":{"title":"Обновить"}});this.setElementById(this.getId()+"_refresh",this.m_btnRefresh);}
GridCommands.prototype.commandsToPopUp=function(popUp){if(this.m_btnInsert){popUp.addButton(this.m_btnInsert);}
if(this.m_btnEdit){popUp.addButton(this.m_btnEdit);}
if(this.m_btnCopy){popUp.addButton(this.m_btnCopy);}
if(this.m_btnDelete){popUp.addButton(this.m_btnDelete);}
if(this.m_btnPrint){popUp.addButton(this.m_btnPrint);}
if(this.m_btnExport){popUp.addButton(this.m_btnExport);}
if(this.m_btnRefresh){popUp.addButton(this.m_btnRefresh);}
if(this.m_btnColumnManager){popUp.addButton(this.m_btnColumnManager);}} 
function GridPagination(id,options){options=options||{};GridPagination.superclass.constructor.call(this,id,(options.tagName||this.DEF_TAG_NAME),options);var self=this;this.m_inf=new Control(id+":inf","span");this.m_showPageCount=(options.showPageCount)?parseInt(options.showPageCount):this.DEF_PAGES;if(this.m_showPageCount){this.m_pages=new ControlContainer(id+":pages","span",{"className":"pagination-pages"});}
this.m_btnsCont=new ControlContainer(id+":bns_cont","span",{"className":"pagination-pages"});var ctrl_class="btn btn-xs";this.m_ctrlGoFirst=new Button(id+":go_first",{"glyph":"glyphicon-fast-backward","className":ctrl_class,"onClick":function(){self.setFrom(0);self.m_onGridRefresh.call(self.m_clickContext);},"attrs":{"title":"в начало"}});this.m_btnsCont.addElement(this.m_ctrlGoFirst);this.m_ctrlGoPrev=new Button(id+":go_prev",{"glyph":"glyphicon-step-backward","className":ctrl_class,"onClick":function(){self.setFrom(Math.max(0,self.m_from-self.m_countPerPage));self.m_onGridRefresh.call(self.m_clickContext);},"attrs":{"title":"предыдущая"}});this.m_btnsCont.addElement(this.m_ctrlGoPrev);this.m_ctrlGoNext=new Button(id+":go_next",{"glyph":"glyphicon-step-forward","className":ctrl_class,"onClick":function(){var from=self.m_from+self.m_countPerPage;from=(from>=self.m_countTotal)?self.m_from:from;self.setFrom(from);self.m_onGridRefresh.call(self.m_clickContext);},"attrs":{"title":"следующая"}});this.m_btnsCont.addElement(this.m_ctrlGoNext);this.m_ctrlGoLast=new Button(id+":go_last",{"glyph":"glyphicon-fast-forward","className":ctrl_class,"onClick":function(){var pages=Math.floor(self.m_countTotal/self.m_countPerPage);if((self.m_countTotal%self.m_countPerPage)==0){pages--;}
self.setFrom(pages*self.m_countPerPage);self.m_onGridRefresh.call(self.m_clickContext);},"attrs":{"title":"в конец"}});this.m_btnsCont.addElement(this.m_ctrlGoLast);options.from=options.from||0;this.setFrom(options.from);if(options.countPerPage){this.setCountPerPage(options.countPerPage);}}
extend(GridPagination,Control);GridPagination.prototype.DEF_PAGES=10;GridPagination.prototype.DEF_TAG_NAME="div";GridPagination.prototype.m_countTotal;GridPagination.prototype.m_countPerPage;GridPagination.prototype.m_from;GridPagination.prototype.m_onGridRefresh;GridPagination.prototype.m_clickContext;GridPagination.prototype.m_inf;GridPagination.prototype.getFrom=function(){return this.m_from;}
GridPagination.prototype.getCountPerPage=function(){return this.m_countPerPage;}
GridPagination.prototype.setCountTotal=function(countTotal){this.m_countTotal=parseInt(countTotal);this.setInf();}
GridPagination.prototype.setCountPerPage=function(countPerPage){this.m_countPerPage=parseInt(countPerPage);}
GridPagination.prototype.setFrom=function(from){this.m_from=parseInt(from);this.setInf();}
GridPagination.prototype.setOnGridRefresh=function(onGridRefresh){this.m_onGridRefresh=onGridRefresh;}
GridPagination.prototype.setClickContext=function(clickContext){this.m_clickContext=clickContext;}
GridPagination.prototype.setFirstEnabled=function(enabled){}
GridPagination.prototype.setInf=function(){var pages=Math.ceil(this.m_countTotal/this.m_countPerPage);var page=Math.ceil(this.m_from/this.m_countPerPage)+1;if(isNaN(pages))pages=1;if(isNaN(page))page=1;this.m_inf.setValue("Страниц: "+pages);this.m_ctrlGoFirst.setEnabled((page>1));this.m_ctrlGoPrev.setEnabled((page>1));if(page==pages){this.m_ctrlGoLast.setEnabled(false);this.m_ctrlGoNext.setEnabled(false);}
else{this.m_ctrlGoLast.setEnabled(true);this.m_ctrlGoNext.setEnabled(true);}
if(this.m_showPageCount&&this.m_inf.getNode().parentNode){this.m_pages.removeDOM();this.m_pages.clear();var self=this;var prev_from=page-this.m_showPageCount;if(prev_from<1)prev_from=1;for(var pg=prev_from;pg<page;pg++){this.m_pages.addElement(new Control(uuid(),"span",{"className":"pagination-page","attrs":{"title":"Перейти на страницу "+pg,"to_page":pg},"value":pg,"events":{"click":function(e){self.goToPageFromEvent(e);}}}));}
if(pages>1){this.m_pages.addElement(new Control(uuid(),"span",{"className":"pagination-page badge pagination-page-cur","attrs":{"title":"Текущая страница"},"value":page}));}
var nxt_to=page+this.m_showPageCount;if(nxt_to>pages)nxt_to=pages;for(var pg=page+1;pg<=nxt_to;pg++){this.m_pages.addElement(new Control(uuid(),"span",{"className":"pagination-page","attrs":{"title":"Перейти на страницу "+pg,"to_page":pg},"value":pg,"events":{"click":function(e){self.goToPageFromEvent(e);}}}));}
this.m_pages.toDOMAfter(this.m_btnsCont.getNode());}}
GridPagination.prototype.goToPageFromEvent=function(e){e=EventHandler.fixMouseEvent(e);var pg=DOMHandler.getAttr(e.target,"to_page");this.setFrom((pg-1)*this.m_countPerPage);this.m_onGridRefresh.call(this.m_clickContext);}
GridPagination.prototype.toDOM=function(parent){GridPagination.superclass.toDOM.call(this,parent);this.m_inf.toDOM(this.m_node);this.m_btnsCont.toDOM(this.m_node);this.setInf();}
GridPagination.prototype.removeDOM=function(){if(this.m_showPageCount){this.m_pages.removeDOM();}
this.m_inf.removeDOM();this.m_btnsCont.removeDOM();GridPagination.superclass.removeDOM.call(this);} 
function GridDb(id,options){options=options||{};GridDb.superclass.constructor.call(this,id,options);if(options.controller){this.setController(options.controller);}
if(options.asyncEditRead!=undefined){this.m_asyncEditRead=options.asyncEditRead;}
this.m_asyncRefresh=(options.asyncRefresh!=undefined)?options.asyncRefresh:true;if(options.readModelId){this.setReadModelId(options.readModelId);}
if(options.methParams){this.m_methParams=options.methParams;}
this.setReadMethodId(options.readMethodId||this.DEF_READ_METH_ID);this.setDeleteMethodId(options.DeleteMethodId||this.DEF_DELETE_METH_ID);}
extend(GridDb,Grid);GridDb.prototype.m_controller;GridDb.prototype.m_readModelId;GridDb.prototype.m_readMethodId;GridDb.prototype.m_deleteMethodId;GridDb.prototype.m_lastWriteResult;GridDb.prototype.m_editViewObj;GridDb.prototype.m_methParams;GridDb.prototype.m_asyncEditRead;GridDb.prototype.DEF_READ_METH_ID="get_list";GridDb.prototype.DEF_DELETE_METH_ID="delete";GridDb.prototype.DEF_TITLE="<>";GridDb.prototype.setController=function(controller){this.m_controller=controller;}
GridDb.prototype.getController=function(){return this.m_controller;}
GridDb.prototype.setReadMethodId=function(readMethodId){this.m_readMethodId=readMethodId;}
GridDb.prototype.getReadMethodId=function(){return this.m_readMethodId;}
GridDb.prototype.setDeleteMethodId=function(deleteMethodId){this.m_deleteMethodId=deleteMethodId;}
GridDb.prototype.getDeleteMethodId=function(){return this.m_deleteMethodId;}
GridDb.prototype.setReadModelId=function(readModelId){this.m_readModelId=readModelId;}
GridDb.prototype.getReadModelId=function(){return this.m_readModelId;}
GridDb.prototype.onError=function(resp,erCode,erStr){this.m_lastWriteResult=false;if(this.m_errorControl){this.m_errorControl.setValue(erStr);}
else{alert("AJAX error: "+erStr);}}
GridDb.prototype.onRefresh=function(callBack){var self=this;var contr=this.getController();var meth=this.getReadMethodId();1000
if(contr==undefined||meth==undefined){if(callBack){callBack.call(this);}
return;}
var pm=contr.getPublicMethodById(meth);var pag=this.getPagination();if(pag){pm.setParamValue(contr.PARAM_FROM,pag.getFrom());pm.setParamValue(contr.PARAM_COUNT,pag.getCountPerPage());}
var filter=this.getFilter();if(filter||this.m_filterComplete){var struc={"fields":null,"signs":null,"vals":null,"icase":null,"field_sep":","};if(filter)filter.getParams(struc);if(this.m_filterComplete)this.m_filterComplete(struc);pm.setParamValue(contr.PARAM_COND_FIELDS,struc.fields);pm.setParamValue(contr.PARAM_COND_SGNS,struc.signs);pm.setParamValue(contr.PARAM_COND_VALS,struc.vals);pm.setParamValue(contr.PARAM_COND_ICASE,struc.icase);pm.setParamValue(contr.PARAM_FIELD_SEP,struc.field_sep);}
for(var col in this.m_sortCols){var sort=this.m_sortCols[col].getAttr("sort");if(sort=="asc"||sort=="desc"){var sort_col=this.m_sortCols[col].getAttr("sortCol");pm.setParamValue(contr.PARAM_ORD_FIELDS,(sort_col)?sort_col:this.m_sortCols[col].getAttr("field_id"));pm.setParamValue(contr.PARAM_ORD_DIRECTS,sort);}}
this.m_lastWriteResult=true;this.m_errorControl.setValue("");var self=this;contr.runPublicMethod(meth,{},this.m_asyncRefresh,function(resp){self.onGetData(resp);if(callBack){callBack.call(self);}},this,function(resp,erCode,erStr){console.log("Got ERROR callBack="+callBack,"error:",erStr)
window.showTempError(erStr,null,5000);if(callBack){callBack.call(self);}});}
GridDb.prototype.toDOM=function(parent){GridDb.superclass.toDOM.call(this,parent);}
GridDb.prototype.onDelete=function(rowId,keys,callback){var self=this;WindowQuestion.show({"text":"Запись будет удалена, продолжить?","winObj":this.m_winObj,"timeout":30000,"callBack":function(res){if(res==WindowQuestion.RES_YES){var contr_id=self.getController().getId();var contr=new window[contr_id](self.getController().getServConnector());var meth=self.getDeleteMethodId();var pm=contr.getPublicMethodById(meth);self.paramsToMethod(pm);for(var key_id in keys){pm.setParamValue(key_id,keys[key_id]);}
contr.run(meth,{"func":function(resp){self.m_modified=true;self.onRefresh(callback);}});}}});}
GridDb.prototype.destroyEditViewObj=function(){if(this.m_editViewObj){if(this.m_editViewObj.m_objModified!=undefined)
this.m_modified=this.m_editViewObj.m_objModified;this.m_editViewObj.removeDOM();delete this.m_editViewObj;}}
GridDb.prototype.initEditViewObj=function(controller){var edit_class=this.getEditViewClass();var interval=this.getRefreshInterval();this.setRefreshInterval(0);var self=this;this.m_editViewObj=new edit_class(this.getId()+"EditView",{"onClose":function(res){self.destroyEditViewObj();var ext_w=self.m_editWinClass&&self.m_editWin;if(ext_w){self.m_editWin.m_closeMode=res;self.m_editWin.close();delete self.m_editWin;}
if(!ext_w||(ext_w&&self.m_rendered)){self.removeDOM();self.toDOM(self.m_parent);self.setRefreshInterval(interval);if(self.m_editRowId){var w=$(window);var row=$("#"+self.m_editRowId);if(row.length){w.scrollTop(row.offset().top-(w.height()/2));}}}
self.m_modified=(res==1);},"readController":controller,"readModelId":this.getReadModelId(),"connect":this.m_controller.getServConnector(),"errorControl":(this.m_editWinClass)?null:this.getErrorControl(),"winObj":(this.m_editWinClass)?self.m_editWin:this.m_winObj,"methParams":this.m_methParams,"params":this.m_editViewParams});}
GridDb.prototype.setDefFilterValues=function(){var filter=this.getFilter();if(filter){for(var ctrl_id in filter.m_params){if(filter.m_params[ctrl_id].keyFieldIds){for(var i=0;i<filter.m_params[ctrl_id].keyFieldIds.length;i++){var val=filter.m_params[ctrl_id].key;if(val){var key=filter.m_params[ctrl_id].keyFieldIds[i];var control=DOMHandler.getElementsByAttr(key,this.m_node.tbody,"name");if(control&&control.length){control[0].value=val;}}}}}}}
GridDb.prototype.onInsert=function(){if(this.m_editViewObj){return 0;}
this.setGlobalWait(true);var contr_id=this.getController().getId();var contr=new window[contr_id](this.getController().getServConnector());var pm=contr.getInsert();this.paramsToMethod(pm);this.initEditViewObj(contr);var parent;if(this.getEditInline()){parent=this.getBody().m_node;}
else if(this.m_editWinClass){this.m_editWin=new this.m_editWinClass({"view":this.m_editViewObj,"title":this.m_editViewObj.getFormCaption()+":Новый","width":this.m_editViewObj.getFormWidth(),"height":this.m_editViewObj.getFormHeight()});this.m_editWin.open();this.m_editViewObj.setWinObj(this.m_editWin);parent=this.m_editWin.getContentParent();}
else{parent=this.m_parent;this.removeDOM();}
this.m_editViewObj.toDOM(parent);this.setDefFilterValues();GridDb.superclass.onInsert.call(this);this.setGlobalWait(false);}
GridDb.prototype.prepareEdit=function(rowId,keys,nodes,isCopy){if(this.m_editViewObj){return 0;}
this.setGlobalWait(true);var contr_id=this.getController().getId();var contr=new window[contr_id](this.getController().getServConnector());this.initEditViewObj(contr);var pm=contr.getPublicMethodById(this.m_editViewObj.getReadMethodId());this.paramsToMethod(pm);for(var key_id in keys){this.m_editViewObj.setReadIdValue(key_id,keys[key_id]);}
if(this.getEditInline()){nodes.parent=this.getBody().m_node;nodes.replaced_node=nd(rowId,this.getWinObjDocum());}
else if(this.m_editWinClass){this.m_editWin=new this.m_editWinClass({"view":this.m_editViewObj,"title":this.m_editViewObj.getFormCaption()+((isCopy)?":Новый":":Редактирование"),"width":this.m_editViewObj.getFormWidth(),"height":this.m_editViewObj.getFormHeight()});this.m_editWin.open();nodes.parent=this.m_editWin.getContentParent();}
else{nodes.parent=this.m_parent;this.removeDOM();}
this.setGlobalWait(false);}
GridDb.prototype.onCopy=function(rowId,keys){var nodes={parent:null,replaced_node:null};this.prepareEdit(rowId,keys,nodes,true);this.m_editViewObj.m_replacedNode=nodes.replaced_node;this.m_editViewObj.toDOM(nodes.parent);this.m_editViewObj.readData(this.m_asyncEditRead,true);}
GridDb.prototype.onEdit=function(rowId,keys){var nodes={parent:null,replaced_node:null};this.prepareEdit(rowId,keys,nodes);this.m_editViewObj.m_replacedNode=nodes.replaced_node;this.m_editRowId=rowId;this.m_editViewObj.toDOM(nodes.parent,nodes.replaced_node);this.m_editViewObj.readData(this.m_asyncEditRead);}
GridDb.prototype.onError=function(resp,erCode,erStr){this.m_lastWriteResult=false;GridDb.superclass.onError.call(this,erStr);}
GridDb.prototype.paramsToMethod=function(pm){if(this.m_methParams){var pm_id=pm.getId();if(this.m_methParams[pm_id]!=undefined){for(param_id in this.m_methParams[pm_id]){pm.setParamValue(param_id,this.m_methParams[pm_id][param_id]);}}}}
GridDb.prototype.onGetData=function(resp){var model=resp.getModelById(this.getReadModelId());model.setActive(true);var head_cells={};this.getHead().getFields(head_cells);var body=this.getBody();body.removeDOM();body.clear();var foot=this.getFoot();var bind,keys,field_count,row_count=0;var pag=this.getPagination();if(pag){pag.setCountTotal(model.getTotCount());}
if(this.m_onSelect){this.m_selects={};var set_select=function(grid,node,keys,descrs,extraFields){EventHandler.addEvent(node,"click",function(){grid.m_onSelect.call(null,keys,descrs,extraFields);},true);}}
if(this.m_foot&&this.m_foot.calcBegin){this.m_foot.calcBegin();}
var row;while(model.getNextRow()){var row_id=this.getId()+"_row_"+row_count;var row_class=(row_count%2==0)?"even":"odd";if(this.m_onSelect){row_class+=" for_select";}
if(this.onGetDataSetRowClass){row_class=this.onGetDataSetRowClass(model,row_class);}
var r_class=this.getGridRowClass();row=new r_class(row_id,{"className":row_class});row.m_grid=this;var keyValues={};var descrValues={};var extraValues={};field_count=0;for(var head_id in head_cells){field_val="";bind=head_cells[head_id].getReadBind();attrs={};if(!head_cells[head_id].getDbValue&&!bind){continue;}
else if(head_cells[head_id].getDbValue){field_val=head_cells[head_id].getDbValue(model,attrs);}
else{keys=bind.keyFieldIds;if(head_cells[head_id].getKeyCol()){keyValues[bind.valueFieldId]=model.getFieldValue(bind.valueFieldId);}
if(head_cells[head_id].getDescrCol()){descrValues[bind.valueFieldId]=model.getFieldValue(bind.valueFieldId);}
if(this.m_extraFields){for(var i=0;i<this.m_extraFields.length;i++){extraValues[this.m_extraFields[i]]=model.getFieldValue(this.m_extraFields[i]);}}
var ar_ind=null;if(bind.arrayIndex!=undefined){ar_ind=bind.arrayIndex;}
field_val=model.getFieldById(bind.valueFieldId).getValue(ar_ind);if(keys){for(var key_ind=0;key_ind<keys.length;key_ind++){attrs["fkey_"+keys[key_ind]]=model.getFieldById(keys[key_ind]).getValue();}}}
if(head_cells[head_id].m_fieldValueToRowClass&&bind){row_class+=(row_class=="")?"":" ";row_class+=model.getFieldValue(bind.valueFieldId);row.setClassName(row_class);}
var common_attrs=head_cells[head_id].getColAttrs();if(common_attrs){for(common_attr_id in common_attrs){attrs[common_attr_id]=common_attrs[common_attr_id];}}
var cell_opts={"value":field_val,"attrs":attrs,"accocImageArray":head_cells[head_id].getAssocImageArray()};if(field_val){var common_cont=head_cells[head_id].getColControlContainer();if(common_cont){common_cont.objectOptions.value=field_val;cell_opts.value=null;cell_opts.controlContainer=new common_cont.objectClass(uuid(),common_cont.objectOptions);}}
var cell=new GridCell(null,cell_opts);row.setElementById(field_count,cell);field_count++;}
row.setAttr("key_values",array2json(keyValues));var row_cmd_class=this.getRowCommandPanelClass();if(row_cmd_class){var row_class_options={"onClickEdit":this.onEdit,"onClickCopy":this.onCopy,"onClickDelete":this.onDelete,"rowId":row_id,"keys":keyValues,"clickContext":this,"connect":this.getController().getServConnector(),"context":this};if(this.m_rowCommandPanelClassParams){for(var par_id in this.m_rowCommandPanelClassParams){row_class_options[par_id]=this.m_rowCommandPanelClassParams[par_id];}}
row.setElementById("sys",new row_cmd_class(null,row_class_options));}
body.setElementById("row_"+row_count,row);row_count++;if(this.m_onSelect){this.m_selects[row_id]=new set_select(this,row.m_node,keyValues,descrValues,extraValues);}
if(this.m_foot&&this.m_foot.calc){this.m_foot.calc(model);}}
if(this.m_lastRowFooter&&row){DOMHandler.addClass(row.m_node,"grid_foot");}
if(this.m_foot&&this.m_foot.calcEnd){this.m_foot.calcEnd();}
body.toDOM(this.m_node);GridDb.superclass.onRefresh.call(this,resp);}
GridDb.prototype.getGridRowClass=function(){return GridRow;} 
function GridDbDOC(id,options){options=options||{};GridDbDOC.superclass.constructor.call(this,id,options);}
extend(GridDbDOC,GridDb);GridDbDOC.prototype.DEF_TITLE="Документ";GridDbDOC.prototype.onInsert=function(){if(this.m_editViewObj){return 0;}
this.setGlobalWait(true);var contr_id=this.getController().getId();var contr=new window[contr_id](this.getController().getServConnector());var pm=contr.getInsert();this.paramsToMethod(pm);this.initEditViewObj(contr);var parent;if(this.getEditInline()){parent=this.getBody().m_node;}
else if(this.m_editWinClass){this.m_editWin=new this.m_editWinClass({"view":this.m_editViewObj,"title":this.m_editViewObj.getFormCaption()+":Новый","width":this.m_editViewObj.getFormWidth(),"height":this.m_editViewObj.getFormHeight()});this.m_editWin.open();this.m_editViewObj.setWinObj(this.m_editWin);parent=this.m_editWin.getContentParent();}
else{parent=this.m_parent;this.removeDOM();}
if(this.m_editViewObj.m_beforeOpen){var contr=new window[this.getController().getId()](new ServConnector(HOST_NAME));this.m_editViewObj.m_beforeOpen(contr,true);}
this.m_editViewObj.toDOM(parent);this.setDefFilterValues();this.setGlobalWait(false);}
GridDbDOC.prototype.onEdit=function(rowId,keys,isCopy){if(this.m_editViewObj){return 0;}
this.setGlobalWait(true);var contr_id=this.getController().getId();var contr=new window[contr_id](this.getController().getServConnector());var pm=contr.getGetObject();this.paramsToMethod(pm);this.initEditViewObj(contr);var parent,replaced_node;if(this.getEditInline()){parent=this.getBody().m_node;replaced_node=nd(rowId);}
else if(this.m_editWinClass){this.m_editWin=new this.m_editWinClass({"view":this.m_editViewObj,"title":this.m_editViewObj.getFormCaption()+((isCopy)?":Новый":":Редактирование"),"width":this.m_editViewObj.getFormWidth(),"height":this.m_editViewObj.getFormHeight()});this.m_editWin.open();parent=this.m_editWin.getContentParent();}
else{parent=this.m_parent;this.removeDOM();}
for(var key_id in keys){this.m_editViewObj.setReadIdValue(key_id,keys[key_id]);}
this.m_editViewObj.readData(this.m_asyncEditRead,isCopy);this.m_editViewObj.m_replacedNode=replaced_node;this.m_editRowId=rowId;this.m_editViewObj.toDOM(parent);this.setGlobalWait(false);}
GridDbDOC.prototype.onCopy=function(rowId,keys){this.onEdit(rowId,keys,true);} 
function GridDbDOCT(id,options){options=options||{};this.m_onModified=options.onModified;this.m_onDelete=options.onDelete;options.asyncEditRead=false;GridDbDOCT.superclass.constructor.call(this,id,options);}
extend(GridDbDOCT,GridDb);GridDbDOCT.prototype.viewId;GridDbDOCT.prototype.onDelete=function(rowId,keys){var self=this;GridDbDOCT.superclass.onDelete.call(this,rowId,keys,function(){if(self.m_onDelete)self.m_onDelete.call(self);});}
GridDbDOCT.prototype.destroyEditViewObj=function(){var mod=(this.m_editViewObj&&this.m_editViewObj.m_objModified);var self=this;GridDbDOCT.superclass.destroyEditViewObj.call(this);if(self.m_onModified){self.m_onModified();}}
GridDbDOCT.prototype.setViewId=function(id){this.m_viewId=id;this.m_methParams=this.m_methParams||{};this.m_methParams.view_id=id;var contr=this.getController();if(contr==undefined){return;}
contr.getPublicMethodById(this.getReadMethodId()).setParamValue("view_id",id);contr.getPublicMethodById("insert").setParamValue("view_id",id);contr.getPublicMethodById("update").setParamValue("view_id",id);contr.getPublicMethodById("delete").setParamValue("view_id",id);}
GridDbDOCT.prototype.getViewId=function(){return this.m_viewId;}
GridDbDOCT.prototype.onInsert=function(){if(this.m_editViewObj){return 0;}
this.setGlobalWait(true);var contr_id=this.getController().getId();var contr=new window[contr_id](this.getController().getServConnector());var pm=contr.getInsert();this.paramsToMethod(pm);this.initEditViewObj(contr);var parent;if(this.getEditInline()){parent=this.getBody().m_node;}
else if(this.m_editWinClass){this.m_editWin=new this.m_editWinClass({"view":this.m_editViewObj,"title":this.m_editViewObj.getFormCaption()+":Новый","width":this.m_editViewObj.getFormWidth(),"height":this.m_editViewObj.getFormHeight()});this.m_editWin.open();this.m_editViewObj.setWinObj(this.m_editWin);parent=this.m_editWin.getContentParent();}
else{parent=this.m_parent;this.removeDOM();}
this.m_editViewObj.toDOM(parent);if(this.m_viewId&&this.m_editViewObj.m_dataControls&&this.m_editViewObj.m_dataControls[this.m_editViewObj.getId()+"view_id"]){this.m_editViewObj.m_dataControls[this.m_editViewObj.getId()+"view_id"].setValue(this.m_viewId);}
this.setDefFilterValues();GridDbDOCT.superclass.onInsert.call(this);this.setGlobalWait(false);} 
function GridDbConst(id,options){options=options||{};GridDbConst.superclass.constructor.call(this,id,options);this.m_editViewClasses=options.editViewClasses;}
extend(GridDbConst,GridDb);GridDbConst.prototype.onEdit=function(rowId,keys){if(this.m_editViewClasses[keys["id"]]){this.m_editViewClass=this.m_editViewClasses[keys["id"]];}
else{this.m_editViewClass=ConstInline_View;}
var nodes={parent:null,replaced_node:null};this.prepareEdit(rowId,keys,nodes);this.m_editViewObj.readData(this.m_asyncEditRead);this.m_editViewObj.m_replacedNode=nodes.replaced_node;this.m_editViewObj.toDOM(nodes.parent,nodes.replaced_node);} 
function ViewInlineGridEditConst(id,options){options.updateMethodId="set_value";ViewInlineGridEditConst.superclass.constructor.call(this,id,options);this.addDataControl(new EditString("ConstantList_Model_id",{"visible":false,"alwaysUpdate":true,"attrs":{"name":"id"}}),{"modelId":"ConstantList_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new EditString("ConstantList_Model_name",{"attrs":{"size":20,"disabled":"disabled","name":"name"}}),{"modelId":"ConstantList_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});this.addDataControl(new EditString("ConstantList_Model_descr",{"attrs":{"size":100,"disabled":"disabled","name":"descr"}}),{"modelId":"ConstantList_Model","valueFieldId":"descr","keyFieldIds":null},{"valueFieldId":"descr","keyFieldIds":null});}
extend(ViewInlineGridEditConst,ViewInlineGridEdit); 
function GridDbMasterDetail(id,options){options=options||{};GridDbMasterDetail.superclass.constructor.call(this,id,options);this.m_detailListView=options.detailListView;this.m_detailReadModelId=options.detailReadModelId;this.m_detailController=options.detailController;this.m_details={};this.m_masterIdCols=options.masterIdCols;this.m_detailExpandedCount=0;}
extend(GridDbMasterDetail,GridDb);GridDbMasterDetail.prototype.m_details;GridDbMasterDetail.prototype.m_detailKeys;GridDbMasterDetail.prototype.m_detailExpandedCount;GridDbMasterDetail.prototype.IMG_COLLAPSED="img/treeview/plus.gif";GridDbMasterDetail.prototype.IMG_EXPANDED="img/treeview/minus.gif";GridDbMasterDetail.prototype.onRefresh=function(){var self=this;var contr=this.getController();var meth=this.getReadMethodId();var pm;this.deleteAllDetails();var pag=this.getPagination();if(pag){pm=contr.getPublicMethodById(meth);pm.setParamValue(contr.PARAM_FROM,pag.getFrom());pm.setParamValue(contr.PARAM_COUNT,pag.getCountPerPage());}
var filter=this.getFilter();if(filter){if(!pm){pm=contr.getPublicMethodById(meth);}
var struc={"fields":null,"signs":null,"vals":null,"icase":null};filter.getParams(struc);pm.setParamValue(contr.PARAM_COND_FIELDS,struc.fields);pm.setParamValue(contr.PARAM_COND_SGNS,struc.signs);pm.setParamValue(contr.PARAM_COND_VALS,struc.vals);pm.setParamValue(contr.PARAM_COND_ICASE,struc.icase);}
for(var col in this.m_sortCols){var sort=this.m_sortCols[col].getAttr("sort");if(sort=="asc"||sort=="desc"){pm.setParamValue(contr.PARAM_ORD_FIELDS,this.m_sortCols[col].getAttr("field_id"));pm.setParamValue(contr.PARAM_ORD_DIRECTS,sort);}}
this.m_lastWriteResult=true;this.m_errorControl.setValue("");contr.runPublicMethod(meth,{},true,this.onGetData,this,this.onError);}
GridDbMasterDetail.prototype.onDetails=function(rowId,keys){var key_str="";for(var id in keys){key_str+=(key_str=="")?"":"_";key_str+=keys[id];}
var row_node=nd(rowId);if(this.m_details[key_str]==undefined){this.addDetail(row_node,keys,key_str);}
else{this.deleteDetail(this.m_details[key_str]);delete this.m_details[key_str];if(isEmpty(this.m_details)){this.setRefreshInterval(this.m_refreshIntervalCopy);}}}
GridDbMasterDetail.prototype.addDetail=function(rowNode,keyAr,keyStr){this.m_refreshIntervalCopy=this.getRefreshInterval();this.setRefreshInterval(0);this.m_details[keyStr]={};var connect=this.m_controller.getServConnector();this.m_details[keyStr].viewObj=new this.m_detailListView(rowNode.id+"_detail",{"readController":new this.m_detailController(connect),"readModelId":this.m_detailReadModelId,"connect":connect,"masterKeys":keyAr});this.m_details[keyStr].keyAr=keyAr;this.m_details[keyStr].rowNode=document.createElement("tr");this.m_details[keyStr].rowNode.setAttribute("class","grid_details");this.m_details[keyStr].viewObj.toDOM(this.m_details[keyStr].rowNode);rowNode.parentNode.insertBefore(this.m_details[keyStr].rowNode,rowNode.nextSibling)
var td=rowNode.getElementsByTagName("td");if(td){var img=td[0].getElementsByTagName("img");if(img){img[0].src=this.IMG_EXPANDED;}}
this.m_detailExpandedCount++;}
GridDbMasterDetail.prototype.deleteDetail=function(detail){detail.viewObj.removeDOM();delete detail.viewObj;var row_node=detail.rowNode;if(row_node.previousSibling){var td=row_node.previousSibling.getElementsByTagName("td");if(td){var img=td[0].getElementsByTagName("img");if(img){img[0].src=this.IMG_COLLAPSED;}}
row_node.parentNode.removeChild(row_node);this.m_detailExpandedCount--;}}
GridDbMasterDetail.prototype.deleteAllDetails=function(){this.m_detailKeys={};for(var id in this.m_details){this.m_detailKeys[id]=this.m_details[id].keyAr;this.deleteDetail(this.m_details[id]);}
this.m_details={};this.m_detailExpandedCount=0;}
GridDbMasterDetail.prototype.restoreAllDetails=function(){if(this.m_detailKeys==undefined){return;}
var id_ar;for(var id in this.m_detailKeys){id_ar=this.m_detailKeys[id];var rows=this.m_node.childNodes[1].childNodes;var found=false;for(var row_ind=0;row_ind<rows.length;row_ind++){for(id_ar_id in id_ar){var col_num=this.m_masterIdCols[id_ar_id];if(rows[row_ind].childNodes[col_num].childNodes[0].nodeValue==id_ar[id_ar_id]){this.addDetail(rows[row_ind],id_ar,id);found=true;break;}}
if(found){break;}}}
delete this.m_detailKeys;}
GridDbMasterDetail.prototype.onGetData=function(resp){var model=resp.getModelById(this.getReadModelId());model.setActive(true);var head_cells={};this.getHead().getFields(head_cells);var body=this.getBody();body.removeDOM();body.clear();var bind,keys,field_count,row_count=0;var pag=this.getPagination();if(pag){pag.setCountTotal(model.getTotCount());}
if(this.m_onSelect){this.m_selects={};var set_select=function(grid,node,keys,descrs){EventHandler.addEvent(node,"dblclick",function(){grid.m_onSelect.call(null,keys,descrs);},true);}}
var row;var row_tot_count=model.getRowCount();while(model.getNextRow()){var row_id=this.getId()+"_row_"+row_count;var row_class="";if(row_count%2==0){row_class="even";}
else{row_class="odd";}
if(this.m_onSelect){row_class+=" for_select";}
row=new GridRow(row_id,{"className":row_class});var keyValues={};var descrValues={};field_count=0;var detail_td;if(row_tot_count==(row_count+1)&&this.m_lastRowFooter){detail_td=new Control(null,"td");}
else{detail_td=new DetailRowCommand(null,{"onClick":this.onDetails,"rowId":row_id,"keys":keyValues,"clickContext":this,"imageCollapsed":this.IMG_COLLAPSED,attrs:{"class":"grid_sys_col"}});}
row.setElementById("details",detail_td);for(var head_id in head_cells){bind=head_cells[head_id].getReadBind();if(!bind)continue;keys=bind.keyFieldIds;attrs=null;if(head_cells[head_id].getKeyCol()){keyValues[bind.valueFieldId]=model.getFieldById(bind.valueFieldId).getValue();}
if(head_cells[head_id].getDescrCol()){descrValues[bind.valueFieldId]=model.getFieldById(bind.valueFieldId).getValue();}
attrs={};if(keys){for(var key_ind=0;key_ind<keys.length;key_ind++){attrs["fkey_"+keys[key_ind]]=model.getFieldById(keys[key_ind]).getValue();}}
var common_attrs=head_cells[head_id].getColAttrs();if(common_attrs){for(common_attr_id in common_attrs){attrs[common_attr_id]=common_attrs[common_attr_id];}}
row.setElementById("field"+field_count,new GridCell(null,{"value":model.getFieldById(bind.valueFieldId).getValue(),"attrs":attrs,"accocImageArray":head_cells[head_id].getAssocImageArray()}));field_count++;}
row.setAttr("key_values",array2json(keyValues));var row_cmd_class=this.getRowCommandPanelClass();if(row_cmd_class){row.setElementById("sys",new row_cmd_class(null,{"onClickEdit":this.onEdit,"onClickDelete":this.onDelete,"rowId":row_id,"keys":keyValues,"clickContext":this}));}
body.setElementById(row_count,row);row_count++;if(this.m_onSelect){this.m_selects[row_id]=new set_select(this,row.m_node,keyValues,descrValues);}}
if(this.m_lastRowFooter&&row){DOMHandler.addClass(row.m_node,"grid_foot");}
body.toDOM(this.m_node);this.restoreAllDetails();if(this.m_onEventRefresh){this.m_onEventRefresh.call(this.m_eventContext,resp);}
if(this.m_navigate){this.setSelection();}}
GridDbMasterDetail.prototype.getDetailExpandedCount=function(){return this.m_detailExpandedCount;}
function DetailRowCommand(id,options){options=options||{};var tagName=options.tagName||this.DEF_TAG_NAME;DetailRowCommand.superclass.constructor.call(this,id,tagName,options);var self=this;if(options.onClick){this.setElementById("edit",new Button(null,{"image":{"src":options.imageCollapsed},"onClick":function(){options.onClick.call(options.clickContext,options.rowId,options.keys);}}));}}
extend(DetailRowCommand,ControlContainer);DetailRowCommand.prototype.DEF_TAG_NAME="td"; 
function GridHead(id,options){options=options||{};GridHead.superclass.constructor.call(this,id,this.DEF_TAG_NAME,options);}
extend(GridHead,ControlContainer);GridHead.prototype.DEF_TAG_NAME="thead";GridHead.prototype.getFields=function(fields){for(var row_id in this.m_elements){var row_fields=this.m_elements[row_id].m_elements;for(var field_id in row_fields){if(row_fields[field_id].m_colSpanArray){for(var i=0;i<row_fields[field_id].m_colSpanArray.length;i++){fields[row_fields[field_id].m_colSpanArray[i].getId()]=row_fields[field_id].m_colSpanArray[i];}}
else{fields[field_id]=row_fields[field_id];}}}} 
function GridFoot(id,options){options=options||{};GridFoot.superclass.constructor.call(this,id,this.DEF_TAG_NAME,options);}
extend(GridFoot,ControlContainer);GridFoot.prototype.DEF_TAG_NAME="tfoot";GridFoot.prototype.calc=function(model){for(var id in this.m_elements){if(this.m_elements[id].calc){this.m_elements[id].calc(model);}}}
GridFoot.prototype.calcBegin=function(){for(var id in this.m_elements){if(this.m_elements[id].calcBegin){this.m_elements[id].calcBegin();}}}
GridFoot.prototype.calcEnd=function(){for(var id in this.m_elements){if(this.m_elements[id].calcEnd){this.m_elements[id].calcEnd();}}}
GridFoot.prototype.init=function(){this.calcBegin();} 
function GridBody(id,options){options=options||{};options.tagName=options.tagName||this.DEF_TAG_NAME;GridBody.superclass.constructor.call(this,id,options.tagName,options);}
extend(GridBody,ControlContainer);GridBody.prototype.DEF_TAG_NAME="tbody"; 
function GridRow(id,options){options=options||{};options.tagName=options.tagName||this.DEF_TAG_NAME;GridRow.superclass.constructor.call(this,id,options.tagName,options);}
extend(GridRow,ControlContainer);GridRow.prototype.DEF_TAG_NAME="tr";GridRow.prototype.m_initCells;GridRow.prototype.setInitColumnOrder=function(){this.m_initCells={};for(var id in this.m_elements){this.m_initCells[id]=clone(this.m_elements[id]);}}
GridRow.prototype.setColumnOrder=function(orderArray){this.m_elements={};for(var i=0;i<orderArray.length;i++){if(!orderArray[i].checked)continue;for(var id in this.m_initCells){if(this.m_initCells[id].getName()==orderArray[i].id){this.m_elements[id]=this.m_initCells[id];break;}}}
for(var id in this.m_initCells){if(!this.m_initCells[id].getVisible()&&!orderArray[this.m_initCells[id].getName()]){this.m_elements[id]=this.m_initCells[id];}}} 
function GridFootRow(id,options){options=options||{};options.attrs=options.attrs||{};options.attrs["class"]=options.attrs["class"]||"grid_foot";GridFootRow.superclass.constructor.call(this,id,options);}
extend(GridFootRow,GridRow);GridFootRow.prototype.calc=function(model){for(var cell_id in this.m_elements){if(this.m_elements[cell_id].calc){this.m_elements[cell_id].calc(model);}}}
GridFootRow.prototype.calcBegin=function(){for(var cell_id in this.m_elements){if(this.m_elements[cell_id].calcBegin){this.m_elements[cell_id].calcBegin();}
else if(this.m_elements[cell_id].calc){this.m_elements[cell_id].setValue("0");}}}
GridFootRow.prototype.calcEnd=function(){for(var cell_id in this.m_elements){if(this.m_elements[cell_id].calcEnd){this.m_elements[cell_id].calcEnd();}}} 
function GridRowDOC(id,options){options=options||{};GridRowDOC.superclass.constructor.call(this,id,options);this.addElement(new GridDbHeadCell(id+"_col_id",{"value":"Код","readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));this.addElement(new GridDbHeadCell(id+"_col_date_time_descr",{"value":"Дата","readBind":{"valueFieldId":"date_time_descr"},"descrCol":true,"sortable":true,"sort":"asc"}));this.addElement(new GridDbHeadCell(id+"_col_number",{"value":"Номер","readBind":{"valueFieldId":"number"},"descrCol":true,"colAttrs":{"align":"center"},"sortable":true}));}
extend(GridRowDOC,GridRow);GridRowDOC.prototype.STATE_PRCESSED="img/doc/processed.png";GridRowDOC.prototype.STATE_UNPRCESSED="img/doc/unprocessed.png"; 
function GridRowDOCT(id,options){options=options||{};GridRowDOCT.superclass.constructor.call(this,id,options);this.addElement(new GridDbHeadCell(id+"_col_view_id",{"readBind":{"valueFieldId":"view_id"},"keyCol":true,"visible":false}));this.addElement(new GridDbHeadCell(id+"_col_line_number",{"value":"№","readBind":{"valueFieldId":"line_number"},"keyCol":true,"colAttrs":{"align":"center"}}));}
extend(GridRowDOCT,GridRow); 
function GridCell(id,options){options=options||{};var tag_name=options.tagName||this.DEF_TAG_NAME;GridCell.superclass.constructor.call(this,id,tag_name,options);if(options.accocImageArray){this.m_accocImageArray=options.accocImageArray;}
if(options.colSpanArray){this.m_colSpanArray=options.colSpanArray;}
if(options.controlContainer){this.m_controlContainer=options.controlContainer;}
if(options.image){this.setImage(options.image);}
if(options.colSpan){this.setColSpan(options.colSpan);}
if(options.rowSpan){this.setRowSpan(options.rowSpan);}
if(options.value){this.setValue(options.value);}}
extend(GridCell,ControlContainer);GridCell.prototype.DEF_TAG_NAME="td";GridCell.prototype.setImage=function(image){this.m_image=image;}
GridCell.prototype.setColSpan=function(colSpan){this.setAttr("colspan",colSpan);}
GridCell.prototype.setRowSpan=function(rowSpan){this.setAttr("rowspan",rowSpan);}
GridCell.prototype.setValue=function(value){if(this.m_accocImageArray&&this.m_accocImageArray[value]){this.setImage(new Control(null,"img",{attrs:{src:this.m_accocImageArray[value]}}));if(this.m_node.childNodes){this.m_node.childNodes[0].nodeValue="";}}
else if(this.m_controlContainer){this.m_controlContainer.setValue(value);}
else{GridCell.superclass.setValue.call(this,value);}}
GridCell.prototype.toDOM=function(parent){GridCell.superclass.toDOM.call(this,parent);if(this.m_image){this.m_image.toDOM(this.m_node);}
if(this.m_controlContainer){this.m_controlContainer.toDOM(this.m_node);}}
GridCell.prototype.removeDOM=function(){GridCell.superclass.removeDOM.call(this);if(this.m_controlContainer){this.m_controlContainer.removeDOM();}}
GridCell.prototype.setControlContainer=function(cont){this.m_controlContainer=cont;} 
function GridFootCell(id,options){options=options||{};GridFootCell.superclass.constructor.call(this,id,options);if(options.calc){this.calc=options.calc;}
if(options.calcBegin){this.calcBegin=options.calcBegin;}
if(options.calcEnd){this.calcEnd=options.calcEnd;}}
extend(GridFootCell,GridCell); 
function GridCellStepInc(id,options){options=options||{};GridCellStepInc.superclass.constructor.call(this,id,options);var self=this;this.m_step=options.step||this.DEFAULT_STEP;this.m_onClickInc=options.onClickInc;this.m_onClickDec=options.onClickDec;this.m_incControl=new ControlContainer(id+"_step_inc","div",{"className":"btns_cont"});this.m_incControl.addElement(new Button(id+"_step_inc_inc",{caption:"+",onClick:function(ev){if(self.m_onClickInc){self.m_onClickInc(self,EventHandler.fixMouseEvent(ev));}
else{self.setValue(parseFloat(self.getValue())+self.m_step);}}}));this.m_incControl.addElement(new Button(id+"_step_inc_dec",{caption:"-",onClick:function(ev){if(self.m_onClickDec){self.m_onClickDec(self,EventHandler.fixMouseEvent(ev));}
else{self.setValue(parseFloat(self.getValue())-self.m_step);}}}));}
extend(GridCellStepInc,GridCell);GridCellStepInc.prototype.DEFAULT_STEP=1;GridCellStepInc.prototype.toDOM=function(parent){GridCellStepInc.superclass.toDOM.call(this,parent);this.m_incControl.toDOM(this.m_node);}
GridCellStepInc.prototype.removeDOM=function(){this.m_incControl.removeDOM(this.m_node);GridCellStepInc.superclass.removeDOM.call(this);}
GridCellStepInc.prototype.setValue=function(value){if(!this.m_incControl){GridCellStepInc.superclass.setValue.call(this,value);}
else{this.m_node.removeChild(this.m_node.firstChild);this.m_node.insertBefore(document.createTextNode(value),this.m_incControl.m_node);}} 
function GridHeadCell(id,options){options=options||{};options.tagName=options.tagName||this.DEF_TAG_NAME;this.m_fieldValueToRowClass=options.fieldValueToRowClass;if(options.visible!=undefined&&!options.visible){options.attrs=options.attrs||{};options.colAttrs=options.colAttrs||{};options.attrs["class"]="invisible";options.colAttrs["class"]="invisible";}
if(options.sortable){this.m_sortable=true;options.attrs=options.attrs||{};var node_class=options.attrs["class"];node_class=node_class||"";if(node_class.length){node_class+=" ";}
options.attrs["title"]="упорядочить";options.attrs["class"]=node_class+this.SORT_CLASS;if(options.sort){options.attrs["sort"]=options.sort;}
if(options.sortCol){options.attrs["sortCol"]=options.sortCol;}}
GridHeadCell.superclass.constructor.call(this,id,options);this.m_keyCol=options.keyCol||false;this.m_descrCol=options.descrCol||false;if(options.colAttrs){this.m_colAttrs=options.colAttrs;}
if(options.colControlContainer){this.m_colControlContainer=options.colControlContainer;}
this.m_node.align=options.align||"center";if(options.assocImageArray){this.m_assocImageArray=options.assocImageArray;}
var self=this;this.m_sorting=function(event){event=EventHandler.fixMouseEvent(event);var th;if(event.target.nodeName.toLowerCase()=="th"){th=event.target;}
else{th=DOMHandler.getParentByTagName(event.target,"th");}
if(th){var new_direct;var sort=th.getAttribute("sort");if(sort==self.SORT_UP){new_direct=self.SORT_DOWN;th.setAttribute("sort",self.SORT_DOWN);var imgs=th.getElementsByTagName("img");if(imgs&&imgs.length){imgs[0].src=self.SORT_IMG_DOWN;}
if(self.m_onRefresh){self.m_onRefresh();}}
else if(sort==self.SORT_DOWN){new_direct=self.SORT_UP;th.setAttribute("sort",self.SORT_UP)
var imgs=th.getElementsByTagName("img");if(imgs&&imgs.length){imgs[0].src=self.SORT_IMG_UP;}
if(self.m_onRefresh){self.m_onRefresh();}}
else{var trs=th.parentNode.childNodes;for(var i=0;i<trs.length;i++){if(trs[i].getAttribute("sort")){DOMHandler.removeAttr(trs[i],"sort");var imgs=trs[i].getElementsByTagName("img");if(imgs&&imgs.length){DOMHandler.removeNode(imgs[0]);}}}
self.setSortable();new_direct=self.SORT_UP;self.setSort(self.SORT_UP);if(self.m_onRefresh){self.m_onRefresh();}}
if(self.m_grid&&TEMPLATE_PARAMS){var name=self.m_grid.getName();var col_name=self.getName();if(!TEMPLATE_PARAMS[name]){TEMPLATE_PARAMS[name]={"order":[],"visibility":[]};}
else if(!TEMPLATE_PARAMS[name].order){TEMPLATE_PARAMS[name].order=[];}
if(!TEMPLATE_PARAMS[name].order.length){var head=self.m_grid.getHead();for(var row in head.m_elements){var head_row=head.m_elements[row];for(var col in head_row.m_elements){if(head_row.m_elements[col].getSortable()){var f_name=head_row.m_elements[col].getName();TEMPLATE_PARAMS[name].order.push({"id":f_name,"descr":head_row.m_elements[col].getValue(),"checked":false,"direct":undefined});}}}}
for(var i=0;i<TEMPLATE_PARAMS[name].order.length;i++){if(TEMPLATE_PARAMS[name].order[i].id==col_name){TEMPLATE_PARAMS[name].order[i].checked=true;TEMPLATE_PARAMS[name].order[i].direct=new_direct;}
else{TEMPLATE_PARAMS[name].order[i].checked=false;}}
var contr=new TemplateParam_Controller(new ServConnector(HOST_NAME));contr.run("set_value",{"params":{"template":name,"param":"order","val":array2json(TEMPLATE_PARAMS[name].order)},"errControl":null,"func":null});}}}}
extend(GridHeadCell,GridCell);GridHeadCell.prototype.SORT_IMG_UP="img/sorting/up-triangle.gif";GridHeadCell.prototype.SORT_IMG_DOWN="img/sorting/down-triangle.gif";GridHeadCell.prototype.SORT_UP="asc";GridHeadCell.prototype.SORT_DOWN="desc";GridHeadCell.prototype.SORT_CLASS="sortable";GridHeadCell.prototype.DEF_TAG_NAME="th";GridHeadCell.prototype.m_keyCol;GridHeadCell.prototype.m_descrCol;GridHeadCell.prototype.m_onRefresh;GridHeadCell.prototype.getKeyCol=function(){return this.m_keyCol;}
GridHeadCell.prototype.getDescrCol=function(){return this.m_descrCol;}
GridHeadCell.prototype.getColAttrs=function(){return this.m_colAttrs;}
GridHeadCell.prototype.getColControlContainer=function(){return this.m_colControlContainer;}
GridHeadCell.prototype.getAssocImageArray=function(){return this.m_assocImageArray;}
GridHeadCell.prototype.setSortable=function(){EventHandler.addEvent(this.m_node,"click",this.m_sorting,true);}
GridHeadCell.prototype.getSortable=function(){return this.m_sortable;}
GridHeadCell.prototype.unsetSort=function(){var imgs=this.m_node.getElementsByTagName("img");if(imgs&&imgs.length){DOMHandler.removeNode(imgs[0]);}
DOMHandler.removeAttr(this.m_node,"sort");}
GridHeadCell.prototype.setSort=function(sort){var img_src=(sort==this.SORT_UP)?this.SORT_IMG_UP:this.SORT_IMG_DOWN;var img_alt=(sort==this.SORT_UP)?"в":"н";var img=DOMHandler.createImgElement(img_src,img_alt);var divs=this.m_node.getElementsByTagName("div");var parent=this.m_node;if(divs&&divs.length){parent=divs[0];}
var imgs=parent.getElementsByTagName("img");if(imgs&&imgs.length){DOMHandler.removeNode(imgs[0]);}
parent.appendChild(img);this.setAttr("sort",sort);}
GridHeadCell.prototype.toDOM=function(parent){GridHeadCell.superclass.toDOM.call(this,parent);if(DOMHandler.hasClass(this.m_node,this.SORT_CLASS)){var sort=this.getAttr("sort");if(sort){this.setSort(sort);}
this.setSortable();}}
GridHeadCell.prototype.removeDOM=function(){if(this.m_sortable){EventHandler.removeEvent(this.m_node,"click",this.m_sorting,true);}
GridHeadCell.superclass.removeDOM.call(this);} 
function GridDbHeadCell(id,options){options=options||{};options.tagName=options.tagName||this.DEF_TAG_NAME;if(options.readBind){if(options.readBind.valueFieldId){options.attrs=options.attrs||{};options.attrs["field_id"]=options.readBind.valueFieldId;options.colAttrs=options.colAttrs||{};options.colAttrs["field_id"]=options.readBind.valueFieldId;}
this.setReadBind(options.readBind);}
this.getDbValue=options.getDbValue;if(options.controls){this.setControls(options.controls);}
GridDbHeadCell.superclass.constructor.call(this,id,options);}
extend(GridDbHeadCell,GridHeadCell);GridDbHeadCell.prototype.m_readBind;GridDbHeadCell.prototype.setReadBind=function(readBind){this.m_readBind=readBind;}
GridDbHeadCell.prototype.getReadBind=function(){return this.m_readBind;}
GridDbHeadCell.prototype.getCellClass=function(){return GridCell;}
GridDbHeadCell.prototype.getName=function(){if(this.m_readBind){return this.m_readBind.valueFieldId;}
else{return GridDbHeadCell.superclass.getName.call(this);}} 
function GridDbHeadCellBool(id,options){options=options||{};options.assocImageArray=options.assocImageArray||{"true":"img/bool/true.png","false":"img/bool/false.png"};options.colAttrs=options.colAttrs||{"align":"center"};GridDbHeadCellBool.superclass.constructor.call(this,id,options);}
extend(GridDbHeadCellBool,GridDbHeadCell); 
function GridDbHeadSysCell(id,options){options=options||{};options.value=options.value||this.DEF_VALUE;options.attrs=options.attrs||{};options.attrs["class"]=options.attrs["class"]||this.DEF_CLASS;GridDbHeadSysCell.superclass.constructor.call(this,id,options);}
extend(GridDbHeadSysCell,GridDbHeadCell);GridDbHeadSysCell.prototype.DEF_VALUE="...";GridDbHeadSysCell.prototype.DEF_CLASS="grid_sys_col"; 
function GridFilter(id,options){options=options||{};var tagName=options.tagName||this.DEF_TAG_NAME;options.className=options.className||this.DEF_CLASS_NAME;GridFilter.superclass.constructor.call(this,id,tagName,options);if(options.onRefresh){this.setOnRefresh(options.onRefresh);}
if(options.clickContext){this.setClickContext(options.clickContext);}
var self=this;this.m_filter=new ListFilter();this.m_commandControls={};if(!TEMPLATE_PARAMS[id]){TEMPLATE_PARAMS[id]={};}
if(options.noSetControl==undefined||(options.noSetControl!=undefined&&options.noSetControl==false)){this.m_setControl=new ButtonCmd(null,{"caption":options.setControlCaption||this.DEF_SET_CTRL_CAP,"attrs":{"title":"установить отбор"},"onClick":function(){var id=self.getId();for(var ctrl_id in self.m_elements){TEMPLATE_PARAMS[id][ctrl_id]=self.m_elements[ctrl_id].serialize();}
self.refresh();}});}
if(!options.noUnsetControl||(options.noUnsetControl!=undefined&&options.noUnsetControl==false)){this.m_unsetControl=new ButtonCmd(null,{"caption":options.unsetControlCaption||this.DEF_UNSET_CTRL_CAP,"attrs":{"title":"отменить отбор"},"onClick":function(){self.resetValues();}});}
if(options.noToggleControl==undefined||(options.noToggleControl!=undefined&&options.noToggleControl==false)){this.m_btnToggle=new ButtonCtrl(uuid(),{"attrs":{"data-toggle":"collapse","data-target":("#"+this.getId())},"caption":options.toggleBtnCaption||"Отбор","glyph":"glyphicon-triangle-bottom"});}}
extend(GridFilter,ControlContainer);GridFilter.prototype.DEF_TAG_NAME="form";GridFilter.prototype.DEF_CLASS_NAME="form-horizontal collapse";GridFilter.prototype.DEF_SET_CTRL_CAP="Применить";GridFilter.prototype.DEF_UNSET_CTRL_CAP="Сбросить";GridFilter.prototype.m_onRefresh;GridFilter.prototype.m_clickContext;GridFilter.prototype.m_setControl;GridFilter.prototype.m_unsetControl;GridFilter.prototype.m_filter;GridFilter.prototype.setOnRefresh=function(onRefresh){this.m_onRefresh=onRefresh;}
GridFilter.prototype.setClickContext=function(clickContext){this.m_clickContext=clickContext;}
GridFilter.prototype.toDOM=function(parent){if(this.m_btnToggle)this.m_btnToggle.toDOM(parent);GridFilter.superclass.toDOM.call(this,parent);if(this.m_setControl){this.m_setControl.toDOM(this.getNode());}
if(this.m_unsetControl){this.m_unsetControl.toDOM(this.getNode());}
for(var id in this.m_commandControls){this.m_commandControls[id].toDOM(this.getNode());}}
GridFilter.prototype.removeDOM=function(){if(this.m_btnToggle)this.m_btnToggle.removeDOM();if(this.m_setControl){this.m_setControl.removeDOM();}
if(this.m_unsetControl){this.m_unsetControl.removeDOM();}
for(var id in this.m_commandControls){this.m_commandControls[id].removeDOM();}
GridFilter.superclass.removeDOM.call(this);}
GridFilter.prototype.addFilterControl=function(control,filter){var ctrl_id=control.getId();var id=this.getId();if(TEMPLATE_PARAMS[id]&&TEMPLATE_PARAMS[id][ctrl_id]){control.unserialize(TEMPLATE_PARAMS[id][ctrl_id]);}
this.m_filter.addFilter(ctrl_id,filter);this.addElement(control);}
GridFilter.prototype.getFilterControlById=function(id){return this.m_filter.getFilterById(id);}
GridFilter.prototype.unsetFilterControlById=function(id){this.m_filter.unsetFilterById(id);}
GridFilter.prototype.getParams=function(struc){for(var ctrl_id in this.m_elements){var keys=this.m_filter.m_params[ctrl_id].keyFieldIds;if(keys){for(var i=0;i<keys.length;i++){var key;if(this.m_elements[ctrl_id].getFieldValue){key=this.m_elements[ctrl_id].getFieldValue(keys[i]);}
else{key=this.m_elements[ctrl_id].getAttr("fkey_"+keys[i]);}
this.m_filter.m_params[ctrl_id].key=key;}}
this.m_filter.m_params[ctrl_id].descr=this.m_elements[ctrl_id].getValue();}
this.m_filter.getParams(struc);}
GridFilter.prototype.setFocus=function(){for(var elem_id in this.m_elements){this.m_elements[elem_id].m_node.focus();break;}}
GridFilter.prototype.unsetGridFromParam=function(grid){if(grid.m_controller&&grid.m_pagination){grid.m_pagination.setFrom(0);}}
GridFilter.prototype.addCommandControl=function(control){this.m_commandControls[control.getId()]=control;}
GridFilter.prototype.refresh=function(){var grid=this.m_clickContext;if(grid){this.unsetGridFromParam(grid);this.m_onRefresh.call(grid);}}
GridFilter.prototype.resetValues=function(){var params=this.m_filter.m_params;var id=this.getId();for(var ctrl_id in params){this.m_elements[ctrl_id].resetValue();TEMPLATE_PARAMS[id][ctrl_id]=undefined;}
this.refresh();} 
function GridFastFilter(id,options){options=options||{};options.tagName="div";options.noSetControl=true;options.noUnsetControl=true;options.noToggleControl=true;options.className="row fast-filter";GridFastFilter.superclass.constructor.call(this,id,options);var self=this;this.m_btnClearFilter=new ButtonCtrl(null,{"glyph":"glyphicon-remove","attrs":{"title":"сбросить фильтр"},"onClick":function(){self.resetValues();}});}
extend(GridFastFilter,GridFilter);GridFastFilter.prototype.toDOM=function(parent){if(this.getCount()>1)this.m_btnClearFilter.toDOM(this.m_node);GridFastFilter.superclass.toDOM.call(this,parent);}
GridFastFilter.prototype.addFilterControl=function(control,filter){var self=this;if(control.resetValue){control.m_origResetValue=control.resetValue;control.resetValue=function(noRefresh){control.m_origResetValue.call(control);if(noRefresh==undefined){self.refresh();}}}
if(control.getEditMask&&!control.getEditMask()&&control.getNode().nodeName.toLowerCase()=="input"){var attr=control.getAttr("type");if(attr=="text"){control.m_events={"keyup":function(){self.refresh();}};}}
GridFastFilter.superclass.addFilterControl.call(this,control,filter);}
GridFastFilter.prototype.resetValues=function(){var params=this.m_filter.m_params;for(var ctrl_id in params){this.m_elements[ctrl_id].resetValue(true);}
this.refresh();} 
function GridFilterDocument(id,options){options=options||{};GridFilterDocument.superclass.constructor.call(this,id,options);this.addFilterControl(new EditPeriodFrom(id+"_filter_date_from"),{"sign":"ge","valueFieldId":"date_time"});this.addFilterControl(new EditPeriodTo(id+"_filter_date_to"),{"sign":"le","valueFieldId":"date_time"});}
extend(GridFilterDocument,GridFilter); 
function GroupFields(id,options){options=options||{};options.className=options.className||this.DEF_CLASS_NAME;GroupFields.superclass.constructor.call(this,id,"ul",options);var self=this;this.addElement(new Control(id+"_title","div",{"value":"Группировки"}));this.addElement(new Button(id+"_grp_on",{"image":{"src":this.IMG_ALL_ON,"alt":"Вкл."},"onClick":function(){self.toggleAllParams(true);}}));this.addElement(new Button(id+"_grp_off",{"image":{"src":this.IMG_ALL_OFF,"alt":"Выкл."},"onClick":function(){self.toggleAllParams(false);}}));this.m_groupper=new ListGroupper();}
extend(GroupFields,ControlContainer);GroupFields.prototype.DEF_CLASS_NAME='groupper';GroupFields.prototype.m_groupper;GroupFields.prototype.toggleAllParams=function(val){var n,new_val;for(var ind=0;ind<this.m_groupper.m_params.length;ind++){if(val!=undefined){new_val=val;}
else{new_val=!this.m_groupper.m_params[ind].isset;}
this.m_groupper.m_params[ind].isset=new_val;n=nd(this.m_groupper.m_params[ind].field+"_grp_toggle");if(n){n.checked=new_val;}}}
GroupFields.prototype.addGroup=function(group){this.m_groupper.addGroup(group.field,group);var cont=new ControlContainer(group.field+"_grp_cont","li",{"attrs":{"grp_ind":group.ind}});var self=this;var ctrl_check=new EditCheckBox(group.field+"_grp_toggle",{"checked":group.isset,"attrs":{"grp_ind":group.ind}});EventHandler.addEvent(ctrl_check.m_node,"click",function(event){event=EventHandler.fixMouseEvent(event);var ind=event.target.getAttribute("grp_ind");if(self.m_groupper.m_params[ind]){self.m_groupper.m_params[ind].isset=event.target.checked;}},false);cont.addElement(ctrl_check);cont.addElement(new Control(group.field+"_grp_title","div",{"value":group.descr}));var sys_cont=new ControlContainer(group.field+"_grp_sys_cont","div",{"className":"btns_cont"});sys_cont.addElement(new Button(group.field+"_grp_up",{"image":{"src":this.IMG_MOVE_UP,"alt":"up"},"onClick":function(event){event=EventHandler.fixMouseEvent(event);var ind=event.target.parentNode.getAttribute("grp_ind");var n_cur=event.target.parentNode;while(n_cur.nodeName.toLowerCase()!='li'){n_cur=n_cur.parentNode;}
if(n_cur.parentNode.firstChild!=n_cur){alert("May Move");var n_prev=n_cur.previousSibling;n_cur.parentNode.insertBefore(n_cur,n_prev);}}}));sys_cont.addElement(new Button(group.field+"_grp_down",{"image":{"src":this.IMG_MOVE_DOWN,"alt":"down"},"onClick":function(event){event=EventHandler.fixMouseEvent(event);var n_cur=event.target.parentNode;while(n_cur.nodeName.toLowerCase()!='li'){n_cur=n_cur.parentNode;}
if(n_cur.parentNode.lastChild!=n_cur){var n_next=n_cur.nextSibling;n_cur.parentNode.insertBefore(n_next,n_cur);}}}));cont.addElement(sys_cont);this.addElement(cont);}
GroupFields.prototype.getParams=function(struc){return this.m_groupper.getParams();}
GroupFields.prototype.IMG_MOVE_UP="img/groupper/pointer_up.ico";GroupFields.prototype.IMG_MOVE_DOWN="img/groupper/pointer_down.ico";GroupFields.prototype.IMG_ALL_ON="img/groupper/11.png";GroupFields.prototype.IMG_ALL_OFF="img/groupper/00.png";GroupFields.prototype.getValueAsString=function(){var data={};return array2json(data);}
GroupFields.prototype.setValueFromString=function(str){} 
var PopUpMenu=function(){this.init();}
PopUpMenu.SEPARATOR='PopUpMenu.SEPARATOR';PopUpMenu.current=null;PopUpMenu.prototype={init:function(){this.items=[];this.width=0;this.height=0;},setSize:function(width,height){this.width=width;this.height=height;if(this.element){var self=this;with(this.element.style){if(self.width)width=self.width+'px';if(self.height)height=self.height+'px';}}},unbind:function(){var self=this;EventHandler.removeEvent(document,"click",function(){self.hide.call(self);},true);},bind:function(element){if(!this.items.length){return;}
var self=this;if(!element){element=document;}else if(typeof element=='string'){element=document.getElementById(element);}
this.target=element;EventHandler.addEvent(this.target,"contextmenu",function(e){self.show.call(self,e);e.preventDefault();return false;},true);EventHandler.addEvent(document,"click",function(){self.hide.call(self);},true);},add:function(action){this.items.push(action);},addButton:function(btn){this.items.push({caption:btn.getCaption()||btn.getAttr("title"),image:btn.getImage(),glyph:btn.getGlyph(),onClick:btn.getOnClick()});},addSeparator:function(){this.items.push(PopUpMenu.SEPARATOR);},setPos:function(e){if(!this.element)return;if(!e)e=window.event;var x,y;if(window.opera){x=e.clientX;y=e.clientY;}else if(document.all){x=document.body.scrollLeft+event.clientX;y=document.body.scrollTop+event.clientY;}else if(document.layers||document.getElementById){x=e.pageX;y=e.pageY;}
this.element.style.top=y+'px';this.element.style.left=x+'px';},show:function(e){if(PopUpMenu.current&&PopUpMenu.current!=this)return;PopUpMenu.current=this;if(this.element){this.setPos(e);this.element.style.display="block";}else{this.element=this.createMenu(this.items);this.setPos(e);document.body.appendChild(this.element);}},hide:function(){PopUpMenu.current=null;if(this.element)this.element.style.display='none';},createMenu:function(items){var self=this;var menu=document.createElement("div");menu.className="popover";menu.setAttribute("role","tooltip");var menu_t=document.createElement("div");menu_t.className="tooltip-arrow";var menu_cont=document.createElement("div");menu_cont.className="popover-content";var menu_cont2=document.createElement("ul");menu_cont2.className="nav";with(menu.style){if(self.width)width=self.width+'px';if(self.height)height=self.height+'px';position='absolute';display='block';}
for(var i=0;i<items.length;i++){var item;if(items[i]==PopUpMenu.SEPARATOR){item=this.createSeparator();}else{item=this.createItem(items[i]);}
menu_cont2.appendChild(item);}
menu_cont.appendChild(menu_t);menu_cont.appendChild(menu_cont2);menu.appendChild(menu_cont);return menu;},createItem:function(item){var self=this;var elem_cont=document.createElement("li");elem_cont.className="nav-item";var elem=document.createElement("a");elem.setAttribute("href","#");var cl="nav-link";if(item.disabled){cl+=" disabled";}
elem.className=cl;var callback=item.onClick;EventHandler.addEvent(elem,"click",function(_callback){return function(){self.hide();_callback(self.target);};}(callback),true);if(item.image){var img=createImgElement(item.image.src,item.image.alt,item.image.h,item.image.w);elem.appendChild(img);}
else if(item.glyph){var i=document.createElement("i");i.className="glyphicon "+item.glyph;elem.appendChild(i);}
elem.appendChild(document.createTextNode(item.caption));elem_cont.appendChild(elem);return elem_cont;},createSeparator:function(){var sep=document.createElement("div");with(sep.style){borderTop='1px dotted #CCCCCC';fontSize='0px';height='0px';}
return sep;}}; 
function ViewGridColumnManager(id,options){options=options||{};ViewGridColumnManager.superclass.constructor.call(this,id,"div",options);this.m_onClose=options.onClose;this.m_grid=options.grid;this.m_template=this.m_grid.getAttr("name");var visib_val;if(TEMPLATE_PARAMS[this.m_template]&&TEMPLATE_PARAMS[this.m_template].visibility){visib_val=TEMPLATE_PARAMS[this.m_template].visibility;}
else{visib_val=[];var head_cells={};this.m_grid.getHead().getFields(head_cells);for(var head_id in head_cells){var descr=head_cells[head_id].getValue();if(descr){var bind=head_cells[head_id].getReadBind();if(!bind)continue;visib_val.push({"id":bind.valueFieldId,"descr":descr,"checked":true});}}}
var order_val;if(TEMPLATE_PARAMS[this.m_template]&&TEMPLATE_PARAMS[this.m_template].order){order_val=TEMPLATE_PARAMS[this.m_template].order;}
else{order_val=[];var head_cells={};this.m_grid.getHead().getFields(head_cells);for(var head_id in head_cells){var descr=head_cells[head_id].getValue();if(descr&&head_cells[head_id].getSortable()){var bind=head_cells[head_id].getReadBind();if(!bind)continue;var direct=head_cells[head_id].getAttr("sort");if(!direct||direct=="")direct="undefined";order_val.push({"id":bind.valueFieldId,"descr":descr,"checked":(direct!="undefined"),"direct":direct});}}}
var self=this;this.m_menu=new ViewMenu(uuid());this.m_menu.addItem({"caption":"Видимость","viewClassId":ViewGridColVisibility,"id":"ViewGridColVisibility","viewParams":{"paramValue":visib_val,"template":this.m_template,"onAfterSave":function(struc){self.onAfterVisibilitySave(struc);}}});this.m_menu.addItem({"caption":"Сортировка","viewClassId":ViewGridColOrder,"id":"ViewGridColOrder","viewParams":{"paramValue":order_val,"template":this.m_template,"onAfterSave":function(struc){self.onAfterOrderSave(struc);}}});this.addElement(this.m_menu);this.addElement(new ButtonCmd(uuid(),{"caption":"Закрыть","attrs":{"title":"Закрыть форму"},"onClick":function(){self.m_onClose.call(self);}}));}
extend(ViewGridColumnManager,ControlContainer);ViewGridColumnManager.prototype.toDOM=function(parent){ViewGridColumnManager.superclass.toDOM.call(this,parent);var item=this.m_menu.m_menu.getElement("ViewGridColVisibility_menu");item.setActive();item.m_onClick.call(item.m_onClickContext,item.m_viewClassId);}
ViewGridColumnManager.prototype.getColNames=function(){var col_names={};var head=this.m_grid.getHead();for(var row in head.m_elements){var head_row=head.m_elements[row];for(var col in head_row.m_elements){if(head_row.m_elements[col].getSortable()){var f_name=head_row.m_elements[col].getName();if(f_name){col_names[f_name]=head_row.m_elements[col];}}}}
return col_names;}
ViewGridColumnManager.prototype.onAfterVisibilitySave=function(struc){var ref_interval=this.m_grid.getRefreshInterval();this.m_grid.setRefreshInterval(0);try{if(!TEMPLATE_PARAMS[this.m_template])TEMPLATE_PARAMS[this.m_template]={};TEMPLATE_PARAMS[this.m_template].visibility=struc;var head=this.m_grid.getHead();for(var row in head.m_elements){var head_row=head.m_elements[row];head_row.removeDOM();head_row.setColumnOrder(struc);}
head.toDOM(this.m_grid.m_node);this.m_grid.onRefresh();}
catch(e){this.m_grid.getErrorControl().setValue(e.message);this.m_grid.setRefreshInterval(ref_interval);}}
ViewGridColumnManager.prototype.onAfterOrderSave=function(struc){if(!TEMPLATE_PARAMS[this.m_template])TEMPLATE_PARAMS[this.m_template]={};TEMPLATE_PARAMS[this.m_template].order=struc;var col_names=this.getColNames();this.m_grid.m_sortCols={};for(var id in struc){var f_name=struc[id].id;this.m_grid.m_sortCols[col_names[f_name].getId()]=col_names[f_name];if(struc[id].checked&&struc[id].direct!="undefined"&&col_names[f_name]){col_names[f_name].setSort(struc[id].direct);}
else{col_names[f_name].unsetSort();}}
this.m_grid.onRefresh();} 
function ViewGridColParam(id,options){options=options||{};ViewGridColParam.superclass.constructor.call(this,id,"div",options);this.m_colCheckId=options.colCheckId;this.m_paramId=options.paramId;this.m_colCheckCaption=options.colCheckCaption;var head=new GridHead();var row=new GridRow(id+"_row1");this.addHeadCells(row);head.addElement(row);var body=new GridBody();options.viewParams=options.viewParams||{};this.m_onAfterSave=options.viewParams.onAfterSave;if(options.viewParams.paramValue){this.m_initVal=options.viewParams.paramValue;this.m_template=options.viewParams.template;for(var i=0;i<options.viewParams.paramValue.length;i++){var fieldStruc=options.viewParams.paramValue[i];var row=new GridRow(this.getId()+"_row_"+fieldStruc.id,{"attrs":{"fieldId":fieldStruc.id}});this.addCells(row,fieldStruc);body.addElement(row);}}
this.m_grid=new Grid(id+":grid",{"head":head,"body":body,"commandPanel":new RepFieldsCommands(id+"_cmd",{"noInsert":true,"noEdit":true,"noDelete":true,"noColumnManager":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"winObj":options.winObj});this.m_errorCtrl=new ErrorControl(id+":error");this.addElement(this.m_errorCtrl);this.addElement(this.m_grid);var self=this;this.addElement(new ButtonCmd(id+":save",{"caption":"Применить","attrs":{"title":"Применить изменения"},"onClick":function(){self.save();}}));}
extend(ViewGridColParam,ControlContainer);ViewGridColParam.prototype.save=function(){var b=this.m_grid.getBody();var rows=b.getNode().getElementsByTagName("tr");var res=[];for(var r=0;r<rows.length;r++){var id=rows[r].getAttribute("fieldId");var row=b.m_elements[this.getId()+"_row_"+id];this.saveRow(res,row,id);}
var res_str=array2json(res);if(array2json(this.m_initVal)!=res_str){var self=this;var contr=new TemplateParam_Controller(new ServConnector(HOST_NAME));contr.run("set_value",{"params":{"template":this.m_template,"param":this.m_paramId,"val":res_str},"errControl":this.m_errorCtrl,"func":function(resp){self.m_initVal=res;self.onAfterSave();self.m_errorCtrl.setValue("Изменения записаны!");}});}}
ViewGridColParam.prototype.onAfterSave=function(){this.m_onAfterSave(this.m_initVal);} 
function ViewGridColOrder(id,options){options=options||{};options.colCheckCaption="Сортировка";options.colCheckId="_col_order";options.paramId="order";ViewGridColOrder.superclass.constructor.call(this,id,options);}
extend(ViewGridColOrder,ViewGridColParam);ViewGridColOrder.prototype.addHeadCells=function(row){row.addElement(new GridDbHeadCell(this.getId()+"_col"+this.m_colCheckId,{"value":this.m_colCheckCaption}));row.addElement(new GridDbHeadCell(this.getId()+"_col_directs",{"value":"Направление возр./убыв."}));row.addElement(new GridDbHeadCell(this.getId()+"_col_columns",{"value":"Колонка"}));}
ViewGridColOrder.prototype.addCells=function(row,fieldStruc){debugger;row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+this.m_colCheckId,{"controlContainer":new EditCheckBox(this.getId()+"_fld_"+fieldStruc.id,{"className":"field_toggle","checked":fieldStruc.checked,"attrs":{"align":"center"}})}));var at_asc={};var at_desc={};if(fieldStruc.checked&&fieldStruc.direct=="asc"){at_asc.checked="checked";}
if(fieldStruc.checked&&fieldStruc.direct=="desc"){at_desc.checked="checked";}
var cont=new EditRadioGroup(this.getId()+"radiogroup",{"elements":[new EditRadio(this.getId()+"-radio-asc",{"value":"asc","name":fieldStruc.id+"_direct","editContClassName":"input-group "+get_bs_col()+"1","attrs":at_asc}),new EditRadio(this.getId()+"-radio-desc",{"value":"desc","name":fieldStruc.id+"_direct","editContClassName":"input-group "+get_bs_col()+"1","attrs":at_desc})]});row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+this.m_colCheckId+"_direct",{"controlContainer":cont}));row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+"_col_name",{"value":fieldStruc.descr}));}
ViewGridColOrder.prototype.saveRow=function(ar,row,id){var checked=row.m_elements[this.getId()+"_"+id+this.m_colCheckId].m_controlContainer.getChecked();var direct="undefined";if(checked){direct=row.m_elements[this.getId()+"_"+id+this.m_colCheckId+"_direct"].m_controlContainer.getValue();}
ar.push({"id":id,"descr":row.m_elements[this.getId()+"_"+id+"_col_name"].getValue(),"checked":checked,"direct":direct});} 
function ViewGridColVisibility(id,options){options=options||{};options.colCheckCaption="Видимость";options.colCheckId="_col_visib";options.paramId="visibility";ViewGridColVisibility.superclass.constructor.call(this,id,options);}
extend(ViewGridColVisibility,ViewGridColParam);ViewGridColVisibility.prototype.addCells=function(row,fieldStruc){row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+this.m_colCheckId,{"controlContainer":new EditCheckBox(this.getId()+"_fld_"+fieldStruc.id,{"className":"field_toggle","checked":fieldStruc.checked,"attrs":{"align":"center"}})}));row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+"_col_name",{"value":fieldStruc.descr}));}
ViewGridColVisibility.prototype.addHeadCells=function(row){row.addElement(new GridDbHeadCell(this.getId()+"_col"+this.m_colCheckId,{"value":this.m_colCheckCaption}));row.addElement(new GridDbHeadCell(this.getId()+"_col_columns",{"value":"Колонки"}));}
ViewGridColVisibility.prototype.saveRow=function(ar,row,id){ar.push({"id":id,"descr":row.m_elements[this.getId()+"_"+id+"_col_name"].getValue(),"checked":row.m_elements[this.getId()+"_"+id+this.m_colCheckId].m_controlContainer.getChecked()});} 
function PeriodFilter(id,options){options=options||{};var tagName=options.tagName||this.DEF_TAG_NAME;options.className=options.className||this.DEF_CLASS_NAME;PeriodFilter.superclass.constructor.call(this,id,tagName,options);this.m_onRefresh=options.onRefresh;this.m_clickContext=options.clickContext;this.m_filter=new ListFilter();this.m_filter.addFilter("from",{"sign":"ge","valueFieldId":options.valueFieldId});this.m_filter.addFilter("to",{"sign":"le","valueFieldId":options.valueFieldId});var DEF_DESCR_TEMPL;this.m_period=options.period||"day";if(this.m_period=="day"){this.m_prevPeriodTitle="предыдущий день";this.m_nextPeriodTitle="следующий день";DEF_DESCR_TEMPL="d M yy, dow";}
else if(this.m_period=="week"){this.m_prevPeriodTitle="предыдущая неделя";this.m_nextPeriodTitle="следующая неделя";DEF_DESCR_TEMPL="dd/mm";}
else if(this.m_period=="month"){this.m_prevPeriodTitle="предыдущий месяц";this.m_nextPeriodTitle="следующий месяц";}
else if(this.m_period=="quater"){this.m_prevPeriodTitle="предыдущий квартал";this.m_nextPeriodTitle="следующий квартал";}
else if(this.m_period=="year"){this.m_prevPeriodTitle="предыдущий год";this.m_nextPeriodTitle="следующий год";}
else{this.m_prevPeriodTitle=options.prevPeriodTitle;this.m_nextPeriodTitle=options.nextPeriodTitle;}
this.m_descrTempl=options.descrTempl||DEF_DESCR_TEMPL;this.m_label=new Label({"tagName":"span","className":"dayText","id":"make_order_filter_l"});var self=this;this.m_prevPeriod=new ButtonCtrl(id+"_prevperiod",{"glyph":"glyphicon-triangle-left","attrs":{"title":this.m_prevPeriodTitle},"onClick":function(){self.setDate(new Date(self.m_dateFrom.getTime()-1*1000));if(self.m_onRefresh){self.m_onRefresh.call(self.m_clickContext);}}});this.m_nextPeriod=new ButtonCtrl(id+"_nextperiod",{"glyph":"glyphicon-triangle-right","attrs":{"title":this.m_nextPeriodTitle},"onClick":function(){self.setDate(new Date(self.m_dateTo.getTime()+1*1000));if(self.m_onRefresh){self.m_onRefresh.call(self.m_clickContext);}}});this.addElement(this.m_prevPeriod);this.addElement(this.m_label);this.addElement(this.m_nextPeriod);options.date=options.date||new Date();this.m_fromH=options.fromH||0;this.m_fromM=options.fromM||0;this.m_fromS=options.fromS||0;this.m_fromMS=options.fromMS||0;this.m_toH=options.toH||23;this.m_toM=options.toM||59;this.m_toS=options.toS||59;this.m_toMS=options.toMS||0;this.m_lengthH=options.lengthH||24;this.m_lengthM=options.lengthM||0;this.m_lengthS=options.lengthS||0;this.setDate(options.date);}
extend(PeriodFilter,ControlContainer);PeriodFilter.prototype.DEF_TAG_NAME="div";PeriodFilter.prototype.DEF_CLASS_NAME='period_filter';PeriodFilter.prototype.m_date;PeriodFilter.prototype.m_label;PeriodFilter.prototype.m_prevPeriod;PeriodFilter.prototype.m_nextPeriod;PeriodFilter.prototype.m_filter;PeriodFilter.prototype.m_onRefresh;PeriodFilter.prototype.m_clickContext;PeriodFilter.prototype.m_start;PeriodFilter.prototype.m_fromH;PeriodFilter.prototype.m_fromM;PeriodFilter.prototype.m_toH;PeriodFilter.prototype.m_toM;PeriodFilter.prototype.m_lengthH;PeriodFilter.prototype.m_lengthM;PeriodFilter.prototype.setDate=function(date){if(this.m_period=="week"){this.m_dateFrom=DateHandler.weekStart(date);this.m_dateFrom.setHours(this.m_fromH,this.m_fromM,this.m_fromS,0);this.m_dateTo=DateHandler.weekEnd(date);this.m_dateTo.setHours(this.m_toH,this.m_toM,this.m_toS,0);}
else if(this.m_period=="month"){this.m_dateFrom=new Date(date.getFullYear(),date.getMonth(),1);this.m_dateFrom.setHours(this.m_fromH,this.m_fromM,this.m_fromS,this.m_fromMS);this.m_dateTo=DateHandler.getLastDateOfMonth(date.getFullYear(),date.getMonth());this.m_dateTo.setHours(this.m_fromH,this.m_fromM,this.m_fromS,this.m_fromMS);this.m_dateTo=new Date(this.m_dateTo.getTime()+
this.m_lengthH*60*60*1000+
this.m_lengthM*60*1000+this.m_lengthS*1000-1000);}
else if(this.m_period=="quater"){var m1=date.getMonth();if(m1<=2){m1=0;m2=2;}
else if(m1<=5){m1=3;m2=5;}
else if(m1<=8){m1=6;m2=8;}
else{m1=9;m2=11;}
this.m_dateFrom=new Date(date.getFullYear(),m1,1);this.m_dateFrom.setHours(this.m_fromH,this.m_fromM,this.m_fromS,this.m_fromMS);this.m_dateTo=DateHandler.getLastDateOfMonth(date.getFullYear(),m2);this.m_dateTo.setHours(this.m_toH,this.m_toM,this.m_toS,0);}
else if(this.m_period=="year"){this.m_dateFrom=new Date(date.getFullYear(),0,1);this.m_dateFrom.setHours(this.m_fromH,this.m_fromM,this.m_fromS,this.m_fromMS);this.m_dateTo=DateHandler.getLastDateOfMonth(date.getFullYear(),11);this.m_dateTo=new Date(this.m_dateTo.getTime()+
this.m_lengthH*60*60*1000+
this.m_lengthM*60*1000+this.m_lengthS*1000-1000);}
else{this.m_dateFrom=date;this.m_dateFrom.setHours(this.m_fromH,this.m_fromM,this.m_fromS,this.m_fromMS);this.m_dateTo=new Date(this.m_dateFrom.getTime()+
this.m_lengthH*60*60*1000+
this.m_lengthM*60*1000+this.m_lengthS*1000-1000);}
this.m_label.setValue(this.getPeriodDescr());}
PeriodFilter.prototype.getDateFrom=function(){return this.m_dateFrom;}
PeriodFilter.prototype.getDateTo=function(){return this.m_dateTo;}
PeriodFilter.prototype.getDate=function(){return this.getDateFrom();}
PeriodFilter.prototype.getParams=function(struc){this.m_filter.m_params["from"].descr=DateHandler.dateToStr(this.getDateFrom(),"dd/mm/yy hh:mmin:ss");this.m_filter.m_params["to"].descr=DateHandler.dateToStr(this.getDateTo(),"dd/mm/yy hh:mmin:ss");this.m_filter.getParams(struc);}
PeriodFilter.prototype.setOnRefresh=function(onGridRefresh){this.m_onRefresh=onGridRefresh;}
PeriodFilter.prototype.setClickContext=function(clickContext){this.m_clickContext=clickContext;}
PeriodFilter.prototype.toDOM=function(parent){PeriodFilter.superclass.toDOM.call(this,parent);var self=this;EventHandler.addEvent(this.m_label.m_node,"click",function(event){var p=$(self.m_label.m_node);p.datepicker({format:options.datePattern,language:"ru",daysOfWeekHighlighted:"0,6",autoclose:true,todayHighlight:true,orientation:"bottom right",showOnFocus:false});p.datepicker().on("hide",function(e){self.setDate(e.date);if(self.m_onRefresh){self.m_onRefresh.call(self.m_clickContext);}});p.datepicker("show");},false);}
PeriodFilter.prototype.getPeriodDescr=function(){var res;if(this.m_period=="day"){var t=this.m_descrTempl;var dow_p=t.indexOf("dow");if(dow_p>=0){t=t.substr(0,dow_p);}
res=DateHandler.dateToStr(this.m_dateFrom,t);if(dow_p>=0){var days=['Воскресенье','Понедельник','Вторник','Среда','Четверг','Пятница','Суббота'];res+=days[this.m_dateFrom.getDay()];}}
else if(this.m_period=="week"){res=DateHandler.dateToStr(this.m_dateFrom,this.m_descrTempl)+" - "+
DateHandler.dateToStr(this.m_dateTo,this.m_descrTempl);}
else if(this.m_period=="quater"){var q_descr=[];q_descr[0]="1 квартал";q_descr[3]="2 квартал";q_descr[6]="3 квартал";q_descr[9]="4 квартал";res=q_descr[this.m_dateFrom.getMonth()]+" "+this.m_dateFrom.getFullYear();}
else if(this.m_period=="month"){var mon_str=[];mon_str[0]="Январь";mon_str[1]="Февраль";mon_str[2]="Март";mon_str[3]="Апрель";mon_str[4]="Май";mon_str[5]="Июнь";mon_str[6]="Июль";mon_str[7]="Август";mon_str[8]="Сентябрь";mon_str[9]="Октябрь";mon_str[10]="Ноябрь";mon_str[11]="Декабрь";res=mon_str[this.m_dateFrom.getMonth()]+" "+this.m_dateFrom.getFullYear();}
else if(this.m_period=="year"){res=this.m_dateFrom.getFullYear();}
return res;}
PeriodFilter.prototype.addFilterControl=function(control,filter){this.m_filter.addFilter(control.getId(),filter);this.addElement(control);}
PeriodFilter.prototype.getFilterControlById=function(id){return this.m_filter.getFilterById(id);}
PeriodFilter.prototype.unsetFilterControlById=function(id){this.m_filter.unsetFilterById(id);}
PeriodFilter.prototype.getControlFrom=function(id){}
PeriodFilter.prototype.getControlTo=function(id){} 
function RepBaseFields(id,options){options=options||{};if(options.commandPanel){options.popUpMenu=new PopUpMenu();options.commandPanel.commandsToPopUp(options.popUpMenu);}
RepBaseFields.superclass.constructor.call(this,id,options);this.addFields(options.fields);}
extend(RepBaseFields,Grid);RepBaseFields.prototype.addFields=function(fields){if(fields){for(var i=0;i<fields.length;i++){this.addField(fields[i]);}}}
RepBaseFields.prototype.addField=function(fieldStruc){}
RepBaseFields.prototype.getParams=function(){}
RepBaseFields.prototype.getValueAsObj=function(){var data={};var b=this.getBody();var r_ind=0;for(var r_id in b.m_elements){data[r_id]={"ind":DOMHandler.getElementIndex(b.m_elements[r_id].m_node),"cells":{}};for(var c_id in b.m_elements[r_id].m_elements){if(b.m_elements[r_id].m_elements[c_id].m_controlContainer){data[r_id].cells[c_id]=b.m_elements[r_id].m_elements[c_id].m_controlContainer.getValueAsObj();}}}
return data;}
RepBaseFields.prototype.setValueFromObj=function(obj){var b=this.getBody();var rows=b.m_node.getElementsByTagName("tr");for(var r_id in b.m_elements){if(obj[r_id]){var ind=DOMHandler.getElementIndex(b.m_elements[r_id].m_node);for(var c_id in b.m_elements[r_id].m_elements){if(obj[r_id].cells[c_id]){b.m_elements[r_id].m_elements[c_id].m_controlContainer.setValueFromObj(obj[r_id].cells[c_id]);}}
if(ind!=obj[r_id].ind&&obj[r_id].ind<rows.length){b.m_node.insertBefore(rows[ind],rows[obj[r_id].ind]);}}}} 
function RepCondFields(id,options){options=options||{};options.head=new GridHead();var row=new GridRow(id+"_head_row");var self=this;row.addElement(new GridDbHeadCell(id+"_col_field_names",{"value":"Колонки"}));row.addElement(new GridDbHeadCell(id+"_col_filter",{"controlContainer":new EditCheckBox(id+"_col_filtered_toggle",{"labelCaption":"Фильтр","attrs":{"title":"Фильтровать по значению колонки"},"className":"filtered_toggle","labelAlign":"left","events":{"onChange":function(elem){self.onSetAll("filtered_toggle",elem.checked);}}})}));row.addElement(new GridDbHeadCell(id+"_col_filter_vals",{"value":"Значения фильтра"}));options.head.addElement(row);options.body=new GridBody();RepCondFields.superclass.constructor.call(this,id,options);}
extend(RepCondFields,RepBaseFields);RepCondFields.prototype.addField=function(fieldStruc){if(fieldStruc.filterControl){var row=new GridRow(this.getId()+"_row_"+fieldStruc.id,{"attrs":{"fieldId":fieldStruc.id}});row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+"_name",{"value":fieldStruc.name}));row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+"_filtered",{"controlContainer":new EditCheckBox(this.getId()+"_filtered_"+fieldStruc.id),"className":"filtered_toggle","attrs":{"align":"center"}}));row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+"_filterVal",{"controlContainer":fieldStruc.filterControl,"className":"input-group"}));this.m_body.addElement(row);}}
RepCondFields.prototype.getParams=function(filterStruc){var b=this.getBody();var rows=b.m_node.getElementsByTagName("tr");filterStruc.field_sep="@";for(var i=0;i<rows.length;i++){var r_id=rows[i].id;if(!b.m_elements[r_id])continue;var id=b.m_elements[r_id].getAttr("fieldId");if(b.m_elements[r_id].m_elements[this.getId()+"_"+id+"_filtered"].m_controlContainer.getChecked()){var ctrl=b.m_elements[r_id].m_elements[this.getId()+"_"+id+"_filterVal"].m_controlContainer;var f_val=ctrl.getValue();if(f_val!="undefined"){if(ctrl.m_keyFieldIds){id=ctrl.m_keyFieldIds[0];f_val=ctrl.getFieldValue(id);}
filterStruc.fields=(filterStruc.fields==null)?"":filterStruc.fields;filterStruc.fields+=((filterStruc.fields)?filterStruc.field_sep:"")+id;filterStruc.signs=(filterStruc.signs==null)?"":filterStruc.signs;filterStruc.signs+=((filterStruc.signs)?filterStruc.field_sep:"")+(ctrl.filterSign||"e");filterStruc.vals=(filterStruc.vals==null)?"":filterStruc.vals;filterStruc.vals+=((filterStruc.vals)?filterStruc.field_sep:"")+f_val;};}}}
RepCondFields.prototype.onSetAll=function(id,flag){var b=this.getBody();var rows=b.m_node.getElementsByTagName("tr");for(var i=0;i<rows.length;i++){var r_id=rows[i].id;var id=b.m_elements[r_id].getAttr("fieldId");b.m_elements[r_id].m_elements[this.getId()+"_"+id+"_filtered"].m_controlContainer.setChecked(flag);}} 
function RepAggFields(id,options){options=options||{};options.commandPanel=new RepFieldsCommands(id+"_cmd",{"noInsert":true,"noEdit":true,"noDelete":true});options.head=new GridHead();var row=new GridRow(id+"_head_row");row.addElement(new GridDbHeadCell(id+"_col_agg_fields",{"value":"Наименование"}));row.addElement(new GridDbHeadCell(id+"_col_agg_fn",{"value":"Функция"}));options.head.addElement(row);options.body=new GridBody();RepAggFields.superclass.constructor.call(this,id,options);}
extend(RepAggFields,RepBaseFields);RepAggFields.prototype.addField=function(fieldStruc){var row=new GridRow(this.getId()+"_row_"+fieldStruc.id,{"attrs":{"fieldId":fieldStruc.id}});var type=new EditSelect(this.getId()+"_agg_"+fieldStruc.id,{"tableLayout":false});row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+"_agg_name",{"controlContainer":type,"value":fieldStruc.name}));type.addElement(new EditSelectOption("undefined",{"optionSelected":true,"optionDescr":"не рассчитывать","optionId":"undefined"}));type.addElement(new EditSelectOption("sum",{"optionDescr":"сумма","optionId":"sum"}));type.addElement(new EditSelectOption("avg",{"optionDescr":"среднее","optionId":"avg"}));type.addElement(new EditSelectOption("min",{"optionDescr":"минимум","optionId":"min"}));type.addElement(new EditSelectOption("max",{"optionDescr":"максисум","optionId":"max"}));row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+"_agg_fn",{"controlContainer":type}));this.m_body.addElement(row);}
RepAggFields.prototype.getParams=function(filterStruc){var b=this.getBody();var rows=b.m_node.getElementsByTagName("tr");for(var i=0;i<rows.length;i++){var r_id=rows[i].id;var id=b.m_elements[r_id].getAttr("fieldId");var v=b.m_elements[r_id].m_elements[this.getId()+"_"+id+"_agg_name"].m_controlContainer.getValue();if(v!="undefined"){filterStruc.agg_fields=(filterStruc.agg_fields==null)?"":filterStruc.agg_fields;filterStruc.agg_fields+=((filterStruc.agg_fields)?",":"")+id;filterStruc.agg_types=(filterStruc.agg_types==null)?"":filterStruc.agg_types;filterStruc.agg_types+=((filterStruc.agg_types)?",":"")+v;}}}
RepAggFields.prototype.addFields=function(fields){if(fields){for(var i=0;i<fields.length;i++){if(fields[i].agg){this.addField(fields[i]);}}}}
RepAggFields.prototype.getSelectedCount=function(){var res=0;var b=this.getBody();var rows=b.m_node.getElementsByTagName("tr");for(var i=0;i<rows.length;i++){var r_id=rows[i].id;var id=b.m_elements[r_id].getAttr("fieldId");var v=b.m_elements[r_id].m_elements[this.getId()+"_"+id+"_agg_name"].m_controlContainer.getValue();if(v!="undefined"){res++;}}
return res;} 
function RepGroupFields(id,options){options=options||{};options.commandPanel=new RepFieldsCommands(id+"_cmd");options.head=new GridHead();var row=new GridRow(id+"_head_row");row.addElement(new GridDbHeadCell(id+"_col_group_names",{"value":"Наименование"}));row.addElement(new GridDbHeadCell(id+"_col_group_fields",{"value":"Поля"}));options.head.addElement(row);options.body=new GridBody();this.m_fields=clone2(options.fields);RepGroupFields.superclass.constructor.call(this,id,options);}
extend(RepGroupFields,RepBaseFields);RepGroupFields.prototype.editRow=function(rowNode,cellVals){var self=this;this.m_modal_v=new RepGroupFields_View(uuid(),{"initVals":{"fields":cellVals[1],"name":cellVals[0]},"onClose":function(res){if(res){var name=self.m_modal_v.getControl(self.m_modal_v.getId()+"_name").getValue();var fields=self.m_modal_v.getSelectedFields();var f_names="";var f_cnt=0;for(var i in fields){f_names+=(f_names=="")?"":", ";f_names+=fields[i].name;f_cnt++;}
var row;if(rowNode){rowNode.setAttribute("fields",array2json(fields));rowNode.cells[0].innerHTML=name;rowNode.cells[1].innerHTML=f_names;}
else if(f_cnt){var r_id=uuid();row=new GridRow(r_id,{"attrs":{"fields":array2json(fields)}});row.addElement(new GridCell(r_id+"_c0",{"value":name}));row.addElement(new GridCell(r_id+"_c1",{"value":f_names}));}
if(row){row.toDOM(self.getBody().getNode());}}
self.m_modal.removeDOM();}});this.m_modal=new WindowFormModalBS(uuid(),{content:this.m_modal_v});this.m_modal.toDOM(document.body);}
RepGroupFields.prototype.onInsert=function(){for(var i=0;i<this.m_fields.length;i++){this.m_fields[i].checked=false;}
this.editRow(null,["",this.m_fields]);}
RepGroupFields.prototype.onEdit=function(rowId,keys){var n=nd(rowId);if(n){var fields=json2obj(DOMHandler.getAttr(n,"fields"));for(var i=0;i<this.m_fields.length;i++){this.m_fields[i].checked=!(fields[this.m_fields[i].id]==undefined);}
var cells=n.getElementsByTagName("td");this.editRow(n,[cells[0].textContent,this.m_fields]);}}
RepGroupFields.prototype.getValueAsObj=function(){var data={};var table=this.getBody().getNode();var r=0;while(row=table.rows[r++]){data[row.id]={"cells":{},"fields":json2obj(DOMHandler.getAttr(row,"fields")),"class":DOMHandler.getAttr(row,"class")};var c=0;while(cell=row.cells[c++]){data[row.id].cells[cell.id]={"html":cell.innerHTML,"class":DOMHandler.getAttr(cell,"class")};}}
return data;}
RepGroupFields.prototype.setValueFromObj=function(obj){var table=this.getBody().getNode();while(row=table.rows[0]){DOMHandler.removeNode(row);}
for(var r_id in obj){var row=document.createElement("tr");row.id=r_id;DOMHandler.setAttr(row,"fields",array2json(obj[r_id].fields));DOMHandler.setAttr(row,"class",obj[r_id]["class"]);for(var c_id in obj[r_id].cells){var cell=document.createElement("td");cell.id=c_id;cell.innerHTML=obj[r_id].cells[c_id].html;cell.className=obj[r_id]["class"];row.appendChild(cell);}
table.appendChild(row);}}
RepGroupFields.prototype.getParams=function(filterStruc){var b=this.getBody();var groups=null;var rows=b.m_node.getElementsByTagName("tr");for(var i=0;i<rows.length;i++){if(rows[i].cells&&rows[i].cells.length){var fields=json2obj(DOMHandler.getAttr(rows[i],"fields"));if(!groups){groups=[];}
var field_ids="";var field_descrs="";for(var fid in fields){field_ids+=((field_ids=="")?"":",")+fid;field_descrs+=((field_descrs=="")?"":",")+fields[fid]["name"];}
var descr="";if(rows[i].cells[0].textContent){descr=rows[i].cells[0].textContent;}
else{descr=rows[i].cells[1].textContent;}
groups.push({"descr":descr,"fields":field_ids,"fieldDescrs":field_descrs});}}
filterStruc.groups=array2json(groups);}
RepGroupFields.prototype.getSelectedCount=function(){return this.getBody().m_node.getElementsByTagName("tr").length;} 
function RepGroupFields_View(id,options){options.className=options.className||"form-group";RepGroupFields_View.superclass.constructor.call(this,id,options);options.initVals=options.initVals||{};this.addControl(new EditString(id+"_name",{"labelCaption":"Наименование:","value":options.initVals.name}));this.addControl(new ButtonCmd(id+"_select",{"caption":"Выбрать","onClick":function(){options.onClose(true);}}));this.addControl(new ButtonCmd(id+"_close",{"caption":"Отмена","onClick":function(){options.onClose(false);}}));var head=new GridHead();var row=new GridRow(id+"_head_row");row.addElement(new GridDbHeadCell(id+"_col_fields",{"value":"Колонки"}));row.addElement(new GridDbHeadCell(id+"_col_field_includes"));head.addElement(row);var body=new GridBody();if(options.initVals.fields){for(var i=0;i<options.initVals.fields.length;i++){var fieldStruc=options.initVals.fields[i];if(fieldStruc.agg)continue;var row=new GridRow(this.getId()+"_row_"+fieldStruc.id,{"attrs":{"fieldId":fieldStruc.id}});row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+"_name",{"value":fieldStruc.name}));row.addElement(new GridCell(this.getId()+"_"+fieldStruc.id+"_field_include",{"controlContainer":new EditCheckBox(this.getId()+"_fld_"+fieldStruc.id,{"className":"field_toggle","checked":fieldStruc.checked,"attrs":{"align":"center","field_data":array2json({"id":fieldStruc.id,"name":fieldStruc.name})}})}));body.addElement(row);}}
this.addControl(new RepBaseFields(id+"_field_grid",{"head":head,"body":body}));}
extend(RepGroupFields_View,View);RepGroupFields_View.prototype.getSelectedFields=function(){var fields={};var gr=this.getControl(this.getId()+"_field_grid");var list=DOMHandler.getElementsByAttr("field_toggle",gr.getNode(),"class");for(var i=0;i<list.length;i++){if(list[i].checked){var o=json2obj(DOMHandler.getAttr(list[i],"field_data"));fields[o.id]=o;}}
return fields;} 
function RepFieldsCommands(id,options){options=options||{};options.noCopy=true;options.noPrint=true;options.noRefresh=true;RepFieldsCommands.superclass.constructor.call(this,id,options);var self=this;this.m_btnUp=new ButtonCtrl(null,{"glyph":"glyphicon-arrow-up","onClick":function(){if(self.getEnabled()){self.m_clickContext.onUp();}},"attrs":{"title":"передвинуть строку вверх"}});this.setElementById(id+"_up",this.m_btnUp);this.m_btnDown=new ButtonCtrl(null,{"glyph":"glyphicon-arrow-down","onClick":function(){if(self.getEnabled()){self.m_clickContext.onDown();}},"attrs":{"title":"передвинуть строку вниз"}});this.setElementById(id+"_down",this.m_btnDown);}
extend(RepFieldsCommands,GridCommands);RepFieldsCommands.prototype.commandsToPopUp=function(popUp){if(this.m_btnUp){popUp.addButton(this.m_btnUp);}
if(this.m_btnDown){popUp.addButton(this.m_btnDown);}} 
function TabMenuItem(id,options){options=options||{};options.className=options.className||this.DEF_CLASS_NAME;options.attrs=options.attrs||{};options.attrs.role="presentation";TabMenuItem.superclass.constructor.call(this,id,"li",options);var self=this;this.m_href=new Control(null,"a",{"value":options.caption});EventHandler.addEvent(this.m_href.m_node,"click",function(){self.onClick(self.m_href,options.onClick,options.onClickContext,options.viewClassId);},false);this.setElementById("a",this.m_href);if(options.defItem){this.onClick(this.m_href,options.onClick,options.onClickContext,options.viewClassId);}}
extend(TabMenuItem,ControlContainer);TabMenuItem.prototype.DEF_CLASS_NAME="tabMenuItem";TabMenuItem.prototype.DEF_SELECTED_CLASS="active";TabMenuItem.prototype.onClick=function(href,onClick,onClickContext,viewClassId){var sel=DOMHandler.getElementsByAttr(this.DEF_SELECTED_CLASS,this.m_node.parentNode,"class");if(sel.length){DOMHandler.removeClass(sel[0],this.DEF_SELECTED_CLASS);}
DOMHandler.addClass(this.m_node,this.DEF_SELECTED_CLASS);onClick.call(onClickContext,viewClassId);} 
function MenuItem(options){options=options||{};options.id=options.id||uuid();options.className=options.className||"";options.className+=(options.className=="")?"":" ";options.className+="menuItem";var tagName=options.tagName||this.DEF_TAG_NAME;MenuItem.superclass.constructor.call(this,options.id,tagName,options);this.m_viewClassId=options.viewClassId;var href=new Control(options.id+"_a","a",{"value":options.caption});this.m_onClick=options.onClick;this.m_onClickContext=options.onClickContext;this.m_viewClassId=options.viewClassId;var self=this;EventHandler.addEvent(href.m_node,"click",function(){self.setActive();self.m_onClick.call(self.m_onClickContext,self.m_viewClassId);},false);this.setElementById("a",href);}
extend(MenuItem,ControlContainer);MenuItem.prototype.DEF_TAG_NAME="li";MenuItem.prototype.DEF_SELECTED_CLASS="active";MenuItem.prototype.setActive=function(){var sel=DOMHandler.getElementsByAttr(this.DEF_SELECTED_CLASS,this.m_node.parentNode,"class");if(sel.length){DOMHandler.removeClass(sel[0],this.DEF_SELECTED_CLASS);}
DOMHandler.addClass(this.m_node,this.DEF_SELECTED_CLASS);} 
function EditListCommands(id,options){options=options||{};options.btnClass=ButtonSmall;options.noCopy=true;options.noPrint=true;options.noExport=true;options.noRefresh=true;EditListCommands.superclass.constructor.call(this,id,options);}
extend(EditListCommands,GridCommands); 
function GridClient(id,options){options=options||{};options.editInline=true;options.refreshInterval=0;options.editViewClass=ViewInlineGridClientEdit;this.m_editControls=options.editControls;GridClient.superclass.constructor.call(this,id,options);}
extend(GridClient,Grid);GridClient.prototype.onError=function(erStr){if(this.m_errorControl){this.m_errorControl.setValue(erStr);}
else{alert("AJAX error: "+erStr);}}
GridClient.prototype.initEditViewObj=function(){var self=this;this.m_editViewObj=new this.m_editViewClass(this.getId()+"EditView",{"elements":this.m_editControls,"onClose":function(res,tr){if(self.m_editViewObj.m_replacedNode){var n=self.m_editViewObj.getNode();var parent=n.parentNode;parent.replaceChild(self.m_editViewObj.m_replacedNode,n);}
else if(res){self.getBody().getNode().appendChild(tr);self.selectRow(tr,self.getSelectedNode());}
self.m_editViewObj.removeDOM();delete self.m_editViewObj;},"errorControl":(this.m_editWinClass)?null:this.getErrorControl(),"winObj":(this.m_editWinClass)?self.m_editWin:this.m_winObj});}
GridClient.prototype.onInsert=function(){if(this.m_editViewObj){return 0;}
this.initEditViewObj();var parent;if(this.getEditInline()){parent=this.getBody().m_node;}
else if(this.m_editWinClass){this.m_editWin=new this.m_editWinClass({"view":this.m_editViewObj,"title":this.m_editViewObj.getFormCaption()+":Новый","width":this.m_editViewObj.getFormWidth(),"height":this.m_editViewObj.getFormHeight()});this.m_editWin.open();this.m_editViewObj.setWinObj(this.m_editWin);parent=this.m_editWin.getContentParent();}
else{parent=this.m_parent;this.removeDOM();}
this.m_editViewObj.toDOM(parent);GridClient.superclass.onInsert.call(this);}
GridClient.prototype.prepareEdit=function(rowId,keys,nodes,isCopy){if(this.m_editViewObj){return 0;}
this.initEditViewObj();if(this.getEditInline()){nodes.parent=this.getBody().m_node;nodes.replaced_node=nd(rowId,this.getWinObjDocum());}
else if(this.m_editWinClass){this.m_editWin=new this.m_editWinClass({"view":this.m_editViewObj,"title":this.m_editViewObj.getFormCaption()+((isCopy)?":Новый":":Редактирование"),"width":this.m_editViewObj.getFormWidth(),"height":this.m_editViewObj.getFormHeight()});this.m_editWin.open();nodes.parent=this.m_editWin.getContentParent();}
else{nodes.parent=this.m_parent;this.removeDOM();}}
GridClient.prototype.onEdit=function(rowId,keys){var nodes={parent:null,replaced_node:null};this.prepareEdit(rowId,keys,nodes);this.m_editViewObj.m_replacedNode=nodes.replaced_node;this.m_editViewObj.toDOM(nodes.parent,nodes.replaced_node);var cell=this.m_editViewObj.m_replacedNode.cells[0];var f_id=this.m_editControls[0].getFieldId();this.m_editControls[0].setValue(cell.innerHTML);this.m_editControls[0].setFieldValue(f_id,cell.getAttribute(f_id));} 
function EditList(id,options){options=options||{};this.m_editViewControl=options.editViewControl;this.m_grid=new GridClient(id+":grid",{"commandPanel":new EditListCommands(id+"_cmd",{}),"body":new GridBody(),"editControls":[options.editViewControl]});this.filterSign=options.filterSign;if(options.labelCaption){this.setLabel(new LabelField(this.getId(),options.labelCaption,{"className":options.labelClassName,"visible":this.getVisible(),"enabled":this.getEnabled(),"readOnly":this.getVisible()}));}
options.className=options.contClassName||this.DEF_CONT_CLASS;EditList.superclass.constructor.call(this,id,"div",options);this.m_editContClassName=options.editContClassName||("input-group "+get_bs_col()+"8");}
extend(EditList,Control);EditList.prototype.DEF_CONT_CLASS="form-group";EditList.prototype.setLabel=function(label){this.m_label=label;}
EditList.prototype.getLabel=function(){return this.m_label;}
EditList.prototype.removeDOM=function(){if(this.m_label){this.m_label.removeDOM();}
if(this.m_edit_container){this.m_edit_container.removeDOM();}
EditList.superclass.removeDOM.call(this);}
EditList.prototype.setFocus=function(){this.setFocused();}
EditList.prototype.toDOM=function(parent){EditList.superclass.toDOM.call(this,parent);if(this.m_label){this.m_label.toDOM(this.m_node);}
this.m_edit_container=new ControlContainer(uuid(),"div",{"className":this.m_editContClassName});this.m_edit_container.addElement(this.m_grid);this.m_edit_container.toDOM(this.m_node);}
EditList.prototype.resetValue=function(){var b=this.m_grid.getBody();b.clear();var rows=b.getNode().getElementsByTagName("tr");while(rows.length){DOMHandler.removeNode(rows[0]);}}
EditList.prototype.getValue=function(){MULTY_FIELD_SEP=";";var f_id=(this.m_editViewControl.getFieldId)?this.m_editViewControl.getFieldId():null;var b_n=this.m_grid.getBody().getNode();var vals=[];for(var i=0;i<b_n.childNodes.length;i++){var cell=b_n.childNodes[i].cells[0];var v;if(f_id){v=cell.getAttribute(f_id);}
else if(cell.childNodes.length){v=cell.childNodes[0].textContent;}
vals.push(v);}
if(vals.join(MULTY_FIELD_SEP)){}
return vals.join(MULTY_FIELD_SEP);}
EditList.prototype.getFieldValue=function(){return this.getValue();}
EditList.prototype.serialize=function(o){var o=o||{};o.grid=this.m_grid.serialize();return EditList.superclass.serialize.call(this,o);}
EditList.prototype.unserialize=function(str){var o=json2obj(str);if(o.grid){this.m_grid.unserialize(o.grid);}}
EditList.prototype.getValueAsObj=function(){return{"grid":this.m_grid.serialize()};}
EditList.prototype.setValueFromObj=function(obj){if(obj.grid){this.m_grid.unserialize(obj.grid);}} 
function ViewInlineGridClientEdit(id,options){options=options||{};options.tagName=options.tagName||this.DEF_TAG_NAME;this.m_tagName=options.tagName;ViewInlineGridClientEdit.superclass.constructor.call(this,id,this.m_tagName,options);this.m_containerClassName=options.containerClassName||"input-group";if(options.onClose){this.setOnClose(options.onClose);}
var self=this;var onOk=function(){var tr=self.writeData();if(self.m_lastWriteResult){self.getOnClose().call(self,1,tr);}}
var onCancel=function(){if(self.getOnClose){self.getOnClose().call(self,0);}}
this.m_ctrlOk=new ButtonSmall(id+"btnOk",{"onClick":onOk,"glyph":"glyphicon-ok","attrs":{"title":"записать"}});this.m_ctrlCancel=new ButtonSmall(id+"btnCancel",{"onClick":onCancel,"glyph":"glyphicon-remove","attrs":{"title":"отмена"}});this.m_ctrlContainer=new ControlContainer(null,(this.m_tagName=="tr")?"td":this.m_tagName);this.m_ctrlContainer.setElementById("ok",this.m_ctrlOk);this.m_ctrlContainer.setElementById("cancel",this.m_ctrlCancel);}
extend(ViewInlineGridClientEdit,ControlContainer);ViewInlineGridClientEdit.prototype.DEF_TAG_NAME="tr";ViewInlineGridClientEdit.prototype.getOnClose=function(){return this.m_onClose;}
ViewInlineGridClientEdit.prototype.setOnClose=function(onClose){this.m_onClose=onClose;}
ViewInlineGridClientEdit.prototype.toDOM=function(parent,replacedNode){var elem;for(var elem_id in this.m_elements){elem=this.m_elements[elem_id];elem.setValid();elem.resetValue();elem.toDOM(this.m_node);}
this.m_ctrlContainer.toDOM(this.m_node);if(replacedNode){parent.replaceChild(this.m_node,replacedNode);}
else{var rows=parent.getElementsByTagName(this.m_node.nodeName);if(rows.length==0){parent.appendChild(this.m_node);}
else{parent.insertBefore(this.m_node,rows[0]);}}}
ViewInlineGridClientEdit.prototype.removeDOM=function(){this.m_ctrlContainer.removeDOM();ViewInlineGridClientEdit.superclass.removeDOM.call(this);}
ViewInlineGridClientEdit.prototype.addDataControl=function(control,readBind,writeBind,options){var container=new ControlContainer(uuid(),"div",{className:this.m_containerClassName});var container_td=new ControlContainer(uuid(),"td");container_td.setVisible(control.getVisible());container_td.setEnabled(control.getEnabled());container_td.addElement(container);container.addElement(control);this.addElement(container_td);}
ViewInlineGridClientEdit.prototype.writeData=function(){this.m_lastWriteResult=true;var tr;if(!this.m_replacedNode){tr=document.createElement("tr");tr.setAttribute("id",uuid());}
else{tr=this.m_replacedNode;}
var ind=0;var td;for(var elem_id in this.m_elements){try{var elem=this.m_elements[elem_id];elem.validate(elem.getValue());if(!this.m_replacedNode){td=document.createElement("td");tr.appendChild(td);}
else{td=this.m_replacedNode.cells[ind];}
var val;if(elem.getFieldId){var f_id=elem.getFieldId();if(elem.m_node.options){val=elem.m_node.options[elem.m_node.selectedIndex].innerHTML;}
else{val=this.m_elements[elem_id].getValue();}
td.setAttribute(f_id,this.m_elements[elem_id].getFieldValue(f_id));}
else{val=this.m_elements[elem_id].getValue();}
td.innerHTML=val;}
catch(e){this.m_lastWriteResult=false;}
ind++;}
return tr;} 
function WaitControl(id){WaitControl.superclass.constructor.call(this,id+"_wait","img",{"className":"wait","attrs":{"src":this.DEF_WAIT_IMG},"visible":false});}
extend(WaitControl,Control);WaitControl.prototype.DEF_WAIT_IMG="img/wait.gif"; 
function ErrorControl(id){ErrorControl.superclass.constructor.call(this,id+"_errors","div",{});}
extend(ErrorControl,Control);ErrorControl.prototype.setValue=function(val){if(!val||val.trim()==""){DOMHandler.removeClass(this.getNode(),"alert alert-danger");}
else{DOMHandler.addClass(this.getNode(),"alert alert-danger");}
ControlContainer.superclass.setValue.call(this,val);} 
function ToolTip(options){this.m_onHover=options.onHover;this.m_node=options.node;var self=this;this.m_wait=options.wait||this.DEF_WAIT;this.m_evMouseOver=function(event){event=EventHandler.fixMouseEvent(event);self.m_timeout=setTimeout(function(){self.m_out=false;self.m_onHover(event);},self.m_wait);};this.m_evMouseOut=function(event){self.m_out=true;if(self.m_timeout){clearTimeout(self.m_timeout);self.m_timeout=null;}
self.remove();}
this.addEvent();}
ToolTip.prototype.DEF_WAIT=3000;ToolTip.prototype.popup=function(content,options){options=options||{};this.m_active=true;tooltip.show(content,options.width,options.title,options.className);if(this.m_out){this.remove();}}
ToolTip.prototype.remove=function(){tooltip.hide();this.m_active=false;}
ToolTip.prototype.getWait=function(){return this.m_wait;}
ToolTip.prototype.setWait=function(wait){this.m_wait=wait;this.removeEvent();if(wait>0){this.addEvent();}}
ToolTip.prototype.addEvent=function(){EventHandler.addEvent(this.m_node,"mouseover",this.m_evMouseOver,false);EventHandler.addEvent(this.m_node,"mouseout",this.m_evMouseOut,false);}
ToolTip.prototype.removeEvent=function(){EventHandler.removeEvent(this.m_node,"mouseover",this.m_evMouseOver,false);EventHandler.removeEvent(this.m_node,"mouseout",this.m_evMouseOut,false);}
var tooltip=function(){var id='tt';var top=3;var left=3;var maxw=300;var speed=10;var timer=20;var endalpha=95;var alpha=0;var tt,c,b,h,te;var ie=document.all?true:false;return{show:function(v,w,title,cl){tt=nd(id);if(tt==null){tt=document.createElement("div");tt.setAttribute("id",id);tt.className="popover popover-tip top"+((cl)?" "+cl:"");tt.setAttribute("role","tooltip");te=document.createElement('h3');te.className="popover-title";if(title){tt.appendChild(te);}
c=document.createElement('div');c.setAttribute('id',id+'cont');c.className="popover-content";tt.appendChild(c);document.body.appendChild(tt);tt.style.opacity=0;tt.style.filter='alpha(opacity=0)';}
if(title){te.innerHTML=title;}
document.onmousemove=this.pos;tt.style.display='block';c.innerHTML=v;tt.style.width=w?w+'px':'auto';if(tt.offsetWidth>maxw){tt.style.width=maxw+'px'}
h=parseInt(tt.offsetHeight)+top;clearInterval(tt.timer);tt.timer=setInterval(function(){tooltip.fade(1)},timer);},pos:function(e){var u=ie?event.clientY+document.documentElement.scrollTop:e.pageY;var l=ie?event.clientX+document.documentElement.scrollLeft:e.pageX;tt.style.top=(u-h)+'px';tt.style.left=(l+left)+'px';},fade:function(d){if(!tt){return;}
var a=alpha;if((a!=endalpha&&d==1)||(a!=0&&d==-1)){var i=speed;if(endalpha-a<speed&&d==1){i=endalpha-a;}else if(alpha<speed&&d==-1){i=a;}
alpha=a+(i*d);tt.style.opacity=alpha*.01;tt.style.filter='alpha(opacity='+alpha+')';}else{clearInterval(tt.timer);if(d==-1){tt.style.display='none'}}},hide:function(){if(tt){clearInterval(tt.timer);tt.timer=setInterval(function(){tooltip.fade(-1)},timer);}}};}(); 
function CurrentDateTime(id,options){options=options||{};this.m_pattern=options.pattern||this.DEF_PATTERN;this.m_interval=options.interval||this.DEF_INTERVAL;CurrentDateTime.superclass.constructor.call(this,id,"span",options);this.m_sync=options.sync;this.m_resyncInterval=options.resyncInterval;}
extend(CurrentDateTime,Control);CurrentDateTime.prototype.DEF_PATTERN="dd M yy hh:mmin";CurrentDateTime.prototype.DEF_INTERVAL=30000;CurrentDateTime.prototype.DEF_RESYNC_INTERVAL=60*60*1000;CurrentDateTime.prototype.SYNC_SCRIPT="functions/ntp.php";CurrentDateTime.prototype.sync=function(){var con=new ServConnector(HOST_NAME,this.SYNC_SCRIPT);this.m_t0=(new Date()).valueOf();var self=this;con.sendRequest(true,null,true,function(error_n,error_s,resp){var t1=resp;var t2=resp;var t3=(new Date()).valueOf();var c=ntp(this.m_t0,t1,t2,t3);this.m_offset=c.offset;},this,false);}
CurrentDateTime.prototype.update=function(){var time;if(this.m_sync&&this.m_offset){time=new Date((new Date()).valueOf()+this.m_offset);}
this.setValue(DateHandler.dateToStr(time,this.m_pattern));}
CurrentDateTime.prototype.toDOM=function(parent){CurrentDateTime.superclass.toDOM.call(this,parent);this.update();var self=this;this.m_intervalObj=setInterval(function(){self.update();},this.m_interval);if(this.m_sync){this.sync();this.m_ResyncIntervalObj=setInterval(function(){self.sync();},this.m_resyncInterval||this.DEF_RESYNC_INTERVAL);}}
CurrentDateTime.prototype.removeDOM=function(){clearInterval(this.m_intervalObj);clearInterval(this.m_ResyncIntervalObj);CurrentDateTime.superclass.removeDOM.call(this);}
function ntp(t0,t1,t2,t3){return{roundtripdelay:(t3-t0)-(t2-t1),offset:((t1-t0)+(t2-t3))/2};} 
function Kladr2_View(id,options){options.className=options.className||"form-group";Kladr2_View.superclass.constructor.call(this,id,"div",options);this.m_controller=new Kladr_Controller(new ServConnector(HOST_NAME));var self=this;var cont=new ControlContainer(uuid(),"div",{className:get_bs_col()+"6"});this.m_ctrlRegion=new EditObject(id+"_region",{"labelCaption":"Регион:","attrs":{"title":"Наименование региона (можно не заполнять)"},"name":"region","noSelect":true,"noOpen":true,"attrs":{"title":"Регион"},"winObj":options.winObj,"minLengthForQuery":1,"lookupController":this.m_controller,"lookupMethodId":"get_region_list","lookupModelId":"Kladr_Model","lookupValueFieldId":"full_name","patternParamId":"pattern","lookupKeyFieldIds":["region_code"],"keyFieldIds":["region_code"]});cont.addElement(this.m_ctrlRegion);this.m_ctrlRaion=new EditObject(id+"_raion",{"className":"hidden","name":"raion","noSelect":true,"noOpen":true,"noClear":true});cont.addElement(this.m_ctrlRaion);this.m_ctrlNasPunkt=new EditObject(id+"_naspunkt",{"className":"hidden","name":"naspunkt","noSelect":true,"noOpen":true,"noClear":true});cont.addElement(this.m_ctrlNasPunkt);this.m_ctrlGorod=new EditObject(id+"_gorod",{"labelCaption":"Город (нас.пункт):","name":"gorod","attrs":{"title":"Наименование город,деревни,села и т.д.","focus":true},"winObj":options.winObj,"noSelect":true,"noOpen":true,"minLengthForQuery":2,"lookupController":this.m_controller,"lookupMethodId":"get_from_naspunkt","lookupModelId":"Kladr_Model","lookupValueFieldId":"full_name","patternParamId":"pattern","lookupKeyFieldIds":["code"],"keyFieldIds":["gorod_code"],"extraFields":["region_name","region_code","raion_name","raion_code"],"resultFieldId":"name","onSelected":function(inputNode){self.m_ctrlRegion.setValue(DOMHandler.getAttr(inputNode,"region_name"));self.m_ctrlRegion.setAttr("fkey_region_code",DOMHandler.getAttr(inputNode,"region_code"));self.m_ctrlGorod.setAttr("fkey_code",DOMHandler.getAttr(inputNode,"region_code"));self.m_ctrlRaion.setValue(DOMHandler.getAttr(inputNode,"raion_name"));self.m_ctrlRaion.setAttr("fkey_raion_code",DOMHandler.getAttr(inputNode,"raion_code"));}});cont.addElement(this.m_ctrlGorod);this.m_ctrlUlitza=new EditObject(id+"_ulitza",{"labelCaption":"Улица:","name":"ulitza","attrs":{"title":"Улица"},"winObj":options.winObj,"noSelect":true,"noOpen":true,"minLengthForQuery":1,"lookupController":this.m_controller,"lookupMethodId":"get_ulitsa_list","lookupModelId":"Kladr_Model","lookupValueFieldId":"full_name","patternParamId":"pattern","lookupKeyFieldIds":["ulitza_code"],"keyFieldIds":["ulitza_code"],"events":{"focus":function(){var pm=self.m_controller.getPublicMethodById("get_ulitsa_list");pm.setParamValue("region_code",self.m_ctrlRegion.getAttr("fkey_region_code"));pm.setParamValue("raion_code",self.m_ctrlRaion.getAttr("fkey_raion_code"));pm.setParamValue("naspunkt_code",null);pm.setParamValue("gorod_code",self.m_ctrlGorod.getAttr("fkey_gorod_code"));}}});cont.addElement(this.m_ctrlUlitza);this.addElement(cont);var cont=new ControlContainer(uuid(),"div",{className:get_bs_col()+"6"});this.m_ctrlDom=new EditString(id+"_dom",{"labelCaption":"Дом:","name":"dom","attrs":{"title":"Дом"},"winObj":options.winObj,"noSelect":true,"noOpen":true});cont.addElement(this.m_ctrlDom);this.m_ctrlKorpus=new EditString(id+"_korpus",{"labelCaption":"Корпус:","name":"korpus","attrs":{"title":"Корпус"},"winObj":options.winObj,"noSelect":true,"noOpen":true});cont.addElement(this.m_ctrlKorpus);this.m_ctrlKvartira=new EditString(id+"_kvartira",{"labelCaption":"Квартира:","name":"kvartira","attrs":{"title":"Квартира"},"winObj":options.winObj,"noSelect":true,"noOpen":true});cont.addElement(this.m_ctrlKvartira);this.addElement(cont);}
extend(Kladr2_View,ControlContainer); 
function FileLoader(id,options){options=options||{};options.className=options.className||this.DEF_CLASS;FileLoader.superclass.constructor.call(this,id,"form",options);this.m_files=options.files;this.m_controller=options.controller;this.m_methodId=options.methodId;this.m_getMethodId=options.getMethodId;this.m_onFileUploadEnd=options.onFileUploadEnd;this.m_onFileDiwnload=options.onFileDiwnload;}
extend(FileLoader,Control);FileLoader.prototype.DEF_CLASS="ctrlFlLoad";FileLoader.prototype.toDOM=function(parent){FileLoader.superclass.toDOM.call(this,parent);this.m_filesCtrl={};this.m_filesCapCtrl={};var self=this;for(var id in this.m_files){(new Button(id+"_download",{"caption":"Скачать","onClick":function(){if(self.m_onFileDownload){self.m_onFileDownload.call(self);}
else{top.location.href=HOST_NAME+"index.php?"+
self.m_controller.getQueryString(self.m_controller.getPublicMethodById(self.m_getMethodId));}}})).toDOM(this.m_node);var file=this.m_files[id];if(file.caption!=undefined){this.m_filesCapCtrl[id]=new Control(file.name+"_cap","div",{"value":file.caption});this.m_filesCapCtrl[id].toDOM(this.m_node);}
this.m_filesCtrl[id]=new Control(file.name,"input",{"attrs":{"type":"file","name":file.name}});this.m_filesCtrl[id].toDOM(this.m_node);}
this.m_submitCtrl=new Control(id+"_submit","input",{"attrs":{"type":"submit","value":"Загрузить"}});this.m_submitCtrl.toDOM(this.m_node);this.m_node.onsubmit=function(){var params={};for(var id in self.m_filesCtrl){params[self.m_filesCtrl[id].m_node.name]=self.m_filesCtrl[id].m_node.files[0];}
self.m_controller.run(self.m_methodId,{"async":true,"get":false,"params":params,"func":function(resp){if(self.m_onFileUploadEnd){self.m_onFileUploadEnd.call(self,resp);}}});return false;}}
FileLoader.prototype.removeDOM=function(){FileLoader.superclass.removeDOM.call(this);} 
function WindowFormModalBS(id,options){options=options||{};options.className=options.className||"modal fade";options.attrs=options.attrs||{};options.attrs.role="dialog";WindowFormModalBS.superclass.constructor.call(this,id,"div",options);this.m_dialog=new ControlContainer(id+"_dial","div",{className:"modal-dialog"});this.m_content=new ControlContainer(id+"_cont","div",{className:"modal-content"});this.m_header=new ControlContainer(id+"_head","div",{className:"modal-header"});this.m_header.addElement(new Control(id+"_close","button",{className:"close",attrs:{"data-dismiss":"modal","aria-label":"Close"}}));this.m_body=new ControlContainer(id+"_body","div",{className:"modal-body"});if(options.content){this.m_body.addElement(options.content);}
this.m_footer=new ControlContainer(id+"_footer","div",{className:"modal-footer"});this.m_content.addElement(this.m_header);this.m_content.addElement(this.m_body);this.m_content.addElement(this.m_footer);this.m_dialog.addElement(this.m_content);}
extend(WindowFormModalBS,ControlContainer);WindowFormModalBS.prototype.toDOM=function(parent){WindowFormModalBS.superclass.toDOM.call(this,parent);this.m_dialog.toDOM(this.getNode());$(this.getNode()).modal({show:true,keyboard:true});}
WindowFormModalBS.prototype.removeDOM=function(){$(this.getNode()).modal("hide");this.m_dialog.removeDOM();WindowFormModalBS.superclass.toDOM.call(this);}
WindowFormModalBS.prototype.open=function(){this.toDOM(document.body);}
WindowFormModalBS.prototype.close=function(){this.removeDOM();}
WindowFormModalBS.prototype.getContentParent=function(){return this.m_body.getNode();}
WindowFormModalBS.prototype.setCaption=function(caption){}
WindowFormModalBS.prototype.setFocus=function(){} 
function ButtonOrgSearch(id,options){options=options||{};options.glyph="glyphicon-search";options.title="Найти контрагента по базе ЕГРЮЛ/ЕГРИП";this.m_viewContext=options.viewContext;this.m_onGetData=options.onGetData;this.m_checkIfExists=options.checkIfExists;this.m_clientId=options.clientId;var self=this;options.onClick=options.onClick||function(event){self.doSearch();};ButtonOrgSearch.superclass.constructor.call(this,id,options);}
extend(ButtonOrgSearch,ButtonCtrl);ButtonOrgSearch.prototype.doSearch=function(){var node=nd("Client_inn");if(!node.value||!node.value.length){throw new Error("Не задан параметр поиска!");}
var contr=new ClientSearch_Controller(new ServConnector(HOST_NAME));var self=this;contr.run("search",{"params":{"query":node.value,"checkIfExists":this.m_checkIfExists,"client_id":this.m_clientId},"func":function(resp){var m=resp.getModelById("SearchResult_Model",true);while(m.getNextRow()){var v=m.getFieldValue("val");if(m.getFieldValue("param")=="Наименование"){nd("Client_name_full").value=v;}
else if(m.getFieldValue("param")=="НаименованиеКраткое"){nd("Client_name").value=v;}
else if(m.getFieldValue("param")=="КПП"){nd("Client_kpp").value=v;}
else if(m.getFieldValue("param")=="Адрес"){nd("Client_addr_reg").value=v;}
else if(m.getFieldValue("param")=="ОГРН"){nd("Client_ogrn").value=v;}}}});} /*

  OpenLayers.js -- OpenLayers Map Viewer Library

  Copyright (c) 2006-2013 by OpenLayers Contributors
  Published under the 2-clause BSD license.
  See http://openlayers.org/dev/license.txt for the full text of the license, and http://openlayers.org/dev/authors.txt for full list of contributors.

  Includes compressed code under the following licenses:

  (For uncompressed versions of the code used, please see the
  OpenLayers Github repository: <https://github.com/openlayers/openlayers>)

*/

/**
 * Contains XMLHttpRequest.js <http://code.google.com/p/xmlhttprequest/>
 * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 */

/**
 * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is
 * Copyright (c) 2006, Yahoo! Inc.
 * All rights reserved.
 * 
 * Redistribution and use of this software in source and binary forms, with or
 * without modification, are permitted provided that the following conditions
 * are met:
 * 
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * 
 * * Neither the name of Yahoo! Inc. nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission of Yahoo! Inc.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 * POSSIBILITY OF SUCH DAMAGE.
 */
var OpenLayers={VERSION_NUMBER:"Release 2.13.1",singleFile:!0,_getScriptLocation:function(){for(var a=/(^|(.*?\/))(OpenLayers[^\/]*?\.js)(\?|$)/,b=document.getElementsByTagName("script"),c,d="",e=0,f=b.length;e<f;e++)if(c=b[e].getAttribute("src"))if(c=c.match(a)){d=c[1];break}return function(){return d}}(),ImgPath:""};OpenLayers.Class=function(){var a=arguments.length,b=arguments[0],c=arguments[a-1],d="function"==typeof c.initialize?c.initialize:function(){b.prototype.initialize.apply(this,arguments)};1<a?(a=[d,b].concat(Array.prototype.slice.call(arguments).slice(1,a-1),c),OpenLayers.inherit.apply(null,a)):d.prototype=c;return d};
OpenLayers.inherit=function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;var d,e,c=2;for(d=arguments.length;c<d;c++)e=arguments[c],"function"===typeof e&&(e=e.prototype),OpenLayers.Util.extend(a.prototype,e)};OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.extend=function(a,b){a=a||{};if(b){for(var c in b){var d=b[c];void 0!==d&&(a[c]=d)}"function"==typeof window.Event&&b instanceof window.Event||(!b.hasOwnProperty||!b.hasOwnProperty("toString"))||(a.toString=b.toString)}return a};OpenLayers.String={startsWith:function(a,b){return 0==a.indexOf(b)},contains:function(a,b){return-1!=a.indexOf(b)},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(a){a=a.split("-");for(var b=a[0],c=1,d=a.length;c<d;c++)var e=a[c],b=b+(e.charAt(0).toUpperCase()+e.substring(1));return b},format:function(a,b,c){b||(b=window);return a.replace(OpenLayers.String.tokenRegEx,function(a,e){for(var f,g=e.split(/\.+/),h=0;h<g.length;h++){0==h&&(f=b);if(void 0===f)break;
f=f[g[h]]}"function"==typeof f&&(f=c?f.apply(null,c):f());return"undefined"==typeof f?"undefined":f})},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(a){return OpenLayers.String.numberRegEx.test(a)},numericIf:function(a,b){var c=a;!0===b&&(null!=a&&a.replace)&&(a=a.replace(/^\s*|\s*$/g,""));return OpenLayers.String.isNumeric(a)?parseFloat(a):c}};
OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(a,b){var c=0;0<b&&(c=parseFloat(a.toPrecision(b)));return c},format:function(a,b,c,d){b="undefined"!=typeof b?b:0;c="undefined"!=typeof c?c:OpenLayers.Number.thousandsSeparator;d="undefined"!=typeof d?d:OpenLayers.Number.decimalSeparator;null!=b&&(a=parseFloat(a.toFixed(b)));var e=a.toString().split(".");1==e.length&&null==b&&(b=0);a=e[0];if(c)for(var f=/(-?[0-9]+)([0-9]{3})/;f.test(a);)a=a.replace(f,"$1"+c+"$2");
0==b?b=a:(c=1<e.length?e[1]:"0",null!=b&&(c+=Array(b-c.length+1).join("0")),b=a+d+c);return b},zeroPad:function(a,b,c){for(a=a.toString(c||10);a.length<b;)a="0"+a;return a}};
OpenLayers.Function={bind:function(a,b){var c=Array.prototype.slice.apply(arguments,[2]);return function(){var d=c.concat(Array.prototype.slice.apply(arguments,[0]));return a.apply(b,d)}},bindAsEventListener:function(a,b){return function(c){return a.call(b,c||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}};
OpenLayers.Array={filter:function(a,b,c){var d=[];if(Array.prototype.filter)d=a.filter(b,c);else{var e=a.length;if("function"!=typeof b)throw new TypeError;for(var f=0;f<e;f++)if(f in a){var g=a[f];b.call(c,g,f,a)&&d.push(g)}}return d}};OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(a,b,c,d){OpenLayers.Util.isArray(a)&&(d=a[3],c=a[2],b=a[1],a=a[0]);null!=a&&(this.left=OpenLayers.Util.toFloat(a));null!=b&&(this.bottom=OpenLayers.Util.toFloat(b));null!=c&&(this.right=OpenLayers.Util.toFloat(c));null!=d&&(this.top=OpenLayers.Util.toFloat(d))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(a){var b=!1;null!=
a&&(b=this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom);return b},toString:function(){return[this.left,this.bottom,this.right,this.top].join()},toArray:function(a){return!0===a?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(a,b){null==a&&(a=6);var c=Math.pow(10,a),d=Math.round(this.left*c)/c,e=Math.round(this.bottom*c)/c,f=Math.round(this.right*c)/c,c=Math.round(this.top*c)/c;return!0===b?e+","+d+","+c+","+f:d+
","+e+","+f+","+c},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},
getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2));return this.centerLonLat},scale:function(a,b){null==b&&(b=this.getCenterLonLat());var c,d;"OpenLayers.LonLat"==b.CLASS_NAME?(c=b.lon,d=b.lat):(c=b.x,d=b.y);return new OpenLayers.Bounds((this.left-c)*a+c,(this.bottom-d)*a+d,(this.right-c)*a+c,(this.top-d)*a+
d)},add:function(a,b){if(null==a||null==b)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+a,this.bottom+b,this.right+a,this.top+b)},extend:function(a){if(a)switch(a.CLASS_NAME){case "OpenLayers.LonLat":this.extendXY(a.lon,a.lat);break;case "OpenLayers.Geometry.Point":this.extendXY(a.x,a.y);break;case "OpenLayers.Bounds":this.centerLonLat=null;if(null==this.left||a.left<this.left)this.left=a.left;if(null==this.bottom||a.bottom<this.bottom)this.bottom=
a.bottom;if(null==this.right||a.right>this.right)this.right=a.right;if(null==this.top||a.top>this.top)this.top=a.top}},extendXY:function(a,b){this.centerLonLat=null;if(null==this.left||a<this.left)this.left=a;if(null==this.bottom||b<this.bottom)this.bottom=b;if(null==this.right||a>this.right)this.right=a;if(null==this.top||b>this.top)this.top=b},containsLonLat:function(a,b){"boolean"===typeof b&&(b={inclusive:b});b=b||{};var c=this.contains(a.lon,a.lat,b.inclusive),d=b.worldBounds;d&&!c&&(c=d.getWidth(),
d=Math.round((a.lon-(d.left+d.right)/2)/c),c=this.containsLonLat({lon:a.lon-d*c,lat:a.lat},{inclusive:b.inclusive}));return c},containsPixel:function(a,b){return this.contains(a.x,a.y,b)},contains:function(a,b,c){null==c&&(c=!0);if(null==a||null==b)return!1;a=OpenLayers.Util.toFloat(a);b=OpenLayers.Util.toFloat(b);var d=!1;return d=c?a>=this.left&&a<=this.right&&b>=this.bottom&&b<=this.top:a>this.left&&a<this.right&&b>this.bottom&&b<this.top},intersectsBounds:function(a,b){"boolean"===typeof b&&(b=
{inclusive:b});b=b||{};if(b.worldBounds){var c=this.wrapDateLine(b.worldBounds);a=a.wrapDateLine(b.worldBounds)}else c=this;null==b.inclusive&&(b.inclusive=!0);var d=!1,e=c.left==a.right||c.right==a.left||c.top==a.bottom||c.bottom==a.top;if(b.inclusive||!e)var d=a.top>=c.bottom&&a.top<=c.top||c.top>a.bottom&&c.top<a.top,e=a.left>=c.left&&a.left<=c.right||c.left>=a.left&&c.left<=a.right,f=a.right>=c.left&&a.right<=c.right||c.right>=a.left&&c.right<=a.right,d=(a.bottom>=c.bottom&&a.bottom<=c.top||c.bottom>=
a.bottom&&c.bottom<=a.top||d)&&(e||f);if(b.worldBounds&&!d){var g=b.worldBounds,e=g.getWidth(),f=!g.containsBounds(c),g=!g.containsBounds(a);f&&!g?(a=a.add(-e,0),d=c.intersectsBounds(a,{inclusive:b.inclusive})):g&&!f&&(c=c.add(-e,0),d=a.intersectsBounds(c,{inclusive:b.inclusive}))}return d},containsBounds:function(a,b,c){null==b&&(b=!1);null==c&&(c=!0);var d=this.contains(a.left,a.bottom,c),e=this.contains(a.right,a.bottom,c),f=this.contains(a.left,a.top,c);a=this.contains(a.right,a.top,c);return b?
d||e||f||a:d&&e&&f&&a},determineQuadrant:function(a){var b="",c=this.getCenterLonLat(),b=b+(a.lat<c.lat?"b":"t");return b+=a.lon<c.lon?"l":"r"},transform:function(a,b){this.centerLonLat=null;var c=OpenLayers.Projection.transform({x:this.left,y:this.bottom},a,b),d=OpenLayers.Projection.transform({x:this.right,y:this.bottom},a,b),e=OpenLayers.Projection.transform({x:this.left,y:this.top},a,b),f=OpenLayers.Projection.transform({x:this.right,y:this.top},a,b);this.left=Math.min(c.x,e.x);this.bottom=Math.min(c.y,
d.y);this.right=Math.max(d.x,f.x);this.top=Math.max(e.y,f.y);return this},wrapDateLine:function(a,b){b=b||{};var c=b.leftTolerance||0,d=b.rightTolerance||0,e=this.clone();if(a){for(var f=a.getWidth();e.left<a.left&&e.right-d<=a.left;)e=e.add(f,0);for(;e.left+c>=a.right&&e.right>a.right;)e=e.add(-f,0);c=e.left+c;c<a.right&&(c>a.left&&e.right-d>a.right)&&(e=e.add(-f,0))}return e},CLASS_NAME:"OpenLayers.Bounds"});
OpenLayers.Bounds.fromString=function(a,b){var c=a.split(",");return OpenLayers.Bounds.fromArray(c,b)};OpenLayers.Bounds.fromArray=function(a,b){return!0===b?new OpenLayers.Bounds(a[1],a[0],a[3],a[2]):new OpenLayers.Bounds(a[0],a[1],a[2],a[3])};OpenLayers.Bounds.fromSize=function(a){return new OpenLayers.Bounds(0,a.h,a.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(a){var b;b=""+("t"==a.charAt(0)?"b":"t");return b+="l"==a.charAt(1)?"r":"l"};OpenLayers.Element={visible:function(a){return"none"!=OpenLayers.Util.getElement(a).style.display},toggle:function(){for(var a=0,b=arguments.length;a<b;a++){var c=OpenLayers.Util.getElement(arguments[a]),d=OpenLayers.Element.visible(c)?"none":"";c.style.display=d}},remove:function(a){a=OpenLayers.Util.getElement(a);a.parentNode.removeChild(a)},getHeight:function(a){a=OpenLayers.Util.getElement(a);return a.offsetHeight},hasClass:function(a,b){var c=a.className;return!!c&&RegExp("(^|\\s)"+b+"(\\s|$)").test(c)},
addClass:function(a,b){OpenLayers.Element.hasClass(a,b)||(a.className+=(a.className?" ":"")+b);return a},removeClass:function(a,b){var c=a.className;c&&(a.className=OpenLayers.String.trim(c.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," ")));return a},toggleClass:function(a,b){OpenLayers.Element.hasClass(a,b)?OpenLayers.Element.removeClass(a,b):OpenLayers.Element.addClass(a,b);return a},getStyle:function(a,b){a=OpenLayers.Util.getElement(a);var c=null;if(a&&a.style){c=a.style[OpenLayers.String.camelize(b)];
c||(document.defaultView&&document.defaultView.getComputedStyle?c=(c=document.defaultView.getComputedStyle(a,null))?c.getPropertyValue(b):null:a.currentStyle&&(c=a.currentStyle[OpenLayers.String.camelize(b)]));var d=["left","top","right","bottom"];window.opera&&(-1!=OpenLayers.Util.indexOf(d,b)&&"static"==OpenLayers.Element.getStyle(a,"position"))&&(c="auto")}return"auto"==c?null:c}};OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(a,b){OpenLayers.Util.isArray(a)&&(b=a[1],a=a[0]);this.lon=OpenLayers.Util.toFloat(a);this.lat=OpenLayers.Util.toFloat(b)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(a,b){if(null==a||null==b)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+
OpenLayers.Util.toFloat(a),this.lat+OpenLayers.Util.toFloat(b))},equals:function(a){var b=!1;null!=a&&(b=this.lon==a.lon&&this.lat==a.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(a.lon)&&isNaN(a.lat));return b},transform:function(a,b){var c=OpenLayers.Projection.transform({x:this.lon,y:this.lat},a,b);this.lon=c.x;this.lat=c.y;return this},wrapDateLine:function(a){var b=this.clone();if(a){for(;b.lon<a.left;)b.lon+=a.getWidth();for(;b.lon>a.right;)b.lon-=a.getWidth()}return b},CLASS_NAME:"OpenLayers.LonLat"});
OpenLayers.LonLat.fromString=function(a){a=a.split(",");return new OpenLayers.LonLat(a[0],a[1])};OpenLayers.LonLat.fromArray=function(a){var b=OpenLayers.Util.isArray(a);return new OpenLayers.LonLat(b&&a[0],b&&a[1])};OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(a,b){this.x=parseFloat(a);this.y=parseFloat(b)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(a){var b=!1;null!=a&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return b},distanceTo:function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))},add:function(a,b){if(null==a||null==b)throw new TypeError("Pixel.add cannot receive null values");
return new OpenLayers.Pixel(this.x+a,this.y+b)},offset:function(a){var b=this.clone();a&&(b=this.add(a.x,a.y));return b},CLASS_NAME:"OpenLayers.Pixel"});OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(a,b){this.w=parseFloat(a);this.h=parseFloat(b)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(a){var b=!1;null!=a&&(b=this.w==a.w&&this.h==a.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(a.w)&&isNaN(a.h));return b},CLASS_NAME:"OpenLayers.Size"});OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(a){alert(a)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"};
(function(){for(var a=document.getElementsByTagName("script"),b=0,c=a.length;b<c;++b)if(-1!=a[b].src.indexOf("firebug.js")&&console){OpenLayers.Util.extend(OpenLayers.Console,console);break}})();OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){OpenLayers.Lang.code||OpenLayers.Lang.setCode();return OpenLayers.Lang.code},setCode:function(a){var b;a||(a="msie"==OpenLayers.BROWSER_NAME?navigator.userLanguage:navigator.language);a=a.split("-");a[0]=a[0].toLowerCase();"object"==typeof OpenLayers.Lang[a[0]]&&(b=a[0]);if(a[1]){var c=a[0]+"-"+a[1].toUpperCase();"object"==typeof OpenLayers.Lang[c]&&(b=c)}b||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+a.join("-")+" dictionary, falling back to default language"),
b=OpenLayers.Lang.defaultCode);OpenLayers.Lang.code=b},translate:function(a,b){var c=OpenLayers.Lang[OpenLayers.Lang.getCode()];(c=c&&c[a])||(c=a);b&&(c=OpenLayers.String.format(c,b));return c}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.getElement=function(){for(var a=[],b=0,c=arguments.length;b<c;b++){var d=arguments[b];"string"==typeof d&&(d=document.getElementById(d));if(1==arguments.length)return d;a.push(d)}return a};OpenLayers.Util.isElement=function(a){return!(!a||1!==a.nodeType)};OpenLayers.Util.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};OpenLayers.Util.removeItem=function(a,b){for(var c=a.length-1;0<=c;c--)a[c]==b&&a.splice(c,1);return a};
OpenLayers.Util.indexOf=function(a,b){if("function"==typeof a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return c;return-1};OpenLayers.Util.dotless=/\./g;
OpenLayers.Util.modifyDOMElement=function(a,b,c,d,e,f,g,h){b&&(a.id=b.replace(OpenLayers.Util.dotless,"_"));c&&(a.style.left=c.x+"px",a.style.top=c.y+"px");d&&(a.style.width=d.w+"px",a.style.height=d.h+"px");e&&(a.style.position=e);f&&(a.style.border=f);g&&(a.style.overflow=g);0<=parseFloat(h)&&1>parseFloat(h)?(a.style.filter="alpha(opacity="+100*h+")",a.style.opacity=h):1==parseFloat(h)&&(a.style.filter="",a.style.opacity="")};
OpenLayers.Util.createDiv=function(a,b,c,d,e,f,g,h){var k=document.createElement("div");d&&(k.style.backgroundImage="url("+d+")");a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));e||(e="absolute");OpenLayers.Util.modifyDOMElement(k,a,b,c,e,f,g,h);return k};
OpenLayers.Util.createImage=function(a,b,c,d,e,f,g,h){var k=document.createElement("img");a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));e||(e="relative");OpenLayers.Util.modifyDOMElement(k,a,b,c,e,f,null,g);h&&(k.style.display="none",b=function(){k.style.display="";OpenLayers.Event.stopObservingElement(k)},OpenLayers.Event.observe(k,"load",b),OpenLayers.Event.observe(k,"error",b));k.style.alt=a;k.galleryImg="no";d&&(k.src=d);return k};OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;
OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(null==OpenLayers.Util.alphaHackNeeded){var a=navigator.appVersion.split("MSIE"),a=parseFloat(a[1]),b=!1;try{b=!!document.body.filters}catch(c){}OpenLayers.Util.alphaHackNeeded=b&&5.5<=a&&7>a}return OpenLayers.Util.alphaHackNeeded};
OpenLayers.Util.modifyAlphaImageDiv=function(a,b,c,d,e,f,g,h,k){OpenLayers.Util.modifyDOMElement(a,b,c,d,f,null,null,k);b=a.childNodes[0];e&&(b.src=e);OpenLayers.Util.modifyDOMElement(b,a.id+"_innerImage",null,d,"relative",g);OpenLayers.Util.alphaHack()&&("none"!=a.style.display&&(a.style.display="inline-block"),null==h&&(h="scale"),a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b.src+"', sizingMethod='"+h+"')",0<=parseFloat(a.style.opacity)&&1>parseFloat(a.style.opacity)&&
(a.style.filter+=" alpha(opacity="+100*a.style.opacity+")"),b.style.filter="alpha(opacity=0)")};OpenLayers.Util.createAlphaImageDiv=function(a,b,c,d,e,f,g,h,k){var l=OpenLayers.Util.createDiv();k=OpenLayers.Util.createImage(null,null,null,null,null,null,null,k);k.className="olAlphaImg";l.appendChild(k);OpenLayers.Util.modifyAlphaImageDiv(l,a,b,c,d,e,f,g,h);return l};OpenLayers.Util.upperCaseObject=function(a){var b={},c;for(c in a)b[c.toUpperCase()]=a[c];return b};
OpenLayers.Util.applyDefaults=function(a,b){a=a||{};var c="function"==typeof window.Event&&b instanceof window.Event,d;for(d in b)if(void 0===a[d]||!c&&b.hasOwnProperty&&b.hasOwnProperty(d)&&!a.hasOwnProperty(d))a[d]=b[d];!c&&(b&&b.hasOwnProperty&&b.hasOwnProperty("toString")&&!a.hasOwnProperty("toString"))&&(a.toString=b.toString);return a};
OpenLayers.Util.getParameterString=function(a){var b=[],c;for(c in a){var d=a[c];if(null!=d&&"function"!=typeof d){if("object"==typeof d&&d.constructor==Array){for(var e=[],f,g=0,h=d.length;g<h;g++)f=d[g],e.push(encodeURIComponent(null===f||void 0===f?"":f));d=e.join(",")}else d=encodeURIComponent(d);b.push(encodeURIComponent(c)+"="+d)}}return b.join("&")};OpenLayers.Util.urlAppend=function(a,b){var c=a;if(b)var d=(a+" ").split(/[?&]/),c=c+(" "===d.pop()?b:d.length?"&"+b:"?"+b);return c};
OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"};OpenLayers.Util.getImageLocation=function(a){return OpenLayers.Util.getImagesLocation()+a};OpenLayers.Util.Try=function(){for(var a=null,b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a};
OpenLayers.Util.getXmlNodeValue=function(a){var b=null;OpenLayers.Util.Try(function(){b=a.text;b||(b=a.textContent);b||(b=a.firstChild.nodeValue)},function(){b=a.textContent});return b};OpenLayers.Util.mouseLeft=function(a,b){for(var c=a.relatedTarget?a.relatedTarget:a.toElement;c!=b&&null!=c;)c=c.parentNode;return c!=b};OpenLayers.Util.DEFAULT_PRECISION=14;OpenLayers.Util.toFloat=function(a,b){null==b&&(b=OpenLayers.Util.DEFAULT_PRECISION);"number"!==typeof a&&(a=parseFloat(a));return 0===b?a:parseFloat(a.toPrecision(b))};
OpenLayers.Util.rad=function(a){return a*Math.PI/180};OpenLayers.Util.deg=function(a){return 180*a/Math.PI};OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563};
OpenLayers.Util.distVincenty=function(a,b){for(var c=OpenLayers.Util.VincentyConstants,d=c.a,e=c.b,c=c.f,f=OpenLayers.Util.rad(b.lon-a.lon),g=Math.atan((1-c)*Math.tan(OpenLayers.Util.rad(a.lat))),h=Math.atan((1-c)*Math.tan(OpenLayers.Util.rad(b.lat))),k=Math.sin(g),g=Math.cos(g),l=Math.sin(h),h=Math.cos(h),m=f,n=2*Math.PI,p=20;1E-12<Math.abs(m-n)&&0<--p;){var q=Math.sin(m),r=Math.cos(m),s=Math.sqrt(h*q*h*q+(g*l-k*h*r)*(g*l-k*h*r));if(0==s)return 0;var r=k*l+g*h*r,t=Math.atan2(s,r),u=Math.asin(g*h*
q/s),v=Math.cos(u)*Math.cos(u),q=r-2*k*l/v,w=c/16*v*(4+c*(4-3*v)),n=m,m=f+(1-w)*c*Math.sin(u)*(t+w*s*(q+w*r*(-1+2*q*q)))}if(0==p)return NaN;d=v*(d*d-e*e)/(e*e);c=d/1024*(256+d*(-128+d*(74-47*d)));return(e*(1+d/16384*(4096+d*(-768+d*(320-175*d))))*(t-c*s*(q+c/4*(r*(-1+2*q*q)-c/6*q*(-3+4*s*s)*(-3+4*q*q))))).toFixed(3)/1E3};
OpenLayers.Util.destinationVincenty=function(a,b,c){var d=OpenLayers.Util,e=d.VincentyConstants,f=e.a,g=e.b,h=e.f,e=a.lon;a=a.lat;var k=d.rad(b);b=Math.sin(k);k=Math.cos(k);a=(1-h)*Math.tan(d.rad(a));var l=1/Math.sqrt(1+a*a),m=a*l,n=Math.atan2(a,k);a=l*b;for(var p=1-a*a,f=p*(f*f-g*g)/(g*g),q=1+f/16384*(4096+f*(-768+f*(320-175*f))),r=f/1024*(256+f*(-128+f*(74-47*f))),f=c/(g*q),s=2*Math.PI;1E-12<Math.abs(f-s);)var t=Math.cos(2*n+f),u=Math.sin(f),v=Math.cos(f),w=r*u*(t+r/4*(v*(-1+2*t*t)-r/6*t*(-3+4*
u*u)*(-3+4*t*t))),s=f,f=c/(g*q)+w;c=m*u-l*v*k;g=Math.atan2(m*v+l*u*k,(1-h)*Math.sqrt(a*a+c*c));b=Math.atan2(u*b,l*v-m*u*k);k=h/16*p*(4+h*(4-3*p));t=b-(1-k)*h*a*(f+k*u*(t+k*v*(-1+2*t*t)));Math.atan2(a,-c);return new OpenLayers.LonLat(e+d.deg(t),d.deg(g))};
OpenLayers.Util.getParameters=function(a,b){b=b||{};a=null===a||void 0===a?window.location.href:a;var c="";if(OpenLayers.String.contains(a,"?"))var d=a.indexOf("?")+1,c=OpenLayers.String.contains(a,"#")?a.indexOf("#"):a.length,c=a.substring(d,c);for(var d={},c=c.split(/[&;]/),e=0,f=c.length;e<f;++e){var g=c[e].split("=");if(g[0]){var h=g[0];try{h=decodeURIComponent(h)}catch(k){h=unescape(h)}g=(g[1]||"").replace(/\+/g," ");try{g=decodeURIComponent(g)}catch(l){g=unescape(g)}!1!==b.splitArgs&&(g=g.split(","));
1==g.length&&(g=g[0]);d[h]=g}}return d};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(a){a=null==a?"id_":a.replace(OpenLayers.Util.dotless,"_");OpenLayers.Util.lastSeqID+=1;return a+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.37,km:39370,dd:4374754,yd:36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m;
OpenLayers.METERS_PER_INCH=0.0254000508001016;
OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:0.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:0.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:0.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:0.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:0.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:0.0254/OpenLayers.METERS_PER_INCH,MicroInch:2.54E-5/OpenLayers.METERS_PER_INCH,Mil:2.54E-8/OpenLayers.METERS_PER_INCH,
Centimeter:0.01/OpenLayers.METERS_PER_INCH,Kilometer:1E3/OpenLayers.METERS_PER_INCH,Yard:0.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:0.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:0.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:0.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:0.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:0.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:0.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:0.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:0.3047996/
OpenLayers.METERS_PER_INCH,IndianFt75:0.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:0.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:0.1/OpenLayers.METERS_PER_INCH,Millimeter:0.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,
Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:0.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:0.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:0.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:0.20116782494375873/OpenLayers.METERS_PER_INCH,
SearsLink:0.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:0.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:0.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:0.304812252984506/
OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5E4/OpenLayers.METERS_PER_INCH,"150kilometers":15E4/OpenLayers.METERS_PER_INCH});
OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1E3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:100*OpenLayers.INCHES_PER_UNIT.Meter,km:1E3*OpenLayers.INCHES_PER_UNIT.Meter,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,
"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(a){return 1<a?1/a:a};OpenLayers.Util.getResolutionFromScale=function(a,b){var c;a&&(null==b&&(b="degrees"),c=1/(OpenLayers.Util.normalizeScale(a)*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH));return c};
OpenLayers.Util.getScaleFromResolution=function(a,b){null==b&&(b="degrees");return a*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH};
OpenLayers.Util.pagePosition=function(a){var b=[0,0],c=OpenLayers.Util.getViewportElement();if(!a||a==window||a==c)return b;var d=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&"absolute"==OpenLayers.Element.getStyle(a,"position")&&(""==a.style.top||""==a.style.left),e=null;if(a.getBoundingClientRect)a=a.getBoundingClientRect(),e=window.pageYOffset||c.scrollTop,b[0]=a.left+(window.pageXOffset||c.scrollLeft),b[1]=a.top+e;else if(document.getBoxObjectFor&&!d)a=document.getBoxObjectFor(a),c=document.getBoxObjectFor(c),
b[0]=a.screenX-c.screenX,b[1]=a.screenY-c.screenY;else{b[0]=a.offsetLeft;b[1]=a.offsetTop;e=a.offsetParent;if(e!=a)for(;e;)b[0]+=e.offsetLeft,b[1]+=e.offsetTop,e=e.offsetParent;c=OpenLayers.BROWSER_NAME;if("opera"==c||"safari"==c&&"absolute"==OpenLayers.Element.getStyle(a,"position"))b[1]-=document.body.offsetTop;for(e=a.offsetParent;e&&e!=document.body;){b[0]-=e.scrollLeft;if("opera"!=c||"TR"!=e.tagName)b[1]-=e.scrollTop;e=e.offsetParent}}return b};
OpenLayers.Util.getViewportElement=function(){var a=arguments.callee.viewportElement;void 0==a&&(a="msie"==OpenLayers.BROWSER_NAME&&"CSS1Compat"!=document.compatMode?document.body:document.documentElement,arguments.callee.viewportElement=a);return a};
OpenLayers.Util.isEquivalentUrl=function(a,b,c){c=c||{};OpenLayers.Util.applyDefaults(c,{ignoreCase:!0,ignorePort80:!0,ignoreHash:!0,splitArgs:!1});a=OpenLayers.Util.createUrlObject(a,c);b=OpenLayers.Util.createUrlObject(b,c);for(var d in a)if("args"!==d&&a[d]!=b[d])return!1;for(d in a.args){if(a.args[d]!=b.args[d])return!1;delete b.args[d]}for(d in b.args)return!1;return!0};
OpenLayers.Util.createUrlObject=function(a,b){b=b||{};if(!/^\w+:\/\//.test(a)){var c=window.location,d=c.port?":"+c.port:"",d=c.protocol+"//"+c.host.split(":").shift()+d;0===a.indexOf("/")?a=d+a:(c=c.pathname.split("/"),c.pop(),a=d+c.join("/")+"/"+a)}b.ignoreCase&&(a=a.toLowerCase());c=document.createElement("a");c.href=a;d={};d.host=c.host.split(":").shift();d.protocol=c.protocol;d.port=b.ignorePort80?"80"==c.port||"0"==c.port?"":c.port:""==c.port||"0"==c.port?"80":c.port;d.hash=b.ignoreHash||"#"===
c.hash?"":c.hash;var e=c.search;e||(e=a.indexOf("?"),e=-1!=e?a.substr(e):"");d.args=OpenLayers.Util.getParameters(e,{splitArgs:b.splitArgs});d.pathname="/"==c.pathname.charAt(0)?c.pathname:"/"+c.pathname;return d};OpenLayers.Util.removeTail=function(a){var b=null,b=a.indexOf("?"),c=a.indexOf("#");return b=-1==b?-1!=c?a.substr(0,c):a:-1!=c?a.substr(0,Math.min(b,c)):a.substr(0,b)};OpenLayers.IS_GECKO=function(){var a=navigator.userAgent.toLowerCase();return-1==a.indexOf("webkit")&&-1!=a.indexOf("gecko")}();
OpenLayers.CANVAS_SUPPORTED=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}();OpenLayers.BROWSER_NAME=function(){var a="",b=navigator.userAgent.toLowerCase();-1!=b.indexOf("opera")?a="opera":-1!=b.indexOf("msie")?a="msie":-1!=b.indexOf("safari")?a="safari":-1!=b.indexOf("mozilla")&&(a=-1!=b.indexOf("firefox")?"firefox":"mozilla");return a}();OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME};
OpenLayers.Util.getRenderedDimensions=function(a,b,c){var d,e,f=document.createElement("div");f.style.visibility="hidden";for(var g=c&&c.containerElement?c.containerElement:document.body,h=!1,k=null,l=g;l&&"body"!=l.tagName.toLowerCase();){var m=OpenLayers.Element.getStyle(l,"position");if("absolute"==m){h=!0;break}else if(m&&"static"!=m)break;l=l.parentNode}!h||0!==g.clientHeight&&0!==g.clientWidth||(k=document.createElement("div"),k.style.visibility="hidden",k.style.position="absolute",k.style.overflow=
"visible",k.style.width=document.body.clientWidth+"px",k.style.height=document.body.clientHeight+"px",k.appendChild(f));f.style.position="absolute";b&&(b.w?(d=b.w,f.style.width=d+"px"):b.h&&(e=b.h,f.style.height=e+"px"));c&&c.displayClass&&(f.className=c.displayClass);b=document.createElement("div");b.innerHTML=a;b.style.overflow="visible";if(b.childNodes)for(a=0,c=b.childNodes.length;a<c;a++)b.childNodes[a].style&&(b.childNodes[a].style.overflow="visible");f.appendChild(b);k?g.appendChild(k):g.appendChild(f);
d||(d=parseInt(b.scrollWidth),f.style.width=d+"px");e||(e=parseInt(b.scrollHeight));f.removeChild(b);k?(k.removeChild(f),g.removeChild(k)):g.removeChild(f);return new OpenLayers.Size(d,e)};
OpenLayers.Util.getScrollbarWidth=function(){var a=OpenLayers.Util._scrollbarWidth;if(null==a){var b=null,c=null,b=a=0,b=document.createElement("div");b.style.position="absolute";b.style.top="-1000px";b.style.left="-1000px";b.style.width="100px";b.style.height="50px";b.style.overflow="hidden";c=document.createElement("div");c.style.width="100%";c.style.height="200px";b.appendChild(c);document.body.appendChild(b);a=c.offsetWidth;b.style.overflow="scroll";b=c.offsetWidth;document.body.removeChild(document.body.lastChild);
OpenLayers.Util._scrollbarWidth=a-b;a=OpenLayers.Util._scrollbarWidth}return a};
OpenLayers.Util.getFormattedLonLat=function(a,b,c){c||(c="dms");a=(a+540)%360-180;var d=Math.abs(a),e=Math.floor(d),f=d=(d-e)/(1/60),d=Math.floor(d),f=Math.round(10*((f-d)/(1/60))),f=f/10;60<=f&&(f-=60,d+=1,60<=d&&(d-=60,e+=1));10>e&&(e="0"+e);e+="\u00b0";0<=c.indexOf("dm")&&(10>d&&(d="0"+d),e+=d+"'",0<=c.indexOf("dms")&&(10>f&&(f="0"+f),e+=f+'"'));return e="lon"==b?e+(0>a?OpenLayers.i18n("W"):OpenLayers.i18n("E")):e+(0>a?OpenLayers.i18n("S"):OpenLayers.i18n("N"))};OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a},destroy:function(){},read:function(a){throw Error("Read not implemented.");},write:function(a){throw Error("Write not implemented.");},CLASS_NAME:"OpenLayers.Format"});OpenLayers.Format.CSWGetRecords=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetRecords.DEFAULTS);var b=OpenLayers.Format.CSWGetRecords["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSWGetRecords version: "+a.version;return new b(a)};OpenLayers.Format.CSWGetRecords.DEFAULTS={version:"2.0.2"};OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handlerOptions:null,handler:null,eventListeners:null,events:null,initialize:function(a){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,a);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+
"_"))},destroy:function(){this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.events=null);this.eventListeners=null;this.handler&&(this.handler.destroy(),this.handler=null);if(this.handlers){for(var a in this.handlers)this.handlers.hasOwnProperty(a)&&"function"==typeof this.handlers[a].destroy&&this.handlers[a].destroy();this.handlers=null}this.map&&(this.map.removeControl(this),this.map=null);this.div=null},setMap:function(a){this.map=a;this.handler&&
this.handler.setMap(a)},draw:function(a){null==this.div&&(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),""!=this.title&&(this.div.title=this.title));null!=a&&(this.position=a.clone());this.moveTo(this.position);return this.div},moveTo:function(a){null!=a&&null!=this.div&&(this.div.style.left=a.x+"px",this.div.style.top=
a.y+"px")},activate:function(){if(this.active)return!1;this.handler&&this.handler.activate();this.active=!0;this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active");this.events.triggerEvent("activate");return!0},deactivate:function(){return this.active?(this.handler&&this.handler.deactivate(),this.active=!1,this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"),
!0):!1},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(a){return a.target||a.srcElement},isSingleTouch:function(a){return a.touches&&1==a.touches.length},isMultiTouch:function(a){return a.touches&&1<a.touches.length},isLeftClick:function(a){return a.which&&1==a.which||a.button&&1==a.button},isRightClick:function(a){return a.which&&3==a.which||a.button&&2==a.button},stop:function(a,
b){b||OpenLayers.Event.preventDefault(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},findElement:function(a,b){for(var c=OpenLayers.Event.element(a);c.parentNode&&(!c.tagName||c.tagName.toUpperCase()!=b.toUpperCase());)c=c.parentNode;return c},observe:function(a,b,c,d){a=OpenLayers.Util.getElement(a);d=d||!1;"keypress"==b&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.attachEvent)&&(b="keydown");
this.observers||(this.observers={});if(!a._eventCacheID){var e="eventCacheID_";a.id&&(e=a.id+"_"+e);a._eventCacheID=OpenLayers.Util.createUniqueID(e)}e=a._eventCacheID;this.observers[e]||(this.observers[e]=[]);this.observers[e].push({element:a,name:b,observer:c,useCapture:d});a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)},stopObservingElement:function(a){a=OpenLayers.Util.getElement(a)._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[a])},
_removeElementObservers:function(a){if(a)for(var b=a.length-1;0<=b;b--){var c=a[b];OpenLayers.Event.stopObserving.apply(this,[c.element,c.name,c.observer,c.useCapture])}},stopObserving:function(a,b,c,d){d=d||!1;a=OpenLayers.Util.getElement(a);var e=a._eventCacheID;"keypress"==b&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.detachEvent)&&(b="keydown");var f=!1,g=OpenLayers.Event.observers[e];if(g)for(var h=0;!f&&h<g.length;){var k=g[h];if(k.name==b&&k.observer==c&&k.useCapture==d){g.splice(h,
1);0==g.length&&delete OpenLayers.Event.observers[e];f=!0;break}h++}f&&(a.removeEventListener?a.removeEventListener(b,c,d):a&&a.detachEvent&&a.detachEvent("on"+b,c));return f},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var a in OpenLayers.Event.observers)OpenLayers.Event._removeElementObservers.apply(this,[OpenLayers.Event.observers[a]]);OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"};
OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1);
OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:"mouseover mouseout mousedown mouseup mousemove click dblclick rightclick dblrightclick resize focus blur touchstart touchmove touchend keydown".split(" "),listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(a,b,c,d,e){OpenLayers.Util.extend(this,e);this.object=a;this.fallThrough=d;this.listeners={};this.extensions={};this.extensionCount=
{};this._msTouches=[];null!=b&&this.attachToElement(b)},destroy:function(){for(var a in this.extensions)"boolean"!==typeof this.extensions[a]&&this.extensions[a].destroy();this.extensions=null;this.element&&(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener));this.eventHandler=this.fallThrough=this.object=this.listeners=this.element=null},addEventType:function(a){},attachToElement:function(a){this.element?
OpenLayers.Event.stopObservingElement(this.element):(this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this));this.element=a;for(var b=!!window.navigator.msMaxTouchPoints,c,d=0,e=this.BROWSER_EVENTS.length;d<e;d++)c=this.BROWSER_EVENTS[d],OpenLayers.Event.observe(a,c,this.eventHandler),b&&0===c.indexOf("touch")&&this.addMsTouchListener(a,c,this.eventHandler);OpenLayers.Event.observe(a,"dragstart",
OpenLayers.Event.stop)},on:function(a){for(var b in a)"scope"!=b&&a.hasOwnProperty(b)&&this.register(b,a.scope,a[b])},register:function(a,b,c,d){a in OpenLayers.Events&&!this.extensions[a]&&(this.extensions[a]=new OpenLayers.Events[a](this));if(null!=c){null==b&&(b=this.object);var e=this.listeners[a];e||(e=[],this.listeners[a]=e,this.extensionCount[a]=0);b={obj:b,func:c};d?(e.splice(this.extensionCount[a],0,b),"object"===typeof d&&d.extension&&this.extensionCount[a]++):e.push(b)}},registerPriority:function(a,
b,c){this.register(a,b,c,!0)},un:function(a){for(var b in a)"scope"!=b&&a.hasOwnProperty(b)&&this.unregister(b,a.scope,a[b])},unregister:function(a,b,c){null==b&&(b=this.object);a=this.listeners[a];if(null!=a)for(var d=0,e=a.length;d<e;d++)if(a[d].obj==b&&a[d].func==c){a.splice(d,1);break}},remove:function(a){null!=this.listeners[a]&&(this.listeners[a]=[])},triggerEvent:function(a,b){var c=this.listeners[a];if(c&&0!=c.length){null==b&&(b={});b.object=this.object;b.element=this.element;b.type||(b.type=
a);for(var c=c.slice(),d,e=0,f=c.length;e<f&&(d=c[e],d=d.func.apply(d.obj,[b]),void 0==d||!1!=d);e++);this.fallThrough||OpenLayers.Event.stop(b,!0);return d}},handleBrowserEvent:function(a){var b=a.type,c=this.listeners[b];if(c&&0!=c.length){if((c=a.touches)&&c[0]){for(var d=0,e=0,f=c.length,g,h=0;h<f;++h)g=this.getTouchClientXY(c[h]),d+=g.clientX,e+=g.clientY;a.clientX=d/f;a.clientY=e/f}this.includeXY&&(a.xy=this.getMousePosition(a));this.triggerEvent(b,a)}},getTouchClientXY:function(a){var b=window.olMockWin||
window,c=b.pageXOffset,b=b.pageYOffset,d=a.clientX,e=a.clientY;if(0===a.pageY&&Math.floor(e)>Math.floor(a.pageY)||0===a.pageX&&Math.floor(d)>Math.floor(a.pageX))d-=c,e-=b;else if(e<a.pageY-b||d<a.pageX-c)d=a.pageX-c,e=a.pageY-b;a.olClientX=d;a.olClientY=e;return{clientX:d,clientY:e}},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;this.element.offsets=null},getMousePosition:function(a){this.includeXY?this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll",
this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache();if(!this.element.scrolls){var b=OpenLayers.Util.getViewportElement();this.element.scrolls=[window.pageXOffset||b.scrollLeft,window.pageYOffset||b.scrollTop]}this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]);this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element));return new OpenLayers.Pixel(a.clientX+this.element.scrolls[0]-
this.element.offsets[0]-this.element.lefttop[0],a.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},addMsTouchListener:function(a,b,c){function d(a){c(OpenLayers.Util.applyDefaults({stopPropagation:function(){for(var a=e.length-1;0<=a;--a)e[a].stopPropagation()},preventDefault:function(){for(var a=e.length-1;0<=a;--a)e[a].preventDefault()},type:b},a))}var e=this._msTouches;switch(b){case "touchstart":return this.addMsTouchListenerStart(a,b,d);case "touchend":return this.addMsTouchListenerEnd(a,
b,d);case "touchmove":return this.addMsTouchListenerMove(a,b,d);default:throw"Unknown touch event type";}},addMsTouchListenerStart:function(a,b,c){var d=this._msTouches;OpenLayers.Event.observe(a,"MSPointerDown",function(a){for(var b=!1,g=0,h=d.length;g<h;++g)if(d[g].pointerId==a.pointerId){b=!0;break}b||d.push(a);a.touches=d.slice();c(a)});OpenLayers.Event.observe(a,"MSPointerUp",function(a){for(var b=0,c=d.length;b<c;++b)if(d[b].pointerId==a.pointerId){d.splice(b,1);break}})},addMsTouchListenerMove:function(a,
b,c){var d=this._msTouches;OpenLayers.Event.observe(a,"MSPointerMove",function(a){if(a.pointerType!=a.MSPOINTER_TYPE_MOUSE||0!=a.buttons)if(1!=d.length||d[0].pageX!=a.pageX||d[0].pageY!=a.pageY){for(var b=0,g=d.length;b<g;++b)if(d[b].pointerId==a.pointerId){d[b]=a;break}a.touches=d.slice();c(a)}})},addMsTouchListenerEnd:function(a,b,c){var d=this._msTouches;OpenLayers.Event.observe(a,"MSPointerUp",function(a){for(var b=0,g=d.length;b<g;++b)if(d[b].pointerId==a.pointerId){d.splice(b,1);break}a.touches=
d.slice();c(a)})},CLASS_NAME:"OpenLayers.Events"});OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:"mousedown mouseup click dblclick touchstart touchmove touchend keydown".split(" "),startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(a){this.target=a;for(a=this.events.length-1;0<=a;--a)this.target.register(this.events[a],this,this.buttonClick,{extension:!0})},destroy:function(){for(var a=this.events.length-1;0<=a;--a)this.target.unregister(this.events[a],this,this.buttonClick);
delete this.target},getPressedButton:function(a){var b=3,c;do{if(OpenLayers.Element.hasClass(a,"olButton")){c=a;break}a=a.parentNode}while(0<--b&&a);return c},ignore:function(a){var b=3,c=!1;do{if("a"===a.nodeName.toLowerCase()){c=!0;break}a=a.parentNode}while(0<--b&&a);return c},buttonClick:function(a){var b=!0,c=OpenLayers.Event.element(a);if(c&&(OpenLayers.Event.isLeftClick(a)||!~a.type.indexOf("mouse")))if(c=this.getPressedButton(c)){if("keydown"===a.type)switch(a.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",
{buttonElement:c}),OpenLayers.Event.stop(a),b=!1}else if(this.startEvt){if(this.completeRegEx.test(a.type)){var b=OpenLayers.Util.pagePosition(c),d=OpenLayers.Util.getViewportElement(),e=window.pageYOffset||d.scrollTop;b[0]-=window.pageXOffset||d.scrollLeft;b[1]-=e;this.target.triggerEvent("buttonclick",{buttonElement:c,buttonXY:{x:this.startEvt.clientX-b[0],y:this.startEvt.clientY-b[1]}})}this.cancelRegEx.test(a.type)&&delete this.startEvt;OpenLayers.Event.stop(a);b=!1}this.startRegEx.test(a.type)&&
(this.startEvt=a,OpenLayers.Event.stop(a),b=!1)}else b=!this.ignore(OpenLayers.Event.element(a)),delete this.startEvt;return b}});OpenLayers.Util=OpenLayers.Util||{};
OpenLayers.Util.vendorPrefix=function(){function a(a){return a?a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}).replace(/^ms-/,"-ms-"):null}function b(a,b){if(void 0===g[b]){var c,e=0,f=d.length,p="undefined"!==typeof a.cssText;for(g[b]=null;e<f;e++)if((c=d[e])?(p||(c=c.toLowerCase()),c=c+b.charAt(0).toUpperCase()+b.slice(1)):c=b,void 0!==a[c]){g[b]=c;break}}return g[b]}function c(a){return b(e,a)}var d=["","O","ms","Moz","Webkit"],e=document.createElement("div").style,f={},g={};return{css:function(b){if(void 0===
f[b]){var d=b.replace(/(-[\s\S])/g,function(a){return a.charAt(1).toUpperCase()}),d=c(d);f[b]=a(d)}return f[b]},js:b,style:c,cssCache:f,jsCache:g}}();OpenLayers.Animation=function(a){var b=OpenLayers.Util.vendorPrefix.js(a,"requestAnimationFrame"),c=!!b,d=function(){var c=a[b]||function(b,c){a.setTimeout(b,16)};return function(b,d){c.apply(a,[b,d])}}(),e=0,f={};return{isNative:c,requestFrame:d,start:function(a,b,c){b=0<b?b:Number.POSITIVE_INFINITY;var l=++e,m=+new Date;f[l]=function(){f[l]&&+new Date-m<=b?(a(),f[l]&&d(f[l],c)):delete f[l]};d(f[l],c);return l},stop:function(a){delete f[a]}}}(window);OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,minFrameRate:null,startTime:null,animationId:null,playing:!1,initialize:function(a){this.easing=a?a:OpenLayers.Easing.Expo.easeOut},start:function(a,b,c,d){this.playing=!0;this.begin=a;this.finish=b;this.duration=c;this.callbacks=d.callbacks;this.minFrameRate=d.minFrameRate||30;this.time=0;this.startTime=(new Date).getTime();OpenLayers.Animation.stop(this.animationId);this.animationId=null;
this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin);this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){this.playing&&(this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.playing=!1)},play:function(){var a={},b;for(b in this.begin){var c=this.begin[b],d=this.finish[b];if(null==c||null==d||isNaN(c)||isNaN(d))throw new TypeError("invalid value for Tween");
a[b]=this.easing.apply(this,[this.time,c,d-c,this.duration])}this.time++;this.callbacks&&this.callbacks.eachStep&&((new Date).getTime()-this.startTime)/this.time<=1E3/this.minFrameRate&&this.callbacks.eachStep.call(this,a);this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(a,b,c,d){return c*a/d+b},easeOut:function(a,b,c,d){return c*a/d+b},easeInOut:function(a,b,c,d){return c*a/d+b},CLASS_NAME:"OpenLayers.Easing.Linear"};
OpenLayers.Easing.Expo={easeIn:function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b},easeOut:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOut:function(a,b,c,d){return 0==a?b:a==d?b+c:1>(a/=d/2)?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b},CLASS_NAME:"OpenLayers.Easing.Expo"};
OpenLayers.Easing.Quad={easeIn:function(a,b,c,d){return c*(a/=d)*a+b},easeOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOut:function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},CLASS_NAME:"OpenLayers.Easing.Quad"};OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(a,b){OpenLayers.Util.extend(this,b);this.projCode=a;"object"==typeof Proj4js&&(this.proj=new Proj4js.Proj(a))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(a){var b=!1;a&&(a instanceof OpenLayers.Projection||(a=new OpenLayers.Projection(a)),"object"==
typeof Proj4js&&this.proj.defData&&a.proj.defData?b=this.proj.defData.replace(this.titleRegEx,"")==a.proj.defData.replace(this.titleRegEx,""):a.getCode&&(b=this.getCode(),a=a.getCode(),b=b==a||!!OpenLayers.Projection.transforms[b]&&OpenLayers.Projection.transforms[b][a]===OpenLayers.Projection.nullTransform));return b},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={};
OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7]}};
OpenLayers.Projection.addTransform=function(a,b,c){if(c===OpenLayers.Projection.nullTransform){var d=OpenLayers.Projection.defaults[a];d&&!OpenLayers.Projection.defaults[b]&&(OpenLayers.Projection.defaults[b]=d)}OpenLayers.Projection.transforms[a]||(OpenLayers.Projection.transforms[a]={});OpenLayers.Projection.transforms[a][b]=c};
OpenLayers.Projection.transform=function(a,b,c){if(b&&c)if(b instanceof OpenLayers.Projection||(b=new OpenLayers.Projection(b)),c instanceof OpenLayers.Projection||(c=new OpenLayers.Projection(c)),b.proj&&c.proj)a=Proj4js.transform(b.proj,c.proj,a);else{b=b.getCode();c=c.getCode();var d=OpenLayers.Projection.transforms;if(d[b]&&d[b][c])d[b][c](a)}return a};OpenLayers.Projection.nullTransform=function(a){return a};
(function(){function a(a){a.x=180*a.x/d;a.y=180/Math.PI*(2*Math.atan(Math.exp(a.y/d*Math.PI))-Math.PI/2);return a}function b(a){a.x=a.x*d/180;var b=Math.log(Math.tan((90+a.y)*Math.PI/360))/Math.PI*d;a.y=Math.max(-2.003750834E7,Math.min(b,2.003750834E7));return a}function c(c,d){var e=OpenLayers.Projection.addTransform,f=OpenLayers.Projection.nullTransform,g,p,q,r,s;g=0;for(p=d.length;g<p;++g)for(q=d[g],e(c,q,b),e(q,c,a),s=g+1;s<p;++s)r=d[s],e(q,r,f),e(r,q,f)}var d=2.003750834E7,e=["EPSG:900913","EPSG:3857",
"EPSG:102113","EPSG:102100"],f=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"],g;for(g=e.length-1;0<=g;--g)c(e[g],f);for(g=f.length-1;0<=g;--g)c(f[g],e)})();OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1E3},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,
maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!1,autoUpdateSize:!0,eventListeners:null,panTween:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,zoomTween:null,zoomMethod:OpenLayers.Easing.Quad.easeOut,zoomDuration:20,paddingForPopups:null,layerContainerOriginPx:null,minPx:null,maxPx:null,initialize:function(a,b){1===arguments.length&&"object"===typeof a&&(a=(b=a)&&b.div);this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,
OpenLayers.Map.TILE_HEIGHT);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css";this.options=OpenLayers.Util.extend({},b);OpenLayers.Util.extend(this,b);OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection]);!this.maxExtent||this.maxExtent instanceof OpenLayers.Bounds||(this.maxExtent=new OpenLayers.Bounds(this.maxExtent));
!this.minExtent||this.minExtent instanceof OpenLayers.Bounds||(this.minExtent=new OpenLayers.Bounds(this.minExtent));!this.restrictedExtent||this.restrictedExtent instanceof OpenLayers.Bounds||(this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent));!this.center||this.center instanceof OpenLayers.LonLat||(this.center=new OpenLayers.LonLat(this.center));this.layers=[];this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(a);this.div||(this.div=document.createElement("div"),
this.div.style.height="1px",this.div.style.width="1px");OpenLayers.Element.addClass(this.div,"olMap");var c=this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(c,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0});OpenLayers.TileManager&&null!==
this.tileManager&&(this.tileManager instanceof OpenLayers.TileManager||(this.tileManager=new OpenLayers.TileManager(this.tileManager)),this.tileManager.addMap(this));c=this.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(c);this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;this.layerContainerOriginPx={x:0,y:0};this.applyTransform();this.viewPortDiv.appendChild(this.layerContainerDiv);this.updateSize();if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);
!0===this.autoUpdateSize&&(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy));if(this.theme){for(var c=!0,d=document.getElementsByTagName("link"),e=0,f=d.length;e<f;++e)if(OpenLayers.Util.isEquivalentUrl(d.item(e).href,this.theme)){c=!1;break}c&&(c=document.createElement("link"),c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(c))}null==
this.controls&&(this.controls=[],null!=OpenLayers.Control&&(OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers.Control.TouchNavigation),OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser),OpenLayers.Control.Attribution&&
this.controls.push(new OpenLayers.Control.Attribution)));e=0;for(f=this.controls.length;e<f;e++)this.addControlToMap(this.controls[e]);this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,"unload",this.unloadDestroy);b&&b.layers&&(delete this.center,delete this.zoom,this.addLayers(b.layers),b.center&&!this.getCenter()&&this.setCenter(b.center,b.zoom));this.panMethod&&(this.panTween=new OpenLayers.Tween(this.panMethod));this.zoomMethod&&this.applyTransform.transform&&
(this.zoomTween=new OpenLayers.Tween(this.zoomMethod))},getViewport:function(){return this.viewPortDiv},render:function(a){this.div=OpenLayers.Util.getElement(a);OpenLayers.Element.addClass(this.div,"olMap");this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;this.panTween&&(this.panTween.stop(),this.panTween=null);this.zoomTween&&(this.zoomTween.stop(),
this.zoomTween=null);OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;this.updateSizeDestroy&&OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy);this.paddingForPopups=null;if(null!=this.controls){for(var a=this.controls.length-1;0<=a;--a)this.controls[a].destroy();this.controls=null}if(null!=this.layers){for(a=this.layers.length-1;0<=a;--a)this.layers[a].destroy(!1);this.layers=null}this.viewPortDiv&&this.viewPortDiv.parentNode&&this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);
this.viewPortDiv=null;this.tileManager&&(this.tileManager.removeMap(this),this.tileManager=null);this.eventListeners&&(this.events.un(this.eventListeners),this.eventListeners=null);this.events.destroy();this.options=this.events=null},setOptions:function(a){var b=this.minPx&&a.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,a);b&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(a,b,c){var d="function"==
typeof c.test;return OpenLayers.Array.filter(this[a],function(a){return a[b]==c||d&&c.test(a[b])})},getLayersBy:function(a,b){return this.getBy("layers",a,b)},getLayersByName:function(a){return this.getLayersBy("name",a)},getLayersByClass:function(a){return this.getLayersBy("CLASS_NAME",a)},getControlsBy:function(a,b){return this.getBy("controls",a,b)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},getLayer:function(a){for(var b=null,c=0,d=this.layers.length;c<d;c++){var e=
this.layers[c];if(e.id==a){b=e;break}}return b},setLayerZIndex:function(a,b){a.setZIndex(this.Z_INDEX_BASE[a.isBaseLayer?"BaseLayer":"Overlay"]+5*b)},resetLayersZIndex:function(){for(var a=0,b=this.layers.length;a<b;a++)this.setLayerZIndex(this.layers[a],a)},addLayer:function(a){for(var b=0,c=this.layers.length;b<c;b++)if(this.layers[b]==a)return!1;if(!1===this.events.triggerEvent("preaddlayer",{layer:a}))return!1;this.allOverlays&&(a.isBaseLayer=!1);a.div.className="olLayerDiv";a.div.style.overflow=
"";this.setLayerZIndex(a,this.layers.length);a.isFixed?this.viewPortDiv.appendChild(a.div):this.layerContainerDiv.appendChild(a.div);this.layers.push(a);a.setMap(this);a.isBaseLayer||this.allOverlays&&!this.baseLayer?null==this.baseLayer?this.setBaseLayer(a):a.setVisibility(!1):a.redraw();this.events.triggerEvent("addlayer",{layer:a});a.events.triggerEvent("added",{map:this,layer:a});a.afterAdd();return!0},addLayers:function(a){for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},removeLayer:function(a,
b){if(!1!==this.events.triggerEvent("preremovelayer",{layer:a})){null==b&&(b=!0);a.isFixed?this.viewPortDiv.removeChild(a.div):this.layerContainerDiv.removeChild(a.div);OpenLayers.Util.removeItem(this.layers,a);a.removeMap(this);a.map=null;if(this.baseLayer==a&&(this.baseLayer=null,b))for(var c=0,d=this.layers.length;c<d;c++){var e=this.layers[c];if(e.isBaseLayer||this.allOverlays){this.setBaseLayer(e);break}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:a});a.events.triggerEvent("removed",
{map:this,layer:a})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(a){return OpenLayers.Util.indexOf(this.layers,a)},setLayerIndex:function(a,b){var c=this.getLayerIndex(a);0>b?b=0:b>this.layers.length&&(b=this.layers.length);if(c!=b){this.layers.splice(c,1);this.layers.splice(b,0,a);for(var c=0,d=this.layers.length;c<d;c++)this.setLayerZIndex(this.layers[c],c);this.events.triggerEvent("changelayer",{layer:a,property:"order"});this.allOverlays&&(0===b?this.setBaseLayer(a):
this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(a,b){var c=this.getLayerIndex(a)+b;this.setLayerIndex(a,c)},setBaseLayer:function(a){if(a!=this.baseLayer&&-1!=OpenLayers.Util.indexOf(this.layers,a)){var b=this.getCachedCenter(),c=OpenLayers.Util.getResolutionFromScale(this.getScale(),a.units);null==this.baseLayer||this.allOverlays||this.baseLayer.setVisibility(!1);this.baseLayer=a;if(!this.allOverlays||this.baseLayer.visibility)this.baseLayer.setVisibility(!0),
!1===this.baseLayer.inRange&&this.baseLayer.redraw();null!=b&&(a=this.getZoomForResolution(c||this.resolution,!0),this.setCenter(b,a,!1,!0));this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(a,b){this.controls.push(a);this.addControlToMap(a,b)},addControls:function(a,b){for(var c=1===arguments.length?[]:b,d=0,e=a.length;d<e;d++)this.addControl(a[d],c[d]?c[d]:null)},addControlToMap:function(a,b){a.outsideViewport=null!=a.div;this.displayProjection&&!a.displayProjection&&
(a.displayProjection=this.displayProjection);a.setMap(this);var c=a.draw(b);c&&!a.outsideViewport&&(c.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(c));a.autoActivate&&a.activate()},getControl:function(a){for(var b=null,c=0,d=this.controls.length;c<d;c++){var e=this.controls[c];if(e.id==a){b=e;break}}return b},removeControl:function(a){a&&a==this.getControl(a.id)&&(a.div&&a.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(a.div),OpenLayers.Util.removeItem(this.controls,
a))},addPopup:function(a,b){if(b)for(var c=this.popups.length-1;0<=c;--c)this.removePopup(this.popups[c]);a.map=this;this.popups.push(a);if(c=a.draw())c.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(c)},removePopup:function(a){OpenLayers.Util.removeItem(this.popups,a);if(a.div)try{this.layerContainerDiv.removeChild(a.div)}catch(b){}a.map=null},getSize:function(){var a=null;null!=this.size&&(a=this.size.clone());return a},updateSize:function(){var a=this.getCurrentSize();
if(a&&!isNaN(a.h)&&!isNaN(a.w)){this.events.clearMouseCache();var b=this.getSize();null==b&&(this.size=b=a);if(!a.equals(b)){this.size=a;a=0;for(b=this.layers.length;a<b;a++)this.layers[a].onMapResize();a=this.getCachedCenter();null!=this.baseLayer&&null!=a&&(b=this.getZoom(),this.zoom=null,this.setCenter(a,b))}}this.events.triggerEvent("updatesize")},getCurrentSize:function(){var a=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(0==a.w&&0==a.h||isNaN(a.w)&&isNaN(a.h))a.w=this.div.offsetWidth,
a.h=this.div.offsetHeight;if(0==a.w&&0==a.h||isNaN(a.w)&&isNaN(a.h))a.w=parseInt(this.div.style.width),a.h=parseInt(this.div.style.height);return a},calculateBounds:function(a,b){var c=null;null==a&&(a=this.getCachedCenter());null==b&&(b=this.getResolution());if(null!=a&&null!=b)var c=this.size.w*b/2,d=this.size.h*b/2,c=new OpenLayers.Bounds(a.lon-c,a.lat-d,a.lon+c,a.lat+d);return c},getCenter:function(){var a=null,b=this.getCachedCenter();b&&(a=b.clone());return a},getCachedCenter:function(){!this.center&&
this.size&&(this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2}));return this.center},getZoom:function(){return this.zoom},pan:function(a,b,c){c=OpenLayers.Util.applyDefaults(c,{animate:!0,dragging:!1});if(c.dragging)0==a&&0==b||this.moveByPx(a,b);else{var d=this.getViewPortPxFromLonLat(this.getCachedCenter());a=d.add(a,b);if(this.dragging||!a.equals(d))d=this.getLonLatFromViewPortPx(a),c.animate?this.panTo(d):(this.moveTo(d),this.dragging&&(this.dragging=!1,this.events.triggerEvent("moveend")))}},
panTo:function(a){if(this.panTween&&this.getExtent().scale(this.panRatio).containsLonLat(a)){var b=this.getCachedCenter();if(!a.equals(b)){var b=this.getPixelFromLonLat(b),c=this.getPixelFromLonLat(a),d=0,e=0;this.panTween.start({x:0,y:0},{x:c.x-b.x,y:c.y-b.y},this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(a){this.moveByPx(a.x-d,a.y-e);d=Math.round(a.x);e=Math.round(a.y)},this),done:OpenLayers.Function.bind(function(b){this.moveTo(a);this.dragging=!1;this.events.triggerEvent("moveend")},
this)}})}}else this.setCenter(a)},setCenter:function(a,b,c,d){this.panTween&&this.panTween.stop();this.zoomTween&&this.zoomTween.stop();this.moveTo(a,b,{dragging:c,forceZoomChange:d})},moveByPx:function(a,b){var c=this.size.w/2,d=this.size.h/2,e=c+a,f=d+b,g=this.baseLayer.wrapDateLine,h=0,k=0;this.restrictedExtent&&(h=c,k=d,g=!1);a=g||e<=this.maxPx.x-h&&e>=this.minPx.x+h?Math.round(a):0;b=f<=this.maxPx.y-k&&f>=this.minPx.y+k?Math.round(b):0;if(a||b){this.dragging||(this.dragging=!0,this.events.triggerEvent("movestart"));
this.center=null;a&&(this.layerContainerOriginPx.x-=a,this.minPx.x-=a,this.maxPx.x-=a);b&&(this.layerContainerOriginPx.y-=b,this.minPx.y-=b,this.maxPx.y-=b);this.applyTransform();d=0;for(e=this.layers.length;d<e;++d)c=this.layers[d],c.visibility&&(c===this.baseLayer||c.inRange)&&(c.moveByPx(a,b),c.events.triggerEvent("move"));this.events.triggerEvent("move")}},adjustZoom:function(a){if(this.baseLayer&&this.baseLayer.wrapDateLine){var b=this.baseLayer.resolutions,c=this.getMaxExtent().getWidth()/this.size.w;
if(this.getResolutionForZoom(a)>c)if(this.fractionalZoom)a=this.getZoomForResolution(c);else for(var d=a|0,e=b.length;d<e;++d)if(b[d]<=c){a=d;break}}return a},getMinZoom:function(){return this.adjustZoom(0)},moveTo:function(a,b,c){null==a||a instanceof OpenLayers.LonLat||(a=new OpenLayers.LonLat(a));c||(c={});null!=b&&(b=parseFloat(b),this.fractionalZoom||(b=Math.round(b)));var d=b;b=this.adjustZoom(b);b!==d&&(a=this.getCenter());var d=c.dragging||this.dragging,e=c.forceZoomChange;this.getCachedCenter()||
this.isValidLonLat(a)||(a=this.maxExtent.getCenterLonLat(),this.center=a.clone());if(null!=this.restrictedExtent){null==a&&(a=this.center);null==b&&(b=this.getZoom());var f=this.getResolutionForZoom(b),f=this.calculateBounds(a,f);if(!this.restrictedExtent.containsBounds(f)){var g=this.restrictedExtent.getCenterLonLat();f.getWidth()>this.restrictedExtent.getWidth()?a=new OpenLayers.LonLat(g.lon,a.lat):f.left<this.restrictedExtent.left?a=a.add(this.restrictedExtent.left-f.left,0):f.right>this.restrictedExtent.right&&
(a=a.add(this.restrictedExtent.right-f.right,0));f.getHeight()>this.restrictedExtent.getHeight()?a=new OpenLayers.LonLat(a.lon,g.lat):f.bottom<this.restrictedExtent.bottom?a=a.add(0,this.restrictedExtent.bottom-f.bottom):f.top>this.restrictedExtent.top&&(a=a.add(0,this.restrictedExtent.top-f.top))}}e=e||this.isValidZoomLevel(b)&&b!=this.getZoom();f=this.isValidLonLat(a)&&!a.equals(this.center);if(e||f||d){d||this.events.triggerEvent("movestart",{zoomChanged:e});f&&(!e&&this.center&&this.centerLayerContainer(a),
this.center=a.clone());a=e?this.getResolutionForZoom(b):this.getResolution();if(e||null==this.layerContainerOrigin){this.layerContainerOrigin=this.getCachedCenter();this.layerContainerOriginPx.x=0;this.layerContainerOriginPx.y=0;this.applyTransform();var f=this.getMaxExtent({restricted:!0}),h=f.getCenterLonLat(),g=this.center.lon-h.lon,h=h.lat-this.center.lat,k=Math.round(f.getWidth()/a),l=Math.round(f.getHeight()/a);this.minPx={x:(this.size.w-k)/2-g/a,y:(this.size.h-l)/2-h/a};this.maxPx={x:this.minPx.x+
Math.round(f.getWidth()/a),y:this.minPx.y+Math.round(f.getHeight()/a)}}e&&(this.zoom=b,this.resolution=a);a=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(a,e,c.dragging),c.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:e}));a=this.baseLayer.getExtent();for(b=this.layers.length-1;0<=b;--b)f=this.layers[b],f===this.baseLayer||f.isBaseLayer||(g=f.calculateInRange(),f.inRange!=g&&((f.inRange=g)||f.display(!1),this.events.triggerEvent("changelayer",{layer:f,property:"visibility"})),
g&&f.visibility&&(f.moveTo(a,e,c.dragging),c.dragging||f.events.triggerEvent("moveend",{zoomChanged:e})));this.events.triggerEvent("move");d||this.events.triggerEvent("moveend");if(e){b=0;for(c=this.popups.length;b<c;b++)this.popups[b].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(a){var b=this.getViewPortPxFromLonLat(this.layerContainerOrigin),c=this.getViewPortPxFromLonLat(a);if(null!=b&&null!=c){var d=this.layerContainerOriginPx.x;a=this.layerContainerOriginPx.y;
var e=Math.round(b.x-c.x),b=Math.round(b.y-c.y);this.applyTransform(this.layerContainerOriginPx.x=e,this.layerContainerOriginPx.y=b);d-=e;a-=b;this.minPx.x-=d;this.maxPx.x-=d;this.minPx.y-=a;this.maxPx.y-=a}},isValidZoomLevel:function(a){return null!=a&&0<=a&&a<this.getNumZoomLevels()},isValidLonLat:function(a){var b=!1;null!=a&&(b=this.getMaxExtent(),b=b.containsLonLat(a,{worldBounds:this.baseLayer.wrapDateLine&&b}));return b},getProjection:function(){var a=this.getProjectionObject();return a?a.getCode():
null},getProjectionObject:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.projection);return a},getMaxResolution:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.maxResolution);return a},getMaxExtent:function(a){var b=null;a&&a.restricted&&this.restrictedExtent?b=this.restrictedExtent:null!=this.baseLayer&&(b=this.baseLayer.maxExtent);return b},getNumZoomLevels:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.numZoomLevels);return a},getExtent:function(){var a=
null;null!=this.baseLayer&&(a=this.baseLayer.getExtent());return a},getResolution:function(){var a=null;null!=this.baseLayer?a=this.baseLayer.getResolution():!0===this.allOverlays&&0<this.layers.length&&(a=this.layers[0].getResolution());return a},getUnits:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.units);return a},getScale:function(){var a=null;null!=this.baseLayer&&(a=this.getResolution(),a=OpenLayers.Util.getScaleFromResolution(a,this.baseLayer.units));return a},getZoomForExtent:function(a,
b){var c=null;null!=this.baseLayer&&(c=this.baseLayer.getZoomForExtent(a,b));return c},getResolutionForZoom:function(a){var b=null;this.baseLayer&&(b=this.baseLayer.getResolutionForZoom(a));return b},getZoomForResolution:function(a,b){var c=null;null!=this.baseLayer&&(c=this.baseLayer.getZoomForResolution(a,b));return c},zoomTo:function(a,b){var c=this;if(c.isValidZoomLevel(a))if(c.baseLayer.wrapDateLine&&(a=c.adjustZoom(a)),c.zoomTween){var d=c.getResolution(),e=c.getResolutionForZoom(a),f={scale:1},
d={scale:d/e};c.zoomTween.playing&&c.zoomTween.duration<3*c.zoomDuration?c.zoomTween.finish={scale:c.zoomTween.finish.scale*d.scale}:(b||(e=c.getSize(),b={x:e.w/2,y:e.h/2}),c.zoomTween.start(f,d,c.zoomDuration,{minFrameRate:50,callbacks:{eachStep:function(a){var d=c.layerContainerOriginPx;a=a.scale;c.applyTransform(d.x+((a-1)*(d.x-b.x)|0),d.y+((a-1)*(d.y-b.y)|0),a)},done:function(a){c.applyTransform();a=c.getResolution()/a.scale;var d=c.getZoomForResolution(a,!0);c.moveTo(c.getZoomTargetCenter(b,
a),d,!0)}}}))}else f=b?c.getZoomTargetCenter(b,c.getResolutionForZoom(a)):null,c.setCenter(f,a)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(a,b){a instanceof OpenLayers.Bounds||(a=new OpenLayers.Bounds(a));var c=a.getCenterLonLat();if(this.baseLayer.wrapDateLine){c=this.getMaxExtent();for(a=a.clone();a.right<a.left;)a.right+=c.getWidth();c=a.getCenterLonLat().wrapDateLine(c)}this.setCenter(c,this.getZoomForExtent(a,b))},
zoomToMaxExtent:function(a){a=this.getMaxExtent({restricted:a?a.restricted:!0});this.zoomToExtent(a)},zoomToScale:function(a,b){var c=OpenLayers.Util.getResolutionFromScale(a,this.baseLayer.units),d=this.size.w*c/2,c=this.size.h*c/2,e=this.getCachedCenter(),d=new OpenLayers.Bounds(e.lon-d,e.lat-c,e.lon+d,e.lat+c);this.zoomToExtent(d,b)},getLonLatFromViewPortPx:function(a){var b=null;null!=this.baseLayer&&(b=this.baseLayer.getLonLatFromViewPortPx(a));return b},getViewPortPxFromLonLat:function(a){var b=
null;null!=this.baseLayer&&(b=this.baseLayer.getViewPortPxFromLonLat(a));return b},getZoomTargetCenter:function(a,b){var c=null,d=this.getSize(),e=d.w/2-a.x,d=a.y-d.h/2,f=this.getLonLatFromPixel(a);f&&(c=new OpenLayers.LonLat(f.lon+e*b,f.lat+d*b));return c},getLonLatFromPixel:function(a){return this.getLonLatFromViewPortPx(a)},getPixelFromLonLat:function(a){a=this.getViewPortPxFromLonLat(a);a.x=Math.round(a.x);a.y=Math.round(a.y);return a},getGeodesicPixelSize:function(a){var b=a?this.getLonLatFromPixel(a):
this.getCachedCenter()||new OpenLayers.LonLat(0,0),c=this.getResolution();a=b.add(-c/2,0);var d=b.add(c/2,0),e=b.add(0,-c/2),b=b.add(0,c/2),c=new OpenLayers.Projection("EPSG:4326"),f=this.getProjectionObject()||c;f.equals(c)||(a.transform(f,c),d.transform(f,c),e.transform(f,c),b.transform(f,c));return new OpenLayers.Size(OpenLayers.Util.distVincenty(a,d),OpenLayers.Util.distVincenty(e,b))},getViewPortPxFromLayerPx:function(a){var b=null;null!=a&&(b=a.add(this.layerContainerOriginPx.x,this.layerContainerOriginPx.y));
return b},getLayerPxFromViewPortPx:function(a){var b=null;null!=a&&(b=a.add(-this.layerContainerOriginPx.x,-this.layerContainerOriginPx.y),isNaN(b.x)||isNaN(b.y))&&(b=null);return b},getLonLatFromLayerPx:function(a){a=this.getViewPortPxFromLayerPx(a);return this.getLonLatFromViewPortPx(a)},getLayerPxFromLonLat:function(a){a=this.getPixelFromLonLat(a);return this.getLayerPxFromViewPortPx(a)},applyTransform:function(a,b,c){c=c||1;var d=this.layerContainerOriginPx,e=1!==c;a=a||d.x;b=b||d.y;var f=this.layerContainerDiv.style,
g=this.applyTransform.transform,h=this.applyTransform.template;if(void 0===g&&(g=OpenLayers.Util.vendorPrefix.style("transform"),this.applyTransform.transform=g)){var k=OpenLayers.Element.getStyle(this.viewPortDiv,OpenLayers.Util.vendorPrefix.css("transform"));k&&"none"===k||(h=["translate3d(",",0) ","scale3d(",",1)"],f[g]=[h[0],"0,0",h[1]].join(""));h&&~f[g].indexOf(h[0])||(h=["translate(",") ","scale(",")"]);this.applyTransform.template=h}null===g||"translate3d("!==h[0]&&!0!==e?(f.left=a+"px",f.top=
b+"px",null!==g&&(f[g]="")):(!0===e&&"translate("===h[0]&&(a-=d.x,b-=d.y,f.left=d.x+"px",f.top=d.y+"px"),f[g]=[h[0],a,"px,",b,"px",h[1],h[2],c,",",c,h[3]].join(""))},CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,touch:!1,initialize:function(a,b,c){OpenLayers.Util.extend(this,c);this.control=a;this.callbacks=b;(a=this.map||a.map)&&this.setMap(a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(a){this.map=a},checkModifiers:function(a){return null==this.keyMask?!0:((a.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(a.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(a.altKey?OpenLayers.Handler.MOD_ALT:
0)|(a.metaKey?OpenLayers.Handler.MOD_META:0))==this.keyMask},activate:function(){if(this.active)return!1;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b<c;b++)this[a[b]]&&this.register(a[b],this[a[b]]);return this.active=!0},deactivate:function(){if(!this.active)return!1;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b<c;b++)this[a[b]]&&this.unregister(a[b],this[a[b]]);this.active=this.touch=!1;return!0},startTouch:function(){if(!this.touch){this.touch=!0;
for(var a="mousedown mouseup mousemove click dblclick mouseout".split(" "),b=0,c=a.length;b<c;b++)this[a[b]]&&this.unregister(a[b],this[a[b]])}},callback:function(a,b){a&&this.callbacks[a]&&this.callbacks[a].apply(this.control,b)},register:function(a,b){this.map.events.registerPriority(a,this,b);this.map.events.registerPriority(a,this,this.setEvent)},unregister:function(a,b){this.map.events.unregister(a,this,b);this.map.events.unregister(a,this,this.setEvent)},setEvent:function(a){this.evt=a;return!0},
destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;OpenLayers.Handler.MOD_META=8;OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(a){this.startTouch();this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return!0},touchmove:function(a){this.last=this.getEventInfo(a);return!0},touchend:function(a){this.down&&(a.xy=this.last.xy,a.lastTouches=this.last.touches,this.handleSingle(a),
this.down=null);return!0},mousedown:function(a){this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return!0},mouseup:function(a){var b=!0;this.checkModifiers(a)&&(this.control.handleRightClicks&&OpenLayers.Event.isRightClick(a))&&(b=this.rightclick(a));return b},rightclick:function(a){if(this.passesTolerance(a)){if(null!=this.rightclickTimerId)return this.clearTimer(),this.callback("dblrightclick",[a]),!this.stopDouble;a=this["double"]?OpenLayers.Util.extend({},a):this.callback("rightclick",
[a]);a=OpenLayers.Function.bind(this.delayedRightCall,this,a);this.rightclickTimerId=window.setTimeout(a,this.delay)}return!this.stopSingle},delayedRightCall:function(a){this.rightclickTimerId=null;a&&this.callback("rightclick",[a])},click:function(a){this.last||(this.last=this.getEventInfo(a));this.handleSingle(a);return!this.stopSingle},dblclick:function(a){this.handleDouble(a);return!this.stopDouble},handleDouble:function(a){this.passesDblclickTolerance(a)&&(this["double"]&&this.callback("dblclick",
[a]),this.clearTimer())},handleSingle:function(a){this.passesTolerance(a)&&(null!=this.timerId?(this.last.touches&&1===this.last.touches.length&&(this["double"]&&OpenLayers.Event.preventDefault(a),this.handleDouble(a)),this.last.touches&&2===this.last.touches.length||this.clearTimer()):(this.first=this.getEventInfo(a),a=this.single?OpenLayers.Util.extend({},a):null,this.queuePotentialClick(a)))},queuePotentialClick:function(a){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,
this,a),this.delay)},passesTolerance:function(a){var b=!0;if(null!=this.pixelTolerance&&this.down&&this.down.xy&&(b=this.pixelTolerance>=this.down.xy.distanceTo(a.xy))&&this.touch&&this.down.touches.length===this.last.touches.length){a=0;for(var c=this.down.touches.length;a<c;++a)if(this.getTouchDistance(this.down.touches[a],this.last.touches[a])>this.pixelTolerance){b=!1;break}}return b},getTouchDistance:function(a,b){return Math.sqrt(Math.pow(a.clientX-b.clientX,2)+Math.pow(a.clientY-b.clientY,
2))},passesDblclickTolerance:function(a){a=!0;this.down&&this.first&&(a=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance);return a},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null);null!=this.rightclickTimerId&&(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(a){this.timerId=null;a&&this.callback("click",[a])},getEventInfo:function(a){var b;if(a.touches){var c=a.touches.length;b=Array(c);for(var d,
e=0;e<c;e++)d=a.touches[e],b[e]={clientX:d.olClientX,clientY:d.olClientY}}return{xy:a.xy,touches:b}},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),this.last=this.first=this.down=null,a=!0);return a},CLASS_NAME:"OpenLayers.Handler.Click"});OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(!0===this.documentDrag){var d=this;this._docMove=function(a){d.mousemove({xy:{x:a.clientX,y:a.clientY},element:document})};this._docUp=function(a){d.mouseup({xy:{x:a.clientX,y:a.clientY}})}}},
dragstart:function(a){var b=!0;this.dragging=!1;this.checkModifiers(a)&&(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))?(this.started=!0,this.last=this.start=a.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(a),this.callback("down",[a.xy]),OpenLayers.Event.preventDefault(a),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True),document.onselectstart=OpenLayers.Function.False,b=!this.stopDown):
(this.started=!1,this.last=this.start=null);return b},dragmove:function(a){this.lastMoveEvt=a;!this.started||(this.timeoutId||a.xy.x==this.last.x&&a.xy.y==this.last.y)||(!0===this.documentDrag&&this.documentEvents&&(a.element===document?(this.adjustXY(a),this.setEvent(a)):this.removeDocumentEvents()),0<this.interval&&(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(a),this.callback("move",[a.xy]),this.oldOnselectstart||(this.oldOnselectstart=
document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=a.xy);return!0},dragend:function(a){if(this.started){!0===this.documentDrag&&this.documentEvents&&(this.adjustXY(a),this.removeDocumentEvents());var b=this.start!=this.last;this.dragging=this.started=!1;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(a);this.callback("up",[a.xy]);b&&this.callback("done",[a.xy]);document.onselectstart=this.oldOnselectstart}return!0},down:function(a){},move:function(a){},
up:function(a){},out:function(a){},mousedown:function(a){return this.dragstart(a)},touchstart:function(a){this.startTouch();return this.dragstart(a)},mousemove:function(a){return this.dragmove(a)},touchmove:function(a){return this.dragmove(a)},removeTimeout:function(){this.timeoutId=null;this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(a){return this.dragend(a)},touchend:function(a){a.xy=this.last;return this.dragend(a)},mouseout:function(a){if(this.started&&OpenLayers.Util.mouseLeft(a,
this.map.viewPortDiv))if(!0===this.documentDrag)this.addDocumentEvents();else{var b=this.start!=this.last;this.dragging=this.started=!1;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(a);this.callback("out",[]);b&&this.callback("done",[a.xy]);document.onselectstart&&(document.onselectstart=this.oldOnselectstart)}return!0},click:function(a){return this.start==this.last},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.dragging=
!1,a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.dragging=this.started=!1,this.last=this.start=null,a=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"));return a},adjustXY:function(a){var b=OpenLayers.Util.pagePosition(this.map.viewPortDiv);a.xy.x-=b[0];a.xy.y-=b[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown");this.documentEvents=!0;OpenLayers.Event.observe(document,"mousemove",
this._docMove);OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown");this.documentEvents=!1;OpenLayers.Event.stopObserving(document,"mousemove",this._docMove);OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"});OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,maximized:!1,maximizeTitle:"",minimizeTitle:"",initialize:function(a){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[a])},destroy:function(){this.mapDiv&&(this.handlers.click&&this.handlers.click.destroy(),
this.handlers.drag&&this.handlers.drag.destroy(),this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle),this.extentRectangle=null,this.rectEvents&&(this.rectEvents.destroy(),this.rectEvents=null),this.ovmap&&(this.ovmap.destroy(),this.ovmap=null),this.element.removeChild(this.mapDiv),this.mapDiv=null,this.div.removeChild(this.element),this.element=null,this.maximizeDiv&&(this.div.removeChild(this.maximizeDiv),this.maximizeDiv=null),this.minimizeDiv&&(this.div.removeChild(this.minimizeDiv),
this.minimizeDiv=null),this.map.events.un({buttonclick:this.onButtonClick,moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments))},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(0===this.layers.length)if(this.map.baseLayer)this.layers=[this.map.baseLayer.clone()];else return this.map.events.register("changebaselayer",this,this.baseLayerDraw),this.div;this.element=document.createElement("div");this.element.className=
this.displayClass+"Element";this.element.style.display="none";this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1E3;this.extentRectangle.className=this.displayClass+
"ExtentRectangle";this.element.appendChild(this.mapDiv);this.div.appendChild(this.element);if(this.outsideViewport)this.element.style.display="";else{this.div.className+=" "+this.displayClass+"Container";var a=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,a,"absolute");this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton";this.maximizeTitle&&
(this.maximizeDiv.title=this.maximizeTitle);this.div.appendChild(this.maximizeDiv);a=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,a,"absolute");this.minimizeDiv.style.display="none";this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton";this.minimizeTitle&&(this.minimizeDiv.title=this.minimizeTitle);this.div.appendChild(this.minimizeDiv);this.minimizeControl()}this.map.getExtent()&&
this.update();this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this});this.maximized&&this.maximizeControl();return this.div},baseLayerDraw:function(){this.draw();this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(a){var b=this.handlers.drag.last.x-a.x,c=this.handlers.drag.last.y-a.y;if(0!=b||0!=c){var d=this.rectPxBounds.top,e=this.rectPxBounds.left;a=Math.abs(this.rectPxBounds.getHeight());var f=this.rectPxBounds.getWidth(),c=Math.max(0,
d-c),c=Math.min(c,this.ovmap.size.h-this.hComp-a),b=Math.max(0,e-b),b=Math.min(b,this.ovmap.size.w-this.wComp-f);this.setRectPxBounds(new OpenLayers.Bounds(b,c+a,b+f,c))}},mapDivClick:function(a){var b=this.rectPxBounds.getCenterPixel(),c=a.xy.x-b.x,d=a.xy.y-b.y,e=this.rectPxBounds.top,f=this.rectPxBounds.left;a=Math.abs(this.rectPxBounds.getHeight());b=this.rectPxBounds.getWidth();d=Math.max(0,e+d);d=Math.min(d,this.ovmap.size.h-a);c=Math.max(0,f+c);c=Math.min(c,this.ovmap.size.w-b);this.setRectPxBounds(new OpenLayers.Bounds(c,
d+a,c+b,d));this.updateMapToRect()},onButtonClick:function(a){a.buttonElement===this.minimizeDiv?this.minimizeControl():a.buttonElement===this.maximizeDiv&&this.maximizeControl()},maximizeControl:function(a){this.element.style.display="";this.showToggle(!1);null!=a&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.element.style.display="none";this.showToggle(!0);null!=a&&OpenLayers.Event.stop(a)},showToggle:function(a){this.maximizeDiv&&(this.maximizeDiv.style.display=a?"":"none");this.minimizeDiv&&
(this.minimizeDiv.style.display=a?"none":"")},update:function(){null==this.ovmap&&this.createMap();!this.autoPan&&this.isSuitableOverview()||this.updateOverview();this.updateRectToMap()},isSuitableOverview:function(){var a=this.map.getExtent(),b=this.map.getMaxExtent(),a=new OpenLayers.Bounds(Math.max(a.left,b.left),Math.max(a.bottom,b.bottom),Math.min(a.right,b.right),Math.min(a.top,b.top));this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()));
b=this.ovmap.getResolution()/this.map.getResolution();return b>this.minRatio&&b<=this.maxRatio&&this.ovmap.getExtent().containsBounds(a)},updateOverview:function(){var a=this.map.getResolution(),b=this.ovmap.getResolution(),c=b/a;c>this.maxRatio?b=this.minRatio*a:c<=this.minRatio&&(b=this.maxRatio*a);this.ovmap.getProjection()!=this.map.getProjection()?(a=this.map.center.clone(),a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())):a=this.map.center;this.ovmap.setCenter(a,
this.ovmap.getZoomForResolution(b*this.resolutionFactor));this.updateRectToMap()},createMap:function(){var a=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:!1},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,a);this.ovmap.viewPortDiv.appendChild(this.extentRectangle);OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=(this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,
"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")))?this.wComp:2;this.hComp=(this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width")))?this.hComp:2;this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},
{single:!0,"double":!1,stopSingle:!0,stopDouble:!0,pixelTolerance:1,map:this.ovmap});this.handlers.click.activate();this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,!0);this.rectEvents.register("mouseover",this,function(a){this.handlers.drag.active||this.map.dragging||this.handlers.drag.activate()});this.rectEvents.register("mouseout",this,function(a){this.handlers.drag.dragging||this.handlers.drag.deactivate()});if(this.ovmap.getProjection()!=this.map.getProjection()){var a=this.map.getProjectionObject().getUnits()||
this.map.units||this.map.baseLayer.units,b=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=a&&b?OpenLayers.INCHES_PER_UNIT[a]/OpenLayers.INCHES_PER_UNIT[b]:1}},updateRectToMap:function(){var a;a=this.ovmap.getProjection()!=this.map.getProjection()?this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):this.map.getExtent();(a=this.getRectBoundsFromMapBounds(a))&&this.setRectPxBounds(a)},updateMapToRect:function(){var a=
this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject()));this.map.panTo(a.getCenterLonLat())},setRectPxBounds:function(a){var b=Math.max(a.top,0),c=Math.max(a.left,0),d=Math.min(a.top+Math.abs(a.getHeight()),this.ovmap.size.h-this.hComp);a=Math.min(a.left+a.getWidth(),this.ovmap.size.w-this.wComp);var e=Math.max(a-c,0),f=Math.max(d-b,0);e<this.minRectSize||f<this.minRectSize?
(this.extentRectangle.className=this.displayClass+this.minRectDisplayClass,e=c+e/2-this.minRectSize/2,this.extentRectangle.style.top=Math.round(b+f/2-this.minRectSize/2)+"px",this.extentRectangle.style.left=Math.round(e)+"px",this.extentRectangle.style.height=this.minRectSize+"px",this.extentRectangle.style.width=this.minRectSize+"px"):(this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.extentRectangle.style.top=Math.round(b)+"px",this.extentRectangle.style.left=Math.round(c)+
"px",this.extentRectangle.style.height=Math.round(f)+"px",this.extentRectangle.style.width=Math.round(e)+"px");this.rectPxBounds=new OpenLayers.Bounds(Math.round(c),Math.round(d),Math.round(a),Math.round(b))},getRectBoundsFromMapBounds:function(a){var b=this.getOverviewPxFromLonLat({lon:a.left,lat:a.bottom});a=this.getOverviewPxFromLonLat({lon:a.right,lat:a.top});var c=null;b&&a&&(c=new OpenLayers.Bounds(b.x,b.y,a.x,a.y));return c},getMapBoundsFromRectBounds:function(a){var b=this.getLonLatFromOverviewPx({x:a.left,
y:a.bottom});a=this.getLonLatFromOverviewPx({x:a.right,y:a.top});return new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat)},getLonLatFromOverviewPx:function(a){var b=this.ovmap.size,c=this.ovmap.getResolution(),d=this.ovmap.getExtent().getCenterLonLat();return{lon:d.lon+(a.x-b.w/2)*c,lat:d.lat-(a.y-b.h/2)*c}},getOverviewPxFromLonLat:function(a){var b=this.ovmap.getResolution(),c=this.ovmap.getExtent();if(c)return{x:Math.round(1/b*(a.lon-c.left)),y:Math.round(1/b*(c.top-a.lat))}},CLASS_NAME:"OpenLayers.Control.OverviewMap"});OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:"scales resolutions maxScale minScale maxResolution minResolution numZoomLevels maxZoomLevel".split(" "),events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,
numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(a,b){this.metadata={};b=OpenLayers.Util.extend({},b);null!=this.alwaysInRange&&(b.alwaysInRange=this.alwaysInRange);this.addOptions(b);this.name=a;if(null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this,
this.div),this.eventListeners instanceof Object))this.events.on(this.eventListeners)},destroy:function(a){null==a&&(a=!0);null!=this.map&&this.map.removeLayer(this,a);this.options=this.div=this.name=this.map=this.projection=null;this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy());this.events=this.eventListeners=null},clone:function(a){null==a&&(a=new OpenLayers.Layer(this.name,this.getOptions()));OpenLayers.Util.applyDefaults(a,this);a.map=null;return a},
getOptions:function(){var a={},b;for(b in this.options)a[b]=this[b];return a},setName:function(a){a!=this.name&&(this.name=a,null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(a,b){null==this.options&&(this.options={});a&&("string"==typeof a.projection&&(a.projection=new OpenLayers.Projection(a.projection)),a.projection&&OpenLayers.Util.applyDefaults(a,OpenLayers.Projection.defaults[a.projection.getCode()]),!a.maxExtent||a.maxExtent instanceof
OpenLayers.Bounds||(a.maxExtent=new OpenLayers.Bounds(a.maxExtent)),!a.minExtent||a.minExtent instanceof OpenLayers.Bounds||(a.minExtent=new OpenLayers.Bounds(a.minExtent)));OpenLayers.Util.extend(this.options,a);OpenLayers.Util.extend(this,a);this.projection&&this.projection.getUnits()&&(this.units=this.projection.getUnits());if(this.map){var c=this.map.getResolution(),d=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]),e;for(e in a)if(a.hasOwnProperty(e)&&0<=OpenLayers.Util.indexOf(d,
e)){this.initResolutions();b&&this.map.baseLayer===this&&(this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(c),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}},onMapResize:function(){},redraw:function(){var a=!1;if(this.map){this.inRange=this.calculateInRange();var b=this.getExtent();b&&(this.inRange&&this.visibility)&&(this.moveTo(b,!0,!1),this.events.triggerEvent("moveend",{zoomChanged:!0}),a=!0)}return a},moveTo:function(a,b,c){a=this.visibility;
this.isBaseLayer||(a=a&&this.inRange);this.display(a)},moveByPx:function(a,b){},setMap:function(a){null==this.map&&(this.map=a,this.maxExtent=this.maxExtent||this.map.maxExtent,this.minExtent=this.minExtent||this.map.minExtent,this.projection=this.projection||this.map.projection,"string"==typeof this.projection&&(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions(),this.isBaseLayer||(this.inRange=this.calculateInRange(),
this.div.style.display=this.visibility&&this.inRange?"":"none"),this.setTileSize())},afterAdd:function(){},removeMap:function(a){},getImageSize:function(a){return this.imageSize||this.tileSize},setTileSize:function(a){this.tileSize=a=a?a:this.tileSize?this.tileSize:this.map.getTileSize();this.gutter&&(this.imageSize=new OpenLayers.Size(a.w+2*this.gutter,a.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(a){a!=this.visibility&&(this.visibility=a,this.display(a),
this.redraw(),null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged"))},display:function(a){a!=("none"!=this.div.style.display)&&(this.div.style.display=a&&this.calculateInRange()?"block":"none")},calculateInRange:function(){var a=!1;this.alwaysInRange?a=!0:this.map&&(a=this.map.getResolution(),a=a>=this.minResolution&&a<=this.maxResolution);return a},setIsBaseLayer:function(a){a!=this.isBaseLayer&&(this.isBaseLayer=
a,null!=this.map&&this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var a,b,c,d={},e=!0;a=0;for(b=this.RESOLUTION_PROPERTIES.length;a<b;a++)c=this.RESOLUTION_PROPERTIES[a],d[c]=this.options[c],e&&this.options[c]&&(e=!1);null==this.options.alwaysInRange&&(this.alwaysInRange=e);null==d.resolutions&&(d.resolutions=this.resolutionsFromScales(d.scales));null==d.resolutions&&(d.resolutions=this.calculateResolutions(d));if(null==d.resolutions){a=0;for(b=this.RESOLUTION_PROPERTIES.length;a<
b;a++)c=this.RESOLUTION_PROPERTIES[a],d[c]=null!=this.options[c]?this.options[c]:this.map[c];null==d.resolutions&&(d.resolutions=this.resolutionsFromScales(d.scales));null==d.resolutions&&(d.resolutions=this.calculateResolutions(d))}var f;this.options.maxResolution&&"auto"!==this.options.maxResolution&&(f=this.options.maxResolution);this.options.minScale&&(f=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var g;this.options.minResolution&&"auto"!==this.options.minResolution&&
(g=this.options.minResolution);this.options.maxScale&&(g=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units));d.resolutions&&(d.resolutions.sort(function(a,b){return b-a}),f||(f=d.resolutions[0]),g||(g=d.resolutions[d.resolutions.length-1]));if(this.resolutions=d.resolutions){b=this.resolutions.length;this.scales=Array(b);for(a=0;a<b;a++)this.scales[a]=OpenLayers.Util.getScaleFromResolution(this.resolutions[a],this.units);this.numZoomLevels=b}if(this.minResolution=g)this.maxScale=
OpenLayers.Util.getScaleFromResolution(g,this.units);if(this.maxResolution=f)this.minScale=OpenLayers.Util.getScaleFromResolution(f,this.units)},resolutionsFromScales:function(a){if(null!=a){var b,c,d;d=a.length;b=Array(d);for(c=0;c<d;c++)b[c]=OpenLayers.Util.getResolutionFromScale(a[c],this.units);return b}},calculateResolutions:function(a){var b,c,d=a.maxResolution;null!=a.minScale?d=OpenLayers.Util.getResolutionFromScale(a.minScale,this.units):"auto"==d&&null!=this.maxExtent&&(b=this.map.getSize(),
c=this.maxExtent.getWidth()/b.w,b=this.maxExtent.getHeight()/b.h,d=Math.max(c,b));c=a.minResolution;null!=a.maxScale?c=OpenLayers.Util.getResolutionFromScale(a.maxScale,this.units):"auto"==a.minResolution&&null!=this.minExtent&&(b=this.map.getSize(),c=this.minExtent.getWidth()/b.w,b=this.minExtent.getHeight()/b.h,c=Math.max(c,b));"number"!==typeof d&&("number"!==typeof c&&null!=this.maxExtent)&&(d=this.map.getTileSize(),d=Math.max(this.maxExtent.getWidth()/d.w,this.maxExtent.getHeight()/d.h));b=a.maxZoomLevel;
a=a.numZoomLevels;"number"===typeof c&&"number"===typeof d&&void 0===a?a=Math.floor(Math.log(d/c)/Math.log(2))+1:void 0===a&&null!=b&&(a=b+1);if(!("number"!==typeof a||0>=a||"number"!==typeof d&&"number"!==typeof c)){b=Array(a);var e=2;"number"==typeof c&&"number"==typeof d&&(e=Math.pow(d/c,1/(a-1)));var f;if("number"===typeof d)for(f=0;f<a;f++)b[f]=d/Math.pow(e,f);else for(f=0;f<a;f++)b[a-1-f]=c*Math.pow(e,f);return b}},getResolution:function(){var a=this.map.getZoom();return this.getResolutionForZoom(a)},
getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(a,b){var c=this.map.getSize(),c=Math.max(a.getWidth()/c.w,a.getHeight()/c.h);return this.getZoomForResolution(c,b)},getDataExtent:function(){},getResolutionForZoom:function(a){a=Math.max(0,Math.min(a,this.resolutions.length-1));if(this.map.fractionalZoom){var b=Math.floor(a),c=Math.ceil(a);a=this.resolutions[b]-(a-b)*(this.resolutions[b]-this.resolutions[c])}else a=this.resolutions[Math.round(a)];return a},getZoomForResolution:function(a,
b){var c,d;if(this.map.fractionalZoom){var e=0,f=this.resolutions[e],g=this.resolutions[this.resolutions.length-1],h;c=0;for(d=this.resolutions.length;c<d;++c)if(h=this.resolutions[c],h>=a&&(f=h,e=c),h<=a){g=h;break}c=f-g;c=0<c?e+(f-a)/c:e}else{f=Number.POSITIVE_INFINITY;c=0;for(d=this.resolutions.length;c<d;c++)if(b){e=Math.abs(this.resolutions[c]-a);if(e>f)break;f=e}else if(this.resolutions[c]<a)break;c=Math.max(0,c-1)}return c},getLonLatFromViewPortPx:function(a){var b=null,c=this.map;if(null!=
a&&c.minPx){var b=c.getResolution(),d=c.getMaxExtent({restricted:!0}),b=new OpenLayers.LonLat((a.x-c.minPx.x)*b+d.left,(c.minPx.y-a.y)*b+d.top);this.wrapDateLine&&(b=b.wrapDateLine(this.maxExtent))}return b},getViewPortPxFromLonLat:function(a,b){var c=null;null!=a&&(b=b||this.map.getResolution(),c=this.map.calculateBounds(null,b),c=new OpenLayers.Pixel(1/b*(a.lon-c.left),1/b*(c.top-a.lat)));return c},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var b=this.div.childNodes,c=0,d=b.length;c<
d;++c){var e=b[c].firstChild||b[c],f=b[c].lastChild;f&&"iframe"===f.nodeName.toLowerCase()&&(e=f.parentNode);OpenLayers.Util.modifyDOMElement(e,null,null,null,null,null,null,a)}null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(a){this.div.style.zIndex=a},adjustBounds:function(a){if(this.gutter){var b=this.gutter*this.map.getResolution();a=new OpenLayers.Bounds(a.left-b,a.bottom-b,a.right+
b,a.top+b)}this.wrapDateLine&&(b={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()},a=a.wrapDateLine(this.maxExtent,b));return a},CLASS_NAME:"OpenLayers.Layer"});OpenLayers.Layer.SphericalMercator={getExtent:function(){var a=null;return a=this.sphericalMercator?this.map.calculateBounds():OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)},getLonLatFromViewPortPx:function(a){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(a){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];for(var a=0;a<=this.MAX_ZOOM_LEVEL;++a)this.RESOLUTIONS[a]=
156543.03390625/Math.pow(2,a);this.units="m";this.projection=this.projection||"EPSG:900913"},forwardMercator:function(){var a=new OpenLayers.Projection("EPSG:4326"),b=new OpenLayers.Projection("EPSG:900913");return function(c,d){var e=OpenLayers.Projection.transform({x:c,y:d},a,b);return new OpenLayers.LonLat(e.x,e.y)}}(),inverseMercator:function(){var a=new OpenLayers.Projection("EPSG:4326"),b=new OpenLayers.Projection("EPSG:900913");return function(c,d){var e=OpenLayers.Projection.transform({x:c,
y:d},b,a);return new OpenLayers.LonLat(e.x,e.y)}}()};OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:!0,isBaseLayer:!0,isFixed:!0,pane:null,mapObject:null,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);null==this.pane&&(this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane"))},destroy:function(){this.pane=this.mapObject=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex=
parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width="100%";this.pane.style.height="100%";"msie"==OpenLayers.BROWSER_NAME&&(this.pane.style.background="url("+OpenLayers.Util.getImageLocation("blank.gif")+")");this.isFixed?this.map.viewPortDiv.appendChild(this.pane):this.map.layerContainerDiv.appendChild(this.pane);this.loadMapObject();null==this.mapObject&&this.loadWarningMessage()},removeMap:function(a){this.pane&&this.pane.parentNode&&this.pane.parentNode.removeChild(this.pane);
OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var a=this.map.getSize(),b=Math.min(a.w,300),c=Math.min(a.h,200),b=new OpenLayers.Size(b,c),a=(new OpenLayers.Pixel(a.w/2,a.h/2)).add(-b.w/2,-b.h/2),a=OpenLayers.Util.createDiv(this.name+"_warning",a,b,null,null,null,"auto");a.style.padding="7px";a.style.backgroundColor="yellow";a.innerHTML=this.getWarningHTML();this.div.appendChild(a)},getWarningHTML:function(){return""},
display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display},setZIndex:function(a){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveByPx:function(a,b){OpenLayers.Layer.prototype.moveByPx.apply(this,arguments);this.dragPanMapObject?this.dragPanMapObject(a,-b):this.moveTo(this.map.getCachedCenter())},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,
arguments);if(null!=this.mapObject){var d=this.map.getCenter(),e=this.map.getZoom();if(null!=d){var f=this.getMapObjectCenter(),f=this.getOLLonLatFromMapObjectLonLat(f),g=this.getMapObjectZoom(),g=this.getOLZoomFromMapObjectZoom(g);d.equals(f)&&e==g||(!b&&f&&this.dragPanMapObject&&this.smoothDragPan?(e=this.map.getViewPortPxFromLonLat(f),d=this.map.getViewPortPxFromLonLat(d),this.dragPanMapObject(d.x-e.x,e.y-d.y)):(d=this.getMapObjectLonLatFromOLLonLat(d),e=this.getMapObjectZoomFromOLZoom(e),this.setMapObjectCenter(d,
e,c)))}}},getLonLatFromViewPortPx:function(a){var b=null;null!=this.mapObject&&null!=this.getMapObjectCenter()&&(a=this.getMapObjectPixelFromOLPixel(a),a=this.getMapObjectLonLatFromMapObjectPixel(a),b=this.getOLLonLatFromMapObjectLonLat(a));return b},getViewPortPxFromLonLat:function(a){var b=null;null!=this.mapObject&&null!=this.getMapObjectCenter()&&(a=this.getMapObjectLonLatFromOLLonLat(a),a=this.getMapObjectPixelFromMapObjectLonLat(a),b=this.getOLPixelFromMapObjectPixel(a));return b},getOLLonLatFromMapObjectLonLat:function(a){var b=
null;null!=a&&(b=this.getLongitudeFromMapObjectLonLat(a),a=this.getLatitudeFromMapObjectLonLat(a),b=new OpenLayers.LonLat(b,a));return b},getMapObjectLonLatFromOLLonLat:function(a){var b=null;null!=a&&(b=this.getMapObjectLonLatFromLonLat(a.lon,a.lat));return b},getOLPixelFromMapObjectPixel:function(a){var b=null;null!=a&&(b=this.getXFromMapObjectPixel(a),a=this.getYFromMapObjectPixel(a),b=new OpenLayers.Pixel(b,a));return b},getMapObjectPixelFromOLPixel:function(a){var b=null;null!=a&&(b=this.getMapObjectPixelFromXY(a.x,
a.y));return b},CLASS_NAME:"OpenLayers.Layer.EventPane"});OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){for(var a=["minZoomLevel","maxZoomLevel","numZoomLevels"],b=0,c=a.length;b<c;b++){var d=a[b];this[d]=null!=this.options[d]?this.options[d]:this.map[d]}if(null==this.minZoomLevel||this.minZoomLevel<this.MIN_ZOOM_LEVEL)this.minZoomLevel=this.MIN_ZOOM_LEVEL;a=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;b=null==this.options.numZoomLevels&&null!=this.options.maxZoomLevel||null==this.numZoomLevels&&null!=this.maxZoomLevel?
this.maxZoomLevel-this.minZoomLevel+1:this.numZoomLevels;this.numZoomLevels=null!=b?Math.min(b,a):a;this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(null!=this.RESOLUTIONS){a=0;this.resolutions=[];for(b=this.minZoomLevel;b<=this.maxZoomLevel;b++)this.resolutions[a++]=this.RESOLUTIONS[b];this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getResolution.apply(this,
arguments);var a=null,b=this.map.getSize(),c=this.getExtent();null!=b&&null!=c&&(a=Math.max(c.getWidth()/b.w,c.getHeight()/b.h));return a},getExtent:function(){var a=this.map.getSize(),b=this.getLonLatFromViewPortPx({x:0,y:0}),a=this.getLonLatFromViewPortPx({x:a.w,y:a.h});return null!=b&&null!=a?new OpenLayers.Bounds(b.lon,a.lat,a.lon,b.lat):null},getZoomForResolution:function(a){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments);var b=OpenLayers.Layer.prototype.getExtent.apply(this,
[]);return this.getZoomForExtent(b)},getOLZoomFromMapObjectZoom:function(a){var b=null;null!=a&&(b=a-this.minZoomLevel,this.map.baseLayer!==this&&(b=this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(b))));return b},getMapObjectZoomFromOLZoom:function(a){var b=null;null!=a&&(b=a+this.minZoomLevel,this.map.baseLayer!==this&&(b=this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(b))));return b},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"});OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,6.866455078125E-4,3.4332275390625E-4,1.71661376953125E-4,8.58306884765625E-5,4.291534423828125E-5,2.145767211914062E-5,1.072883605957031E-5,5.36441802978515E-6,2.68220901489257E-6,1.341104507446289E-6,6.705522537231445E-7],
type:null,wrapDateLine:!0,sphericalMercator:!1,version:null,initialize:function(a,b){b=b||{};b.version||(b.version="function"===typeof GMap2?"2":"3");var c=OpenLayers.Layer.Google["v"+b.version.replace(/\./g,"_")];if(c)OpenLayers.Util.applyDefaults(b,c);else throw"Unsupported Google Maps API version: "+b.version;OpenLayers.Util.applyDefaults(b,c.DEFAULTS);b.maxExtent&&(b.maxExtent=b.maxExtent.clone());OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[a,b]);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,
[a,b]);this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(a){var b=null==this.opacity?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments);this.setOpacity(b)},display:function(a){this._dragging||this.setGMapVisibility(a);OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},moveTo:function(a,
b,c){this._dragging=c;OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments);delete this._dragging},setOpacity:function(a){a!==this.opacity&&(null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"}),this.opacity=a);if(this.getVisibility()){var b=this.getMapContainer();OpenLayers.Util.modifyDOMElement(b,null,null,null,null,null,null,a)}},destroy:function(){if(this.map){this.setGMapVisibility(!1);var a=OpenLayers.Layer.Google.cache[this.map.id];a&&1>=a.count&&
this.removeGMapElements()}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var a=OpenLayers.Layer.Google.cache[this.map.id];if(a){var b=this.mapObject&&this.getMapContainer();b&&b.parentNode&&b.parentNode.removeChild(b);(b=a.termsOfUse)&&b.parentNode&&b.parentNode.removeChild(b);(a=a.poweredBy)&&a.parentNode&&a.parentNode.removeChild(a);this.mapObject&&(window.google&&google.maps&&google.maps.event&&google.maps.event.clearListeners)&&google.maps.event.clearListeners(this.mapObject,
"tilesloaded")}},removeMap:function(a){this.visibility&&this.mapObject&&this.setGMapVisibility(!1);var b=OpenLayers.Layer.Google.cache[a.id];b&&(1>=b.count?(this.removeGMapElements(),delete OpenLayers.Layer.Google.cache[a.id]):--b.count);delete this.termsOfUse;delete this.poweredBy;delete this.mapObject;delete this.dragObject;OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(a){var b=null;null!=a&&(b=a.getSouthWest(),a=a.getNorthEast(),this.sphericalMercator?
(b=this.forwardMercator(b.lng(),b.lat()),a=this.forwardMercator(a.lng(),a.lat())):(b=new OpenLayers.LonLat(b.lng(),b.lat()),a=new OpenLayers.LonLat(a.lng(),a.lat())),b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat));return b},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),
a.lat()).lon:a.lng()},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),a.lat()).lat:a.lat()},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},CLASS_NAME:"OpenLayers.Layer.Google"});OpenLayers.Layer.Google.cache={};
OpenLayers.Layer.Google.v2={termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){this.type||(this.type=G_NORMAL_MAP);var a,b,c,d=OpenLayers.Layer.Google.cache[this.map.id];if(d)a=d.mapObject,b=d.termsOfUse,c=d.poweredBy,++d.count;else{var d=this.map.viewPortDiv,e=document.createElement("div");e.id=this.map.id+"_GMap2Container";e.style.position="absolute";e.style.width="100%";e.style.height="100%";d.appendChild(e);try{a=new GMap2(e),b=e.lastChild,d.appendChild(b),b.style.zIndex=
"1100",b.style.right="",b.style.bottom="",b.className="olLayerGoogleCopyright",c=e.lastChild,d.appendChild(c),c.style.zIndex="1100",c.style.right="",c.style.bottom="",c.className="olLayerGooglePoweredBy gmnoprint"}catch(f){throw f;}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:a,termsOfUse:b,poweredBy:c,count:1}}this.mapObject=a;this.termsOfUse=b;this.poweredBy=c;-1===OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)&&this.mapObject.addMapType(this.type);"function"==typeof a.getDragObject?
this.dragObject=a.getDragObject():this.dragPanMapObject=null;!1===this.isBaseLayer&&this.setGMapVisibility("none"!==this.div.style.display)},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded())this.mapObject.checkResize();else{if(!this._resized)var a=this,b=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(b);delete a._resized;a.mapObject.checkResize();a.moveTo(a.map.getCenter(),a.map.getZoom())});this._resized=!0}},setGMapVisibility:function(a){var b=OpenLayers.Layer.Google.cache[this.map.id];
if(b){var c=this.mapObject.getContainer();!0===a?(this.mapObject.setMapType(this.type),c.style.display="",this.termsOfUse.style.left="",this.termsOfUse.style.display="",this.poweredBy.style.display="",b.displayed=this.id):(b.displayed===this.id&&delete b.displayed,b.displayed||(c.style.display="none",this.termsOfUse.style.display="none",this.termsOfUse.style.left="-9999px",this.poweredBy.style.display="none"))}},getMapContainer:function(){return this.mapObject.getContainer()},getMapObjectBoundsFromOLBounds:function(a){var b=
null;null!=a&&(b=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,a.left),a=this.sphericalMercator?this.inverseMercator(a.top,a.right):new OpenLayers.LonLat(a.top,a.right),b=new GLatLngBounds(new GLatLng(b.lat,b.lon),new GLatLng(a.lat,a.lon)));return b},setMapObjectCenter:function(a,b){this.mapObject.setCenter(a,b)},dragPanMapObject:function(a,b){this.dragObject.moveBy(new GSize(-a,b))},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.fromContainerPixelToLatLng(a)},
getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.fromLatLngToContainerPixel(a)},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(a,b){var c;this.sphericalMercator?(c=this.inverseMercator(a,b),c=new GLatLng(c.lat,c.lon)):c=new GLatLng(b,a);return c},getMapObjectPixelFromXY:function(a,b){return new GPoint(a,b)}};OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(a){window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM"));OpenLayers.Format.prototype.initialize.apply(this,[a]);this.namespaces=OpenLayers.Util.extend({},this.namespaces);this.namespaceAlias={};for(var b in this.namespaces)this.namespaceAlias[this.namespaces[b]]=b},destroy:function(){this.xmldom=null;OpenLayers.Format.prototype.destroy.apply(this,
arguments)},setNamespace:function(a,b){this.namespaces[a]=b;this.namespaceAlias[b]=a},read:function(a){var b=a.indexOf("<");0<b&&(a=a.substring(b));b=OpenLayers.Util.Try(OpenLayers.Function.bind(function(){var b;b=window.ActiveXObject&&!this.xmldom?new ActiveXObject("Microsoft.XMLDOM"):this.xmldom;b.loadXML(a);return b},this),function(){return(new DOMParser).parseFromString(a,"text/xml")},function(){var b=new XMLHttpRequest;b.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(a),!1);b.overrideMimeType&&
b.overrideMimeType("text/xml");b.send(null);return b.responseXML});this.keepData&&(this.data=b);return b},write:function(a){if(this.xmldom)a=a.xml;else{var b=new XMLSerializer;if(1==a.nodeType){var c=document.implementation.createDocument("","",null);c.importNode&&(a=c.importNode(a,!0));c.appendChild(a);a=b.serializeToString(c)}else a=b.serializeToString(a)}return a},createElementNS:function(a,b){return this.xmldom?"string"==typeof a?this.xmldom.createNode(1,b,a):this.xmldom.createNode(1,b,""):document.createElementNS(a,
b)},createDocumentFragment:function(){return this.xmldom?this.xmldom.createDocumentFragment():document.createDocumentFragment()},createTextNode:function(a){"string"!==typeof a&&(a=String(a));return this.xmldom?this.xmldom.createTextNode(a):document.createTextNode(a)},getElementsByTagNameNS:function(a,b,c){var d=[];if(a.getElementsByTagNameNS)d=a.getElementsByTagNameNS(b,c);else{a=a.getElementsByTagName("*");for(var e,f,g=0,h=a.length;g<h;++g)if(e=a[g],f=e.prefix?e.prefix+":"+c:c,"*"==c||f==e.nodeName)"*"!=
b&&b!=e.namespaceURI||d.push(e)}return d},getAttributeNodeNS:function(a,b,c){var d=null;if(a.getAttributeNodeNS)d=a.getAttributeNodeNS(b,c);else{a=a.attributes;for(var e,f,g=0,h=a.length;g<h;++g)if(e=a[g],e.namespaceURI==b&&(f=e.prefix?e.prefix+":"+c:c,f==e.nodeName)){d=e;break}}return d},getAttributeNS:function(a,b,c){var d="";if(a.getAttributeNS)d=a.getAttributeNS(b,c)||"";else if(a=this.getAttributeNodeNS(a,b,c))d=a.nodeValue;return d},getChildValue:function(a,b){var c=b||"";if(a)for(var d=a.firstChild;d;d=
d.nextSibling)switch(d.nodeType){case 3:case 4:c+=d.nodeValue}return c},isSimpleContent:function(a){var b=!0;for(a=a.firstChild;a;a=a.nextSibling)if(1===a.nodeType){b=!1;break}return b},contentType:function(a){var b=!1,c=!1,d=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY;for(a=a.firstChild;a;a=a.nextSibling){switch(a.nodeType){case 1:c=!0;break;case 8:break;default:b=!0}if(c&&b)break}if(c&&b)d=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;else{if(c)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;if(b)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}return d},
hasAttributeNS:function(a,b,c){var d=!1;return d=a.hasAttributeNS?a.hasAttributeNS(b,c):!!this.getAttributeNodeNS(a,b,c)},setAttributeNS:function(a,b,c,d){if(a.setAttributeNS)a.setAttributeNS(b,c,d);else if(this.xmldom)b?(b=a.ownerDocument.createNode(2,c,b),b.nodeValue=d,a.setAttributeNode(b)):a.setAttribute(c,d);else throw"setAttributeNS not implemented";},createElementNSPlus:function(a,b){b=b||{};var c=b.uri||this.namespaces[b.prefix];c||(c=a.indexOf(":"),c=this.namespaces[a.substring(0,c)]);c||
(c=this.namespaces[this.defaultPrefix]);c=this.createElementNS(c,a);b.attributes&&this.setAttributes(c,b.attributes);var d=b.value;null!=d&&c.appendChild(this.createTextNode(d));return c},setAttributes:function(a,b){var c,d,e;for(e in b)null!=b[e]&&b[e].toString&&(c=b[e].toString(),d=this.namespaces[e.substring(0,e.indexOf(":"))]||null,this.setAttributeNS(a,d,e,c))},readNode:function(a,b){b||(b={});var c=this.readers[a.namespaceURI?this.namespaceAlias[a.namespaceURI]:this.defaultPrefix];if(c){var d=
a.localName||a.nodeName.split(":").pop();(c=c[d]||c["*"])&&c.apply(this,[a,b])}return b},readChildNodes:function(a,b){b||(b={});for(var c=a.childNodes,d,e=0,f=c.length;e<f;++e)d=c[e],1==d.nodeType&&this.readNode(d,b);return b},writeNode:function(a,b,c){var d,e=a.indexOf(":");0<e?(d=a.substring(0,e),a=a.substring(e+1)):d=c?this.namespaceAlias[c.namespaceURI]:this.defaultPrefix;b=this.writers[d][a].apply(this,[b]);c&&c.appendChild(b);return b},getChildEl:function(a,b,c){return a&&this.getThisOrNextEl(a.firstChild,
b,c)},getNextEl:function(a,b,c){return a&&this.getThisOrNextEl(a.nextSibling,b,c)},getThisOrNextEl:function(a,b,c){a:for(;a;a=a.nextSibling)switch(a.nodeType){case 1:if(!(b&&b!==(a.localName||a.nodeName.split(":").pop())||c&&c!==a.namespaceURI))break a;a=null;break a;case 3:if(/^\s*$/.test(a.nodeValue))break;case 4:case 6:case 12:case 10:case 11:a=null;break a}return a||null},lookupNamespaceURI:function(a,b){var c=null;if(a)if(a.lookupNamespaceURI)c=a.lookupNamespaceURI(b);else a:switch(a.nodeType){case 1:if(null!==
a.namespaceURI&&a.prefix===b){c=a.namespaceURI;break a}if(c=a.attributes.length)for(var d,e=0;e<c;++e)if(d=a.attributes[e],"xmlns"===d.prefix&&d.name==="xmlns:"+b){c=d.value||null;break a}else if("xmlns"===d.name&&null===b){c=d.value||null;break a}c=this.lookupNamespaceURI(a.parentNode,b);break a;case 2:c=this.lookupNamespaceURI(a.ownerElement,b);break a;case 9:c=this.lookupNamespaceURI(a.documentElement,b);break a;case 6:case 12:case 10:case 11:break a;default:c=this.lookupNamespaceURI(a.parentNode,
b)}return c},getXMLDoc:function(){OpenLayers.Format.XML.document||this.xmldom||(document.implementation&&document.implementation.createDocument?OpenLayers.Format.XML.document=document.implementation.createDocument("","",null):!this.xmldom&&window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM")));return OpenLayers.Format.XML.document||this.xmldom},CLASS_NAME:"OpenLayers.Format.XML"});OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3};
OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype);OpenLayers.Format.XML.document=null;OpenLayers.Format.WFST=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.WFST.DEFAULTS);var b=OpenLayers.Format.WFST["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported WFST version: "+a.version;return new b(a)};OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"};OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(a,b,c){this.layer=a;this.lonlat=b;this.data=null!=c?c:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){null!=this.layer&&null!=this.layer.map&&null!=this.popup&&this.layer.map.removePopup(this.popup);null!=this.layer&&null!=this.marker&&this.layer.removeMarker(this.marker);this.data=this.lonlat=this.id=this.layer=null;null!=this.marker&&
(this.destroyMarker(this.marker),this.marker=null);null!=this.popup&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var a=!1;null!=this.layer&&null!=this.layer.map&&(a=this.layer.map.getExtent().containsLonLat(this.lonlat));return a},createMarker:function(){null!=this.lonlat&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon));return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(a){null!=this.lonlat&&(this.popup||(this.popup=new (this.popupClass?
this.popupClass:OpenLayers.Popup.Anchored)(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,this.marker?this.marker.icon:null,a)),null!=this.data.overflow&&(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this);return this.popup},destroyPopup:function(){this.popup&&(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"});OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};
OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(a,b,c){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,b]);this.lonlat=null;this.geometry=a?a:null;this.state=null;this.attributes={};b&&(this.attributes=OpenLayers.Util.extend(this.attributes,b));this.style=c?c:null},destroy:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=
null);this.modified=this.geometry=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(a){var b=!1;this.layer&&this.layer.map&&(b=this.layer.map.getExtent(),a?(a=this.geometry.getBounds(),b=b.intersectsBounds(a)):b=b.toGeometry().intersects(this.geometry));return b},getVisibility:function(){return!(this.style&&"none"==this.style.display||!this.layer||
this.layer&&this.layer.styleMap&&"none"==this.layer.styleMap.createSymbolizer(this,this.renderIntent).display||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(a,b,c){var d=!1;this.geometry&&(d=this.geometry.atPoint(a,b,c));return d},destroyPopup:function(){},move:function(a){if(this.layer&&this.geometry.move){a="OpenLayers.LonLat"==a.CLASS_NAME?this.layer.getViewPortPxFromLonLat(a):a;var b=
this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),c=this.layer.map.getResolution();this.geometry.move(c*(a.x-b.x),c*(b.y-a.y));this.layer.drawFeature(this);return b}},toState:function(a){if(a==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=a}else if(a==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=a}else if(a==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=
a}else a==OpenLayers.State.UNKNOWN&&(this.state=a)},CLASS_NAME:"OpenLayers.Feature.Vector"});
OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:0.4,
hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:0.2,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#66cccc",strokeOpacity:1,
strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}};OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(a,b){OpenLayers.Util.extend(this,b);this.rules=[];b&&b.rules&&this.addRules(b.rules);this.setDefaultStyle(a||OpenLayers.Feature.Vector.style["default"]);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,b=this.rules.length;a<b;a++)this.rules[a].destroy(),
this.rules[a]=null;this.defaultStyle=this.rules=null},createSymbolizer:function(a){for(var b=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),a),c=this.rules,d,e=[],f=!1,g=0,h=c.length;g<h;g++)d=c[g],d.evaluate(a)&&(d instanceof OpenLayers.Rule&&d.elseFilter?e.push(d):(f=!0,this.applySymbolizer(d,b,a)));if(!1==f&&0<e.length)for(f=!0,g=0,h=e.length;g<h;g++)this.applySymbolizer(e[g],b,a);0<c.length&&!1==f&&(b.display="none");null!=b.label&&"string"!==typeof b.label&&
(b.label=String(b.label));return b},applySymbolizer:function(a,b,c){var d=c.geometry?this.getSymbolizerPrefix(c.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0];a=a.symbolizer[d]||a.symbolizer;!0===this.defaultsPerSymbolizer&&(d=this.defaultStyle,OpenLayers.Util.applyDefaults(a,{pointRadius:d.pointRadius}),!0!==a.stroke&&!0!==a.graphic||OpenLayers.Util.applyDefaults(a,{strokeWidth:d.strokeWidth,strokeColor:d.strokeColor,strokeOpacity:d.strokeOpacity,strokeDashstyle:d.strokeDashstyle,strokeLinecap:d.strokeLinecap}),
!0!==a.fill&&!0!==a.graphic||OpenLayers.Util.applyDefaults(a,{fillColor:d.fillColor,fillOpacity:d.fillOpacity}),!0===a.graphic&&OpenLayers.Util.applyDefaults(a,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset}));
return this.createLiterals(OpenLayers.Util.extend(b,a),c)},createLiterals:function(a,b){var c=OpenLayers.Util.extend({},b.attributes||b.data);OpenLayers.Util.extend(c,this.context);for(var d in this.propertyStyles)a[d]=OpenLayers.Style.createLiteral(a[d],c,b,d);return a},findPropertyStyles:function(){var a={};this.addPropertyStyles(a,this.defaultStyle);for(var b=this.rules,c,d,e=0,f=b.length;e<f;e++){c=b[e].symbolizer;for(var g in c)if(d=c[g],"object"==typeof d)this.addPropertyStyles(a,d);else{this.addPropertyStyles(a,
c);break}}return a},addPropertyStyles:function(a,b){var c,d;for(d in b)c=b[d],"string"==typeof c&&c.match(/\$\{\w+\}/)&&(a[d]=!0);return a},addRules:function(a){Array.prototype.push.apply(this.rules,a);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(a){this.defaultStyle=a;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(a){for(var b=OpenLayers.Style.SYMBOLIZER_PREFIXES,c=0,d=b.length;c<d;c++)if(-1!=a.CLASS_NAME.indexOf(b[c]))return b[c]},clone:function(){var a=
OpenLayers.Util.extend({},this);if(this.rules){a.rules=[];for(var b=0,c=this.rules.length;b<c;++b)a.rules.push(this.rules[b].clone())}a.context=this.context&&OpenLayers.Util.extend({},this.context);b=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(b,a)},CLASS_NAME:"OpenLayers.Style"});OpenLayers.Style.createLiteral=function(a,b,c,d){"string"==typeof a&&-1!=a.indexOf("${")&&(a=OpenLayers.String.format(a,b,[c,d]),a=isNaN(a)||!a?a:parseFloat(a));return a};
OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"];OpenLayers.Filter=OpenLayers.Class({initialize:function(a){OpenLayers.Util.extend(this,a)},destroy:function(){},evaluate:function(a){return!0},clone:function(){return null},toString:function(){return OpenLayers.Format&&OpenLayers.Format.CQL?OpenLayers.Format.CQL.prototype.write(this):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Filter"});OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(a){var b=!1;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(a.geometry){var c=this.value;"OpenLayers.Bounds"==this.value.CLASS_NAME&&(c=this.value.toGeometry());a.geometry.intersects(c)&&(b=!0)}break;default:throw Error("evaluate is not implemented for this filter type.");}return b},clone:function(){var a=
OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(a)},CLASS_NAME:"OpenLayers.Filter.Spatial"});OpenLayers.Filter.Spatial.BBOX="BBOX";OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS";OpenLayers.Filter.Spatial.DWITHIN="DWITHIN";OpenLayers.Filter.Spatial.WITHIN="WITHIN";OpenLayers.Filter.Spatial.CONTAINS="CONTAINS";OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,type:"FID",initialize:function(a){this.fids=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(a){for(var b=0,c=this.fids.length;b<c;b++)if((a.fid||a.id)==this.fids[b])return!0;return!1},clone:function(){var a=new OpenLayers.Filter.FeatureId;OpenLayers.Util.extend(a,this);a.fids=this.fids.slice();return a},CLASS_NAME:"OpenLayers.Filter.FeatureId"});OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:!0,xy:!0,stateName:null,initialize:function(a){this.stateName={};this.stateName[OpenLayers.State.INSERT]="wfs:Insert";this.stateName[OpenLayers.State.UPDATE]=
"wfs:Update";this.stateName[OpenLayers.State.DELETE]="wfs:Delete";OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},getSrsName:function(a,b){var c=b&&b.srsName;c||(c=a&&a.layer?a.layer.projection.getCode():this.srsName);return c},read:function(a,b){b=b||{};OpenLayers.Util.applyDefaults(b,{output:"features"});"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var c={};a&&this.readNode(a,c,!0);c.features&&"features"===b.output&&
(c=c.features);return c},readers:{wfs:{FeatureCollection:function(a,b){b.features=[];this.readChildNodes(a,b)}}},write:function(a,b){var c=this.writeNode("wfs:Transaction",{features:a,options:b}),d=this.schemaLocationAttr();d&&this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",d);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},writers:{wfs:{GetFeature:function(a){var b=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,handle:a&&a.handle,
outputFormat:a&&a.outputFormat,maxFeatures:a&&a.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(a)}});if("string"==typeof this.featureType)this.writeNode("Query",a,b);else for(var c=0,d=this.featureType.length;c<d;c++)a.featureType=this.featureType[c],this.writeNode("Query",a,b);return b},Transaction:function(a){a=a||{};var b=a.options||{},c=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version,handle:b.handle}}),d,e=a.features;if(e){!0===b.multi&&OpenLayers.Util.extend(this.geometryTypes,
{"OpenLayers.Geometry.Point":"MultiPoint","OpenLayers.Geometry.LineString":!0===this.multiCurve?"MultiCurve":"MultiLineString","OpenLayers.Geometry.Polygon":!0===this.multiSurface?"MultiSurface":"MultiPolygon"});var f,g;a=0;for(d=e.length;a<d;++a)g=e[a],(f=this.stateName[g.state])&&this.writeNode(f,{feature:g,options:b},c);!0===b.multi&&this.setGeometryTypes()}if(b.nativeElements)for(a=0,d=b.nativeElements.length;a<d;++a)this.writeNode("wfs:Native",b.nativeElements[a],c);return c},Native:function(a){return this.createElementNSPlus("wfs:Native",
{attributes:{vendorId:a.vendorId,safeToIgnore:a.safeToIgnore},value:a.value})},Insert:function(a){var b=a.feature;a=a.options;a=this.createElementNSPlus("wfs:Insert",{attributes:{handle:a&&a.handle}});this.srsName=this.getSrsName(b);this.writeNode("feature:_typeName",b,a);return a},Update:function(a){var b=a.feature;a=a.options;a=this.createElementNSPlus("wfs:Update",{attributes:{handle:a&&a.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&a.setAttribute("xmlns:"+
this.featurePrefix,this.featureNS);var c=b.modified;null===this.geometryName||c&&void 0===c.geometry||(this.srsName=this.getSrsName(b),this.writeNode("Property",{name:this.geometryName,value:b.geometry},a));for(var d in b.attributes)void 0===b.attributes[d]||c&&c.attributes&&(!c.attributes||void 0===c.attributes[d])||this.writeNode("Property",{name:d,value:b.attributes[d]},a);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[b.fid]}),a);return a},Property:function(a){var b=this.createElementNSPlus("wfs:Property");
this.writeNode("Name",a.name,b);null!==a.value&&this.writeNode("Value",a.value,b);return b},Name:function(a){return this.createElementNSPlus("wfs:Name",{value:a})},Value:function(a){var b;a instanceof OpenLayers.Geometry?(b=this.createElementNSPlus("wfs:Value"),a=this.writeNode("feature:_geometry",a).firstChild,b.appendChild(a)):b=this.createElementNSPlus("wfs:Value",{value:a});return b},Delete:function(a){var b=a.feature;a=a.options;a=this.createElementNSPlus("wfs:Delete",{attributes:{handle:a&&
a.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&a.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[b.fid]}),a);return a}}},schemaLocationAttr:function(a){a=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},a);var b=OpenLayers.Util.extend({},this.schemaLocations);a.schema&&(b[a.featurePrefix]=a.schema);a=[];var c,d;for(d in b)(c=this.namespaces[d])&&
a.push(c+" "+b[d]);return a.join(" ")||void 0},setFilterProperty:function(a){if(a.filters)for(var b=0,c=a.filters.length;b<c;++b)OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(this,a.filters[b]);else a instanceof OpenLayers.Filter.Spatial&&!a.property&&(a.property=this.geometryName)},CLASS_NAME:"OpenLayers.Format.WFST.v1"});OpenLayers.Format.OGCExceptionReport=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},defaultPrefix:"ogc",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b={exceptionReport:null};a.documentElement&&(this.readChildNodes(a,b),null===b.exceptionReport&&(b=(new OpenLayers.Format.OWSCommon).read(a)));return b},readers:{ogc:{ServiceExceptionReport:function(a,
b){b.exceptionReport={exceptions:[]};this.readChildNodes(a,b.exceptionReport)},ServiceException:function(a,b){var c={code:a.getAttribute("code"),locator:a.getAttribute("locator"),text:this.getChildValue(a)};b.exceptions.push(c)}}},CLASS_NAME:"OpenLayers.Format.OGCExceptionReport"});OpenLayers.Format.XML.VersionedOGC=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:null,version:null,profile:null,allowFallback:!1,name:null,stringifyOutput:!1,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);a=this.CLASS_NAME;this.name=a.substring(a.lastIndexOf(".")+1)},getVersion:function(a,b){var c;a?(c=this.version,c||(c=a.getAttribute("version"),c||(c=this.defaultVersion))):c=b&&b.version||this.version||this.defaultVersion;return c},getParser:function(a){a=
a||this.defaultVersion;var b=this.profile?"_"+this.profile:"";if(!this.parser||this.parser.VERSION!=a){var c=OpenLayers.Format[this.name]["v"+a.replace(/\./g,"_")+b];if(!c&&(""!==b&&this.allowFallback&&(b="",c=OpenLayers.Format[this.name]["v"+a.replace(/\./g,"_")]),!c))throw"Can't find a "+this.name+" parser for version "+a+b;this.parser=new c(this.options)}return this.parser},write:function(a,b){var c=this.getVersion(null,b);this.parser=this.getParser(c);c=this.parser.write(a,b);return!1===this.stringifyOutput?
c:OpenLayers.Format.XML.prototype.write.apply(this,[c])},read:function(a,b){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=this.getVersion(a.documentElement);this.parser=this.getParser(c);var d=this.parser.read(a,b),e=this.parser.errorProperty||null;null!==e&&void 0===d[e]&&(e=new OpenLayers.Format.OGCExceptionReport,d.error=e.read(a));d.version=c;return d},CLASS_NAME:"OpenLayers.Format.XML.VersionedOGC"});OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(a){this.filters=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},destroy:function(){this.filters=null;OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(a){var b,c;switch(this.type){case OpenLayers.Filter.Logical.AND:b=0;for(c=this.filters.length;b<c;b++)if(!1==this.filters[b].evaluate(a))return!1;return!0;case OpenLayers.Filter.Logical.OR:b=0;for(c=this.filters.length;b<
c;b++)if(!0==this.filters[b].evaluate(a))return!0;return!1;case OpenLayers.Filter.Logical.NOT:return!this.filters[0].evaluate(a)}},clone:function(){for(var a=[],b=0,c=this.filters.length;b<c;++b)a.push(this.filters[b].clone());return new OpenLayers.Filter.Logical({type:this.type,filters:a})},CLASS_NAME:"OpenLayers.Filter.Logical"});OpenLayers.Filter.Logical.AND="&&";OpenLayers.Filter.Logical.OR="||";OpenLayers.Filter.Logical.NOT="!";OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(a){OpenLayers.Filter.prototype.initialize.apply(this,[a]);this.type===OpenLayers.Filter.Comparison.LIKE&&void 0===a.matchCase&&(this.matchCase=null)},evaluate:function(a){a instanceof OpenLayers.Feature.Vector&&(a=a.attributes);var b=!1;a=a[this.property];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:b=this.value;
b=this.matchCase||"string"!=typeof a||"string"!=typeof b?a==b:a.toUpperCase()==b.toUpperCase();break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:b=this.value;b=this.matchCase||"string"!=typeof a||"string"!=typeof b?a!=b:a.toUpperCase()!=b.toUpperCase();break;case OpenLayers.Filter.Comparison.LESS_THAN:b=a<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:b=a>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:b=a<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:b=
a>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:b=a>=this.lowerBoundary&&a<=this.upperBoundary;break;case OpenLayers.Filter.Comparison.LIKE:b=RegExp(this.value,"gi").test(a);break;case OpenLayers.Filter.Comparison.IS_NULL:b=null===a}return b},value2regex:function(a,b,c){if("."==a)throw Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison");a=a?a:"*";b=b?b:".";this.value=this.value.replace(RegExp("\\"+(c?c:"!")+"(.|$)","g"),"\\$1");this.value=this.value.replace(RegExp("\\"+
b,"g"),".");this.value=this.value.replace(RegExp("\\"+a,"g"),".*");this.value=this.value.replace(RegExp("\\\\.\\*","g"),"\\"+a);return this.value=this.value.replace(RegExp("\\\\\\.","g"),"\\"+b)},regex2value:function(){var a=this.value,a=a.replace(/!/g,"!!"),a=a.replace(/(\\)?\\\./g,function(a,c){return c?a:"!."}),a=a.replace(/(\\)?\\\*/g,function(a,c){return c?a:"!*"}),a=a.replace(/\\\\/g,"\\");return a=a.replace(/\.\*/g,"*")},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison,
this)},CLASS_NAME:"OpenLayers.Filter.Comparison"});OpenLayers.Filter.Comparison.EQUAL_TO="==";OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=";OpenLayers.Filter.Comparison.LESS_THAN="<";OpenLayers.Filter.Comparison.GREATER_THAN=">";OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=";OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=";OpenLayers.Filter.Comparison.BETWEEN="..";OpenLayers.Filter.Comparison.LIKE="~";OpenLayers.Filter.Comparison.IS_NULL="NULL";OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.Filter"});OpenLayers.Filter.Function=OpenLayers.Class(OpenLayers.Filter,{name:null,params:null,CLASS_NAME:"OpenLayers.Filter.Function"});OpenLayers.Date={dateRegEx:/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/,toISOString:function(){return"toISOString"in Date.prototype?function(a){return a.toISOString()}:function(a){return isNaN(a.getTime())?"Invalid Date":a.getUTCFullYear()+"-"+OpenLayers.Number.zeroPad(a.getUTCMonth()+1,2)+"-"+OpenLayers.Number.zeroPad(a.getUTCDate(),2)+"T"+OpenLayers.Number.zeroPad(a.getUTCHours(),2)+":"+OpenLayers.Number.zeroPad(a.getUTCMinutes(),
2)+":"+OpenLayers.Number.zeroPad(a.getUTCSeconds(),2)+"."+OpenLayers.Number.zeroPad(a.getUTCMilliseconds(),3)+"Z"}}(),parse:function(a){var b;if((a=a.match(this.dateRegEx))&&(a[1]||a[7])){b=parseInt(a[1],10)||0;var c=parseInt(a[2],10)-1||0,d=parseInt(a[3],10)||1;b=new Date(Date.UTC(b,c,d));if(c=a[7]){var d=parseInt(a[4],10),e=parseInt(a[5],10),f=parseFloat(a[6]),g=f|0,f=Math.round(1E3*(f-g));b.setUTCHours(d,e,g,f);"Z"!==c&&(c=parseInt(c,10),a=parseInt(a[8],10)||0,a=-1E3*(60*60*c+60*a),b=new Date(b.getTime()+
a))}}else b=new Date("invalid");return b}};OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){var b={};this.readers.ogc.Filter.apply(this,[a,b]);return b.filter},readers:{ogc:{_expression:function(a){for(var b="",c=a.firstChild;c;c=
c.nextSibling)switch(c.nodeType){case 1:a=this.readNode(c);a.property?b+="${"+a.property+"}":void 0!==a.value&&(b+=a.value);break;case 3:case 4:b+=c.nodeValue}return b},Filter:function(a,b){var c={fids:[],filters:[]};this.readChildNodes(a,c);0<c.fids.length?b.filter=new OpenLayers.Filter.FeatureId({fids:c.fids}):0<c.filters.length&&(b.filter=c.filters[0])},FeatureId:function(a,b){var c=a.getAttribute("fid");c&&b.fids.push(c)},And:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});
this.readChildNodes(a,c);b.filters.push(c)},Or:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(a,c);b.filters.push(c)},Not:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLessThan:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsGreaterThan:function(a,
b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLessThanOrEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsGreaterThanOrEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},
PropertyIsBetween:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(a,c);b.filters.push(c)},Literal:function(a,b){b.value=OpenLayers.String.numericIf(this.getChildValue(a),!0)},PropertyName:function(a,b){b.property=this.getChildValue(a)},LowerBoundary:function(a,b){b.lowerBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,a),!0)},UpperBoundary:function(a,b){b.upperBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,
a),!0)},Intersects:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(a,b){b.distance=parseInt(this.getChildValue(a));b.distanceUnits=a.getAttribute("units")},Function:function(a,b){},PropertyIsNull:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.IS_NULL});
this.readChildNodes(a,c);b.filters.push(c)}}},readSpatial:function(a,b,c){c=new OpenLayers.Filter.Spatial({type:c});this.readChildNodes(a,c);c.value=c.components[0];delete c.components;b.filters.push(c)},encodeLiteral:function(a){a instanceof Date&&(a=OpenLayers.Date.toISOString(a));return a},writeOgcExpression:function(a,b){a instanceof OpenLayers.Filter.Function?this.writeNode("Function",a,b):this.writeNode("Literal",a,b);return b},write:function(a){return this.writers.ogc.Filter.apply(this,[a])},
writers:{ogc:{Filter:function(a){var b=this.createElementNSPlus("ogc:Filter");this.writeNode(this.getFilterType(a),a,b);return b},_featureIds:function(a){for(var b=this.createDocumentFragment(),c=0,d=a.fids.length;c<d;++c)this.writeNode("ogc:FeatureId",a.fids[c],b);return b},FeatureId:function(a){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:a}})},And:function(a){for(var b=this.createElementNSPlus("ogc:And"),c,d=0,e=a.filters.length;d<e;++d)c=a.filters[d],this.writeNode(this.getFilterType(c),
c,b);return b},Or:function(a){for(var b=this.createElementNSPlus("ogc:Or"),c,d=0,e=a.filters.length;d<e;++d)c=a.filters[d],this.writeNode(this.getFilterType(c),c,b);return b},Not:function(a){var b=this.createElementNSPlus("ogc:Not");a=a.filters[0];this.writeNode(this.getFilterType(a),a,b);return b},PropertyIsLessThan:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThan");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsGreaterThan:function(a){var b=
this.createElementNSPlus("ogc:PropertyIsGreaterThan");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLessThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsGreaterThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);
return b},PropertyIsBetween:function(a){var b=this.createElementNSPlus("ogc:PropertyIsBetween");this.writeNode("PropertyName",a,b);this.writeNode("LowerBoundary",a,b);this.writeNode("UpperBoundary",a,b);return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",{value:a.property})},Literal:function(a){return this.createElementNSPlus("ogc:Literal",{value:(this.encodeLiteral||OpenLayers.Format.Filter.v1.prototype.encodeLiteral)(a)})},LowerBoundary:function(a){var b=this.createElementNSPlus("ogc:LowerBoundary");
this.writeOgcExpression(a.lowerBoundary,b);return b},UpperBoundary:function(a){var b=this.createElementNSPlus("ogc:UpperBoundary");this.writeNode("Literal",a.upperBoundary,b);return b},INTERSECTS:function(a){return this.writeSpatial(a,"Intersects")},WITHIN:function(a){return this.writeSpatial(a,"Within")},CONTAINS:function(a){return this.writeSpatial(a,"Contains")},DWITHIN:function(a){var b=this.writeSpatial(a,"DWithin");this.writeNode("Distance",a,b);return b},Distance:function(a){return this.createElementNSPlus("ogc:Distance",
{attributes:{units:a.distanceUnits},value:a.distance})},Function:function(a){var b=this.createElementNSPlus("ogc:Function",{attributes:{name:a.name}});a=a.params;for(var c=0,d=a.length;c<d;c++)this.writeOgcExpression(a[c],b);return b},PropertyIsNull:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNull");this.writeNode("PropertyName",a,b);return b}}},getFilterType:function(a){var b=this.filterMap[a.type];if(!b)throw"Filter writing not supported for rule type: "+a.type;return b},filterMap:{"&&":"And",
"||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan","<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",NULL:"PropertyIsNull",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS",FID:"_featureIds"},CLASS_NAME:"OpenLayers.Format.Filter.v1"});OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.bounds=this.id=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(a){a&&(this.bounds=a.clone())},clearBounds:function(){this.bounds=null;this.parent&&this.parent.clearBounds()},extendBounds:function(a){this.getBounds()?this.bounds.extend(a):this.setBounds(a)},getBounds:function(){null==this.bounds&&this.calculateBounds();
return this.bounds},calculateBounds:function(){},distanceTo:function(a,b){},getVertices:function(a){},atPoint:function(a,b,c){var d=!1;null!=this.getBounds()&&null!=a&&(b=null!=b?b:0,c=null!=c?c:0,d=(new OpenLayers.Bounds(this.bounds.left-b,this.bounds.bottom-c,this.bounds.right+b,this.bounds.top+c)).containsLonLat(a));return d},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){return OpenLayers.Format&&OpenLayers.Format.WKT?OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)):
Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Geometry"});OpenLayers.Geometry.fromWKT=function(a){var b;if(OpenLayers.Format&&OpenLayers.Format.WKT){var c=OpenLayers.Geometry.fromWKT.format;c||(c=new OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=c);a=c.read(a);if(a instanceof OpenLayers.Feature.Vector)b=a.geometry;else if(OpenLayers.Util.isArray(a)){b=a.length;for(var c=Array(b),d=0;d<b;++d)c[d]=a[d].geometry;b=new OpenLayers.Geometry.Collection(c)}}return b};
OpenLayers.Geometry.segmentsIntersect=function(a,b,c){var d=c&&c.point;c=c&&c.tolerance;var e=!1,f=a.x1-b.x1,g=a.y1-b.y1,h=a.x2-a.x1,k=a.y2-a.y1,l=b.y2-b.y1,m=b.x2-b.x1,n=l*h-m*k,l=m*g-l*f,g=h*g-k*f;0==n?0==l&&0==g&&(e=!0):(f=l/n,n=g/n,0<=f&&(1>=f&&0<=n&&1>=n)&&(d?(h=a.x1+f*h,n=a.y1+f*k,e=new OpenLayers.Geometry.Point(h,n)):e=!0));if(c)if(e){if(d)a:for(a=[a,b],b=0;2>b;++b)for(f=a[b],k=1;3>k;++k)if(h=f["x"+k],n=f["y"+k],d=Math.sqrt(Math.pow(h-e.x,2)+Math.pow(n-e.y,2)),d<c){e.x=h;e.y=n;break a}}else a:for(a=
[a,b],b=0;2>b;++b)for(h=a[b],n=a[(b+1)%2],k=1;3>k;++k)if(f={x:h["x"+k],y:h["y"+k]},g=OpenLayers.Geometry.distanceToSegment(f,n),g.distance<c){e=d?new OpenLayers.Geometry.Point(f.x,f.y):!0;break a}return e};OpenLayers.Geometry.distanceToSegment=function(a,b){var c=OpenLayers.Geometry.distanceSquaredToSegment(a,b);c.distance=Math.sqrt(c.distance);return c};
OpenLayers.Geometry.distanceSquaredToSegment=function(a,b){var c=a.x,d=a.y,e=b.x1,f=b.y1,g=b.x2,h=b.y2,k=g-e,l=h-f,m=(k*(c-e)+l*(d-f))/(Math.pow(k,2)+Math.pow(l,2));0>=m||(1<=m?(e=g,f=h):(e+=m*k,f+=m*l));return{distance:Math.pow(e-c,2)+Math.pow(f-d,2),x:e,y:f,along:m}};OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(a,b){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(a);this.y=parseFloat(b)},clone:function(a){null==a&&(a=new OpenLayers.Geometry.Point(this.x,this.y));OpenLayers.Util.applyDefaults(a,this);return a},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(a,b){var c=!(b&&!1===b.edge)&&b&&b.details,d,e,f,g,h;a instanceof
OpenLayers.Geometry.Point?(e=this.x,f=this.y,g=a.x,h=a.y,d=Math.sqrt(Math.pow(e-g,2)+Math.pow(f-h,2)),d=c?{x0:e,y0:f,x1:g,y1:h,distance:d}:d):(d=a.distanceTo(this,b),c&&(d={x0:d.x1,y0:d.y1,x1:d.x0,y1:d.y0,distance:d.distance}));return d},equals:function(a){var b=!1;null!=a&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return b},toShortString:function(){return this.x+", "+this.y},move:function(a,b){this.x+=a;this.y+=b;this.clearBounds()},rotate:function(a,b){a*=
Math.PI/180;var c=this.distanceTo(b),d=a+Math.atan2(this.y-b.y,this.x-b.x);this.x=b.x+c*Math.cos(d);this.y=b.y+c*Math.sin(d);this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(a,b,c){this.x=b.x+a*(void 0==c?1:c)*(this.x-b.x);this.y=b.y+a*(this.y-b.y);this.clearBounds();return this},intersects:function(a){var b=!1;return b="OpenLayers.Geometry.Point"==a.CLASS_NAME?this.equals(a):a.intersects(this)},transform:function(a,b){a&&b&&(OpenLayers.Projection.transform(this,
a,b),this.bounds=null);return this},getVertices:function(a){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"});OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(a){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];null!=a&&this.addComponents(a)},destroy:function(){this.components.length=0;this.components=null;OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){for(var a=eval("new "+this.CLASS_NAME+"()"),b=0,c=this.components.length;b<c;b++)a.addComponent(this.components[b].clone());
OpenLayers.Util.applyDefaults(a,this);return a},getComponentsString:function(){for(var a=[],b=0,c=this.components.length;b<c;b++)a.push(this.components[b].toShortString());return a.join(",")},calculateBounds:function(){this.bounds=null;var a=new OpenLayers.Bounds,b=this.components;if(b)for(var c=0,d=b.length;c<d;c++)a.extend(b[c].getBounds());null!=a.left&&(null!=a.bottom&&null!=a.right&&null!=a.top)&&this.setBounds(a)},addComponents:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0,c=a.length;b<
c;b++)this.addComponent(a[b])},addComponent:function(a,b){var c=!1;if(a&&(null==this.componentTypes||-1<OpenLayers.Util.indexOf(this.componentTypes,a.CLASS_NAME))){if(null!=b&&b<this.components.length){var c=this.components.slice(0,b),d=this.components.slice(b,this.components.length);c.push(a);this.components=c.concat(d)}else this.components.push(a);a.parent=this;this.clearBounds();c=!0}return c},removeComponents:function(a){var b=!1;OpenLayers.Util.isArray(a)||(a=[a]);for(var c=a.length-1;0<=c;--c)b=
this.removeComponent(a[c])||b;return b},removeComponent:function(a){OpenLayers.Util.removeItem(this.components,a);this.clearBounds();return!0},getLength:function(){for(var a=0,b=0,c=this.components.length;b<c;b++)a+=this.components[b].getLength();return a},getArea:function(){for(var a=0,b=0,c=this.components.length;b<c;b++)a+=this.components[b].getArea();return a},getGeodesicArea:function(a){for(var b=0,c=0,d=this.components.length;c<d;c++)b+=this.components[c].getGeodesicArea(a);return b},getCentroid:function(a){if(!a)return this.components.length&&
this.components[0].getCentroid();a=this.components.length;if(!a)return!1;for(var b=[],c=[],d=0,e=Number.MAX_VALUE,f,g=0;g<a;++g){f=this.components[g];var h=f.getArea();f=f.getCentroid(!0);isNaN(h)||(isNaN(f.x)||isNaN(f.y))||(b.push(h),d+=h,e=h<e&&0<h?h:e,c.push(f))}a=b.length;if(0===d){for(g=0;g<a;++g)b[g]=1;d=b.length}else{for(g=0;g<a;++g)b[g]/=e;d/=e}for(var k=e=0,g=0;g<a;++g)f=c[g],h=b[g],e+=f.x*h,k+=f.y*h;return new OpenLayers.Geometry.Point(e/d,k/d)},getGeodesicLength:function(a){for(var b=0,
c=0,d=this.components.length;c<d;c++)b+=this.components[c].getGeodesicLength(a);return b},move:function(a,b){for(var c=0,d=this.components.length;c<d;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c<d;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0;d<this.components.length;++d)this.components[d].resize(a,b,c);return this},distanceTo:function(a,b){for(var c=!(b&&!1===b.edge)&&b&&b.details,d,e,f,g=Number.POSITIVE_INFINITY,h=0,k=this.components.length;h<
k&&!(d=this.components[h].distanceTo(a,b),f=c?d.distance:d,f<g&&(g=f,e=d,0==g));++h);return e},equals:function(a){var b=!0;if(a&&a.CLASS_NAME&&this.CLASS_NAME==a.CLASS_NAME)if(OpenLayers.Util.isArray(a.components)&&a.components.length==this.components.length)for(var c=0,d=this.components.length;c<d;++c){if(!this.components[c].equals(a.components[c])){b=!1;break}}else b=!1;else b=!1;return b},transform:function(a,b){if(a&&b){for(var c=0,d=this.components.length;c<d;c++)this.components[c].transform(a,
b);this.bounds=null}return this},intersects:function(a){for(var b=!1,c=0,d=this.components.length;c<d&&!(b=a.intersects(this.components[c]));++c);return b},getVertices:function(a){for(var b=[],c=0,d=this.components.length;c<d;++c)Array.prototype.push.apply(b,this.components[c].getVertices(a));return b},CLASS_NAME:"OpenLayers.Geometry.Collection"});OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(a,b){this.addComponent(a,b)},removePoint:function(a){this.removeComponent(a)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"});OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var a=0;if(this.components&&1<this.components.length)for(var b=1,c=this.components.length;b<c;b++)a+=this.components[b-1].distanceTo(this.components[b]);return a},getGeodesicLength:function(a){var b=this;if(a){var c=new OpenLayers.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}a=0;if(b.components&&1<b.components.length)for(var d,e=1,f=b.components.length;e<
f;e++)c=b.components[e-1],d=b.components[e],a+=OpenLayers.Util.distVincenty({lon:c.x,lat:c.y},{lon:d.x,lat:d.y});return 1E3*a},CLASS_NAME:"OpenLayers.Geometry.Curve"});OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(a){var b=this.components&&2<this.components.length;b&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);return b},intersects:function(a){var b=!1,c=a.CLASS_NAME;if("OpenLayers.Geometry.LineString"==c||"OpenLayers.Geometry.LinearRing"==c||"OpenLayers.Geometry.Point"==c){var d=this.getSortedSegments();a="OpenLayers.Geometry.Point"==c?[{x1:a.x,y1:a.y,x2:a.x,y2:a.y}]:a.getSortedSegments();
var e,f,g,h,k,l,m,n=0,p=d.length;a:for(;n<p;++n){c=d[n];e=c.x1;f=c.x2;g=c.y1;h=c.y2;var q=0,r=a.length;for(;q<r;++q){k=a[q];if(k.x1>f)break;if(!(k.x2<e||(l=k.y1,m=k.y2,Math.min(l,m)>Math.max(g,h)||Math.max(l,m)<Math.min(g,h)||!OpenLayers.Geometry.segmentsIntersect(c,k)))){b=!0;break a}}}}else b=a.intersects(this);return b},getSortedSegments:function(){for(var a=this.components.length-1,b=Array(a),c,d,e=0;e<a;++e)c=this.components[e],d=this.components[e+1],b[e]=c.x<d.x?{x1:c.x,y1:c.y,x2:d.x,y2:d.y}:
{x1:d.x,y1:d.y,x2:c.x,y2:c.y};return b.sort(function(a,b){return a.x1-b.x1})},splitWithSegment:function(a,b){for(var c=!(b&&!1===b.edge),d=b&&b.tolerance,e=[],f=this.getVertices(),g=[],h=[],k=!1,l,m,n,p={point:!0,tolerance:d},q=null,r=0,s=f.length-2;r<=s;++r)if(d=f[r],g.push(d.clone()),l=f[r+1],m={x1:d.x,y1:d.y,x2:l.x,y2:l.y},m=OpenLayers.Geometry.segmentsIntersect(a,m,p),m instanceof OpenLayers.Geometry.Point&&((n=m.x===a.x1&&m.y===a.y1||m.x===a.x2&&m.y===a.y2||m.equals(d)||m.equals(l)?!0:!1)||c))m.equals(h[h.length-
1])||h.push(m.clone()),0===r&&m.equals(d)||m.equals(l)||(k=!0,m.equals(d)||g.push(m),e.push(new OpenLayers.Geometry.LineString(g)),g=[m.clone()]);k&&(g.push(l.clone()),e.push(new OpenLayers.Geometry.LineString(g)));if(0<h.length)var t=a.x1<a.x2?1:-1,u=a.y1<a.y2?1:-1,q={lines:e,points:h.sort(function(a,b){return t*a.x-t*b.x||u*a.y-u*b.y})};return q},split:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h;if(a instanceof OpenLayers.Geometry.LineString){var k=this.getVertices(),l,m,n,p,q,r=[];g=[];for(var s=
0,t=k.length-2;s<=t;++s){l=k[s];m=k[s+1];n={x1:l.x,y1:l.y,x2:m.x,y2:m.y};h=h||[a];d&&r.push(l.clone());for(var u=0;u<h.length;++u)if(p=h[u].splitWithSegment(n,b))if(q=p.lines,0<q.length&&(q.unshift(u,1),Array.prototype.splice.apply(h,q),u+=q.length-2),d)for(var v=0,w=p.points.length;v<w;++v)q=p.points[v],q.equals(l)||(r.push(q),g.push(new OpenLayers.Geometry.LineString(r)),r=q.equals(m)?[]:[q.clone()])}d&&(0<g.length&&0<r.length)&&(r.push(m.clone()),g.push(new OpenLayers.Geometry.LineString(r)))}else c=
a.splitWith(this,b);h&&1<h.length?f=!0:h=[];g&&1<g.length?e=!0:g=[];if(f||e)c=d?[g,h]:h;return c},splitWith:function(a,b){return a.split(this,b)},getVertices:function(a){return!0===a?[this.components[0],this.components[this.components.length-1]]:!1===a?this.components.slice(1,this.components.length-1):this.components.slice()},distanceTo:function(a,b){var c=!(b&&!1===b.edge)&&b&&b.details,d,e={},f=Number.POSITIVE_INFINITY;if(a instanceof OpenLayers.Geometry.Point){for(var g=this.getSortedSegments(),
h=a.x,k=a.y,l,m=0,n=g.length;m<n;++m)if(l=g[m],d=OpenLayers.Geometry.distanceToSegment(a,l),d.distance<f){if(f=d.distance,e=d,0===f)break}else if(l.x2>h&&(k>l.y1&&k<l.y2||k<l.y1&&k>l.y2))break;e=c?{distance:e.distance,x0:e.x,y0:e.y,x1:h,y1:k}:e.distance}else if(a instanceof OpenLayers.Geometry.LineString){var g=this.getSortedSegments(),h=a.getSortedSegments(),p,q,r=h.length,s={point:!0},m=0,n=g.length;a:for(;m<n;++m){k=g[m];l=k.x1;q=k.y1;for(var t=0;t<r;++t)if(d=h[t],p=OpenLayers.Geometry.segmentsIntersect(k,
d,s)){f=0;e={distance:0,x0:p.x,y0:p.y,x1:p.x,y1:p.y};break a}else d=OpenLayers.Geometry.distanceToSegment({x:l,y:q},d),d.distance<f&&(f=d.distance,e={distance:f,x0:l,y0:q,x1:d.x,y1:d.y})}c||(e=e.distance);0!==f&&k&&(d=a.distanceTo(new OpenLayers.Geometry.Point(k.x2,k.y2),b),m=c?d.distance:d,m<f&&(e=c?{distance:f,x0:d.x1,y0:d.y1,x1:d.x0,y1:d.y0}:m))}else e=a.distanceTo(this,b),c&&(e={distance:e.distance,x0:e.x1,y0:e.y1,x1:e.x0,y1:e.y0});return e},simplify:function(a){if(this&&null!==this){var b=this.getVertices();
if(3>b.length)return this;var c=function(a,b,d,k){for(var l=0,m=0,n=b,p;n<d;n++){p=a[b];var q=a[d],r=a[n],r=Math.abs(0.5*(p.x*q.y+q.x*r.y+r.x*p.y-q.x*p.y-r.x*q.y-p.x*r.y));p=Math.sqrt(Math.pow(p.x-q.x,2)+Math.pow(p.y-q.y,2));p=2*(r/p);p>l&&(l=p,m=n)}l>k&&m!=b&&(e.push(m),c(a,b,m,k),c(a,m,d,k))},d=b.length-1,e=[];e.push(0);for(e.push(d);b[0].equals(b[d]);)d--,e.push(d);c(b,0,d,a);a=[];e.sort(function(a,b){return a-b});for(d=0;d<e.length;d++)a.push(b[e[d]]);return new OpenLayers.Geometry.LineString(a)}return this},
CLASS_NAME:"OpenLayers.Geometry.LineString"});OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(a,b){for(var c=null,d=b&&b.mutual,e,f,g,h,k=[],l=[a],m=0,n=this.components.length;m<n;++m){f=this.components[m];g=!1;for(var p=0;p<l.length;++p)if(e=f.split(l[p],b)){if(d){g=e[0];for(var q=0,r=g.length;q<r;++q)0===q&&k.length?k[k.length-1].addComponent(g[q]):k.push(new OpenLayers.Geometry.MultiLineString([g[q]]));g=!0;e=e[1]}if(e.length){e.unshift(p,
1);Array.prototype.splice.apply(l,e);break}}g||(k.length?k[k.length-1].addComponent(f.clone()):k=[new OpenLayers.Geometry.MultiLineString(f.clone())])}k&&1<k.length?g=!0:k=[];l&&1<l.length?h=!0:l=[];if(g||h)c=d?[k,l]:l;return c},splitWith:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h,k,l;if(a instanceof OpenLayers.Geometry.LineString){l=[];k=[a];for(var m=0,n=this.components.length;m<n;++m){g=!1;f=this.components[m];for(var p=0;p<k.length;++p)if(e=k[p].split(f,b)){d&&(g=e[0],g.length&&(g.unshift(p,
1),Array.prototype.splice.apply(k,g),p+=g.length-2),e=e[1],0===e.length&&(e=[f.clone()]));g=0;for(var q=e.length;g<q;++g)0===g&&l.length?l[l.length-1].addComponent(e[g]):l.push(new OpenLayers.Geometry.MultiLineString([e[g]]));g=!0}g||(l.length?l[l.length-1].addComponent(f.clone()):l=[new OpenLayers.Geometry.MultiLineString([f.clone()])])}}else c=a.split(this);k&&1<k.length?h=!0:k=[];l&&1<l.length?g=!0:l=[];if(h||g)c=d?[k,l]:l;return c},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"});OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(a,b){var c=!1,d=this.components.pop();null==b&&a.equals(d)||(c=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments));OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]);return c},removeComponent:function(a){var b=this.components&&3<this.components.length;b&&(this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,
arguments),OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]));return b},move:function(a,b){for(var c=0,d=this.components.length;c<d-1;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c<d-1;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0,e=this.components.length;d<e-1;++d)this.components[d].resize(a,b,c);return this},transform:function(a,b){if(a&&b){for(var c=0,d=this.components.length;c<d-1;c++)this.components[c].transform(a,
b);this.bounds=null}return this},getCentroid:function(){if(this.components){var a=this.components.length;if(0<a&&2>=a)return this.components[0].clone();if(2<a){var b=0,c=0,d=this.components[0].x,e=this.components[0].y,f=-1*this.getArea();if(0!=f){for(var g=0;g<a-1;g++)var h=this.components[g],k=this.components[g+1],b=b+(h.x+k.x-2*d)*((h.x-d)*(k.y-e)-(k.x-d)*(h.y-e)),c=c+(h.y+k.y-2*e)*((h.x-d)*(k.y-e)-(k.x-d)*(h.y-e));b=d+b/(6*f);a=e+c/(6*f)}else{for(g=0;g<a-1;g++)b+=this.components[g].x,c+=this.components[g].y;
b/=a-1;a=c/(a-1)}return new OpenLayers.Geometry.Point(b,a)}return null}},getArea:function(){var a=0;if(this.components&&2<this.components.length){for(var b=a=0,c=this.components.length;b<c-1;b++)var d=this.components[b],e=this.components[b+1],a=a+(d.x+e.x)*(e.y-d.y);a=-a/2}return a},getGeodesicArea:function(a){var b=this;if(a){var c=new OpenLayers.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}a=0;c=b.components&&b.components.length;if(2<c){for(var d,e,f=0;f<c-1;f++)d=b.components[f],
e=b.components[f+1],a+=OpenLayers.Util.rad(e.x-d.x)*(2+Math.sin(OpenLayers.Util.rad(d.y))+Math.sin(OpenLayers.Util.rad(e.y)));a=40680631590769*a/2}return a},containsPoint:function(a){var b=OpenLayers.Number.limitSigDigs,c=b(a.x,14);a=b(a.y,14);for(var d=this.components.length-1,e,f,g,h,k,l=0,m=0;m<d;++m)if(e=this.components[m],g=b(e.x,14),e=b(e.y,14),f=this.components[m+1],h=b(f.x,14),f=b(f.y,14),e==f){if(a==e&&(g<=h&&c>=g&&c<=h||g>=h&&c<=g&&c>=h)){l=-1;break}}else{k=b((a-f)*((h-g)/(f-e))+h,14);if(k==
c&&(e<f&&a>=e&&a<=f||e>f&&a<=e&&a>=f)){l=-1;break}k<=c||g!=h&&(k<Math.min(g,h)||k>Math.max(g,h))||(e<f&&a>=e&&a<f||e>f&&a<e&&a>=f)&&++l}return-1==l?1:!!(l&1)},intersects:function(a){var b=!1;if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.containsPoint(a);else if("OpenLayers.Geometry.LineString"==a.CLASS_NAME)b=a.intersects(this);else if("OpenLayers.Geometry.LinearRing"==a.CLASS_NAME)b=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[a]);else for(var c=0,d=a.components.length;c<
d&&!(b=a.components[c].intersects(this));++c);return b},getVertices:function(a){return!0===a?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"});OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var a=0;if(this.components&&0<this.components.length)for(var a=a+Math.abs(this.components[0].getArea()),b=1,c=this.components.length;b<c;b++)a-=Math.abs(this.components[b].getArea());return a},getGeodesicArea:function(a){var b=0;if(this.components&&0<this.components.length)for(var b=b+Math.abs(this.components[0].getGeodesicArea(a)),c=1,d=this.components.length;c<
d;c++)b-=Math.abs(this.components[c].getGeodesicArea(a));return b},containsPoint:function(a){var b=this.components.length,c=!1;if(0<b&&(c=this.components[0].containsPoint(a),1!==c&&c&&1<b))for(var d,e=1;e<b;++e)if(d=this.components[e].containsPoint(a)){c=1===d?1:!1;break}return c},intersects:function(a){var b=!1,c,d;if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.containsPoint(a);else if("OpenLayers.Geometry.LineString"==a.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==a.CLASS_NAME){c=0;for(d=
this.components.length;c<d&&!(b=a.intersects(this.components[c]));++c);if(!b)for(c=0,d=a.components.length;c<d&&!(b=this.containsPoint(a.components[c]));++c);}else for(c=0,d=a.components.length;c<d&&!(b=this.intersects(a.components[c]));++c);if(!b&&"OpenLayers.Geometry.Polygon"==a.CLASS_NAME){var e=this.components[0];c=0;for(d=e.components.length;c<d&&!(b=a.containsPoint(e.components[c]));++c);}return b},distanceTo:function(a,b){return b&&!1===b.edge&&this.intersects(a)?0:OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,
[a,b])},CLASS_NAME:"OpenLayers.Geometry.Polygon"});OpenLayers.Geometry.Polygon.createRegularPolygon=function(a,b,c,d){var e=Math.PI*(1/c-0.5);d&&(e+=d/180*Math.PI);for(var f,g=[],h=0;h<c;++h)f=e+2*h*Math.PI/c,d=a.x+b*Math.cos(f),f=a.y+b*Math.sin(f),g.push(new OpenLayers.Geometry.Point(d,f));a=new OpenLayers.Geometry.LinearRing(g);return new OpenLayers.Geometry.Polygon([a])};OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:!0,xy:!0,initialize:function(a){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g};OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==
typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a=this.getElementsByTagNameNS(a.documentElement,this.gmlns,this.featureName);for(var b=[],c=0;c<a.length;c++){var d=this.parseFeature(a[c]);d&&b.push(d)}return b},parseFeature:function(a){for(var b="MultiPolygon Polygon MultiLineString LineString MultiPoint Point Envelope".split(" "),c,d,e,f=0;f<b.length;++f)if(c=b[f],d=this.getElementsByTagNameNS(a,this.gmlns,c),0<d.length){if(e=this.parseGeometry[c.toLowerCase()])e=e.apply(this,
[d[0]]),this.internalProjection&&this.externalProjection&&e.transform(this.externalProjection,this.internalProjection);else throw new TypeError("Unsupported geometry type: "+c);break}var g;c=this.getElementsByTagNameNS(a,this.gmlns,"Box");for(f=0;f<c.length;++f)b=c[f],d=this.parseGeometry.box.apply(this,[b]),b=b.parentNode,"boundedBy"===(b.localName||b.nodeName.split(":").pop())?g=d:e=d.toGeometry();var h;this.extractAttributes&&(h=this.parseAttributes(a));h=new OpenLayers.Feature.Vector(e,h);h.bounds=
g;h.gml={featureType:a.firstChild.nodeName.split(":")[1],featureNS:a.firstChild.namespaceURI,featureNSPrefix:a.firstChild.prefix};a=a.firstChild;for(var k;a&&(1!=a.nodeType||!(k=a.getAttribute("fid")||a.getAttribute("id")));)a=a.nextSibling;h.fid=k;return h},parseGeometry:{point:function(a){var b,c;c=[];b=this.getElementsByTagNameNS(a,this.gmlns,"pos");0<b.length&&(c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));0==c.length&&(b=this.getElementsByTagNameNS(a,
this.gmlns,"coordinates"),0<b.length&&(c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.removeSpace,""),c=c.split(",")));0==c.length&&(b=this.getElementsByTagNameNS(a,this.gmlns,"coord"),0<b.length&&(a=this.getElementsByTagNameNS(b[0],this.gmlns,"X"),b=this.getElementsByTagNameNS(b[0],this.gmlns,"Y"),0<a.length&&0<b.length&&(c=[a[0].firstChild.nodeValue,b[0].firstChild.nodeValue])));2==c.length&&(c[2]=null);return this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],
c[0],c[2])},multipoint:function(a){a=this.getElementsByTagNameNS(a,this.gmlns,"Point");var b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.point.apply(this,[a[d]]))&&b.push(c);return new OpenLayers.Geometry.MultiPoint(b)},linestring:function(a,b){var c,d;d=[];var e=[];c=this.getElementsByTagNameNS(a,this.gmlns,"posList");if(0<c.length){d=this.getChildValue(c[0]);d=d.replace(this.regExes.trimSpace,"");d=d.split(this.regExes.splitSpace);var f=parseInt(c[0].getAttribute("dimension")),
g,h,k;for(c=0;c<d.length/f;++c)g=c*f,h=d[g],k=d[g+1],g=2==f?null:d[g+2],this.xy?e.push(new OpenLayers.Geometry.Point(h,k,g)):e.push(new OpenLayers.Geometry.Point(k,h,g))}if(0==d.length&&(c=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),0<c.length))for(d=this.getChildValue(c[0]),d=d.replace(this.regExes.trimSpace,""),d=d.replace(this.regExes.trimComma,","),f=d.split(this.regExes.splitSpace),c=0;c<f.length;++c)d=f[c].split(","),2==d.length&&(d[2]=null),this.xy?e.push(new OpenLayers.Geometry.Point(d[0],
d[1],d[2])):e.push(new OpenLayers.Geometry.Point(d[1],d[0],d[2]));d=null;0!=e.length&&(d=b?new OpenLayers.Geometry.LinearRing(e):new OpenLayers.Geometry.LineString(e));return d},multilinestring:function(a){a=this.getElementsByTagNameNS(a,this.gmlns,"LineString");var b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.linestring.apply(this,[a[d]]))&&b.push(c);return new OpenLayers.Geometry.MultiLineString(b)},polygon:function(a){a=this.getElementsByTagNameNS(a,this.gmlns,"LinearRing");
var b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.linestring.apply(this,[a[d],!0]))&&b.push(c);return new OpenLayers.Geometry.Polygon(b)},multipolygon:function(a){a=this.getElementsByTagNameNS(a,this.gmlns,"Polygon");var b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.polygon.apply(this,[a[d]]))&&b.push(c);return new OpenLayers.Geometry.MultiPolygon(b)},envelope:function(a){var b=[],c,d,e=this.getElementsByTagNameNS(a,this.gmlns,"lowerCorner");if(0<e.length){c=
[];0<e.length&&(c=e[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));2==c.length&&(c[2]=null);var f=this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2])}a=this.getElementsByTagNameNS(a,this.gmlns,"upperCorner");if(0<a.length){c=[];0<a.length&&(c=a[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));2==c.length&&(c[2]=null);var g=this.xy?new OpenLayers.Geometry.Point(c[0],
c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2])}f&&g&&(b.push(new OpenLayers.Geometry.Point(f.x,f.y)),b.push(new OpenLayers.Geometry.Point(g.x,f.y)),b.push(new OpenLayers.Geometry.Point(g.x,g.y)),b.push(new OpenLayers.Geometry.Point(f.x,g.y)),b.push(new OpenLayers.Geometry.Point(f.x,f.y)),b=new OpenLayers.Geometry.LinearRing(b),d=new OpenLayers.Geometry.Polygon([b]));return d},box:function(a){var b=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),c=a=null;0<b.length&&(b=b[0].firstChild.nodeValue,
b=b.split(" "),2==b.length&&(a=b[0].split(","),c=b[1].split(",")));if(null!==a&&null!==c)return new OpenLayers.Bounds(parseFloat(a[0]),parseFloat(a[1]),parseFloat(c[0]),parseFloat(c[1]))}},parseAttributes:function(a){var b={};a=a.firstChild;for(var c,d,e;a;){if(1==a.nodeType){a=a.childNodes;for(c=0;c<a.length;++c)if(d=a[c],1==d.nodeType)if(e=d.childNodes,1==e.length){if(e=e[0],3==e.nodeType||4==e.nodeType)d=d.prefix?d.nodeName.split(":")[1]:d.nodeName,e=e.nodeValue.replace(this.regExes.trimSpace,
""),b[d]=e}else b[d.nodeName.split(":").pop()]=null;break}a=a.nextSibling}return b},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName),c=0;c<a.length;c++)b.appendChild(this.createFeatureXML(a[c]));return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);c.appendChild(b);
var b=this.createElementNS(this.gmlns,"gml:"+this.featureName),d=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName);d.setAttribute("fid",a.fid||a.id);d.appendChild(c);for(var e in a.attributes){var c=this.createTextNode(a.attributes[e]),f=e.substring(e.lastIndexOf(":")+1),f=this.createElementNS(this.featureNS,this.featurePrefix+":"+f);f.appendChild(c);d.appendChild(f)}b.appendChild(d);return b},buildGeometryNode:function(a){this.externalProjection&&this.internalProjection&&
(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME,b=b.substring(b.lastIndexOf(".")+1);return this.buildGeometry[b.toLowerCase()].apply(this,[a])},buildGeometry:{point:function(a){var b=this.createElementNS(this.gmlns,"gml:Point");b.appendChild(this.buildCoordinatesNode(a));return b},multipoint:function(a){var b=this.createElementNS(this.gmlns,"gml:MultiPoint");a=a.components;for(var c,d,e=0;e<a.length;e++)c=this.createElementNS(this.gmlns,"gml:pointMember"),
d=this.buildGeometry.point.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},linestring:function(a){var b=this.createElementNS(this.gmlns,"gml:LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){var b=this.createElementNS(this.gmlns,"gml:MultiLineString");a=a.components;for(var c,d,e=0;e<a.length;++e)c=this.createElementNS(this.gmlns,"gml:lineStringMember"),d=this.buildGeometry.linestring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);
return b},linearring:function(a){var b=this.createElementNS(this.gmlns,"gml:LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){var b=this.createElementNS(this.gmlns,"gml:Polygon");a=a.components;for(var c,d,e=0;e<a.length;++e)c=0==e?"outerBoundaryIs":"innerBoundaryIs",c=this.createElementNS(this.gmlns,"gml:"+c),d=this.buildGeometry.linearring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},multipolygon:function(a){var b=this.createElementNS(this.gmlns,
"gml:MultiPolygon");a=a.components;for(var c,d,e=0;e<a.length;++e)c=this.createElementNS(this.gmlns,"gml:polygonMember"),d=this.buildGeometry.polygon.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},bounds:function(a){var b=this.createElementNS(this.gmlns,"gml:Box");b.appendChild(this.buildCoordinatesNode(a));return b}},buildCoordinatesNode:function(a){var b=this.createElementNS(this.gmlns,"gml:coordinates");b.setAttribute("decimal",".");b.setAttribute("cs",",");b.setAttribute("ts",
" ");var c=[];if(a instanceof OpenLayers.Bounds)c.push(a.left+","+a.bottom),c.push(a.right+","+a.top);else{a=a.components?a.components:[a];for(var d=0;d<a.length;d++)c.push(a[d].x+","+a[d].y)}c=this.createTextNode(c.join(" "));b.appendChild(c);return b},CLASS_NAME:"OpenLayers.Format.GML"});OpenLayers.Format.GML||(OpenLayers.Format.GML={});
OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:!0,srsName:null,xy:!0,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,featureMember:/^(.*:)?featureMembers?$/},
initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.setGeometryTypes();a&&a.featureNS&&this.setNamespace("feature",a.featureNS);this.singleFeatureType=!a||"string"===typeof a.featureType},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b=[];this.readNode(a,{features:b},!0);if(0==b.length){var c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMember");if(c.length){a=
0;for(var d=c.length;a<d;++a)this.readNode(c[a],{features:b},!0)}else c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMembers"),c.length&&this.readNode(c[0],{features:b},!0)}return b},readNode:function(a,b,c){!0===c&&!0===this.autoConfig&&(this.featureType=null,delete this.namespaceAlias[this.featureNS],delete this.namespaces.feature,this.featureNS=null);this.featureNS||(a.prefix in this.namespaces||a.parentNode.namespaceURI!=this.namespaces.gml||!this.regExes.featureMember.test(a.parentNode.nodeName))||
(this.featureType=a.nodeName.split(":").pop(),this.setNamespace("feature",a.namespaceURI),this.featureNS=a.namespaceURI,this.autoConfig=!0);return OpenLayers.Format.XML.prototype.readNode.apply(this,[a,b])},readers:{gml:{_inherit:function(a,b,c){},featureMember:function(a,b){this.readChildNodes(a,b)},featureMembers:function(a,b){this.readChildNodes(a,b)},name:function(a,b){b.name=this.getChildValue(a)},boundedBy:function(a,b){var c={};this.readChildNodes(a,c);c.components&&0<c.components.length&&
(b.bounds=c.components[0])},Point:function(a,b){var c={points:[]};this.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(c.points[0])},coordinates:function(a,b){for(var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace),d,e=c.length,f=Array(e),g=0;g<e;++g)d=c[g].split(","),f[g]=this.xy?new OpenLayers.Geometry.Point(d[0],d[1],d[2]):new OpenLayers.Geometry.Point(d[1],d[0],d[2]);b.points=f},coord:function(a,
b){var c={};this.readChildNodes(a,c);b.points||(b.points=[]);b.points.push(new OpenLayers.Geometry.Point(c.x,c.y,c.z))},X:function(a,b){b.x=this.getChildValue(a)},Y:function(a,b){b.y=this.getChildValue(a)},Z:function(a,b){b.z=this.getChildValue(a)},MultiPoint:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiPoint(c.components)]},pointMember:function(a,b){this.readChildNodes(a,b)},LineString:function(a,
b){var c={};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(new OpenLayers.Geometry.LineString(c.points))},MultiLineString:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiLineString(c.components)]},lineStringMember:function(a,b){this.readChildNodes(a,b)},Polygon:function(a,b){var c={outer:null,inner:[]};this.readers.gml._inherit.apply(this,
[a,c,b]);this.readChildNodes(a,c);c.inner.unshift(c.outer);b.components||(b.components=[]);b.components.push(new OpenLayers.Geometry.Polygon(c.inner))},LinearRing:function(a,b){var c={};this.readers.gml._inherit.apply(this,[a,c]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.LinearRing(c.points)]},MultiPolygon:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiPolygon(c.components)]},
polygonMember:function(a,b){this.readChildNodes(a,b)},GeometryCollection:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.Collection(c.components)]},geometryMember:function(a,b){this.readChildNodes(a,b)}},feature:{"*":function(a,b){var c,d=a.localName||a.nodeName.split(":").pop();b.features?this.singleFeatureType||-1===OpenLayers.Util.indexOf(this.featureType,d)?d===this.featureType&&(c="_typeName"):c=
"_typeName":0==a.childNodes.length||1==a.childNodes.length&&3==a.firstChild.nodeType?this.extractAttributes&&(c="_attribute"):c="_geometry";c&&this.readers.feature[c].apply(this,[a,b])},_typeName:function(a,b){var c={components:[],attributes:{}};this.readChildNodes(a,c);c.name&&(c.attributes.name=c.name);var d=new OpenLayers.Feature.Vector(c.components[0],c.attributes);this.singleFeatureType||(d.type=a.nodeName.split(":").pop(),d.namespace=a.namespaceURI);var e=a.getAttribute("fid")||this.getAttributeNS(a,
this.namespaces.gml,"id");e&&(d.fid=e);this.internalProjection&&(this.externalProjection&&d.geometry)&&d.geometry.transform(this.externalProjection,this.internalProjection);c.bounds&&(d.bounds=c.bounds);b.features.push(d)},_geometry:function(a,b){this.geometryName||(this.geometryName=a.nodeName.split(":").pop());this.readChildNodes(a,b)},_attribute:function(a,b){var c=a.localName||a.nodeName.split(":").pop(),d=this.getChildValue(a);b.attributes[c]=d}},wfs:{FeatureCollection:function(a,b){this.readChildNodes(a,
b)}}},write:function(a){var b;b=OpenLayers.Util.isArray(a)?"featureMembers":"featureMember";a=this.writeNode("gml:"+b,a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:{featureMember:function(a){var b=this.createElementNSPlus("gml:featureMember");this.writeNode("feature:_typeName",a,b);return b},MultiPoint:function(a){var b=this.createElementNSPlus("gml:MultiPoint");a=a.components||[a];
for(var c=0,d=a.length;c<d;++c)this.writeNode("pointMember",a[c],b);return b},pointMember:function(a){var b=this.createElementNSPlus("gml:pointMember");this.writeNode("Point",a,b);return b},MultiLineString:function(a){var b=this.createElementNSPlus("gml:MultiLineString");a=a.components||[a];for(var c=0,d=a.length;c<d;++c)this.writeNode("lineStringMember",a[c],b);return b},lineStringMember:function(a){var b=this.createElementNSPlus("gml:lineStringMember");this.writeNode("LineString",a,b);return b},
MultiPolygon:function(a){var b=this.createElementNSPlus("gml:MultiPolygon");a=a.components||[a];for(var c=0,d=a.length;c<d;++c)this.writeNode("polygonMember",a[c],b);return b},polygonMember:function(a){var b=this.createElementNSPlus("gml:polygonMember");this.writeNode("Polygon",a,b);return b},GeometryCollection:function(a){for(var b=this.createElementNSPlus("gml:GeometryCollection"),c=0,d=a.components.length;c<d;++c)this.writeNode("geometryMember",a.components[c],b);return b},geometryMember:function(a){var b=
this.createElementNSPlus("gml:geometryMember");a=this.writeNode("feature:_geometry",a);b.appendChild(a.firstChild);return b}},feature:{_typeName:function(a){var b=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:a.fid}});a.geometry&&this.writeNode("feature:_geometry",a.geometry,b);for(var c in a.attributes){var d=a.attributes[c];null!=d&&this.writeNode("feature:_attribute",{name:c,value:d},b)}return b},_geometry:function(a){this.externalProjection&&this.internalProjection&&(a=
a.clone().transform(this.internalProjection,this.externalProjection));var b=this.createElementNSPlus("feature:"+this.geometryName);a=this.writeNode("gml:"+this.geometryTypes[a.CLASS_NAME],a,b);this.srsName&&a.setAttribute("srsName",this.srsName);return b},_attribute:function(a){return this.createElementNSPlus("feature:"+a.name,{value:a.value})}},wfs:{FeatureCollection:function(a){for(var b=this.createElementNSPlus("wfs:FeatureCollection"),c=0,d=a.length;c<d;++c)this.writeNode("gml:featureMember",
a[c],b);return b}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"});OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:!1,multiCurve:!0,surface:!1,multiSurface:!0,initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({_inherit:function(a,b,c){if(a=parseInt(a.getAttribute("srsDimension"),10)||c&&c.srsDimension)b.srsDimension=a},featureMembers:function(a,
b){this.readChildNodes(a,b)},Curve:function(a,b){var c={points:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(new OpenLayers.Geometry.LineString(c.points))},segments:function(a,b){this.readChildNodes(a,b)},LineStringSegment:function(a,b){var c={};this.readChildNodes(a,c);c.points&&Array.prototype.push.apply(b.points,c.points)},pos:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace),
c=this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2]);b.points=[c]},posList:function(a,b){for(var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace),d=b.srsDimension||parseInt(a.getAttribute("srsDimension")||a.getAttribute("dimension"),10)||2,e,f,g,h=Array(c.length/d),k=0,l=c.length;k<l;k+=d)e=c[k],f=c[k+1],g=2==d?void 0:c[k+2],h[k/d]=this.xy?new OpenLayers.Geometry.Point(e,f,g):new OpenLayers.Geometry.Point(f,
e,g);b.points=h},Surface:function(a,b){this.readChildNodes(a,b)},patches:function(a,b){this.readChildNodes(a,b)},PolygonPatch:function(a,b){this.readers.gml.Polygon.apply(this,[a,b])},exterior:function(a,b){var c={};this.readChildNodes(a,c);b.outer=c.components[0]},interior:function(a,b){var c={};this.readChildNodes(a,c);b.inner.push(c.components[0])},MultiCurve:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);0<c.components.length&&(b.components=
[new OpenLayers.Geometry.MultiLineString(c.components)])},curveMember:function(a,b){this.readChildNodes(a,b)},MultiSurface:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);0<c.components.length&&(b.components=[new OpenLayers.Geometry.MultiPolygon(c.components)])},surfaceMember:function(a,b){this.readChildNodes(a,b)},surfaceMembers:function(a,b){this.readChildNodes(a,b)},pointMembers:function(a,b){this.readChildNodes(a,b)},lineStringMembers:function(a,
b){this.readChildNodes(a,b)},polygonMembers:function(a,b){this.readChildNodes(a,b)},geometryMembers:function(a,b){this.readChildNodes(a,b)},Envelope:function(a,b){var c={points:Array(2)};this.readChildNodes(a,c);b.components||(b.components=[]);var d=c.points[0],c=c.points[1];b.components.push(new OpenLayers.Bounds(d.x,d.y,c.x,c.y))},lowerCorner:function(a,b){var c={};this.readers.gml.pos.apply(this,[a,c]);b.points[0]=c.points[0]},upperCorner:function(a,b){var c={};this.readers.gml.pos.apply(this,
[a,c]);b.points[1]=c.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){var b;b=OpenLayers.Util.isArray(a)?"featureMembers":"featureMember";a=this.writeNode("gml:"+b,a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(a){for(var b=
this.createElementNSPlus("gml:featureMembers"),c=0,d=a.length;c<d;++c)this.writeNode("feature:_typeName",a[c],b);return b},Point:function(a){var b=this.createElementNSPlus("gml:Point");this.writeNode("pos",a,b);return b},pos:function(a){return this.createElementNSPlus("gml:pos",{value:this.xy?a.x+" "+a.y:a.y+" "+a.x})},LineString:function(a){var b=this.createElementNSPlus("gml:LineString");this.writeNode("posList",a.components,b);return b},Curve:function(a){var b=this.createElementNSPlus("gml:Curve");
this.writeNode("segments",a,b);return b},segments:function(a){var b=this.createElementNSPlus("gml:segments");this.writeNode("LineStringSegment",a,b);return b},LineStringSegment:function(a){var b=this.createElementNSPlus("gml:LineStringSegment");this.writeNode("posList",a.components,b);return b},posList:function(a){for(var b=a.length,c=Array(b),d,e=0;e<b;++e)d=a[e],c[e]=this.xy?d.x+" "+d.y:d.y+" "+d.x;return this.createElementNSPlus("gml:posList",{value:c.join(" ")})},Surface:function(a){var b=this.createElementNSPlus("gml:Surface");
this.writeNode("patches",a,b);return b},patches:function(a){var b=this.createElementNSPlus("gml:patches");this.writeNode("PolygonPatch",a,b);return b},PolygonPatch:function(a){var b=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",a.components[0],b);for(var c=1,d=a.components.length;c<d;++c)this.writeNode("interior",a.components[c],b);return b},Polygon:function(a){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",a.components[0],
b);for(var c=1,d=a.components.length;c<d;++c)this.writeNode("interior",a.components[c],b);return b},exterior:function(a){var b=this.createElementNSPlus("gml:exterior");this.writeNode("LinearRing",a,b);return b},interior:function(a){var b=this.createElementNSPlus("gml:interior");this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("posList",a.components,b);return b},MultiCurve:function(a){var b=this.createElementNSPlus("gml:MultiCurve");
a=a.components||[a];for(var c=0,d=a.length;c<d;++c)this.writeNode("curveMember",a[c],b);return b},curveMember:function(a){var b=this.createElementNSPlus("gml:curveMember");this.curve?this.writeNode("Curve",a,b):this.writeNode("LineString",a,b);return b},MultiSurface:function(a){var b=this.createElementNSPlus("gml:MultiSurface");a=a.components||[a];for(var c=0,d=a.length;c<d;++c)this.writeNode("surfaceMember",a[c],b);return b},surfaceMember:function(a){var b=this.createElementNSPlus("gml:surfaceMember");
this.surface?this.writeNode("Surface",a,b):this.writeNode("Polygon",a,b);return b},Envelope:function(a){var b=this.createElementNSPlus("gml:Envelope");this.writeNode("lowerCorner",a,b);this.writeNode("upperCorner",a,b);this.srsName&&b.setAttribute("srsName",this.srsName);return b},lowerCorner:function(a){return this.createElementNSPlus("gml:lowerCorner",{value:this.xy?a.left+" "+a.bottom:a.bottom+" "+a.left})},upperCorner:function(a){return this.createElementNSPlus("gml:upperCorner",{value:this.xy?
a.right+" "+a.top:a.top+" "+a.right})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":!0===this.curve?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":!1===this.multiCurve?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":!0===
this.surface?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":!1===this.multiSurface?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"});OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,b){var c=a.getAttribute("matchCase"),c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!("false"===c||"0"===c)});this.readChildNodes(a,
c);b.filters.push(c)},PropertyIsNotEqualTo:function(a,b){var c=a.getAttribute("matchCase"),c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!("false"===c||"0"===c)});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLike:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,c);var d=a.getAttribute("wildCard"),e=a.getAttribute("singleChar"),f=a.getAttribute("escapeChar");c.value2regex(d,e,
f);b.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo",
{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{matchCase:a.matchCase,wildCard:"*",singleChar:".",escapeChar:"!"}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var b=this.createElementNSPlus("ogc:BBOX");a.property&&this.writeNode("PropertyName",a,b);var c=this.writeNode("gml:Envelope",
a.value);a.projection&&c.setAttribute("srsName",a.projection);b.appendChild(c);return b},SortBy:function(a){for(var b=this.createElementNSPlus("ogc:SortBy"),c=0,d=a.length;c<d;c++)this.writeNode("ogc:SortProperty",a[c],b);return b},SortProperty:function(a){var b=this.createElementNSPlus("ogc:SortProperty");this.writeNode("ogc:PropertyName",a,b);this.writeNode("ogc:SortOrder","DESC"==a.order?"DESC":"ASC",b);return b},SortOrder:function(a){return this.createElementNSPlus("ogc:SortOrder",{value:a})}},
OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature},writeSpatial:function(a,b){var c=this.createElementNSPlus("ogc:"+b);this.writeNode("PropertyName",a,c);if(a.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",a.value,c);else{var d;d=a.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",a.value).firstChild:this.writeNode("gml:Envelope",a.value);a.projection&&
d.setAttribute("srsName",a.projection);c.appendChild(d)}return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"});OpenLayers.Format.OWSCommon=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",getVersion:function(a,b){var c=this.version;if(!c){var d=a.getAttribute("xmlns:ows");d&&"1.1"===d.substring(d.lastIndexOf("/")+1)&&(c="1.1.0");c||(c=this.defaultVersion)}return c},CLASS_NAME:"OpenLayers.Format.OWSCommon"});OpenLayers.Format.OWSCommon.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a,b){OpenLayers.Util.applyDefaults(b,this.options);var c={};this.readChildNodes(a,c);return c},readers:{ows:{Exception:function(a,b){var c={code:a.getAttribute("exceptionCode"),locator:a.getAttribute("locator"),texts:[]};b.exceptions.push(c);this.readChildNodes(a,c)},ExceptionText:function(a,b){var c=this.getChildValue(a);b.texts.push(c)},
ServiceIdentification:function(a,b){b.serviceIdentification={};this.readChildNodes(a,b.serviceIdentification)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},Keywords:function(a,b){b.keywords={};this.readChildNodes(a,b.keywords)},Keyword:function(a,b){b[this.getChildValue(a)]=!0},ServiceType:function(a,b){b.serviceType={codeSpace:a.getAttribute("codeSpace"),value:this.getChildValue(a)}},ServiceTypeVersion:function(a,b){b.serviceTypeVersion=
this.getChildValue(a)},Fees:function(a,b){b.fees=this.getChildValue(a)},AccessConstraints:function(a,b){b.accessConstraints=this.getChildValue(a)},ServiceProvider:function(a,b){b.serviceProvider={};this.readChildNodes(a,b.serviceProvider)},ProviderName:function(a,b){b.providerName=this.getChildValue(a)},ProviderSite:function(a,b){b.providerSite=this.getAttributeNS(a,this.namespaces.xlink,"href")},ServiceContact:function(a,b){b.serviceContact={};this.readChildNodes(a,b.serviceContact)},IndividualName:function(a,
b){b.individualName=this.getChildValue(a)},PositionName:function(a,b){b.positionName=this.getChildValue(a)},ContactInfo:function(a,b){b.contactInfo={};this.readChildNodes(a,b.contactInfo)},Phone:function(a,b){b.phone={};this.readChildNodes(a,b.phone)},Voice:function(a,b){b.voice=this.getChildValue(a)},Address:function(a,b){b.address={};this.readChildNodes(a,b.address)},DeliveryPoint:function(a,b){b.deliveryPoint=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},AdministrativeArea:function(a,
b){b.administrativeArea=this.getChildValue(a)},PostalCode:function(a,b){b.postalCode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ElectronicMailAddress:function(a,b){b.electronicMailAddress=this.getChildValue(a)},Role:function(a,b){b.role=this.getChildValue(a)},OperationsMetadata:function(a,b){b.operationsMetadata={};this.readChildNodes(a,b.operationsMetadata)},Operation:function(a,b){var c=a.getAttribute("name");b[c]={};this.readChildNodes(a,b[c])},DCP:function(a,
b){b.dcp={};this.readChildNodes(a,b.dcp)},HTTP:function(a,b){b.http={};this.readChildNodes(a,b.http)},Get:function(a,b){b.get||(b.get=[]);var c={url:this.getAttributeNS(a,this.namespaces.xlink,"href")};this.readChildNodes(a,c);b.get.push(c)},Post:function(a,b){b.post||(b.post=[]);var c={url:this.getAttributeNS(a,this.namespaces.xlink,"href")};this.readChildNodes(a,c);b.post.push(c)},Parameter:function(a,b){b.parameters||(b.parameters={});var c=a.getAttribute("name");b.parameters[c]={};this.readChildNodes(a,
b.parameters[c])},Constraint:function(a,b){b.constraints||(b.constraints={});var c=a.getAttribute("name");b.constraints[c]={};this.readChildNodes(a,b.constraints[c])},Value:function(a,b){b[this.getChildValue(a)]=!0},OutputFormat:function(a,b){b.formats.push({value:this.getChildValue(a)});this.readChildNodes(a,b)},WGS84BoundingBox:function(a,b){var c={};c.crs=a.getAttribute("crs");b.BoundingBox?b.BoundingBox.push(c):(b.projection=c.crs,c=b);this.readChildNodes(a,c)},BoundingBox:function(a,b){this.readers.ows.WGS84BoundingBox.apply(this,
[a,b])},LowerCorner:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace);b.left=c[0];b.bottom=c[1]},UpperCorner:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace);b.right=c[0];b.top=c[1];b.bounds=new OpenLayers.Bounds(b.left,b.bottom,b.right,b.top);delete b.left;delete b.bottom;delete b.right;delete b.top},
Language:function(a,b){b.language=this.getChildValue(a)}}},writers:{ows:{BoundingBox:function(a,b){var c=this.createElementNSPlus(b||"ows:BoundingBox",{attributes:{crs:a.projection}});this.writeNode("ows:LowerCorner",a,c);this.writeNode("ows:UpperCorner",a,c);return c},LowerCorner:function(a){return this.createElementNSPlus("ows:LowerCorner",{value:a.bounds.left+" "+a.bounds.bottom})},UpperCorner:function(a){return this.createElementNSPlus("ows:UpperCorner",{value:a.bounds.right+" "+a.bounds.top})},
Identifier:function(a){return this.createElementNSPlus("ows:Identifier",{value:a})},Title:function(a){return this.createElementNSPlus("ows:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("ows:Abstract",{value:a})},OutputFormat:function(a){return this.createElementNSPlus("ows:OutputFormat",{value:a})}}},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1"});OpenLayers.Format.OWSCommon.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(a,b){b.success=!1;b.exceptionReport={version:a.getAttribute("version"),language:a.getAttribute("language"),exceptions:[]};this.readChildNodes(a,b.exceptionReport)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Format.OWSCommon.v1.prototype.writers.ows},
CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_0_0"});OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readNode:function(a,b,c){return OpenLayers.Format.GML.v3.prototype.readNode.apply(this,arguments)},readers:{wfs:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,
b){b.numberOfFeatures=parseInt(a.getAttribute("numberOfFeatures"));OpenLayers.Format.WFST.v1.prototype.readers.wfs.FeatureCollection.apply(this,arguments)},TransactionResponse:function(a,b){b.insertIds=[];b.success=!1;this.readChildNodes(a,b)},TransactionSummary:function(a,b){b.success=!0},InsertResults:function(a,b){this.readChildNodes(a,b)},Feature:function(a,b){var c={fids:[]};this.readChildNodes(a,c);b.insertIds.push(c.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,
feature:OpenLayers.Format.GML.v3.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc,ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows},writers:{wfs:OpenLayers.Util.applyDefaults({GetFeature:function(a){var b=OpenLayers.Format.WFST.v1.prototype.writers.wfs.GetFeature.apply(this,arguments);a&&this.setAttributes(b,{resultType:a.resultType,startIndex:a.startIndex,count:a.count});return b},Query:function(a){a=OpenLayers.Util.extend({featureNS:this.featureNS,
featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},a);var b=a.featurePrefix,c=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(b?b+":":"")+a.featureType,srsName:a.srsName}});a.featureNS&&c.setAttribute("xmlns:"+b,a.featureNS);if(a.propertyNames)for(var b=0,d=a.propertyNames.length;b<d;b++)this.writeNode("wfs:PropertyName",{property:a.propertyNames[b]},c);a.filter&&(OpenLayers.Format.WFST.v1_1_0.prototype.setFilterProperty.call(this,a.filter),this.writeNode("ogc:Filter",
a.filter,c));return c},PropertyName:function(a){return this.createElementNSPlus("wfs:PropertyName",{value:a.property})}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"});OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(a){a=a||{};OpenLayers.Util.extend(this,a);this.options=a},mergeWithDefaultFilter:function(a){return a&&this.defaultFilter?new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,a]}):a||this.defaultFilter||void 0},destroy:function(){this.format=this.options=null},read:function(a){a=a||{};a.filter=this.mergeWithDefaultFilter(a.filter)},create:function(){},
update:function(){},"delete":function(){},commit:function(){},abort:function(a){},createCallback:function(a,b,c){return OpenLayers.Function.bind(function(){a.apply(this,[b,c])},this)},CLASS_NAME:"OpenLayers.Protocol"});OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(a){OpenLayers.Util.extend(this,a)},success:function(){return 0<this.code},CLASS_NAME:"OpenLayers.Protocol.Response"});
OpenLayers.Protocol.Response.SUCCESS=1;OpenLayers.Protocol.Response.FAILURE=0;OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return!(!window.JSON||"function"!=typeof JSON.parse||"function"!=typeof JSON.stringify)}(),read:function(a,b){var c;if(this.nativeJSON)c=JSON.parse(a,b);else try{if(/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&&(c=eval("("+a+")"),"function"===
typeof b)){var d=function(a,c){if(c&&"object"===typeof c)for(var e in c)c.hasOwnProperty(e)&&(c[e]=d(e,c[e]));return b(a,c)};c=d("",c)}}catch(e){}this.keepData&&(this.data=c);return c},write:function(a,b){this.pretty=!!b;var c=null,d=typeof a;if(this.serialize[d])try{c=!this.pretty&&this.nativeJSON?JSON.stringify(a):this.serialize[d].apply(this,[a])}catch(e){OpenLayers.Console.error("Trouble serializing: "+e)}return c},writeIndent:function(){var a=[];if(this.pretty)for(var b=0;b<this.level;++b)a.push(this.indent);
return a.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(a){if(null==a)return"null";if(a.constructor==Date)return this.serialize.date.apply(this,[a]);if(a.constructor==Array)return this.serialize.array.apply(this,[a]);var b=["{"];this.level+=1;var c,d,e,f=!1;for(c in a)a.hasOwnProperty(c)&&(d=OpenLayers.Format.JSON.prototype.write.apply(this,[c,this.pretty]),e=OpenLayers.Format.JSON.prototype.write.apply(this,
[a[c],this.pretty]),null!=d&&null!=e&&(f&&b.push(","),b.push(this.writeNewline(),this.writeIndent(),d,":",this.writeSpace(),e),f=!0));this.level-=1;b.push(this.writeNewline(),this.writeIndent(),"}");return b.join("")},array:function(a){var b,c=["["];this.level+=1;for(var d=0,e=a.length;d<e;++d)b=OpenLayers.Format.JSON.prototype.write.apply(this,[a[d],this.pretty]),null!=b&&(0<d&&c.push(","),c.push(this.writeNewline(),this.writeIndent(),b));this.level-=1;c.push(this.writeNewline(),this.writeIndent(),
"]");return c.join("")},string:function(a){var b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(a)?'"'+a.replace(/([\x00-\x1f\\"])/g,function(a,d){var e=b[d];if(e)return e;e=d.charCodeAt();return"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16)})+'"':'"'+a+'"'},number:function(a){return isFinite(a)?String(a):"null"},"boolean":function(a){return String(a)},date:function(a){function b(a){return 10>a?"0"+a:a}return'"'+a.getFullYear()+
"-"+b(a.getMonth()+1)+"-"+b(a.getDate())+"T"+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"});OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,read:function(a,b,c){b=b?b:"FeatureCollection";var d=null,e=null,e="string"==typeof a?OpenLayers.Format.JSON.prototype.read.apply(this,[a,c]):a;if(!e)OpenLayers.Console.error("Bad JSON: "+a);else if("string"!=typeof e.type)OpenLayers.Console.error("Bad GeoJSON - no type: "+a);else if(this.isValidType(e,b))switch(b){case "Geometry":try{d=this.parseGeometry(e)}catch(f){OpenLayers.Console.error(f)}break;case "Feature":try{d=
this.parseFeature(e),d.type="Feature"}catch(g){OpenLayers.Console.error(g)}break;case "FeatureCollection":switch(d=[],e.type){case "Feature":try{d.push(this.parseFeature(e))}catch(h){d=null,OpenLayers.Console.error(h)}break;case "FeatureCollection":a=0;for(b=e.features.length;a<b;++a)try{d.push(this.parseFeature(e.features[a]))}catch(k){d=null,OpenLayers.Console.error(k)}break;default:try{var l=this.parseGeometry(e);d.push(new OpenLayers.Feature.Vector(l))}catch(m){d=null,OpenLayers.Console.error(m)}}}return d},
isValidType:function(a,b){var c=!1;switch(b){case "Geometry":-1==OpenLayers.Util.indexOf("Point MultiPoint LineString MultiLineString Polygon MultiPolygon Box GeometryCollection".split(" "),a.type)?OpenLayers.Console.error("Unsupported geometry type: "+a.type):c=!0;break;case "FeatureCollection":c=!0;break;default:a.type==b?c=!0:OpenLayers.Console.error("Cannot convert types from "+a.type+" to "+b)}return c},parseFeature:function(a){var b,c,d;c=a.properties?a.properties:{};d=a.geometry&&a.geometry.bbox||
a.bbox;try{b=this.parseGeometry(a.geometry)}catch(e){throw e;}b=new OpenLayers.Feature.Vector(b,c);d&&(b.bounds=OpenLayers.Bounds.fromArray(d));a.id&&(b.fid=a.id);return b},parseGeometry:function(a){if(null==a)return null;var b,c=!1;if("GeometryCollection"==a.type){if(!OpenLayers.Util.isArray(a.geometries))throw"GeometryCollection must have geometries array: "+a;b=a.geometries.length;for(var c=Array(b),d=0;d<b;++d)c[d]=this.parseGeometry.apply(this,[a.geometries[d]]);b=new OpenLayers.Geometry.Collection(c);
c=!0}else{if(!OpenLayers.Util.isArray(a.coordinates))throw"Geometry must have coordinates array: "+a;if(!this.parseCoords[a.type.toLowerCase()])throw"Unsupported geometry type: "+a.type;try{b=this.parseCoords[a.type.toLowerCase()].apply(this,[a.coordinates])}catch(e){throw e;}}this.internalProjection&&(this.externalProjection&&!c)&&b.transform(this.externalProjection,this.internalProjection);return b},parseCoords:{point:function(a){if(!1==this.ignoreExtraDims&&2!=a.length)throw"Only 2D points are supported: "+
a;return new OpenLayers.Geometry.Point(a[0],a[1])},multipoint:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiPoint(b)},linestring:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.LineString(b)},multilinestring:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=
this.parseCoords.linestring.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiLineString(b)},polygon:function(a){for(var b=[],c,d,e=0,f=a.length;e<f;++e){try{d=this.parseCoords.linestring.apply(this,[a[e]])}catch(g){throw g;}c=new OpenLayers.Geometry.LinearRing(d.components);b.push(c)}return new OpenLayers.Geometry.Polygon(b)},multipolygon:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.polygon.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiPolygon(b)},
box:function(a){if(2!=a.length)throw"GeoJSON box coordinates must have 2 elements";return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(a[0][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[0][1])])])}},write:function(a,b){var c={type:null};if(OpenLayers.Util.isArray(a)){c.type="FeatureCollection";var d=
a.length;c.features=Array(d);for(var e=0;e<d;++e){var f=a[e];if(!f instanceof OpenLayers.Feature.Vector)throw"FeatureCollection only supports collections of features: "+f;c.features[e]=this.extract.feature.apply(this,[f])}}else 0==a.CLASS_NAME.indexOf("OpenLayers.Geometry")?c=this.extract.geometry.apply(this,[a]):a instanceof OpenLayers.Feature.Vector&&(c=this.extract.feature.apply(this,[a]),a.layer&&a.layer.projection&&(c.crs=this.createCRSObject(a)));return OpenLayers.Format.JSON.prototype.write.apply(this,
[c,b])},createCRSObject:function(a){a=a.layer.projection.toString();var b={};a.match(/epsg:/i)&&(a=parseInt(a.substring(a.indexOf(":")+1)),b=4326==a?{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+a}});return b},extract:{feature:function(a){var b=this.extract.geometry.apply(this,[a.geometry]),b={type:"Feature",properties:a.attributes,geometry:b};null!=a.fid&&(b.id=a.fid);return b},geometry:function(a){if(null==a)return null;this.internalProjection&&
this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME.split(".")[2];a=this.extract[b.toLowerCase()].apply(this,[a]);return"Collection"==b?{type:"GeometryCollection",geometries:a}:{type:b,coordinates:a}},point:function(a){return[a.x,a.y]},multipoint:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},linestring:function(a){for(var b=[],c=0,d=a.components.length;c<
d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},multilinestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.linestring.apply(this,[a.components[c]]));return b},polygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.linestring.apply(this,[a.components[c]]));return b},multipolygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.polygon.apply(this,[a.components[c]]));return b},collection:function(a){for(var b=
a.components.length,c=Array(b),d=0;d<b;++d)c[d]=this.extract.geometry.apply(this,[a.components[d]]);return c}},CLASS_NAME:"OpenLayers.Format.GeoJSON"});OpenLayers.Protocol.Script=OpenLayers.Class(OpenLayers.Protocol,{url:null,params:null,callback:null,callbackTemplate:"OpenLayers.Protocol.Script.registry.${id}",callbackKey:"callback",callbackPrefix:"",scope:null,format:null,pendingRequests:null,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.pendingRequests={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);this.format||(this.format=new OpenLayers.Format.GeoJSON);if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var b=
new OpenLayers.Format.QueryStringFilter({srsInBBOX:this.srsInBBOX});this.filterToParams=function(a,d){return b.write(a,d)}}},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.applyDefaults(a,this.options);a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);a.filter&&this.filterToParams&&(a.params=this.filterToParams(a.filter,a.params));var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.createRequest(a.url,a.params,OpenLayers.Function.bind(function(c){b.data=
c;this.handleRead(b,a)},this));b.priv=c;return b},createRequest:function(a,b,c){c=OpenLayers.Protocol.Script.register(c);var d=OpenLayers.String.format(this.callbackTemplate,{id:c});b=OpenLayers.Util.extend({},b);b[this.callbackKey]=this.callbackPrefix+d;a=OpenLayers.Util.urlAppend(a,OpenLayers.Util.getParameterString(b));b=document.createElement("script");b.type="text/javascript";b.src=a;b.id="OpenLayers_Protocol_Script_"+c;this.pendingRequests[b.id]=b;document.getElementsByTagName("head")[0].appendChild(b);
return b},destroyRequest:function(a){OpenLayers.Protocol.Script.unregister(a.id.split("_").pop());delete this.pendingRequests[a.id];a.parentNode&&a.parentNode.removeChild(a)},handleRead:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){b.callback&&(a.data?(a.features=this.parseFeatures(a.data),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,this.destroyRequest(a.priv),b.callback.call(b.scope,a))},parseFeatures:function(a){return this.format.read(a)},
abort:function(a){if(a)this.destroyRequest(a.priv);else for(var b in this.pendingRequests)this.destroyRequest(this.pendingRequests[b])},destroy:function(){this.abort();delete this.params;delete this.format;OpenLayers.Protocol.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Protocol.Script"});(function(){var a=OpenLayers.Protocol.Script,b=0;a.registry={};a.register=function(c){var d="c"+ ++b;a.registry[d]=function(){c.apply(this,arguments)};return d};a.unregister=function(b){delete a.registry[b]}})();OpenLayers.Format.EncodedPolyline=OpenLayers.Class(OpenLayers.Format,{geometryType:"linestring",initialize:function(a){OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){var b;if("linestring"==this.geometryType)b=OpenLayers.Geometry.LineString;else if("linearring"==this.geometryType)b=OpenLayers.Geometry.LinearRing;else if("multipoint"==this.geometryType)b=OpenLayers.Geometry.MultiPoint;else if("point"!=this.geometryType&&"polygon"!=this.geometryType)return null;a=this.decodeDeltas(a,
2);for(var c=a.length,d=[],e=0;e+1<c;){var f=a[e++],g=a[e++];d.push(new OpenLayers.Geometry.Point(g,f))}return"point"==this.geometryType?new OpenLayers.Feature.Vector(d[0]):"polygon"==this.geometryType?new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)])):new OpenLayers.Feature.Vector(new b(d))},decode:function(a,b,c){a=this.decodeDeltas(a,b,c||1E5);c=a.length;for(var d=[],e=0;e+(b-1)<c;){for(var f=[],g=0;g<b;++g)f.push(a[e++]);d.push(f)}return d},
write:function(a){a=(a.constructor==Array?a[0]:a).geometry;var b=a.CLASS_NAME.split(".")[2].toLowerCase();if("point"==b)a=Array(a);else if("linestring"==b||"linearring"==b||"multipoint"==b)a=a.components;else if("polygon"==b)a=a.components[0].components;else return null;for(var b=[],c=a.length,d=0;d<c;++d){var e=a[d];b.push(e.y);b.push(e.x)}return this.encodeDeltas(b,2)},encode:function(a,b,c){c=c||1E5;for(var d=[],e=a.length,f=0;f<e;++f)for(var g=a[f],h=0;h<b;++h)d.push(g[h]);return this.encodeDeltas(d,
b,c)},encodeDeltas:function(a,b,c){var d,e=Array(b);for(d=0;d<b;++d)e[d]=0;for(var f=a.length,g=0;g<f;)for(d=0;d<b;++d,++g){var h=a[g],k=h-e[d];e[d]=h;a[g]=k}return this.encodeFloats(a,c||1E5)},decodeDeltas:function(a,b,c){var d,e=Array(b);for(d=0;d<b;++d)e[d]=0;a=this.decodeFloats(a,c||1E5);c=a.length;for(var f=0;f<c;)for(d=0;d<b;++d,++f)e[d]+=a[f],a[f]=e[d];return a},encodeFloats:function(a,b){for(var c=b||1E5,d=a.length,e=0;e<d;++e)a[e]=Math.round(a[e]*c);return this.encodeSignedIntegers(a)},decodeFloats:function(a,
b){for(var c=b||1E5,d=this.decodeSignedIntegers(a),e=d.length,f=0;f<e;++f)d[f]/=c;return d},encodeSignedIntegers:function(a){for(var b=a.length,c=0;c<b;++c){var d=a[c],e=d<<1;0>d&&(e=~e);a[c]=e}return this.encodeUnsignedIntegers(a)},decodeSignedIntegers:function(a){a=this.decodeUnsignedIntegers(a);for(var b=a.length,c=0;c<b;++c){var d=a[c];a[c]=d&1?~(d>>1):d>>1}return a},encodeUnsignedIntegers:function(a){for(var b="",c=a.length,d=0;d<c;++d)b+=this.encodeUnsignedInteger(a[d]);return b},decodeUnsignedIntegers:function(a){for(var b=
[],c=0,d=0,e=a.length,f=0;f<e;++f){var g=a.charCodeAt(f)-63,c=c|(g&31)<<d;32>g?(b.push(c),d=c=0):d+=5}return b},encodeFloat:function(a,b){a=Math.round(a*(b||1E5));return this.encodeSignedInteger(a)},decodeFloat:function(a,b){return this.decodeSignedInteger(a)/(b||1E5)},encodeSignedInteger:function(a){var b=a<<1;0>a&&(b=~b);return this.encodeUnsignedInteger(b)},decodeSignedInteger:function(a){a=this.decodeUnsignedInteger(a);return a&1?~(a>>1):a>>1},encodeUnsignedInteger:function(a){for(var b,c="";32<=
a;)b=(32|a&31)+63,c+=String.fromCharCode(b),a>>=5;return c+=String.fromCharCode(a+63)},decodeUnsignedInteger:function(a){for(var b=0,c=0,d=a.length,e=0;e<d;++e){var f=a.charCodeAt(e)-63,b=b|(f&31)<<c;if(32>f)break;c+=5}return b},CLASS_NAME:"OpenLayers.Format.EncodedPolyline"});OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:!0,defaultControl:null,saveState:!1,allowDepress:!1,activeState:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.controls=[];this.activeState={}},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var a,b=this.controls.length-1;0<=b;b--)a=this.controls[b],a.events&&
a.events.un({activate:this.iconOn,deactivate:this.iconOff}),a.panel_div=null;this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var a,b=0,c=this.controls.length;b<c;b++)a=this.controls[b],(a===this.defaultControl||this.saveState&&this.activeState[a.id])&&a.activate();!0===this.saveState&&(this.defaultControl=null);this.redraw();return!0}return!1},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var a,
b=0,c=this.controls.length;b<c;b++)a=this.controls[b],this.activeState[a.id]=a.deactivate();this.redraw();return!0}return!1},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick);this.addControlsToMap(this.controls);return this.div},redraw:function(){for(var a=this.div.childNodes.length-1;0<=a;a--)this.div.removeChild(this.div.childNodes[a]);
this.div.innerHTML="";if(this.active)for(var a=0,b=this.controls.length;a<b;a++)this.div.appendChild(this.controls[a].panel_div)},activateControl:function(a){if(!this.active)return!1;if(a.type==OpenLayers.Control.TYPE_BUTTON)a.trigger();else if(a.type==OpenLayers.Control.TYPE_TOGGLE)a.active?a.deactivate():a.activate();else if(this.allowDepress&&a.active)a.deactivate();else{for(var b,c=0,d=this.controls.length;c<d;c++)b=this.controls[c],b==a||b.type!==OpenLayers.Control.TYPE_TOOL&&null!=b.type||b.deactivate();
a.activate()}},addControls:function(a){OpenLayers.Util.isArray(a)||(a=[a]);this.controls=this.controls.concat(a);for(var b=0,c=a.length;b<c;b++){var d=a[b],e=this.createControlMarkup(d);OpenLayers.Element.addClass(e,d.displayClass+"ItemInactive");OpenLayers.Element.addClass(e,"olButton");""==d.title||e.title||(e.title=d.title);d.panel_div=e}this.map&&(this.addControlsToMap(a),this.redraw())},createControlMarkup:function(a){return document.createElement("div")},addControlsToMap:function(a){for(var b,
c=0,d=a.length;c<d;c++)b=a[c],!0===b.autoActivate?(b.autoActivate=!1,this.map.addControl(b),b.autoActivate=!0):(this.map.addControl(b),b.deactivate()),b.events.on({activate:this.iconOn,deactivate:this.iconOff})},iconOn:function(){var a=this.panel_div;a.className=a.className.replace(RegExp("\\b("+this.displayClass+"Item)Inactive\\b"),"$1Active")},iconOff:function(){var a=this.panel_div;a.className=a.className.replace(RegExp("\\b("+this.displayClass+"Item)Active\\b"),"$1Inactive")},onButtonClick:function(a){var b=
this.controls;a=a.buttonElement;for(var c=b.length-1;0<=c;--c)if(b[c].panel_div===a){this.activateControl(b[c]);break}},getControlsBy:function(a,b){var c="function"==typeof b.test;return OpenLayers.Array.filter(this.controls,function(d){return d[a]==b||c&&b.test(d[a])})},getControlsByName:function(a){return this.getControlsBy("name",a)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},CLASS_NAME:"OpenLayers.Control.Panel"});OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"OpenLayers.Control.Button"});OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){this.map&&this.map.zoomIn()},CLASS_NAME:"OpenLayers.Control.ZoomIn"});OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){this.map&&this.map.zoomOut()},CLASS_NAME:"OpenLayers.Control.ZoomOut"});OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){this.map&&this.map.zoomToMaxExtent()},CLASS_NAME:"OpenLayers.Control.ZoomToMaxExtent"});OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new OpenLayers.Control.ZoomIn,new OpenLayers.Control.ZoomToMaxExtent,new OpenLayers.Control.ZoomOut])},CLASS_NAME:"OpenLayers.Control.ZoomPanel"});OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(a,b,c,d){OpenLayers.Layer.prototype.initialize.apply(this,[a,d]);this.url=b;this.params||(this.params=OpenLayers.Util.extend({},c))},destroy:function(){this.params=this.url=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions()));
return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setUrl:function(a){this.url=a},mergeNewParams:function(a){this.params=OpenLayers.Util.extend(this.params,a);a=this.redraw();null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"});return a},redraw:function(a){return a?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(a,b){for(var c=1,d=0,e=a.length;d<e;d++)c*=a.charCodeAt(d)*this.URL_HASH_FACTOR,
c-=Math.floor(c);return b[Math.floor(c*b.length)]},getFullRequestString:function(a,b){var c=b||this.url,d=OpenLayers.Util.extend({},this.params),d=OpenLayers.Util.extend(d,a),e=OpenLayers.Util.getParameterString(d);OpenLayers.Util.isArray(c)&&(c=this.selectUrl(e,c));var e=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),f;for(f in d)f.toUpperCase()in e&&delete d[f];e=OpenLayers.Util.getParameterString(d);return OpenLayers.Util.urlAppend(c,e)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(a,b,c,d,e,f){this.layer=a;this.position=b.clone();this.setBounds(c);this.url=d;e&&(this.size=e.clone());this.id=OpenLayers.Util.createUniqueID("Tile_");OpenLayers.Util.extend(this,f);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners)},unload:function(){this.isLoading&&(this.isLoading=
!1,this.events.triggerEvent("unload"))},destroy:function(){this.position=this.size=this.bounds=this.layer=null;this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy();this.events=this.eventListeners=null},draw:function(a){a||this.clear();var b=this.shouldDraw();b&&(!a&&!1===this.events.triggerEvent("beforedraw"))&&(b=null);return b},shouldDraw:function(){var a=!1,b=this.layer.maxExtent;if(b){var c=this.layer.map,c=c.baseLayer.wrapDateLine&&c.getMaxExtent();this.bounds.intersectsBounds(b,
{inclusive:!1,worldBounds:c})&&(a=!0)}return a||this.layer.displayOutsideMaxExtent},setBounds:function(a){a=a.clone();if(this.layer.map.baseLayer.wrapDateLine){var b=this.layer.map.getMaxExtent(),c=this.layer.map.getResolution();a=a.wrapDateLine(b,{leftTolerance:c,rightTolerance:c})}this.bounds=a},moveTo:function(a,b,c){null==c&&(c=!0);this.setBounds(a);this.position=b.clone();c&&this.draw()},clear:function(a){},CLASS_NAME:"OpenLayers.Tile"});OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(a,b,c,d,e,f){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=d;this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack();if(null!=this.maxGetUrlLength||this.layer.gutter||this.layerAlphaHack)this.frame=document.createElement("div"),this.frame.style.position=
"absolute",this.frame.style.overflow="hidden";null!=this.maxGetUrlLength&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){this.imgDiv&&(this.clear(),this.frame=this.imgDiv=null);this.asyncRequestId=null;OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);a?(this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.isLoading?this._loadEvent=
"reload":(this.isLoading=!0,this._loadEvent="loadstart"),this.renderTile(),this.positionTile()):!1===a&&this.unload();return a},renderTile:function(){if(this.layer.async){var a=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(b){a==this.asyncRequestId&&(this.url=b,this.initImage())},this)}else this.url=this.layer.getURL(this.bounds),this.initImage()},positionTile:function(){var a=this.getTile().style,b=this.frame?this.size:this.layer.getImageSize(this.bounds),
c=1;this.layer instanceof OpenLayers.Layer.Grid&&(c=this.layer.getServerResolution()/this.layer.map.getResolution());a.left=this.position.x+"px";a.top=this.position.y+"px";a.width=Math.round(c*b.w)+"px";a.height=Math.round(c*b.h)+"px"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var a=this.imgDiv;if(a){var b=this.getTile();b.parentNode===this.layer.div&&this.layer.div.removeChild(b);this.setImgSrc();!0===this.layerAlphaHack&&(a.style.filter="");OpenLayers.Element.removeClass(a,
"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=OpenLayers.Tile.Image.IMAGE.cloneNode(!1);var a=this.imgDiv.style;if(this.frame){var b=0,c=0;this.layer.gutter&&(b=100*(this.layer.gutter/this.layer.tileSize.w),c=100*(this.layer.gutter/this.layer.tileSize.h));a.left=-b+"%";a.top=-c+"%";a.width=2*b+100+"%";a.height=2*c+100+"%"}a.visibility="hidden";a.opacity=0;1>this.layer.opacity&&(a.filter="alpha(opacity="+100*this.layer.opacity+")");a.position="absolute";
this.layerAlphaHack&&(a.paddingTop=a.height,a.height="0",a.width="100%");this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},setImage:function(a){this.imgDiv=a},initImage:function(){if(this.url||this.imgDiv){this.events.triggerEvent("beforeload");this.layer.div.appendChild(this.getTile());this.events.triggerEvent(this._loadEvent);var a=this.getImage(),b=a.getAttribute("src")||"";this.url&&OpenLayers.Util.isEquivalentUrl(b,this.url)?this._loadTimeout=window.setTimeout(OpenLayers.Function.bind(this.onImageLoad,
this),0):(this.stopLoading(),this.crossOriginKeyword&&a.removeAttribute("crossorigin"),OpenLayers.Event.observe(a,"load",OpenLayers.Function.bind(this.onImageLoad,this)),OpenLayers.Event.observe(a,"error",OpenLayers.Function.bind(this.onImageError,this)),this.imageReloadAttempts=0,this.setImgSrc(this.url))}else this.isLoading=!1},setImgSrc:function(a){var b=this.imgDiv;a?(b.style.visibility="hidden",b.style.opacity=0,this.crossOriginKeyword&&("data:"!==a.substr(0,5)?b.setAttribute("crossorigin",this.crossOriginKeyword):
b.removeAttribute("crossorigin")),b.src=a):(this.stopLoading(),this.imgDiv=null,b.parentNode&&b.parentNode.removeChild(b))},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(this.imgDiv&&!this.isLoading){var a;this.frame?(a=this.frame.cloneNode(!1),a.appendChild(this.imgDiv)):a=this.imgDiv;this.imgDiv=null;return a}},onImageLoad:function(){var a=this.imgDiv;this.stopLoading();a.style.visibility="inherit";a.style.opacity=this.layer.opacity;this.isLoading=
!1;this.canvasContext=null;this.events.triggerEvent("loadend");!0===this.layerAlphaHack&&(a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.src+"', sizingMethod='scale')")},onImageError:function(){var a=this.imgDiv;null!=a.src&&(this.imageReloadAttempts++,this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(OpenLayers.Element.addClass(a,"olImageLoadError"),this.events.triggerEvent("loaderror"),this.onImageLoad()))},stopLoading:function(){OpenLayers.Event.stopObservingElement(this.imgDiv);
window.clearTimeout(this._loadTimeout);delete this._loadTimeout},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var a=document.createElement("canvas");a.width=this.size.w;a.height=this.size.h;this.canvasContext=a.getContext("2d");this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"});
OpenLayers.Tile.Image.IMAGE=function(){var a=new Image;a.className="olTileImage";a.galleryImg="no";return a}();OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:"resize",numLoadingTiles:0,serverResolutions:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,gridLayout:null,rowSign:null,transitionendEvents:["transitionend",
"webkitTransitionEnd","otransitionend","oTransitionEnd"],initialize:function(a,b,c,d){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.grid=[];this._removeBackBuffer=OpenLayers.Function.bind(this.removeBackBuffer,this);this.initProperties();this.rowSign="t"===this.tileOriginCorner.substr(0,1)?1:-1},initProperties:function(){void 0===this.options.removeBackBufferDelay&&(this.removeBackBufferDelay=this.singleTile?0:2500);void 0===this.options.className&&(this.className=this.singleTile?
"olLayerGridSingleTile":"olLayerGrid")},setMap:function(a){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,a);OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(a){this.removeBackBuffer()},destroy:function(){this.removeBackBuffer();this.clearGrid();this.tileSize=this.grid=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){if(this.grid){for(var a=0,b=this.grid.length;a<b;a++)for(var c=this.grid[a],d=0,e=c.length;d<e;d++)this.destroyTile(c[d]);
this.grid=[];this.gridLayout=this.gridResolution=null}},addOptions:function(a,b){var c=void 0!==a.singleTile&&a.singleTile!==this.singleTile;OpenLayers.Layer.HTTPRequest.prototype.addOptions.apply(this,arguments);this.map&&c&&(this.initProperties(),this.clearGrid(),this.tileSize=this.options.tileSize,this.setTileSize(),this.moveTo(null,!0))},clone:function(a){null==a&&(a=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions()));a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,
[a]);null!=this.tileSize&&(a.tileSize=this.tileSize.clone());a.grid=[];a.gridResolution=null;a.backBuffer=null;a.backBufferTimerId=null;a.loading=!1;a.numLoadingTiles=0;return a},moveTo:function(a,b,c){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);a=a||this.map.getExtent();if(null!=a){var d=!this.grid.length||b,e=this.getTilesBounds(),f=this.map.getResolution();this.getServerResolution(f);if(this.singleTile){if(d||!c&&!e.containsBounds(a))b&&"resize"!==this.transitionEffect&&
this.removeBackBuffer(),b&&"resize"!==this.transitionEffect||this.applyBackBuffer(f),this.initSingleTile(a)}else(d=d||!e.intersectsBounds(a,{worldBounds:this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent()}))?(!b||"resize"!==this.transitionEffect&&this.gridResolution!==f||this.applyBackBuffer(f),this.initGriddedTiles(a)):this.moveGriddedTiles()}},getTileData:function(a){var b=null,c=a.lon,d=a.lat,e=this.grid.length;if(this.map&&e){var f=this.map.getResolution();a=this.tileSize.w;var g=this.tileSize.h,
h=this.grid[0][0].bounds,k=h.left,h=h.top;if(c<k&&this.map.baseLayer.wrapDateLine)var l=this.map.getMaxExtent().getWidth(),m=Math.ceil((k-c)/l),c=c+l*m;c=(c-k)/(f*a);d=(h-d)/(f*g);f=Math.floor(c);k=Math.floor(d);0<=k&&k<e&&(e=this.grid[k][f])&&(b={tile:e,i:Math.floor((c-f)*a),j:Math.floor((d-k)*g)})}return b},destroyTile:function(a){this.removeTileMonitoringHooks(a);a.destroy()},getServerResolution:function(a){var b=Number.POSITIVE_INFINITY;a=a||this.map.getResolution();if(this.serverResolutions&&
-1===OpenLayers.Util.indexOf(this.serverResolutions,a)){var c,d,e,f;for(c=this.serverResolutions.length-1;0<=c;c--){e=this.serverResolutions[c];d=Math.abs(e-a);if(d>b)break;b=d;f=e}a=f}return a},getServerZoom:function(){var a=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,a):this.map.getZoomForResolution(a)+(this.zoomOffset||0)},applyBackBuffer:function(a){null!==this.backBufferTimerId&&this.removeBackBuffer();var b=this.backBuffer;if(!b){b=
this.createBackBuffer();if(!b)return;a===this.gridResolution?this.div.insertBefore(b,this.div.firstChild):this.map.baseLayer.div.parentNode.insertBefore(b,this.map.baseLayer.div);this.backBuffer=b;var c=this.grid[0][0].bounds;this.backBufferLonLat={lon:c.left,lat:c.top};this.backBufferResolution=this.gridResolution}for(var c=this.backBufferResolution/a,d=b.childNodes,e,f=d.length-1;0<=f;--f)e=d[f],e.style.top=(c*e._i*e._h|0)+"px",e.style.left=(c*e._j*e._w|0)+"px",e.style.width=Math.round(c*e._w)+
"px",e.style.height=Math.round(c*e._h)+"px";a=this.getViewPortPxFromLonLat(this.backBufferLonLat,a);c=this.map.layerContainerOriginPx.y;b.style.left=Math.round(a.x-this.map.layerContainerOriginPx.x)+"px";b.style.top=Math.round(a.y-c)+"px"},createBackBuffer:function(){var a;if(0<this.grid.length){a=document.createElement("div");a.id=this.div.id+"_bb";a.className="olBackBuffer";a.style.position="absolute";var b=this.map;a.style.zIndex="resize"===this.transitionEffect?this.getZIndex()-1:b.Z_INDEX_BASE.BaseLayer-
(b.getNumLayers()-b.getLayerIndex(this));for(var b=0,c=this.grid.length;b<c;b++)for(var d=0,e=this.grid[b].length;d<e;d++){var f=this.grid[b][d],g=this.grid[b][d].createBackBuffer();g&&(g._i=b,g._j=d,g._w=f.size.w,g._h=f.size.h,g.id=f.id+"_bb",a.appendChild(g))}}return a},removeBackBuffer:function(){if(this._transitionElement){for(var a=this.transitionendEvents.length-1;0<=a;--a)OpenLayers.Event.stopObserving(this._transitionElement,this.transitionendEvents[a],this._removeBackBuffer);delete this._transitionElement}this.backBuffer&&
(this.backBuffer.parentNode&&this.backBuffer.parentNode.removeChild(this.backBuffer),this.backBufferResolution=this.backBuffer=null,null!==this.backBufferTimerId&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null))},moveByPx:function(a,b){this.singleTile||this.moveGriddedTiles()},setTileSize:function(a){this.singleTile&&(a=this.map.getSize(),a.h=parseInt(a.h*this.ratio,10),a.w=parseInt(a.w*this.ratio,10));OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[a])},getTilesBounds:function(){var a=
null,b=this.grid.length;if(b)var a=this.grid[b-1][0].bounds,b=this.grid[0].length*a.getWidth(),c=this.grid.length*a.getHeight(),a=new OpenLayers.Bounds(a.left,a.bottom,a.left+b,a.bottom+c);return a},initSingleTile:function(a){this.events.triggerEvent("retile");var b=a.getCenterLonLat(),c=a.getWidth()*this.ratio;a=a.getHeight()*this.ratio;b=new OpenLayers.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2);c=this.map.getLayerPxFromLonLat({lon:b.left,lat:b.top});this.grid.length||(this.grid[0]=[]);(a=this.grid[0][0])?
a.moveTo(b,c):(a=this.addTile(b,c),this.addTileMonitoringHooks(a),a.draw(),this.grid[0][0]=a);this.removeExcessTiles(1,1);this.gridResolution=this.getServerResolution()},calculateGridLayout:function(a,b,c){var d=c*this.tileSize.w;c*=this.tileSize.h;var e=Math.floor((a.left-b.lon)/d)-this.buffer,f=this.rowSign;a=Math[~f?"floor":"ceil"](f*(b.lat-a.top+c)/c)-this.buffer*f;return{tilelon:d,tilelat:c,startcol:e,startrow:a}},getTileOrigin:function(){var a=this.tileOrigin;if(!a)var a=this.getMaxExtent(),
b={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner],a=new OpenLayers.LonLat(a[b[0]],a[b[1]]);return a},getTileBoundsForGridIndex:function(a,b){var c=this.getTileOrigin(),d=this.gridLayout,e=d.tilelon,f=d.tilelat,g=d.startcol,d=d.startrow,h=this.rowSign;return new OpenLayers.Bounds(c.lon+(g+b)*e,c.lat-(d+a*h)*f*h,c.lon+(g+b+1)*e,c.lat-(d+(a-1)*h)*f*h)},initGriddedTiles:function(a){this.events.triggerEvent("retile");var b=this.map.getSize(),c=this.getTileOrigin(),
d=this.map.getResolution(),e=this.getServerResolution(),f=d/e,d=this.tileSize.w/f,f=this.tileSize.h/f,g=Math.ceil(b.h/f)+2*this.buffer+1,b=Math.ceil(b.w/d)+2*this.buffer+1;this.gridLayout=e=this.calculateGridLayout(a,c,e);var c=e.tilelon,h=e.tilelat,e=this.map.layerContainerOriginPx.x,k=this.map.layerContainerOriginPx.y,l=this.getTileBoundsForGridIndex(0,0),m=this.map.getViewPortPxFromLonLat(new OpenLayers.LonLat(l.left,l.top));m.x=Math.round(m.x)-e;m.y=Math.round(m.y)-k;var e=[],k=this.map.getCenter(),
n=0;do{var p=this.grid[n];p||(p=[],this.grid.push(p));var q=0;do{var l=this.getTileBoundsForGridIndex(n,q),r=m.clone();r.x+=q*Math.round(d);r.y+=n*Math.round(f);var s=p[q];s?s.moveTo(l,r,!1):(s=this.addTile(l,r),this.addTileMonitoringHooks(s),p.push(s));r=l.getCenterLonLat();e.push({tile:s,distance:Math.pow(r.lon-k.lon,2)+Math.pow(r.lat-k.lat,2)});q+=1}while(l.right<=a.right+c*this.buffer||q<b);n+=1}while(l.bottom>=a.bottom-h*this.buffer||n<g);this.removeExcessTiles(n,q);this.gridResolution=d=this.getServerResolution();
e.sort(function(a,b){return a.distance-b.distance});a=0;for(d=e.length;a<d;++a)e[a].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(a,b){var c=new this.tileClass(this,b,a,null,this.tileSize,this.tileOptions);this.events.triggerEvent("addtile",{tile:c});return c},addTileMonitoringHooks:function(a){a.onLoadStart=function(){!1===this.loading&&(this.loading=!0,this.events.triggerEvent("loadstart"));this.events.triggerEvent("tileloadstart",{tile:a});this.numLoadingTiles++;
!this.singleTile&&(this.backBuffer&&this.gridResolution===this.backBufferResolution)&&OpenLayers.Element.addClass(a.getTile(),"olTileReplacing")};a.onLoadEnd=function(b){this.numLoadingTiles--;b="unload"===b.type;this.events.triggerEvent("tileloaded",{tile:a,aborted:b});if(!this.singleTile&&!b&&this.backBuffer&&this.gridResolution===this.backBufferResolution){var c=a.getTile();if("none"===OpenLayers.Element.getStyle(c,"display")){var d=document.getElementById(a.id+"_bb");d&&d.parentNode.removeChild(d)}OpenLayers.Element.removeClass(c,
"olTileReplacing")}if(0===this.numLoadingTiles){if(this.backBuffer)if(0===this.backBuffer.childNodes.length)this.removeBackBuffer();else{this._transitionElement=b?this.div.lastChild:a.imgDiv;b=this.transitionendEvents;for(c=b.length-1;0<=c;--c)OpenLayers.Event.observe(this._transitionElement,b[c],this._removeBackBuffer);this.backBufferTimerId=window.setTimeout(this._removeBackBuffer,this.removeBackBufferDelay)}this.loading=!1;this.events.triggerEvent("loadend")}};a.onLoadError=function(){this.events.triggerEvent("tileerror",
{tile:a})};a.events.on({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},moveGriddedTiles:function(){for(var a=this.buffer+1;;){var b=this.grid[0][0],c=b.position.x+this.map.layerContainerOriginPx.x,b=b.position.y+this.map.layerContainerOriginPx.y,d=this.getServerResolution()/this.map.getResolution(),
d={w:Math.round(this.tileSize.w*d),h:Math.round(this.tileSize.h*d)};if(c>-d.w*(a-1))this.shiftColumn(!0,d);else if(c<-d.w*a)this.shiftColumn(!1,d);else if(b>-d.h*(a-1))this.shiftRow(!0,d);else if(b<-d.h*a)this.shiftRow(!1,d);else break}},shiftRow:function(a,b){var c=this.grid,d=a?0:c.length-1,e=a?-1:1;this.gridLayout.startrow+=e*this.rowSign;for(var f=c[d],g=c[a?"pop":"shift"](),h=0,k=g.length;h<k;h++){var l=g[h],m=f[h].position.clone();m.y+=b.h*e;l.moveTo(this.getTileBoundsForGridIndex(d,h),m)}c[a?
"unshift":"push"](g)},shiftColumn:function(a,b){var c=this.grid,d=a?0:c[0].length-1,e=a?-1:1;this.gridLayout.startcol+=e;for(var f=0,g=c.length;f<g;f++){var h=c[f],k=h[d].position.clone(),l=h[a?"pop":"shift"]();k.x+=b.w*e;l.moveTo(this.getTileBoundsForGridIndex(f,d),k);h[a?"unshift":"push"](l)}},removeExcessTiles:function(a,b){for(var c,d;this.grid.length>a;){var e=this.grid.pop();c=0;for(d=e.length;c<d;c++){var f=e[c];this.destroyTile(f)}}c=0;for(d=this.grid.length;c<d;c++)for(;this.grid[c].length>
b;)e=this.grid[c],f=e.pop(),this.destroyTile(f)},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(a){var b=this.maxExtent,c=this.getResolution(),d=c*this.tileSize.w,c=c*this.tileSize.h,e=this.getLonLatFromViewPortPx(a);a=b.left+d*Math.floor((e.lon-b.left)/d);b=b.bottom+c*Math.floor((e.lat-b.bottom)/c);return new OpenLayers.Bounds(a,b,a+d,b+c)},CLASS_NAME:"OpenLayers.Layer.Grid"});OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:"antialiasing blockout font fontcolor fontsize fontstyle glowing interval outline printmode shadow transparency".split(" "),request:null,response:null,initialize:function(a){this.request=new OpenLayers.Format.ArcXML.Request;this.response=new OpenLayers.Format.ArcXML.Response;if(a)if("feature"==a.requesttype){this.request.get_image=null;var b=this.request.get_feature.query;this.addCoordSys(b.featurecoordsys,a.featureCoordSys);
this.addCoordSys(b.filtercoordsys,a.filterCoordSys);a.polygon?(b.isspatial=!0,b.spatialfilter.polygon=a.polygon):a.envelope&&(b.isspatial=!0,b.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0},this.parseEnvelope(b.spatialfilter.envelope,a.envelope))}else"image"==a.requesttype?(this.request.get_feature=null,b=this.request.get_image.properties,this.parseEnvelope(b.envelope,a.envelope),this.addLayers(b.layerlist,a.layers),this.addImageSize(b.imagesize,a.tileSize),this.addCoordSys(b.featurecoordsys,
a.featureCoordSys),this.addCoordSys(b.filtercoordsys,a.filterCoordSys)):this.request=null;OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},parseEnvelope:function(a,b){b&&4==b.length&&(a.minx=b[0],a.miny=b[1],a.maxx=b[2],a.maxy=b[3])},addLayers:function(a,b){for(var c=0,d=b.length;c<d;c++)a.push(b[c])},addImageSize:function(a,b){null!==b&&(a.width=b.w,a.height=b.h,a.printwidth=b.w,a.printheight=b.h)},addCoordSys:function(a,b){"string"==typeof b?(a.id=parseInt(b),a.string=b):"object"==typeof b&&
null!==b.proj&&(a.id=b.proj.srsProjNumber,a.string=b.proj.srsCode)},iserror:function(a){var b=null;a?(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]),a=a.documentElement.getElementsByTagName("ERROR"),b=null!==a&&0<a.length):b=""!==this.response.error;return b},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=null;a&&a.documentElement&&(b="ARCXML"==a.documentElement.nodeName?a.documentElement:a.documentElement.getElementsByTagName("ARCXML")[0]);
if(!b||"parsererror"===b.firstChild.nodeName){var c,d;try{c=a.firstChild.nodeValue,d=a.firstChild.childNodes[1].firstChild.nodeValue}catch(e){}throw{message:"Error parsing the ArcXML request",error:c,source:d};}return this.parseResponse(b)},write:function(a){a||(a=this.request);var b=this.createElementNS("","ARCXML");b.setAttribute("version","1.1");var c=this.createElementNS("","REQUEST");if(null!=a.get_image){var d=this.createElementNS("","GET_IMAGE");c.appendChild(d);var e=this.createElementNS("",
"PROPERTIES");d.appendChild(e);a=a.get_image.properties;null!=a.featurecoordsys&&(d=this.createElementNS("","FEATURECOORDSYS"),e.appendChild(d),0===a.featurecoordsys.id?d.setAttribute("string",a.featurecoordsys.string):d.setAttribute("id",a.featurecoordsys.id));null!=a.filtercoordsys&&(d=this.createElementNS("","FILTERCOORDSYS"),e.appendChild(d),0===a.filtercoordsys.id?d.setAttribute("string",a.filtercoordsys.string):d.setAttribute("id",a.filtercoordsys.id));null!=a.envelope&&(d=this.createElementNS("",
"ENVELOPE"),e.appendChild(d),d.setAttribute("minx",a.envelope.minx),d.setAttribute("miny",a.envelope.miny),d.setAttribute("maxx",a.envelope.maxx),d.setAttribute("maxy",a.envelope.maxy));d=this.createElementNS("","IMAGESIZE");e.appendChild(d);d.setAttribute("height",a.imagesize.height);d.setAttribute("width",a.imagesize.width);if(a.imagesize.height!=a.imagesize.printheight||a.imagesize.width!=a.imagesize.printwidth)d.setAttribute("printheight",a.imagesize.printheight),d.setArrtibute("printwidth",a.imagesize.printwidth);
null!=a.background&&(d=this.createElementNS("","BACKGROUND"),e.appendChild(d),d.setAttribute("color",a.background.color.r+","+a.background.color.g+","+a.background.color.b),null!==a.background.transcolor&&d.setAttribute("transcolor",a.background.transcolor.r+","+a.background.transcolor.g+","+a.background.transcolor.b));if(null!=a.layerlist&&0<a.layerlist.length)for(d=this.createElementNS("","LAYERLIST"),e.appendChild(d),e=0;e<a.layerlist.length;e++){var f=this.createElementNS("","LAYERDEF");d.appendChild(f);
f.setAttribute("id",a.layerlist[e].id);f.setAttribute("visible",a.layerlist[e].visible);if("object"==typeof a.layerlist[e].query){var g=a.layerlist[e].query;if(0>g.where.length)continue;var h=null,h="boolean"==typeof g.spatialfilter&&g.spatialfilter?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY");h.setAttribute("where",g.where);"number"==typeof g.accuracy&&0<g.accuracy&&h.setAttribute("accuracy",g.accuracy);"number"==typeof g.featurelimit&&2E3>g.featurelimit&&h.setAttribute("featurelimit",
g.featurelimit);"string"==typeof g.subfields&&"#ALL#"!=g.subfields&&h.setAttribute("subfields",g.subfields);"string"==typeof g.joinexpression&&0<g.joinexpression.length&&h.setAttribute("joinexpression",g.joinexpression);"string"==typeof g.jointables&&0<g.jointables.length&&h.setAttribute("jointables",g.jointables);f.appendChild(h)}"object"==typeof a.layerlist[e].renderer&&this.addRenderer(f,a.layerlist[e].renderer)}}else null!=a.get_feature&&(d=this.createElementNS("","GET_FEATURES"),d.setAttribute("outputmode",
"newxml"),d.setAttribute("checkesc","true"),a.get_feature.geometry?d.setAttribute("geometry",a.get_feature.geometry):d.setAttribute("geometry","false"),a.get_feature.compact&&d.setAttribute("compact",a.get_feature.compact),"number"==a.get_feature.featurelimit&&d.setAttribute("featurelimit",a.get_feature.featurelimit),d.setAttribute("globalenvelope","true"),c.appendChild(d),null!=a.get_feature.layer&&0<a.get_feature.layer.length&&(e=this.createElementNS("","LAYER"),e.setAttribute("id",a.get_feature.layer),
d.appendChild(e)),a=a.get_feature.query,null!=a&&(e=null,e=a.isspatial?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY"),d.appendChild(e),"number"==typeof a.accuracy&&e.setAttribute("accuracy",a.accuracy),null!=a.featurecoordsys&&(d=this.createElementNS("","FEATURECOORDSYS"),0==a.featurecoordsys.id?d.setAttribute("string",a.featurecoordsys.string):d.setAttribute("id",a.featurecoordsys.id),e.appendChild(d)),null!=a.filtercoordsys&&(d=this.createElementNS("","FILTERCOORDSYS"),
0===a.filtercoordsys.id?d.setAttribute("string",a.filtercoordsys.string):d.setAttribute("id",a.filtercoordsys.id),e.appendChild(d)),0<a.buffer&&(d=this.createElementNS("","BUFFER"),d.setAttribute("distance",a.buffer),e.appendChild(d)),a.isspatial&&(d=this.createElementNS("","SPATIALFILTER"),d.setAttribute("relation",a.spatialfilter.relation),e.appendChild(d),a.spatialfilter.envelope?(f=this.createElementNS("","ENVELOPE"),f.setAttribute("minx",a.spatialfilter.envelope.minx),f.setAttribute("miny",a.spatialfilter.envelope.miny),
f.setAttribute("maxx",a.spatialfilter.envelope.maxx),f.setAttribute("maxy",a.spatialfilter.envelope.maxy),d.appendChild(f)):"object"==typeof a.spatialfilter.polygon&&d.appendChild(this.writePolygonGeometry(a.spatialfilter.polygon))),null!=a.where&&0<a.where.length&&e.setAttribute("where",a.where)));b.appendChild(c);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},addGroupRenderer:function(a,b){var c=this.createElementNS("","GROUPRENDERER");a.appendChild(c);for(var d=0;d<b.length;d++)this.addRenderer(c,
b[d])},addRenderer:function(a,b){if(OpenLayers.Util.isArray(b))this.addGroupRenderer(a,b);else{var c=this.createElementNS("",b.type.toUpperCase()+"RENDERER");a.appendChild(c);"VALUEMAPRENDERER"==c.tagName?this.addValueMapRenderer(c,b):"VALUEMAPLABELRENDERER"==c.tagName?this.addValueMapLabelRenderer(c,b):"SIMPLELABELRENDERER"==c.tagName?this.addSimpleLabelRenderer(c,b):"SCALEDEPENDENTRENDERER"==c.tagName&&this.addScaleDependentRenderer(c,b)}},addScaleDependentRenderer:function(a,b){"string"!=typeof b.lower&&
"number"!=typeof b.lower||a.setAttribute("lower",b.lower);"string"!=typeof b.upper&&"number"!=typeof b.upper||a.setAttribute("upper",b.upper);this.addRenderer(a,b.renderer)},addValueMapLabelRenderer:function(a,b){a.setAttribute("lookupfield",b.lookupfield);a.setAttribute("labelfield",b.labelfield);if("object"==typeof b.exacts)for(var c=0,d=b.exacts.length;c<d;c++){var e=b.exacts[c],f=this.createElementNS("","EXACT");"string"==typeof e.value&&f.setAttribute("value",e.value);"string"==typeof e.label&&
f.setAttribute("label",e.label);"string"==typeof e.method&&f.setAttribute("method",e.method);a.appendChild(f);if("object"==typeof e.symbol){var g=null;"text"==e.symbol.type&&(g=this.createElementNS("","TEXTSYMBOL"));if(null!=g){for(var h=this.fontStyleKeys,k=0,l=h.length;k<l;k++){var m=h[k];e.symbol[m]&&g.setAttribute(m,e.symbol[m])}f.appendChild(g)}}}},addValueMapRenderer:function(a,b){a.setAttribute("lookupfield",b.lookupfield);if("object"==typeof b.ranges)for(var c=0,d=b.ranges.length;c<d;c++){var e=
b.ranges[c],f=this.createElementNS("","RANGE");f.setAttribute("lower",e.lower);f.setAttribute("upper",e.upper);a.appendChild(f);if("object"==typeof e.symbol){var g=null;"simplepolygon"==e.symbol.type&&(g=this.createElementNS("","SIMPLEPOLYGONSYMBOL"));null!=g&&("string"==typeof e.symbol.boundarycolor&&g.setAttribute("boundarycolor",e.symbol.boundarycolor),"string"==typeof e.symbol.fillcolor&&g.setAttribute("fillcolor",e.symbol.fillcolor),"number"==typeof e.symbol.filltransparency&&g.setAttribute("filltransparency",
e.symbol.filltransparency),f.appendChild(g))}}else if("object"==typeof b.exacts)for(c=0,d=b.exacts.length;c<d;c++)e=b.exacts[c],f=this.createElementNS("","EXACT"),"string"==typeof e.value&&f.setAttribute("value",e.value),"string"==typeof e.label&&f.setAttribute("label",e.label),"string"==typeof e.method&&f.setAttribute("method",e.method),a.appendChild(f),"object"==typeof e.symbol&&(g=null,"simplemarker"==e.symbol.type&&(g=this.createElementNS("","SIMPLEMARKERSYMBOL")),null!=g&&("string"==typeof e.symbol.antialiasing&&
g.setAttribute("antialiasing",e.symbol.antialiasing),"string"==typeof e.symbol.color&&g.setAttribute("color",e.symbol.color),"string"==typeof e.symbol.outline&&g.setAttribute("outline",e.symbol.outline),"string"==typeof e.symbol.overlap&&g.setAttribute("overlap",e.symbol.overlap),"string"==typeof e.symbol.shadow&&g.setAttribute("shadow",e.symbol.shadow),"number"==typeof e.symbol.transparency&&g.setAttribute("transparency",e.symbol.transparency),"string"==typeof e.symbol.usecentroid&&g.setAttribute("usecentroid",
e.symbol.usecentroid),"number"==typeof e.symbol.width&&g.setAttribute("width",e.symbol.width),f.appendChild(g)))},addSimpleLabelRenderer:function(a,b){a.setAttribute("field",b.field);for(var c="featureweight howmanylabels labelbufferratio labelpriorities labelweight linelabelposition rotationalangles".split(" "),d=0,e=c.length;d<e;d++){var f=c[d];b[f]&&a.setAttribute(f,b[f])}if("text"==b.symbol.type){var g=b.symbol,h=this.createElementNS("","TEXTSYMBOL");a.appendChild(h);c=this.fontStyleKeys;d=0;
for(e=c.length;d<e;d++)f=c[d],g[f]&&h.setAttribute(f,b[f])}},writePolygonGeometry:function(a){if(!(a instanceof OpenLayers.Geometry.Polygon))throw{message:"Cannot write polygon geometry to ArcXML with an "+a.CLASS_NAME+" object.",geometry:a};for(var b=this.createElementNS("","POLYGON"),c=0,d=a.components.length;c<d;c++){for(var e=a.components[c],f=this.createElementNS("","RING"),g=0,h=e.components.length;g<h;g++){var k=e.components[g],l=this.createElementNS("","POINT");l.setAttribute("x",k.x);l.setAttribute("y",
k.y);f.appendChild(l)}b.appendChild(f)}return b},parseResponse:function(a){"string"==typeof a&&(a=(new OpenLayers.Format.XML).read(a));var b=new OpenLayers.Format.ArcXML.Response,c=a.getElementsByTagName("ERROR");if(null!=c&&0<c.length)b.error=this.getChildValue(c,"Unknown error.");else{c=a.getElementsByTagName("RESPONSE");if(null==c||0==c.length)return b.error="No RESPONSE tag found in ArcXML response.",b;var d=c[0].firstChild.nodeName;"#text"==d&&(d=c[0].firstChild.nextSibling.nodeName);if("IMAGE"==
d)c=a.getElementsByTagName("ENVELOPE"),a=a.getElementsByTagName("OUTPUT"),null==c||0==c.length?b.error="No ENVELOPE tag found in ArcXML response.":null==a||0==a.length?b.error="No OUTPUT tag found in ArcXML response.":(c=this.parseAttributes(c[0]),d=this.parseAttributes(a[0]),b.image="string"==typeof d.type?{envelope:c,output:{type:d.type,data:this.getChildValue(a[0])}}:{envelope:c,output:d});else if("FEATURES"==d){if(a=c[0].getElementsByTagName("FEATURES"),c=a[0].getElementsByTagName("FEATURECOUNT"),
b.features.featurecount=c[0].getAttribute("count"),0<b.features.featurecount)for(c=a[0].getElementsByTagName("ENVELOPE"),b.features.envelope=this.parseAttributes(c[0],"number"),a=a[0].getElementsByTagName("FEATURE"),c=0;c<a.length;c++){for(var d=new OpenLayers.Feature.Vector,e=a[c].getElementsByTagName("FIELD"),f=0;f<e.length;f++){var g=e[f].getAttribute("name"),h=e[f].getAttribute("value");d.attributes[g]=h}e=a[c].getElementsByTagName("POLYGON");if(0<e.length){e=e[0].getElementsByTagName("RING");
f=[];for(g=0;g<e.length;g++){h=[];h.push(this.parsePointGeometry(e[g]));for(var k=e[g].getElementsByTagName("HOLE"),l=0;l<k.length;l++)h.push(this.parsePointGeometry(k[l]));f.push(new OpenLayers.Geometry.Polygon(h))}d.geometry=1==f.length?f[0]:new OpenLayers.Geometry.MultiPolygon(f)}b.features.feature.push(d)}}else b.error="Unidentified response type."}return b},parseAttributes:function(a,b){for(var c={},d=0;d<a.attributes.length;d++)c[a.attributes[d].nodeName]="number"==b?parseFloat(a.attributes[d].nodeValue):
a.attributes[d].nodeValue;return c},parsePointGeometry:function(a){var b=[],c=a.getElementsByTagName("COORDS");if(0<c.length)for(a=this.getChildValue(c[0]),a=a.split(/;/),c=0;c<a.length;c++){var d=a[c].split(/ /);b.push(new OpenLayers.Geometry.Point(d[0],d[1]))}else if(a=a.getElementsByTagName("POINT"),0<a.length)for(c=0;c<a.length;c++)b.push(new OpenLayers.Geometry.Point(parseFloat(a[c].getAttribute("x")),parseFloat(a[c].getAttribute("y"))));return new OpenLayers.Geometry.LinearRing(b)},CLASS_NAME:"OpenLayers.Format.ArcXML"});
OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(a){return OpenLayers.Util.extend(this,{get_image:{properties:{background:null,draw:!0,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:!1},layerlist:[],output:{baseurl:"",legendbaseurl:"",legendname:"",legendpath:"",
legendurl:"",name:"",path:"",type:"jpg",url:""}}},get_feature:{layer:"",query:{isspatial:!1,featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},buffer:0,where:"",spatialfilter:{relation:"envelope_intersection",envelope:null}}},environment:{separators:{cs:" ",ts:";"}},layer:[],workspaces:[]})},CLASS_NAME:"OpenLayers.Format.ArcXML.Request"});
OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(a){return OpenLayers.Util.extend(this,{image:{envelope:null,output:""},features:{featurecount:0,envelope:null,feature:[]},error:""})},CLASS_NAME:"OpenLayers.Format.ArcXML.Response"});(function(){function a(){this._object=f&&!k?new f:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function b(){return new a}function c(a){b.onreadystatechange&&b.onreadystatechange.apply(a);a.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function d(a){try{a.responseText=a._object.responseText}catch(b){}try{var c;var d=a._object,e=d.responseXML,f=d.responseText;h&&(f&&e&&!e.documentElement&&d.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/))&&
(e=new window.ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.validateOnParse=!1,e.loadXML(f));c=e&&(h&&0!=e.parseError||!e.documentElement||e.documentElement&&"parsererror"==e.documentElement.tagName)?null:e;a.responseXML=c}catch(g){}try{a.status=a._object.status}catch(k){}try{a.statusText=a._object.statusText}catch(u){}}function e(a){a._object.onreadystatechange=new window.Function}var f=window.XMLHttpRequest,g=!!window.controllers,h=window.document.all&&!window.opera,k=h&&window.navigator.userAgent.match(/MSIE 7.0/);
b.prototype=a.prototype;g&&f.wrapped&&(b.wrapped=f.wrapped);b.UNSENT=0;b.OPENED=1;b.HEADERS_RECEIVED=2;b.LOADING=3;b.DONE=4;b.prototype.readyState=b.UNSENT;b.prototype.responseText="";b.prototype.responseXML=null;b.prototype.status=0;b.prototype.statusText="";b.prototype.priority="NORMAL";b.prototype.onreadystatechange=null;b.onreadystatechange=null;b.onopen=null;b.onsend=null;b.onabort=null;b.prototype.open=function(a,f,k,p,q){delete this._headers;3>arguments.length&&(k=!0);this._async=k;var r=this,
s=this.readyState,t;h&&k&&(t=function(){s!=b.DONE&&(e(r),r.abort())},window.attachEvent("onunload",t));b.onopen&&b.onopen.apply(this,arguments);4<arguments.length?this._object.open(a,f,k,p,q):3<arguments.length?this._object.open(a,f,k,p):this._object.open(a,f,k);this.readyState=b.OPENED;c(this);this._object.onreadystatechange=function(){if(!g||k)r.readyState=r._object.readyState,d(r),r._aborted?r.readyState=b.UNSENT:(r.readyState==b.DONE&&(delete r._data,e(r),h&&k&&window.detachEvent("onunload",t)),
s!=r.readyState&&c(r),s=r.readyState)}};b.prototype.send=function(a){b.onsend&&b.onsend.apply(this,arguments);arguments.length||(a=null);a&&a.nodeType&&(a=window.XMLSerializer?(new window.XMLSerializer).serializeToString(a):a.xml,this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml"));this._data=a;a:if(this._object.send(this._data),g&&!this._async)for(this.readyState=b.OPENED,d(this);this.readyState<b.DONE;)if(this.readyState++,c(this),this._aborted)break a};
b.prototype.abort=function(){b.onabort&&b.onabort.apply(this,arguments);this.readyState>b.UNSENT&&(this._aborted=!0);this._object.abort();e(this);this.readyState=b.UNSENT;delete this._data};b.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};b.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)};b.prototype.setRequestHeader=function(a,b){this._headers||(this._headers={});this._headers[a]=b;return this._object.setRequestHeader(a,b)};
b.prototype.addEventListener=function(a,b,c){for(var d=0,e;e=this._listeners[d];d++)if(e[0]==a&&e[1]==b&&e[2]==c)return;this._listeners.push([a,b,c])};b.prototype.removeEventListener=function(a,b,c){for(var d=0,e;(e=this._listeners[d])&&(e[0]!=a||e[1]!=b||e[2]!=c);d++);e&&this._listeners.splice(d,1)};b.prototype.dispatchEvent=function(a){a={type:a.type,target:this,currentTarget:this,eventPhase:2,bubbles:a.bubbles,cancelable:a.cancelable,timeStamp:a.timeStamp,stopPropagation:function(){},preventDefault:function(){},
initEvent:function(){}};"readystatechange"==a.type&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[a]);for(var b=0,c;c=this._listeners[b];b++)c[0]!=a.type||c[2]||(c[1].handleEvent||c[1]).apply(this,[a])};b.prototype.toString=function(){return"[object XMLHttpRequest]"};b.toString=function(){return"[XMLHttpRequest]"};window.Function.prototype.apply||(window.Function.prototype.apply=function(a,b){b||(b=[]);a.__func=this;a.__func(b[0],b[1],b[2],b[3],
b[4]);delete a.__func});OpenLayers.Request||(OpenLayers.Request={});OpenLayers.Request.XMLHttpRequest=b})();OpenLayers.ProxyHost="";OpenLayers.Request||(OpenLayers.Request={});
OpenLayers.Util.extend(OpenLayers.Request,{DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:void 0,password:void 0,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(a,b){var c=0!==a.indexOf("http"),d=!c&&a.match(this.URL_SPLIT_REGEX);if(d){var e=window.location,c=d[1]==e.protocol&&d[3]==
e.hostname,d=d[4],e=e.port;if(80!=d&&""!=d||"80"!=e&&""!=e)c=c&&d==e}c||b&&(a="function"==typeof b?b(a):b+encodeURIComponent(a));return a},issue:function(a){var b=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});a=a||{};a.headers=a.headers||{};a=OpenLayers.Util.applyDefaults(a,b);a.headers=OpenLayers.Util.applyDefaults(a.headers,b.headers);var b=!1,c;for(c in a.headers)a.headers.hasOwnProperty(c)&&"x-requested-with"===c.toLowerCase()&&(b=!0);!1===b&&(a.headers["X-Requested-With"]=
"XMLHttpRequest");var d=new OpenLayers.Request.XMLHttpRequest,e=OpenLayers.Util.urlAppend(a.url,OpenLayers.Util.getParameterString(a.params||{})),e=OpenLayers.Request.makeSameOrigin(e,a.proxy);d.open(a.method,e,a.async,a.user,a.password);for(var f in a.headers)d.setRequestHeader(f,a.headers[f]);var g=this.events,h=this;d.onreadystatechange=function(){d.readyState==OpenLayers.Request.XMLHttpRequest.DONE&&!1!==g.triggerEvent("complete",{request:d,config:a,requestUrl:e})&&h.runCallbacks({request:d,config:a,
requestUrl:e})};!1===a.async?d.send(a.data):window.setTimeout(function(){0!==d.readyState&&d.send(a.data)},0);return d},runCallbacks:function(a){var b=a.request,c=a.config,d=c.scope?OpenLayers.Function.bind(c.callback,c.scope):c.callback,e;c.success&&(e=c.scope?OpenLayers.Function.bind(c.success,c.scope):c.success);var f;c.failure&&(f=c.scope?OpenLayers.Function.bind(c.failure,c.scope):c.failure);"file:"==OpenLayers.Util.createUrlObject(c.url).protocol&&b.responseText&&(b.status=200);d(b);if(!b.status||
200<=b.status&&300>b.status)this.events.triggerEvent("success",a),e&&e(b);b.status&&(200>b.status||300<=b.status)&&(this.events.triggerEvent("failure",a),f&&f(b))},GET:function(a){a=OpenLayers.Util.extend(a,{method:"GET"});return OpenLayers.Request.issue(a)},POST:function(a){a=OpenLayers.Util.extend(a,{method:"POST"});a.headers=a.headers?a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},PUT:function(a){a=
OpenLayers.Util.extend(a,{method:"PUT"});a.headers=a.headers?a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},DELETE:function(a){a=OpenLayers.Util.extend(a,{method:"DELETE"});return OpenLayers.Request.issue(a)},HEAD:function(a){a=OpenLayers.Util.extend(a,{method:"HEAD"});return OpenLayers.Request.issue(a)},OPTIONS:function(a){a=OpenLayers.Util.extend(a,{method:"OPTIONS"});return OpenLayers.Request.issue(a)}});OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{ClientVersion:"9.2",ServiceName:""},featureCoordSys:"4326",filterCoordSys:"4326",layers:null,async:!0,name:"ArcIMS",isBaseLayer:!0,DEFAULT_OPTIONS:{tileSize:new OpenLayers.Size(512,512),featureCoordSys:"4326",filterCoordSys:"4326",layers:null,isBaseLayer:!0,async:!0,name:"ArcIMS"},initialize:function(a,b,c){this.tileSize=new OpenLayers.Size(512,512);this.params=OpenLayers.Util.applyDefaults({ServiceName:c.serviceName},
this.DEFAULT_PARAMS);this.options=OpenLayers.Util.applyDefaults(c,this.DEFAULT_OPTIONS);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,this.params,c]);this.transparent&&(this.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.format&&(this.format=OpenLayers.Util.alphaHack()?"image/gif":"image/png"));null===this.options.layers&&(this.options.layers=[])},getURL:function(a){var b="";a=this.adjustBounds(a);a=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",
envelope:a.toArray(),tileSize:this.tileSize}));a=new OpenLayers.Request.POST({url:this.getFullRequestString(),data:a.write(),async:!1});null!=a&&(b=a.responseXML,b&&b.documentElement||(b=a.responseText),b=(new OpenLayers.Format.ArcXML).read(b),b=this.getUrlOrImage(b.image.output));return b},getURLasync:function(a,b,c){a=this.adjustBounds(a);a=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:a.toArray(),tileSize:this.tileSize}));OpenLayers.Request.POST({url:this.getFullRequestString(),
async:!0,data:a.write(),callback:function(a){var e=a.responseXML;e&&e.documentElement||(e=a.responseText);a=(new OpenLayers.Format.ArcXML).read(e);b.call(c,this.getUrlOrImage(a.image.output))},scope:this})},getUrlOrImage:function(a){var b="";a.url?b=a.url:a.data&&(b="data:image/"+a.type+";base64,"+a.data);return b},setLayerQuery:function(a,b){for(var c=0;c<this.options.layers.length;c++)if(a==this.options.layers[c].id){this.options.layers[c].query=b;return}this.options.layers.push({id:a,visible:!0,
query:b})},getFeatureInfo:function(a,b,c){var d=c.buffer||1,e=c.callback||function(){},f=c.scope||window,g={};OpenLayers.Util.extend(g,this.options);g.requesttype="feature";a instanceof OpenLayers.LonLat?(g.polygon=null,g.envelope=[a.lon-d,a.lat-d,a.lon+d,a.lat+d]):a instanceof OpenLayers.Geometry.Polygon&&(g.envelope=null,g.polygon=a);var h=new OpenLayers.Format.ArcXML(g);OpenLayers.Util.extend(h.request.get_feature,c);h.request.get_feature.layer=b.id;"number"==typeof b.query.accuracy?h.request.get_feature.query.accuracy=
b.query.accuracy:(a=this.map.getCenter(),c=this.map.getViewPortPxFromLonLat(a),c.x++,c=this.map.getLonLatFromPixel(c),h.request.get_feature.query.accuracy=c.lon-a.lon);h.request.get_feature.query.where=b.query.where;h.request.get_feature.query.spatialfilter.relation="area_intersection";OpenLayers.Request.POST({url:this.getFullRequestString({CustomService:"Query"}),data:h.write(),callback:function(a){a=h.parseResponse(a.responseText);h.iserror()?e.call(f,null):e.call(f,a.features)}})},clone:function(a){null==
a&&(a=new OpenLayers.Layer.ArcIMS(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},CLASS_NAME:"OpenLayers.Layer.ArcIMS"});OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(a){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y);OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick);this.removeButtons();this.position=this.buttons=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},
setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments);a=this.position;this.buttons=[];var b={w:18,h:18},c=new OpenLayers.Pixel(a.x+b.w/2,a.y);this._addButton("panup","north-mini.png",c,b);a.y=c.y+b.h;this._addButton("panleft","west-mini.png",a,b);this._addButton("panright","east-mini.png",a.add(b.w,0),b);this._addButton("pandown","south-mini.png",
c.add(0,2*b.h),b);this._addButton("zoomin","zoom-plus-mini.png",c.add(0,3*b.h+5),b);this._addButton("zoomworld","zoom-world-mini.png",c.add(0,4*b.h+5),b);this._addButton("zoomout","zoom-minus-mini.png",c.add(0,5*b.h+5),b);return this.div},_addButton:function(a,b,c,d){b=OpenLayers.Util.getImageLocation(b);c=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+a,c,d,b,"absolute");c.style.cursor="pointer";this.div.appendChild(c);c.action=a;c.className="olButton";this.buttons.push(c);return c},_removeButton:function(a){this.div.removeChild(a);
OpenLayers.Util.removeItem(this.buttons,a)},removeButtons:function(){for(var a=this.buttons.length-1;0<=a;--a)this._removeButton(this.buttons[a])},onButtonClick:function(a){switch(a.buttonElement.action){case "panup":this.map.pan(0,-this.getSlideFactor("h"));break;case "pandown":this.map.pan(0,this.getSlideFactor("h"));break;case "panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case "panright":this.map.pan(this.getSlideFactor("w"),0);break;case "zoomin":this.map.zoomIn();break;case "zoomout":this.map.zoomOut();
break;case "zoomworld":this.map.zoomToMaxExtent()}},getSlideFactor:function(a){return this.slideRatio?this.map.getSize()[a]*this.slideRatio:this.slideFactor},CLASS_NAME:"OpenLayers.Control.PanZoom"});OpenLayers.Control.PanZoom.X=4;OpenLayers.Control.PanZoom.Y=4;OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:11,slider:null,sliderEvents:null,zoombarDiv:null,zoomWorldIcon:!1,panIcons:!0,forceFixedZoomLevel:!1,mouseDragStart:null,deltaY:null,zoomStart:null,destroy:function(){this._removeZoomBar();this.map.events.un({changebaselayer:this.redraw,updatesize:this.redraw,scope:this});OpenLayers.Control.PanZoom.prototype.destroy.apply(this,arguments);delete this.mouseDragStart;delete this.zoomStart},setMap:function(a){OpenLayers.Control.PanZoom.prototype.setMap.apply(this,
arguments);this.map.events.on({changebaselayer:this.redraw,updatesize:this.redraw,scope:this})},redraw:function(){null!=this.div&&(this.removeButtons(),this._removeZoomBar());this.draw()},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments);a=this.position.clone();this.buttons=[];var b={w:18,h:18};if(this.panIcons){var c=new OpenLayers.Pixel(a.x+b.w/2,a.y),d=b.w;this.zoomWorldIcon&&(c=new OpenLayers.Pixel(a.x+b.w,a.y));this._addButton("panup","north-mini.png",c,b);a.y=c.y+b.h;
this._addButton("panleft","west-mini.png",a,b);this.zoomWorldIcon&&(this._addButton("zoomworld","zoom-world-mini.png",a.add(b.w,0),b),d*=2);this._addButton("panright","east-mini.png",a.add(d,0),b);this._addButton("pandown","south-mini.png",c.add(0,2*b.h),b);this._addButton("zoomin","zoom-plus-mini.png",c.add(0,3*b.h+5),b);c=this._addZoomBar(c.add(0,4*b.h+5));this._addButton("zoomout","zoom-minus-mini.png",c,b)}else this._addButton("zoomin","zoom-plus-mini.png",a,b),c=this._addZoomBar(a.add(0,b.h)),
this._addButton("zoomout","zoom-minus-mini.png",c,b),this.zoomWorldIcon&&(c=c.add(0,b.h+3),this._addButton("zoomworld","zoom-world-mini.png",c,b));return this.div},_addZoomBar:function(a){var b=OpenLayers.Util.getImageLocation("slider.png"),c=this.id+"_"+this.map.id,d=this.map.getMinZoom(),e=this.map.getNumZoomLevels()-1-this.map.getZoom(),e=OpenLayers.Util.createAlphaImageDiv(c,a.add(-1,e*this.zoomStopHeight),{w:20,h:9},b,"absolute");e.style.cursor="move";this.slider=e;this.sliderEvents=new OpenLayers.Events(this,
e,null,!0,{includeXY:!0});this.sliderEvents.on({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp});var f={w:this.zoomStopWidth,h:this.zoomStopHeight*(this.map.getNumZoomLevels()-d)},b=OpenLayers.Util.getImageLocation("zoombar.png"),c=null;OpenLayers.Util.alphaHack()?(c=this.id+"_"+this.map.id,c=OpenLayers.Util.createAlphaImageDiv(c,a,{w:f.w,h:this.zoomStopHeight},b,"absolute",null,"crop"),c.style.height=
f.h+"px"):c=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+this.map.id,a,f,b);c.style.cursor="pointer";c.className="olButton";this.zoombarDiv=c;this.div.appendChild(c);this.startTop=parseInt(c.style.top);this.div.appendChild(e);this.map.events.register("zoomend",this,this.moveZoomBar);return a=a.add(0,this.zoomStopHeight*(this.map.getNumZoomLevels()-d))},_removeZoomBar:function(){this.sliderEvents.un({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,
mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp});this.sliderEvents.destroy();this.div.removeChild(this.zoombarDiv);this.zoombarDiv=null;this.div.removeChild(this.slider);this.slider=null;this.map.events.unregister("zoomend",this,this.moveZoomBar)},onButtonClick:function(a){OpenLayers.Control.PanZoom.prototype.onButtonClick.apply(this,arguments);if(a.buttonElement===this.zoombarDiv){var b=a.buttonXY.y/this.zoomStopHeight;if(this.forceFixedZoomLevel||!this.map.fractionalZoom)b=
Math.floor(b);b=this.map.getNumZoomLevels()-1-b;b=Math.min(Math.max(b,0),this.map.getNumZoomLevels()-1);this.map.zoomTo(b)}},passEventToSlider:function(a){this.sliderEvents.handleBrowserEvent(a)},zoomBarDown:function(a){if(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))this.map.events.on({touchmove:this.passEventToSlider,mousemove:this.passEventToSlider,mouseup:this.passEventToSlider,scope:this}),this.mouseDragStart=a.xy.clone(),this.zoomStart=a.xy.clone(),this.div.style.cursor=
"move",this.zoombarDiv.offsets=null,OpenLayers.Event.stop(a)},zoomBarDrag:function(a){if(null!=this.mouseDragStart){var b=this.mouseDragStart.y-a.xy.y,c=OpenLayers.Util.pagePosition(this.zoombarDiv);0<a.clientY-c[1]&&a.clientY-c[1]<parseInt(this.zoombarDiv.style.height)-2&&(b=parseInt(this.slider.style.top)-b,this.slider.style.top=b+"px",this.mouseDragStart=a.xy.clone());this.deltaY=this.zoomStart.y-a.xy.y;OpenLayers.Event.stop(a)}},zoomBarUp:function(a){if((OpenLayers.Event.isLeftClick(a)||"touchend"===
a.type)&&this.mouseDragStart){this.div.style.cursor="";this.map.events.un({touchmove:this.passEventToSlider,mouseup:this.passEventToSlider,mousemove:this.passEventToSlider,scope:this});var b=this.map.zoom;!this.forceFixedZoomLevel&&this.map.fractionalZoom?(b+=this.deltaY/this.zoomStopHeight,b=Math.min(Math.max(b,0),this.map.getNumZoomLevels()-1)):(b+=this.deltaY/this.zoomStopHeight,b=Math.max(Math.round(b),0));this.map.zoomTo(b);this.zoomStart=this.mouseDragStart=null;this.deltaY=0;OpenLayers.Event.stop(a)}},
moveZoomBar:function(){var a=(this.map.getNumZoomLevels()-1-this.map.getZoom())*this.zoomStopHeight+this.startTop+1;this.slider.style.top=a+"px"},CLASS_NAME:"OpenLayers.Control.PanZoomBar"});OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WFSCapabilities"});OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wfs:"http://www.opengis.net/wfs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},errorProperty:"featureTypeList",defaultPrefix:"wfs",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{wfs:{WFS_Capabilities:function(a,
b){this.readChildNodes(a,b)},FeatureTypeList:function(a,b){b.featureTypeList={featureTypes:[]};this.readChildNodes(a,b.featureTypeList)},FeatureType:function(a,b){var c={};this.readChildNodes(a,c);b.featureTypes.push(c)},Name:function(a,b){var c=this.getChildValue(a);c&&(c=c.split(":"),b.name=c.pop(),0<c.length&&(b.featureNS=this.lookupNamespaceURI(a,c[0])))},Title:function(a,b){var c=this.getChildValue(a);c&&(b.title=c)},Abstract:function(a,b){var c=this.getChildValue(a);c&&(b["abstract"]=c)}}},
CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"});OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},readers:{wfs:OpenLayers.Util.applyDefaults({DefaultSRS:function(a,b){var c=this.getChildValue(a);c&&(b.srs=c)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs),ows:OpenLayers.Format.OWSCommon.v1.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"});OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!0,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(a,b,c,d,e){this.url=b;this.maxExtent=this.extent=c;this.size=d;OpenLayers.Layer.prototype.initialize.apply(this,[a,e]);this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){this.tile&&(this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null);OpenLayers.Layer.prototype.destroy.apply(this,
arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions()));return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setMap:function(a){null==this.options.maxResolution&&(this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w);OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=null==this.tile;if(b||d){this.setTileSize();
var e=this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});d?(this.tile=new OpenLayers.Tile.Image(this,e,this.extent,null,this.tileSize),this.addTileMonitoringHooks(this.tile)):(this.tile.size=this.tileSize.clone(),this.tile.position=e.clone());this.tile.draw()}},setTileSize:function(){var a=this.extent.getWidth()/this.map.getResolution(),b=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(a,b)},addTileMonitoringHooks:function(a){a.onLoadStart=
function(){this.events.triggerEvent("loadstart")};a.events.register("loadstart",this,a.onLoadStart);a.onLoadEnd=function(){this.events.triggerEvent("loadend")};a.events.register("loadend",this,a.onLoadEnd);a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})},setUrl:function(a){this.url=a;this.tile.draw()},getURL:function(a){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"});OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a;this.active=!1},destroy:function(){this.deactivate();this.options=this.layer=null},setLayer:function(a){this.layer=a},activate:function(){return this.active?!1:this.active=!0},deactivate:function(){return this.active?(this.active=!1,!0):!1},CLASS_NAME:"OpenLayers.Strategy"});OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{events:null,auto:!1,timer:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a]);this.events=new OpenLayers.Events(this)},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a&&this.auto)if("number"===typeof this.auto)this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),1E3*this.auto);else this.layer.events.on({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,
scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.auto&&("number"===typeof this.auto?window.clearInterval(this.timer):this.layer.events.un({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this}));return a},triggerSave:function(a){var b=a.feature;b.state!==OpenLayers.State.INSERT&&b.state!==OpenLayers.State.UPDATE&&b.state!==OpenLayers.State.DELETE||this.save([a.feature])},save:function(a){a||(a=this.layer.features);
this.events.triggerEvent("start",{features:a});var b=this.layer.projection,c=this.layer.map.getProjectionObject();if(!c.equals(b)){for(var d=a.length,e=Array(d),f,g,h=0;h<d;++h)f=a[h],g=f.clone(),g.fid=f.fid,g.state=f.state,f.url&&(g.url=f.url),g._original=f,g.geometry.transform(c,b),e[h]=g;a=e}this.layer.protocol.commit(a,{callback:this.onCommit,scope:this})},onCommit:function(a){var b={response:a};if(a.success()){for(var c=a.reqFeatures,d,e=[],f=a.insertIds||[],g=0,h=0,k=c.length;h<k;++h)if(d=c[h],
d=d._original||d,a=d.state)a==OpenLayers.State.DELETE?e.push(d):a==OpenLayers.State.INSERT&&(d.fid=f[g],++g),d.state=null;0<e.length&&this.layer.destroyFeatures(e);this.events.triggerEvent("success",b)}else this.events.triggerEvent("fail",b)},CLASS_NAME:"OpenLayers.Strategy.Save"});OpenLayers.Events.featureclick=OpenLayers.Class({cache:null,map:null,provides:["featureclick","nofeatureclick","featureover","featureout"],initialize:function(a){this.target=a;if(a.object instanceof OpenLayers.Map)this.setMap(a.object);else if(a.object instanceof OpenLayers.Layer.Vector)a.object.map?this.setMap(a.object.map):a.object.events.register("added",this,function(b){this.setMap(a.object.map)});else throw"Listeners for '"+this.provides.join("', '")+"' events can only be registered for OpenLayers.Layer.Vector or OpenLayers.Map instances";
for(var b=this.provides.length-1;0<=b;--b)a.extensions[this.provides[b]]=!0},setMap:function(a){this.map=a;this.cache={};a.events.register("mousedown",this,this.start,{extension:!0});a.events.register("mouseup",this,this.onClick,{extension:!0});a.events.register("touchstart",this,this.start,{extension:!0});a.events.register("touchmove",this,this.cancel,{extension:!0});a.events.register("touchend",this,this.onClick,{extension:!0});a.events.register("mousemove",this,this.onMousemove,{extension:!0})},
start:function(a){this.startEvt=a},cancel:function(a){delete this.startEvt},onClick:function(a){if(this.startEvt&&("touchend"===a.type||OpenLayers.Event.isLeftClick(a))){a=this.getFeatures(this.startEvt);delete this.startEvt;for(var b,c,d={},e=0,f=a.length;e<f&&(b=a[e],c=b.layer,d[c.id]=!0,b=this.triggerEvent("featureclick",{feature:b}),!1!==b);++e);e=0;for(f=this.map.layers.length;e<f;++e)c=this.map.layers[e],c instanceof OpenLayers.Layer.Vector&&!d[c.id]&&this.triggerEvent("nofeatureclick",{layer:c})}},
onMousemove:function(a){delete this.startEvt;var b=this.getFeatures(a),c={};a=[];for(var d,e=0,f=b.length;e<f;++e)d=b[e],c[d.id]=d,this.cache[d.id]||a.push(d);var b=[],g;for(g in this.cache)d=this.cache[g],d.layer&&d.layer.map?c[d.id]||b.push(d):delete this.cache[g];e=0;for(f=a.length;e<f&&(d=a[e],this.cache[d.id]=d,g=this.triggerEvent("featureover",{feature:d}),!1!==g);++e);e=0;for(f=b.length;e<f&&(d=b[e],delete this.cache[d.id],g=this.triggerEvent("featureout",{feature:d}),!1!==g);++e);},triggerEvent:function(a,
b){var c=b.feature?b.feature.layer:b.layer,d=this.target.object;if(d instanceof OpenLayers.Map||d===c)return this.target.triggerEvent(a,b)},getFeatures:function(a){var b=a.clientX,c=a.clientY,d=[],e=[],f=[],g,h,k,l;for(l=this.map.layers.length-1;0<=l;--l)if(g=this.map.layers[l],"none"!==g.div.style.display)if(g.renderer instanceof OpenLayers.Renderer.Elements){if(g instanceof OpenLayers.Layer.Vector)for(h=document.elementFromPoint(b,c);h&&h._featureId;)(k=g.getFeatureById(h._featureId))?(d.push(k),
h.style.display="none",e.push(h),h=document.elementFromPoint(b,c)):h=!1;f.push(g);g.div.style.display="none"}else g.renderer instanceof OpenLayers.Renderer.Canvas&&(k=g.renderer.getFeatureIdFromEvent(a))&&(d.push(k),f.push(g));l=0;for(a=e.length;l<a;++l)e[l].style.display="";for(l=f.length-1;0<=l;--l)f[l].div.style.display="block";return d},destroy:function(){for(var a=this.provides.length-1;0<=a;--a)delete this.target.extensions[this.provides[a]];this.map.events.un({mousemove:this.onMousemove,mousedown:this.start,
mouseup:this.onClick,touchstart:this.start,touchmove:this.cancel,touchend:this.onClick,scope:this});delete this.cache;delete this.map;delete this.target}});OpenLayers.Events.nofeatureclick=OpenLayers.Events.featureclick;OpenLayers.Events.featureover=OpenLayers.Events.featureclick;OpenLayers.Events.featureout=OpenLayers.Events.featureclick;OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{defaultDesc:"No description available",extractWaypoints:!0,extractTracks:!0,extractRoutes:!0,extractAttributes:!0,namespaces:{gpx:"http://www.topografix.com/GPX/1/1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",creator:"OpenLayers",initialize:function(a){this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,
[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=[];if(this.extractTracks)for(var c=a.getElementsByTagName("trk"),d=0,e=c.length;d<e;d++){var f={};this.extractAttributes&&(f=this.parseAttributes(c[d]));for(var g=this.getElementsByTagNameNS(c[d],c[d].namespaceURI,"trkseg"),h=0,k=g.length;h<k;h++){var l=this.extractSegment(g[h],"trkpt");b.push(new OpenLayers.Feature.Vector(l,f))}}if(this.extractRoutes)for(e=a.getElementsByTagName("rte"),c=0,d=
e.length;c<d;c++)f={},this.extractAttributes&&(f=this.parseAttributes(e[c])),g=this.extractSegment(e[c],"rtept"),b.push(new OpenLayers.Feature.Vector(g,f));if(this.extractWaypoints)for(a=a.getElementsByTagName("wpt"),c=0,e=a.length;c<e;c++)f={},this.extractAttributes&&(f=this.parseAttributes(a[c])),d=new OpenLayers.Geometry.Point(a[c].getAttribute("lon"),a[c].getAttribute("lat")),b.push(new OpenLayers.Feature.Vector(d,f));if(this.internalProjection&&this.externalProjection)for(f=0,a=b.length;f<a;f++)b[f].geometry.transform(this.externalProjection,
this.internalProjection);return b},extractSegment:function(a,b){for(var c=this.getElementsByTagNameNS(a,a.namespaceURI,b),d=[],e=0,f=c.length;e<f;e++)d.push(new OpenLayers.Geometry.Point(c[e].getAttribute("lon"),c[e].getAttribute("lat")));return new OpenLayers.Geometry.LineString(d)},parseAttributes:function(a){var b={};a=a.firstChild;for(var c,d;a;)1==a.nodeType&&a.firstChild&&(c=a.firstChild,3==c.nodeType||4==c.nodeType)&&(d=a.prefix?a.nodeName.split(":")[1]:a.nodeName,"trkseg"!=d&&"rtept"!=d&&
(b[d]=c.nodeValue)),a=a.nextSibling;return b},write:function(a,b){a=OpenLayers.Util.isArray(a)?a:[a];var c=this.createElementNS(this.namespaces.gpx,"gpx");c.setAttribute("version","1.1");c.setAttribute("creator",this.creator);this.setAttributes(c,{"xsi:schemaLocation":this.schemaLocation});b&&"object"==typeof b&&c.appendChild(this.buildMetadataNode(b));for(var d=0,e=a.length;d<e;d++)c.appendChild(this.buildFeatureNode(a[d]));return OpenLayers.Format.XML.prototype.write.apply(this,[c])},buildMetadataNode:function(a){for(var b=
["name","desc","author"],c=this.createElementNS(this.namespaces.gpx,"metadata"),d=0;d<b.length;d++){var e=b[d];if(a[e]){var f=this.createElementNS(this.namespaces.gpx,e);f.appendChild(this.createTextNode(a[e]));c.appendChild(f)}}return c},buildFeatureNode:function(a){var b=a.geometry,b=b.clone();this.internalProjection&&this.externalProjection&&b.transform(this.internalProjection,this.externalProjection);if("OpenLayers.Geometry.Point"==b.CLASS_NAME){var c=this.buildWptNode(b);this.appendAttributesNode(c,
a);return c}c=this.createElementNS(this.namespaces.gpx,"trk");this.appendAttributesNode(c,a);a=this.buildTrkSegNode(b);a=OpenLayers.Util.isArray(a)?a:[a];for(var b=0,d=a.length;b<d;b++)c.appendChild(a[b]);return c},buildTrkSegNode:function(a){var b,c,d,e;if("OpenLayers.Geometry.LineString"==a.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==a.CLASS_NAME){b=this.createElementNS(this.namespaces.gpx,"trkseg");c=0;for(d=a.components.length;c<d;c++)e=a.components[c],b.appendChild(this.buildTrkPtNode(e));
return b}b=[];c=0;for(d=a.components.length;c<d;c++)b.push(this.buildTrkSegNode(a.components[c]));return b},buildTrkPtNode:function(a){var b=this.createElementNS(this.namespaces.gpx,"trkpt");b.setAttribute("lon",a.x);b.setAttribute("lat",a.y);return b},buildWptNode:function(a){var b=this.createElementNS(this.namespaces.gpx,"wpt");b.setAttribute("lon",a.x);b.setAttribute("lat",a.y);return b},appendAttributesNode:function(a,b){var c=this.createElementNS(this.namespaces.gpx,"name");c.appendChild(this.createTextNode(b.attributes.name||
b.id));a.appendChild(c);c=this.createElementNS(this.namespaces.gpx,"desc");c.appendChild(this.createTextNode(b.attributes.description||this.defaultDesc));a.appendChild(c)},CLASS_NAME:"OpenLayers.Format.GPX"});OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer"});OpenLayers.Format.WMSDescribeLayer.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(a){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var b=a.documentElement.childNodes,c={layerDescriptions:[]},d,e,f=0;f<b.length;++f)if(d=b[f],e=d.nodeName,"LayerDescription"==e){e=d.getAttribute("name");var g="",h="",k="";d.getAttribute("owsType")?(g=d.getAttribute("owsType"),
h=d.getAttribute("owsURL")):""!=d.getAttribute("wfs")?(g="WFS",h=d.getAttribute("wfs")):""!=d.getAttribute("wcs")&&(g="WCS",h=d.getAttribute("wcs"));d=d.getElementsByTagName("Query");0<d.length&&((k=d[0].getAttribute("typeName"))||(k=d[0].getAttribute("typename")));d={layerName:e,owsType:g,owsURL:h,typeName:k};c.layerDescriptions.push(d);c.length=c.layerDescriptions.length;c[c.length-1]=d}else if("ServiceException"==e)return{error:(new OpenLayers.Format.OGCExceptionReport).read(a)};return c},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer.v1_1_1"});
OpenLayers.Format.WMSDescribeLayer.v1_1_0=OpenLayers.Format.WMSDescribeLayer.v1_1_1;OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,zoomOffset:0,serverResolutions:null,initialize:function(a,b,c){if(c&&c.sphericalMercator||this.sphericalMercator)c=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a||this.name,b||this.url,{},c])},clone:function(a){null==a&&(a=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getURL:function(a){a=this.getXYZ(a);var b=this.url;OpenLayers.Util.isArray(b)&&(b=this.selectUrl(""+a.x+a.y+a.z,b));return OpenLayers.String.format(b,a)},getXYZ:function(a){var b=this.getServerResolution(),c=Math.round((a.left-this.maxExtent.left)/(b*this.tileSize.w));a=Math.round((this.maxExtent.top-a.top)/(b*this.tileSize.h));b=this.getServerZoom();if(this.wrapDateLine)var d=Math.pow(2,b),c=(c%d+d)%d;return{x:c,y:a,z:b}},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,
arguments);this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.XYZ"});OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],attribution:"&copy; <a href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors",sphericalMercator:!0,wrapDateLine:!0,tileOptions:null,initialize:function(a,b,c){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);this.tileOptions=
OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options&&this.options.tileOptions)},clone:function(a){null==a&&(a=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},CLASS_NAME:"OpenLayers.Layer.OSM"});OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(a,b){this.container=OpenLayers.Util.getElement(a);OpenLayers.Util.extend(this,b)},destroy:function(){this.map=this.resolution=this.size=this.extent=this.container=null},supported:function(){return!1},setExtent:function(a,b){this.extent=a.clone();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var c=a.getWidth()/this.map.getExtent().getWidth();
a=a.scale(1/c);this.extent=a.wrapDateLine(this.map.getMaxExtent()).scale(c)}b&&(this.resolution=null);return!0},setSize:function(a){this.size=a.clone();this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution()},drawFeature:function(a,b){null==b&&(b=a.style);if(a.geometry){var c=a.geometry.getBounds();if(c){var d;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(d=this.map.getMaxExtent());c.intersectsBounds(this.extent,{worldBounds:d})?this.calculateFeatureDx(c,
d):b={display:"none"};c=this.drawGeometry(a.geometry,b,a.id);if("none"!=b.display&&b.label&&!1!==c){d=a.geometry.getCentroid();if(b.labelXOffset||b.labelYOffset){var e=isNaN(b.labelXOffset)?0:b.labelXOffset,f=isNaN(b.labelYOffset)?0:b.labelYOffset,g=this.getResolution();d.move(e*g,f*g)}this.drawText(a.id,b,d)}else this.removeText(a.id);return c}}},calculateFeatureDx:function(a,b){this.featureDx=0;if(b){var c=b.getWidth();this.featureDx=Math.round(((a.left+a.right)/2-(this.extent.left+this.extent.right)/
2)/c)*c}},drawGeometry:function(a,b,c){},drawText:function(a,b,c){},removeText:function(a){},clear:function(){},getFeatureIdFromEvent:function(a){},eraseFeatures:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0,c=a.length;b<c;++b){var d=a[b];this.eraseGeometry(d.geometry,d.id);this.removeText(d.id)}},eraseGeometry:function(a,b){},moveRoot:function(a){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(a){var b=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);
!1===a.stroke&&(delete b.strokeWidth,delete b.strokeColor);!1===a.fill&&delete b.fillColor;OpenLayers.Util.extend(b,a);return b},CLASS_NAME:"OpenLayers.Renderer"});OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"};
OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]};OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(a,b){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement("canvas");this.container.appendChild(this.root);this.canvas=this.root.getContext("2d");this.features={};this.hitDetection&&(this.hitCanvas=document.createElement("canvas"),this.hitContext=this.hitCanvas.getContext("2d"))},
setExtent:function(){OpenLayers.Renderer.prototype.setExtent.apply(this,arguments);return!1},eraseGeometry:function(a,b){this.eraseFeatures(this.features[b][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(a){this.size=a.clone();var b=this.root;b.style.width=a.w+"px";b.style.height=a.h+"px";b.width=a.w;b.height=a.h;this.resolution=null;this.hitDetection&&(b=this.hitCanvas,b.style.width=a.w+"px",b.style.height=a.h+"px",b.width=a.w,b.height=a.h)},drawFeature:function(a,
b){var c;if(a.geometry){b=this.applyDefaultSymbolizer(b||a.style);c=a.geometry.getBounds();var d;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(d=this.map.getMaxExtent());d=c&&c.intersectsBounds(this.extent,{worldBounds:d});(c="none"!==b.display&&!!c&&d)?this.features[a.id]=[a,b]:delete this.features[a.id];this.pendingRedraw=!0}this.pendingRedraw&&!this.locked&&(this.redraw(),this.pendingRedraw=!1);return c},drawGeometry:function(a,b,c){var d=a.CLASS_NAME;if("OpenLayers.Geometry.Collection"==
d||"OpenLayers.Geometry.MultiPoint"==d||"OpenLayers.Geometry.MultiLineString"==d||"OpenLayers.Geometry.MultiPolygon"==d)for(d=0;d<a.components.length;d++)this.drawGeometry(a.components[d],b,c);else switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":this.drawPoint(a,b,c);break;case "OpenLayers.Geometry.LineString":this.drawLineString(a,b,c);break;case "OpenLayers.Geometry.LinearRing":this.drawLinearRing(a,b,c);break;case "OpenLayers.Geometry.Polygon":this.drawPolygon(a,b,c)}},drawExternalGraphic:function(a,
b,c){var d=new Image,e=b.title||b.graphicTitle;e&&(d.title=e);var f=b.graphicWidth||b.graphicHeight,g=b.graphicHeight||b.graphicWidth,f=f?f:2*b.pointRadius,g=g?g:2*b.pointRadius,h=void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*f),k=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*g),l=b.graphicOpacity||b.fillOpacity;d.onload=OpenLayers.Function.bind(function(){if(this.features[c]){var b=this.getLocalXY(a),e=b[0],b=b[1];if(!isNaN(e)&&!isNaN(b)){var e=e+h|0,b=b+k|0,p=this.canvas;p.globalAlpha=l;var q=
OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);p.drawImage(d,e*q,b*q,f*q,g*q);this.hitDetection&&(this.setHitContextStyle("fill",c),this.hitContext.fillRect(e,b,f,g))}}},this);d.src=b.externalGraphic},drawNamedSymbol:function(a,b,c){var d,e,f,g;f=Math.PI/180;var h=OpenLayers.Renderer.symbol[b.graphicName];if(!h)throw Error(b.graphicName+" is not a valid symbol name");
if(!(!h.length||2>h.length||(a=this.getLocalXY(a),e=a[0],g=a[1],isNaN(e)||isNaN(g)))){this.canvas.lineCap="round";this.canvas.lineJoin="round";this.hitDetection&&(this.hitContext.lineCap="round",this.hitContext.lineJoin="round");if(b.graphicName in this.cachedSymbolBounds)d=this.cachedSymbolBounds[b.graphicName];else{d=new OpenLayers.Bounds;for(a=0;a<h.length;a+=2)d.extend(new OpenLayers.LonLat(h[a],h[a+1]));this.cachedSymbolBounds[b.graphicName]=d}this.canvas.save();this.hitDetection&&this.hitContext.save();
this.canvas.translate(e,g);this.hitDetection&&this.hitContext.translate(e,g);a=f*b.rotation;isNaN(a)||(this.canvas.rotate(a),this.hitDetection&&this.hitContext.rotate(a));f=2*b.pointRadius/Math.max(d.getWidth(),d.getHeight());this.canvas.scale(f,f);this.hitDetection&&this.hitContext.scale(f,f);a=d.getCenterLonLat().lon;d=d.getCenterLonLat().lat;this.canvas.translate(-a,-d);this.hitDetection&&this.hitContext.translate(-a,-d);g=b.strokeWidth;b.strokeWidth=g/f;if(!1!==b.fill){this.setCanvasStyle("fill",
b);this.canvas.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.canvas.lineTo(d,e);this.canvas.closePath();this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",c,b);this.hitContext.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.hitContext.lineTo(d,e);this.hitContext.closePath();this.hitContext.fill()}}if(!1!==b.stroke){this.setCanvasStyle("stroke",b);this.canvas.beginPath();for(a=0;a<h.length;a+=2)d=h[a],
e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.canvas.lineTo(d,e);this.canvas.closePath();this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",c,b,f);this.hitContext.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.hitContext.moveTo(d,e),this.hitContext.lineTo(d,e);this.hitContext.closePath();this.hitContext.stroke()}}b.strokeWidth=g;this.canvas.restore();this.hitDetection&&this.hitContext.restore();this.setCanvasStyle("reset")}},setCanvasStyle:function(a,b){"fill"===
a?(this.canvas.globalAlpha=b.fillOpacity,this.canvas.fillStyle=b.fillColor):"stroke"===a?(this.canvas.globalAlpha=b.strokeOpacity,this.canvas.strokeStyle=b.strokeColor,this.canvas.lineWidth=b.strokeWidth):(this.canvas.globalAlpha=0,this.canvas.lineWidth=1)},featureIdToHex:function(a){a=Number(a.split("_").pop())+1;16777216<=a&&(this.hitOverflow=a-16777215,a=a%16777216+1);a="000000"+a.toString(16);var b=a.length;return a="#"+a.substring(b-6,b)},setHitContextStyle:function(a,b,c,d){b=this.featureIdToHex(b);
"fill"==a?(this.hitContext.globalAlpha=1,this.hitContext.fillStyle=b):"stroke"==a?(this.hitContext.globalAlpha=1,this.hitContext.strokeStyle=b,"undefined"===typeof d?this.hitContext.lineWidth=c.strokeWidth+2:isNaN(d)||(this.hitContext.lineWidth=c.strokeWidth+2/d)):(this.hitContext.globalAlpha=0,this.hitContext.lineWidth=1)},drawPoint:function(a,b,c){if(!1!==b.graphic)if(b.externalGraphic)this.drawExternalGraphic(a,b,c);else if(b.graphicName&&"circle"!=b.graphicName)this.drawNamedSymbol(a,b,c);else{var d=
this.getLocalXY(a);a=d[0];d=d[1];if(!isNaN(a)&&!isNaN(d)){var e=2*Math.PI,f=b.pointRadius;!1!==b.fill&&(this.setCanvasStyle("fill",b),this.canvas.beginPath(),this.canvas.arc(a,d,f,0,e,!0),this.canvas.fill(),this.hitDetection&&(this.setHitContextStyle("fill",c,b),this.hitContext.beginPath(),this.hitContext.arc(a,d,f,0,e,!0),this.hitContext.fill()));!1!==b.stroke&&(this.setCanvasStyle("stroke",b),this.canvas.beginPath(),this.canvas.arc(a,d,f,0,e,!0),this.canvas.stroke(),this.hitDetection&&(this.setHitContextStyle("stroke",
c,b),this.hitContext.beginPath(),this.hitContext.arc(a,d,f,0,e,!0),this.hitContext.stroke()),this.setCanvasStyle("reset"))}}},drawLineString:function(a,b,c){b=OpenLayers.Util.applyDefaults({fill:!1},b);this.drawLinearRing(a,b,c)},drawLinearRing:function(a,b,c){!1!==b.fill&&(this.setCanvasStyle("fill",b),this.renderPath(this.canvas,a,b,c,"fill"),this.hitDetection&&(this.setHitContextStyle("fill",c,b),this.renderPath(this.hitContext,a,b,c,"fill")));!1!==b.stroke&&(this.setCanvasStyle("stroke",b),this.renderPath(this.canvas,
a,b,c,"stroke"),this.hitDetection&&(this.setHitContextStyle("stroke",c,b),this.renderPath(this.hitContext,a,b,c,"stroke")));this.setCanvasStyle("reset")},renderPath:function(a,b,c,d,e){b=b.components;c=b.length;a.beginPath();d=this.getLocalXY(b[0]);var f=d[1];if(!isNaN(d[0])&&!isNaN(f)){a.moveTo(d[0],d[1]);for(d=1;d<c;++d)f=this.getLocalXY(b[d]),a.lineTo(f[0],f[1]);"fill"===e?a.fill():a.stroke()}},drawPolygon:function(a,b,c){a=a.components;var d=a.length;this.drawLinearRing(a[0],b,c);for(var e=1;e<
d;++e)this.canvas.globalCompositeOperation="destination-out",this.hitDetection&&(this.hitContext.globalCompositeOperation="destination-out"),this.drawLinearRing(a[e],OpenLayers.Util.applyDefaults({stroke:!1,fillOpacity:1},b),c),this.canvas.globalCompositeOperation="source-over",this.hitDetection&&(this.hitContext.globalCompositeOperation="source-over"),this.drawLinearRing(a[e],OpenLayers.Util.applyDefaults({fill:!1},b),c)},drawText:function(a,b){var c=this.getLocalXY(a);this.setCanvasStyle("reset");
this.canvas.fillStyle=b.fontColor;this.canvas.globalAlpha=b.fontOpacity||1;var d=[b.fontStyle?b.fontStyle:"normal","normal",b.fontWeight?b.fontWeight:"normal",b.fontSize?b.fontSize:"1em",b.fontFamily?b.fontFamily:"sans-serif"].join(" "),e=b.label.split("\n"),f=e.length;if(this.canvas.fillText){this.canvas.font=d;this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[0]]||"center";this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[1]]||"middle";var g=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[1]];
null==g&&(g=-0.5);d=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;c[1]+=d*g*(f-1);for(g=0;g<f;g++)b.labelOutlineWidth&&(this.canvas.save(),this.canvas.globalAlpha=b.labelOutlineOpacity||b.fontOpacity||1,this.canvas.strokeStyle=b.labelOutlineColor,this.canvas.lineWidth=b.labelOutlineWidth,this.canvas.strokeText(e[g],c[0],c[1]+d*g+1),this.canvas.restore()),this.canvas.fillText(e[g],c[0],c[1]+d*g)}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=d;var h=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[0]];
null==h&&(h=-0.5);g=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[1]];null==g&&(g=-0.5);d=this.canvas.mozMeasureText("xx");c[1]+=d*(1+g*f);for(g=0;g<f;g++){var k=c[0]+h*this.canvas.mozMeasureText(e[g]),l=c[1]+g*d;this.canvas.translate(k,l);this.canvas.mozDrawText(e[g]);this.canvas.translate(-k,-l)}}this.setCanvasStyle("reset")},getLocalXY:function(a){var b=this.getResolution(),c=this.extent;return[(a.x-this.featureDx)/b+-c.left/b,c.top/b-a.y/b]},clear:function(){var a=this.root.height,b=this.root.width;
this.canvas.clearRect(0,0,b,a);this.features={};this.hitDetection&&this.hitContext.clearRect(0,0,b,a)},getFeatureIdFromEvent:function(a){var b;if(this.hitDetection&&"none"!==this.root.style.display&&!this.map.dragging&&(a=a.xy,a=this.hitContext.getImageData(a.x|0,a.y|0,1,1).data,255===a[3]&&(a=a[2]+256*(a[1]+256*a[0])))){a="OpenLayers_Feature_Vector_"+(a-1+this.hitOverflow);try{b=this.features[a][0]}catch(c){}}return b},eraseFeatures:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0;b<a.length;++b)delete this.features[a[b].id];
this.redraw()},redraw:function(){if(!this.locked){var a=this.root.height,b=this.root.width;this.canvas.clearRect(0,0,b,a);this.hitDetection&&this.hitContext.clearRect(0,0,b,a);var a=[],c,d,e=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent(),f;for(f in this.features)this.features.hasOwnProperty(f)&&(b=this.features[f][0],c=b.geometry,this.calculateFeatureDx(c.getBounds(),e),d=this.features[f][1],this.drawGeometry(c,d,b.id),d.label&&a.push([b,d]));b=0;for(c=a.length;b<c;++b)f=
a[b],this.drawText(f[0].geometry.getCentroid(),f[1])}},CLASS_NAME:"OpenLayers.Renderer.Canvas"});OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"};OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1};OpenLayers.Renderer.Canvas.drawImageScaleFactor=null;OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:!1,interestingTagsExclude:null,areaTags:null,initialize:function(a){var b={interestingTagsExclude:"source source_ref source:ref history attribution created_by".split(" "),areaTags:"area building leisure tourism ruins historic landuse military natural sport".split(" ")},b=OpenLayers.Util.extend(b,a),c={};for(a=0;a<b.interestingTagsExclude.length;a++)c[b.interestingTagsExclude[a]]=!0;b.interestingTagsExclude=c;c={};for(a=0;a<b.areaTags.length;a++)c[b.areaTags[a]]=
!0;b.areaTags=c;this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[b])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=this.getNodes(a),c=this.getWays(a);a=Array(c.length);for(var d=0;d<c.length;d++){for(var e=Array(c[d].nodes.length),f=this.isWayArea(c[d])?1:0,g=0;g<c[d].nodes.length;g++){var h=b[c[d].nodes[g]],k=new OpenLayers.Geometry.Point(h.lon,h.lat);k.osm_id=parseInt(c[d].nodes[g]);
e[g]=k;h.used=!0}h=null;h=f?new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(e)):new OpenLayers.Geometry.LineString(e);this.internalProjection&&this.externalProjection&&h.transform(this.externalProjection,this.internalProjection);e=new OpenLayers.Feature.Vector(h,c[d].tags);e.osm_id=parseInt(c[d].id);e.fid="way."+e.osm_id;a[d]=e}for(var l in b){h=b[l];if(!h.used||this.checkTags){c=null;if(this.checkTags){c=this.getTags(h.node,!0);if(h.used&&!c[1])continue;c=c[0]}else c=this.getTags(h.node);
e=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(h.lon,h.lat),c);this.internalProjection&&this.externalProjection&&e.geometry.transform(this.externalProjection,this.internalProjection);e.osm_id=parseInt(l);e.fid="node."+e.osm_id;a.push(e)}h.node=null}return a},getNodes:function(a){a=a.getElementsByTagName("node");for(var b={},c=0;c<a.length;c++){var d=a[c],e=d.getAttribute("id");b[e]={lat:d.getAttribute("lat"),lon:d.getAttribute("lon"),node:d}}return b},getWays:function(a){a=a.getElementsByTagName("way");
for(var b=[],c=0;c<a.length;c++){var d=a[c],e={id:d.getAttribute("id")};e.tags=this.getTags(d);d=d.getElementsByTagName("nd");e.nodes=Array(d.length);for(var f=0;f<d.length;f++)e.nodes[f]=d[f].getAttribute("ref");b.push(e)}return b},getTags:function(a,b){for(var c=a.getElementsByTagName("tag"),d={},e=!1,f=0;f<c.length;f++){var g=c[f].getAttribute("k");d[g]=c[f].getAttribute("v");b&&(this.interestingTagsExclude[g]||(e=!0))}return b?[d,e]:d},isWayArea:function(a){var b=!1,c=!1;a.nodes[0]==a.nodes[a.nodes.length-
1]&&(b=!0);if(this.checkTags)for(var d in a.tags)if(this.areaTags[d]){c=!0;break}return b&&(this.checkTags?c:!0)},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);this.osm_id=1;this.created_nodes={};var b=this.createElementNS(null,"osm");b.setAttribute("version","0.5");b.setAttribute("generator","OpenLayers "+OpenLayers.VERSION_NUMBER);for(var c=a.length-1;0<=c;c--)for(var d=this.createFeatureNodes(a[c]),e=0;e<d.length;e++)b.appendChild(d[e]);return OpenLayers.Format.XML.prototype.write.apply(this,
[b])},createFeatureNodes:function(a){var b=[],c=a.geometry.CLASS_NAME,c=c.substring(c.lastIndexOf(".")+1),c=c.toLowerCase();(c=this.createXML[c])&&(b=c.apply(this,[a]));return b},createXML:{point:function(a){var b=null,c=a.geometry?a.geometry:a;this.internalProjection&&this.externalProjection&&(c=c.clone(),c.transform(this.internalProjection,this.externalProjection));var d=!1;a.osm_id?(b=a.osm_id,this.created_nodes[b]&&(d=!0)):(b=-this.osm_id,this.osm_id++);var e=d?this.created_nodes[b]:this.createElementNS(null,
"node");this.created_nodes[b]=e;e.setAttribute("id",b);e.setAttribute("lon",c.x);e.setAttribute("lat",c.y);a.attributes&&this.serializeTags(a,e);this.setState(a,e);return d?[]:[e]},linestring:function(a){var b,c=[],d=a.geometry;a.osm_id?b=a.osm_id:(b=-this.osm_id,this.osm_id++);var e=this.createElementNS(null,"way");e.setAttribute("id",b);for(b=0;b<d.components.length;b++){var f=this.createXML.point.apply(this,[d.components[b]]);if(f.length){var f=f[0],g=f.getAttribute("id");c.push(f)}else g=d.components[b].osm_id,
f=this.created_nodes[g];this.setState(a,f);f=this.createElementNS(null,"nd");f.setAttribute("ref",g);e.appendChild(f)}this.serializeTags(a,e);c.push(e);return c},polygon:function(a){var b=OpenLayers.Util.extend({area:"yes"},a.attributes),b=new OpenLayers.Feature.Vector(a.geometry.components[0],b);b.osm_id=a.osm_id;return this.createXML.linestring.apply(this,[b])}},serializeTags:function(a,b){for(var c in a.attributes){var d=this.createElementNS(null,"tag");d.setAttribute("k",c);d.setAttribute("v",
a.attributes[c]);b.appendChild(d)}},setState:function(a,b){if(a.state){var c=null;switch(a.state){case OpenLayers.State.UPDATE:case OpenLayers.State.DELETE:c="delete"}c&&b.setAttribute("action",c)}},CLASS_NAME:"OpenLayers.Format.OSM"});OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate();this.eventListener=null;OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,
arguments)){this.observeElement=this.observeElement||document;for(var a=0,b=this.KEY_EVENTS.length;a<b;a++)OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[a],this.eventListener);return!0}return!1},deactivate:function(){var a=!1;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var a=0,b=this.KEY_EVENTS.length;a<b;a++)OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[a],this.eventListener);a=!0}return a},handleKeyEvent:function(a){this.checkModifiers(a)&&
this.callback(a.type,[a])},CLASS_NAME:"OpenLayers.Handler.Keyboard"});OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{documentDrag:!1,geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertex:null,vertices:null,virtualVertices:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:!0,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(a,b){b=b||{};this.layer=a;this.vertices=
[];this.virtualVertices=[];this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,b.vertexRenderIntent));this.virtualStyle.fillOpacity=0.3;this.virtualStyle.strokeOpacity=0.3;this.deleteCodes=[46,68];this.mode=OpenLayers.Control.ModifyFeature.RESHAPE;OpenLayers.Control.prototype.initialize.apply(this,[b]);OpenLayers.Util.isArray(this.deleteCodes)||(this.deleteCodes=[this.deleteCodes]);var c={documentDrag:this.documentDrag,stopDown:!1};this.handlers=
{keyboard:new OpenLayers.Handler.Keyboard(this,{keydown:this.handleKeypress}),drag:new OpenLayers.Handler.Drag(this,{down:function(a){this.vertex=null;(a=this.layer.getFeatureFromEvent(this.handlers.drag.evt))?this.dragStart(a):this.clickout&&(this._unselect=this.feature)},move:function(a){delete this._unselect;this.vertex&&this.dragVertex(this.vertex,a)},up:function(){this.handlers.drag.stopDown=!1;this._unselect&&(this.unselectFeature(this._unselect),delete this._unselect)},done:function(a){this.vertex&&
this.dragComplete(this.vertex)}},c)}},destroy:function(){this.map&&this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){this.moveLayerToTop();this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});return this.handlers.keyboard.activate()&&this.handlers.drag.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},
deactivate:function(){var a=!1;OpenLayers.Control.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),this.layer.removeFeatures(this.vertices,{silent:!0}),this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.vertices=[],this.handlers.drag.deactivate(),this.handlers.keyboard.deactivate(),(a=this.feature)&&(a.geometry&&a.layer)&&this.unselectFeature(a),a=!0);return a},beforeSelectFeature:function(a){return this.layer.events.triggerEvent("beforefeaturemodified",
{feature:a})},selectFeature:function(a){if(!(this.feature===a||this.geometryTypes&&-1==OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME))){!1!==this.beforeSelectFeature(a)&&(this.feature&&this.unselectFeature(this.feature),this.feature=a,this.layer.selectedFeatures.push(a),this.layer.drawFeature(a,"select"),this.modified=!1,this.resetVertices(),this.onModificationStart(this.feature));var b=a.modified;!a.geometry||b&&b.geometry||(this._originalGeometry=a.geometry.clone())}},unselectFeature:function(a){this.layer.removeFeatures(this.vertices,
{silent:!0});this.vertices=[];this.layer.destroyFeatures(this.virtualVertices,{silent:!0});this.virtualVertices=[];this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),delete this.dragHandle);this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),delete this.radiusHandle);this.layer.drawFeature(this.feature,"default");this.feature=null;OpenLayers.Util.removeItem(this.layer.selectedFeatures,a);this.onModificationEnd(a);this.layer.events.triggerEvent("afterfeaturemodified",
{feature:a,modified:this.modified});this.modified=!1},dragStart:function(a){var b="OpenLayers.Geometry.Point"==a.geometry.CLASS_NAME;this.standalone||(a._sketch||!b)&&a._sketch||(this.toggle&&this.feature===a&&(this._unselect=a),this.selectFeature(a));if(a._sketch||b)this.vertex=a,this.handlers.drag.stopDown=!0},dragVertex:function(a,b){var c=this.map.getLonLatFromViewPortPx(b),d=a.geometry;d.move(c.lon-d.x,c.lat-d.y);this.modified=!0;"OpenLayers.Geometry.Point"==this.feature.geometry.CLASS_NAME?
this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:b}):(a._index?(a.geometry.parent.addComponent(a.geometry,a._index),delete a._index,OpenLayers.Util.removeItem(this.virtualVertices,a),this.vertices.push(a)):a==this.dragHandle?(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null)):a!==this.radiusHandle&&this.layer.events.triggerEvent("vertexmodified",
{vertex:a.geometry,feature:this.feature,pixel:b}),0<this.virtualVertices.length&&(this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.layer.drawFeature(this.feature,this.standalone?void 0:"select"));this.layer.drawFeature(a)},dragComplete:function(a){this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&
this.feature.state!=OpenLayers.State.DELETE&&(this.feature.state=OpenLayers.State.UPDATE,this.modified&&this._originalGeometry)){var a=this.feature;a.modified=OpenLayers.Util.extend(a.modified,{geometry:this._originalGeometry});delete this._originalGeometry}},resetVertices:function(){0<this.vertices.length&&(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[]);0<this.virtualVertices.length&&(this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]);this.dragHandle&&
(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),this.dragHandle=null);this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null);this.feature&&"OpenLayers.Geometry.Point"!=this.feature.geometry.CLASS_NAME&&(this.mode&OpenLayers.Control.ModifyFeature.DRAG&&this.collectDragHandle(),this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&&this.collectRadiusHandle(),this.mode&OpenLayers.Control.ModifyFeature.RESHAPE&&
(this.mode&OpenLayers.Control.ModifyFeature.RESIZE||this.collectVertices()))},handleKeypress:function(a){var b=a.keyCode;this.feature&&-1!=OpenLayers.Util.indexOf(this.deleteCodes,b)&&(b=this.layer.getFeatureFromEvent(this.handlers.drag.evt))&&(-1!=OpenLayers.Util.indexOf(this.vertices,b)&&!this.handlers.drag.dragging&&b.geometry.parent)&&(b.geometry.parent.removeComponent(b.geometry),this.layer.events.triggerEvent("vertexremoved",{vertex:b.geometry,feature:this.feature,pixel:a.xy}),this.layer.drawFeature(this.feature,
this.standalone?void 0:"select"),this.modified=!0,this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature}))},collectVertices:function(){function a(c){var d,e,f;if("OpenLayers.Geometry.Point"==c.CLASS_NAME)e=new OpenLayers.Feature.Vector(c),e._sketch=!0,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e);else{f=c.components.length;"OpenLayers.Geometry.LinearRing"==c.CLASS_NAME&&(f-=1);for(d=0;d<f;++d)e=
c.components[d],"OpenLayers.Geometry.Point"==e.CLASS_NAME?(e=new OpenLayers.Feature.Vector(e),e._sketch=!0,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e)):a(e);if(b.createVertices&&"OpenLayers.Geometry.MultiPoint"!=c.CLASS_NAME)for(d=0,f=c.components.length;d<f-1;++d){e=c.components[d];var g=c.components[d+1];"OpenLayers.Geometry.Point"==e.CLASS_NAME&&"OpenLayers.Geometry.Point"==g.CLASS_NAME&&(e=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point((e.x+g.x)/2,(e.y+g.y)/2),null,b.virtualStyle),
e.geometry.parent=c,e._index=d+1,e._sketch=!0,b.virtualVertices.push(e))}}}this.vertices=[];this.virtualVertices=[];var b=this;a.call(this,this.feature.geometry);this.layer.addFeatures(this.virtualVertices,{silent:!0});this.layer.addFeatures(this.vertices,{silent:!0})},collectDragHandle:function(){var a=this.feature.geometry,b=a.getBounds().getCenterLonLat(),b=new OpenLayers.Geometry.Point(b.lon,b.lat),c=new OpenLayers.Feature.Vector(b);b.move=function(b,c){OpenLayers.Geometry.Point.prototype.move.call(this,
b,c);a.move(b,c)};c._sketch=!0;this.dragHandle=c;this.dragHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.dragHandle],{silent:!0})},collectRadiusHandle:function(){var a=this.feature.geometry,b=a.getBounds(),c=b.getCenterLonLat(),d=new OpenLayers.Geometry.Point(c.lon,c.lat),b=new OpenLayers.Geometry.Point(b.right,b.bottom),c=new OpenLayers.Feature.Vector(b),e=this.mode&OpenLayers.Control.ModifyFeature.RESIZE,f=this.mode&OpenLayers.Control.ModifyFeature.RESHAPE,g=this.mode&
OpenLayers.Control.ModifyFeature.ROTATE;b.move=function(b,c){OpenLayers.Geometry.Point.prototype.move.call(this,b,c);var l=this.x-d.x,m=this.y-d.y,n=l-b,p=m-c;if(g){var q=Math.atan2(p,n),q=Math.atan2(m,l)-q,q=q*(180/Math.PI);a.rotate(q,d)}if(e){var r;f?(m/=p,r=l/n/m):(n=Math.sqrt(n*n+p*p),m=Math.sqrt(l*l+m*m)/n);a.resize(m,d,r)}};c._sketch=!0;this.radiusHandle=c;this.radiusHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.radiusHandle],{silent:!0})},setMap:function(a){this.handlers.drag.setMap(a);
OpenLayers.Control.prototype.setMap.apply(this,arguments)},handleMapEvents:function(a){"removelayer"!=a.type&&"order"!=a.property||this.moveLayerToTop()},moveLayerToTop:function(){var a=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(a)},moveLayerBack:function(){var a=this.layer.getZIndex()-1;a>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(a):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Control.ModifyFeature"});
OpenLayers.Control.ModifyFeature.RESHAPE=1;OpenLayers.Control.ModifyFeature.RESIZE=2;OpenLayers.Control.ModifyFeature.ROTATE=4;OpenLayers.Control.ModifyFeature.DRAG=8;OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,{key:null,serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,0.5971642833948135,0.29858214169740677,0.14929107084870338,0.07464553542435169],attributionTemplate:'<span class="olBingAttribution ${type}"><div><a target="_blank" href="http://www.bing.com/maps/"><img src="${logo}" /></a></div>${copyrights}<a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a></span>',
metadata:null,protocolRegex:/^http:/i,type:"Road",culture:"en-US",metadataParams:null,tileOptions:null,protocol:~window.location.href.indexOf("http")?"":"http:",initialize:function(a){a=OpenLayers.Util.applyDefaults({sphericalMercator:!0},a);OpenLayers.Layer.XYZ.prototype.initialize.apply(this,[a.name||"Bing "+(a.type||this.type),null,a]);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options.tileOptions);this.loadMetadata()},loadMetadata:function(){this._callbackId=
"_callback_"+this.id.replace(/\./g,"_");window[this._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,this);var a=OpenLayers.Util.applyDefaults({key:this.key,jsonp:this._callbackId,include:"ImageryProviders"},this.metadataParams),a=this.protocol+"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.type+"?"+OpenLayers.Util.getParameterString(a),b=document.createElement("script");b.type="text/javascript";b.src=a;b.id=this._callbackId;document.getElementsByTagName("head")[0].appendChild(b)},
initLayer:function(){var a=this.metadata.resourceSets[0].resources[0],b=a.imageUrl.replace("{quadkey}","${quadkey}"),b=b.replace("{culture}",this.culture),b=b.replace(this.protocolRegex,this.protocol);this.url=[];for(var c=0;c<a.imageUrlSubdomains.length;++c)this.url.push(b.replace("{subdomain}",a.imageUrlSubdomains[c]));this.addOptions({maxResolution:Math.min(this.serverResolutions[a.zoomMin],this.maxResolution||Number.POSITIVE_INFINITY),numZoomLevels:Math.min(a.zoomMax+1-a.zoomMin,this.numZoomLevels)},
!0);this.isBaseLayer||this.redraw();this.updateAttribution()},getURL:function(a){if(this.url){var b=this.getXYZ(a);a=b.x;for(var c=b.y,b=b.z,d=[],e=b;0<e;--e){var f="0",g=1<<e-1;0!=(a&g)&&f++;0!=(c&g)&&(f++,f++);d.push(f)}d=d.join("");a=this.selectUrl(""+a+c+b,this.url);return OpenLayers.String.format(a,{quadkey:d})}},updateAttribution:function(){var a=this.metadata;if(a.resourceSets&&this.map&&this.map.center){var b=a.resourceSets[0].resources[0],c=this.map.getExtent().transform(this.map.getProjectionObject(),
new OpenLayers.Projection("EPSG:4326")),d=b.imageryProviders||[],e=OpenLayers.Util.indexOf(this.serverResolutions,this.getServerResolution()),b="",f,g,h,k,l,m,n;g=0;for(h=d.length;g<h;++g)for(f=d[g],k=0,l=f.coverageAreas.length;k<l;++k)n=f.coverageAreas[k],m=OpenLayers.Bounds.fromArray(n.bbox,!0),c.intersectsBounds(m)&&(e<=n.zoomMax&&e>=n.zoomMin)&&(b+=f.attribution+" ");a=a.brandLogoUri.replace(this.protocolRegex,this.protocol);this.attribution=OpenLayers.String.format(this.attributionTemplate,{type:this.type.toLowerCase(),
logo:a,copyrights:b});this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"attribution"})}},setMap:function(){OpenLayers.Layer.XYZ.prototype.setMap.apply(this,arguments);this.map.events.register("moveend",this,this.updateAttribution)},clone:function(a){null==a&&(a=new OpenLayers.Layer.Bing(this.options));return a=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},destroy:function(){this.map&&this.map.events.unregister("moveend",this,this.updateAttribution);OpenLayers.Layer.XYZ.prototype.destroy.apply(this,
arguments)},CLASS_NAME:"OpenLayers.Layer.Bing"});OpenLayers.Layer.Bing.processMetadata=function(a){this.metadata=a;this.initLayer();a=document.getElementById(this._callbackId);a.parentNode.removeChild(a);window[this._callbackId]=void 0;delete this._callbackId};OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(a,b){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(a instanceof OpenLayers.Style)this.styles["default"]=a,this.styles.select=a,this.styles.temporary=a,this.styles["delete"]=
a;else if("object"==typeof a)for(var c in a)if(a[c]instanceof OpenLayers.Style)this.styles[c]=a[c];else if("object"==typeof a[c])this.styles[c]=new OpenLayers.Style(a[c]);else{this.styles["default"]=new OpenLayers.Style(a);this.styles.select=new OpenLayers.Style(a);this.styles.temporary=new OpenLayers.Style(a);this.styles["delete"]=new OpenLayers.Style(a);break}OpenLayers.Util.extend(this,b)},destroy:function(){for(var a in this.styles)this.styles[a].destroy();this.styles=null},createSymbolizer:function(a,
b){a||(a=new OpenLayers.Feature.Vector);this.styles[b]||(b="default");a.renderIntent=b;var c={};this.extendDefault&&"default"!=b&&(c=this.styles["default"].createSymbolizer(a));return OpenLayers.Util.extend(c,this.styles[b].createSymbolizer(a))},addUniqueValueRules:function(a,b,c,d){var e=[],f;for(f in c)e.push(new OpenLayers.Rule({symbolizer:c[f],context:d,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:b,value:f})}));this.styles[a].addRules(e)},CLASS_NAME:"OpenLayers.StyleMap"});OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);this.renderer&&this.renderer.supported()||this.assignRenderer();this.renderer&&this.renderer.supported()||
(this.renderer=null,this.displayError());this.styleMap||(this.styleMap=new OpenLayers.StyleMap);this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies)for(var c=0,d=this.strategies.length;c<d;c++)this.strategies[c].setLayer(this)},destroy:function(){if(this.strategies){var a,b,c;b=0;for(c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoDestroy&&a.destroy();this.strategies=null}this.protocol&&(this.protocol.autoDestroy&&this.protocol.destroy(),this.protocol=
null);this.destroyFeatures();this.unrenderedFeatures=this.selectedFeatures=this.features=null;this.renderer&&this.renderer.destroy();this.drawn=this.geometryType=this.renderer=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.Vector(this.name,this.getOptions()));a=OpenLayers.Layer.prototype.clone.apply(this,[a]);for(var b=this.features,c=b.length,d=Array(c),e=0;e<c;++e)d[e]=b[e].clone();a.features=d;return a},refresh:function(a){this.calculateInRange()&&
this.visibility&&this.events.triggerEvent("refresh",a)},assignRenderer:function(){for(var a=0,b=this.renderers.length;a<b;a++){var c=this.renderers[a];if((c="function"==typeof c?c:OpenLayers.Renderer[c])&&c.prototype.supported()){this.renderer=new c(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,
arguments);if(this.renderer){this.renderer.map=this.map;var b=this.map.getSize();b.w*=this.ratio;b.h*=this.ratio;this.renderer.setSize(b)}else this.map.removeLayer(this)},afterAdd:function(){if(this.strategies){var a,b,c;b=0;for(c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoActivate&&a.activate()}},removeMap:function(a){this.drawn=!1;if(this.strategies){var b,c;b=0;for(c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoActivate&&a.deactivate()}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,
arguments);var a=this.map.getSize();a.w*=this.ratio;a.h*=this.ratio;this.renderer.setSize(a)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=!0;if(!c){this.renderer.root.style.visibility="hidden";var d=this.map.getSize(),e=d.w,d=d.h,e=e/2*this.ratio-e/2,d=d/2*this.ratio-d/2,e=e+this.map.layerContainerOriginPx.x,e=-Math.round(e),d=d+this.map.layerContainerOriginPx.y,d=-Math.round(d);this.div.style.left=e+"px";this.div.style.top=d+"px";e=this.map.getExtent().scale(this.ratio);
d=this.renderer.setExtent(e,b);this.renderer.root.style.visibility="visible";!0===OpenLayers.IS_GECKO&&(this.div.scrollLeft=this.div.scrollLeft);if(!b&&d)for(var f in this.unrenderedFeatures)e=this.unrenderedFeatures[f],this.drawFeature(e)}if(!this.drawn||b||!d)for(this.drawn=!0,f=0,d=this.features.length;f<d;f++)this.renderer.locked=f!==d-1,e=this.features[f],this.drawFeature(e)},display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);var b=this.div.style.display;b!=this.renderer.root.style.display&&
(this.renderer.root.style.display=b)},addFeatures:function(a,b){OpenLayers.Util.isArray(a)||(a=[a]);var c=!b||!b.silent;if(c){var d={features:a};if(!1===this.events.triggerEvent("beforefeaturesadded",d))return;a=d.features}for(var d=[],e=0,f=a.length;e<f;e++){this.renderer.locked=e!=a.length-1?!0:!1;var g=a[e];if(this.geometryType&&!(g.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME);g.layer=this;!g.style&&this.style&&
(g.style=OpenLayers.Util.extend({},this.style));if(c){if(!1===this.events.triggerEvent("beforefeatureadded",{feature:g}))continue;this.preFeatureInsert(g)}d.push(g);this.features.push(g);this.drawFeature(g);c&&(this.events.triggerEvent("featureadded",{feature:g}),this.onFeatureInsert(g))}c&&this.events.triggerEvent("featuresadded",{features:d})},removeFeatures:function(a,b){if(a&&0!==a.length){if(a===this.features)return this.removeAllFeatures(b);OpenLayers.Util.isArray(a)||(a=[a]);a===this.selectedFeatures&&
(a=a.slice());var c=!b||!b.silent;c&&this.events.triggerEvent("beforefeaturesremoved",{features:a});for(var d=a.length-1;0<=d;d--){this.renderer.locked=0!=d&&a[d-1].geometry?!0:!1;var e=a[d];delete this.unrenderedFeatures[e.id];c&&this.events.triggerEvent("beforefeatureremoved",{feature:e});this.features=OpenLayers.Util.removeItem(this.features,e);e.layer=null;e.geometry&&this.renderer.eraseFeatures(e);-1!=OpenLayers.Util.indexOf(this.selectedFeatures,e)&&OpenLayers.Util.removeItem(this.selectedFeatures,
e);c&&this.events.triggerEvent("featureremoved",{feature:e})}c&&this.events.triggerEvent("featuresremoved",{features:a})}},removeAllFeatures:function(a){a=!a||!a.silent;var b=this.features;a&&this.events.triggerEvent("beforefeaturesremoved",{features:b});for(var c,d=b.length-1;0<=d;d--)c=b[d],a&&this.events.triggerEvent("beforefeatureremoved",{feature:c}),c.layer=null,a&&this.events.triggerEvent("featureremoved",{feature:c});this.renderer.clear();this.features=[];this.unrenderedFeatures={};this.selectedFeatures=
[];a&&this.events.triggerEvent("featuresremoved",{features:b})},destroyFeatures:function(a,b){void 0==a&&(a=this.features);if(a){this.removeFeatures(a,b);for(var c=a.length-1;0<=c;c--)a[c].destroy()}},drawFeature:function(a,b){if(this.drawn){if("object"!=typeof b){b||a.state!==OpenLayers.State.DELETE||(b="delete");var c=b||a.renderIntent;(b=a.style||this.style)||(b=this.styleMap.createSymbolizer(a,c))}c=this.renderer.drawFeature(a,b);!1===c||null===c?this.unrenderedFeatures[a.id]=a:delete this.unrenderedFeatures[a.id]}},
eraseFeatures:function(a){this.renderer.eraseFeatures(a)},getFeatureFromEvent:function(a){if(!this.renderer)throw Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");var b=null;(a=this.renderer.getFeatureIdFromEvent(a))&&(b="string"===typeof a?this.getFeatureById(a):a);return b},getFeatureBy:function(a,b){for(var c=null,d=0,e=this.features.length;d<e;++d)if(this.features[d][a]==b){c=this.features[d];
break}return c},getFeatureById:function(a){return this.getFeatureBy("id",a)},getFeatureByFid:function(a){return this.getFeatureBy("fid",a)},getFeaturesByAttribute:function(a,b){var c,d,e=this.features.length,f=[];for(c=0;c<e;c++)(d=this.features[c])&&d.attributes&&d.attributes[a]===b&&f.push(d);return f},onFeatureInsert:function(a){},preFeatureInsert:function(a){},getDataExtent:function(){var a=null,b=this.features;if(b&&0<b.length)for(var c=null,d=0,e=b.length;d<e;d++)if(c=b[d].geometry)null===a&&
(a=new OpenLayers.Bounds),a.extend(c.getBounds());return a},CLASS_NAME:"OpenLayers.Layer.Vector"});OpenLayers.Layer.PointGrid=OpenLayers.Class(OpenLayers.Layer.Vector,{dx:null,dy:null,ratio:1.5,maxFeatures:250,rotation:0,origin:null,gridBounds:null,initialize:function(a){a=a||{};OpenLayers.Layer.Vector.prototype.initialize.apply(this,[a.name,a])},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);a.events.register("moveend",this,this.onMoveEnd)},removeMap:function(a){a.events.unregister("moveend",this,this.onMoveEnd);OpenLayers.Layer.Vector.prototype.removeMap.apply(this,
arguments)},setRatio:function(a){this.ratio=a;this.updateGrid(!0)},setMaxFeatures:function(a){this.maxFeatures=a;this.updateGrid(!0)},setSpacing:function(a,b){this.dx=a;this.dy=b||a;this.updateGrid(!0)},setOrigin:function(a){this.origin=a;this.updateGrid(!0)},getOrigin:function(){this.origin||(this.origin=this.map.getExtent().getCenterLonLat());return this.origin},setRotation:function(a){this.rotation=a;this.updateGrid(!0)},onMoveEnd:function(){this.updateGrid()},getViewBounds:function(){var a=this.map.getExtent();
if(this.rotation){var b=this.getOrigin(),b=new OpenLayers.Geometry.Point(b.lon,b.lat),a=a.toGeometry();a.rotate(-this.rotation,b);a=a.getBounds()}return a},updateGrid:function(a){if(a||this.invalidBounds()){var b=this.getViewBounds(),c=this.getOrigin();a=new OpenLayers.Geometry.Point(c.lon,c.lat);var d=b.getWidth(),e=b.getHeight(),f=d/e,g=Math.sqrt(this.dx*this.dy*this.maxFeatures/f),d=Math.min(d*this.ratio,g*f),e=Math.min(e*this.ratio,g),b=b.getCenterLonLat();this.gridBounds=new OpenLayers.Bounds(b.lon-
d/2,b.lat-e/2,b.lon+d/2,b.lat+e/2);for(var b=Math.floor(e/this.dy),d=Math.floor(d/this.dx),e=c.lon+this.dx*Math.ceil((this.gridBounds.left-c.lon)/this.dx),c=c.lat+this.dy*Math.ceil((this.gridBounds.bottom-c.lat)/this.dy),g=Array(b*d),h,k=0;k<d;++k)for(var f=e+k*this.dx,l=0;l<b;++l)h=c+l*this.dy,h=new OpenLayers.Geometry.Point(f,h),this.rotation&&h.rotate(this.rotation,a),g[k*b+l]=new OpenLayers.Feature.Vector(h);this.destroyFeatures(this.features,{silent:!0});this.addFeatures(g,{silent:!0})}},invalidBounds:function(){return!this.gridBounds||
!this.gridBounds.containsBounds(this.getViewBounds())},CLASS_NAME:"OpenLayers.Layer.PointGrid"});OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,interval:0,maxDelta:Number.POSITIVE_INFINITY,delta:0,cumulative:!0,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(a){if(this.map&&this.checkModifiers(a)){for(var b=
!1,c=!1,d=!1,e=OpenLayers.Event.element(a);null!=e&&!d&&!b;){if(!b)try{var f,b=(f=e.currentStyle?e.currentStyle.overflow:document.defaultView.getComputedStyle(e,null).getPropertyValue("overflow"))&&"auto"==f||"scroll"==f}catch(g){}if(!c&&(c=OpenLayers.Element.hasClass(e,"olScrollable"),!c))for(var d=0,h=this.map.layers.length;d<h;d++){var k=this.map.layers[d];if(e==k.div||e==k.pane){c=!0;break}}d=e==this.map.div;e=e.parentNode}if(!b&&d){if(c)if(b=0,a.wheelDelta?(b=a.wheelDelta,0===b%160&&(b*=0.75),
b/=120):a.detail&&(b=-(a.detail/Math.abs(a.detail))),this.delta+=b,window.clearTimeout(this._timeoutId),this.interval&&Math.abs(this.delta)<this.maxDelta){var l=OpenLayers.Util.extend({},a);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(l)},this),this.interval)}else this.wheelZoom(a);OpenLayers.Event.stop(a)}}},wheelZoom:function(a){var b=this.delta;this.delta=0;b&&(a.xy=this.map.events.getMousePosition(a),0>b?this.callback("down",[a,this.cumulative?Math.max(-this.maxDelta,
b):-1]):this.callback("up",[a,this.cumulative?Math.min(this.maxDelta,b):1]))},activate:function(a){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",b);OpenLayers.Event.observe(window,"mousewheel",b);OpenLayers.Event.observe(document,"mousewheel",b);return!0}return!1},deactivate:function(a){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.stopObserving(window,
"DOMMouseScroll",b);OpenLayers.Event.stopObserving(window,"mousewheel",b);OpenLayers.Event.stopObserving(document,"mousewheel",b);return!0}return!1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});OpenLayers.Symbolizer=OpenLayers.Class({zIndex:0,initialize:function(a){OpenLayers.Util.extend(this,a)},clone:function(){return new (eval(this.CLASS_NAME))(OpenLayers.Util.extend({},this))},CLASS_NAME:"OpenLayers.Symbolizer"});OpenLayers.Symbolizer.Raster=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Raster"});OpenLayers.Rule=OpenLayers.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:!1,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(a){this.symbolizer={};OpenLayers.Util.extend(this,a);this.symbolizers&&delete this.symbolizer;this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a in this.symbolizer)this.symbolizer[a]=null;this.symbolizer=null;delete this.symbolizers},evaluate:function(a){var b=
this.getContext(a),c=!0;if(this.minScaleDenominator||this.maxScaleDenominator)var d=a.layer.map.getScale();this.minScaleDenominator&&(c=d>=OpenLayers.Style.createLiteral(this.minScaleDenominator,b));c&&this.maxScaleDenominator&&(c=d<OpenLayers.Style.createLiteral(this.maxScaleDenominator,b));c&&this.filter&&(c="OpenLayers.Filter.FeatureId"==this.filter.CLASS_NAME?this.filter.evaluate(a):this.filter.evaluate(b));return c},getContext:function(a){var b=this.context;b||(b=a.attributes||a.data);"function"==
typeof this.context&&(b=this.context(a));return b},clone:function(){var a=OpenLayers.Util.extend({},this);if(this.symbolizers){var b=this.symbolizers.length;a.symbolizers=Array(b);for(var c=0;c<b;++c)a.symbolizers[c]=this.symbolizers[c].clone()}else{a.symbolizer={};for(var d in this.symbolizer)b=this.symbolizer[d],c=typeof b,"object"===c?a.symbolizer[d]=OpenLayers.Util.extend({},b):"string"===c&&(a.symbolizer[d]=b)}a.filter=this.filter&&this.filter.clone();a.context=this.context&&OpenLayers.Util.extend({},
this.context);return new OpenLayers.Rule(a)},CLASS_NAME:"OpenLayers.Rule"});OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{profile:null,defaultVersion:"1.0.0",stringifyOutput:!0,namedLayersAsArray:!1,CLASS_NAME:"OpenLayers.Format.SLD"});OpenLayers.Symbolizer.Polygon=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Polygon"});OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(a,b){var c={};this.readChildNodes(a,c);b.outer=c.components[0]},innerBoundaryIs:function(a,b){var c={};this.readChildNodes(a,c);b.inner.push(c.components[0])},Box:function(a,b){var c=
{};this.readChildNodes(a,c);b.components||(b.components=[]);var d=c.points[0],c=c.points[1];b.components.push(new OpenLayers.Bounds(d.x,d.y,c.x,c.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){var b;b=OpenLayers.Util.isArray(a)?"wfs:FeatureCollection":"gml:featureMember";a=this.writeNode(b,a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);
return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(a){var b=this.createElementNSPlus("gml:Point");this.writeNode("coordinates",[a],b);return b},coordinates:function(a){for(var b=a.length,c=Array(b),d,e=0;e<b;++e)d=a[e],c[e]=this.xy?d.x+","+d.y:d.y+","+d.x,void 0!=d.z&&(c[e]+=","+d.z);return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:1==b?c[0]:c.join(" ")})},LineString:function(a){var b=
this.createElementNSPlus("gml:LineString");this.writeNode("coordinates",a.components,b);return b},Polygon:function(a){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",a.components[0],b);for(var c=1;c<a.components.length;++c)this.writeNode("innerBoundaryIs",a.components[c],b);return b},outerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:outerBoundaryIs");this.writeNode("LinearRing",a,b);return b},innerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:innerBoundaryIs");
this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("coordinates",a.components,b);return b},Box:function(a){var b=this.createElementNSPlus("gml:Box");this.writeNode("coordinates",[{x:a.left,y:a.bottom},{x:a.right,y:a.top}],b);this.srsName&&b.setAttribute("srsName",this.srsName);return b}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},
CLASS_NAME:"OpenLayers.Format.GML.v2"});OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsNotEqualTo:function(a,
b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLike:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,c);var d=a.getAttribute("wildCard"),e=a.getAttribute("singleChar"),f=a.getAttribute("escape");c.value2regex(d,e,f);b.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,
feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",
{attributes:{wildCard:"*",singleChar:".",escape:"!"}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var b=this.createElementNSPlus("ogc:BBOX");a.property&&this.writeNode("PropertyName",a,b);var c=this.writeNode("gml:Box",a.value,b);a.projection&&c.setAttribute("srsName",a.projection);return b}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},
writeSpatial:function(a,b){var c=this.createElementNSPlus("ogc:"+b);this.writeNode("PropertyName",a,c);if(a.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",a.value,c);else{var d;d=a.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",a.value).firstChild:this.writeNode("gml:Box",a.value);a.projection&&d.setAttribute("srsName",a.projection);c.appendChild(d)}return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"});OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:!1,schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readNode:function(a,b,c){return OpenLayers.Format.GML.v2.prototype.readNode.apply(this,arguments)},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(a,
b){b.insertIds=[];b.success=!1;this.readChildNodes(a,b)},InsertResult:function(a,b){var c={fids:[]};this.readChildNodes(a,c);b.insertIds=b.insertIds.concat(c.fids)},TransactionResult:function(a,b){this.readChildNodes(a,b)},Status:function(a,b){this.readChildNodes(a,b)},SUCCESS:function(a,b){b.success=!0}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc},
writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(a){a=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},a);var b=a.featurePrefix,c=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(b?b+":":"")+a.featureType}});a.srsNameInQuery&&a.srsName&&c.setAttribute("srsName",a.srsName);a.featureNS&&c.setAttribute("xmlns:"+b,a.featureNS);if(a.propertyNames)for(var b=0,d=a.propertyNames.length;b<
d;b++)this.writeNode("ogc:PropertyName",{property:a.propertyNames[b]},c);a.filter&&(this.setFilterProperty(a.filter),this.writeNode("ogc:Filter",a.filter,c));return c}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"});OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(a){this.compare=a?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.clear()},insert:function(a){this.exists(a)&&this.remove(a);var b=a.id;this.determineZIndex(a);for(var c=-1,d=this.order.length,e;1<d-c;)e=parseInt((c+d)/2),0<this.compare(this,a,OpenLayers.Util.getElement(this.order[e]))?c=e:d=e;this.order.splice(d,
0,b);this.indices[b]=this.getZIndex(a);return this.getNextElement(d)},remove:function(a){a=a.id;var b=OpenLayers.Util.indexOf(this.order,a);0<=b&&(this.order.splice(b,1),delete this.indices[a],this.maxZIndex=0<this.order.length?this.indices[this.order[this.order.length-1]]:0)},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(a){return null!=this.indices[a.id]},getZIndex:function(a){return a._style.graphicZIndex},determineZIndex:function(a){var b=a._style.graphicZIndex;
null==b?(b=this.maxZIndex,a._style.graphicZIndex=b):b>this.maxZIndex&&(this.maxZIndex=b)},getNextElement:function(a){a+=1;if(a<this.order.length){var b=OpenLayers.Util.getElement(this.order[a]);void 0==b&&(b=this.getNextElement(a));return b}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"});
OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(a,b,c){b=a.getZIndex(b);var d=0;c&&(a=a.getZIndex(c),d=b-a);return d},Z_ORDER_DRAWING_ORDER:function(a,b,c){a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&&0==a&&(a=1);return a},Z_ORDER_Y_ORDER:function(a,b,c){a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&&0===a&&(b=c._boundsBottom-b._boundsBottom,a=0===b?1:b);return a}};
OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(a,b){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot);
this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);b&&(b.zIndexing||b.yOrdering)&&(this.indexer=new OpenLayers.ElementsIndexer(b.yOrdering))},destroy:function(){this.clear();this.xmlns=this.root=this.rendererRoot=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var a,b=this.vectorRoot;if(b)for(;a=b.firstChild;)b.removeChild(a);if(b=this.textRoot)for(;a=b.firstChild;)b.removeChild(a);this.indexer&&
this.indexer.clear()},setExtent:function(a,b){var c=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),d=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var e,f=a.getWidth()/this.map.getExtent().getWidth();a=a.scale(1/f);f=this.map.getMaxExtent();f.right>a.left&&f.right<a.right?e=!0:f.left>a.left&&f.left<a.right&&(e=!1);if(e!==this.rightOfDateLine||b)c=!1,this.xOffset=!0===e?f.getWidth()/d:0;this.rightOfDateLine=e}return c},getNodeType:function(a,b){},drawGeometry:function(a,
b,c){var d=a.CLASS_NAME,e=!0;if("OpenLayers.Geometry.Collection"==d||"OpenLayers.Geometry.MultiPoint"==d||"OpenLayers.Geometry.MultiLineString"==d||"OpenLayers.Geometry.MultiPolygon"==d){for(var d=0,f=a.components.length;d<f;d++)e=this.drawGeometry(a.components[d],b,c)&&e;return e}d=e=!1;"none"!=b.display&&(b.backgroundGraphic?this.redrawBackgroundNode(a.id,a,b,c):d=!0,e=this.redrawNode(a.id,a,b,c));!1==e&&(b=document.getElementById(a.id))&&(b._style.backgroundGraphic&&(d=!0),b.parentNode.removeChild(b));
d&&(b=document.getElementById(a.id+this.BACKGROUND_ID_SUFFIX))&&b.parentNode.removeChild(b);return e},redrawNode:function(a,b,c,d){c=this.applyDefaultSymbolizer(c);a=this.nodeFactory(a,this.getNodeType(b,c));a._featureId=d;a._boundsBottom=b.getBounds().bottom;a._geometryClass=b.CLASS_NAME;a._style=c;b=this.drawGeometryNode(a,b,c);if(!1===b)return!1;a=b.node;this.indexer?(c=this.indexer.insert(a))?this.vectorRoot.insertBefore(a,c):this.vectorRoot.appendChild(a):a.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(a);
this.postDraw(a);return b.complete},redrawBackgroundNode:function(a,b,c,d){c=OpenLayers.Util.extend({},c);c.externalGraphic=c.backgroundGraphic;c.graphicXOffset=c.backgroundXOffset;c.graphicYOffset=c.backgroundYOffset;c.graphicZIndex=c.backgroundGraphicZIndex;c.graphicWidth=c.backgroundWidth||c.graphicWidth;c.graphicHeight=c.backgroundHeight||c.graphicHeight;c.backgroundGraphic=null;c.backgroundXOffset=null;c.backgroundYOffset=null;c.backgroundGraphicZIndex=null;return this.redrawNode(a+this.BACKGROUND_ID_SUFFIX,
b,c,null)},drawGeometryNode:function(a,b,c){c=c||a._style;var d={isFilled:void 0===c.fill?!0:c.fill,isStroked:void 0===c.stroke?!!c.strokeWidth:c.stroke},e;switch(b.CLASS_NAME){case "OpenLayers.Geometry.Point":!1===c.graphic&&(d.isFilled=!1,d.isStroked=!1);e=this.drawPoint(a,b);break;case "OpenLayers.Geometry.LineString":d.isFilled=!1;e=this.drawLineString(a,b);break;case "OpenLayers.Geometry.LinearRing":e=this.drawLinearRing(a,b);break;case "OpenLayers.Geometry.Polygon":e=this.drawPolygon(a,b);break;
case "OpenLayers.Geometry.Rectangle":e=this.drawRectangle(a,b)}a._options=d;return!1!=e?{node:this.setStyle(a,c,d,b),complete:e}:!1},postDraw:function(a){},drawPoint:function(a,b){},drawLineString:function(a,b){},drawLinearRing:function(a,b){},drawPolygon:function(a,b){},drawRectangle:function(a,b){},drawCircle:function(a,b){},removeText:function(a){var b=document.getElementById(a+this.LABEL_ID_SUFFIX);b&&this.textRoot.removeChild(b);(a=document.getElementById(a+this.LABEL_OUTLINE_SUFFIX))&&this.textRoot.removeChild(a)},
getFeatureIdFromEvent:function(a){var b=a.target,c=b&&b.correspondingUseElement;return(c?c:b||a.srcElement)._featureId},eraseGeometry:function(a,b){if("OpenLayers.Geometry.MultiPoint"==a.CLASS_NAME||"OpenLayers.Geometry.MultiLineString"==a.CLASS_NAME||"OpenLayers.Geometry.MultiPolygon"==a.CLASS_NAME||"OpenLayers.Geometry.Collection"==a.CLASS_NAME)for(var c=0,d=a.components.length;c<d;c++)this.eraseGeometry(a.components[c],b);else(c=OpenLayers.Util.getElement(a.id))&&c.parentNode&&(c.geometry&&(c.geometry.destroy(),
c.geometry=null),c.parentNode.removeChild(c),this.indexer&&this.indexer.remove(c),c._style.backgroundGraphic&&(c=OpenLayers.Util.getElement(a.id+this.BACKGROUND_ID_SUFFIX))&&c.parentNode&&c.parentNode.removeChild(c))},nodeFactory:function(a,b){var c=OpenLayers.Util.getElement(a);c?this.nodeTypeCompare(c,b)||(c.parentNode.removeChild(c),c=this.nodeFactory(a,b)):c=this.createNode(b,a);return c},nodeTypeCompare:function(a,b){},createNode:function(a,b){},moveRoot:function(a){var b=this.root;a.root.parentNode==
this.rendererRoot&&(b=a.root);b.parentNode.removeChild(b);a.rendererRoot.appendChild(b)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(a){return"circle"!=a&&!!a},CLASS_NAME:"OpenLayers.Renderer.Elements"});OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,getParameters:function(a){a=a||window.location.href;var b=OpenLayers.Util.getParameters(a),c=a.indexOf("#");0<c&&(a="?"+a.substring(c+1,a.length),OpenLayers.Util.extend(b,OpenLayers.Util.getParameters(a)));return b},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;b<c;b++){var d=this.map.controls[b];if(d!=this&&
"OpenLayers.Control.ArgParser"==d.CLASS_NAME){d.displayProjection!=this.displayProjection&&(this.displayProjection=d.displayProjection);break}}b==this.map.controls.length&&(b=this.getParameters(),b.layers&&(this.layers=b.layers,this.map.events.register("addlayer",this,this.configureLayers),this.configureLayers()),b.lat&&b.lon&&(this.center=new OpenLayers.LonLat(parseFloat(b.lon),parseFloat(b.lat)),b.zoom&&(this.zoom=parseFloat(b.zoom)),this.map.events.register("changebaselayer",this,this.setCenter),
this.setCenter()))},setCenter:function(){this.map.baseLayer&&(this.map.events.unregister("changebaselayer",this,this.setCenter),this.displayProjection&&this.center.transform(this.displayProjection,this.map.getProjectionObject()),this.map.setCenter(this.center,this.zoom))},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var a=0,b=this.layers.length;a<b;a++){var c=this.map.layers[a],d=this.layers.charAt(a);
"B"==d?this.map.setBaseLayer(c):"T"!=d&&"F"!=d||c.setVisibility("T"==d)}}},CLASS_NAME:"OpenLayers.Control.ArgParser"});OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,anchor:!1,base:"",displayProjection:null,initialize:function(a,b,c){null===a||"object"!=typeof a||OpenLayers.Util.isElement(a)?(OpenLayers.Control.prototype.initialize.apply(this,[c]),this.element=OpenLayers.Util.getElement(a),this.base=b||document.location.href):(this.base=document.location.href,OpenLayers.Control.prototype.initialize.apply(this,[a]),null!=this.element&&(this.element=
OpenLayers.Util.getElement(this.element)))},destroy:function(){this.element&&this.element.parentNode==this.div&&(this.div.removeChild(this.element),this.element=null);this.map&&this.map.events.unregister("moveend",this,this.updateLink);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;b<c;b++){var d=this.map.controls[b];if(d.CLASS_NAME==this.argParserClass.CLASS_NAME){d.displayProjection!=
this.displayProjection&&(this.displayProjection=d.displayProjection);break}}b==this.map.controls.length&&this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.element||this.anchor||(this.element=document.createElement("a"),this.element.innerHTML=OpenLayers.i18n("Permalink"),this.element.href="",this.div.appendChild(this.element));this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink,
changebaselayer:this.updateLink,scope:this});this.updateLink();return this.div},updateLink:function(){var a=this.anchor?"#":"?",b=this.base,c=null;-1!=b.indexOf("#")&&!1==this.anchor&&(c=b.substring(b.indexOf("#"),b.length));-1!=b.indexOf(a)&&(b=b.substring(0,b.indexOf(a)));b=b.split("#")[0]+a+OpenLayers.Util.getParameterString(this.createParams());c&&(b+=c);this.anchor&&!this.element?window.location.href=b:this.element.href=b},createParams:function(a,b,c){a=a||this.map.getCenter();var d=OpenLayers.Util.getParameters(this.base);
if(a)for(d.zoom=b||this.map.getZoom(),b=a.lat,a=a.lon,this.displayProjection&&(b=OpenLayers.Projection.transform({x:a,y:b},this.map.getProjectionObject(),this.displayProjection),a=b.x,b=b.y),d.lat=Math.round(1E5*b)/1E5,d.lon=Math.round(1E5*a)/1E5,c=c||this.map.layers,d.layers="",a=0,b=c.length;a<b;a++){var e=c[a];d.layers=e.isBaseLayer?d.layers+(e==this.map.baseLayer?"B":"0"):d.layers+(e.getVisibility()?"T":"F")}return d},CLASS_NAME:"OpenLayers.Control.Permalink"});OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",layername:null,type:null,isBaseLayer:!0,tileOrigin:null,serverResolutions:null,zoomOffset:0,initialize:function(a,b,c){var d=[];d.push(a,b,{},c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,d)},clone:function(a){null==a&&(a=new OpenLayers.Layer.TMS(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){a=this.adjustBounds(a);var b=this.getServerResolution(),
c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w));a=Math.round((a.bottom-this.tileOrigin.lat)/(b*this.tileSize.h));b=this.getServerZoom();c=this.serviceVersion+"/"+this.layername+"/"+b+"/"+c+"/"+a+"."+this.type;a=this.url;OpenLayers.Util.isArray(a)&&(a=this.selectUrl(c,a));return a+c},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.TMS"});OpenLayers.Format.WCSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WCSCapabilities"});OpenLayers.Format.WCSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,splitSpace:/\s+/},defaultPrefix:"wcs",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1"});OpenLayers.Format.WCSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,{namespaces:{wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},errorProperty:"service",readers:{wcs:{WCS_Capabilities:function(a,b){this.readChildNodes(a,b)},Service:function(a,b){b.service={};this.readChildNodes(a,b.service)},name:function(a,b){b.name=this.getChildValue(a)},label:function(a,b){b.label=
this.getChildValue(a)},keywords:function(a,b){b.keywords=[];this.readChildNodes(a,b.keywords)},keyword:function(a,b){b.push(this.getChildValue(a))},responsibleParty:function(a,b){b.responsibleParty={};this.readChildNodes(a,b.responsibleParty)},individualName:function(a,b){b.individualName=this.getChildValue(a)},organisationName:function(a,b){b.organisationName=this.getChildValue(a)},positionName:function(a,b){b.positionName=this.getChildValue(a)},contactInfo:function(a,b){b.contactInfo={};this.readChildNodes(a,
b.contactInfo)},phone:function(a,b){b.phone={};this.readChildNodes(a,b.phone)},voice:function(a,b){b.voice=this.getChildValue(a)},facsimile:function(a,b){b.facsimile=this.getChildValue(a)},address:function(a,b){b.address={};this.readChildNodes(a,b.address)},deliveryPoint:function(a,b){b.deliveryPoint=this.getChildValue(a)},city:function(a,b){b.city=this.getChildValue(a)},postalCode:function(a,b){b.postalCode=this.getChildValue(a)},country:function(a,b){b.country=this.getChildValue(a)},electronicMailAddress:function(a,
b){b.electronicMailAddress=this.getChildValue(a)},fees:function(a,b){b.fees=this.getChildValue(a)},accessConstraints:function(a,b){b.accessConstraints=this.getChildValue(a)},ContentMetadata:function(a,b){b.contentMetadata=[];this.readChildNodes(a,b.contentMetadata)},CoverageOfferingBrief:function(a,b){var c={};this.readChildNodes(a,c);b.push(c)},name:function(a,b){b.name=this.getChildValue(a)},label:function(a,b){b.label=this.getChildValue(a)},lonLatEnvelope:function(a,b){var c=this.getElementsByTagNameNS(a,
"http://www.opengis.net/gml","pos");if(2==c.length){var d={},e={};OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[c[0],d]);OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[c[1],e]);b.lonLatEnvelope={};b.lonLatEnvelope.srsName=a.getAttribute("srsName");b.lonLatEnvelope.min=d.points[0];b.lonLatEnvelope.max=e.points[0]}}}},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1_0_0"});OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.apply(this,arguments);if(a)if(this.layer.events.on({refresh:this.load,scope:this}),!0==this.layer.visibility||this.preload)this.load();else this.layer.events.on({visibilitychanged:this.load,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,
scope:this});return a},load:function(a){var b=this.layer;b.events.triggerEvent("loadstart",{filter:b.filter});b.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,filter:b.filter,scope:this},a));b.events.un({visibilitychanged:this.load,scope:this})},merge:function(a){var b=this.layer;b.destroyFeatures();var c=a.features;if(c&&0<c.length){var d=b.projection,e=b.map.getProjectionObject();if(!e.equals(d))for(var f,g=0,h=c.length;g<h;++g)(f=c[g].geometry)&&f.transform(d,e);b.addFeatures(c)}b.events.triggerEvent("loadend",
{response:a})},CLASS_NAME:"OpenLayers.Strategy.Fixed"});OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"\u2212",zoomOutId:"olZoomOutLink",draw:function(){var a=OpenLayers.Control.prototype.draw.apply(this),b=this.getOrCreateLinks(a),c=b.zoomIn,b=b.zoomOut,d=this.map.events;b.parentNode!==a&&(d=this.events,d.attachToElement(b.parentNode));d.register("buttonclick",this,this.onZoomClick);this.zoomInLink=c;this.zoomOutLink=b;return a},getOrCreateLinks:function(a){var b=document.getElementById(this.zoomInId),
c=document.getElementById(this.zoomOutId);b||(b=document.createElement("a"),b.href="#zoomIn",b.appendChild(document.createTextNode(this.zoomInText)),b.className="olControlZoomIn",a.appendChild(b));OpenLayers.Element.addClass(b,"olButton");c||(c=document.createElement("a"),c.href="#zoomOut",c.appendChild(document.createTextNode(this.zoomOutText)),c.className="olControlZoomOut",a.appendChild(c));OpenLayers.Element.addClass(c,"olButton");return{zoomIn:b,zoomOut:c}},onZoomClick:function(a){a=a.buttonElement;
a===this.zoomInLink?this.map.zoomIn():a===this.zoomOutLink&&this.map.zoomOut()},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onZoomClick);delete this.zoomInLink;delete this.zoomOutLink;OpenLayers.Control.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Control.Zoom"});OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,styleFrom:null,addNodes:function(a,b){if(2>a.length)throw Error("At least two point features have to be added to create a line from");for(var c=Array(a.length-1),d,e,f,g=0,h=a.length;g<h;g++){d=a[g];f=d.geometry;if(!f)f=d.lonlat,f=new OpenLayers.Geometry.Point(f.lon,f.lat);else if("OpenLayers.Geometry.Point"!=f.CLASS_NAME)throw new TypeError("Only features with point geometries are supported.");if(0<g){d=null!=this.dataFrom?
a[g+this.dataFrom].data||a[g+this.dataFrom].attributes:null;var k=null!=this.styleFrom?a[g+this.styleFrom].style:null;e=new OpenLayers.Geometry.LineString([e,f]);c[g-1]=new OpenLayers.Feature.Vector(e,d,k)}e=f}this.addFeatures(c,b)},CLASS_NAME:"OpenLayers.Layer.PointTrack"});OpenLayers.Layer.PointTrack.SOURCE_NODE=-1;OpenLayers.Layer.PointTrack.TARGET_NODE=0;OpenLayers.Layer.PointTrack.dataFrom={SOURCE_NODE:-1,TARGET_NODE:0};OpenLayers.Protocol.WFS=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.WFS.DEFAULTS);var b=OpenLayers.Protocol.WFS["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported WFS version: "+a.version;return new b(a)};
OpenLayers.Protocol.WFS.fromWMSLayer=function(a,b){var c,d;c=a.params.LAYERS;c=(OpenLayers.Util.isArray(c)?c[0]:c).split(":");1<c.length&&(d=c[0]);c=c.pop();d={url:a.url,featureType:c,featurePrefix:d,srsName:a.projection&&a.projection.getCode()||a.map&&a.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(b,d))};OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"};OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,markers:null,drawn:!1,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);this.markers=[]},destroy:function(){this.clearMarkers();this.markers=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;a=0;for(var b=this.markers.length;a<b;a++)this.markers[a].setOpacity(this.opacity)}},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,
arguments);if(b||!this.drawn){for(var d=0,e=this.markers.length;d<e;d++)this.drawMarker(this.markers[d]);this.drawn=!0}},addMarker:function(a){this.markers.push(a);1>this.opacity&&a.setOpacity(this.opacity);this.map&&this.map.getExtent()&&(a.map=this.map,this.drawMarker(a))},removeMarker:function(a){this.markers&&this.markers.length&&(OpenLayers.Util.removeItem(this.markers,a),a.erase())},clearMarkers:function(){if(null!=this.markers)for(;0<this.markers.length;)this.removeMarker(this.markers[0])},
drawMarker:function(a){var b=this.map.getLayerPxFromLonLat(a.lonlat);null==b?a.display(!1):a.isDrawn()?a.icon&&a.icon.moveTo(b):(a=a.draw(b),this.div.appendChild(a))},getDataExtent:function(){var a=null;if(this.markers&&0<this.markers.length)for(var a=new OpenLayers.Bounds,b=0,c=this.markers.length;b<c;b++)a.extend(this.markers[b].lonlat);return a},CLASS_NAME:"OpenLayers.Layer.Markers"});OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control.Button,{slideFactor:50,slideRatio:null,direction:null,initialize:function(a,b){this.direction=a;this.CLASS_NAME+=this.direction;OpenLayers.Control.prototype.initialize.apply(this,[b])},trigger:function(){if(this.map){var a=OpenLayers.Function.bind(function(a){return this.slideRatio?this.map.getSize()[a]*this.slideRatio:this.slideFactor},this);switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,-a("h"));break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0,
a("h"));break;case OpenLayers.Control.Pan.WEST:this.map.pan(-a("w"),0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(a("w"),0)}}},CLASS_NAME:"OpenLayers.Control.Pan"});OpenLayers.Control.Pan.NORTH="North";OpenLayers.Control.Pan.SOUTH="South";OpenLayers.Control.Pan.EAST="East";OpenLayers.Control.Pan.WEST="West";OpenLayers.Format.CSWGetDomain=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetDomain.DEFAULTS);var b=OpenLayers.Format.CSWGetDomain["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSWGetDomain version: "+a.version;return new b(a)};OpenLayers.Format.CSWGetDomain.DEFAULTS={version:"2.0.2"};OpenLayers.Format.CSWGetDomain.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",PropertyName:null,ParameterName:null,read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==
a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{csw:{GetDomainResponse:function(a,b){this.readChildNodes(a,b)},DomainValues:function(a,b){OpenLayers.Util.isArray(b.DomainValues)||(b.DomainValues=[]);for(var c=a.attributes,d={},e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;this.readChildNodes(a,d);b.DomainValues.push(d)},PropertyName:function(a,b){b.PropertyName=this.getChildValue(a)},ParameterName:function(a,b){b.ParameterName=this.getChildValue(a)},ListOfValues:function(a,
b){OpenLayers.Util.isArray(b.ListOfValues)||(b.ListOfValues=[]);this.readChildNodes(a,b.ListOfValues)},Value:function(a,b){for(var c=a.attributes,d={},e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a);b.push({Value:d})},ConceptualScheme:function(a,b){b.ConceptualScheme={};this.readChildNodes(a,b.ConceptualScheme)},Name:function(a,b){b.Name=this.getChildValue(a)},Document:function(a,b){b.Document=this.getChildValue(a)},Authority:function(a,b){b.Authority=this.getChildValue(a)},
RangeOfValues:function(a,b){b.RangeOfValues={};this.readChildNodes(a,b.RangeOfValues)},MinValue:function(a,b){for(var c=a.attributes,d={},e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a);b.MinValue=d},MaxValue:function(a,b){for(var c=a.attributes,d={},e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a);b.MaxValue=d}}},write:function(a){a=this.writeNode("csw:GetDomain",a);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{csw:{GetDomain:function(a){var b=
this.createElementNSPlus("csw:GetDomain",{attributes:{service:"CSW",version:this.version}});a.PropertyName||this.PropertyName?this.writeNode("csw:PropertyName",a.PropertyName||this.PropertyName,b):(a.ParameterName||this.ParameterName)&&this.writeNode("csw:ParameterName",a.ParameterName||this.ParameterName,b);this.readChildNodes(b,a);return b},PropertyName:function(a){return this.createElementNSPlus("csw:PropertyName",{value:a})},ParameterName:function(a){return this.createElementNSPlus("csw:ParameterName",
{value:a})}}},CLASS_NAME:"OpenLayers.Format.CSWGetDomain.v2_0_2"});OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{read:function(a){return(new OpenLayers.Format.ArcXML).read(a).features.feature}});OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,{DEFAULTS:{tolerance:10,node:!0,edge:!0,vertex:!0},greedy:!0,precedence:["node","vertex","edge"],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.options=a||{};this.options.layer&&this.setLayer(this.options.layer);a=OpenLayers.Util.extend({},this.options.defaults);this.defaults=OpenLayers.Util.applyDefaults(a,this.DEFAULTS);this.setTargets(this.options.targets);
0===this.targets.length&&this.layer&&this.addTargetLayer(this.layer);this.geoToleranceCache={}},setLayer:function(a){this.active?(this.deactivate(),this.layer=a,this.activate()):this.layer=a},setTargets:function(a){this.targets=[];if(a&&a.length)for(var b,c=0,d=a.length;c<d;++c)b=a[c],b instanceof OpenLayers.Layer.Vector?this.addTargetLayer(b):this.addTarget(b)},addTargetLayer:function(a){this.addTarget({layer:a})},addTarget:function(a){a=OpenLayers.Util.applyDefaults(a,this.defaults);a.nodeTolerance=
a.nodeTolerance||a.tolerance;a.vertexTolerance=a.vertexTolerance||a.tolerance;a.edgeTolerance=a.edgeTolerance||a.tolerance;this.targets.push(a)},removeTargetLayer:function(a){for(var b,c=this.targets.length-1;0<=c;--c)b=this.targets[c],b.layer===a&&this.removeTarget(b)},removeTarget:function(a){return OpenLayers.Util.removeItem(this.targets,a)},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a&&this.layer&&this.layer.events)this.layer.events.on({sketchstarted:this.onSketchModified,
sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this});return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this);a&&this.layer&&this.layer.events&&this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this});this.point=this.feature=null;return a},onSketchModified:function(a){this.feature=a.feature;this.considerSnapping(a.vertex,a.vertex)},onVertexModified:function(a){this.feature=
a.feature;var b=this.layer.map.getLonLatFromViewPortPx(a.pixel);this.considerSnapping(a.vertex,new OpenLayers.Geometry.Point(b.lon,b.lat))},considerSnapping:function(a,b){for(var c={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null},d=!1,e,f,g=0,h=this.targets.length;g<h;++g)if(f=this.targets[g],e=this.testTarget(f,b))if(this.greedy){c=e;c.target=f;d=!0;break}else if(e.rank<c.rank||e.rank===c.rank&&e.dist<c.dist)c=e,c.target=f,d=!0;d&&(!1!==this.events.triggerEvent("beforesnap",
{point:a,x:c.x,y:c.y,distance:c.dist,layer:c.target.layer,snapType:this.precedence[c.rank]})?(a.x=c.x,a.y=c.y,this.point=a,this.events.triggerEvent("snap",{point:a,snapType:this.precedence[c.rank],layer:c.target.layer,distance:c.dist})):d=!1);this.point&&!d&&(a.x=b.x,a.y=b.y,this.point=null,this.events.triggerEvent("unsnap",{point:a}))},testTarget:function(a,b){var c=this.layer.map.getResolution();if("minResolution"in a&&c<a.minResolution||"maxResolution"in a&&c>=a.maxResolution)return null;for(var c=
{node:this.getGeoTolerance(a.nodeTolerance,c),vertex:this.getGeoTolerance(a.vertexTolerance,c),edge:this.getGeoTolerance(a.edgeTolerance,c)},d=Math.max(c.node,c.vertex,c.edge),e={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY},f=!1,g=a.layer.features,h,k,l,m,n,p,q=this.precedence.length,r=new OpenLayers.LonLat(b.x,b.y),s=0,t=g.length;s<t;++s)if(h=g[s],h!==this.feature&&(!h._sketch&&h.state!==OpenLayers.State.DELETE&&(!a.filter||a.filter.evaluate(h)))&&h.atPoint(r,d,d))for(var u=0,v=Math.min(e.rank+
1,q);u<v;++u)if(k=this.precedence[u],a[k])if("edge"===k){if(l=h.geometry.distanceTo(b,{details:!0}),n=l.distance,n<=c[k]&&n<e.dist){e={rank:u,dist:n,x:l.x0,y:l.y0};f=!0;break}}else{l=h.geometry.getVertices("node"===k);p=!1;for(var w=0,x=l.length;w<x;++w)m=l[w],n=m.distanceTo(b),n<=c[k]&&(u<e.rank||u===e.rank&&n<e.dist)&&(e={rank:u,dist:n,x:m.x,y:m.y},p=f=!0);if(p)break}return f?e:null},getGeoTolerance:function(a,b){b!==this.resolution&&(this.resolution=b,this.geoToleranceCache={});var c=this.geoToleranceCache[a];
void 0===c&&(c=a*b,this.geoToleranceCache[a]=c);return c},destroy:function(){this.active&&this.deactivate();delete this.layer;delete this.targets;OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Snapping"});OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows/1.1",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(a,b){b.exceptionReport={version:a.getAttribute("version"),language:a.getAttribute("xml:lang"),exceptions:[]};this.readChildNodes(a,b.exceptionReport)},AllowedValues:function(a,b){b.allowedValues={};this.readChildNodes(a,b.allowedValues)},AnyValue:function(a,b){b.anyValue=
!0},DataType:function(a,b){b.dataType=this.getChildValue(a)},Range:function(a,b){b.range={};this.readChildNodes(a,b.range)},MinimumValue:function(a,b){b.minValue=this.getChildValue(a)},MaximumValue:function(a,b){b.maxValue=this.getChildValue(a)},Identifier:function(a,b){b.identifier=this.getChildValue(a)},SupportedCRS:function(a,b){b.supportedCRS=this.getChildValue(a)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Util.applyDefaults({Range:function(a){var b=this.createElementNSPlus("ows:Range",
{attributes:{"ows:rangeClosure":a.closure}});this.writeNode("ows:MinimumValue",a.minValue,b);this.writeNode("ows:MaximumValue",a.maxValue,b);return b},MinimumValue:function(a){return this.createElementNSPlus("ows:MinimumValue",{value:a})},MaximumValue:function(a){return this.createElementNSPlus("ows:MaximumValue",{value:a})},Value:function(a){return this.createElementNSPlus("ows:Value",{value:a})}},OpenLayers.Format.OWSCommon.v1.prototype.writers.ows)},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"});OpenLayers.Format.WCSGetCoverage=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.1.2",schemaLocation:"http://www.opengis.net/wcs/1.1 http://schemas.opengis.net/wcs/1.1/wcsGetCoverage.xsd",write:function(a){a=this.writeNode("wcs:GetCoverage",
a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{wcs:{GetCoverage:function(a){var b=this.createElementNSPlus("wcs:GetCoverage",{attributes:{version:a.version||this.VERSION,service:"WCS"}});this.writeNode("ows:Identifier",a.identifier,b);this.writeNode("wcs:DomainSubset",a.domainSubset,b);this.writeNode("wcs:Output",a.output,b);return b},DomainSubset:function(a){var b=this.createElementNSPlus("wcs:DomainSubset",
{});this.writeNode("ows:BoundingBox",a.boundingBox,b);a.temporalSubset&&this.writeNode("wcs:TemporalSubset",a.temporalSubset,b);return b},TemporalSubset:function(a){for(var b=this.createElementNSPlus("wcs:TemporalSubset",{}),c=0,d=a.timePeriods.length;c<d;++c)this.writeNode("wcs:TimePeriod",a.timePeriods[c],b);return b},TimePeriod:function(a){var b=this.createElementNSPlus("wcs:TimePeriod",{});this.writeNode("wcs:BeginPosition",a.begin,b);this.writeNode("wcs:EndPosition",a.end,b);a.resolution&&this.writeNode("wcs:TimeResolution",
a.resolution,b);return b},BeginPosition:function(a){return this.createElementNSPlus("wcs:BeginPosition",{value:a})},EndPosition:function(a){return this.createElementNSPlus("wcs:EndPosition",{value:a})},TimeResolution:function(a){return this.createElementNSPlus("wcs:TimeResolution",{value:a})},Output:function(a){var b=this.createElementNSPlus("wcs:Output",{attributes:{format:a.format,store:a.store}});a.gridCRS&&this.writeNode("wcs:GridCRS",a.gridCRS,b);return b},GridCRS:function(a){var b=this.createElementNSPlus("wcs:GridCRS",
{});this.writeNode("wcs:GridBaseCRS",a.baseCRS,b);a.type&&this.writeNode("wcs:GridType",a.type,b);a.origin&&this.writeNode("wcs:GridOrigin",a.origin,b);this.writeNode("wcs:GridOffsets",a.offsets,b);a.CS&&this.writeNode("wcs:GridCS",a.CS,b);return b},GridBaseCRS:function(a){return this.createElementNSPlus("wcs:GridBaseCRS",{value:a})},GridOrigin:function(a){return this.createElementNSPlus("wcs:GridOrigin",{value:a})},GridType:function(a){return this.createElementNSPlus("wcs:GridType",{value:a})},GridOffsets:function(a){return this.createElementNSPlus("wcs:GridOffsets",
{value:a})},GridCS:function(a){return this.createElementNSPlus("wcs:GridCS",{value:a})}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.WCSGetCoverage"});OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date,extractAttributes:!0,kvpAttributes:!1,extractStyles:!1,extractTracks:!1,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(a){this.regExes=
{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,kmlColor:/(\w{2})(\w{2})(\w{2})(\w{2})/,kmlIconPalette:/root:\/\/icons\/palette-(\d+)(\.\w+)/,straightBracket:/\$\[(.*?)\]/g};this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){this.features=[];this.styles={};this.fetched={};return this.parseData(a,{depth:0,styleBaseUrl:this.styleBaseUrl})},parseData:function(a,b){"string"==typeof a&&
(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var c=["Link","NetworkLink","Style","StyleMap","Placemark"],d=0,e=c.length;d<e;++d){var f=c[d],g=this.getElementsByTagNameNS(a,"*",f);if(0!=g.length)switch(f.toLowerCase()){case "link":case "networklink":this.parseLinks(g,b);break;case "style":this.extractStyles&&this.parseStyles(g,b);break;case "stylemap":this.extractStyles&&this.parseStyleMaps(g,b);break;case "placemark":this.parseFeatures(g,b)}}return this.features},parseLinks:function(a,
b){if(b.depth>=this.maxDepth)return!1;var c=OpenLayers.Util.extend({},b);c.depth++;for(var d=0,e=a.length;d<e;d++){var f=this.parseProperty(a[d],"*","href");f&&!this.fetched[f]&&(this.fetched[f]=!0,(f=this.fetchLink(f))&&this.parseData(f,c))}},fetchLink:function(a){if(a=OpenLayers.Request.GET({url:a,async:!1}))return a.responseText},parseStyles:function(a,b){for(var c=0,d=a.length;c<d;c++){var e=this.parseStyle(a[c]);e&&(this.styles[(b.styleBaseUrl||"")+"#"+e.id]=e)}},parseKmlColor:function(a){var b=
null;a&&(a=a.match(this.regExes.kmlColor))&&(b={color:"#"+a[4]+a[3]+a[2],opacity:parseInt(a[1],16)/255});return b},parseStyle:function(a){for(var b={},c=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"],d,e,f=0,g=c.length;f<g;++f)if(d=c[f],e=this.getElementsByTagNameNS(a,"*",d)[0])switch(d.toLowerCase()){case "linestyle":d=this.parseProperty(e,"*","color");if(d=this.parseKmlColor(d))b.strokeColor=d.color,b.strokeOpacity=d.opacity;(d=this.parseProperty(e,"*","width"))&&(b.strokeWidth=
d);break;case "polystyle":d=this.parseProperty(e,"*","color");if(d=this.parseKmlColor(d))b.fillOpacity=d.opacity,b.fillColor=d.color;"0"==this.parseProperty(e,"*","fill")&&(b.fillColor="none");"0"==this.parseProperty(e,"*","outline")&&(b.strokeWidth="0");break;case "iconstyle":var h=parseFloat(this.parseProperty(e,"*","scale")||1);d=32*h;var k=32*h,l=this.getElementsByTagNameNS(e,"*","Icon")[0];if(l){var m=this.parseProperty(l,"*","href");if(m){var n=this.parseProperty(l,"*","w"),p=this.parseProperty(l,
"*","h");!OpenLayers.String.startsWith(m,"http://maps.google.com/mapfiles/kml")||(n||p)||(p=n=64,h/=2);n=n||p;p=p||n;n&&(d=parseInt(n)*h);p&&(k=parseInt(p)*h);if(p=m.match(this.regExes.kmlIconPalette))n=p[1],p=p[2],m=this.parseProperty(l,"*","x"),l=this.parseProperty(l,"*","y"),m="http://maps.google.com/mapfiles/kml/pal"+n+"/icon"+(8*(l?7-l/32:7)+(m?m/32:0))+p;b.graphicOpacity=1;b.externalGraphic=m}}if(e=this.getElementsByTagNameNS(e,"*","hotSpot")[0])m=parseFloat(e.getAttribute("x")),l=parseFloat(e.getAttribute("y")),
n=e.getAttribute("xunits"),"pixels"==n?b.graphicXOffset=-m*h:"insetPixels"==n?b.graphicXOffset=-d+m*h:"fraction"==n&&(b.graphicXOffset=-d*m),e=e.getAttribute("yunits"),"pixels"==e?b.graphicYOffset=-k+l*h+1:"insetPixels"==e?b.graphicYOffset=-(l*h)+1:"fraction"==e&&(b.graphicYOffset=-k*(1-l)+1);b.graphicWidth=d;b.graphicHeight=k;break;case "balloonstyle":(e=OpenLayers.Util.getXmlNodeValue(e))&&(b.balloonStyle=e.replace(this.regExes.straightBracket,"${$1}"));break;case "labelstyle":if(d=this.parseProperty(e,
"*","color"),d=this.parseKmlColor(d))b.fontColor=d.color,b.fontOpacity=d.opacity}!b.strokeColor&&b.fillColor&&(b.strokeColor=b.fillColor);(a=a.getAttribute("id"))&&b&&(b.id=a);return b},parseStyleMaps:function(a,b){for(var c=0,d=a.length;c<d;c++)for(var e=a[c],f=this.getElementsByTagNameNS(e,"*","Pair"),e=e.getAttribute("id"),g=0,h=f.length;g<h;g++){var k=f[g],l=this.parseProperty(k,"*","key");(k=this.parseProperty(k,"*","styleUrl"))&&"normal"==l&&(this.styles[(b.styleBaseUrl||"")+"#"+e]=this.styles[(b.styleBaseUrl||
"")+k])}},parseFeatures:function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){var f=a[d],g=this.parseFeature.apply(this,[f]);if(g){this.extractStyles&&(g.attributes&&g.attributes.styleUrl)&&(g.style=this.getStyle(g.attributes.styleUrl,b));if(this.extractStyles){var h=this.getElementsByTagNameNS(f,"*","Style")[0];h&&(h=this.parseStyle(h))&&(g.style=OpenLayers.Util.extend(g.style,h))}this.extractTracks?(f=this.getElementsByTagNameNS(f,this.namespaces.gx,"Track"))&&0<f.length&&(g={features:[],feature:g},
this.readNode(f[0],g),0<g.features.length&&c.push.apply(c,g.features)):c.push(g)}else throw"Bad Placemark: "+d;}this.features=this.features.concat(c)},readers:{kml:{when:function(a,b){b.whens.push(OpenLayers.Date.parse(this.getChildValue(a)))},_trackPointAttribute:function(a,b){var c=a.nodeName.split(":").pop();b.attributes[c].push(this.getChildValue(a))}},gx:{Track:function(a,b){var c={whens:[],points:[],angles:[]};if(this.trackAttributes){var d;c.attributes={};for(var e=0,f=this.trackAttributes.length;e<
f;++e)d=this.trackAttributes[e],c.attributes[d]=[],d in this.readers.kml||(this.readers.kml[d]=this.readers.kml._trackPointAttribute)}this.readChildNodes(a,c);if(c.whens.length!==c.points.length)throw Error("gx:Track with unequal number of when ("+c.whens.length+") and gx:coord ("+c.points.length+") elements.");var g=0<c.angles.length;if(g&&c.whens.length!==c.angles.length)throw Error("gx:Track with unequal number of when ("+c.whens.length+") and gx:angles ("+c.angles.length+") elements.");for(var h,
e=0,f=c.whens.length;e<f;++e){h=b.feature.clone();h.fid=b.feature.fid||b.feature.id;d=c.points[e];h.geometry=d;"z"in d&&(h.attributes.altitude=d.z);this.internalProjection&&this.externalProjection&&h.geometry.transform(this.externalProjection,this.internalProjection);if(this.trackAttributes)for(var k=0,l=this.trackAttributes.length;k<l;++k)d=this.trackAttributes[k],h.attributes[d]=c.attributes[d][e];h.attributes.when=c.whens[e];h.attributes.trackId=b.feature.id;g&&(d=c.angles[e],h.attributes.heading=
parseFloat(d[0]),h.attributes.tilt=parseFloat(d[1]),h.attributes.roll=parseFloat(d[2]));b.features.push(h)}},coord:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/),d=new OpenLayers.Geometry.Point(c[0],c[1]);2<c.length&&(d.z=parseFloat(c[2]));b.points.push(d)},angles:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/);b.angles.push(c)}}},parseFeature:function(a){for(var b=["MultiGeometry","Polygon","LineString","Point"],
c,d,e,f=0,g=b.length;f<g;++f)if(c=b[f],this.internalns=a.namespaceURI?a.namespaceURI:this.kmlns,d=this.getElementsByTagNameNS(a,this.internalns,c),0<d.length){if(b=this.parseGeometry[c.toLowerCase()])e=b.apply(this,[d[0]]),this.internalProjection&&this.externalProjection&&e.transform(this.externalProjection,this.internalProjection);else throw new TypeError("Unsupported geometry type: "+c);break}var h;this.extractAttributes&&(h=this.parseAttributes(a));c=new OpenLayers.Feature.Vector(e,h);a=a.getAttribute("id")||
a.getAttribute("name");null!=a&&(c.fid=a);return c},getStyle:function(a,b){var c=OpenLayers.Util.removeTail(a),d=OpenLayers.Util.extend({},b);d.depth++;d.styleBaseUrl=c;!this.styles[a]&&!OpenLayers.String.startsWith(a,"#")&&d.depth<=this.maxDepth&&!this.fetched[c]&&(c=this.fetchLink(c))&&this.parseData(c,d);return OpenLayers.Util.extend({},this.styles[a])},parseGeometry:{point:function(a){var b=this.getElementsByTagNameNS(a,this.internalns,"coordinates");a=[];if(0<b.length){var c=b[0].firstChild.nodeValue,
c=c.replace(this.regExes.removeSpace,"");a=c.split(",")}b=null;if(1<a.length)2==a.length&&(a[2]=null),b=new OpenLayers.Geometry.Point(a[0],a[1],a[2]);else throw"Bad coordinate string: "+c;return b},linestring:function(a,b){var c=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),d=null;if(0<c.length){for(var c=this.getChildValue(c[0]),c=c.replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),d=c.split(this.regExes.splitSpace),e=d.length,f=Array(e),g,h,k=0;k<e;++k)if(g=
d[k].split(","),h=g.length,1<h)2==g.length&&(g[2]=null),f[k]=new OpenLayers.Geometry.Point(g[0],g[1],g[2]);else throw"Bad LineString point coordinates: "+d[k];if(e)d=b?new OpenLayers.Geometry.LinearRing(f):new OpenLayers.Geometry.LineString(f);else throw"Bad LineString coordinates: "+c;}return d},polygon:function(a){a=this.getElementsByTagNameNS(a,this.internalns,"LinearRing");var b=a.length,c=Array(b);if(0<b)for(var d=0,e=a.length;d<e;++d)if(b=this.parseGeometry.linestring.apply(this,[a[d],!0]))c[d]=
b;else throw"Bad LinearRing geometry: "+d;return new OpenLayers.Geometry.Polygon(c)},multigeometry:function(a){for(var b,c=[],d=a.childNodes,e=0,f=d.length;e<f;++e)a=d[e],1==a.nodeType&&(b=a.prefix?a.nodeName.split(":")[1]:a.nodeName,(b=this.parseGeometry[b.toLowerCase()])&&c.push(b.apply(this,[a])));return new OpenLayers.Geometry.Collection(c)}},parseAttributes:function(a){var b={},c=a.getElementsByTagName("ExtendedData");c.length&&(b=this.parseExtendedData(c[0]));var d,e,f;a=a.childNodes;for(var c=
0,g=a.length;c<g;++c)if(d=a[c],1==d.nodeType&&(e=d.childNodes,1<=e.length&&3>=e.length)){switch(e.length){case 1:f=e[0];break;case 2:f=e[0];e=e[1];f=3==f.nodeType||4==f.nodeType?f:e;break;default:f=e[1]}if(3==f.nodeType||4==f.nodeType)if(d=d.prefix?d.nodeName.split(":")[1]:d.nodeName,f=OpenLayers.Util.getXmlNodeValue(f))f=f.replace(this.regExes.trimSpace,""),b[d]=f}return b},parseExtendedData:function(a){var b={},c,d,e,f,g=a.getElementsByTagName("Data");c=0;for(d=g.length;c<d;c++){e=g[c];f=e.getAttribute("name");
var h={},k=e.getElementsByTagName("value");k.length&&(h.value=this.getChildValue(k[0]));this.kvpAttributes?b[f]=h.value:(e=e.getElementsByTagName("displayName"),e.length&&(h.displayName=this.getChildValue(e[0])),b[f]=h)}a=a.getElementsByTagName("SimpleData");c=0;for(d=a.length;c<d;c++)h={},e=a[c],f=e.getAttribute("name"),h.value=this.getChildValue(e),this.kvpAttributes?b[f]=h.value:(h.displayName=f,b[f]=h);return b},parseProperty:function(a,b,c){var d;a=this.getElementsByTagNameNS(a,b,c);try{d=OpenLayers.Util.getXmlNodeValue(a[0])}catch(e){d=
null}return d},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=this.createElementNS(this.kmlns,"kml"),c=this.createFolderXML(),d=0,e=a.length;d<e;++d)c.appendChild(this.createPlacemarkXML(a[d]));b.appendChild(c);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFolderXML:function(){var a=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var b=this.createElementNS(this.kmlns,"name"),c=this.createTextNode(this.foldersName);b.appendChild(c);a.appendChild(b)}this.foldersDesc&&
(b=this.createElementNS(this.kmlns,"description"),c=this.createTextNode(this.foldersDesc),b.appendChild(c),a.appendChild(b));return a},createPlacemarkXML:function(a){var b=this.createElementNS(this.kmlns,"name"),c=a.style&&a.style.label?a.style.label:a.id;b.appendChild(this.createTextNode(a.attributes.name||c));var d=this.createElementNS(this.kmlns,"description");d.appendChild(this.createTextNode(a.attributes.description||this.placemarksDesc));c=this.createElementNS(this.kmlns,"Placemark");null!=
a.fid&&c.setAttribute("id",a.fid);c.appendChild(b);c.appendChild(d);b=this.buildGeometryNode(a.geometry);c.appendChild(b);a.attributes&&(a=this.buildExtendedData(a.attributes))&&c.appendChild(a);return c},buildGeometryNode:function(a){var b=a.CLASS_NAME,b=b.substring(b.lastIndexOf(".")+1),b=this.buildGeometry[b.toLowerCase()],c=null;b&&(c=b.apply(this,[a]));return c},buildGeometry:{point:function(a){var b=this.createElementNS(this.kmlns,"Point");b.appendChild(this.buildCoordinatesNode(a));return b},
multipoint:function(a){return this.buildGeometry.collection.apply(this,[a])},linestring:function(a){var b=this.createElementNS(this.kmlns,"LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){return this.buildGeometry.collection.apply(this,[a])},linearring:function(a){var b=this.createElementNS(this.kmlns,"LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){var b=this.createElementNS(this.kmlns,"Polygon");a=a.components;
for(var c,d,e=0,f=a.length;e<f;++e)c=0==e?"outerBoundaryIs":"innerBoundaryIs",c=this.createElementNS(this.kmlns,c),d=this.buildGeometry.linearring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},multipolygon:function(a){return this.buildGeometry.collection.apply(this,[a])},collection:function(a){for(var b=this.createElementNS(this.kmlns,"MultiGeometry"),c,d=0,e=a.components.length;d<e;++d)(c=this.buildGeometryNode.apply(this,[a.components[d]]))&&b.appendChild(c);return b}},buildCoordinatesNode:function(a){var b=
this.createElementNS(this.kmlns,"coordinates"),c;if(c=a.components){for(var d=c.length,e=Array(d),f=0;f<d;++f)a=c[f],e[f]=this.buildCoordinates(a);c=e.join(" ")}else c=this.buildCoordinates(a);c=this.createTextNode(c);b.appendChild(c);return b},buildCoordinates:function(a){this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));return a.x+","+a.y},buildExtendedData:function(a){var b=this.createElementNS(this.kmlns,"ExtendedData"),
c;for(c in a)if(a[c]&&"name"!=c&&"description"!=c&&"styleUrl"!=c){var d=this.createElementNS(this.kmlns,"Data");d.setAttribute("name",c);var e=this.createElementNS(this.kmlns,"value");if("object"==typeof a[c]){if(a[c].value&&e.appendChild(this.createTextNode(a[c].value)),a[c].displayName){var f=this.createElementNS(this.kmlns,"displayName");f.appendChild(this.getXMLDoc().createCDATASection(a[c].displayName));d.appendChild(f)}}else e.appendChild(this.createTextNode(a[c]));d.appendChild(e);b.appendChild(d)}return this.isSimpleContent(b)?
null:b},CLASS_NAME:"OpenLayers.Format.KML"});OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",profile:null,CLASS_NAME:"OpenLayers.Format.WMSCapabilities"});OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wms:"http://www.opengis.net/wms",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"wms",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a;a&&9==a.nodeType&&(a=a.documentElement);var c={};this.readNode(a,c);void 0===c.service&&(a=new OpenLayers.Format.OGCExceptionReport,c.error=a.read(b));return c},readers:{wms:{Service:function(a,
b){b.service={};this.readChildNodes(a,b.service)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},BoundingBox:function(a,b){var c={};c.bbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))];var d={x:parseFloat(a.getAttribute("resx")),y:parseFloat(a.getAttribute("resy"))};isNaN(d.x)&&isNaN(d.y)||(c.res=
d);return c},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},ContactInformation:function(a,b){b.contactInformation={};this.readChildNodes(a,b.contactInformation)},ContactPersonPrimary:function(a,b){b.personPrimary={};this.readChildNodes(a,b.personPrimary)},ContactPerson:function(a,b){b.person=this.getChildValue(a)},ContactOrganization:function(a,b){b.organization=this.getChildValue(a)},ContactPosition:function(a,b){b.position=this.getChildValue(a)},ContactAddress:function(a,
b){b.contactAddress={};this.readChildNodes(a,b.contactAddress)},AddressType:function(a,b){b.type=this.getChildValue(a)},Address:function(a,b){b.address=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},StateOrProvince:function(a,b){b.stateOrProvince=this.getChildValue(a)},PostCode:function(a,b){b.postcode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ContactVoiceTelephone:function(a,b){b.phone=this.getChildValue(a)},ContactFacsimileTelephone:function(a,
b){b.fax=this.getChildValue(a)},ContactElectronicMailAddress:function(a,b){b.email=this.getChildValue(a)},Fees:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.fees=c)},AccessConstraints:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.accessConstraints=c)},Capability:function(a,b){b.capability={nestedLayers:[],layers:[]};this.readChildNodes(a,b.capability)},Request:function(a,b){b.request={};this.readChildNodes(a,b.request)},GetCapabilities:function(a,
b){b.getcapabilities={formats:[]};this.readChildNodes(a,b.getcapabilities)},Format:function(a,b){OpenLayers.Util.isArray(b.formats)?b.formats.push(this.getChildValue(a)):b.format=this.getChildValue(a)},DCPType:function(a,b){this.readChildNodes(a,b)},HTTP:function(a,b){this.readChildNodes(a,b)},Get:function(a,b){b.get={};this.readChildNodes(a,b.get);b.href||(b.href=b.get.href)},Post:function(a,b){b.post={};this.readChildNodes(a,b.post);b.href||(b.href=b.get.href)},GetMap:function(a,b){b.getmap={formats:[]};
this.readChildNodes(a,b.getmap)},GetFeatureInfo:function(a,b){b.getfeatureinfo={formats:[]};this.readChildNodes(a,b.getfeatureinfo)},Exception:function(a,b){b.exception={formats:[]};this.readChildNodes(a,b.exception)},Layer:function(a,b){var c,d;b.capability?(d=b.capability,c=b):d=b;var e=a.getAttributeNode("queryable"),f=e&&e.specified?a.getAttribute("queryable"):null,g=(e=a.getAttributeNode("cascaded"))&&e.specified?a.getAttribute("cascaded"):null,e=(e=a.getAttributeNode("opaque"))&&e.specified?
a.getAttribute("opaque"):null,h=a.getAttribute("noSubsets"),k=a.getAttribute("fixedWidth"),l=a.getAttribute("fixedHeight"),m=c||{},n=OpenLayers.Util.extend;c={nestedLayers:[],styles:c?[].concat(c.styles):[],srs:c?n({},m.srs):{},metadataURLs:[],bbox:c?n({},m.bbox):{},llbbox:m.llbbox,dimensions:c?n({},m.dimensions):{},authorityURLs:c?n({},m.authorityURLs):{},identifiers:{},keywords:[],queryable:f&&""!==f?"1"===f||"true"===f:m.queryable||!1,cascaded:null!==g?parseInt(g):m.cascaded||0,opaque:e?"1"===
e||"true"===e:m.opaque||!1,noSubsets:null!==h?"1"===h||"true"===h:m.noSubsets||!1,fixedWidth:null!=k?parseInt(k):m.fixedWidth||0,fixedHeight:null!=l?parseInt(l):m.fixedHeight||0,minScale:m.minScale,maxScale:m.maxScale,attribution:m.attribution};b.nestedLayers.push(c);c.capability=d;this.readChildNodes(a,c);delete c.capability;c.name&&(f=c.name.split(":"),g=d.request,e=g.getfeatureinfo,0<f.length&&(c.prefix=f[0]),d.layers.push(c),void 0===c.formats&&(c.formats=g.getmap.formats),void 0===c.infoFormats&&
e&&(c.infoFormats=e.formats))},Attribution:function(a,b){b.attribution={};this.readChildNodes(a,b.attribution)},LogoURL:function(a,b){b.logo={width:a.getAttribute("width"),height:a.getAttribute("height")};this.readChildNodes(a,b.logo)},Style:function(a,b){var c={};b.styles.push(c);this.readChildNodes(a,c)},LegendURL:function(a,b){var c={width:a.getAttribute("width"),height:a.getAttribute("height")};b.legend=c;this.readChildNodes(a,c)},MetadataURL:function(a,b){var c={type:a.getAttribute("type")};
b.metadataURLs.push(c);this.readChildNodes(a,c)},DataURL:function(a,b){b.dataURL={};this.readChildNodes(a,b.dataURL)},FeatureListURL:function(a,b){b.featureListURL={};this.readChildNodes(a,b.featureListURL)},AuthorityURL:function(a,b){var c=a.getAttribute("name"),d={};this.readChildNodes(a,d);b.authorityURLs[c]=d.href},Identifier:function(a,b){var c=a.getAttribute("authority");b.identifiers[c]=this.getChildValue(a)},KeywordList:function(a,b){this.readChildNodes(a,b)},SRS:function(a,b){b.srs[this.getChildValue(a)]=
!0}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1"});OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMT_MS_Capabilities:function(a,b){this.readChildNodes(a,b)},Keyword:function(a,b){b.keywords&&b.keywords.push(this.getChildValue(a))},DescribeLayer:function(a,b){b.describelayer={formats:[]};this.readChildNodes(a,b.describelayer)},GetLegendGraphic:function(a,b){b.getlegendgraphic={formats:[]};this.readChildNodes(a,b.getlegendgraphic)},GetStyles:function(a,b){b.getstyles=
{formats:[]};this.readChildNodes(a,b.getstyles)},PutStyles:function(a,b){b.putstyles={formats:[]};this.readChildNodes(a,b.putstyles)},UserDefinedSymbolization:function(a,b){var c={supportSLD:1==parseInt(a.getAttribute("SupportSLD")),userLayer:1==parseInt(a.getAttribute("UserLayer")),userStyle:1==parseInt(a.getAttribute("UserStyle")),remoteWFS:1==parseInt(a.getAttribute("RemoteWFS"))};b.userSymbols=c},LatLonBoundingBox:function(a,b){b.llbbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),
parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))]},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[a,b]);c.srs=a.getAttribute("SRS");b.bbox[c.srs]=c},ScaleHint:function(a,b){var c=a.getAttribute("min"),d=a.getAttribute("max"),e=Math.pow(2,0.5),f=OpenLayers.INCHES_PER_UNIT.m;0!=c&&(b.maxScale=parseFloat((c/e*f*OpenLayers.DOTS_PER_INCH).toPrecision(13)));d!=Number.POSITIVE_INFINITY&&(b.minScale=parseFloat((d/e*f*
OpenLayers.DOTS_PER_INCH).toPrecision(13)))},Dimension:function(a,b){var c={name:a.getAttribute("name").toLowerCase(),units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol")};b.dimensions[c.name]=c},Extent:function(a,b){var c=a.getAttribute("name").toLowerCase();if(c in b.dimensions){c=b.dimensions[c];c.nearestVal="1"===a.getAttribute("nearestValue");c.multipleVal="1"===a.getAttribute("multipleValues");c.current="1"===a.getAttribute("current");c["default"]=a.getAttribute("default")||
"";var d=this.getChildValue(a);c.values=d.split(",")}}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"});OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){for(var c=this.getChildValue(a).split(/ +/),d=0,e=c.length;d<e;d++)b.srs[c[d]]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"});OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,readOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);a.format||(this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,
srsName:this.srsName,schema:this.schema},this.formatOptions)));!a.geometryName&&1<parseFloat(this.format.version)&&this.setGeometryName(null)},destroy:function(){this.options&&!this.options.format&&this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,this.options||{});var b=new OpenLayers.Protocol.Response({requestType:"read"}),
c=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",a)]);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),params:a.params,headers:a.headers,data:c});return b},setFeatureType:function(a){this.featureType=a;this.format.featureType=a},setGeometryName:function(a){this.geometryName=a;this.format.geometryName=a},handleRead:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);if(b.callback){var c=
a.priv;200<=c.status&&300>c.status?(c=this.parseResponse(c,b.readOptions))&&!1!==c.success?(b.readOptions&&"object"==b.readOptions.output?OpenLayers.Util.extend(a,c):a.features=c,a.code=OpenLayers.Protocol.Response.SUCCESS):(a.code=OpenLayers.Protocol.Response.FAILURE,a.error=c):a.code=OpenLayers.Protocol.Response.FAILURE;b.callback.call(b.scope,a)}},parseResponse:function(a,b){var c=a.responseXML;c&&c.documentElement||(c=a.responseText);if(!c||0>=c.length)return null;c=null!==this.readFormat?this.readFormat.read(c):
this.format.read(c,b);if(!this.featureNS){var d=this.readFormat||this.format;this.featureNS=d.featureNS;d.autoConfig=!1;this.geometryName||this.setGeometryName(d.geometryName)}return c},commit:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);var c=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:a});c.priv=OpenLayers.Request.POST({url:b.url,headers:b.headers,data:this.format.write(a,b),callback:this.createCallback(this.handleCommit,c,b)});
return c},handleCommit:function(a,b){if(b.callback){var c=a.priv,d=c.responseXML;d&&d.documentElement||(d=c.responseText);c=this.format.read(d)||{};a.insertIds=c.insertIds||[];c.success?a.code=OpenLayers.Protocol.Response.SUCCESS:(a.code=OpenLayers.Protocol.Response.FAILURE,a.error=c);b.callback.call(b.scope,a)}},filterDelete:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);new OpenLayers.Protocol.Response({requestType:"commit"});var c=this.format.createElementNSPlus("wfs:Transaction",
{attributes:{service:"WFS",version:this.version}}),d=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(b.featureNS?this.featurePrefix+":":"")+b.featureType}});b.featureNS&&d.setAttribute("xmlns:"+this.featurePrefix,b.featureNS);var e=this.format.writeNode("ogc:Filter",a);d.appendChild(e);c.appendChild(d);c=OpenLayers.Format.XML.prototype.write.apply(this.format,[c]);return OpenLayers.Request.POST({url:this.url,callback:b.callback||function(){},data:c})},abort:function(a){a&&a.priv.abort()},
CLASS_NAME:"OpenLayers.Protocol.WFS.v1"});OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(a,b,c,d){OpenLayers.Handler.prototype.initialize.apply(this,[a,c,d]);this.layer=
b},touchstart:function(a){this.startTouch();return OpenLayers.Event.isMultiTouch(a)?!0:this.mousedown(a)},touchmove:function(a){OpenLayers.Event.preventDefault(a)},mousedown:function(a){if(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))this.down=a.xy;return this.handle(a)?!this.stopDown:!0},mouseup:function(a){this.up=a.xy;return this.handle(a)?!this.stopUp:!0},click:function(a){return this.handle(a)?!this.stopClick:!0},mousemove:function(a){if(!this.callbacks.over&&!this.callbacks.out)return!0;
this.handle(a);return!0},dblclick:function(a){return!this.handle(a)},geometryTypeMatches:function(a){return null==this.geometryTypes||-1<OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)},handle:function(a){this.feature&&!this.feature.layer&&(this.feature=null);var b=a.type,c=!1,d=!!this.feature,e="click"==b||"dblclick"==b||"touchstart"==b;(this.feature=this.layer.getFeatureFromEvent(a))&&!this.feature.layer&&(this.feature=null);this.lastFeature&&!this.lastFeature.layer&&(this.lastFeature=
null);this.feature?("touchstart"===b&&OpenLayers.Event.preventDefault(a),a=this.feature!=this.lastFeature,this.geometryTypeMatches(this.feature)?(d&&a?(this.lastFeature&&this.triggerCallback(b,"out",[this.lastFeature]),this.triggerCallback(b,"in",[this.feature])):d&&!e||this.triggerCallback(b,"in",[this.feature]),this.lastFeature=this.feature,c=!0):(this.lastFeature&&(d&&a||e)&&this.triggerCallback(b,"out",[this.lastFeature]),this.feature=null)):this.lastFeature&&(d||e)&&this.triggerCallback(b,"out",
[this.lastFeature]);return c},triggerCallback:function(a,b,c){if(b=this.EVENTMAP[a][b])"click"==a&&this.up&&this.down?(Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2))<=this.clickTolerance&&this.callback(b,c),this.up=this.down=null):this.callback(b,c)},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),a=!0);
return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.up=this.down=this.lastFeature=this.feature=null,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),a=!0);return a},handleMapEvents:function(a){"removelayer"!=a.type&&"order"!=a.property||this.moveLayerToTop()},moveLayerToTop:function(){var a=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(a)},
moveLayerBack:function(){var a=this.layer.getZIndex()-1;a>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(a):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Handler.Feature"});OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(a){for(var b=this.layers,c,d=0;d<b.length;d++)if(c=b[d].getFeatureFromEvent(a))return c},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();a.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(a){a.events.unregister("changelayer",this,this.handleChangeLayer);
this.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){for(var a,b=0;b<this.map.layers.length;++b)a=this.map.layers[b],-1!=OpenLayers.Util.indexOf(this.layers,a)&&a.renderer.moveRoot(this.renderer)},resetRoots:function(){for(var a,b=0;b<this.layers.length;++b)a=this.layers[b],this.renderer&&a.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(a.renderer)},handleChangeLayer:function(a){var b=a.layer;"order"==a.property&&-1!=OpenLayers.Util.indexOf(this.layers,
b)&&(this.resetRoots(),this.collectRoots())},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"});OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);null===this.scope&&(this.scope=this);this.initLayer(a);var c=
{click:this.clickFeature,clickout:this.clickoutFeature};this.hover&&(c.over=this.overFeature,c.out=this.outFeature);this.callbacks=OpenLayers.Util.extend(c,this.callbacks);this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"}))},initLayer:function(a){OpenLayers.Util.isArray(a)?(this.layers=a,this.layer=
new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:a})):this.layer=a},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer);OpenLayers.Control.prototype.destroy.apply(this,arguments);this.layers&&this.layer.destroy()},activate:function(){this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&&this.handlers.box&&this.handlers.box.activate());return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.active&&
(this.handlers.feature.deactivate(),this.handlers.box&&this.handlers.box.deactivate(),this.layers&&this.map.removeLayer(this.layer));return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(a){var b=this.layers||[this.layer],c,d,e,f;for(e=0;e<b.length;++e)if(c=b[e],f=0,null!=c.selectedFeatures)for(;c.selectedFeatures.length>f;)d=c.selectedFeatures[f],a&&a.except==d?++f:this.unselect(d)},clickFeature:function(a){this.hover||(-1<OpenLayers.Util.indexOf(a.layer.selectedFeatures,
a)?this.toggleSelect()?this.unselect(a):this.multipleSelect()||this.unselectAll({except:a}):(this.multipleSelect()||this.unselectAll({except:a}),this.select(a)))},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(a){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(a){var b=
a.layer;this.hover&&(this.highlightOnly?this.highlight(a):-1==OpenLayers.Util.indexOf(b.selectedFeatures,a)&&this.select(a))},outFeature:function(a){if(this.hover)if(this.highlightOnly){if(a._lastHighlighter==this.id)if(a._prevHighlighter&&a._prevHighlighter!=this.id){delete a._lastHighlighter;var b=this.map.getControl(a._prevHighlighter);b&&b.highlight(a)}else this.unhighlight(a)}else this.unselect(a)},highlight:function(a){var b=a.layer;!1!==this.events.triggerEvent("beforefeaturehighlighted",{feature:a})&&
(a._prevHighlighter=a._lastHighlighter,a._lastHighlighter=this.id,b.drawFeature(a,this.selectStyle||this.renderIntent),this.events.triggerEvent("featurehighlighted",{feature:a}))},unhighlight:function(a){var b=a.layer;void 0==a._prevHighlighter?delete a._lastHighlighter:(a._prevHighlighter!=this.id&&(a._lastHighlighter=a._prevHighlighter),delete a._prevHighlighter);b.drawFeature(a,a.style||a.layer.style||"default");this.events.triggerEvent("featureunhighlighted",{feature:a})},select:function(a){var b=
this.onBeforeSelect.call(this.scope,a),c=a.layer;!1!==b&&(b=c.events.triggerEvent("beforefeatureselected",{feature:a}),!1!==b&&(c.selectedFeatures.push(a),this.highlight(a),this.handlers.feature.lastFeature||(this.handlers.feature.lastFeature=c.selectedFeatures[0]),c.events.triggerEvent("featureselected",{feature:a}),this.onSelect.call(this.scope,a)))},unselect:function(a){var b=a.layer;this.unhighlight(a);OpenLayers.Util.removeItem(b.selectedFeatures,a);b.events.triggerEvent("featureunselected",
{feature:a});this.onUnselect.call(this.scope,a)},selectBox:function(a){if(a instanceof OpenLayers.Bounds){var b=this.map.getLonLatFromPixel({x:a.left,y:a.bottom});a=this.map.getLonLatFromPixel({x:a.right,y:a.top});b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat);this.multipleSelect()||this.unselectAll();a=this.multiple;this.multiple=!0;var c=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:c});for(var d,e=0;e<c.length;++e){d=c[e];for(var f=0,g=d.features.length;f<g;++f){var h=
d.features[f];h.getVisibility()&&(null==this.geometryTypes||-1<OpenLayers.Util.indexOf(this.geometryTypes,h.geometry.CLASS_NAME))&&b.toGeometry().intersects(h.geometry)&&-1==OpenLayers.Util.indexOf(d.selectedFeatures,h)&&this.select(h)}}this.multiple=a;this.events.triggerEvent("boxselectionend",{layers:c})}},setMap:function(a){this.handlers.feature.setMap(a);this.box&&this.handlers.box.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(a){var b=this.active;this.unselectAll();
this.deactivate();this.layers&&(this.layer.destroy(),this.layers=null);this.initLayer(a);this.handlers.feature.layer=this.layer;b&&this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"});OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:!1,citeCompliant:!1,mouseDown:!1,stoppedDown:null,lastDown:null,lastUp:null,persist:!1,stopDown:!1,stopUp:!1,layerOptions:null,pixelTolerance:5,lastTouchPx:null,initialize:function(a,b,c){c&&c.layerOptions&&c.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{}));OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,
arguments))return!1;var a=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a);this.map.addLayer(this.layer);return!0},createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.callback("create",[this.point.geometry,this.point]);this.point.geometry.clearBounds();
this.layer.addFeatures([this.point],{silent:!0})},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments))return!1;this.cancel();null!=this.layer.map&&(this.destroyFeature(!0),this.layer.destroy(!1));this.layer=null;return!0},destroyFeature:function(a){!this.layer||!a&&this.persist||this.layer.destroyFeatures();this.point=null},destroyPersistedFeature:function(){var a=this.layer;a&&1<a.features.length&&this.layer.features[0].destroy()},finalize:function(a){this.mouseDown=
!1;this.lastTouchPx=this.lastUp=this.lastDown=null;this.callback(a?"cancel":"done",[this.geometryClone()]);this.destroyFeature(a)},cancel:function(){this.finalize(!0)},click:function(a){OpenLayers.Event.stop(a);return!1},dblclick:function(a){OpenLayers.Event.stop(a);return!1},modifyFeature:function(a){this.point||this.createFeature(a);a=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=a.lon;this.point.geometry.y=a.lat;this.callback("modify",[this.point.geometry,this.point,!1]);this.point.geometry.clearBounds();
this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var a=this.point&&this.point.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiPoint([a]));return a},geometryClone:function(){var a=this.getGeometry();return a&&a.clone()},mousedown:function(a){return this.down(a)},touchstart:function(a){this.startTouch();this.lastTouchPx=a.xy;return this.down(a)},mousemove:function(a){return this.move(a)},touchmove:function(a){this.lastTouchPx=a.xy;
return this.move(a)},mouseup:function(a){return this.up(a)},touchend:function(a){a.xy=this.lastTouchPx;return this.up(a)},down:function(a){this.mouseDown=!0;this.lastDown=a.xy;this.touch||this.modifyFeature(a.xy);this.stoppedDown=this.stopDown;return!this.stopDown},move:function(a){this.touch||this.mouseDown&&!this.stoppedDown||this.modifyFeature(a.xy);return!0},up:function(a){this.mouseDown=!1;this.stoppedDown=this.stopDown;if(!this.checkModifiers(a)||this.lastUp&&this.lastUp.equals(a.xy)||!this.lastDown||
!this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance))return!0;this.touch&&this.modifyFeature(a.xy);this.persist&&this.destroyPersistedFeature();this.lastUp=a.xy;this.finalize();return!this.stopUp},mouseout:function(a){OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv)&&(this.stoppedDown=this.stopDown,this.mouseDown=!1)},passesTolerance:function(a,b,c){var d=!0;null!=c&&a&&b&&a.distanceTo(b)>c&&(d=!1);return d},CLASS_NAME:"OpenLayers.Handler.Point"});OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:!1,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);
this.point.geometry.clearBounds();this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(a){OpenLayers.Handler.Point.prototype.destroyFeature.call(this,a);this.line=null},destroyPersistedFeature:function(){var a=this.layer;a&&2<a.features.length&&this.layer.features[0].destroy()},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(a){this.layer.removeFeatures([this.point]);a=this.layer.getLonLatFromViewPortPx(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a.lon,
a.lat));this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length);this.layer.addFeatures([this.point]);this.callback("point",[this.point.geometry,this.getGeometry()]);this.callback("modify",[this.point.geometry,this.getSketch()]);this.drawFeature();delete this.redoStack},insertXY:function(a,b){this.line.geometry.addComponent(new OpenLayers.Geometry.Point(a,b),this.getCurrentPointIndex());this.drawFeature();delete this.redoStack},insertDeltaXY:function(a,b){var c=this.getCurrentPointIndex()-
1,c=this.line.geometry.components[c];!c||(isNaN(c.x)||isNaN(c.y))||this.insertXY(c.x+a,c.y+b)},insertDirectionLength:function(a,b){a*=Math.PI/180;var c=b*Math.cos(a),d=b*Math.sin(a);this.insertDeltaXY(c,d)},insertDeflectionLength:function(a,b){var c=this.getCurrentPointIndex()-1;if(0<c){var d=this.line.geometry.components[c],c=this.line.geometry.components[c-1],d=Math.atan2(d.y-c.y,d.x-c.x);this.insertDirectionLength(180*d/Math.PI+a,b)}},getCurrentPointIndex:function(){return this.line.geometry.components.length-
1},undo:function(){var a=this.line.geometry,b=a.components,c=this.getCurrentPointIndex()-1,d=b[c],e=a.removeComponent(d);e&&(this.touch&&0<c&&(b=a.components,a=b[c-1],c=this.getCurrentPointIndex(),b=b[c],b.x=a.x,b.y=a.y),this.redoStack||(this.redoStack=[]),this.redoStack.push(d),this.drawFeature());return e},redo:function(){var a=this.redoStack&&this.redoStack.pop();a&&(this.line.geometry.addComponent(a,this.getCurrentPointIndex()),this.drawFeature());return!!a},freehandMode:function(a){return this.freehandToggle&&
a[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(a,b){this.line||this.createFeature(a);var c=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=c.lon;this.point.geometry.y=c.lat;this.callback("modify",[this.point.geometry,this.getSketch(),b]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var a=
this.line&&this.line.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiLineString([a]));return a},touchstart:function(a){if(this.timerId&&this.passesTolerance(this.lastTouchPx,a.xy,this.doubleTouchTolerance))return this.finishGeometry(),window.clearTimeout(this.timerId),this.timerId=null,!1;this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null);this.timerId=window.setTimeout(OpenLayers.Function.bind(function(){this.timerId=null},this),300);return OpenLayers.Handler.Point.prototype.touchstart.call(this,
a)},down:function(a){var b=this.stopDown;this.freehandMode(a)&&(b=!0,this.touch&&(this.modifyFeature(a.xy,!!this.lastUp),OpenLayers.Event.stop(a)));this.touch||this.lastDown&&this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)||this.modifyFeature(a.xy,!!this.lastUp);this.mouseDown=!0;this.lastDown=a.xy;this.stoppedDown=b;return!b},move:function(a){if(this.stoppedDown&&this.freehandMode(a))return this.persist&&this.destroyPersistedFeature(),this.maxVertices&&this.line&&this.line.geometry.components.length===
this.maxVertices?(this.removePoint(),this.finalize()):this.addPoint(a.xy),!1;this.touch||this.mouseDown&&!this.stoppedDown||this.modifyFeature(a.xy,!!this.lastUp);return!0},up:function(a){!this.mouseDown||this.lastUp&&this.lastUp.equals(a.xy)||(this.stoppedDown&&this.freehandMode(a)?(this.persist&&this.destroyPersistedFeature(),this.removePoint(),this.finalize()):this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)&&(this.touch&&this.modifyFeature(a.xy),null==this.lastUp&&this.persist&&this.destroyPersistedFeature(),
this.addPoint(a.xy),this.lastUp=a.xy,this.line.geometry.components.length===this.maxVertices+1&&this.finishGeometry()));this.stoppedDown=this.stopDown;this.mouseDown=!1;return!this.stopUp},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-1]);this.removePoint();this.finalize()},dblclick:function(a){this.freehandMode(a)||this.finishGeometry();return!1},CLASS_NAME:"OpenLayers.Handler.Path"});OpenLayers.Spherical=OpenLayers.Spherical||{};OpenLayers.Spherical.DEFAULT_RADIUS=6378137;OpenLayers.Spherical.computeDistanceBetween=function(a,b,c){c=c||OpenLayers.Spherical.DEFAULT_RADIUS;var d=Math.sin(Math.PI*(b.lon-a.lon)/360),e=Math.sin(Math.PI*(b.lat-a.lat)/360);a=e*e+d*d*Math.cos(Math.PI*a.lat/180)*Math.cos(Math.PI*b.lat/180);return 2*c*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))};
OpenLayers.Spherical.computeHeading=function(a,b){var c=Math.sin(Math.PI*(a.lon-b.lon)/180)*Math.cos(Math.PI*b.lat/180),d=Math.cos(Math.PI*a.lat/180)*Math.sin(Math.PI*b.lat/180)-Math.sin(Math.PI*a.lat/180)*Math.cos(Math.PI*b.lat/180)*Math.cos(Math.PI*(a.lon-b.lon)/180);return 180*Math.atan2(c,d)/Math.PI};OpenLayers.Control.CacheWrite=OpenLayers.Class(OpenLayers.Control,{layers:null,imageFormat:"image/png",quotaRegEx:/quota/i,setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);var b,c=this.layers||a.layers;for(b=c.length-1;0<=b;--b)this.addLayer({layer:c[b]});if(!this.layers)a.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(a){a.layer.events.on({tileloadstart:this.makeSameOrigin,tileloaded:this.onTileLoaded,scope:this})},removeLayer:function(a){a.layer.events.un({tileloadstart:this.makeSameOrigin,
tileloaded:this.onTileLoaded,scope:this})},makeSameOrigin:function(a){if(this.active&&(a=a.tile,a instanceof OpenLayers.Tile.Image&&!a.crossOriginKeyword&&"data:"!==a.url.substr(0,5))){var b=OpenLayers.Request.makeSameOrigin(a.url,OpenLayers.ProxyHost);OpenLayers.Control.CacheWrite.urlMap[b]=a.url;a.url=b}},onTileLoaded:function(a){this.active&&(!a.aborted&&a.tile instanceof OpenLayers.Tile.Image&&"data:"!==a.tile.url.substr(0,5))&&(this.cache({tile:a.tile}),delete OpenLayers.Control.CacheWrite.urlMap[a.tile.url])},
cache:function(a){if(window.localStorage){a=a.tile;try{var b=a.getCanvasContext();b&&window.localStorage.setItem("olCache_"+(OpenLayers.Control.CacheWrite.urlMap[a.url]||a.url),b.canvas.toDataURL(this.imageFormat))}catch(c){(b=c.name||c.message)&&this.quotaRegEx.test(b)?this.events.triggerEvent("cachefull",{tile:a}):OpenLayers.Console.error(c.toString())}}},destroy:function(){if(this.layers||this.map){var a,b=this.layers||this.map.layers;for(a=b.length-1;0<=a;--a)this.removeLayer({layer:b[a]})}this.map&&
this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheWrite"});OpenLayers.Control.CacheWrite.clearCache=function(){if(window.localStorage){var a,b;for(a=window.localStorage.length-1;0<=a;--a)b=window.localStorage.key(a),"olCache_"===b.substr(0,8)&&window.localStorage.removeItem(b)}};OpenLayers.Control.CacheWrite.urlMap={};OpenLayers.Format.Context=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{layerOptions:null,layerParams:null,read:function(a,b){var c=OpenLayers.Format.XML.VersionedOGC.prototype.read.apply(this,arguments);if(b&&b.map)if(this.context=c,b.map instanceof OpenLayers.Map)c=this.mergeContextToMap(c,b.map);else{var d=b.map;if(OpenLayers.Util.isElement(d)||"string"==typeof d)d={div:d};c=this.contextToMap(c,d)}return c},getLayerFromContext:function(a){var b,c,d={queryable:a.queryable,visibility:a.visibility,
maxExtent:a.maxExtent,metadata:OpenLayers.Util.applyDefaults(a.metadata,{styles:a.styles,formats:a.formats,"abstract":a["abstract"],dataURL:a.dataURL}),numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,tileSize:a.tileSize?new OpenLayers.Size(a.tileSize.width,a.tileSize.height):void 0,minScale:a.minScale||a.maxScaleDenominator,maxScale:a.maxScale||a.minScaleDenominator,srs:a.srs,dimensions:a.dimensions,
metadataURL:a.metadataURL};this.layerOptions&&OpenLayers.Util.applyDefaults(d,this.layerOptions);var e={layers:a.name,transparent:a.transparent,version:a.version};if(a.formats&&0<a.formats.length)for(e.format=a.formats[0].value,b=0,c=a.formats.length;b<c;b++){var f=a.formats[b];if(!0==f.current){e.format=f.value;break}}if(a.styles&&0<a.styles.length)for(b=0,c=a.styles.length;b<c;b++)if(f=a.styles[b],!0==f.current){f.href?e.sld=f.href:f.body?e.sld_body=f.body:e.styles=f.name;break}this.layerParams&&
OpenLayers.Util.applyDefaults(e,this.layerParams);b=null;c=a.service;c==OpenLayers.Format.Context.serviceTypes.WFS?(d.strategies=[new OpenLayers.Strategy.BBOX],d.protocol=new OpenLayers.Protocol.WFS({url:a.url,featurePrefix:a.name.split(":")[0],featureType:a.name.split(":").pop()}),b=new OpenLayers.Layer.Vector(a.title||a.name,d)):c==OpenLayers.Format.Context.serviceTypes.KML?(d.strategies=[new OpenLayers.Strategy.Fixed],d.protocol=new OpenLayers.Protocol.HTTP({url:a.url,format:new OpenLayers.Format.KML}),
b=new OpenLayers.Layer.Vector(a.title||a.name,d)):c==OpenLayers.Format.Context.serviceTypes.GML?(d.strategies=[new OpenLayers.Strategy.Fixed],d.protocol=new OpenLayers.Protocol.HTTP({url:a.url,format:new OpenLayers.Format.GML}),b=new OpenLayers.Layer.Vector(a.title||a.name,d)):a.features?(b=new OpenLayers.Layer.Vector(a.title||a.name,d),b.addFeatures(a.features)):!0!==a.categoryLayer&&(b=new OpenLayers.Layer.WMS(a.title||a.name,a.url,e,d));return b},getLayersFromContext:function(a){for(var b=[],c=
0,d=a.length;c<d;c++){var e=this.getLayerFromContext(a[c]);null!==e&&b.push(e)}return b},contextToMap:function(a,b){b=OpenLayers.Util.applyDefaults({maxExtent:a.maxExtent,projection:a.projection,units:a.units},b);b.maxExtent&&(b.maxResolution=b.maxExtent.getWidth()/OpenLayers.Map.TILE_WIDTH);b.metadata={contactInformation:a.contactInformation,"abstract":a["abstract"],keywords:a.keywords,logo:a.logo,descriptionURL:a.descriptionURL};var c=new OpenLayers.Map(b);c.addLayers(this.getLayersFromContext(a.layersContext));
c.setCenter(a.bounds.getCenterLonLat(),c.getZoomForExtent(a.bounds,!0));return c},mergeContextToMap:function(a,b){b.addLayers(this.getLayersFromContext(a.layersContext));return b},write:function(a,b){a=this.toContext(a);return OpenLayers.Format.XML.VersionedOGC.prototype.write.apply(this,arguments)},CLASS_NAME:"OpenLayers.Format.Context"});
OpenLayers.Format.Context.serviceTypes={WMS:"urn:ogc:serviceType:WMS",WFS:"urn:ogc:serviceType:WFS",WCS:"urn:ogc:serviceType:WCS",GML:"urn:ogc:serviceType:GML",SLD:"urn:ogc:serviceType:SLD",FES:"urn:ogc:serviceType:FES",KML:"urn:ogc:serviceType:KML"};OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"1.1.0",layerToContext:function(a){var b=this.getParser(),c={queryable:a.queryable,visibility:a.visibility,name:a.params.LAYERS,title:a.name,"abstract":a.metadata["abstract"],dataURL:a.metadata.dataURL,metadataURL:a.metadataURL,server:{version:a.params.VERSION,url:a.url},maxExtent:a.maxExtent,transparent:a.params.TRANSPARENT,numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:1==a.opacity?void 0:
a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,tileSize:a.singleTile||!a.tileSize?void 0:{width:a.tileSize.w,height:a.tileSize.h},minScale:a.options.resolutions||a.options.scales||a.options.maxResolution||a.options.minScale?a.minScale:void 0,maxScale:a.options.resolutions||a.options.scales||a.options.minResolution||a.options.maxScale?a.maxScale:void 0,formats:[],styles:[],srs:a.srs,dimensions:a.dimensions};a.metadata.servertitle&&(c.server.title=a.metadata.servertitle);
if(a.metadata.formats&&0<a.metadata.formats.length)for(var d=0,e=a.metadata.formats.length;d<e;d++){var f=a.metadata.formats[d];c.formats.push({value:f.value,current:f.value==a.params.FORMAT})}else c.formats.push({value:a.params.FORMAT,current:!0});if(a.metadata.styles&&0<a.metadata.styles.length)for(d=0,e=a.metadata.styles.length;d<e;d++)b=a.metadata.styles[d],b.current=b.href==a.params.SLD||b.body==a.params.SLD_BODY||b.name==a.params.STYLES?!0:!1,c.styles.push(b);else c.styles.push({href:a.params.SLD,
body:a.params.SLD_BODY,name:a.params.STYLES||b.defaultStyleName,title:b.defaultStyleTitle,current:!0});return c},toContext:function(a){var b={},c=a.layers;if("OpenLayers.Map"==a.CLASS_NAME){var d=a.metadata||{};b.size=a.getSize();b.bounds=a.getExtent();b.projection=a.projection;b.title=a.title;b.keywords=d.keywords;b["abstract"]=d["abstract"];b.logo=d.logo;b.descriptionURL=d.descriptionURL;b.contactInformation=d.contactInformation;b.maxExtent=a.maxExtent}else OpenLayers.Util.applyDefaults(b,a),void 0!=
b.layers&&delete b.layers;void 0==b.layersContext&&(b.layersContext=[]);if(void 0!=c&&OpenLayers.Util.isArray(c))for(a=0,d=c.length;a<d;a++){var e=c[a];e instanceof OpenLayers.Layer.WMS&&b.layersContext.push(this.layerToContext(e))}return b},CLASS_NAME:"OpenLayers.Format.WMC"});OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(a){var b=null;if(null==a)b=this.namespaces[this.defaultPrefix];else for(b in this.namespaces)if(this.namespaces[b]==a)break;return b},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"",
defaultStyleTitle:"Default",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a=a.documentElement;this.rootPrefix=a.prefix;var b={version:a.getAttribute("version")};this.runChildNodes(b,a);return b},runChildNodes:function(a,b){for(var c=b.childNodes,d,e,f,g=0,h=c.length;g<h;++g)d=c[g],1==d.nodeType&&(e=this.getNamespacePrefix(d.namespaceURI),f=d.nodeName.split(":").pop(),
(e=this["read_"+e+"_"+f])&&e.apply(this,[a,d]))},read_wmc_General:function(a,b){this.runChildNodes(a,b)},read_wmc_BoundingBox:function(a,b){a.projection=b.getAttribute("SRS");a.bounds=new OpenLayers.Bounds(b.getAttribute("minx"),b.getAttribute("miny"),b.getAttribute("maxx"),b.getAttribute("maxy"))},read_wmc_LayerList:function(a,b){a.layersContext=[];this.runChildNodes(a,b)},read_wmc_Layer:function(a,b){var c={visibility:"1"!=b.getAttribute("hidden"),queryable:"1"==b.getAttribute("queryable"),formats:[],
styles:[],metadata:{}};this.runChildNodes(c,b);a.layersContext.push(c)},read_wmc_Extension:function(a,b){this.runChildNodes(a,b)},read_ol_units:function(a,b){a.units=this.getChildValue(b)},read_ol_maxExtent:function(a,b){var c=new OpenLayers.Bounds(b.getAttribute("minx"),b.getAttribute("miny"),b.getAttribute("maxx"),b.getAttribute("maxy"));a.maxExtent=c},read_ol_transparent:function(a,b){a.transparent=this.getChildValue(b)},read_ol_numZoomLevels:function(a,b){a.numZoomLevels=parseInt(this.getChildValue(b))},
read_ol_opacity:function(a,b){a.opacity=parseFloat(this.getChildValue(b))},read_ol_singleTile:function(a,b){a.singleTile="true"==this.getChildValue(b)},read_ol_tileSize:function(a,b){var c={width:b.getAttribute("width"),height:b.getAttribute("height")};a.tileSize=c},read_ol_isBaseLayer:function(a,b){a.isBaseLayer="true"==this.getChildValue(b)},read_ol_displayInLayerSwitcher:function(a,b){a.displayInLayerSwitcher="true"==this.getChildValue(b)},read_wmc_Server:function(a,b){a.version=b.getAttribute("version");
a.url=this.getOnlineResource_href(b);a.metadata.servertitle=b.getAttribute("title")},read_wmc_FormatList:function(a,b){this.runChildNodes(a,b)},read_wmc_Format:function(a,b){var c={value:this.getChildValue(b)};"1"==b.getAttribute("current")&&(c.current=!0);a.formats.push(c)},read_wmc_StyleList:function(a,b){this.runChildNodes(a,b)},read_wmc_Style:function(a,b){var c={};this.runChildNodes(c,b);"1"==b.getAttribute("current")&&(c.current=!0);a.styles.push(c)},read_wmc_SLD:function(a,b){this.runChildNodes(a,
b)},read_sld_StyledLayerDescriptor:function(a,b){var c=OpenLayers.Format.XML.prototype.write.apply(this,[b]);a.body=c},read_sld_FeatureTypeStyle:function(a,b){var c=OpenLayers.Format.XML.prototype.write.apply(this,[b]);a.body=c},read_wmc_OnlineResource:function(a,b){a.href=this.getAttributeNS(b,this.namespaces.xlink,"href")},read_wmc_Name:function(a,b){var c=this.getChildValue(b);c&&(a.name=c)},read_wmc_Title:function(a,b){var c=this.getChildValue(b);c&&(a.title=c)},read_wmc_MetadataURL:function(a,
b){a.metadataURL=this.getOnlineResource_href(b)},read_wmc_KeywordList:function(a,b){a.keywords=[];this.runChildNodes(a.keywords,b)},read_wmc_Keyword:function(a,b){a.push(this.getChildValue(b))},read_wmc_Abstract:function(a,b){var c=this.getChildValue(b);c&&(a["abstract"]=c)},read_wmc_LogoURL:function(a,b){a.logo={width:b.getAttribute("width"),height:b.getAttribute("height"),format:b.getAttribute("format"),href:this.getOnlineResource_href(b)}},read_wmc_DescriptionURL:function(a,b){a.descriptionURL=
this.getOnlineResource_href(b)},read_wmc_ContactInformation:function(a,b){var c={};this.runChildNodes(c,b);a.contactInformation=c},read_wmc_ContactPersonPrimary:function(a,b){var c={};this.runChildNodes(c,b);a.personPrimary=c},read_wmc_ContactPerson:function(a,b){var c=this.getChildValue(b);c&&(a.person=c)},read_wmc_ContactOrganization:function(a,b){var c=this.getChildValue(b);c&&(a.organization=c)},read_wmc_ContactPosition:function(a,b){var c=this.getChildValue(b);c&&(a.position=c)},read_wmc_ContactAddress:function(a,
b){var c={};this.runChildNodes(c,b);a.contactAddress=c},read_wmc_AddressType:function(a,b){var c=this.getChildValue(b);c&&(a.type=c)},read_wmc_Address:function(a,b){var c=this.getChildValue(b);c&&(a.address=c)},read_wmc_City:function(a,b){var c=this.getChildValue(b);c&&(a.city=c)},read_wmc_StateOrProvince:function(a,b){var c=this.getChildValue(b);c&&(a.stateOrProvince=c)},read_wmc_PostCode:function(a,b){var c=this.getChildValue(b);c&&(a.postcode=c)},read_wmc_Country:function(a,b){var c=this.getChildValue(b);
c&&(a.country=c)},read_wmc_ContactVoiceTelephone:function(a,b){var c=this.getChildValue(b);c&&(a.phone=c)},read_wmc_ContactFacsimileTelephone:function(a,b){var c=this.getChildValue(b);c&&(a.fax=c)},read_wmc_ContactElectronicMailAddress:function(a,b){var c=this.getChildValue(b);c&&(a.email=c)},read_wmc_DataURL:function(a,b){a.dataURL=this.getOnlineResource_href(b)},read_wmc_LegendURL:function(a,b){var c={width:b.getAttribute("width"),height:b.getAttribute("height"),format:b.getAttribute("format"),
href:this.getOnlineResource_href(b)};a.legend=c},read_wmc_DimensionList:function(a,b){a.dimensions={};this.runChildNodes(a.dimensions,b)},read_wmc_Dimension:function(a,b){var c={name:b.getAttribute("name").toLowerCase(),units:b.getAttribute("units")||"",unitSymbol:b.getAttribute("unitSymbol")||"",userValue:b.getAttribute("userValue")||"",nearestValue:"1"===b.getAttribute("nearestValue"),multipleValues:"1"===b.getAttribute("multipleValues"),current:"1"===b.getAttribute("current"),"default":b.getAttribute("default")||
""},d=this.getChildValue(b);c.values=d.split(",");a[c.name]=c},write:function(a,b){var c=this.createElementDefaultNS("ViewContext");this.setAttributes(c,{version:this.VERSION,id:b&&"string"==typeof b.id?b.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")});this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);c.appendChild(this.write_wmc_General(a));c.appendChild(this.write_wmc_LayerList(a));return OpenLayers.Format.XML.prototype.write.apply(this,[c])},createElementDefaultNS:function(a,
b,c){a=this.createElementNS(this.namespaces[this.defaultPrefix],a);b&&a.appendChild(this.createTextNode(b));c&&this.setAttributes(a,c);return a},setAttributes:function(a,b){var c,d;for(d in b)c=b[d].toString(),c.match(/[A-Z]/)?this.setAttributeNS(a,null,d,c):a.setAttribute(d,c)},write_wmc_General:function(a){var b=this.createElementDefaultNS("General");a.size&&b.appendChild(this.createElementDefaultNS("Window",null,{width:a.size.w,height:a.size.h}));var c=a.bounds;b.appendChild(this.createElementDefaultNS("BoundingBox",
null,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18),maxy:c.top.toPrecision(18),SRS:a.projection}));b.appendChild(this.createElementDefaultNS("Title",a.title));a.keywords&&b.appendChild(this.write_wmc_KeywordList(a.keywords));a["abstract"]&&b.appendChild(this.createElementDefaultNS("Abstract",a["abstract"]));a.logo&&b.appendChild(this.write_wmc_URLType("LogoURL",a.logo.href,a.logo));a.descriptionURL&&b.appendChild(this.write_wmc_URLType("DescriptionURL",a.descriptionURL));
a.contactInformation&&b.appendChild(this.write_wmc_ContactInformation(a.contactInformation));b.appendChild(this.write_ol_MapExtension(a));return b},write_wmc_KeywordList:function(a){for(var b=this.createElementDefaultNS("KeywordList"),c=0,d=a.length;c<d;c++)b.appendChild(this.createElementDefaultNS("Keyword",a[c]));return b},write_wmc_ContactInformation:function(a){var b=this.createElementDefaultNS("ContactInformation");a.personPrimary&&b.appendChild(this.write_wmc_ContactPersonPrimary(a.personPrimary));
a.position&&b.appendChild(this.createElementDefaultNS("ContactPosition",a.position));a.contactAddress&&b.appendChild(this.write_wmc_ContactAddress(a.contactAddress));a.phone&&b.appendChild(this.createElementDefaultNS("ContactVoiceTelephone",a.phone));a.fax&&b.appendChild(this.createElementDefaultNS("ContactFacsimileTelephone",a.fax));a.email&&b.appendChild(this.createElementDefaultNS("ContactElectronicMailAddress",a.email));return b},write_wmc_ContactPersonPrimary:function(a){var b=this.createElementDefaultNS("ContactPersonPrimary");
a.person&&b.appendChild(this.createElementDefaultNS("ContactPerson",a.person));a.organization&&b.appendChild(this.createElementDefaultNS("ContactOrganization",a.organization));return b},write_wmc_ContactAddress:function(a){var b=this.createElementDefaultNS("ContactAddress");a.type&&b.appendChild(this.createElementDefaultNS("AddressType",a.type));a.address&&b.appendChild(this.createElementDefaultNS("Address",a.address));a.city&&b.appendChild(this.createElementDefaultNS("City",a.city));a.stateOrProvince&&
b.appendChild(this.createElementDefaultNS("StateOrProvince",a.stateOrProvince));a.postcode&&b.appendChild(this.createElementDefaultNS("PostCode",a.postcode));a.country&&b.appendChild(this.createElementDefaultNS("Country",a.country));return b},write_ol_MapExtension:function(a){var b=this.createElementDefaultNS("Extension");if(a=a.maxExtent){var c=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(c,{minx:a.left.toPrecision(18),miny:a.bottom.toPrecision(18),maxx:a.right.toPrecision(18),
maxy:a.top.toPrecision(18)});b.appendChild(c)}return b},write_wmc_LayerList:function(a){for(var b=this.createElementDefaultNS("LayerList"),c=0,d=a.layersContext.length;c<d;++c)b.appendChild(this.write_wmc_Layer(a.layersContext[c]));return b},write_wmc_Layer:function(a){var b=this.createElementDefaultNS("Layer",null,{queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1"});b.appendChild(this.write_wmc_Server(a));b.appendChild(this.createElementDefaultNS("Name",a.name));b.appendChild(this.createElementDefaultNS("Title",
a.title));a["abstract"]&&b.appendChild(this.createElementDefaultNS("Abstract",a["abstract"]));a.dataURL&&b.appendChild(this.write_wmc_URLType("DataURL",a.dataURL));a.metadataURL&&b.appendChild(this.write_wmc_URLType("MetadataURL",a.metadataURL));return b},write_wmc_LayerExtension:function(a){var b=this.createElementDefaultNS("Extension"),c=a.maxExtent,d=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(d,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18),
maxy:c.top.toPrecision(18)});b.appendChild(d);a.tileSize&&!a.singleTile&&(c=this.createElementNS(this.namespaces.ol,"ol:tileSize"),this.setAttributes(c,a.tileSize),b.appendChild(c));for(var c="transparent numZoomLevels units isBaseLayer opacity displayInLayerSwitcher singleTile".split(" "),e=0,f=c.length;e<f;++e)(d=this.createOLPropertyNode(a,c[e]))&&b.appendChild(d);return b},createOLPropertyNode:function(a,b){var c=null;null!=a[b]&&(c=this.createElementNS(this.namespaces.ol,"ol:"+b),c.appendChild(this.createTextNode(a[b].toString())));
return c},write_wmc_Server:function(a){a=a.server;var b=this.createElementDefaultNS("Server"),c={service:"OGC:WMS",version:a.version};a.title&&(c.title=a.title);this.setAttributes(b,c);b.appendChild(this.write_wmc_OnlineResource(a.url));return b},write_wmc_URLType:function(a,b,c){a=this.createElementDefaultNS(a);a.appendChild(this.write_wmc_OnlineResource(b));if(c){b=["width","height","format"];for(var d=0;d<b.length;d++)b[d]in c&&a.setAttribute(b[d],c[b[d]])}return a},write_wmc_DimensionList:function(a){var b=
this.createElementDefaultNS("DimensionList"),c;for(c in a.dimensions){var d={},e=a.dimensions[c],f;for(f in e)d[f]="boolean"==typeof e[f]?Number(e[f]):e[f];e="";d.values&&(e=d.values.join(","),delete d.values);b.appendChild(this.createElementDefaultNS("Dimension",e,d))}return b},write_wmc_FormatList:function(a){for(var b=this.createElementDefaultNS("FormatList"),c=0,d=a.formats.length;c<d;c++){var e=a.formats[c];b.appendChild(this.createElementDefaultNS("Format",e.value,e.current&&!0==e.current?{current:"1"}:
null))}return b},write_wmc_StyleList:function(a){var b=this.createElementDefaultNS("StyleList");if((a=a.styles)&&OpenLayers.Util.isArray(a))for(var c,d=0,e=a.length;d<e;d++){var f=a[d],g=this.createElementDefaultNS("Style",null,f.current&&!0==f.current?{current:"1"}:null);f.href?(c=this.createElementDefaultNS("SLD"),f.name&&c.appendChild(this.createElementDefaultNS("Name",f.name)),f.title&&c.appendChild(this.createElementDefaultNS("Title",f.title)),f.legend&&c.appendChild(this.write_wmc_URLType("LegendURL",
f.legend.href,f.legend)),f=this.write_wmc_OnlineResource(f.href),c.appendChild(f),g.appendChild(c)):f.body?(c=this.createElementDefaultNS("SLD"),f.name&&c.appendChild(this.createElementDefaultNS("Name",f.name)),f.title&&c.appendChild(this.createElementDefaultNS("Title",f.title)),f.legend&&c.appendChild(this.write_wmc_URLType("LegendURL",f.legend.href,f.legend)),f=OpenLayers.Format.XML.prototype.read.apply(this,[f.body]).documentElement,c.ownerDocument&&c.ownerDocument.importNode&&(f=c.ownerDocument.importNode(f,
!0)),c.appendChild(f),g.appendChild(c)):(g.appendChild(this.createElementDefaultNS("Name",f.name)),g.appendChild(this.createElementDefaultNS("Title",f.title)),f["abstract"]&&g.appendChild(this.createElementDefaultNS("Abstract",f["abstract"])),f.legend&&g.appendChild(this.write_wmc_URLType("LegendURL",f.legend.href,f.legend)));b.appendChild(g)}return b},write_wmc_OnlineResource:function(a){var b=this.createElementDefaultNS("OnlineResource");this.setAttributeNS(b,this.namespaces.xlink,"xlink:type",
"simple");this.setAttributeNS(b,this.namespaces.xlink,"xlink:href",a);return b},getOnlineResource_href:function(a){var b={};a=a.getElementsByTagName("OnlineResource");0<a.length&&this.read_wmc_OnlineResource(b,a[0]);return b.href},CLASS_NAME:"OpenLayers.Format.WMC.v1"});OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{slideFactor:50,slideRatio:null,initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);a={slideFactor:this.slideFactor,slideRatio:this.slideRatio};this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST,a)])},
CLASS_NAME:"OpenLayers.Control.PanPanel"});OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,
addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var a=[];if(this.map&&this.map.layers){for(var b=0,c=this.map.layers.length;b<c;b++){var d=this.map.layers[b];d.attribution&&d.getVisibility()&&-1===OpenLayers.Util.indexOf(a,d.attribution)&&a.push(d.attribution)}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:a.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"});OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:0.0035,nbPoints:100,delay:200,points:void 0,timerId:void 0,initialize:function(a){OpenLayers.Util.extend(this,a)},begin:function(){OpenLayers.Animation.stop(this.timerId);this.timerId=void 0;this.points=[]},update:function(a){this.points.unshift({xy:a,tick:(new Date).getTime()});this.points.length>this.nbPoints&&this.points.pop()},end:function(a){for(var b,c=(new Date).getTime(),d=0,e=this.points.length,f;d<e;d++){f=this.points[d];if(c-
f.tick>this.delay)break;b=f}if(b&&(d=(new Date).getTime()-b.tick,c=Math.sqrt(Math.pow(a.x-b.xy.x,2)+Math.pow(a.y-b.xy.y,2)),d=c/d,!(0==d||d<this.threshold)))return c=Math.asin((a.y-b.xy.y)/c),b.xy.x<=a.x&&(c=Math.PI-c),{speed:d,theta:c}},move:function(a,b){var c=a.speed,d=Math.cos(a.theta),e=-Math.sin(a.theta),f=(new Date).getTime(),g=0,h=0;this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(function(){if(null!=this.timerId){var a=(new Date).getTime()-f,l=-this.deceleration*Math.pow(a,
2)/2+c*a,m=l*d,l=l*e,n,p;n=!1;0>=-this.deceleration*a+c&&(OpenLayers.Animation.stop(this.timerId),this.timerId=null,n=!0);a=m-g;p=l-h;g=m;h=l;b(a,p,n)}},this))},CLASS_NAME:"OpenLayers.Kinetic"});OpenLayers.Format.WPSExecute=OpenLayers.Class(OpenLayers.Format.XML,OpenLayers.Format.Filter.v1_1_0,{namespaces:{ows:"http://www.opengis.net/ows/1.1",gml:"http://www.opengis.net/gml",wps:"http://www.opengis.net/wps/1.0.0",wfs:"http://www.opengis.net/wfs",ogc:"http://www.opengis.net/ogc",wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",
schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",schemaLocationAttr:function(a){},write:function(a){var b;window.ActiveXObject?this.xmldom=b=new ActiveXObject("Microsoft.XMLDOM"):b=document.implementation.createDocument("","",null);a=this.writeNode("wps:Execute",a,b);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},read:function(a){"string"==typeof a&&(a=
OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},writers:{wps:{Execute:function(a){var b=this.createElementNSPlus("wps:Execute",{attributes:{version:this.VERSION,service:"WPS"}});this.writeNode("ows:Identifier",a.identifier,b);this.writeNode("wps:DataInputs",a.dataInputs,b);this.writeNode("wps:ResponseForm",a.responseForm,b);return b},ResponseForm:function(a){var b=this.createElementNSPlus("wps:ResponseForm",{});a.rawDataOutput&&
this.writeNode("wps:RawDataOutput",a.rawDataOutput,b);a.responseDocument&&this.writeNode("wps:ResponseDocument",a.responseDocument,b);return b},ResponseDocument:function(a){var b=this.createElementNSPlus("wps:ResponseDocument",{attributes:{storeExecuteResponse:a.storeExecuteResponse,lineage:a.lineage,status:a.status}});if(a.outputs)for(var c=0,d=a.outputs.length;c<d;c++)this.writeNode("wps:Output",a.outputs[c],b);return b},Output:function(a){var b=this.createElementNSPlus("wps:Output",{attributes:{asReference:a.asReference,
mimeType:a.mimeType,encoding:a.encoding,schema:a.schema}});this.writeNode("ows:Identifier",a.identifier,b);this.writeNode("ows:Title",a.title,b);this.writeNode("ows:Abstract",a["abstract"],b);return b},RawDataOutput:function(a){var b=this.createElementNSPlus("wps:RawDataOutput",{attributes:{mimeType:a.mimeType,encoding:a.encoding,schema:a.schema}});this.writeNode("ows:Identifier",a.identifier,b);return b},DataInputs:function(a){for(var b=this.createElementNSPlus("wps:DataInputs",{}),c=0,d=a.length;c<
d;++c)this.writeNode("wps:Input",a[c],b);return b},Input:function(a){var b=this.createElementNSPlus("wps:Input",{});this.writeNode("ows:Identifier",a.identifier,b);a.title&&this.writeNode("ows:Title",a.title,b);a.data&&this.writeNode("wps:Data",a.data,b);a.reference&&this.writeNode("wps:Reference",a.reference,b);a.boundingBoxData&&this.writeNode("wps:BoundingBoxData",a.boundingBoxData,b);return b},Data:function(a){var b=this.createElementNSPlus("wps:Data",{});a.literalData?this.writeNode("wps:LiteralData",
a.literalData,b):a.complexData?this.writeNode("wps:ComplexData",a.complexData,b):a.boundingBoxData&&this.writeNode("ows:BoundingBox",a.boundingBoxData,b);return b},LiteralData:function(a){return this.createElementNSPlus("wps:LiteralData",{attributes:{uom:a.uom},value:a.value})},ComplexData:function(a){var b=this.createElementNSPlus("wps:ComplexData",{attributes:{mimeType:a.mimeType,encoding:a.encoding,schema:a.schema}}),c=a.value;"string"===typeof c?b.appendChild(this.getXMLDoc().createCDATASection(a.value)):
b.appendChild(c);return b},Reference:function(a){var b=this.createElementNSPlus("wps:Reference",{attributes:{mimeType:a.mimeType,"xlink:href":a.href,method:a.method,encoding:a.encoding,schema:a.schema}});a.body&&this.writeNode("wps:Body",a.body,b);return b},BoundingBoxData:function(a,b){this.writers.ows.BoundingBox.apply(this,[a,b,"wps:BoundingBoxData"])},Body:function(a){var b=this.createElementNSPlus("wps:Body",{});a.wcs?this.writeNode("wcs:GetCoverage",a.wcs,b):a.wfs?(this.featureType=a.wfs.featureType,
this.version=a.wfs.version,this.writeNode("wfs:GetFeature",a.wfs,b)):this.writeNode("wps:Execute",a,b);return b}},wcs:OpenLayers.Format.WCSGetCoverage.prototype.writers.wcs,wfs:OpenLayers.Format.WFST.v1_1_0.prototype.writers.wfs,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc,ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},readers:{wps:{ExecuteResponse:function(a,b){b.executeResponse={lang:a.getAttribute("lang"),statusLocation:a.getAttribute("statusLocation"),serviceInstance:a.getAttribute("serviceInstance"),
service:a.getAttribute("service")};this.readChildNodes(a,b.executeResponse)},Process:function(a,b){b.process={};this.readChildNodes(a,b.process)},Status:function(a,b){b.status={creationTime:a.getAttribute("creationTime")};this.readChildNodes(a,b.status)},ProcessSucceeded:function(a,b){b.processSucceeded=!0},ProcessOutputs:function(a,b){b.processOutputs=[];this.readChildNodes(a,b.processOutputs)},Output:function(a,b){var c={};this.readChildNodes(a,c);b.push(c)},Reference:function(a,b){b.reference=
{href:a.getAttribute("href"),mimeType:a.getAttribute("mimeType"),encoding:a.getAttribute("encoding"),schema:a.getAttribute("schema")}},Data:function(a,b){b.data={};this.readChildNodes(a,b)},LiteralData:function(a,b){b.literalData={dataType:a.getAttribute("dataType"),uom:a.getAttribute("uom"),value:this.getChildValue(a)}},ComplexData:function(a,b){b.complexData={mimeType:a.getAttribute("mimeType"),schema:a.getAttribute("schema"),encoding:a.getAttribute("encoding"),value:""};if(this.isSimpleContent(a)){var c;
for(c=a.firstChild;c;c=c.nextSibling)switch(c.nodeType){case 3:case 4:b.complexData.value+=c.nodeValue}}else for(c=a.firstChild;c;c=c.nextSibling)1==c.nodeType&&(b.complexData.value=c)},BoundingBox:function(a,b){b.boundingBoxData={dimensions:a.getAttribute("dimensions"),crs:a.getAttribute("crs")};this.readChildNodes(a,b.boundingBoxData)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSExecute"});OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,icon:null,popupSize:null,useFeedTitle:!0,initialize:function(a,b,c){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[a,c]);this.location=b;this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadRSS:function(){this.loaded||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location,
success:this.parseData,scope:this}),this.loaded=!0)},moveTo:function(a,b,c){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);this.visibility&&!this.loaded&&this.loadRSS()},parseData:function(a){var b=a.responseXML;b&&b.documentElement||(b=OpenLayers.Format.XML.prototype.read(a.responseText));if(this.useFeedTitle){a=null;try{a=b.getElementsByTagNameNS("*","title")[0].firstChild.nodeValue}catch(c){a=b.getElementsByTagName("title")[0].firstChild.nodeValue}a&&this.setName(a)}a={};OpenLayers.Util.extend(a,
this.formatOptions);this.map&&!this.projection.equals(this.map.getProjectionObject())&&(a.externalProjection=this.projection,a.internalProjection=this.map.getProjectionObject());b=(new OpenLayers.Format.GeoRSS(a)).read(b);a=0;for(var d=b.length;a<d;a++){var e={},f=b[a];if(f.geometry){var g=f.attributes.title?f.attributes.title:"Untitled",h=f.attributes.description?f.attributes.description:"No description.",k=f.attributes.link?f.attributes.link:"",f=f.geometry.getBounds().getCenterLonLat();e.icon=
null==this.icon?OpenLayers.Marker.defaultIcon():this.icon.clone();e.popupSize=this.popupSize?this.popupSize.clone():new OpenLayers.Size(250,120);if(g||h){e.title=g;e.description=h;var l='<div class="olLayerGeoRSSClose">[x]</div>',l=l+'<div class="olLayerGeoRSSTitle">';k&&(l+='<a class="link" href="'+k+'" target="_blank">');l+=g;k&&(l+="</a>");l+="</div>";l+='<div style="" class="olLayerGeoRSSDescription">';l+=h;l+="</div>";e.popupContentHTML=l}f=new OpenLayers.Feature(this,f,e);this.features.push(f);
e=f.createMarker();e.events.register("click",f,this.markerClick);this.addMarker(e)}}this.events.triggerEvent("loadend")},markerClick:function(a){var b=this==this.layer.selectedFeature;this.layer.selectedFeature=b?null:this;for(var c=0,d=this.layer.map.popups.length;c<d;c++)this.layer.map.removePopup(this.layer.map.popups[c]);b||(b=this.createPopup(),OpenLayers.Event.observe(b.div,"click",OpenLayers.Function.bind(function(){for(var a=0,b=this.layer.map.popups.length;a<b;a++)this.layer.map.removePopup(this.layer.map.popups[a])},
this)),this.layer.map.addPopup(b));OpenLayers.Event.stop(a)},clearFeatures:function(){if(null!=this.features)for(;0<this.features.length;){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a);a.destroy()}},CLASS_NAME:"OpenLayers.Layer.GeoRSS"});OpenLayers.Symbolizer.Point=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Point"});OpenLayers.Symbolizer.Line=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Line"});OpenLayers.Symbolizer.Text=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Text"});OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:"http://www.opengis.net/sld",ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"sld",schemaLocation:null,multipleSymbolizers:!1,featureTypeCounter:null,defaultSymbolizer:{fillColor:"#808080",fillOpacity:1,strokeColor:"#000000",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"solid",pointRadius:3,
graphicName:"square"},read:function(a,b){b=OpenLayers.Util.applyDefaults(b,this.options);var c={namedLayers:!0===b.namedLayersAsArray?[]:{}};this.readChildNodes(a,c);return c},readers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(a,b){b.version=a.getAttribute("version");this.readChildNodes(a,b)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b.description=this.getChildValue(a)},NamedLayer:function(a,b){var c=
{userStyles:[],namedStyles:[]};this.readChildNodes(a,c);for(var d=0,e=c.userStyles.length;d<e;++d)c.userStyles[d].layerName=c.name;OpenLayers.Util.isArray(b.namedLayers)?b.namedLayers.push(c):b.namedLayers[c.name]=c},NamedStyle:function(a,b){b.namedStyles.push(this.getChildName(a.firstChild))},UserStyle:function(a,b){var c={defaultsPerSymbolizer:!0,rules:[]};this.featureTypeCounter=-1;this.readChildNodes(a,c);this.multipleSymbolizers?(delete c.defaultsPerSymbolizer,c=new OpenLayers.Style2(c)):c=new OpenLayers.Style(this.defaultSymbolizer,
c);b.userStyles.push(c)},IsDefault:function(a,b){"1"==this.getChildValue(a)&&(b.isDefault=!0)},FeatureTypeStyle:function(a,b){++this.featureTypeCounter;var c={rules:this.multipleSymbolizers?b.rules:[]};this.readChildNodes(a,c);this.multipleSymbolizers||(b.rules=c.rules)},Rule:function(a,b){var c;this.multipleSymbolizers&&(c={symbolizers:[]});c=new OpenLayers.Rule(c);this.readChildNodes(a,c);b.rules.push(c)},ElseFilter:function(a,b){b.elseFilter=!0},MinScaleDenominator:function(a,b){b.minScaleDenominator=
parseFloat(this.getChildValue(a))},MaxScaleDenominator:function(a,b){b.maxScaleDenominator=parseFloat(this.getChildValue(a))},TextSymbolizer:function(a,b){var c={};this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Text(c))):b.symbolizer.Text=OpenLayers.Util.applyDefaults(c,b.symbolizer.Text)},LabelPlacement:function(a,b){this.readChildNodes(a,b)},PointPlacement:function(a,b){var c={};this.readChildNodes(a,c);c.labelRotation=
c.rotation;delete c.rotation;var d,e=b.labelAnchorPointX,f=b.labelAnchorPointY;e<=1/3?d="l":e>1/3&&e<2/3?d="c":e>=2/3&&(d="r");f<=1/3?d+="b":f>1/3&&f<2/3?d+="m":f>=2/3&&(d+="t");c.labelAlign=d;OpenLayers.Util.applyDefaults(b,c)},AnchorPoint:function(a,b){this.readChildNodes(a,b)},AnchorPointX:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.labelAnchorPointX=c)},AnchorPointY:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.labelAnchorPointY=c)},Displacement:function(a,
b){this.readChildNodes(a,b)},DisplacementX:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.labelXOffset=c)},DisplacementY:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.labelYOffset=c)},LinePlacement:function(a,b){this.readChildNodes(a,b)},PerpendicularOffset:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.labelPerpendicularOffset=c)},Label:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.label=c)},Font:function(a,b){this.readChildNodes(a,
b)},Halo:function(a,b){var c={};this.readChildNodes(a,c);b.haloRadius=c.haloRadius;b.haloColor=c.fillColor;b.haloOpacity=c.fillOpacity},Radius:function(a,b){var c=this.readers.ogc._expression.call(this,a);null!=c&&(b.haloRadius=c)},RasterSymbolizer:function(a,b){var c={};this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Raster(c))):b.symbolizer.Raster=OpenLayers.Util.applyDefaults(c,b.symbolizer.Raster)},Geometry:function(a,
b){b.geometry={};this.readChildNodes(a,b.geometry)},ColorMap:function(a,b){b.colorMap=[];this.readChildNodes(a,b.colorMap)},ColorMapEntry:function(a,b){var c=a.getAttribute("quantity"),d=a.getAttribute("opacity");b.push({color:a.getAttribute("color"),quantity:null!==c?parseFloat(c):void 0,label:a.getAttribute("label")||void 0,opacity:null!==d?parseFloat(d):void 0})},LineSymbolizer:function(a,b){var c={};this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Line(c))):
b.symbolizer.Line=OpenLayers.Util.applyDefaults(c,b.symbolizer.Line)},PolygonSymbolizer:function(a,b){var c={fill:!1,stroke:!1};this.multipleSymbolizers||(c=b.symbolizer.Polygon||c);this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Polygon(c))):b.symbolizer.Polygon=c},PointSymbolizer:function(a,b){var c={fill:!1,stroke:!1,graphic:!1};this.multipleSymbolizers||(c=b.symbolizer.Point||c);this.readChildNodes(a,c);this.multipleSymbolizers?
(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Point(c))):b.symbolizer.Point=c},Stroke:function(a,b){b.stroke=!0;this.readChildNodes(a,b)},Fill:function(a,b){b.fill=!0;this.readChildNodes(a,b)},CssParameter:function(a,b){var c=a.getAttribute("name"),d=this.cssMap[c];b.label&&("fill"===c?d="fontColor":"fill-opacity"===c&&(d="fontOpacity"));d&&(c=this.readers.ogc._expression.call(this,a))&&(b[d]=c)},Graphic:function(a,b){b.graphic=!0;var c={};this.readChildNodes(a,c);
for(var d="stroke strokeColor strokeWidth strokeOpacity strokeLinecap fill fillColor fillOpacity graphicName rotation graphicFormat".split(" "),e,f,g=0,h=d.length;g<h;++g)e=d[g],f=c[e],void 0!=f&&(b[e]=f);void 0!=c.opacity&&(b.graphicOpacity=c.opacity);void 0!=c.size&&(isNaN(c.size/2)?b.graphicWidth=c.size:b.pointRadius=c.size/2);void 0!=c.href&&(b.externalGraphic=c.href);void 0!=c.rotation&&(b.rotation=c.rotation)},ExternalGraphic:function(a,b){this.readChildNodes(a,b)},Mark:function(a,b){this.readChildNodes(a,
b)},WellKnownName:function(a,b){b.graphicName=this.getChildValue(a)},Opacity:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.opacity=c)},Size:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.size=c)},Rotation:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.rotation=c)},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},Format:function(a,b){b.graphicFormat=this.getChildValue(a)}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers),
cssMap:{stroke:"strokeColor","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","stroke-linecap":"strokeLinecap","stroke-dasharray":"strokeDashstyle",fill:"fillColor","fill-opacity":"fillOpacity","font-family":"fontFamily","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle"},getCssProperty:function(a){var b=null,c;for(c in this.cssMap)if(this.cssMap[c]==a){b=c;break}return b},getGraphicFormat:function(a){var b,c;for(c in this.graphicFormats)if(this.graphicFormats[c].test(a)){b=
c;break}return b||this.defaultGraphicFormat},defaultGraphicFormat:"image/png",graphicFormats:{"image/jpeg":/\.jpe?g$/i,"image/gif":/\.gif$/i,"image/png":/\.png$/i},write:function(a){return this.writers.sld.StyledLayerDescriptor.apply(this,[a])},writers:OpenLayers.Util.applyDefaults({sld:{_OGCExpression:function(a,b){var c=this.createElementNSPlus(a),d="string"==typeof b?b.split("${"):[b];c.appendChild(this.createTextNode(d[0]));for(var e,f,g=1,h=d.length;g<h;g++)e=d[g],f=e.indexOf("}"),0<f?(this.writeNode("ogc:PropertyName",
{property:e.substring(0,f)},c),c.appendChild(this.createTextNode(e.substring(++f)))):c.appendChild(this.createTextNode("${"+e));return c},StyledLayerDescriptor:function(a){var b=this.createElementNSPlus("sld:StyledLayerDescriptor",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});b.setAttribute("xmlns:ogc",this.namespaces.ogc);b.setAttribute("xmlns:gml",this.namespaces.gml);a.name&&this.writeNode("Name",a.name,b);a.title&&this.writeNode("Title",a.title,b);a.description&&
this.writeNode("Abstract",a.description,b);if(OpenLayers.Util.isArray(a.namedLayers))for(var c=0,d=a.namedLayers.length;c<d;++c)this.writeNode("NamedLayer",a.namedLayers[c],b);else for(c in a.namedLayers)this.writeNode("NamedLayer",a.namedLayers[c],b);return b},Name:function(a){return this.createElementNSPlus("sld:Name",{value:a})},Title:function(a){return this.createElementNSPlus("sld:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("sld:Abstract",{value:a})},NamedLayer:function(a){var b=
this.createElementNSPlus("sld:NamedLayer");this.writeNode("Name",a.name,b);if(a.namedStyles)for(var c=0,d=a.namedStyles.length;c<d;++c)this.writeNode("NamedStyle",a.namedStyles[c],b);if(a.userStyles)for(c=0,d=a.userStyles.length;c<d;++c)this.writeNode("UserStyle",a.userStyles[c],b);return b},NamedStyle:function(a){var b=this.createElementNSPlus("sld:NamedStyle");this.writeNode("Name",a,b);return b},UserStyle:function(a){var b=this.createElementNSPlus("sld:UserStyle");a.name&&this.writeNode("Name",
a.name,b);a.title&&this.writeNode("Title",a.title,b);a.description&&this.writeNode("Abstract",a.description,b);a.isDefault&&this.writeNode("IsDefault",a.isDefault,b);if(this.multipleSymbolizers&&a.rules){for(var c={0:[]},d=[0],e,f,g,h,k,l=0,m=a.rules.length;l<m;++l)if(e=a.rules[l],e.symbolizers){f={};for(var n=0,p=e.symbolizers.length;n<p;++n)g=e.symbolizers[n],h=g.zIndex,h in f||(k=e.clone(),k.symbolizers=[],f[h]=k),f[h].symbolizers.push(g.clone());for(h in f)h in c||(d.push(h),c[h]=[]),c[h].push(f[h])}else c[0].push(e.clone());
d.sort();l=0;for(m=d.length;l<m;++l)e=c[d[l]],0<e.length&&(k=a.clone(),k.rules=c[d[l]],this.writeNode("FeatureTypeStyle",k,b))}else this.writeNode("FeatureTypeStyle",a,b);return b},IsDefault:function(a){return this.createElementNSPlus("sld:IsDefault",{value:a?"1":"0"})},FeatureTypeStyle:function(a){for(var b=this.createElementNSPlus("sld:FeatureTypeStyle"),c=0,d=a.rules.length;c<d;++c)this.writeNode("Rule",a.rules[c],b);return b},Rule:function(a){var b=this.createElementNSPlus("sld:Rule");a.name&&
this.writeNode("Name",a.name,b);a.title&&this.writeNode("Title",a.title,b);a.description&&this.writeNode("Abstract",a.description,b);a.elseFilter?this.writeNode("ElseFilter",null,b):a.filter&&this.writeNode("ogc:Filter",a.filter,b);void 0!=a.minScaleDenominator&&this.writeNode("MinScaleDenominator",a.minScaleDenominator,b);void 0!=a.maxScaleDenominator&&this.writeNode("MaxScaleDenominator",a.maxScaleDenominator,b);var c,d;if(this.multipleSymbolizers&&a.symbolizers)for(var e=0,f=a.symbolizers.length;e<
f;++e)d=a.symbolizers[e],c=d.CLASS_NAME.split(".").pop(),this.writeNode(c+"Symbolizer",d,b);else for(var f=OpenLayers.Style.SYMBOLIZER_PREFIXES,e=0,g=f.length;e<g;++e)c=f[e],(d=a.symbolizer[c])&&this.writeNode(c+"Symbolizer",d,b);return b},ElseFilter:function(){return this.createElementNSPlus("sld:ElseFilter")},MinScaleDenominator:function(a){return this.createElementNSPlus("sld:MinScaleDenominator",{value:a})},MaxScaleDenominator:function(a){return this.createElementNSPlus("sld:MaxScaleDenominator",
{value:a})},LineSymbolizer:function(a){var b=this.createElementNSPlus("sld:LineSymbolizer");this.writeNode("Stroke",a,b);return b},Stroke:function(a){var b=this.createElementNSPlus("sld:Stroke");void 0!=a.strokeColor&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeColor"},b);void 0!=a.strokeOpacity&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeOpacity"},b);void 0!=a.strokeWidth&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeWidth"},b);void 0!=a.strokeDashstyle&&"solid"!==
a.strokeDashstyle&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeDashstyle"},b);void 0!=a.strokeLinecap&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeLinecap"},b);return b},CssParameter:function(a){return this.createElementNSPlus("sld:CssParameter",{attributes:{name:this.getCssProperty(a.key)},value:a.symbolizer[a.key]})},TextSymbolizer:function(a){var b=this.createElementNSPlus("sld:TextSymbolizer");null!=a.label&&this.writeNode("Label",a.label,b);null==a.fontFamily&&null==a.fontSize&&
null==a.fontWeight&&null==a.fontStyle||this.writeNode("Font",a,b);null==a.labelAnchorPointX&&null==a.labelAnchorPointY&&null==a.labelAlign&&null==a.labelXOffset&&null==a.labelYOffset&&null==a.labelRotation&&null==a.labelPerpendicularOffset||this.writeNode("LabelPlacement",a,b);null==a.haloRadius&&null==a.haloColor&&null==a.haloOpacity||this.writeNode("Halo",a,b);null==a.fontColor&&null==a.fontOpacity||this.writeNode("Fill",{fillColor:a.fontColor,fillOpacity:a.fontOpacity},b);return b},LabelPlacement:function(a){var b=
this.createElementNSPlus("sld:LabelPlacement");null==a.labelAnchorPointX&&null==a.labelAnchorPointY&&null==a.labelAlign&&null==a.labelXOffset&&null==a.labelYOffset&&null==a.labelRotation||null!=a.labelPerpendicularOffset||this.writeNode("PointPlacement",a,b);null!=a.labelPerpendicularOffset&&this.writeNode("LinePlacement",a,b);return b},LinePlacement:function(a){var b=this.createElementNSPlus("sld:LinePlacement");this.writeNode("PerpendicularOffset",a.labelPerpendicularOffset,b);return b},PerpendicularOffset:function(a){return this.createElementNSPlus("sld:PerpendicularOffset",
{value:a})},PointPlacement:function(a){var b=this.createElementNSPlus("sld:PointPlacement");null==a.labelAnchorPointX&&null==a.labelAnchorPointY&&null==a.labelAlign||this.writeNode("AnchorPoint",a,b);null==a.labelXOffset&&null==a.labelYOffset||this.writeNode("Displacement",a,b);null!=a.labelRotation&&this.writeNode("Rotation",a.labelRotation,b);return b},AnchorPoint:function(a){var b=this.createElementNSPlus("sld:AnchorPoint"),c=a.labelAnchorPointX,d=a.labelAnchorPointY;null!=c&&this.writeNode("AnchorPointX",
c,b);null!=d&&this.writeNode("AnchorPointY",d,b);if(null==c&&null==d){var e=a.labelAlign.substr(0,1);a=a.labelAlign.substr(1,1);"l"===e?c=0:"c"===e?c=0.5:"r"===e&&(c=1);"b"===a?d=0:"m"===a?d=0.5:"t"===a&&(d=1);this.writeNode("AnchorPointX",c,b);this.writeNode("AnchorPointY",d,b)}return b},AnchorPointX:function(a){return this.createElementNSPlus("sld:AnchorPointX",{value:a})},AnchorPointY:function(a){return this.createElementNSPlus("sld:AnchorPointY",{value:a})},Displacement:function(a){var b=this.createElementNSPlus("sld:Displacement");
null!=a.labelXOffset&&this.writeNode("DisplacementX",a.labelXOffset,b);null!=a.labelYOffset&&this.writeNode("DisplacementY",a.labelYOffset,b);return b},DisplacementX:function(a){return this.createElementNSPlus("sld:DisplacementX",{value:a})},DisplacementY:function(a){return this.createElementNSPlus("sld:DisplacementY",{value:a})},Font:function(a){var b=this.createElementNSPlus("sld:Font");a.fontFamily&&this.writeNode("CssParameter",{symbolizer:a,key:"fontFamily"},b);a.fontSize&&this.writeNode("CssParameter",
{symbolizer:a,key:"fontSize"},b);a.fontWeight&&this.writeNode("CssParameter",{symbolizer:a,key:"fontWeight"},b);a.fontStyle&&this.writeNode("CssParameter",{symbolizer:a,key:"fontStyle"},b);return b},Label:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Label",a)},Halo:function(a){var b=this.createElementNSPlus("sld:Halo");a.haloRadius&&this.writeNode("Radius",a.haloRadius,b);(a.haloColor||a.haloOpacity)&&this.writeNode("Fill",{fillColor:a.haloColor,fillOpacity:a.haloOpacity},b);
return b},Radius:function(a){return this.createElementNSPlus("sld:Radius",{value:a})},RasterSymbolizer:function(a){var b=this.createElementNSPlus("sld:RasterSymbolizer");a.geometry&&this.writeNode("Geometry",a.geometry,b);a.opacity&&this.writeNode("Opacity",a.opacity,b);a.colorMap&&this.writeNode("ColorMap",a.colorMap,b);return b},Geometry:function(a){var b=this.createElementNSPlus("sld:Geometry");a.property&&this.writeNode("ogc:PropertyName",a,b);return b},ColorMap:function(a){for(var b=this.createElementNSPlus("sld:ColorMap"),
c=0,d=a.length;c<d;++c)this.writeNode("ColorMapEntry",a[c],b);return b},ColorMapEntry:function(a){var b=this.createElementNSPlus("sld:ColorMapEntry");b.setAttribute("color",a.color);void 0!==a.opacity&&b.setAttribute("opacity",parseFloat(a.opacity));void 0!==a.quantity&&b.setAttribute("quantity",parseFloat(a.quantity));void 0!==a.label&&b.setAttribute("label",a.label);return b},PolygonSymbolizer:function(a){var b=this.createElementNSPlus("sld:PolygonSymbolizer");!1!==a.fill&&this.writeNode("Fill",
a,b);!1!==a.stroke&&this.writeNode("Stroke",a,b);return b},Fill:function(a){var b=this.createElementNSPlus("sld:Fill");a.fillColor&&this.writeNode("CssParameter",{symbolizer:a,key:"fillColor"},b);null!=a.fillOpacity&&this.writeNode("CssParameter",{symbolizer:a,key:"fillOpacity"},b);return b},PointSymbolizer:function(a){var b=this.createElementNSPlus("sld:PointSymbolizer");this.writeNode("Graphic",a,b);return b},Graphic:function(a){var b=this.createElementNSPlus("sld:Graphic");void 0!=a.externalGraphic?
this.writeNode("ExternalGraphic",a,b):this.writeNode("Mark",a,b);void 0!=a.graphicOpacity&&this.writeNode("Opacity",a.graphicOpacity,b);void 0!=a.pointRadius?this.writeNode("Size",2*a.pointRadius,b):void 0!=a.graphicWidth&&this.writeNode("Size",a.graphicWidth,b);void 0!=a.rotation&&this.writeNode("Rotation",a.rotation,b);return b},ExternalGraphic:function(a){var b=this.createElementNSPlus("sld:ExternalGraphic");this.writeNode("OnlineResource",a.externalGraphic,b);a=a.graphicFormat||this.getGraphicFormat(a.externalGraphic);
this.writeNode("Format",a,b);return b},Mark:function(a){var b=this.createElementNSPlus("sld:Mark");a.graphicName&&this.writeNode("WellKnownName",a.graphicName,b);!1!==a.fill&&this.writeNode("Fill",a,b);!1!==a.stroke&&this.writeNode("Stroke",a,b);return b},WellKnownName:function(a){return this.createElementNSPlus("sld:WellKnownName",{value:a})},Opacity:function(a){return this.createElementNSPlus("sld:Opacity",{value:a})},Size:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Size",
a)},Rotation:function(a){return this.createElementNSPlus("sld:Rotation",{value:a})},OnlineResource:function(a){return this.createElementNSPlus("sld:OnlineResource",{attributes:{"xlink:type":"simple","xlink:href":a}})},Format:function(a){return this.createElementNSPlus("sld:Format",{value:a})}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),CLASS_NAME:"OpenLayers.Format.SLD.v1"});OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(a,b,c,d){var e=[];c=OpenLayers.Util.upperCaseObject(c);1.3<=parseFloat(c.VERSION)&&!c.EXCEPTIONS&&(c.EXCEPTIONS="INIMAGE");e.push(a,b,c,d);OpenLayers.Layer.Grid.prototype.initialize.apply(this,e);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));
!this.noMagic&&(this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase())&&(null!=d&&d.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.params.FORMAT&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"))},clone:function(a){null==a&&(a=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},reverseAxisOrder:function(){var a=this.projection.getCode();return 1.3<=parseFloat(this.params.VERSION)&&
!!(this.yx[a]||OpenLayers.Projection.defaults[a]&&OpenLayers.Projection.defaults[a].yx)},getURL:function(a){a=this.adjustBounds(a);var b=this.getImageSize(),c={},d=this.reverseAxisOrder();c.BBOX=this.encodeBBOX?a.toBBOX(null,d):a.toArray(d);c.WIDTH=b.w;c.HEIGHT=b.h;return this.getFullRequestString(c)},mergeNewParams:function(a){a=[OpenLayers.Util.upperCaseObject(a)];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},getFullRequestString:function(a,b){var c=this.map.getProjectionObject(),
c=this.projection&&this.projection.equals(c)?this.projection.getCode():c.getCode(),c="none"==c?null:c;1.3<=parseFloat(this.params.VERSION)?this.params.CRS=c:this.params.SRS=c;"boolean"==typeof this.params.TRANSPARENT&&(a.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE");return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,DEFAULT_PARAMS:{i:"jpeg",map:""},initialize:function(a,b,c,d){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getURL:function(a){a=this.adjustBounds(a);var b=this.map.getResolution(),c=Math.round(1E4*this.map.getScale())/1E4,d=Math.round(a.left/b);a=-Math.round(a.top/b);return this.getFullRequestString({t:a,l:d,s:c})},calculateGridLayout:function(a,
b,c){b=c*this.tileSize.w;c*=this.tileSize.h;return{tilelon:b,tilelat:c,startcol:Math.floor(a.left/b)-this.buffer,startrow:Math.floor(a.top/c)+this.buffer}},getTileBoundsForGridIndex:function(a,b){this.getTileOrigin();var c=this.gridLayout,d=c.tilelon,e=c.tilelat,f=(c.startcol+b)*d,c=(c.startrow-a)*e;return new OpenLayers.Bounds(f,c,f+d,c+e)},clone:function(a){null==a&&(a=new OpenLayers.Layer.KaMap(this.name,this.url,this.params,this.getOptions()));a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a]);null!=this.tileSize&&(a.tileSize=this.tileSize.clone());a.grid=[];return a},getTileBounds:function(a){var b=this.getResolution(),c=b*this.tileSize.w,b=b*this.tileSize.h,d=this.getLonLatFromViewPortPx(a);a=c*Math.floor(d.lon/c);d=b*Math.floor(d.lat/b);return new OpenLayers.Bounds(a,d,a+c,d+b)},CLASS_NAME:"OpenLayers.Layer.KaMap"});OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},read_sld_MinScaleDenominator:function(a,b){var c=parseFloat(this.getChildValue(b));0<c&&(a.maxScale=c)},read_sld_MaxScaleDenominator:function(a,b){a.minScale=parseFloat(this.getChildValue(b))},read_wmc_SRS:function(a,b){"srs"in
a||(a.srs={});a.srs[this.getChildValue(b)]=!0},write_wmc_Layer:function(a){var b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[a]);if(a.maxScale){var c=this.createElementNS(this.namespaces.sld,"sld:MinScaleDenominator");c.appendChild(this.createTextNode(a.maxScale.toPrecision(16)));b.appendChild(c)}a.minScale&&(c=this.createElementNS(this.namespaces.sld,"sld:MaxScaleDenominator"),c.appendChild(this.createTextNode(a.minScale.toPrecision(16))),b.appendChild(c));if(a.srs)for(var d in a.srs)b.appendChild(this.createElementDefaultNS("SRS",
d));b.appendChild(this.write_wmc_FormatList(a));b.appendChild(this.write_wmc_StyleList(a));a.dimensions&&b.appendChild(this.write_wmc_DimensionList(a));b.appendChild(this.write_wmc_LayerExtension(a));return b},CLASS_NAME:"OpenLayers.Format.WMC.v1_1_0"});OpenLayers.Format.XLS=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",stringifyOutput:!0,CLASS_NAME:"OpenLayers.Format.XLS"});OpenLayers.Format.XLS.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xls:"http://www.opengis.net/xls",gml:"http://www.opengis.net/gml",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},xy:!0,defaultPrefix:"xls",schemaLocation:null,read:function(a,b){OpenLayers.Util.applyDefaults(b,this.options);var c={};this.readChildNodes(a,c);return c},readers:{xls:{XLS:function(a,b){b.version=a.getAttribute("version");
this.readChildNodes(a,b)},Response:function(a,b){this.readChildNodes(a,b)},GeocodeResponse:function(a,b){b.responseLists=[];this.readChildNodes(a,b)},GeocodeResponseList:function(a,b){var c={features:[],numberOfGeocodedAddresses:parseInt(a.getAttribute("numberOfGeocodedAddresses"))};b.responseLists.push(c);this.readChildNodes(a,c)},GeocodedAddress:function(a,b){var c=new OpenLayers.Feature.Vector;b.features.push(c);this.readChildNodes(a,c);c.geometry=c.components[0]},GeocodeMatchCode:function(a,b){b.attributes.matchCode=
{accuracy:parseFloat(a.getAttribute("accuracy")),matchType:a.getAttribute("matchType")}},Address:function(a,b){var c={countryCode:a.getAttribute("countryCode"),addressee:a.getAttribute("addressee"),street:[],place:[]};b.attributes.address=c;this.readChildNodes(a,c)},freeFormAddress:function(a,b){b.freeFormAddress=this.getChildValue(a)},StreetAddress:function(a,b){this.readChildNodes(a,b)},Building:function(a,b){b.building={number:a.getAttribute("number"),subdivision:a.getAttribute("subdivision"),
buildingName:a.getAttribute("buildingName")}},Street:function(a,b){b.street.push(this.getChildValue(a))},Place:function(a,b){b.place[a.getAttribute("type")]=this.getChildValue(a)},PostalCode:function(a,b){b.postalCode=this.getChildValue(a)}},gml:OpenLayers.Format.GML.v3.prototype.readers.gml},write:function(a){return this.writers.xls.XLS.apply(this,[a])},writers:{xls:{XLS:function(a){var b=this.createElementNSPlus("xls:XLS",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});
this.writeNode("RequestHeader",a.header,b);this.writeNode("Request",a,b);return b},RequestHeader:function(a){return this.createElementNSPlus("xls:RequestHeader")},Request:function(a){var b=this.createElementNSPlus("xls:Request",{attributes:{methodName:"GeocodeRequest",requestID:a.requestID||"",version:this.VERSION}});this.writeNode("GeocodeRequest",a.addresses,b);return b},GeocodeRequest:function(a){for(var b=this.createElementNSPlus("xls:GeocodeRequest"),c=0,d=a.length;c<d;c++)this.writeNode("Address",
a[c],b);return b},Address:function(a){var b=this.createElementNSPlus("xls:Address",{attributes:{countryCode:a.countryCode}});a.freeFormAddress?this.writeNode("freeFormAddress",a.freeFormAddress,b):(a.street&&this.writeNode("StreetAddress",a,b),a.municipality&&this.writeNode("Municipality",a.municipality,b),a.countrySubdivision&&this.writeNode("CountrySubdivision",a.countrySubdivision,b),a.postalCode&&this.writeNode("PostalCode",a.postalCode,b));return b},freeFormAddress:function(a){return this.createElementNSPlus("freeFormAddress",
{value:a})},StreetAddress:function(a){var b=this.createElementNSPlus("xls:StreetAddress");a.building&&this.writeNode(b,"Building",a.building);a=a.street;OpenLayers.Util.isArray(a)||(a=[a]);for(var c=0,d=a.length;c<d;c++)this.writeNode("Street",a[c],b);return b},Building:function(a){return this.createElementNSPlus("xls:Building",{attributes:{number:a.number,subdivision:a.subdivision,buildingName:a.buildingName}})},Street:function(a){return this.createElementNSPlus("xls:Street",{value:a})},Municipality:function(a){return this.createElementNSPlus("xls:Place",
{attributes:{type:"Municipality"},value:a})},CountrySubdivision:function(a){return this.createElementNSPlus("xls:Place",{attributes:{type:"CountrySubdivision"},value:a})},PostalCode:function(a){return this.createElementNSPlus("xls:PostalCode",{value:a})}}},CLASS_NAME:"OpenLayers.Format.XLS.v1"});OpenLayers.Format.XLS.v1_1_0=OpenLayers.Class(OpenLayers.Format.XLS.v1,{VERSION:"1.1",schemaLocation:"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.1.0/LocationUtilityService.xsd",CLASS_NAME:"OpenLayers.Format.XLS.v1_1_0"});OpenLayers.Format.XLS.v1_1=OpenLayers.Format.XLS.v1_1_0;OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15E3,translationParameters:null,symbolMetrics:null,initialize:function(a){this.supported()&&(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={})},supported:function(){return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG",
"1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))},inValidRange:function(a,b,c){a+=c?0:this.translationParameters.x;b+=c?0:this.translationParameters.y;return a>=-this.MAX_PIXEL&&a<=this.MAX_PIXEL&&b>=-this.MAX_PIXEL&&b<=this.MAX_PIXEL},setExtent:function(a,b){var c=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),d=this.getResolution(),e=-a.left/d,d=a.top/d;if(b)return this.left=e,this.top=d,this.rendererRoot.setAttributeNS(null,
"viewBox","0 0 "+this.size.w+" "+this.size.h),this.translate(this.xOffset,0),!0;(e=this.translate(e-this.left+this.xOffset,d-this.top))||this.setExtent(a,!0);return c&&e},translate:function(a,b){if(this.inValidRange(a,b,!0)){var c="";if(a||b)c="translate("+a+","+b+")";this.root.setAttributeNS(null,"transform",c);this.translationParameters={x:a,y:b};return!0}return!1},setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,"width",this.size.w);
this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":c=b.externalGraphic?"image":this.isComplexSymbol(b.graphicName)?"svg":"circle";break;case "OpenLayers.Geometry.Rectangle":c="rect";break;case "OpenLayers.Geometry.LineString":c="polyline";break;case "OpenLayers.Geometry.LinearRing":c="polygon";break;case "OpenLayers.Geometry.Polygon":case "OpenLayers.Geometry.Curve":c="path"}return c},setStyle:function(a,
b,c){b=b||a._style;c=c||a._options;var d=b.title||b.graphicTitle;if(d){a.setAttributeNS(null,"title",d);var e=a.getElementsByTagName("title");0<e.length?e[0].firstChild.textContent=d:(e=this.nodeFactory(null,"title"),e.textContent=d,a.appendChild(e))}var e=parseFloat(a.getAttributeNS(null,"r")),d=1,f;if("OpenLayers.Geometry.Point"==a._geometryClass&&e){a.style.visibility="";if(!1===b.graphic)a.style.visibility="hidden";else if(b.externalGraphic){f=this.getPosition(a);b.graphicWidth&&b.graphicHeight&&
a.setAttributeNS(null,"preserveAspectRatio","none");var e=b.graphicWidth||b.graphicHeight,g=b.graphicHeight||b.graphicWidth,e=e?e:2*b.pointRadius,g=g?g:2*b.pointRadius,h=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*g),k=b.graphicOpacity||b.fillOpacity;a.setAttributeNS(null,"x",(f.x+(void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*e))).toFixed());a.setAttributeNS(null,"y",(f.y+h).toFixed());a.setAttributeNS(null,"width",e);a.setAttributeNS(null,"height",g);a.setAttributeNS(this.xlinkns,"xlink:href",
b.externalGraphic);a.setAttributeNS(null,"style","opacity: "+k);a.onclick=OpenLayers.Event.preventDefault}else if(this.isComplexSymbol(b.graphicName)){var e=3*b.pointRadius,g=2*e,l=this.importSymbol(b.graphicName);f=this.getPosition(a);d=3*this.symbolMetrics[l.id][0]/g;h=a.parentNode;k=a.nextSibling;h&&h.removeChild(a);a.firstChild&&a.removeChild(a.firstChild);a.appendChild(l.firstChild.cloneNode(!0));a.setAttributeNS(null,"viewBox",l.getAttributeNS(null,"viewBox"));a.setAttributeNS(null,"width",
g);a.setAttributeNS(null,"height",g);a.setAttributeNS(null,"x",f.x-e);a.setAttributeNS(null,"y",f.y-e);k?h.insertBefore(a,k):h&&h.appendChild(a)}else a.setAttributeNS(null,"r",b.pointRadius);e=b.rotation;void 0===e&&void 0===a._rotation||!f||(a._rotation=e,e|=0,"svg"!==a.nodeName?a.setAttributeNS(null,"transform","rotate("+e+" "+f.x+" "+f.y+")"):(f=this.symbolMetrics[l.id],a.firstChild.setAttributeNS(null,"transform","rotate("+e+" "+f[1]+" "+f[2]+")")))}c.isFilled?(a.setAttributeNS(null,"fill",b.fillColor),
a.setAttributeNS(null,"fill-opacity",b.fillOpacity)):a.setAttributeNS(null,"fill","none");c.isStroked?(a.setAttributeNS(null,"stroke",b.strokeColor),a.setAttributeNS(null,"stroke-opacity",b.strokeOpacity),a.setAttributeNS(null,"stroke-width",b.strokeWidth*d),a.setAttributeNS(null,"stroke-linecap",b.strokeLinecap||"round"),a.setAttributeNS(null,"stroke-linejoin","round"),b.strokeDashstyle&&a.setAttributeNS(null,"stroke-dasharray",this.dashStyle(b,d))):a.setAttributeNS(null,"stroke","none");b.pointerEvents&&
a.setAttributeNS(null,"pointer-events",b.pointerEvents);null!=b.cursor&&a.setAttributeNS(null,"cursor",b.cursor);return a},dashStyle:function(a,b){var c=a.strokeWidth*b,d=a.strokeDashstyle;switch(d){case "solid":return"none";case "dot":return[1,4*c].join();case "dash":return[4*c,4*c].join();case "dashdot":return[4*c,4*c,1,4*c].join();case "longdash":return[8*c,4*c].join();case "longdashdot":return[8*c,4*c,1,4*c].join();default:return OpenLayers.String.trim(d).replace(/\s+/g,",")}},createNode:function(a,
b){var c=document.createElementNS(this.xmlns,a);b&&c.setAttributeNS(null,"id",b);return c},nodeTypeCompare:function(a,b){return b==a.nodeName},createRenderRoot:function(){var a=this.nodeFactory(this.container.id+"_svgRoot","svg");a.style.display="block";return a},createRoot:function(a){return this.nodeFactory(this.container.id+a,"g")},createDefs:function(){var a=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(a);return a},drawPoint:function(a,b){return this.drawCircle(a,
b,1)},drawCircle:function(a,b,c){var d=this.getResolution(),e=(b.x-this.featureDx)/d+this.left;b=this.top-b.y/d;return this.inValidRange(e,b)?(a.setAttributeNS(null,"cx",e),a.setAttributeNS(null,"cy",b),a.setAttributeNS(null,"r",c),a):!1},drawLineString:function(a,b){var c=this.getComponentsString(b.components);return c.path?(a.setAttributeNS(null,"points",c.path),c.complete?a:null):!1},drawLinearRing:function(a,b){var c=this.getComponentsString(b.components);return c.path?(a.setAttributeNS(null,
"points",c.path),c.complete?a:null):!1},drawPolygon:function(a,b){for(var c="",d=!0,e=!0,f,g,h=0,k=b.components.length;h<k;h++)c+=" M",f=this.getComponentsString(b.components[h].components," "),(g=f.path)?(c+=" "+g,e=f.complete&&e):d=!1;return d?(a.setAttributeNS(null,"d",c+" z"),a.setAttributeNS(null,"fill-rule","evenodd"),e?a:null):!1},drawRectangle:function(a,b){var c=this.getResolution(),d=(b.x-this.featureDx)/c+this.left,e=this.top-b.y/c;return this.inValidRange(d,e)?(a.setAttributeNS(null,"x",
d),a.setAttributeNS(null,"y",e),a.setAttributeNS(null,"width",b.width/c),a.setAttributeNS(null,"height",b.height/c),a):!1},drawText:function(a,b,c){var d=!!b.labelOutlineWidth;if(d){var e=OpenLayers.Util.extend({},b);e.fontColor=e.labelOutlineColor;e.fontStrokeColor=e.labelOutlineColor;e.fontStrokeWidth=b.labelOutlineWidth;b.labelOutlineOpacity&&(e.fontOpacity=b.labelOutlineOpacity);delete e.labelOutlineWidth;this.drawText(a,e,c)}var f=this.getResolution(),e=(c.x-this.featureDx)/f+this.left,g=c.y/
f-this.top,d=d?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,f=this.nodeFactory(a+d,"text");f.setAttributeNS(null,"x",e);f.setAttributeNS(null,"y",-g);b.fontColor&&f.setAttributeNS(null,"fill",b.fontColor);b.fontStrokeColor&&f.setAttributeNS(null,"stroke",b.fontStrokeColor);b.fontStrokeWidth&&f.setAttributeNS(null,"stroke-width",b.fontStrokeWidth);b.fontOpacity&&f.setAttributeNS(null,"opacity",b.fontOpacity);b.fontFamily&&f.setAttributeNS(null,"font-family",b.fontFamily);b.fontSize&&f.setAttributeNS(null,
"font-size",b.fontSize);b.fontWeight&&f.setAttributeNS(null,"font-weight",b.fontWeight);b.fontStyle&&f.setAttributeNS(null,"font-style",b.fontStyle);!0===b.labelSelect?(f.setAttributeNS(null,"pointer-events","visible"),f._featureId=a):f.setAttributeNS(null,"pointer-events","none");g=b.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;f.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[g[0]]||"middle");!0===OpenLayers.IS_GECKO&&f.setAttributeNS(null,"dominant-baseline",
OpenLayers.Renderer.SVG.LABEL_ALIGN[g[1]]||"central");for(var h=b.label.split("\n"),k=h.length;f.childNodes.length>k;)f.removeChild(f.lastChild);for(var l=0;l<k;l++){var m=this.nodeFactory(a+d+"_tspan_"+l,"tspan");!0===b.labelSelect&&(m._featureId=a,m._geometry=c,m._geometryClass=c.CLASS_NAME);!1===OpenLayers.IS_GECKO&&m.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[g[1]]||"-35%");m.setAttribute("x",e);if(0==l){var n=OpenLayers.Renderer.SVG.LABEL_VFACTOR[g[1]];null==n&&
(n=-0.5);m.setAttribute("dy",n*(k-1)+"em")}else m.setAttribute("dy","1em");m.textContent=""===h[l]?" ":h[l];m.parentNode||f.appendChild(m)}f.parentNode||this.textRoot.appendChild(f)},getComponentsString:function(a,b){for(var c=[],d=!0,e=a.length,f=[],g,h=0;h<e;h++)g=a[h],c.push(g),(g=this.getShortString(g))?f.push(g):(0<h&&this.getShortString(a[h-1])&&f.push(this.clipLine(a[h],a[h-1])),h<e-1&&this.getShortString(a[h+1])&&f.push(this.clipLine(a[h],a[h+1])),d=!1);return{path:f.join(b||","),complete:d}},
clipLine:function(a,b){if(b.equals(a))return"";var c=this.getResolution(),d=this.MAX_PIXEL-this.translationParameters.x,e=this.MAX_PIXEL-this.translationParameters.y,f=(b.x-this.featureDx)/c+this.left,g=this.top-b.y/c,h=(a.x-this.featureDx)/c+this.left,c=this.top-a.y/c,k;if(h<-d||h>d)k=(c-g)/(h-f),h=0>h?-d:d,c=g+(h-f)*k;if(c<-e||c>e)k=(h-f)/(c-g),c=0>c?-e:e,h=f+(c-g)*k;return h+","+c},getShortString:function(a){var b=this.getResolution(),c=(a.x-this.featureDx)/b+this.left;a=this.top-a.y/b;return this.inValidRange(c,
a)?c+","+a:!1},getPosition:function(a){return{x:parseFloat(a.getAttributeNS(null,"cx")),y:parseFloat(a.getAttributeNS(null,"cy"))}},importSymbol:function(a){this.defs||(this.defs=this.createDefs());var b=this.container.id+"-"+a,c=document.getElementById(b);if(null!=c)return c;var d=OpenLayers.Renderer.symbol[a];if(!d)throw Error(a+" is not a valid symbol name");a=this.nodeFactory(b,"symbol");var e=this.nodeFactory(null,"polygon");a.appendChild(e);for(var c=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,
0,0),f=[],g,h,k=0;k<d.length;k+=2)g=d[k],h=d[k+1],c.left=Math.min(c.left,g),c.bottom=Math.min(c.bottom,h),c.right=Math.max(c.right,g),c.top=Math.max(c.top,h),f.push(g,",",h);e.setAttributeNS(null,"points",f.join(" "));d=c.getWidth();e=c.getHeight();a.setAttributeNS(null,"viewBox",[c.left-d,c.bottom-e,3*d,3*e].join(" "));this.symbolMetrics[b]=[Math.max(d,e),c.getCenterLonLat().lon,c.getCenterLonLat().lat];this.defs.appendChild(a);return a},getFeatureIdFromEvent:function(a){var b=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,
arguments);b||(b=a.target,b=b.parentNode&&b!=this.rendererRoot?b.parentNode._featureId:void 0);return b},CLASS_NAME:"OpenLayers.Renderer.SVG"});OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"};OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1};OpenLayers.Renderer.SVG.preventDefault=function(a){OpenLayers.Event.preventDefault(a)};OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0"});OpenLayers.Format.OWSContext=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"0.3.1",getVersion:function(a,b){var c=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this,arguments);"0.3.0"===c&&(c=this.defaultVersion);return c},toContext:function(a){var b={};"OpenLayers.Map"==a.CLASS_NAME&&(b.bounds=a.getExtent(),b.maxExtent=a.maxExtent,b.projection=a.projection,b.size=a.getSize(),b.layers=a.layers);return b},CLASS_NAME:"OpenLayers.Format.OWSContext"});OpenLayers.Format.OWSContext.v0_3_1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{owc:"http://www.opengis.net/ows-context",gml:"http://www.opengis.net/gml",kml:"http://www.opengis.net/kml/2.2",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},VERSION:"0.3.1",schemaLocation:"http://www.opengis.net/ows-context http://www.ogcnetwork.net/schemas/owc/0.3.1/owsContext.xsd",
defaultPrefix:"owc",extractAttributes:!0,xy:!0,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},featureNS:"http://mapserver.gis.umn.edu/mapserver",featureType:"vector",geometryName:"geometry",nestingLayerLookup:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);OpenLayers.Format.GML.v2.prototype.setGeometryTypes.call(this)},setNestingPath:function(a){if(a.layersContext)for(var b=0,c=a.layersContext.length;b<c;b++){var d=
a.layersContext[b],e=[],f=a.title||"";a.metadata&&a.metadata.nestingPath&&(e=a.metadata.nestingPath.slice());""!=f&&e.push(f);d.metadata.nestingPath=e;d.layersContext&&this.setNestingPath(d)}},decomposeNestingPath:function(a){var b=[];if(OpenLayers.Util.isArray(a)){for(a=a.slice();0<a.length;)b.push(a.slice()),a.pop();b.reverse()}return b},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,
b);this.setNestingPath({layersContext:b.layersContext});a=[];this.processLayer(a,b);delete b.layersContext;b.layersContext=a;return b},processLayer:function(a,b){if(b.layersContext)for(var c=0,d=b.layersContext.length;c<d;c++){var e=b.layersContext[c];a.push(e);e.layersContext&&this.processLayer(a,e)}},write:function(a,b){this.nestingLayerLookup={};b=b||{};OpenLayers.Util.applyDefaults(b,a);var c=this.writeNode("OWSContext",b);this.nestingLayerLookup=null;this.setAttributeNS(c,this.namespaces.xsi,
"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},readers:{kml:{Document:function(a,b){b.features=(new OpenLayers.Format.KML({kmlns:this.namespaces.kml,extractStyles:!0})).read(a)}},owc:{OWSContext:function(a,b){this.readChildNodes(a,b)},General:function(a,b){this.readChildNodes(a,b)},ResourceList:function(a,b){this.readChildNodes(a,b)},Layer:function(a,b){var c={metadata:{},visibility:"1"!=a.getAttribute("hidden"),queryable:"1"==a.getAttribute("queryable"),
opacity:null!=a.getAttribute("opacity")?parseFloat(a.getAttribute("opacity")):null,name:a.getAttribute("name"),categoryLayer:null==a.getAttribute("name"),formats:[],styles:[]};b.layersContext||(b.layersContext=[]);b.layersContext.push(c);this.readChildNodes(a,c)},InlineGeometry:function(a,b){b.features=[];var c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMember"),d;1<=c.length&&(d=c[0]);d&&d.firstChild&&(c=d.firstChild.nextSibling?d.firstChild.nextSibling:d.firstChild,this.setNamespace("feature",
c.namespaceURI),this.featureType=c.localName||c.nodeName.split(":").pop(),this.readChildNodes(a,b))},Server:function(a,b){if(!b.service&&!b.version||b.service!=OpenLayers.Format.Context.serviceTypes.WMS)b.service=a.getAttribute("service"),b.version=a.getAttribute("version"),this.readChildNodes(a,b)},Name:function(a,b){b.name=this.getChildValue(a);this.readChildNodes(a,b)},Title:function(a,b){b.title=this.getChildValue(a);this.readChildNodes(a,b)},StyleList:function(a,b){this.readChildNodes(a,b.styles)},
Style:function(a,b){var c={};b.push(c);this.readChildNodes(a,c)},LegendURL:function(a,b){var c={};b.legend=c;this.readChildNodes(a,c)},OnlineResource:function(a,b){b.url=this.getAttributeNS(a,this.namespaces.xlink,"href");this.readChildNodes(a,b)}},ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,gml:OpenLayers.Format.GML.v2.prototype.readers.gml,sld:OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{owc:{OWSContext:function(a){var b=
this.createElementNSPlus("OWSContext",{attributes:{version:this.VERSION,id:a.id||OpenLayers.Util.createUniqueID("OpenLayers_OWSContext_")}});this.writeNode("General",a,b);this.writeNode("ResourceList",a,b);return b},General:function(a){var b=this.createElementNSPlus("General");this.writeNode("ows:BoundingBox",a,b);this.writeNode("ows:Title",a.title||"OpenLayers OWSContext",b);return b},ResourceList:function(a){for(var b=this.createElementNSPlus("ResourceList"),c=0,d=a.layers.length;c<d;c++){var e=
a.layers[c],f=this.decomposeNestingPath(e.metadata.nestingPath);this.writeNode("_Layer",{layer:e,subPaths:f},b)}return b},Server:function(a){var b=this.createElementNSPlus("Server",{attributes:{version:a.version,service:a.service}});this.writeNode("OnlineResource",a,b);return b},OnlineResource:function(a){return this.createElementNSPlus("OnlineResource",{attributes:{"xlink:href":a.url}})},InlineGeometry:function(a){var b=this.createElementNSPlus("InlineGeometry"),c=a.getDataExtent();null!==c&&this.writeNode("gml:boundedBy",
c,b);for(var c=0,d=a.features.length;c<d;c++)this.writeNode("gml:featureMember",a.features[c],b);return b},StyleList:function(a){for(var b=this.createElementNSPlus("StyleList"),c=0,d=a.length;c<d;c++)this.writeNode("Style",a[c],b);return b},Style:function(a){var b=this.createElementNSPlus("Style");this.writeNode("Name",a,b);this.writeNode("Title",a,b);a.legend&&this.writeNode("LegendURL",a,b);return b},Name:function(a){return this.createElementNSPlus("Name",{value:a.name})},Title:function(a){return this.createElementNSPlus("Title",
{value:a.title})},LegendURL:function(a){var b=this.createElementNSPlus("LegendURL");this.writeNode("OnlineResource",a.legend,b);return b},_WMS:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:a.params.LAYERS,queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1",opacity:a.hasOwnProperty("opacity")?a.opacity:null}});this.writeNode("ows:Title",a.name,b);this.writeNode("ows:OutputFormat",a.params.FORMAT,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WMS,
version:a.params.VERSION,url:a.url},b);a.metadata.styles&&0<a.metadata.styles.length&&this.writeNode("StyleList",a.metadata.styles,b);return b},_Layer:function(a){var b,c,d;b=a.layer;c=a.subPaths;d=null;0<c.length?(b=c[0].join("/"),c=b.lastIndexOf("/"),d=this.nestingLayerLookup[b],c=0<c?b.substring(c+1,b.length):b,d||(d=this.createElementNSPlus("Layer"),this.writeNode("ows:Title",c,d),this.nestingLayerLookup[b]=d),a.subPaths.shift(),this.writeNode("_Layer",a,d)):(b instanceof OpenLayers.Layer.WMS?
d=this.writeNode("_WMS",b):b instanceof OpenLayers.Layer.Vector&&(b.protocol instanceof OpenLayers.Protocol.WFS.v1?d=this.writeNode("_WFS",b):b.protocol instanceof OpenLayers.Protocol.HTTP?b.protocol.format instanceof OpenLayers.Format.GML?(b.protocol.format.version="2.1.2",d=this.writeNode("_GML",b)):b.protocol.format instanceof OpenLayers.Format.KML&&(b.protocol.format.version="2.2",d=this.writeNode("_KML",b)):(this.setNamespace("feature",this.featureNS),d=this.writeNode("_InlineGeometry",b))),
b.options.maxScale&&this.writeNode("sld:MinScaleDenominator",b.options.maxScale,d),b.options.minScale&&this.writeNode("sld:MaxScaleDenominator",b.options.minScale,d),this.nestingLayerLookup[b.name]=d);return d},_WFS:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:a.protocol.featurePrefix+":"+a.protocol.featureType,hidden:a.visibility?"0":"1"}});this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WFS,version:a.protocol.version,
url:a.protocol.url},b);return b},_InlineGeometry:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:this.featureType,hidden:a.visibility?"0":"1"}});this.writeNode("ows:Title",a.name,b);this.writeNode("InlineGeometry",a,b);return b},_GML:function(a){var b=this.createElementNSPlus("Layer");this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.GML,url:a.protocol.url,version:a.protocol.format.version},b);return b},_KML:function(a){var b=
this.createElementNSPlus("Layer");this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.KML,version:a.protocol.format.version,url:a.protocol.url},b);return b}},gml:OpenLayers.Util.applyDefaults({boundedBy:function(a){var b=this.createElementNSPlus("gml:boundedBy");this.writeNode("gml:Box",a,b);return b}},OpenLayers.Format.GML.v2.prototype.writers.gml),ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.writers.ows,sld:OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld,
feature:OpenLayers.Format.GML.v2.prototype.writers.feature},CLASS_NAME:"OpenLayers.Format.OWSContext.v0_3_1"});OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:!1,fixPadding:function(){"number"==typeof this.padding&&(this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding))},panMapIfOutOfView:!1,
keepInMap:!1,closeOnMove:!1,map:null,initialize:function(a,b,c,d,e,f){null==a&&(a=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"));this.id=a;this.lonlat=b;this.contentSize=null!=c?c:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);null!=d&&(this.contentHTML=d);this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden");this.div.className=this.displayClass;
this.groupDiv=OpenLayers.Util.createDiv(this.id+"_GroupDiv",null,null,null,"relative",null,"hidden");a=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(a,null,this.contentSize.clone(),null,"relative");this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);e&&this.addCloseBox(f);this.registerEvents()},destroy:function(){this.border=this.opacity=this.backgroundColor=this.contentHTML=this.size=this.lonlat=this.id=
null;this.closeOnMove&&this.map&&this.map.events.unregister("movestart",this,this.hide);this.events.destroy();this.events=null;this.closeDiv&&(OpenLayers.Event.stopObservingElement(this.closeDiv),this.groupDiv.removeChild(this.closeDiv));this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;null!=this.map&&this.map.removePopup(this);this.panMapIfOutOfView=this.padding=this.maxSize=this.minSize=this.autoSize=this.div=this.map=null},draw:function(a){null==a&&null!=this.lonlat&&null!=
this.map&&(a=this.map.getLayerPxFromLonLat(this.lonlat));this.closeOnMove&&this.map.events.register("movestart",this,this.hide);this.disableFirefoxOverflowHack||"firefox"!=OpenLayers.BROWSER_NAME||(this.map.events.register("movestart",this,function(){var a=document.defaultView.getComputedStyle(this.contentDiv,null).getPropertyValue("overflow");"hidden"!=a&&(this.contentDiv._oldOverflow=a,this.contentDiv.style.overflow="hidden")}),this.map.events.register("moveend",this,function(){var a=this.contentDiv._oldOverflow;
a&&(this.contentDiv.style.overflow=a,this.contentDiv._oldOverflow=null)}));this.moveTo(a);this.autoSize||this.size||this.setSize(this.contentSize);this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();this.panMapIfOutOfView&&this.panIntoView();return this.div},updatePosition:function(){if(this.lonlat&&this.map){var a=this.map.getLayerPxFromLonLat(this.lonlat);a&&this.moveTo(a)}},moveTo:function(a){null!=a&&null!=this.div&&(this.div.style.left=a.x+"px",this.div.style.top=
a.y+"px")},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){this.visible()?this.hide():this.show()},show:function(){this.div.style.display="";this.panMapIfOutOfView&&this.panIntoView()},hide:function(){this.div.style.display="none"},setSize:function(a){this.size=a.clone();var b=this.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;this.fixPadding();c+=this.padding.left+this.padding.right;d+=this.padding.top+this.padding.bottom;if(this.closeDiv)var e=parseInt(this.closeDiv.style.width),
c=c+(e+b.right);this.size.w+=c;this.size.h+=d;"msie"==OpenLayers.BROWSER_NAME&&(this.contentSize.w+=b.left+b.right,this.contentSize.h+=b.bottom+b.top);null!=this.div&&(this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px");null!=this.contentDiv&&(this.contentDiv.style.width=a.w+"px",this.contentDiv.style.height=a.h+"px")},updateSize:function(){var a="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>",b=this.map?this.map.div:document.body,c=OpenLayers.Util.getRenderedDimensions(a,
null,{displayClass:this.displayClass,containerElement:b}),d=this.getSafeContentSize(c),e=null;d.equals(c)?e=c:(c={w:d.w<c.w?d.w:null,h:d.h<c.h?d.h:null},c.w&&c.h?e=d:(a=OpenLayers.Util.getRenderedDimensions(a,c,{displayClass:this.contentDisplayClass,containerElement:b}),"hidden"!=OpenLayers.Element.getStyle(this.contentDiv,"overflow")&&a.equals(d)&&(d=OpenLayers.Util.getScrollbarWidth(),c.w?a.h+=d:a.w+=d),e=this.getSafeContentSize(a)));this.setSize(e)},setBackgroundColor:function(a){void 0!=a&&(this.backgroundColor=
a);null!=this.div&&(this.div.style.backgroundColor=this.backgroundColor)},setOpacity:function(a){void 0!=a&&(this.opacity=a);null!=this.div&&(this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+100*this.opacity+")")},setBorder:function(a){void 0!=a&&(this.border=a);null!=this.div&&(this.div.style.border=this.border)},setContentHTML:function(a){null!=a&&(this.contentHTML=a);null!=this.contentDiv&&(null!=this.contentHTML&&this.contentHTML!=this.contentDiv.innerHTML)&&(this.contentDiv.innerHTML=
this.contentHTML,this.autoSize&&(this.registerImageListeners(),this.updateSize()))},registerImageListeners:function(){for(var a=function(){null!==this.popup.id&&(this.popup.updateSize(),this.popup.visible()&&this.popup.panMapIfOutOfView&&this.popup.panIntoView(),OpenLayers.Event.stopObserving(this.img,"load",this.img._onImgLoad))},b=this.contentDiv.getElementsByTagName("img"),c=0,d=b.length;c<d;c++){var e=b[c];if(0==e.width||0==e.height)e._onImgLoad=OpenLayers.Function.bind(a,{popup:this,img:e}),
OpenLayers.Event.observe(e,"load",e._onImgLoad)}},getSafeContentSize:function(a){a=a.clone();var b=this.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;this.fixPadding();c+=this.padding.left+this.padding.right;d+=this.padding.top+this.padding.bottom;if(this.closeDiv)var e=parseInt(this.closeDiv.style.width),c=c+(e+b.right);this.minSize&&(a.w=Math.max(a.w,this.minSize.w-c),a.h=Math.max(a.h,this.minSize.h-d));this.maxSize&&(a.w=Math.min(a.w,this.maxSize.w-c),a.h=Math.min(a.h,this.maxSize.h-
d));if(this.map&&this.map.size){e=b=0;if(this.keepInMap&&!this.panMapIfOutOfView)switch(e=this.map.getPixelFromLonLat(this.lonlat),this.relativePosition){case "tr":b=e.x;e=this.map.size.h-e.y;break;case "tl":b=this.map.size.w-e.x;e=this.map.size.h-e.y;break;case "bl":b=this.map.size.w-e.x;e=e.y;break;case "br":b=e.x;e=e.y;break;default:b=e.x,e=this.map.size.h-e.y}d=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-d-e;a.w=Math.min(a.w,this.map.size.w-this.map.paddingForPopups.left-
this.map.paddingForPopups.right-c-b);a.h=Math.min(a.h,d)}return a},getContentDivPadding:function(){var a=this._contentDivPadding;a||(null==this.div.parentNode&&(this.div.style.display="none",document.body.appendChild(this.div)),this._contentDivPadding=a=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,
"padding-top")),this.div.parentNode==document.body&&(document.body.removeChild(this.div),this.div.style.display=""));return a},addCloseBox:function(a){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,{w:17,h:17});this.closeDiv.className="olPopupCloseBox";var b=this.getContentDivPadding();this.closeDiv.style.right=b.right+"px";this.closeDiv.style.top=b.top+"px";this.groupDiv.appendChild(this.closeDiv);a=a||function(a){this.hide();OpenLayers.Event.stop(a)};OpenLayers.Event.observe(this.closeDiv,
"touchend",OpenLayers.Function.bindAsEventListener(a,this));OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(a,this))},panIntoView:function(){var a=this.map.getSize(),b=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top))),c=b.clone();b.x<this.map.paddingForPopups.left?c.x=this.map.paddingForPopups.left:b.x+this.size.w>a.w-this.map.paddingForPopups.right&&(c.x=a.w-this.map.paddingForPopups.right-this.size.w);
b.y<this.map.paddingForPopups.top?c.y=this.map.paddingForPopups.top:b.y+this.size.h>a.h-this.map.paddingForPopups.bottom&&(c.y=a.h-this.map.paddingForPopups.bottom-this.size.h);this.map.pan(b.x-c.x,b.y-c.y)},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,!0);this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,touchstart:function(a){OpenLayers.Event.stop(a,!0)},
scope:this})},onmousedown:function(a){this.mousedown=!0;OpenLayers.Event.stop(a,!0)},onmousemove:function(a){this.mousedown&&OpenLayers.Event.stop(a,!0)},onmouseup:function(a){this.mousedown&&(this.mousedown=!1,OpenLayers.Event.stop(a,!0))},onclick:function(a){OpenLayers.Event.stop(a,!0)},onmouseout:function(a){this.mousedown=!1},ondblclick:function(a){OpenLayers.Event.stop(a,!0)},CLASS_NAME:"OpenLayers.Popup"});OpenLayers.Popup.WIDTH=200;OpenLayers.Popup.HEIGHT=200;OpenLayers.Popup.COLOR="white";
OpenLayers.Popup.OPACITY=1;OpenLayers.Popup.BORDER="0px";OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:!1,draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.eTop||(this.eTop=document.createElement("div"),this.eTop.className=this.displayClass+"Top",this.div.appendChild(this.eTop),this.eTop.style.visibility=""==this.topOutUnits||""==this.topInUnits?"hidden":"visible",this.eBottom=document.createElement("div"),
this.eBottom.className=this.displayClass+"Bottom",this.div.appendChild(this.eBottom),this.eBottom.style.visibility=""==this.bottomOutUnits||""==this.bottomInUnits?"hidden":"visible");this.map.events.register("moveend",this,this.update);this.update();return this.div},getBarLen:function(a){var b=parseInt(Math.log(a)/Math.log(10)),b=Math.pow(10,b);a=parseInt(a/b);return(5<a?5:2<a?2:1)*b},update:function(){var a=this.map.getResolution();if(a){var b=this.map.getUnits(),c=OpenLayers.INCHES_PER_UNIT,d=this.maxWidth*
a*c[b],e=1;!0===this.geodesic&&(e=(this.map.getGeodesicPixelSize().w||1E-6)*this.maxWidth/(d/c.km),d*=e);var f,g;1E5<d?(f=this.topOutUnits,g=this.bottomOutUnits):(f=this.topInUnits,g=this.bottomInUnits);var h=d/c[f],k=d/c[g],d=this.getBarLen(h),l=this.getBarLen(k),h=d/c[b]*c[f],k=l/c[b]*c[g],b=h/a/e,a=k/a/e;"visible"==this.eBottom.style.visibility&&(this.eBottom.style.width=Math.round(a)+"px",this.eBottom.innerHTML=l+" "+g);"visible"==this.eTop.style.visibility&&(this.eTop.style.width=Math.round(b)+
"px",this.eTop.innerHTML=d+" "+f)}},CLASS_NAME:"OpenLayers.Control.ScaleLine"});OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(a,b,c,d){this.url=a;this.size=b||{w:20,h:20};this.offset=c||{x:-(this.size.w/2),y:-(this.size.h/2)};this.calculateOffset=d;a=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(a)},destroy:function(){this.erase();OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild);this.imageDiv.innerHTML="";this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,
this.size,this.offset,this.calculateOffset)},setSize:function(a){null!=a&&(this.size=a);this.draw()},setUrl:function(a){null!=a&&(this.url=a);this.draw()},draw:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute");this.moveTo(a);return this.imageDiv},erase:function(){null!=this.imageDiv&&null!=this.imageDiv.parentNode&&OpenLayers.Element.remove(this.imageDiv)},setOpacity:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,
null,null,null,a)},moveTo:function(a){null!=a&&(this.px=a);null!=this.imageDiv&&(null==this.px?this.display(!1):(this.calculateOffset&&(this.offset=this.calculateOffset(this.size)),OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})))},display:function(a){this.imageDiv.style.display=a?"":"none"},isDrawn:function(){return this.imageDiv&&this.imageDiv.parentNode&&11!=this.imageDiv.parentNode.nodeType},CLASS_NAME:"OpenLayers.Icon"});OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(a,b){this.lonlat=a;var c=b?b:OpenLayers.Marker.defaultIcon();null==this.icon?this.icon=c:(this.icon.url=c.url,this.icon.size=c.size,this.icon.offset=c.offset,this.icon.calculateOffset=c.calculateOffset);this.events=new OpenLayers.Events(this,this.icon.imageDiv)},destroy:function(){this.erase();this.map=null;this.events.destroy();this.events=null;null!=this.icon&&(this.icon.destroy(),this.icon=null)},
draw:function(a){return this.icon.draw(a)},erase:function(){null!=this.icon&&this.icon.erase()},moveTo:function(a){null!=a&&null!=this.icon&&this.icon.moveTo(a);this.lonlat=this.map.getLonLatFromLayerPx(a)},isDrawn:function(){return this.icon&&this.icon.isDrawn()},onScreen:function(){var a=!1;this.map&&(a=this.map.getExtent().containsLonLat(this.lonlat));return a},inflate:function(a){this.icon&&this.icon.setSize({w:this.icon.size.w*a,h:this.icon.size.h*a})},setOpacity:function(a){this.icon.setOpacity(a)},
setUrl:function(a){this.icon.setUrl(a)},display:function(a){this.icon.display(a)},CLASS_NAME:"OpenLayers.Marker"});OpenLayers.Marker.defaultIcon=function(){return new OpenLayers.Icon(OpenLayers.Util.getImageLocation("marker.png"),{w:21,h:25},{x:-10.5,y:-25})};OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,format:"image/png",serverResolutions:null,initialize:function(a,b,c,d){this.layername=c;OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,{},d]);this.extension=this.format.split("/")[1].toLowerCase();this.extension="jpg"==this.extension?"jpeg":this.extension},clone:function(a){null==a&&(a=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getURL:function(a){var b=this.getServerResolution(),c=this.maxExtent,d=this.tileSize,e=Math.round((a.left-c.left)/(b*d.w));a=Math.round((a.bottom-c.bottom)/(b*d.h));b=null!=this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,b):this.map.getZoom();e=[this.layername,OpenLayers.Number.zeroPad(b,2),OpenLayers.Number.zeroPad(parseInt(e/1E6),3),OpenLayers.Number.zeroPad(parseInt(e/1E3)%1E3,3),OpenLayers.Number.zeroPad(parseInt(e)%1E3,3),OpenLayers.Number.zeroPad(parseInt(a/1E6),
3),OpenLayers.Number.zeroPad(parseInt(a/1E3)%1E3,3),OpenLayers.Number.zeroPad(parseInt(a)%1E3,3)+"."+this.extension].join("/");b=this.url;OpenLayers.Util.isArray(b)&&(b=this.selectUrl(e,b));b="/"==b.charAt(b.length-1)?b:b+"/";return b+e},CLASS_NAME:"OpenLayers.Layer.TileCache"});OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,scope:this}));return a},cacheFeatures:function(a){this.paging||(this.clearCache(),
this.features=a.features,this.pageNext(a))},clearCache:function(){if(this.features)for(var a=0;a<this.features.length;++a)this.features[a].destroy();this.num=this.features=null},pageCount:function(){return Math.ceil((this.features?this.features.length:0)/this.length)},pageNum:function(){return this.num},pageLength:function(a){a&&0<a&&(this.length=a);return this.length},pageNext:function(a){var b=!1;this.features&&(null===this.num&&(this.num=-1),b=this.page((this.num+1)*this.length,a));return b},pagePrevious:function(){var a=
!1;this.features&&(null===this.num&&(this.num=this.pageCount()),a=this.page((this.num-1)*this.length));return a},page:function(a,b){var c=!1;if(this.features&&0<=a&&a<this.features.length){var d=Math.floor(a/this.length);d!=this.num&&(this.paging=!0,c=this.features.slice(a,a+this.length),this.layer.removeFeatures(this.layer.features),this.num=d,b&&b.features?b.features=c:this.layer.addFeatures(c),this.paging=!1,c=!0)}return c},CLASS_NAME:"OpenLayers.Strategy.Paging"});OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(a,b){},onDrag:function(a,b){},onComplete:function(a,b){},onEnter:function(a){},onLeave:function(a){},documentDrag:!1,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.layer=a;this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,
up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},clickFeature:function(a){this.handlers.feature.touch&&(!this.over&&this.overFeature(a))&&(this.handlers.drag.dragstart(this.handlers.feature.evt),this.handlers.drag.stopDown=
!1)},clickoutFeature:function(a){this.handlers.feature.touch&&this.over&&(this.outFeature(a),this.handlers.drag.stopDown=!0)},destroy:function(){this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return this.handlers.feature.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.handlers.drag.deactivate();this.handlers.feature.deactivate();this.feature=null;this.dragging=!1;this.lastPixel=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,
this.displayClass+"Over");return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(a){var b=!1;this.handlers.drag.dragging?this.over=this.feature.id==a.id?!0:!1:(this.feature=a,this.handlers.drag.activate(),this.over=b=!0,OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onEnter(a));return b},downFeature:function(a){this.lastPixel=a;this.onStart(this.feature,a)},moveFeature:function(a){var b=this.map.getResolution();this.feature.geometry.move(b*
(a.x-this.lastPixel.x),b*(this.lastPixel.y-a.y));this.layer.drawFeature(this.feature);this.lastPixel=a;this.onDrag(this.feature,a)},upFeature:function(a){this.over||this.handlers.drag.deactivate()},doneDragging:function(a){this.onComplete(this.feature,a)},outFeature:function(a){this.handlers.drag.dragging?this.feature.id==a.id&&(this.over=!1):(this.over=!1,this.handlers.drag.deactivate(),OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onLeave(a),this.feature=null)},
cancel:function(){this.handlers.drag.deactivate();this.over=!1},setMap:function(a){this.handlers.drag.setMap(a);this.handlers.feature.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"});OpenLayers.Control.TransformFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,layer:null,preserveAspectRatio:!1,rotate:!0,feature:null,renderIntent:"temporary",rotationHandleSymbolizer:null,box:null,center:null,scale:1,ratio:1,rotation:0,handles:null,rotationHandles:null,dragControl:null,irregular:!1,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.layer=a;this.rotationHandleSymbolizer||(this.rotationHandleSymbolizer={stroke:!1,pointRadius:10,fillOpacity:0,
cursor:"pointer"});this.createBox();this.createControl()},activate:function(){var a=!1;OpenLayers.Control.prototype.activate.apply(this,arguments)&&(this.dragControl.activate(),this.layer.addFeatures([this.box]),this.rotate&&this.layer.addFeatures(this.rotationHandles),this.layer.addFeatures(this.handles),a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Control.prototype.deactivate.apply(this,arguments)&&(this.layer.removeFeatures(this.handles),this.rotate&&this.layer.removeFeatures(this.rotationHandles),
this.layer.removeFeatures([this.box]),this.dragControl.deactivate(),a=!0);return a},setMap:function(a){this.dragControl.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setFeature:function(a,b){b=OpenLayers.Util.applyDefaults(b,{rotation:0,scale:1,ratio:1});var c=this.rotation,d=this.center;OpenLayers.Util.extend(this,b);if(!1!==this.events.triggerEvent("beforesetfeature",{feature:a})){this.feature=a;this.activate();this._setfeature=!0;var e=this.feature.geometry.getBounds();this.box.move(e.getCenterLonLat());
this.box.geometry.rotate(-c,d);this._angle=0;this.rotation?(c=a.geometry.clone(),c.rotate(-this.rotation,this.center),c=new OpenLayers.Feature.Vector(c.getBounds().toGeometry()),c.geometry.rotate(this.rotation,this.center),this.box.geometry.rotate(this.rotation,this.center),this.box.move(c.geometry.getBounds().getCenterLonLat()),c=c.geometry.components[0].components[0].getBounds().getCenterLonLat()):c=new OpenLayers.LonLat(e.left,e.bottom);this.handles[0].move(c);delete this._setfeature;this.events.triggerEvent("setfeature",
{feature:a})}},unsetFeature:function(){this.active?this.deactivate():(this.feature=null,this.rotation=0,this.ratio=this.scale=1)},createBox:function(){var a=this;this.center=new OpenLayers.Geometry.Point(0,0);this.box=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-1,-1),new OpenLayers.Geometry.Point(0,-1),new OpenLayers.Geometry.Point(1,-1),new OpenLayers.Geometry.Point(1,0),new OpenLayers.Geometry.Point(1,1),new OpenLayers.Geometry.Point(0,1),new OpenLayers.Geometry.Point(-1,
1),new OpenLayers.Geometry.Point(-1,0),new OpenLayers.Geometry.Point(-1,-1)]),null,"string"==typeof this.renderIntent?null:this.renderIntent);this.box.geometry.move=function(b,c){a._moving=!0;OpenLayers.Geometry.LineString.prototype.move.apply(this,arguments);a.center.move(b,c);delete a._moving};for(var b=function(a,b){OpenLayers.Geometry.Point.prototype.move.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.move(a,b);this._handle.geometry.move(a,b)},c=function(a,b,c){OpenLayers.Geometry.Point.prototype.resize.apply(this,
arguments);this._rotationHandle&&this._rotationHandle.geometry.resize(a,b,c);this._handle.geometry.resize(a,b,c)},d=function(a,b){OpenLayers.Geometry.Point.prototype.rotate.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.rotate(a,b);this._handle.geometry.rotate(a,b)},e=function(b,c){var d=this.x,e=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,b,c);if(!a._moving){var f=a.dragControl.handlers.drag.evt,g=!(!a._setfeature&&a.preserveAspectRatio)&&!(f&&f.shiftKey),
h=new OpenLayers.Geometry.Point(d,e),f=a.center;this.rotate(-a.rotation,f);h.rotate(-a.rotation,f);var k=this.x-f.x,l=this.y-f.y,m=k-(this.x-h.x),n=l-(this.y-h.y);a.irregular&&!a._setfeature&&(k-=(this.x-h.x)/2,l-=(this.y-h.y)/2);this.x=d;this.y=e;h=1;g?(l=1E-5>Math.abs(n)?1:l/n,h=(1E-5>Math.abs(m)?1:k/m)/l):(m=Math.sqrt(m*m+n*n),l=Math.sqrt(k*k+l*l)/m);a._moving=!0;a.box.geometry.rotate(-a.rotation,f);delete a._moving;a.box.geometry.resize(l,f,h);a.box.geometry.rotate(a.rotation,f);a.transformFeature({scale:l,
ratio:h});a.irregular&&!a._setfeature&&(k=f.clone(),k.x+=1E-5>Math.abs(d-f.x)?0:this.x-d,k.y+=1E-5>Math.abs(e-f.y)?0:this.y-e,a.box.geometry.move(this.x-d,this.y-e),a.transformFeature({center:k}))}},f=function(b,c){var d=this.x,e=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,b,c);if(!a._moving){var f=a.dragControl.handlers.drag.evt,f=f&&f.shiftKey?45:1,g=a.center,h=this.x-g.x,k=this.y-g.y;this.x=d;this.y=e;d=Math.atan2(k-c,h-b);d=Math.atan2(k,h)-d;d*=180/Math.PI;a._angle=(a._angle+d)%
360;d=a.rotation%f;if(Math.abs(a._angle)>=f||0!==d)d=Math.round(a._angle/f)*f-d,a._angle=0,a.box.geometry.rotate(d,g),a.transformFeature({rotation:d})}},g=Array(8),h=Array(4),k,l,m,n="sw s se e ne n nw w".split(" "),p=0;8>p;++p)k=this.box.geometry.components[p],l=new OpenLayers.Feature.Vector(k.clone(),{role:n[p]+"-resize"},"string"==typeof this.renderIntent?null:this.renderIntent),0==p%2&&(m=new OpenLayers.Feature.Vector(k.clone(),{role:n[p]+"-rotate"},"string"==typeof this.rotationHandleSymbolizer?
null:this.rotationHandleSymbolizer),m.geometry.move=f,k._rotationHandle=m,h[p/2]=m),k.move=b,k.resize=c,k.rotate=d,l.geometry.move=e,k._handle=l,g[p]=l;this.rotationHandles=h;this.handles=g},createControl:function(){var a=this;this.dragControl=new OpenLayers.Control.DragFeature(this.layer,{documentDrag:!0,moveFeature:function(b){this.feature===a.feature&&(this.feature=a.box);OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},onDrag:function(b,c){b===a.box&&a.transformFeature({center:a.center})},
onStart:function(b,c){var d=!a.geometryTypes||-1!==OpenLayers.Util.indexOf(a.geometryTypes,b.geometry.CLASS_NAME),e=OpenLayers.Util.indexOf(a.handles,b),e=e+OpenLayers.Util.indexOf(a.rotationHandles,b);b!==a.feature&&(b!==a.box&&-2==e&&d)&&a.setFeature(b)},onComplete:function(b,c){a.events.triggerEvent("transformcomplete",{feature:a.feature})}})},drawHandles:function(){for(var a=this.layer,b=0;8>b;++b)this.rotate&&0===b%2&&a.drawFeature(this.rotationHandles[b/2],this.rotationHandleSymbolizer),a.drawFeature(this.handles[b],
this.renderIntent)},transformFeature:function(a){if(!this._setfeature){this.scale*=a.scale||1;this.ratio*=a.ratio||1;var b=this.rotation;this.rotation=(this.rotation+(a.rotation||0))%360;if(!1!==this.events.triggerEvent("beforetransform",a)){var c=this.feature,d=c.geometry,e=this.center;d.rotate(-b,e);a.scale||a.ratio?d.resize(a.scale,e,a.ratio):a.center&&c.move(a.center.getBounds().getCenterLonLat());d.rotate(this.rotation,e);this.layer.drawFeature(c);c.toState(OpenLayers.State.UPDATE);this.events.triggerEvent("transform",
a)}}this.layer.drawFeature(this.box,this.renderIntent);this.drawHandles()},destroy:function(){for(var a,b=0;8>b;++b)a=this.box.geometry.components[b],a._handle.destroy(),a._handle=null,a._rotationHandle&&a._rotationHandle.destroy(),a._rotationHandle=null;this.rotationHandles=this.rotationHandleSymbolizer=this.handles=this.feature=this.center=null;this.box.destroy();this.layer=this.box=null;this.dragControl.destroy();this.dragControl=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},
CLASS_NAME:"OpenLayers.Control.TransformFeature"});OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.dragHandler&&(this.dragHandler.destroy(),this.dragHandler=
null)},setMap:function(a){OpenLayers.Handler.prototype.setMap.apply(this,arguments);this.dragHandler&&this.dragHandler.setMap(a)},startBox:function(a){this.callback("start",[]);this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999});this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(a){var b=this.dragHandler.start.x,
c=this.dragHandler.start.y,d=Math.abs(b-a.x),e=Math.abs(c-a.y),f=this.getBoxOffsets();this.zoomBox.style.width=d+f.width+1+"px";this.zoomBox.style.height=e+f.height+1+"px";this.zoomBox.style.left=(a.x<b?b-d-f.left:b-f.left)+"px";this.zoomBox.style.top=(a.y<c?c-e-f.top:c-f.top)+"px"},endBox:function(a){var b;if(5<Math.abs(this.dragHandler.start.x-a.x)||5<Math.abs(this.dragHandler.start.y-a.y)){var c=this.dragHandler.start;b=Math.min(c.y,a.y);var d=Math.max(c.y,a.y),e=Math.min(c.x,a.x);a=Math.max(c.x,
a.x);b=new OpenLayers.Bounds(e,d,a,b)}else b=this.dragHandler.start.clone();this.removeBox();this.callback("done",[b])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.boxOffsets=this.zoomBox=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return OpenLayers.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?
(this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var a=document.createElement("div");a.style.position="absolute";a.style.border="1px solid black";a.style.width="3px";document.body.appendChild(a);var b=3==a.clientWidth;document.body.removeChild(a);var a=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),c=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),d=parseInt(OpenLayers.Element.getStyle(this.zoomBox,
"border-top-width")),e=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:a,right:c,top:d,bottom:e,width:!1===b?a+c:0,height:!1===b?d+e:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"});OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,zoomOnClick:!0,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(a){if(a instanceof OpenLayers.Bounds){var b,c=a.getCenterPixel();if(this.out){b=Math.min(this.map.size.h/(a.bottom-a.top),this.map.size.w/(a.right-a.left));var d=this.map.getExtent(),e=this.map.getLonLatFromPixel(c),f=e.lon-d.getWidth()/
2*b;a=e.lon+d.getWidth()/2*b;var g=e.lat-d.getHeight()/2*b;b=e.lat+d.getHeight()/2*b;b=new OpenLayers.Bounds(f,g,a,b)}else f=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),a=this.map.getLonLatFromPixel({x:a.right,y:a.top}),b=new OpenLayers.Bounds(f.lon,f.lat,a.lon,a.lat);f=this.map.getZoom();g=this.map.getSize();a=g.w/2;g=g.h/2;b=this.map.getZoomForExtent(b);d=this.map.getResolution();e=this.map.getResolutionForZoom(b);d==e?this.map.setCenter(this.map.getLonLatFromPixel(c)):this.map.zoomTo(b,
{x:(d*c.x-e*a)/(d-e),y:(d*c.y-e*g)/(d-e)});f==this.map.getZoom()&&!0==this.alwaysZoom&&this.map.zoomTo(f+(this.out?-1:1))}else this.zoomOnClick&&(this.out?this.map.zoomTo(this.map.getZoom()-1,a):this.map.zoomTo(this.map.getZoom()+1,a))},CLASS_NAME:"OpenLayers.Control.ZoomBox"});OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:0,documentDrag:!1,kinetic:null,enableKinetic:!0,kineticInterval:10,draw:function(){if(this.enableKinetic&&OpenLayers.Kinetic){var a={interval:this.kineticInterval};"object"===typeof this.enableKinetic&&(a=OpenLayers.Util.extend(a,this.enableKinetic));this.kinetic=new OpenLayers.Kinetic(a)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},
{interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(a){this.kinetic&&this.kinetic.update(a);this.panned=!0;this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!0,animate:!1})},panMapDone:function(a){if(this.panned){var b=null;this.kinetic&&(b=this.kinetic.end(a));this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!!b,animate:!1});if(b){var c=this;this.kinetic.move(b,function(a,b,
f){c.map.pan(a,b,{dragging:!f,animate:!1})})}this.panned=!1}},CLASS_NAME:"OpenLayers.Control.DragPan"});OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;
this.zoomBox&&this.zoomBox.destroy();this.zoomBox=null;this.pinchZoom&&this.pinchZoom.destroy();this.pinchZoom=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();this.zoomWheelEnabled&&this.handlers.wheel.activate();this.handlers.click.activate();this.zoomBoxEnabled&&this.zoomBox.activate();this.pinchZoom&&this.pinchZoom.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.pinchZoom&&this.pinchZoom.deactivate();
this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&&(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},{"double":!0,stopDouble:!0});this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,
documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},OpenLayers.Util.extend(this.map.fractionalZoom?{}:{cumulative:!1,interval:50,maxDelta:6},this.mouseWheelOptions));OpenLayers.Control.PinchZoom&&(this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},
this.pinchZoomOptions)))},defaultClick:function(a){a.lastTouches&&2==a.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(a){this.map.zoomTo(this.map.zoom+1,a.xy)},defaultDblRightClick:function(a){this.map.zoomTo(this.map.zoom-1,a.xy)},wheelChange:function(a,b){this.map.fractionalZoom||(b=Math.round(b));var c=this.map.getZoom(),d;d=Math.max(c+b,0);d=Math.min(d,this.map.getNumZoomLevels());d!==c&&this.map.zoomTo(d,a.xy)},wheelUp:function(a,b){this.wheelChange(a,b||1)},wheelDown:function(a,
b){this.wheelChange(a,b||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0;this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0;this.active&&this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"});OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,multi:!1,featureAdded:function(){},initialize:function(a,b,c){OpenLayers.Control.prototype.initialize.apply(this,[c]);this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(a,b){this.layer.events.triggerEvent("sketchmodified",{vertex:a,feature:b})},create:function(a,b){this.layer.events.triggerEvent("sketchstarted",{vertex:a,feature:b})}},this.callbacks);this.layer=a;this.handlerOptions=
this.handlerOptions||{};this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:a.renderers,rendererOptions:a.rendererOptions});"multi"in this.handlerOptions||(this.handlerOptions.multi=this.multi);if(a=this.layer.styleMap&&this.layer.styleMap.styles.temporary)this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":a})});this.handler=new b(this,this.callbacks,this.handlerOptions)},
drawFeature:function(a){a=new OpenLayers.Feature.Vector(a);!1!==this.layer.events.triggerEvent("sketchcomplete",{feature:a})&&(a.state=OpenLayers.State.INSERT,this.layer.addFeatures([a]),this.featureAdded(a),this.events.triggerEvent("featureadded",{feature:a}))},insertXY:function(a,b){this.handler&&this.handler.line&&this.handler.insertXY(a,b)},insertDeltaXY:function(a,b){this.handler&&this.handler.line&&this.handler.insertDeltaXY(a,b)},insertDirectionLength:function(a,b){this.handler&&this.handler.line&&
this.handler.insertDirectionLength(a,b)},insertDeflectionLength:function(a,b){this.handler&&this.handler.line&&this.handler.insertDeflectionLength(a,b)},undo:function(){return this.handler.undo&&this.handler.undo()},redo:function(){return this.handler.redo&&this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"OpenLayers.Control.DrawFeature"});OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{holeModifier:null,drawingHole:!1,polygon:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry]));this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry]));this.callback("create",[this.point.geometry,
this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.polygon,this.point],{silent:!0})},addPoint:function(a){if(!this.drawingHole&&this.holeModifier&&this.evt&&this.evt[this.holeModifier])for(var b=this.point.geometry,c=this.control.layer.features,d,e=c.length-1;0<=e;--e)if(d=c[e].geometry,(d instanceof OpenLayers.Geometry.Polygon||d instanceof OpenLayers.Geometry.MultiPolygon)&&d.intersects(b)){b=c[e];this.control.layer.removeFeatures([b],{silent:!0});this.control.layer.events.registerPriority("sketchcomplete",
this,this.finalizeInteriorRing);this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology);b.geometry.addComponent(this.line.geometry);this.polygon=b;this.drawingHole=!0;break}OpenLayers.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(a){a=a.vertex;var b=this.line.geometry.components;this.polygon.geometry.intersects(a)||(b=b[b.length-3],a.x=b.x,a.y=b.y)},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-
2]);this.removePoint();this.finalize()},finalizeInteriorRing:function(){var a=this.line.geometry,b=0!==a.getArea();if(b){for(var c=this.polygon.geometry.components,d=c.length-2;0<=d;--d)if(a.intersects(c[d])){b=!1;break}if(b)a:for(d=c.length-2;0<d;--d)for(var e=c[d].components,f=0,g=e.length;f<g;++f)if(a.containsPoint(e[f])){b=!1;break a}}b?this.polygon.state!==OpenLayers.State.INSERT&&(this.polygon.state=OpenLayers.State.UPDATE):this.polygon.geometry.removeComponent(a);this.restoreFeature();return!1},
cancel:function(){this.drawingHole&&(this.polygon.geometry.removeComponent(this.line.geometry),this.restoreFeature(!0));return OpenLayers.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(a){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing);this.control.layer.events.unregister("sketchmodified",this,this.enforceTopology);this.layer.removeFeatures([this.polygon],{silent:!0});this.control.layer.addFeatures([this.polygon],{silent:!0});this.drawingHole=
!1;a||this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})},destroyFeature:function(a){OpenLayers.Handler.Path.prototype.destroyFeature.call(this,a);this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var a=this.polygon&&this.polygon.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiPolygon([a]));return a},CLASS_NAME:"OpenLayers.Handler.Polygon"});OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{citeCompliant:!1,initialize:function(a,b){OpenLayers.Control.Panel.prototype.initialize.apply(this,[b]);this.addControls([new OpenLayers.Control.Navigation]);var c=[new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Point,{displayClass:"olControlDrawFeaturePoint",handlerOptions:{citeCompliant:this.citeCompliant}}),new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Path,{displayClass:"olControlDrawFeaturePath",handlerOptions:{citeCompliant:this.citeCompliant}}),
new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Polygon,{displayClass:"olControlDrawFeaturePolygon",handlerOptions:{citeCompliant:this.citeCompliant}})];this.addControls(c)},draw:function(){var a=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);null===this.defaultControl&&(this.defaultControl=this.controls[0]);return a},CLASS_NAME:"OpenLayers.Control.EditingToolbar"});OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&&(this.layer.events.on({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this}),this.update());return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({moveend:this.update,refresh:this.update,visibilitychanged:this.update,
scope:this});return a},update:function(a){var b=this.getMapBounds();null!==b&&(a&&a.force||this.layer.visibility&&this.layer.calculateInRange()&&this.invalidBounds(b))&&(this.calculateBounds(b),this.resolution=this.layer.map.getResolution(),this.triggerRead(a))},getMapBounds:function(){if(null===this.layer.map)return null;var a=this.layer.map.getExtent();a&&!this.layer.projection.equals(this.layer.map.getProjectionObject())&&(a=a.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection));
return a},invalidBounds:function(a){a||(a=this.getMapBounds());a=!this.bounds||!this.bounds.containsBounds(a);!a&&this.resFactor&&(a=this.resolution/this.layer.map.getResolution(),a=a>=this.resFactor||a<=1/this.resFactor);return a},calculateBounds:function(a){a||(a=this.getMapBounds());var b=a.getCenterLonLat(),c=a.getWidth()*this.ratio;a=a.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2)},triggerRead:function(a){!this.response||a&&!0===a.noAbort||
(this.layer.protocol.abort(this.response),this.layer.events.triggerEvent("loadend"));var b={filter:this.createFilter()};this.layer.events.triggerEvent("loadstart",b);this.response=this.layer.protocol.read(OpenLayers.Util.applyDefaults({filter:b.filter,callback:this.merge,scope:this},a))},createFilter:function(){var a=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});this.layer.filter&&(a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,
filters:[this.layer.filter,a]}));return a},merge:function(a){this.layer.destroyFeatures();if(a.success()){var b=a.features;if(b&&0<b.length){var c=this.layer.projection,d=this.layer.map.getProjectionObject();if(!d.equals(c))for(var e,f=0,g=b.length;f<g;++f)(e=b[f].geometry)&&e.transform(c,d);this.layer.addFeatures(b)}}else this.bounds=null;this.response=null;this.layer.events.triggerEvent("loadend",{response:a})},CLASS_NAME:"OpenLayers.Strategy.BBOX"});OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:!0,lzd:null,zoomLevels:null,initialize:function(a,b,c,d,e,f){this.lzd=c;this.zoomLevels=d;c=[];c.push(a,b,e,f);OpenLayers.Layer.Grid.prototype.initialize.apply(this,c);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getZoom:function(){var a=this.map.getZoom();this.map.getMaxExtent();return a-=Math.log(this.maxResolution/(this.lzd/512))/Math.log(2)},getURL:function(a){a=this.adjustBounds(a);
var b=this.getZoom(),c=this.map.getMaxExtent(),d=this.lzd/Math.pow(2,this.getZoom()),e=Math.floor((a.left-c.left)/d);a=Math.floor((a.bottom-c.bottom)/d);return this.map.getResolution()<=this.lzd/512&&this.getZoom()<=this.zoomLevels?this.getFullRequestString({L:b,X:e,Y:a}):OpenLayers.Util.getImageLocation("blank.gif")},CLASS_NAME:"OpenLayers.Layer.WorldWind"});OpenLayers.Protocol.CSW=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.CSW.DEFAULTS);var b=OpenLayers.Protocol.CSW["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSW version: "+a.version;return new b(a)};OpenLayers.Protocol.CSW.DEFAULTS={version:"2.0.2"};OpenLayers.Format.WMTSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",yx:{"urn:ogc:def:crs:EPSG::4326":!0},createLayer:function(a,b){if(!("layer"in b))throw Error("Missing property 'layer' in configuration.");for(var c=a.contents,d,e=0,f=c.layers.length;e<f;++e)if(c.layers[e].identifier===b.layer){d=c.layers[e];break}if(!d)throw Error("Layer not found");var g=b.format;!g&&(d.formats&&d.formats.length)&&(g=d.formats[0]);var h;b.matrixSet?h=c.tileMatrixSets[b.matrixSet]:
1<=d.tileMatrixSetLinks.length&&(h=c.tileMatrixSets[d.tileMatrixSetLinks[0].tileMatrixSet]);if(!h)throw Error("matrixSet not found");for(var k,e=0,f=d.styles.length;e<f&&(k=d.styles[e],!k.isDefault);++e);c=b.requestEncoding;if(!c&&(c="KVP",a.operationsMetadata.GetTile.dcp.http)){var l=a.operationsMetadata.GetTile.dcp.http;l.get[0].constraints&&(l=l.get[0].constraints.GetEncoding.allowedValues,l.KVP||!l.REST&&!l.RESTful||(c="REST"))}var l=[],m=b.params||{};delete b.params;for(var n=0,p=d.dimensions.length;n<
p;n++){var q=d.dimensions[n];l.push(q.identifier);m.hasOwnProperty(q.identifier)||(m[q.identifier]=q["default"])}var n=b.projection||h.supportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"),p=b.units||("EPSG:4326"===n?"degrees":"m"),q=[],r;for(r in h.matrixIds)h.matrixIds.hasOwnProperty(r)&&q.push(2.8E-4*h.matrixIds[r].scaleDenominator/OpenLayers.METERS_PER_INCH/OpenLayers.INCHES_PER_UNIT[p]);if("REST"===c&&d.resourceUrls){r=[];for(var f=0,s=d.resourceUrls.length;f<s;++f)e=d.resourceUrls[f],
e.format===g&&"tile"===e.resourceType&&r.push(e.template)}else{s=a.operationsMetadata.GetTile.dcp.http.get;r=[];for(var t,e=0,f=s.length;e<f;e++)t=s[e].constraints,(!t||t&&t.GetEncoding.allowedValues[c])&&r.push(s[e].url)}return new OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(b,{url:r,requestEncoding:c,name:d.title,style:k.identifier,format:g,matrixIds:h.matrixIds,matrixSet:h.identifier,projection:n,units:p,resolutions:!1===b.isBaseLayer?void 0:q,serverResolutions:q,tileFullExtent:h.bounds,
dimensions:l,params:m}))},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities"});OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:!0,projection:"EPSG:900913"},animationEnabled:!0,loadMapObject:function(){this.type||(this.type=google.maps.MapTypeId.ROADMAP);var a,b=OpenLayers.Layer.Google.cache[this.map.id];b?(a=b.mapObject,++b.count):(a=this.map.getCenter(),b=document.createElement("div"),b.className="olForeignContainer",b.style.width="100%",b.style.height="100%",a=new google.maps.Map(b,{center:a?new google.maps.LatLng(a.lat,a.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||
0,mapTypeId:this.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1}),b=document.createElement("div"),b.style.width="100%",b.style.height="100%",a.controls[google.maps.ControlPosition.TOP_LEFT].push(b),b={googleControl:b,mapObject:a,count:1},OpenLayers.Layer.Google.cache[this.map.id]=b);this.mapObject=a;this.setGMapVisibility(this.visibility)},onMapResize:function(){this.visibility&&google.maps.event.trigger(this.mapObject,"resize")},
setGMapVisibility:function(a){var b=OpenLayers.Layer.Google.cache[this.map.id],c=this.map;if(b){for(var d=this.type,e=c.layers,f,g=e.length-1;0<=g;--g)if(f=e[g],f instanceof OpenLayers.Layer.Google&&!0===f.visibility&&!0===f.inRange){d=f.type;a=!0;break}e=this.mapObject.getDiv();if(!0===a){if(e.parentNode!==c.div)if(b.rendered)c.div.appendChild(e),b.googleControl.appendChild(c.viewPortDiv),google.maps.event.trigger(this.mapObject,"resize");else{var h=this;google.maps.event.addListenerOnce(this.mapObject,
"tilesloaded",function(){b.rendered=!0;h.setGMapVisibility(h.getVisibility());h.moveTo(h.map.getCenter())})}this.mapObject.setMapTypeId(d)}else b.googleControl.hasChildNodes()&&(c.div.appendChild(c.viewPortDiv),c.div.removeChild(e))}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(a){var b=null;null!=a&&(b=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,a.left),a=this.sphericalMercator?this.inverseMercator(a.top,
a.right):new OpenLayers.LonLat(a.top,a.right),b=new google.maps.LatLngBounds(new google.maps.LatLng(b.lat,b.lon),new google.maps.LatLng(a.lat,a.lon)));return b},getMapObjectLonLatFromMapObjectPixel:function(a){var b=this.map.getSize(),c=this.getLongitudeFromMapObjectLonLat(this.mapObject.center),d=this.getLatitudeFromMapObjectLonLat(this.mapObject.center),e=this.map.getResolution();a=new OpenLayers.LonLat(c+(a.x-b.w/2)*e,d-(a.y-b.h/2)*e);this.wrapDateLine&&(a=a.wrapDateLine(this.maxExtent));return this.getMapObjectLonLatFromLonLat(a.lon,
a.lat)},getMapObjectPixelFromMapObjectLonLat:function(a){var b=this.getLongitudeFromMapObjectLonLat(a);a=this.getLatitudeFromMapObjectLonLat(a);var c=this.map.getResolution(),d=this.map.getExtent();return this.getMapObjectPixelFromXY(1/c*(b-d.left),1/c*(d.top-a))},setMapObjectCenter:function(a,b){if(!1===this.animationEnabled&&b!=this.mapObject.zoom){var c=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,"idle",function(){c.style.visibility=""});c.style.visibility="hidden"}this.mapObject.setOptions({center:a,
zoom:b})},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(a,b){var c;this.sphericalMercator?(c=this.inverseMercator(a,b),c=new google.maps.LatLng(c.lat,c.lon)):c=new google.maps.LatLng(b,a);return c},getMapObjectPixelFromXY:function(a,b){return new google.maps.Point(a,b)}};OpenLayers.Format.WPSDescribeProcess=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{wps:"http://www.opengis.net/wps/1.0.0",ows:"http://www.opengis.net/ows/1.1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",defaultPrefix:"wps",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,
[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{wps:{ProcessDescriptions:function(a,b){b.processDescriptions={};this.readChildNodes(a,b.processDescriptions)},ProcessDescription:function(a,b){var c={processVersion:this.getAttributeNS(a,this.namespaces.wps,"processVersion"),statusSupported:"true"===a.getAttribute("statusSupported"),storeSupported:"true"===a.getAttribute("storeSupported")};this.readChildNodes(a,c);b[c.identifier]=c},DataInputs:function(a,
b){b.dataInputs=[];this.readChildNodes(a,b.dataInputs)},ProcessOutputs:function(a,b){b.processOutputs=[];this.readChildNodes(a,b.processOutputs)},Output:function(a,b){var c={};this.readChildNodes(a,c);b.push(c)},ComplexOutput:function(a,b){b.complexOutput={};this.readChildNodes(a,b.complexOutput)},LiteralOutput:function(a,b){b.literalOutput={};this.readChildNodes(a,b.literalOutput)},Input:function(a,b){var c={maxOccurs:parseInt(a.getAttribute("maxOccurs")),minOccurs:parseInt(a.getAttribute("minOccurs"))};
this.readChildNodes(a,c);b.push(c)},BoundingBoxData:function(a,b){b.boundingBoxData={};this.readChildNodes(a,b.boundingBoxData)},CRS:function(a,b){b.CRSs||(b.CRSs={});b.CRSs[this.getChildValue(a)]=!0},LiteralData:function(a,b){b.literalData={};this.readChildNodes(a,b.literalData)},ComplexData:function(a,b){b.complexData={};this.readChildNodes(a,b.complexData)},Default:function(a,b){b["default"]={};this.readChildNodes(a,b["default"])},Supported:function(a,b){b.supported={};this.readChildNodes(a,b.supported)},
Format:function(a,b){var c={};this.readChildNodes(a,c);b.formats||(b.formats={});b.formats[c.mimeType]=!0},MimeType:function(a,b){b.mimeType=this.getChildValue(a)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSDescribeProcess"});OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(a){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){var b,c;a=a.replace(/[\n\r]/g," ");if(c=this.regExes.typeStr.exec(a))if(a=c[1].toLowerCase(),c=c[2],this.parse[a]&&(b=this.parse[a].apply(this,[c])),this.internalProjection&&this.externalProjection)if(b&&
"OpenLayers.Feature.Vector"==b.CLASS_NAME)b.geometry.transform(this.externalProjection,this.internalProjection);else if(b&&"geometrycollection"!=a&&"object"==typeof b)for(a=0,c=b.length;a<c;a++)b[a].geometry.transform(this.externalProjection,this.internalProjection);return b},write:function(a){var b,c;a.constructor==Array?c=!0:(a=[a],c=!1);var d=[];c&&d.push("GEOMETRYCOLLECTION(");for(var e=0,f=a.length;e<f;++e)c&&0<e&&d.push(","),b=a[e].geometry,d.push(this.extractGeometry(b));c&&d.push(")");return d.join("")},
extractGeometry:function(a){var b=a.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[b])return null;this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));return("collection"==b?"GEOMETRYCOLLECTION":b.toUpperCase())+"("+this.extract[b].apply(this,[a])+")"},extract:{point:function(a){return a.x+" "+a.y},multipoint:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.point.apply(this,[a.components[c]])+
")");return b.join(",")},linestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b.join(",")},multilinestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},polygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},multipolygon:function(a){for(var b=
[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.polygon.apply(this,[a.components[c]])+")");return b.join(",")},collection:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extractGeometry.apply(this,[a.components[c]]));return b.join(",")}},parse:{point:function(a){a=OpenLayers.String.trim(a).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a[0],a[1]))},multipoint:function(a){for(var b=OpenLayers.String.trim(a).split(","),
c=[],d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.point.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(c))},linestring:function(a){a=OpenLayers.String.trim(a).split(",");for(var b=[],c=0,d=a.length;c<d;++c)b.push(this.parse.point.apply(this,[a[c]]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(b))},multilinestring:function(a){for(var b=OpenLayers.String.trim(a).split(this.regExes.parenComma),
c=[],d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.linestring.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(c))},polygon:function(a){var b;a=OpenLayers.String.trim(a).split(this.regExes.parenComma);for(var c=[],d=0,e=a.length;d<e;++d)b=a[d].replace(this.regExes.trimParens,"$1"),b=this.parse.linestring.apply(this,[b]).geometry,b=new OpenLayers.Geometry.LinearRing(b.components),c.push(b);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(c))},
multipolygon:function(a){for(var b=OpenLayers.String.trim(a).split(this.regExes.doubleParenComma),c=[],d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.polygon.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(c))},geometrycollection:function(a){a=a.replace(/,\s*([A-Za-z])/g,"|$1");a=OpenLayers.String.trim(a).split("|");for(var b=[],c=0,d=a.length;c<d;++c)b.push(OpenLayers.Format.WKT.prototype.read.apply(this,[a[c]]));
return b}},CLASS_NAME:"OpenLayers.Format.WKT"});OpenLayers.WPSProcess=OpenLayers.Class({client:null,server:null,identifier:null,description:null,localWPS:"http://geoserver/wps",formats:null,chained:0,executeCallbacks:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.executeCallbacks=[];this.formats={"application/wkt":new OpenLayers.Format.WKT,"application/json":new OpenLayers.Format.GeoJSON}},describe:function(a){a=a||{};if(!this.description)this.client.describeProcess(this.server,this.identifier,function(b){this.description||this.parseDescription(b);
a.callback&&a.callback.call(a.scope,this.description)},this);else if(a.callback){var b=this.description;window.setTimeout(function(){a.callback.call(a.scope,b)},0)}},configure:function(a){this.describe({callback:function(){var b=this.description,c=a.inputs,d,e,f;e=0;for(f=b.dataInputs.length;e<f;++e)d=b.dataInputs[e],this.setInputData(d,c[d.identifier]);a.callback&&a.callback.call(a.scope)},scope:this});return this},execute:function(a){this.configure({inputs:a.inputs,callback:function(){var b=this,
c=this.getOutputIndex(b.description.processOutputs,a.output);b.setResponseForm({outputIndex:c});(function e(){OpenLayers.Util.removeItem(b.executeCallbacks,e);0!==b.chained?b.executeCallbacks.push(e):OpenLayers.Request.POST({url:b.client.servers[b.server].url,data:(new OpenLayers.Format.WPSExecute).write(b.description),success:function(e){var g=b.findMimeType(b.description.processOutputs[c].complexOutput.supported.formats);e=b.formats[g].read(e.responseText);e instanceof OpenLayers.Feature.Vector&&
(e=[e]);a.success&&(g={},g[a.output||"result"]=e,a.success.call(a.scope,g))},scope:b})})()},scope:this})},output:function(a){return new OpenLayers.WPSProcess.ChainLink({process:this,output:a})},parseDescription:function(a){a=this.client.servers[this.server];this.description=(new OpenLayers.Format.WPSDescribeProcess).read(a.processDescription[this.identifier]).processDescriptions[this.identifier]},setInputData:function(a,b){delete a.data;delete a.reference;if(b instanceof OpenLayers.WPSProcess.ChainLink)++this.chained,
a.reference={method:"POST",href:b.process.server===this.server?this.localWPS:this.client.servers[b.process.server].url},b.process.describe({callback:function(){--this.chained;this.chainProcess(a,b)},scope:this});else{a.data={};var c=a.complexData;c?(c=this.findMimeType(c.supported.formats),a.data.complexData={mimeType:c,value:this.formats[c].write(this.toFeatures(b))}):a.data.literalData={value:b}}},setResponseForm:function(a){a=a||{};var b=this.description.processOutputs[a.outputIndex||0];this.description.responseForm=
{rawDataOutput:{identifier:b.identifier,mimeType:this.findMimeType(b.complexOutput.supported.formats,a.supportedFormats)}}},getOutputIndex:function(a,b){var c;if(b)for(var d=a.length-1;0<=d;--d){if(a[d].identifier===b){c=d;break}}else c=0;return c},chainProcess:function(a,b){var c=this.getOutputIndex(b.process.description.processOutputs,b.output);a.reference.mimeType=this.findMimeType(a.complexData.supported.formats,b.process.description.processOutputs[c].complexOutput.supported.formats);var d={};
d[a.reference.mimeType]=!0;b.process.setResponseForm({outputIndex:c,supportedFormats:d});for(a.reference.body=b.process.description;0<this.executeCallbacks.length;)this.executeCallbacks[0]()},toFeatures:function(a){var b=OpenLayers.Util.isArray(a);b||(a=[a]);for(var c=Array(a.length),d,e=0,f=a.length;e<f;++e)d=a[e],c[e]=d instanceof OpenLayers.Feature.Vector?d:new OpenLayers.Feature.Vector(d);return b?c:c[0]},findMimeType:function(a,b){b=b||this.formats;for(var c in a)if(c in b)return c},CLASS_NAME:"OpenLayers.WPSProcess"});
OpenLayers.WPSProcess.ChainLink=OpenLayers.Class({process:null,output:null,initialize:function(a){OpenLayers.Util.extend(this,a)},CLASS_NAME:"OpenLayers.WPSProcess.ChainLink"});OpenLayers.WPSClient=OpenLayers.Class({servers:null,version:"1.0.0",lazy:!1,events:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.events=new OpenLayers.Events(this);this.servers={};for(var b in a.servers)this.servers[b]="string"==typeof a.servers[b]?{url:a.servers[b],version:this.version,processDescription:{}}:a.servers[b]},execute:function(a){this.getProcess(a.server,a.process).execute({inputs:a.inputs,success:a.success,scope:a.scope})},getProcess:function(a,b){var c=new OpenLayers.WPSProcess({client:this,
server:a,identifier:b});this.lazy||c.describe();return c},describeProcess:function(a,b,c,d){var e=this.servers[a];e.processDescription[b]?window.setTimeout(function(){c.call(d,e.processDescription[b])},0):b in e.processDescription?this.events.register("describeprocess",this,function g(a){a.identifier===b&&(this.events.unregister("describeprocess",this,g),c.call(d,a.raw))}):(e.processDescription[b]=null,OpenLayers.Request.GET({url:e.url,params:{SERVICE:"WPS",VERSION:e.version,REQUEST:"DescribeProcess",
IDENTIFIER:b},success:function(a){e.processDescription[b]=a.responseText;this.events.triggerEvent("describeprocess",{identifier:b,raw:a.responseText})},scope:this}))},destroy:function(){this.events.destroy();this.servers=this.events=null},CLASS_NAME:"OpenLayers.WPSClient"});OpenLayers.Format.CSWGetRecords.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{csw:"http://www.opengis.net/cat/csw/2.0.2",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",gmd:"http://www.isotc211.org/2005/gmd",geonet:"http://www.fao.org/geonetwork",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",
requestId:null,resultType:null,outputFormat:null,outputSchema:null,startPosition:null,maxRecords:null,DistributedSearch:null,ResponseHandler:null,Query:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},
readers:{csw:{GetRecordsResponse:function(a,b){b.records=[];this.readChildNodes(a,b);var c=this.getAttributeNS(a,"","version");""!=c&&(b.version=c)},RequestId:function(a,b){b.RequestId=this.getChildValue(a)},SearchStatus:function(a,b){b.SearchStatus={};var c=this.getAttributeNS(a,"","timestamp");""!=c&&(b.SearchStatus.timestamp=c)},SearchResults:function(a,b){this.readChildNodes(a,b);for(var c=a.attributes,d={},e=0,f=c.length;e<f;++e)d[c[e].name]="numberOfRecordsMatched"==c[e].name||"numberOfRecordsReturned"==
c[e].name||"nextRecord"==c[e].name?parseInt(c[e].nodeValue):c[e].nodeValue;b.SearchResults=d},SummaryRecord:function(a,b){var c={type:"SummaryRecord"};this.readChildNodes(a,c);b.records.push(c)},BriefRecord:function(a,b){var c={type:"BriefRecord"};this.readChildNodes(a,c);b.records.push(c)},DCMIRecord:function(a,b){var c={type:"DCMIRecord"};this.readChildNodes(a,c);b.records.push(c)},Record:function(a,b){var c={type:"Record"};this.readChildNodes(a,c);b.records.push(c)},"*":function(a,b){var c=a.localName||
a.nodeName.split(":").pop();b[c]=this.getChildValue(a)}},geonet:{info:function(a,b){var c={};this.readChildNodes(a,c);b.gninfo=c}},dc:{"*":function(a,b){var c=a.localName||a.nodeName.split(":").pop();OpenLayers.Util.isArray(b[c])||(b[c]=[]);for(var d={},e=a.attributes,f=0,g=e.length;f<g;++f)d[e[f].name]=e[f].nodeValue;d.value=this.getChildValue(a);""!=d.value&&b[c].push(d)}},dct:{"*":function(a,b){var c=a.localName||a.nodeName.split(":").pop();OpenLayers.Util.isArray(b[c])||(b[c]=[]);b[c].push(this.getChildValue(a))}},
ows:OpenLayers.Util.applyDefaults({BoundingBox:function(a,b){b.bounds&&(b.BoundingBox=[{crs:b.projection,value:[b.bounds.left,b.bounds.bottom,b.bounds.right,b.bounds.top]}],delete b.projection,delete b.bounds);OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows.BoundingBox.apply(this,arguments)}},OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows)},write:function(a){a=this.writeNode("csw:GetRecords",a);a.setAttribute("xmlns:gmd",this.namespaces.gmd);return OpenLayers.Format.XML.prototype.write.apply(this,
[a])},writers:{csw:{GetRecords:function(a){a||(a={});var b=this.createElementNSPlus("csw:GetRecords",{attributes:{service:"CSW",version:this.version,requestId:a.requestId||this.requestId,resultType:a.resultType||this.resultType,outputFormat:a.outputFormat||this.outputFormat,outputSchema:a.outputSchema||this.outputSchema,startPosition:a.startPosition||this.startPosition,maxRecords:a.maxRecords||this.maxRecords}});(a.DistributedSearch||this.DistributedSearch)&&this.writeNode("csw:DistributedSearch",
a.DistributedSearch||this.DistributedSearch,b);var c=a.ResponseHandler||this.ResponseHandler;if(OpenLayers.Util.isArray(c)&&0<c.length)for(var d=0,e=c.length;d<e;d++)this.writeNode("csw:ResponseHandler",c[d],b);this.writeNode("Query",a.Query||this.Query,b);return b},DistributedSearch:function(a){return this.createElementNSPlus("csw:DistributedSearch",{attributes:{hopCount:a.hopCount}})},ResponseHandler:function(a){return this.createElementNSPlus("csw:ResponseHandler",{value:a.value})},Query:function(a){a||
(a={});var b=this.createElementNSPlus("csw:Query",{attributes:{typeNames:a.typeNames||"csw:Record"}}),c=a.ElementName;if(OpenLayers.Util.isArray(c)&&0<c.length)for(var d=0,e=c.length;d<e;d++)this.writeNode("csw:ElementName",c[d],b);else this.writeNode("csw:ElementSetName",a.ElementSetName||{value:"summary"},b);a.Constraint&&this.writeNode("csw:Constraint",a.Constraint,b);a.SortBy&&this.writeNode("ogc:SortBy",a.SortBy,b);return b},ElementName:function(a){return this.createElementNSPlus("csw:ElementName",
{value:a.value})},ElementSetName:function(a){return this.createElementNSPlus("csw:ElementSetName",{attributes:{typeNames:a.typeNames},value:a.value})},Constraint:function(a){var b=this.createElementNSPlus("csw:Constraint",{attributes:{version:a.version}});if(a.Filter){var c=new OpenLayers.Format.Filter({version:a.version});b.appendChild(c.write(a.Filter))}else a.CqlText&&(a=this.createElementNSPlus("CqlText",{value:a.CqlText.value}),b.appendChild(a));return b}},ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},
CLASS_NAME:"OpenLayers.Format.CSWGetRecords.v2_0_2"});/*
 Apache 2 

 Contains portions of Rico <http://openrico.org/>

 Copyright 2005 Sabre Airline Solutions  

 Licensed under the Apache License, Version 2.0 (the "License"); you
 may not use this file except in compliance with the License. You
 may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0  

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied. See the License for the specific language governing
 permissions and limitations under the License. 
*/
OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,{bounds:null,div:null,initialize:function(a,b,c){this.bounds=a;this.div=OpenLayers.Util.createDiv();this.div.style.overflow="hidden";this.events=new OpenLayers.Events(this,this.div);this.setBorder(b,c)},destroy:function(){this.div=this.bounds=null;OpenLayers.Marker.prototype.destroy.apply(this,arguments)},setBorder:function(a,b){a||(a="red");b||(b=2);this.div.style.border=b+"px solid "+a},draw:function(a,b){OpenLayers.Util.modifyDOMElement(this.div,
null,a,b);return this.div},onScreen:function(){var a=!1;this.map&&(a=this.map.getExtent().containsBounds(this.bounds,!0,!0));return a},display:function(a){this.div.style.display=a?"":"none"},CLASS_NAME:"OpenLayers.Marker.Box"});OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:!0,initialize:function(a){a=a||{};!1!==a.extractStyles&&(a.defaultStyle={externalGraphic:OpenLayers.Util.getImageLocation("marker.png"),graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5});OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){a=a.split("\n");for(var b,c=[],d=0;d<a.length-1;d++){var e=a[d].replace(/^\s*/,"").replace(/\s*$/,"");if("#"!=e.charAt(0))if(b){for(var e=
e.split("\t"),f=new OpenLayers.Geometry.Point(0,0),g={},h=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null,k=!1,l=0;l<e.length;l++)if(e[l])if("point"==b[l])k=e[l].split(","),f.y=parseFloat(k[0]),f.x=parseFloat(k[1]),k=!0;else if("lat"==b[l])f.y=parseFloat(e[l]),k=!0;else if("lon"==b[l])f.x=parseFloat(e[l]),k=!0;else if("title"==b[l])g.title=e[l];else if("image"==b[l]||"icon"==b[l]&&h)h.externalGraphic=e[l];else if("iconSize"==b[l]&&h){var m=e[l].split(",");h.graphicWidth=
parseFloat(m[0]);h.graphicHeight=parseFloat(m[1])}else"iconOffset"==b[l]&&h?(m=e[l].split(","),h.graphicXOffset=parseFloat(m[0]),h.graphicYOffset=parseFloat(m[1])):"description"==b[l]?g.description=e[l]:"overflow"==b[l]?g.overflow=e[l]:g[b[l]]=e[l];k&&(this.internalProjection&&this.externalProjection&&f.transform(this.externalProjection,this.internalProjection),e=new OpenLayers.Feature.Vector(f,g,h),c.push(e))}else b=e.split("\t")}return c},CLASS_NAME:"OpenLayers.Format.Text"});OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(a,b){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments);this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadText:function(){this.loaded||null==this.location||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location,
success:this.parseData,failure:function(a){this.events.triggerEvent("loadend")},scope:this}),this.loaded=!0)},moveTo:function(a,b,c){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);this.visibility&&!this.loaded&&this.loadText()},parseData:function(a){a=a.responseText;var b={};OpenLayers.Util.extend(b,this.formatOptions);this.map&&!this.projection.equals(this.map.getProjectionObject())&&(b.externalProjection=this.projection,b.internalProjection=this.map.getProjectionObject());a=(new OpenLayers.Format.Text(b)).read(a);
for(var b=0,c=a.length;b<c;b++){var d={},e=a[b],f,g,h;f=new OpenLayers.LonLat(e.geometry.x,e.geometry.y);e.style.graphicWidth&&e.style.graphicHeight&&(g=new OpenLayers.Size(e.style.graphicWidth,e.style.graphicHeight));void 0!==e.style.graphicXOffset&&void 0!==e.style.graphicYOffset&&(h=new OpenLayers.Pixel(e.style.graphicXOffset,e.style.graphicYOffset));null!=e.style.externalGraphic?d.icon=new OpenLayers.Icon(e.style.externalGraphic,g,h):(d.icon=OpenLayers.Marker.defaultIcon(),null!=g&&d.icon.setSize(g));
null!=e.attributes.title&&null!=e.attributes.description&&(d.popupContentHTML="<h2>"+e.attributes.title+"</h2><p>"+e.attributes.description+"</p>");d.overflow=e.attributes.overflow||"auto";d=new OpenLayers.Feature(this,f,d);this.features.push(d);f=d.createMarker();null!=e.attributes.title&&null!=e.attributes.description&&f.events.register("click",d,this.markerClick);this.addMarker(f)}this.events.triggerEvent("loadend")},markerClick:function(a){var b=this==this.layer.selectedFeature;this.layer.selectedFeature=
b?null:this;for(var c=0,d=this.layer.map.popups.length;c<d;c++)this.layer.map.removePopup(this.layer.map.popups[c]);b||this.layer.map.addPopup(this.createPopup());OpenLayers.Event.stop(a)},clearFeatures:function(){if(null!=this.features)for(;0<this.features.length;){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a);a.destroy()}},CLASS_NAME:"OpenLayers.Layer.Text"});OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",layerOptions:null,persist:!1,irregular:!1,citeCompliant:!1,angle:null,fixedRadius:!1,feature:null,layer:null,origin:null,initialize:function(a,b,c){c&&c.layerOptions&&c.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{}));OpenLayers.Handler.Drag.prototype.initialize.apply(this,[a,b,c]);this.options=c?c:{}},setOptions:function(a){OpenLayers.Util.extend(this.options,
a);OpenLayers.Util.extend(this,a)},activate:function(){var a=!1;OpenLayers.Handler.Drag.prototype.activate.apply(this,arguments)&&(a=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions),this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a),this.map.addLayer(this.layer),a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)&&(this.dragging&&this.cancel(),
null!=this.layer.map&&(this.layer.destroy(!1),this.feature&&this.feature.destroy()),this.feature=this.layer=null,a=!0);return a},down:function(a){this.fixedRadius=!!this.radius;a=this.layer.getLonLatFromViewPortPx(a.xy);this.origin=new OpenLayers.Geometry.Point(a.lon,a.lat);if(!this.fixedRadius||this.irregular)this.radius=this.map.getResolution();this.persist&&this.clear();this.feature=new OpenLayers.Feature.Vector;this.createGeometry();this.callback("create",[this.origin,this.feature]);this.layer.addFeatures([this.feature],
{silent:!0});this.layer.drawFeature(this.feature,this.style)},move:function(a){var b=this.layer.getLonLatFromViewPortPx(a.xy),b=new OpenLayers.Geometry.Point(b.lon,b.lat);this.irregular?(a=Math.sqrt(2)*Math.abs(b.y-this.origin.y)/2,this.radius=Math.max(this.map.getResolution()/2,a)):this.fixedRadius?this.origin=b:(this.calculateAngle(b,a),this.radius=Math.max(this.map.getResolution()/2,b.distanceTo(this.origin)));this.modifyGeometry();if(this.irregular){a=b.x-this.origin.x;var b=b.y-this.origin.y,
c;c=0==b?a/(this.radius*Math.sqrt(2)):a/b;this.feature.geometry.resize(1,this.origin,c);this.feature.geometry.move(a/2,b/2)}this.layer.drawFeature(this.feature,this.style)},up:function(a){this.finalize();this.start==this.last&&this.callback("done",[a.xy])},out:function(a){this.finalize()},createGeometry:function(){this.angle=Math.PI*(1/this.sides-0.5);this.snapAngle&&(this.angle+=this.snapAngle*(Math.PI/180));this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,
this.sides,this.snapAngle)},modifyGeometry:function(){var a,b,c=this.feature.geometry.components[0];c.components.length!=this.sides+1&&(this.createGeometry(),c=this.feature.geometry.components[0]);for(var d=0;d<this.sides;++d)b=c.components[d],a=this.angle+2*d*Math.PI/this.sides,b.x=this.origin.x+this.radius*Math.cos(a),b.y=this.origin.y+this.radius*Math.sin(a),b.clearBounds()},calculateAngle:function(a,b){var c=Math.atan2(a.y-this.origin.y,a.x-this.origin.x);if(this.snapAngle&&this.snapToggle&&!b[this.snapToggle]){var d=
Math.PI/180*this.snapAngle;this.angle=Math.round(c/d)*d}else this.angle=c},cancel:function(){this.callback("cancel",null);this.finalize()},finalize:function(){this.origin=null;this.radius=this.options.radius},clear:function(){this.layer&&(this.layer.renderer.clear(),this.layer.destroyFeatures())},callback:function(a,b){this.callbacks[a]&&this.callbacks[a].apply(this.control,[this.feature.geometry.clone()]);this.persist||"done"!=a&&"cancel"!=a||this.clear()},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"});OpenLayers.Control.SLDSelect=OpenLayers.Class(OpenLayers.Control,{clearOnDeactivate:!1,layers:null,callbacks:null,selectionSymbolizer:{Polygon:{fillColor:"#FF0000",stroke:!1},Line:{strokeColor:"#FF0000",strokeWidth:2},Point:{graphicName:"square",fillColor:"#FF0000",pointRadius:5}},layerOptions:null,sketchStyle:null,wfsCache:{},layerCache:{},initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.callbacks=OpenLayers.Util.extend({done:this.select,click:this.select},this.callbacks);
this.handlerOptions=this.handlerOptions||{};this.layerOptions=OpenLayers.Util.applyDefaults(this.layerOptions,{displayInLayerSwitcher:!1,tileOptions:{maxGetUrlLength:2048}});this.sketchStyle&&(this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":this.sketchStyle})}));this.handler=new a(this,this.callbacks,this.handlerOptions)},destroy:function(){for(var a in this.layerCache)delete this.layerCache[a];for(a in this.wfsCache)delete this.wfsCache[a];
OpenLayers.Control.prototype.destroy.apply(this,arguments)},coupleLayerVisiblity:function(a){this.setVisibility(a.object.getVisibility())},createSelectionLayer:function(a){var b;if(this.layerCache[a.id])b=this.layerCache[a.id];else{b=new OpenLayers.Layer.WMS(a.name,a.url,a.params,OpenLayers.Util.applyDefaults(this.layerOptions,a.getOptions()));this.layerCache[a.id]=b;if(!1===this.layerOptions.displayInLayerSwitcher)a.events.on({visibilitychanged:this.coupleLayerVisiblity,scope:b});this.map.addLayer(b)}return b},
createSLD:function(a,b,c){for(var d={version:"1.0.0",namedLayers:{}},e=(""+a.params.LAYERS).split(","),f=0,g=e.length;f<g;f++){var h=e[f];d.namedLayers[h]={name:h,userStyles:[]};var k=this.selectionSymbolizer,l=c[f];0<=l.type.indexOf("Polygon")?k={Polygon:this.selectionSymbolizer.Polygon}:0<=l.type.indexOf("LineString")?k={Line:this.selectionSymbolizer.Line}:0<=l.type.indexOf("Point")&&(k={Point:this.selectionSymbolizer.Point});d.namedLayers[h].userStyles.push({name:"default",rules:[new OpenLayers.Rule({symbolizer:k,
filter:b[f],maxScaleDenominator:a.options.minScale})]})}return(new OpenLayers.Format.SLD({srsName:this.map.getProjection()})).write(d)},parseDescribeLayer:function(a){var b=new OpenLayers.Format.WMSDescribeLayer,c=a.responseXML;c&&c.documentElement||(c=a.responseText);a=b.read(c);for(var b=[],c=null,d=0,e=a.length;d<e;d++)"WFS"==a[d].owsType&&(b.push(a[d].typeName),c=a[d].owsURL);OpenLayers.Request.GET({url:c,params:{SERVICE:"WFS",TYPENAME:b.toString(),REQUEST:"DescribeFeatureType",VERSION:"1.0.0"},
callback:function(a){var b=new OpenLayers.Format.WFSDescribeFeatureType,c=a.responseXML;c&&c.documentElement||(c=a.responseText);a=b.read(c);this.control.wfsCache[this.layer.id]=a;this.control._queue&&this.control.applySelection()},scope:this})},getGeometryAttributes:function(a){var b=[];a=this.wfsCache[a.id];for(var c=0,d=a.featureTypes.length;c<d;c++)for(var e=a.featureTypes[c].properties,f=0,g=e.length;f<g;f++){var h=e[f],k=h.type;(0<=k.indexOf("LineString")||0<=k.indexOf("GeometryAssociationType")||
0<=k.indexOf("GeometryPropertyType")||0<=k.indexOf("Point")||0<=k.indexOf("Polygon"))&&b.push(h)}return b},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a)for(var b=0,c=this.layers.length;b<c;b++){var d=this.layers[b];d&&!this.wfsCache[d.id]&&OpenLayers.Request.GET({url:d.url,params:{SERVICE:"WMS",VERSION:d.params.VERSION,LAYERS:d.params.LAYERS,REQUEST:"DescribeLayer"},callback:this.parseDescribeLayer,scope:{layer:d,control:this}})}return a},deactivate:function(){var a=
OpenLayers.Control.prototype.deactivate.call(this);if(a)for(var b=0,c=this.layers.length;b<c;b++){var d=this.layers[b];if(d&&!0===this.clearOnDeactivate){var e=this.layerCache,f=e[d.id];f&&(d.events.un({visibilitychanged:this.coupleLayerVisiblity,scope:f}),f.destroy(),delete e[d.id])}}return a},setLayers:function(a){this.active?(this.deactivate(),this.layers=a,this.activate()):this.layers=a},createFilter:function(a,b){var c=null;this.handler instanceof OpenLayers.Handler.RegularPolygon?c=!0===this.handler.irregular?
new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:a.name,value:b.getBounds()}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):this.handler instanceof OpenLayers.Handler.Polygon?c=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):this.handler instanceof OpenLayers.Handler.Path?c=0<=a.type.indexOf("Point")?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,
property:a.name,distance:0.01*this.map.getExtent().getWidth(),distanceUnits:this.map.getUnits(),value:b}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):this.handler instanceof OpenLayers.Handler.Click&&(c=0<=a.type.indexOf("Polygon")?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,property:a.name,distance:0.01*this.map.getExtent().getWidth(),
distanceUnits:this.map.getUnits(),value:b}));return c},select:function(a){this._queue=function(){for(var b=0,c=this.layers.length;b<c;b++){for(var d=this.layers[b],e=this.getGeometryAttributes(d),f=[],g=0,h=e.length;g<h;g++){var k=e[g];if(null!==k){if(!(a instanceof OpenLayers.Geometry)){var l=this.map.getLonLatFromPixel(a.xy);a=new OpenLayers.Geometry.Point(l.lon,l.lat)}k=this.createFilter(k,a);null!==k&&f.push(k)}}g=this.createSelectionLayer(d);this.events.triggerEvent("selected",{layer:d,filters:f});
d=this.createSLD(d,f,e);g.mergeNewParams({SLD_BODY:d});delete this._queue}};this.applySelection()},applySelection:function(){for(var a=!0,b=0,c=this.layers.length;b<c;b++)if(!this.wfsCache[this.layers[b].id]){a=!1;break}a&&this._queue.call(this)},CLASS_NAME:"OpenLayers.Control.SLDSelect"});OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,geodesic:!1,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.element=OpenLayers.Util.getElement(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.element||(this.element=document.createElement("div"),this.div.appendChild(this.element));this.map.events.register("moveend",this,this.updateScale);this.updateScale();return this.div},updateScale:function(){var a;
if(!0===this.geodesic){if(!this.map.getUnits())return;a=OpenLayers.INCHES_PER_UNIT;a=(this.map.getGeodesicPixelSize().w||1E-6)*a.km*OpenLayers.DOTS_PER_INCH}else a=this.map.getScale();a&&(a=9500<=a&&95E4>=a?Math.round(a/1E3)+"K":95E4<=a?Math.round(a/1E6)+"M":Math.round(a),this.element.innerHTML=OpenLayers.i18n("Scale = 1 : ${scaleDenom}",{scaleDenom:a}))},CLASS_NAME:"OpenLayers.Control.Scale"});OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,useHttpTile:!1,singleTile:!1,useOverlay:!1,useAsyncOverlay:!0,TILE_PARAMS:{operation:"GETTILEIMAGE",version:"1.2.0"},SINGLE_TILE_PARAMS:{operation:"GETMAPIMAGE",format:"PNG",locale:"en",clip:"1",version:"1.0.0"},OVERLAY_PARAMS:{operation:"GETDYNAMICMAPOVERLAYIMAGE",format:"PNG",locale:"en",clip:"1",version:"2.0.0"},FOLDER_PARAMS:{tileColumnsPerFolder:30,tileRowsPerFolder:30,format:"png",querystring:null},defaultSize:new OpenLayers.Size(300,
300),tileOriginCorner:"tl",initialize:function(a,b,c,d){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);if(null==d||null==d.isBaseLayer)this.isBaseLayer="true"!=this.transparent&&!0!=this.transparent;d&&null!=d.useOverlay&&(this.useOverlay=d.useOverlay);this.singleTile?this.useOverlay?(OpenLayers.Util.applyDefaults(this.params,this.OVERLAY_PARAMS),this.useAsyncOverlay||(this.params.version="1.0.0")):OpenLayers.Util.applyDefaults(this.params,this.SINGLE_TILE_PARAMS):(this.useHttpTile?
OpenLayers.Util.applyDefaults(this.params,this.FOLDER_PARAMS):OpenLayers.Util.applyDefaults(this.params,this.TILE_PARAMS),this.setTileSize(this.defaultSize))},clone:function(a){null==a&&(a=new OpenLayers.Layer.MapGuide(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var b;b=a.getCenterLonLat();var c=this.map.getSize();this.singleTile?(a={setdisplaydpi:OpenLayers.DOTS_PER_INCH,setdisplayheight:c.h*this.ratio,setdisplaywidth:c.w*
this.ratio,setviewcenterx:b.lon,setviewcentery:b.lat,setviewscale:this.map.getScale()},this.useOverlay&&!this.useAsyncOverlay&&(b={},b=OpenLayers.Util.extend(b,a),b.operation="GETVISIBLEMAPEXTENT",b.version="1.0.0",b.session=this.params.session,b.mapName=this.params.mapName,b.format="text/xml",b=this.getFullRequestString(b),OpenLayers.Request.GET({url:b,async:!1})),b=this.getFullRequestString(a)):(c=this.map.getResolution(),b=Math.floor((a.left-this.maxExtent.left)/c),b=Math.round(b/this.tileSize.w),
a=Math.floor((this.maxExtent.top-a.top)/c),a=Math.round(a/this.tileSize.h),b=this.useHttpTile?this.getImageFilePath({tilecol:b,tilerow:a,scaleindex:this.resolutions.length-this.map.zoom-1}):this.getFullRequestString({tilecol:b,tilerow:a,scaleindex:this.resolutions.length-this.map.zoom-1}));return b},getFullRequestString:function(a,b){var c=null==b?this.url:b;"object"==typeof c&&(c=c[Math.floor(Math.random()*c.length)]);var d=c,e=OpenLayers.Util.extend({},this.params),e=OpenLayers.Util.extend(e,a),
f=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),g;for(g in e)g.toUpperCase()in f&&delete e[g];e=OpenLayers.Util.getParameterString(e);e=e.replace(/,/g,"+");""!=e&&(f=c.charAt(c.length-1),d="&"==f||"?"==f?d+e:-1==c.indexOf("?")?d+("?"+e):d+("&"+e));return d},getImageFilePath:function(a,b){var c=null==b?this.url:b;"object"==typeof c&&(c=c[Math.floor(Math.random()*c.length)]);var d="",e="";0>a.tilerow&&(d="-");d=0==a.tilerow?d+"0":d+Math.floor(Math.abs(a.tilerow/this.params.tileRowsPerFolder))*
this.params.tileRowsPerFolder;0>a.tilecol&&(e="-");e=0==a.tilecol?e+"0":e+Math.floor(Math.abs(a.tilecol/this.params.tileColumnsPerFolder))*this.params.tileColumnsPerFolder;d="/S"+Math.floor(a.scaleindex)+"/"+this.params.basemaplayergroupname+"/R"+d+"/C"+e+"/"+a.tilerow%this.params.tileRowsPerFolder+"_"+a.tilecol%this.params.tileColumnsPerFolder+"."+this.params.format;this.params.querystring&&(d+="?"+this.params.querystring);return c+d},CLASS_NAME:"OpenLayers.Layer.MapGuide"});OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{callbacks:null,displaySystem:"metric",geodesic:!1,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:!1,immediate:!1,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);var c={done:this.measureComplete,point:this.measurePartial};this.immediate&&(c.modify=this.measureImmediate);this.callbacks=OpenLayers.Util.extend(c,this.callbacks);
this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions);this.handler=new a(this,this.callbacks,this.handlerOptions)},deactivate:function(){this.cancelDelay();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},cancel:function(){this.cancelDelay();this.handler.cancel()},setImmediate:function(a){(this.immediate=a)?this.callbacks.modify=this.measureImmediate:delete this.callbacks.modify},updateHandler:function(a,b){var c=this.active;c&&this.deactivate();
this.handler=new a(this,this.callbacks,b);c&&this.activate()},measureComplete:function(a){this.cancelDelay();this.measure(a,"measure")},measurePartial:function(a,b){this.cancelDelay();b=b.clone();this.handler.freehandMode(this.handler.evt)?this.measure(b,"measurepartial"):this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.delayedTrigger=null;this.measure(b,"measurepartial")},this),this.partialDelay)},measureImmediate:function(a,b,c){c&&!this.handler.freehandMode(this.handler.evt)&&
(this.cancelDelay(),this.measure(b.geometry,"measurepartial"))},cancelDelay:function(){null!==this.delayedTrigger&&(window.clearTimeout(this.delayedTrigger),this.delayedTrigger=null)},measure:function(a,b){var c,d;-1<a.CLASS_NAME.indexOf("LineString")?(c=this.getBestLength(a),d=1):(c=this.getBestArea(a),d=2);this.events.triggerEvent(b,{measure:c[0],units:c[1],order:d,geometry:a})},getBestArea:function(a){for(var b=this.displaySystemUnits[this.displaySystem],c,d,e=0,f=b.length;e<f&&!(c=b[e],d=this.getArea(a,
c),1<d);++e);return[d,c]},getArea:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicArea(this.map.getProjectionObject()),d="m"):(c=a.getArea(),d=this.map.getUnits());var e=OpenLayers.INCHES_PER_UNIT[b];e&&(c*=Math.pow(OpenLayers.INCHES_PER_UNIT[d]/e,2));return c},getBestLength:function(a){for(var b=this.displaySystemUnits[this.displaySystem],c,d,e=0,f=b.length;e<f&&!(c=b[e],d=this.getLength(a,c),1<d);++e);return[d,c]},getLength:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicLength(this.map.getProjectionObject()),
d="m"):(c=a.getLength(),d=this.map.getUnits());var e=OpenLayers.INCHES_PER_UNIT[b];e&&(c*=OpenLayers.INCHES_PER_UNIT[d]/e);return c},CLASS_NAME:"OpenLayers.Control.Measure"});OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},read_wmc_SRS:function(a,b){var c=this.getChildValue(b);"object"!=typeof a.projections&&(a.projections={});for(var c=c.split(/ +/),d=0,e=c.length;d<e;d++)a.projections[c[d]]=!0},write_wmc_Layer:function(a){var b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,
[a]);if(a.srs){var c=[],d;for(d in a.srs)c.push(d);b.appendChild(this.createElementDefaultNS("SRS",c.join(" ")))}b.appendChild(this.write_wmc_FormatList(a));b.appendChild(this.write_wmc_StyleList(a));a.dimensions&&b.appendChild(this.write_wmc_DimensionList(a));b.appendChild(this.write_wmc_LayerExtension(a))},CLASS_NAME:"OpenLayers.Format.WMC.v1_0_0"});OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:!0,anchor:null,initialize:function(a,b,c,d,e,f,g){OpenLayers.Popup.prototype.initialize.apply(this,[a,b,c,d,f,g]);this.anchor=null!=e?e:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.relativePosition=this.anchor=null;OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();OpenLayers.Popup.prototype.show.apply(this,arguments)},
moveTo:function(a){var b=this.relativePosition;this.relativePosition=this.calculateRelativePosition(a);OpenLayers.Popup.prototype.moveTo.call(this,this.calculateNewPx(a));this.relativePosition!=b&&this.updateRelativePosition()},setSize:function(a){OpenLayers.Popup.prototype.setSize.apply(this,arguments);if(this.lonlat&&this.map){var b=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(b)}},calculateRelativePosition:function(a){a=this.map.getLonLatFromLayerPx(a);a=this.map.getExtent().determineQuadrant(a);
return OpenLayers.Bounds.oppositeQuadrant(a)},updateRelativePosition:function(){},calculateNewPx:function(a){a=a.offset(this.anchor.offset);var b=this.size||this.contentSize,c="t"==this.relativePosition.charAt(0);a.y+=c?-b.h:this.anchor.size.h;c="l"==this.relativePosition.charAt(1);a.x+=c?-b.w:this.anchor.size.w;return a},CLASS_NAME:"OpenLayers.Popup.Anchored"});OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:!1,positionBlocks:null,blocks:null,fixedRelativePosition:!1,initialize:function(a,b,c,d,e,f,g){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments);this.fixedRelativePosition&&(this.updateRelativePosition(),this.calculateRelativePosition=function(a){return this.relativePosition});this.contentDiv.style.position="absolute";this.contentDiv.style.zIndex=1;f&&(this.closeDiv.style.zIndex=
1);this.groupDiv.style.position="absolute";this.groupDiv.style.top="0px";this.groupDiv.style.left="0px";this.groupDiv.style.height="100%";this.groupDiv.style.width="100%"},destroy:function(){this.isAlphaImage=this.imageSize=this.imageSrc=null;this.fixedRelativePosition=!1;this.positionBlocks=null;for(var a=0;a<this.blocks.length;a++){var b=this.blocks[a];b.image&&b.div.removeChild(b.image);b.image=null;b.div&&this.groupDiv.removeChild(b.div);b.div=null}this.blocks=null;OpenLayers.Popup.Anchored.prototype.destroy.apply(this,
arguments)},setBackgroundColor:function(a){},setBorder:function(){},setOpacity:function(a){},setSize:function(a){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.updateBlocks()},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var a=this.getContentDivPadding();this.closeDiv.style.right=a.right+this.padding.right+"px";this.closeDiv.style.top=a.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(a){var b=
OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);return b=b.offset(this.positionBlocks[this.relativePosition].offset)},createBlocks:function(){this.blocks=[];var a=null,b;for(b in this.positionBlocks){a=b;break}a=this.positionBlocks[a];for(b=0;b<a.blocks.length;b++){var c={};this.blocks.push(c);c.div=OpenLayers.Util.createDiv(this.id+"_FrameDecorationDiv_"+b,null,null,null,"absolute",null,"hidden",null);c.image=(this.isAlphaImage?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage)(this.id+
"_FrameDecorationImg_"+b,null,this.imageSize,this.imageSrc,"absolute",null,null,null);c.div.appendChild(c.image);this.groupDiv.appendChild(c.div)}},updateBlocks:function(){this.blocks||this.createBlocks();if(this.size&&this.relativePosition){for(var a=this.positionBlocks[this.relativePosition],b=0;b<a.blocks.length;b++){var c=a.blocks[b],d=this.blocks[b],e=c.anchor.left,f=c.anchor.bottom,g=c.anchor.right,h=c.anchor.top,k=isNaN(c.size.w)?this.size.w-(g+e):c.size.w,l=isNaN(c.size.h)?this.size.h-(f+
h):c.size.h;d.div.style.width=(0>k?0:k)+"px";d.div.style.height=(0>l?0:l)+"px";d.div.style.left=null!=e?e+"px":"";d.div.style.bottom=null!=f?f+"px":"";d.div.style.right=null!=g?g+"px":"";d.div.style.top=null!=h?h+"px":"";d.image.style.left=c.position.x+"px";d.image.style.top=c.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px";this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"});OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:!0,panMapIfOutOfView:!0,imageSize:new OpenLayers.Size(1276,736),isAlphaImage:!1,fixedRelativePosition:!1,positionBlocks:{tl:{offset:new OpenLayers.Pixel(44,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,
50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},tr:{offset:new OpenLayers.Pixel(-45,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto",
"auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,
0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},bl:{offset:new OpenLayers.Pixel(45,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,
21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},br:{offset:new OpenLayers.Pixel(-44,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,
0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(1200,660),initialize:function(a,b,c,d,e,f,g){this.imageSrc=OpenLayers.Util.getImageLocation("cloud-popup-relative.png");
OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments);this.contentDiv.className=this.contentDisplayClass},CLASS_NAME:"OpenLayers.Popup.FramedCloud"});OpenLayers.Tile.Image.IFrame={useIFrame:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",draw:function(){if(OpenLayers.Tile.Image.prototype.shouldDraw.call(this)){var a=this.layer.getURL(this.bounds),b=this.useIFrame;this.useIFrame=null!==this.maxGetUrlLength&&!this.layer.async&&a.length>this.maxGetUrlLength;a=b&&!this.useIFrame;b=!b&&this.useIFrame;if(a||b)this.imgDiv&&this.imgDiv.parentNode===this.frame&&this.frame.removeChild(this.imgDiv),this.imgDiv=
null,a&&this.frame.removeChild(this.frame.firstChild)}return OpenLayers.Tile.Image.prototype.draw.apply(this,arguments)},getImage:function(){if(!0===this.useIFrame){if(!this.frame.childNodes.length){var a=document.createElement("div"),b=a.style;b.position="absolute";b.width="100%";b.height="100%";b.zIndex=1;b.backgroundImage="url("+this.blankImageUrl+")";this.frame.appendChild(a)}a=this.id+"_iFrame";9>parseFloat(navigator.appVersion.split("MSIE")[1])?(b=document.createElement('<iframe name="'+a+'">'),
b.style.backgroundColor="#FFFFFF",b.style.filter="chroma(color=#FFFFFF)"):(b=document.createElement("iframe"),b.style.backgroundColor="transparent",b.name=a);b.scrolling="no";b.marginWidth="0px";b.marginHeight="0px";b.frameBorder="0";b.style.position="absolute";b.style.width="100%";b.style.height="100%";1>this.layer.opacity&&OpenLayers.Util.modifyDOMElement(b,null,null,null,null,null,null,this.layer.opacity);this.frame.appendChild(b);return this.imgDiv=b}return OpenLayers.Tile.Image.prototype.getImage.apply(this,
arguments)},createRequestForm:function(){var a=document.createElement("form");a.method="POST";var b=this.layer.params._OLSALT,b=(b?b+"_":"")+this.bounds.toBBOX();a.action=OpenLayers.Util.urlAppend(this.layer.url,b);a.target=this.id+"_iFrame";this.layer.getImageSize();var b=OpenLayers.Util.getParameters(this.url),c,d;for(d in b)c=document.createElement("input"),c.type="hidden",c.name=d,c.value=b[d],a.appendChild(c);return a},setImgSrc:function(a){if(!0===this.useIFrame)if(a){var b=this.createRequestForm();
this.frame.appendChild(b);b.submit();this.frame.removeChild(b)}else this.imgDiv.parentNode===this.frame&&(this.frame.removeChild(this.imgDiv),this.imgDiv=null);else OpenLayers.Tile.Image.prototype.setImgSrc.apply(this,arguments)},onImageLoad:function(){OpenLayers.Tile.Image.prototype.onImageLoad.apply(this,arguments);!0===this.useIFrame&&(this.imgDiv.style.opacity=1,this.frame.style.opacity=this.layer.opacity)},createBackBuffer:function(){var a;!1===this.useIFrame&&(a=OpenLayers.Tile.Image.prototype.createBackBuffer.call(this));
return a}};OpenLayers.Format.SOSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.SOSCapabilities"});OpenLayers.Format.SOSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.SOSCapabilities,{namespaces:{ows:"http://www.opengis.net/ows/1.1",sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,
[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{gml:OpenLayers.Util.applyDefaults({name:function(a,b){b.name=this.getChildValue(a)},TimePeriod:function(a,b){b.timePeriod={};this.readChildNodes(a,b.timePeriod)},beginPosition:function(a,b){b.beginPosition=this.getChildValue(a)},endPosition:function(a,b){b.endPosition=this.getChildValue(a)}},OpenLayers.Format.GML.v3.prototype.readers.gml),sos:{Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,
b){b.contents={};this.readChildNodes(a,b.contents)},ObservationOfferingList:function(a,b){b.offeringList={};this.readChildNodes(a,b.offeringList)},ObservationOffering:function(a,b){var c=this.getAttributeNS(a,this.namespaces.gml,"id");b[c]={procedures:[],observedProperties:[],featureOfInterestIds:[],responseFormats:[],resultModels:[],responseModes:[]};this.readChildNodes(a,b[c])},time:function(a,b){b.time={};this.readChildNodes(a,b.time)},procedure:function(a,b){b.procedures.push(this.getAttributeNS(a,
this.namespaces.xlink,"href"))},observedProperty:function(a,b){b.observedProperties.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},featureOfInterest:function(a,b){b.featureOfInterestIds.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},responseFormat:function(a,b){b.responseFormats.push(this.getChildValue(a))},resultModel:function(a,b){b.resultModels.push(this.getChildValue(a))},responseMode:function(a,b){b.responseModes.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},
CLASS_NAME:"OpenLayers.Format.SOSCapabilities.v1_0_0"});OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!1,pinching:!1,last:null,start:null,touchstart:function(a){var b=!0;this.pinching=!1;if(OpenLayers.Event.isMultiTouch(a))this.started=!0,this.last=this.start={distance:this.getDistance(a.touches),delta:0,scale:1},this.callback("start",[a,this.start]),b=!this.stopDown;else{if(this.started)return!1;this.started=!1;this.last=this.start=null}OpenLayers.Event.preventDefault(a);return b},touchmove:function(a){if(this.started&&
OpenLayers.Event.isMultiTouch(a)){this.pinching=!0;var b=this.getPinchData(a);this.callback("move",[a,b]);this.last=b;OpenLayers.Event.stop(a)}else if(this.started)return!1;return!0},touchend:function(a){return this.started&&!OpenLayers.Event.isMultiTouch(a)?(this.pinching=this.started=!1,this.callback("done",[a,this.start,this.last]),this.last=this.start=null,!1):!0},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.pinching=!1,a=!0);return a},deactivate:function(){var a=
!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.pinching=this.started=!1,this.last=this.start=null,a=!0);return a},getDistance:function(a){var b=a[0];a=a[1];return Math.sqrt(Math.pow(b.olClientX-a.olClientX,2)+Math.pow(b.olClientY-a.olClientY,2))},getPinchData:function(a){a=this.getDistance(a.touches);return{distance:a,delta:this.last.distance-a,scale:a/this.start.distance}},CLASS_NAME:"OpenLayers.Handler.Pinch"});OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new OpenLayers.Control.Navigation,new OpenLayers.Control.ZoomBox])},draw:function(){var a=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);null===this.defaultControl&&(this.defaultControl=this.controls[0]);return a},CLASS_NAME:"OpenLayers.Control.NavToolbar"});OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,{force:!1,interval:0,timer:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&&(!0===this.layer.visibility&&this.start(),this.layer.events.on({visibilitychanged:this.reset,scope:this}));return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&(this.stop(),this.layer.events.un({visibilitychanged:this.reset,scope:this}));return a},reset:function(){!0===this.layer.visibility?
this.start():this.stop()},start:function(){this.interval&&("number"===typeof this.interval&&0<this.interval)&&(this.timer=window.setInterval(OpenLayers.Function.bind(this.refresh,this),this.interval))},refresh:function(){this.layer&&(this.layer.refresh&&"function"==typeof this.layer.refresh)&&this.layer.refresh({force:this.force})},stop:function(){null!==this.timer&&(window.clearInterval(this.timer),this.timer=null)},CLASS_NAME:"OpenLayers.Strategy.Refresh"});OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{format:"png"},isBaseLayer:!0,initialize:function(a,b,c,d){var e=[];c=OpenLayers.Util.upperCaseObject(c);e.push(a,b,c,d);OpenLayers.Layer.Grid.prototype.initialize.apply(this,e);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()&&(null!=d&&d.isBaseLayer||(this.isBaseLayer=!1),"jpg"==this.params.FORMAT&&
(this.params.FORMAT=OpenLayers.Util.alphaHack()?"gif":"png"))},clone:function(a){null==a&&(a=new OpenLayers.Layer.ArcGIS93Rest(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){a=this.adjustBounds(a);var b=this.projection.getCode().split(":"),b=b[b.length-1],c=this.getImageSize();a={BBOX:a.toBBOX(),SIZE:c.w+","+c.h,F:"image",BBOXSR:b,IMAGESR:b};if(this.layerDefs){var b=[],d;for(d in this.layerDefs)this.layerDefs.hasOwnProperty(d)&&
this.layerDefs[d]&&(b.push(d),b.push(":"),b.push(this.layerDefs[d]),b.push(";"));0<b.length&&(a.LAYERDEFS=b.join(""))}return this.getFullRequestString(a)},setLayerFilter:function(a,b){this.layerDefs||(this.layerDefs={});b?this.layerDefs[a]=b:delete this.layerDefs[a]},clearLayerFilter:function(a){a?delete this.layerDefs[a]:delete this.layerDefs},mergeNewParams:function(a){a=[OpenLayers.Util.upperCaseObject(a)];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},CLASS_NAME:"OpenLayers.Layer.ArcGIS93Rest"});OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:!1,px:null,timerId:null,mousemove:function(a){this.passesTolerance(a.xy)&&(this.clearTimer(),this.callback("move",[a]),this.px=a.xy,a=OpenLayers.Util.extend({},a),this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay));return!this.stopMove},mouseout:function(a){OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv)&&(this.clearTimer(),this.callback("move",[a]));return!0},
passesTolerance:function(a){var b=!0;this.pixelTolerance&&this.px&&Math.sqrt(Math.pow(this.px.x-a.x,2)+Math.pow(this.px.y-a.y,2))<this.pixelTolerance&&(b=!1);return b},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null)},delayedCall:function(a){this.callback("pause",[a])},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),a=!0);return a},CLASS_NAME:"OpenLayers.Handler.Hover"});OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:!1,click:!0,single:!0,clickout:!0,toggle:!1,clickTolerance:5,hover:!1,box:!1,maxFeatures:10,features:null,hoverFeature:null,handlers:null,hoverResponse:null,filterType:OpenLayers.Filter.Spatial.BBOX,initialize:function(a){a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.features={};this.handlers={};this.click&&(this.handlers.click=
new OpenLayers.Handler.Click(this,{click:this.selectClick},this.handlerOptions.click||{}));this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:"olHandlerBoxSelectFeature"})));this.hover&&(this.handlers.hover=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{delay:250,pixelTolerance:2})))},activate:function(){if(!this.active)for(var a in this.handlers)this.handlers[a].activate();
return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active)for(var a in this.handlers)this.handlers[a].deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},selectClick:function(a){var b=this.pixelToBounds(a.xy);this.setModifiers(a);this.request(b,{single:this.single})},selectBox:function(a){var b;if(a instanceof OpenLayers.Bounds)b=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),a=this.map.getLonLatFromPixel({x:a.right,
y:a.top}),b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat);else{if(this.click)return;b=this.pixelToBounds(a)}this.setModifiers(this.handlers.box.dragHandler.evt);this.request(b)},selectHover:function(a){a=this.pixelToBounds(a.xy);this.request(a,{single:!0,hover:!0})},cancelHover:function(){this.hoverResponse&&(this.protocol.abort(this.hoverResponse),this.hoverResponse=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"))},request:function(a,b){b=b||{};var c=new OpenLayers.Filter.Spatial({type:this.filterType,
value:a});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");c=this.protocol.read({maxFeatures:!0==b.single?this.maxFeatures:void 0,filter:c,callback:function(c){c.success()&&(c.features.length?!0==b.single?this.selectBestFeature(c.features,a.getCenterLonLat(),b):this.select(c.features):b.hover?this.hoverSelect():(this.events.triggerEvent("clickout"),this.clickout&&this.unselectAll()));OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},scope:this});!0==b.hover&&(this.hoverResponse=
c)},selectBestFeature:function(a,b,c){c=c||{};if(a.length){b=new OpenLayers.Geometry.Point(b.lon,b.lat);for(var d,e,f,g=Number.MAX_VALUE,h=0;h<a.length&&!(d=a[h],d.geometry&&(f=b.distanceTo(d.geometry,{edge:!1}),f<g&&(g=f,e=d,0==g)));++h);!0==c.hover?this.hoverSelect(e):this.select(e||a)}},setModifiers:function(a){this.modifiers={multiple:this.multiple||this.multipleKey&&a[this.multipleKey],toggle:this.toggle||this.toggleKey&&a[this.toggleKey]}},select:function(a){this.modifiers.multiple||this.modifiers.toggle||
this.unselectAll();OpenLayers.Util.isArray(a)||(a=[a]);var b=this.events.triggerEvent("beforefeaturesselected",{features:a});if(!1!==b){for(var c=[],d,e=0,f=a.length;e<f;++e)d=a[e],this.features[d.fid||d.id]?this.modifiers.toggle&&this.unselect(this.features[d.fid||d.id]):(b=this.events.triggerEvent("beforefeatureselected",{feature:d}),!1!==b&&(this.features[d.fid||d.id]=d,c.push(d),this.events.triggerEvent("featureselected",{feature:d})));this.events.triggerEvent("featuresselected",{features:c})}},
hoverSelect:function(a){var b=a?a.fid||a.id:null,c=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;c&&c!=b&&(this.events.triggerEvent("outfeature",{feature:this.hoverFeature}),this.hoverFeature=null);b&&b!=c&&(this.events.triggerEvent("hoverfeature",{feature:a}),this.hoverFeature=a)},unselect:function(a){delete this.features[a.fid||a.id];this.events.triggerEvent("featureunselected",{feature:a})},unselectAll:function(){for(var a in this.features)this.unselect(this.features[a])},
setMap:function(a){for(var b in this.handlers)this.handlers[b].setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},pixelToBounds:function(a){var b=a.add(-this.clickTolerance/2,this.clickTolerance/2);a=a.add(this.clickTolerance/2,-this.clickTolerance/2);b=this.map.getLonLatFromPixel(b);a=this.map.getLonLatFromPixel(a);return new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat)},CLASS_NAME:"OpenLayers.Control.GetFeature"});OpenLayers.Format.QueryStringFilter=function(){function a(a){a=a.replace(/%/g,"\\%");a=a.replace(/\\\\\.(\*)?/g,function(a,b){return b?a:"\\\\_"});a=a.replace(/\\\\\.\*/g,"\\\\%");a=a.replace(/(\\)?\.(\*)?/g,function(a,b,c){return b||c?a:"_"});a=a.replace(/(\\)?\.\*/g,function(a,b){return b?a:"%"});a=a.replace(/\\\./g,".");return a=a.replace(/(\\)?\\\*/g,function(a,b){return b?a:"*"})}var b={};b[OpenLayers.Filter.Comparison.EQUAL_TO]="eq";b[OpenLayers.Filter.Comparison.NOT_EQUAL_TO]="ne";b[OpenLayers.Filter.Comparison.LESS_THAN]=
"lt";b[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]="lte";b[OpenLayers.Filter.Comparison.GREATER_THAN]="gt";b[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]="gte";b[OpenLayers.Filter.Comparison.LIKE]="ilike";return OpenLayers.Class(OpenLayers.Format,{wildcarded:!1,srsInBBOX:!1,write:function(c,d){d=d||{};var e=c.CLASS_NAME,e=e.substring(e.lastIndexOf(".")+1);switch(e){case "Spatial":switch(c.type){case OpenLayers.Filter.Spatial.BBOX:d.bbox=c.value.toArray();this.srsInBBOX&&c.projection&&
d.bbox.push(c.projection.getCode());break;case OpenLayers.Filter.Spatial.DWITHIN:d.tolerance=c.distance;case OpenLayers.Filter.Spatial.WITHIN:d.lon=c.value.x;d.lat=c.value.y;break;default:OpenLayers.Console.warn("Unknown spatial filter type "+c.type)}break;case "Comparison":e=b[c.type];if(void 0!==e){var f=c.value;c.type==OpenLayers.Filter.Comparison.LIKE&&(f=a(f),this.wildcarded&&(f="%"+f+"%"));d[c.property+"__"+e]=f;d.queryable=d.queryable||[];d.queryable.push(c.property)}else OpenLayers.Console.warn("Unknown comparison filter type "+
c.type);break;case "Logical":if(c.type===OpenLayers.Filter.Logical.AND)for(e=0,f=c.filters.length;e<f;e++)d=this.write(c.filters[e],d);else OpenLayers.Console.warn("Unsupported logical filter type "+c.type);break;default:OpenLayers.Console.warn("Unknown filter type "+e)}return d},CLASS_NAME:"OpenLayers.Format.QueryStringFilter"})}();OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.events.register("mousemove",this,this.redraw),this.map.events.register("mouseout",this,this.reset),
this.redraw(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.map.events.unregister("mousemove",this,this.redraw),this.map.events.unregister("mouseout",this,this.reset),this.element.innerHTML="",!0):!1},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.element||(this.div.left="",this.div.top="",this.element=this.div);return this.div},redraw:function(a){var b;if(null==a)this.reset();else if(null==this.lastXy||Math.abs(a.xy.x-
this.lastXy.x)>this.granularity||Math.abs(a.xy.y-this.lastXy.y)>this.granularity)this.lastXy=a.xy;else if(b=this.map.getLonLatFromPixel(a.xy))this.displayProjection&&b.transform(this.map.getProjectionObject(),this.displayProjection),this.lastXy=a.xy,a=this.formatOutput(b),a!=this.element.innerHTML&&(this.element.innerHTML=a)},reset:function(a){null!=this.emptyString&&(this.element.innerHTML=this.emptyString)},formatOutput:function(a){var b=parseInt(this.numDigits);return this.prefix+a.lon.toFixed(b)+
this.separator+a.lat.toFixed(b)+this.suffix},CLASS_NAME:"OpenLayers.Control.MousePosition"});OpenLayers.Control.Geolocate=OpenLayers.Class(OpenLayers.Control,{geolocation:null,available:"geolocation"in navigator,bind:!0,watch:!1,geolocationOptions:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.available&&!this.geolocation&&(this.geolocation=navigator.geolocation);return this.geolocation?OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.watch?this.watchId=this.geolocation.watchPosition(OpenLayers.Function.bind(this.geolocate,
this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions):this.getCurrentLocation(),!0):!1:(this.events.triggerEvent("locationuncapable"),!1)},deactivate:function(){this.active&&null!==this.watchId&&this.geolocation.clearWatch(this.watchId);return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(a){var b=(new OpenLayers.LonLat(a.coords.longitude,a.coords.latitude)).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());this.bind&&
this.map.setCenter(b);this.events.triggerEvent("locationupdated",{position:a,point:new OpenLayers.Geometry.Point(b.lon,b.lat)})},getCurrentLocation:function(){if(!this.active||this.watch)return!1;this.geolocation.getCurrentPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions);return!0},failure:function(a){this.events.triggerEvent("locationfailed",{error:a})},CLASS_NAME:"OpenLayers.Control.Geolocate"});OpenLayers.Tile.UTFGrid=OpenLayers.Class(OpenLayers.Tile,{url:null,utfgridResolution:2,json:null,format:null,destroy:function(){this.clear();OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(a)if(this.isLoading?(this.abortLoading(),this.events.triggerEvent("reload")):(this.isLoading=!0,this.events.triggerEvent("loadstart")),this.url=this.layer.getURL(this.bounds),this.layer.useJSONP){var b=new OpenLayers.Protocol.Script({url:this.url,
callback:function(a){this.isLoading=!1;this.events.triggerEvent("loadend");this.json=a.data},scope:this});b.read();this.request=b}else this.request=OpenLayers.Request.GET({url:this.url,callback:function(a){this.isLoading=!1;this.events.triggerEvent("loadend");200===a.status&&this.parseData(a.responseText)},scope:this});else this.unload();return a},abortLoading:function(){this.request&&(this.request.abort(),delete this.request);this.isLoading=!1},getFeatureInfo:function(a,b){var c=null;if(this.json){var d=
this.getFeatureId(a,b);null!==d&&(c={id:d,data:this.json.data[d]})}return c},getFeatureId:function(a,b){var c=null;if(this.json){var d=this.utfgridResolution,d=this.json.grid[Math.floor(b/d)].charCodeAt(Math.floor(a/d)),d=this.indexFromCharCode(d),e=this.json.keys;!isNaN(d)&&d in e&&(c=e[d])}return c},indexFromCharCode:function(a){93<=a&&a--;35<=a&&a--;return a-32},parseData:function(a){this.format||(this.format=new OpenLayers.Format.JSON);this.json=this.format.read(a)},clear:function(){this.json=
null},CLASS_NAME:"OpenLayers.Tile.UTFGrid"});OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.headers={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var b=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=
function(a,d){return b.write(a,d)}}},destroy:function(){this.headers=this.params=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=a||{};a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);a=OpenLayers.Util.applyDefaults(a,this.options);a.filter&&this.filterToParams&&(a.params=this.filterToParams(a.filter,a.params));var b=void 0!==a.readWithPOST?a.readWithPOST:this.readWithPOST,c=new OpenLayers.Protocol.Response({requestType:"read"});
b?(b=a.headers||{},b["Content-Type"]="application/x-www-form-urlencoded",c.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,c,a),data:OpenLayers.Util.getParameterString(a.params),headers:b})):c.priv=OpenLayers.Request.GET({url:a.url,callback:this.createCallback(this.handleRead,c,a),params:a.params,headers:a.headers});return c},handleRead:function(a,b){this.handleResponse(a,b)},create:function(a,b){b=OpenLayers.Util.applyDefaults(b,this.options);var c=new OpenLayers.Protocol.Response({reqFeatures:a,
requestType:"create"});c.priv=OpenLayers.Request.POST({url:b.url,callback:this.createCallback(this.handleCreate,c,b),headers:b.headers,data:this.format.write(a)});return c},handleCreate:function(a,b){this.handleResponse(a,b)},update:function(a,b){b=b||{};var c=b.url||a.url||this.options.url+"/"+a.fid;b=OpenLayers.Util.applyDefaults(b,this.options);var d=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"update"});d.priv=OpenLayers.Request[this.updateWithPOST?"POST":"PUT"]({url:c,callback:this.createCallback(this.handleUpdate,
d,b),headers:b.headers,data:this.format.write(a)});return d},handleUpdate:function(a,b){this.handleResponse(a,b)},"delete":function(a,b){b=b||{};var c=b.url||a.url||this.options.url+"/"+a.fid;b=OpenLayers.Util.applyDefaults(b,this.options);var d=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"delete"}),e=this.deleteWithPOST?"POST":"DELETE",c={url:c,callback:this.createCallback(this.handleDelete,d,b),headers:b.headers};this.deleteWithPOST&&(c.data=this.format.write(a));d.priv=OpenLayers.Request[e](c);
return d},handleDelete:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){var c=a.priv;b.callback&&(200<=c.status&&300>c.status?("delete"!=a.requestType&&(a.features=this.parseFeatures(c)),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,b.callback.call(b.scope,a))},parseFeatures:function(a){var b=a.responseXML;b&&b.documentElement||(b=a.responseText);return!b||0>=b.length?null:this.format.read(b)},commit:function(a,b){function c(a){for(var b=
a.features?a.features.length:0,c=Array(b),e=0;e<b;++e)c[e]=a.features[e].fid;r.insertIds=c;d.apply(this,[a])}function d(a){this.callUserCallback(a,b);q=q&&a.success();f++;f>=p&&b.callback&&(r.code=q?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,b.callback.apply(b.scope,[r]))}b=OpenLayers.Util.applyDefaults(b,this.options);var e=[],f=0,g={};g[OpenLayers.State.INSERT]=[];g[OpenLayers.State.UPDATE]=[];g[OpenLayers.State.DELETE]=[];for(var h,k,l=[],m=0,n=a.length;m<n;++m)if(h=
a[m],k=g[h.state])k.push(h),l.push(h);var p=(0<g[OpenLayers.State.INSERT].length?1:0)+g[OpenLayers.State.UPDATE].length+g[OpenLayers.State.DELETE].length,q=!0,r=new OpenLayers.Protocol.Response({reqFeatures:l});h=g[OpenLayers.State.INSERT];0<h.length&&e.push(this.create(h,OpenLayers.Util.applyDefaults({callback:c,scope:this},b.create)));h=g[OpenLayers.State.UPDATE];for(m=h.length-1;0<=m;--m)e.push(this.update(h[m],OpenLayers.Util.applyDefaults({callback:d,scope:this},b.update)));h=g[OpenLayers.State.DELETE];
for(m=h.length-1;0<=m;--m)e.push(this["delete"](h[m],OpenLayers.Util.applyDefaults({callback:d,scope:this},b["delete"])));return e},abort:function(a){a&&a.priv.abort()},callUserCallback:function(a,b){var c=b[a.requestType];c&&c.callback&&c.callback.call(c.scope,a)},CLASS_NAME:"OpenLayers.Protocol.HTTP"});OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:!1,resolution:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,featuresremoved:this.clearCache,moveend:this.cluster,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,
featuresremoved:this.clearCache,moveend:this.cluster,scope:this}));return a},cacheFeatures:function(a){var b=!0;this.clustering||(this.clearCache(),this.features=a.features,this.cluster(),b=!1);return b},clearCache:function(){this.clustering||(this.features=null)},cluster:function(a){if((!a||a.zoomChanged)&&this.features&&(a=this.layer.map.getResolution(),a!=this.resolution||!this.clustersExist())){this.resolution=a;a=[];for(var b,c,d,e=0;e<this.features.length;++e)if(b=this.features[e],b.geometry){c=
!1;for(var f=a.length-1;0<=f;--f)if(d=a[f],this.shouldCluster(d,b)){this.addToCluster(d,b);c=!0;break}c||a.push(this.createCluster(this.features[e]))}this.clustering=!0;this.layer.removeAllFeatures();this.clustering=!1;if(0<a.length){if(1<this.threshold)for(b=a.slice(),a=[],e=0,d=b.length;e<d;++e)c=b[e],c.attributes.count<this.threshold?Array.prototype.push.apply(a,c.cluster):a.push(c);this.clustering=!0;this.layer.addFeatures(a);this.clustering=!1}this.clusters=a}},clustersExist:function(){var a=
!1;if(this.clusters&&0<this.clusters.length&&this.clusters.length==this.layer.features.length)for(var a=!0,b=0;b<this.clusters.length;++b)if(this.clusters[b]!=this.layer.features[b]){a=!1;break}return a},shouldCluster:function(a,b){var c=a.geometry.getBounds().getCenterLonLat(),d=b.geometry.getBounds().getCenterLonLat();return Math.sqrt(Math.pow(c.lon-d.lon,2)+Math.pow(c.lat-d.lat,2))/this.resolution<=this.distance},addToCluster:function(a,b){a.cluster.push(b);a.attributes.count+=1},createCluster:function(a){var b=
a.geometry.getBounds().getCenterLonLat(),b=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat),{count:1});b.cluster=[a];return b},CLASS_NAME:"OpenLayers.Strategy.Cluster"});OpenLayers.Strategy.Filter=OpenLayers.Class(OpenLayers.Strategy,{filter:null,cache:null,caching:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.apply(this,arguments);a&&(this.cache=[],this.layer.events.on({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this}));return a},deactivate:function(){this.cache=null;this.layer&&this.layer.events&&this.layer.events.un({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this});
return OpenLayers.Strategy.prototype.deactivate.apply(this,arguments)},handleAdd:function(a){if(!this.caching&&this.filter){var b=a.features;a.features=[];for(var c,d=0,e=b.length;d<e;++d)c=b[d],this.filter.evaluate(c)?a.features.push(c):this.cache.push(c)}},handleRemove:function(a){this.caching||(this.cache=[])},setFilter:function(a){this.filter=a;a=this.cache;this.cache=[];this.handleAdd({features:this.layer.features});0<this.cache.length&&(this.caching=!0,this.layer.removeFeatures(this.cache.slice()),
this.caching=!1);0<a.length&&(a={features:a},this.handleAdd(a),0<a.features.length&&(this.caching=!0,this.layer.addFeatures(a.features),this.caching=!1))},CLASS_NAME:"OpenLayers.Strategy.Filter"});OpenLayers.Protocol.SOS=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.SOS.DEFAULTS);var b=OpenLayers.Protocol.SOS["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported SOS version: "+a.version;return new b(a)};OpenLayers.Protocol.SOS.DEFAULTS={version:"1.0.0"};OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g},namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},readers:{xsd:{schema:function(a,b){var c=[],d={},e,f;this.readChildNodes(a,{complexTypes:c,customTypes:d});var g=a.attributes,h,k;e=0;for(f=g.length;e<f;++e)h=g[e],k=h.name,0===k.indexOf("xmlns")?this.setNamespace(k.split(":")[1]||"",h.value):b[k]=h.value;b.featureTypes=c;b.targetPrefix=this.namespaceAlias[b.targetNamespace];e=0;for(f=
c.length;e<f;++e)g=c[e],h=d[g.typeName],d[g.typeName]&&(g.typeName=h.name)},complexType:function(a,b){var c={typeName:a.getAttribute("name")};this.readChildNodes(a,c);b.complexTypes.push(c)},complexContent:function(a,b){this.readChildNodes(a,b)},extension:function(a,b){this.readChildNodes(a,b)},sequence:function(a,b){var c={elements:[]};this.readChildNodes(a,c);b.properties=c.elements},element:function(a,b){var c;if(b.elements){var d={};c=a.attributes;for(var e,f=0,g=c.length;f<g;++f)e=c[f],d[e.name]=
e.value;c=d.type;c||(c={},this.readChildNodes(a,c),d.restriction=c,d.type=c.base);d.localType=(c.base||c).split(":").pop();b.elements.push(d);this.readChildNodes(a,d)}b.complexTypes&&(c=a.getAttribute("type"),d=c.split(":").pop(),b.customTypes[d]={name:a.getAttribute("name"),type:c})},annotation:function(a,b){b.annotation={};this.readChildNodes(a,b.annotation)},appinfo:function(a,b){b.appinfo||(b.appinfo=[]);b.appinfo.push(this.getChildValue(a))},documentation:function(a,b){b.documentation||(b.documentation=
[]);var c=this.getChildValue(a);b.documentation.push({lang:a.getAttribute("xml:lang"),textContent:c.replace(this.regExes.trimSpace,"")})},simpleType:function(a,b){this.readChildNodes(a,b)},restriction:function(a,b){b.base=a.getAttribute("base");this.readRestriction(a,b)}}},readRestriction:function(a,b){for(var c=a.childNodes,d,e,f=0,g=c.length;f<g;++f)d=c[f],1==d.nodeType&&(e=d.nodeName.split(":").pop(),d=d.getAttribute("value"),b[e]?("string"==typeof b[e]&&(b[e]=[b[e]]),b[e].push(d)):b[e]=d)},read:function(a){"string"==
typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};if("ExceptionReport"===a.nodeName.split(":").pop()){var c=new OpenLayers.Format.OGCExceptionReport;b.error=c.read(a)}else this.readNode(a,b);return b},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"});OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:!1,createGeometryFromItem:function(a){var b=this.getElementsByTagNameNS(a,this.georssns,"point"),c=this.getElementsByTagNameNS(a,this.geons,"lat"),d=this.getElementsByTagNameNS(a,
this.geons,"long"),e=this.getElementsByTagNameNS(a,this.georssns,"line"),f=this.getElementsByTagNameNS(a,this.georssns,"polygon"),g=this.getElementsByTagNameNS(a,this.georssns,"where");a=this.getElementsByTagNameNS(a,this.georssns,"box");if(0<b.length||0<c.length&&0<d.length){0<b.length?(c=OpenLayers.String.trim(b[0].firstChild.nodeValue).split(/\s+/),2!=c.length&&(c=OpenLayers.String.trim(b[0].firstChild.nodeValue).split(/\s*,\s*/))):c=[parseFloat(c[0].firstChild.nodeValue),parseFloat(d[0].firstChild.nodeValue)];
var h=new OpenLayers.Geometry.Point(c[1],c[0])}else if(0<e.length){c=OpenLayers.String.trim(this.getChildValue(e[0])).split(/\s+/);d=[];e=0;for(f=c.length;e<f;e+=2)b=new OpenLayers.Geometry.Point(c[e+1],c[e]),d.push(b);h=new OpenLayers.Geometry.LineString(d)}else if(0<f.length){c=OpenLayers.String.trim(this.getChildValue(f[0])).split(/\s+/);d=[];e=0;for(f=c.length;e<f;e+=2)b=new OpenLayers.Geometry.Point(c[e+1],c[e]),d.push(b);h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)])}else 0<
g.length?(this.gmlParser||(this.gmlParser=new OpenLayers.Format.GML({xy:this.xy})),h=this.gmlParser.parseFeature(g[0]).geometry):0<a.length&&(c=OpenLayers.String.trim(a[0].firstChild.nodeValue).split(/\s+/),d=[],3<c.length&&(b=new OpenLayers.Geometry.Point(c[1],c[0]),d.push(b),b=new OpenLayers.Geometry.Point(c[1],c[2]),d.push(b),b=new OpenLayers.Geometry.Point(c[3],c[2]),d.push(b),b=new OpenLayers.Geometry.Point(c[3],c[0]),d.push(b),b=new OpenLayers.Geometry.Point(c[1],c[0]),d.push(b)),h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)]));
h&&(this.internalProjection&&this.externalProjection)&&h.transform(this.externalProjection,this.internalProjection);return h},createFeatureFromItem:function(a){var b=this.createGeometryFromItem(a),c=this._getChildValue(a,"*","title",this.featureTitle),d=this._getChildValue(a,"*","description",this._getChildValue(a,"*","content",this._getChildValue(a,"*","summary",this.featureDescription))),e=this._getChildValue(a,"*","link");if(!e)try{e=this.getElementsByTagNameNS(a,"*","link")[0].getAttribute("href")}catch(f){e=
null}a=this._getChildValue(a,"*","id",null);b=new OpenLayers.Feature.Vector(b,{title:c,description:d,link:e});b.fid=a;return b},_getChildValue:function(a,b,c,d){return(a=this.getElementsByTagNameNS(a,b,c))&&a[0]&&a[0].firstChild&&a[0].firstChild.nodeValue?this.getChildValue(a[0]):void 0==d?"":d},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=null,b=this.getElementsByTagNameNS(a,"*","item");0==b.length&&(b=this.getElementsByTagNameNS(a,"*","entry"));
a=b.length;for(var c=Array(a),d=0;d<a;d++)c[d]=this.createFeatureFromItem(b[d]);return c},write:function(a){var b;if(OpenLayers.Util.isArray(a)){b=this.createElementNS(this.rssns,"rss");for(var c=0,d=a.length;c<d;c++)b.appendChild(this.createFeatureXML(a[c]))}else b=this.createFeatureXML(a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.rssns,"item"),d=this.createElementNS(this.rssns,"title");
d.appendChild(this.createTextNode(a.attributes.title?a.attributes.title:""));var e=this.createElementNS(this.rssns,"description");e.appendChild(this.createTextNode(a.attributes.description?a.attributes.description:""));c.appendChild(d);c.appendChild(e);a.attributes.link&&(d=this.createElementNS(this.rssns,"link"),d.appendChild(this.createTextNode(a.attributes.link)),c.appendChild(d));for(var f in a.attributes)"link"!=f&&("title"!=f&&"description"!=f)&&(d=this.createTextNode(a.attributes[f]),e=f,-1!=
f.search(":")&&(e=f.split(":")[1]),e=this.createElementNS(this.featureNS,"feature:"+e),e.appendChild(d),c.appendChild(e));c.appendChild(b);return c},buildGeometryNode:function(a){this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b;if("OpenLayers.Geometry.Polygon"==a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:polygon"),b.appendChild(this.buildCoordinatesNode(a.components[0]));else if("OpenLayers.Geometry.LineString"==
a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:line"),b.appendChild(this.buildCoordinatesNode(a));else if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:point"),b.appendChild(this.buildCoordinatesNode(a));else throw"Couldn't parse "+a.CLASS_NAME;return b},buildCoordinatesNode:function(a){var b=null;a.components&&(b=a.components);if(b){a=b.length;for(var c=Array(a),d=0;d<a;d++)c[d]=b[d].y+" "+b[d].x;b=c.join(" ")}else b=a.y+" "+a.x;return this.createTextNode(b)},
CLASS_NAME:"OpenLayers.Format.GeoRSS"});OpenLayers.Format.WPSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.WPSCapabilities"});OpenLayers.Format.WPSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wps:"http://www.opengis.net/wps/1.0.0",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);
var b={};this.readNode(a,b);return b},readers:{wps:{Capabilities:function(a,b){this.readChildNodes(a,b)},ProcessOfferings:function(a,b){b.processOfferings={};this.readChildNodes(a,b.processOfferings)},Process:function(a,b){var c={processVersion:this.getAttributeNS(a,this.namespaces.wps,"processVersion")};this.readChildNodes(a,c);b[c.identifier]=c},Languages:function(a,b){b.languages=[];this.readChildNodes(a,b.languages)},Default:function(a,b){var c={isDefault:!0};this.readChildNodes(a,c);b.push(c)},
Supported:function(a,b){var c={};this.readChildNodes(a,c);b.push(c)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSCapabilities.v1_0_0"});OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,pinchOrigin:null,currentCenter:null,autoActivate:!0,preserveCenter:!1,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.handler=new OpenLayers.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},pinchStart:function(a,b){var c=this.preserveCenter?this.map.getPixelFromLonLat(this.map.getCenter()):a.xy;this.currentCenter=
this.pinchOrigin=c},pinchMove:function(a,b){var c=b.scale,d=this.map.layerContainerOriginPx,e=this.pinchOrigin,f=this.preserveCenter?this.map.getPixelFromLonLat(this.map.getCenter()):a.xy,g=Math.round(d.x+f.x-e.x+(c-1)*(d.x-e.x)),d=Math.round(d.y+f.y-e.y+(c-1)*(d.y-e.y));this.map.applyTransform(g,d,c);this.currentCenter=f},pinchDone:function(a,b,c){this.map.applyTransform();a=this.map.getZoomForResolution(this.map.getResolution()/c.scale,!0);if(a!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){b=
this.map.getResolutionForZoom(a);c=this.map.getLonLatFromPixel(this.pinchOrigin);var d=this.currentCenter,e=this.map.getSize();c.lon+=b*(e.w/2-d.x);c.lat-=b*(e.h/2-d.y);this.map.div.clientWidth=this.map.div.clientWidth;this.map.setCenter(c,a)}},CLASS_NAME:"OpenLayers.Control.PinchZoom"});OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:!1,autoActivate:!0,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;this.pinchZoom&&(this.pinchZoom.destroy(),delete this.pinchZoom);OpenLayers.Control.prototype.destroy.apply(this,
arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.dragPan.activate(),this.handlers.click.activate(),this.pinchZoom.activate(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.dragPan.deactivate(),this.handlers.click.deactivate(),this.pinchZoom.deactivate(),!0):!1},draw:function(){var a={click:this.defaultClick,dblclick:this.defaultDblClick},b=OpenLayers.Util.extend({"double":!0,stopDouble:!0,
pixelTolerance:2},this.clickHandlerOptions);this.handlers.click=new OpenLayers.Handler.Click(this,a,b);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.dragPan.draw();this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(a){a.lastTouches&&2==a.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(a){this.map.zoomTo(this.map.zoom+
1,a.xy)},CLASS_NAME:"OpenLayers.Control.TouchNavigation"});OpenLayers.Console.warn("OpenLayers.Rico is deprecated");OpenLayers.Rico=OpenLayers.Rico||{};
OpenLayers.Rico.Color=OpenLayers.Class({initialize:function(a,b,c){this.rgb={r:a,g:b,b:c}},setRed:function(a){this.rgb.r=a},setGreen:function(a){this.rgb.g=a},setBlue:function(a){this.rgb.b=a},setHue:function(a){var b=this.asHSB();b.h=a;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setSaturation:function(a){var b=this.asHSB();b.s=a;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setBrightness:function(a){var b=this.asHSB();b.b=a;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},
darken:function(a){var b=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,Math.max(b.b-a,0))},brighten:function(a){var b=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,Math.min(b.b+a,1))},blend:function(a){this.rgb.r=Math.floor((this.rgb.r+a.rgb.r)/2);this.rgb.g=Math.floor((this.rgb.g+a.rgb.g)/2);this.rgb.b=Math.floor((this.rgb.b+a.rgb.b)/2)},isBright:function(){this.asHSB();return 0.5<this.asHSB().b},isDark:function(){return!this.isBright()},asRGB:function(){return"rgb("+
this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}});
OpenLayers.Rico.Color.createFromHex=function(a){if(4==a.length){var b=a;a="#";for(var c=1;4>c;c++)a+=b.charAt(c)+b.charAt(c)}0==a.indexOf("#")&&(a=a.substring(1));b=a.substring(0,2);c=a.substring(2,4);a=a.substring(4,6);return new OpenLayers.Rico.Color(parseInt(b,16),parseInt(c,16),parseInt(a,16))};
OpenLayers.Rico.Color.createColorFromBackground=function(a){var b=OpenLayers.Element.getStyle(OpenLayers.Util.getElement(a),"backgroundColor");return"transparent"==b&&a.parentNode?OpenLayers.Rico.Color.createColorFromBackground(a.parentNode):null==b?new OpenLayers.Rico.Color(255,255,255):0==b.indexOf("rgb(")?(a=b.substring(4,b.length-1).split(","),new OpenLayers.Rico.Color(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]))):0==b.indexOf("#")?OpenLayers.Rico.Color.createFromHex(b):new OpenLayers.Rico.Color(255,
255,255)};
OpenLayers.Rico.Color.HSBtoRGB=function(a,b,c){var d=0,e=0,f=0;if(0==b)f=e=d=parseInt(255*c+0.5);else{a=6*(a-Math.floor(a));var g=a-Math.floor(a),h=c*(1-b),k=c*(1-b*g);b=c*(1-b*(1-g));switch(parseInt(a)){case 0:d=255*c+0.5;e=255*b+0.5;f=255*h+0.5;break;case 1:d=255*k+0.5;e=255*c+0.5;f=255*h+0.5;break;case 2:d=255*h+0.5;e=255*c+0.5;f=255*b+0.5;break;case 3:d=255*h+0.5;e=255*k+0.5;f=255*c+0.5;break;case 4:d=255*b+0.5;e=255*h+0.5;f=255*c+0.5;break;case 5:d=255*c+0.5,e=255*h+0.5,f=255*k+0.5}}return{r:parseInt(d),g:parseInt(e),
b:parseInt(f)}};OpenLayers.Rico.Color.RGBtoHSB=function(a,b,c){var d,e=a>b?a:b;c>e&&(e=c);var f=a<b?a:b;c<f&&(f=c);d=0!=e?(e-f)/e:0;if(0==d)a=0;else{var g=(e-a)/(e-f),h=(e-b)/(e-f);c=(e-c)/(e-f);a=(a==e?c-h:b==e?2+g-c:4+h-g)/6;0>a&&(a+=1)}return{h:a,s:d,b:e/255}};OpenLayers.Style2=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,b=this.rules.length;a<b;a++)this.rules[a].destroy();delete this.rules},clone:function(){var a=OpenLayers.Util.extend({},this);if(this.rules){a.rules=[];for(var b=0,c=this.rules.length;b<c;++b)a.rules.push(this.rules[b].clone())}return new OpenLayers.Style2(a)},
CLASS_NAME:"OpenLayers.Style2"});OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:"http://www.opengis.net/wfs",ogcns:"http://www.opengis.net/ogc",initialize:function(a,b){OpenLayers.Format.GML.prototype.initialize.apply(this,[a]);this.layer=b;this.layer.featureNS&&(this.featureNS=this.layer.featureNS);this.layer.options.geometry_column&&(this.geometryName=this.layer.options.geometry_column);this.layer.options.typename&&(this.featureName=this.layer.options.typename)},write:function(a){var b=this.createElementNS(this.wfsns,
"wfs:Transaction");b.setAttribute("version","1.0.0");b.setAttribute("service","WFS");for(var c=0;c<a.length;c++)switch(a[c].state){case OpenLayers.State.INSERT:b.appendChild(this.insert(a[c]));break;case OpenLayers.State.UPDATE:b.appendChild(this.update(a[c]));break;case OpenLayers.State.DELETE:b.appendChild(this.remove(a[c]))}return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.featureNS,"feature:"+
this.geometryName);c.appendChild(b);b=this.createElementNS(this.featureNS,"feature:"+this.featureName);b.appendChild(c);for(var d in a.attributes){var c=this.createTextNode(a.attributes[d]),e=d;-1!=d.search(":")&&(e=d.split(":")[1]);e=this.createElementNS(this.featureNS,"feature:"+e);e.appendChild(c);b.appendChild(e)}return b},insert:function(a){var b=this.createElementNS(this.wfsns,"wfs:Insert");b.appendChild(this.createFeatureXML(a));return b},update:function(a){a.fid||OpenLayers.Console.userError(OpenLayers.i18n("noFID"));
var b=this.createElementNS(this.wfsns,"wfs:Update");b.setAttribute("typeName",this.featurePrefix+":"+this.featureName);b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var c=this.createElementNS(this.wfsns,"wfs:Property"),d=this.createElementNS(this.wfsns,"wfs:Name"),e=this.createTextNode(this.geometryName);d.appendChild(e);c.appendChild(d);d=this.createElementNS(this.wfsns,"wfs:Value");e=this.buildGeometryNode(a.geometry);a.layer&&e.setAttribute("srsName",a.layer.projection.getCode());
d.appendChild(e);c.appendChild(d);b.appendChild(c);for(var f in a.attributes)c=this.createElementNS(this.wfsns,"wfs:Property"),d=this.createElementNS(this.wfsns,"wfs:Name"),d.appendChild(this.createTextNode(f)),c.appendChild(d),d=this.createElementNS(this.wfsns,"wfs:Value"),d.appendChild(this.createTextNode(a.attributes[f])),c.appendChild(d),b.appendChild(c);c=this.createElementNS(this.ogcns,"ogc:Filter");f=this.createElementNS(this.ogcns,"ogc:FeatureId");f.setAttribute("fid",a.fid);c.appendChild(f);
b.appendChild(c);return b},remove:function(a){if(!a.fid)return OpenLayers.Console.userError(OpenLayers.i18n("noFID")),!1;var b=this.createElementNS(this.wfsns,"wfs:Delete");b.setAttribute("typeName",this.featurePrefix+":"+this.featureName);b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var c=this.createElementNS(this.ogcns,"ogc:Filter"),d=this.createElementNS(this.ogcns,"ogc:FeatureId");d.setAttribute("fid",a.fid);c.appendChild(d);b.appendChild(c);return b},destroy:function(){this.layer=
null},CLASS_NAME:"OpenLayers.Format.WFS"});OpenLayers.Format.SLD.v1_0_0_GeoServer=OpenLayers.Class(OpenLayers.Format.SLD.v1_0_0,{version:"1.0.0",profile:"GeoServer",readers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.priority=c)},VendorOption:function(a,b){b.vendorOptions||(b.vendorOptions={});b.vendorOptions[a.getAttribute("name")]=this.getChildValue(a)},TextSymbolizer:function(a,b){OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld.TextSymbolizer.apply(this,
arguments);var c=this.multipleSymbolizers?b.symbolizers[b.symbolizers.length-1]:b.symbolizer.Text;void 0===c.graphic&&(c.graphic=!1)}},OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.readers),writers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Priority",a)},VendorOption:function(a){return this.createElementNSPlus("sld:VendorOption",{attributes:{name:a.name},
value:a.value})},TextSymbolizer:function(a){var b=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.TextSymbolizer.apply(this,arguments);!1!==a.graphic&&(a.externalGraphic||a.graphicName)&&this.writeNode("Graphic",a,b);"priority"in a&&this.writeNode("Priority",a.priority,b);return this.addVendorOptions(b,a)},PointSymbolizer:function(a){var b=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PointSymbolizer.apply(this,arguments);return this.addVendorOptions(b,a)},LineSymbolizer:function(a){var b=
OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.LineSymbolizer.apply(this,arguments);return this.addVendorOptions(b,a)},PolygonSymbolizer:function(a){var b=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PolygonSymbolizer.apply(this,arguments);return this.addVendorOptions(b,a)}},OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.writers),addVendorOptions:function(a,b){if(b.vendorOptions)for(var c in b.vendorOptions)this.writeNode("VendorOption",{name:c,
value:b.vendorOptions[c]},a);return a},CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0_GeoServer"});OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,{drawMarker:function(a){var b=this.map.getLayerPxFromLonLat({lon:a.bounds.left,lat:a.bounds.top}),c=this.map.getLayerPxFromLonLat({lon:a.bounds.right,lat:a.bounds.bottom});null==c||null==b?a.display(!1):(b=a.draw(b,{w:Math.max(1,c.x-b.x),h:Math.max(1,c.y-b.y)}),a.drawn||(this.div.appendChild(b),a.drawn=!0))},removeMarker:function(a){OpenLayers.Util.removeItem(this.markers,a);null!=a.div&&a.div.parentNode==this.div&&this.div.removeChild(a.div)},
CLASS_NAME:"OpenLayers.Layer.Boxes"});OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{readers:{wfs:OpenLayers.Util.applyDefaults({Service:function(a,b){b.service={};this.readChildNodes(a,b.service)},Fees:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.fees=c)},AccessConstraints:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.accessConstraints=c)},OnlineResource:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.onlineResource=
c)},Keywords:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.keywords=c.split(", "))},Capability:function(a,b){b.capability={};this.readChildNodes(a,b.capability)},Request:function(a,b){b.request={};this.readChildNodes(a,b.request)},GetFeature:function(a,b){b.getfeature={href:{},formats:[]};this.readChildNodes(a,b.getfeature)},ResultFormat:function(a,b){for(var c=a.childNodes,d,e=0;e<c.length;e++)d=c[e],1==d.nodeType&&b.formats.push(d.nodeName)},DCPType:function(a,b){this.readChildNodes(a,
b)},HTTP:function(a,b){this.readChildNodes(a,b.href)},Get:function(a,b){b.get=a.getAttribute("onlineResource")},Post:function(a,b){b.post=a.getAttribute("onlineResource")},SRS:function(a,b){var c=this.getChildValue(a);c&&(b.srs=c)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs)},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"});OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMS_Capabilities:function(a,b){this.readChildNodes(a,b)},LayerLimit:function(a,b){b.layerLimit=parseInt(this.getChildValue(a))},MaxWidth:function(a,b){b.maxWidth=parseInt(this.getChildValue(a))},MaxHeight:function(a,b){b.maxHeight=parseInt(this.getChildValue(a))},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,
[a,b]);c.srs=a.getAttribute("CRS");b.bbox[c.srs]=c},CRS:function(a,b){this.readers.wms.SRS.apply(this,[a,b])},EX_GeographicBoundingBox:function(a,b){b.llbbox=[];this.readChildNodes(a,b.llbbox)},westBoundLongitude:function(a,b){b[0]=this.getChildValue(a)},eastBoundLongitude:function(a,b){b[2]=this.getChildValue(a)},southBoundLatitude:function(a,b){b[1]=this.getChildValue(a)},northBoundLatitude:function(a,b){b[3]=this.getChildValue(a)},MinScaleDenominator:function(a,b){b.maxScale=parseFloat(this.getChildValue(a)).toPrecision(16)},
MaxScaleDenominator:function(a,b){b.minScale=parseFloat(this.getChildValue(a)).toPrecision(16)},Dimension:function(a,b){var c={name:a.getAttribute("name").toLowerCase(),units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol"),nearestVal:"1"===a.getAttribute("nearestValue"),multipleVal:"1"===a.getAttribute("multipleValues"),"default":a.getAttribute("default")||"",current:"1"===a.getAttribute("current"),values:this.getChildValue(a).split(",")};b.dimensions[c.name]=c},Keyword:function(a,
b){var c={value:this.getChildValue(a),vocabulary:a.getAttribute("vocabulary")};b.keywords&&b.keywords.push(c)}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms),sld:{UserDefinedSymbolization:function(a,b){this.readers.wms.UserDefinedSymbolization.apply(this,[a,b]);b.userSymbols.inlineFeature=1==parseInt(a.getAttribute("InlineFeature"));b.userSymbols.remoteWCS=1==parseInt(a.getAttribute("RemoteWCS"))},DescribeLayer:function(a,b){this.readers.wms.DescribeLayer.apply(this,[a,b])},GetLegendGraphic:function(a,
b){this.readers.wms.GetLegendGraphic.apply(this,[a,b])}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3"});OpenLayers.Layer.Zoomify=OpenLayers.Class(OpenLayers.Layer.Grid,{size:null,isBaseLayer:!0,standardTileSize:256,tileOriginCorner:"tl",numberOfTiers:0,tileCountUpToTier:null,tierSizeInTiles:null,tierImageSize:null,initialize:function(a,b,c,d){this.initializeZoomify(c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,c,{},d])},initializeZoomify:function(a){var b=a.clone();this.size=a.clone();a=new OpenLayers.Size(Math.ceil(b.w/this.standardTileSize),Math.ceil(b.h/this.standardTileSize));this.tierSizeInTiles=
[a];for(this.tierImageSize=[b];b.w>this.standardTileSize||b.h>this.standardTileSize;)b=new OpenLayers.Size(Math.floor(b.w/2),Math.floor(b.h/2)),a=new OpenLayers.Size(Math.ceil(b.w/this.standardTileSize),Math.ceil(b.h/this.standardTileSize)),this.tierSizeInTiles.push(a),this.tierImageSize.push(b);this.tierSizeInTiles.reverse();this.tierImageSize.reverse();this.numberOfTiers=this.tierSizeInTiles.length;b=[1];this.tileCountUpToTier=[0];for(a=1;a<this.numberOfTiers;a++)b.unshift(Math.pow(2,a)),this.tileCountUpToTier.push(this.tierSizeInTiles[a-
1].w*this.tierSizeInTiles[a-1].h+this.tileCountUpToTier[a-1]);this.serverResolutions||(this.serverResolutions=b)},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments);this.tileCountUpToTier.length=0;this.tierSizeInTiles.length=0;this.tierImageSize.length=0},clone:function(a){null==a&&(a=new OpenLayers.Layer.Zoomify(this.name,this.url,this.size,this.options));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){a=this.adjustBounds(a);var b=
this.getServerResolution(),c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w));a=Math.round((this.tileOrigin.lat-a.top)/(b*this.tileSize.h));b=this.getZoomForResolution(b);c="TileGroup"+Math.floor((c+a*this.tierSizeInTiles[b].w+this.tileCountUpToTier[b])/256)+"/"+b+"-"+c+"-"+a+".jpg";b=this.url;OpenLayers.Util.isArray(b)&&(b=this.selectUrl(c,b));return b+c},getImageSize:function(){if(0<arguments.length){var a=this.adjustBounds(arguments[0]),b=this.getServerResolution(),c=Math.round((a.left-
this.tileOrigin.lon)/(b*this.tileSize.w)),a=Math.round((this.tileOrigin.lat-a.top)/(b*this.tileSize.h)),b=this.getZoomForResolution(b),d=this.standardTileSize,e=this.standardTileSize;c==this.tierSizeInTiles[b].w-1&&(d=this.tierImageSize[b].w%this.standardTileSize);a==this.tierSizeInTiles[b].h-1&&(e=this.tierImageSize[b].h%this.standardTileSize);return new OpenLayers.Size(d,e)}return this.tileSize},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,
this.map.maxExtent.top)},CLASS_NAME:"OpenLayers.Layer.Zoomify"});OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:"map",map_imagetype:"png"},initialize:function(a,b,c,d){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS);if(null==d||null==d.isBaseLayer)this.isBaseLayer="true"!=this.params.transparent&&!0!=this.params.transparent},clone:function(a){null==a&&(a=new OpenLayers.Layer.MapServer(this.name,this.url,this.params,this.getOptions()));
return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){a=this.adjustBounds(a);a=[a.left,a.bottom,a.right,a.top];var b=this.getImageSize();return this.getFullRequestString({mapext:a,imgext:a,map_size:[b.w,b.h],imgx:b.w/2,imgy:b.h/2,imgxy:[b.w,b.h]})},getFullRequestString:function(a,b){var c=null==b?this.url:b,d=OpenLayers.Util.extend({},this.params),d=OpenLayers.Util.extend(d,a),e=OpenLayers.Util.getParameterString(d);OpenLayers.Util.isArray(c)&&(c=this.selectUrl(e,c));
var e=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),f;for(f in d)f.toUpperCase()in e&&delete d[f];e=OpenLayers.Util.getParameterString(d);d=c;e=e.replace(/,/g,"+");""!=e&&(f=c.charAt(c.length-1),d="&"==f||"?"==f?d+e:-1==c.indexOf("?")?d+("?"+e):d+("&"+e));return d},CLASS_NAME:"OpenLayers.Layer.MapServer"});OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(a){if(this.supported()){if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);for(var b=document.createStyleSheet(),c="shape rect oval fill stroke imagedata group textbox".split(" "),d=0,e=c.length;d<e;d++)b.addRule("olv\\:"+c[d],"behavior: url(#default#VML); position: absolute; display: inline-block;")}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,
arguments)}},supported:function(){return!!document.namespaces},setExtent:function(a,b){var c=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),d=this.getResolution(),e=a.left/d|0,d=a.top/d-this.size.h|0;b||!this.offset?(this.offset={x:e,y:d},d=e=0):(e-=this.offset.x,d-=this.offset.y);this.root.coordorigin=e-this.xOffset+" "+d;for(var e=[this.root,this.vectorRoot,this.textRoot],f=0,g=e.length;f<g;++f)d=e[f],d.coordsize=this.size.w+" "+this.size.h;this.root.style.flip="y";return c},
setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);for(var b=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],c=this.size.w+"px",d=this.size.h+"px",e,f=0,g=b.length;f<g;++f)e=b[f],e.style.width=c,e.style.height=d},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":c=b.externalGraphic?"olv:rect":this.isComplexSymbol(b.graphicName)?"olv:shape":"olv:oval";break;case "OpenLayers.Geometry.Rectangle":c="olv:rect";break;case "OpenLayers.Geometry.LineString":case "OpenLayers.Geometry.LinearRing":case "OpenLayers.Geometry.Polygon":case "OpenLayers.Geometry.Curve":c=
"olv:shape"}return c},setStyle:function(a,b,c,d){b=b||a._style;c=c||a._options;var e=b.fillColor,f=b.title||b.graphicTitle;f&&(a.title=f);if("OpenLayers.Geometry.Point"===a._geometryClass)if(b.externalGraphic){c.isFilled=!0;var e=b.graphicWidth||b.graphicHeight,f=b.graphicHeight||b.graphicWidth,e=e?e:2*b.pointRadius,f=f?f:2*b.pointRadius,g=this.getResolution(),h=void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*e),k=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*f);a.style.left=((d.x-this.featureDx)/
g-this.offset.x+h|0)+"px";a.style.top=(d.y/g-this.offset.y-(k+f)|0)+"px";a.style.width=e+"px";a.style.height=f+"px";a.style.flip="y";e="none";c.isStroked=!1}else this.isComplexSymbol(b.graphicName)?(f=this.importSymbol(b.graphicName),a.path=f.path,a.coordorigin=f.left+","+f.bottom,f=f.size,a.coordsize=f+","+f,this.drawCircle(a,d,b.pointRadius),a.style.flip="y"):this.drawCircle(a,d,b.pointRadius);c.isFilled?a.fillcolor=e:a.filled="false";d=a.getElementsByTagName("fill");d=0==d.length?null:d[0];c.isFilled?
(d||(d=this.createNode("olv:fill",a.id+"_fill")),d.opacity=b.fillOpacity,"OpenLayers.Geometry.Point"===a._geometryClass&&b.externalGraphic&&(b.graphicOpacity&&(d.opacity=b.graphicOpacity),d.src=b.externalGraphic,d.type="frame",b.graphicWidth&&b.graphicHeight||(d.aspect="atmost")),d.parentNode!=a&&a.appendChild(d)):d&&a.removeChild(d);e=b.rotation;if(void 0!==e||void 0!==a._rotation)a._rotation=e,b.externalGraphic?(this.graphicRotate(a,h,k,b),d.opacity=0):"OpenLayers.Geometry.Point"===a._geometryClass&&
(a.style.rotation=e||0);h=a.getElementsByTagName("stroke");h=0==h.length?null:h[0];c.isStroked?(h||(h=this.createNode("olv:stroke",a.id+"_stroke"),a.appendChild(h)),h.on=!0,h.color=b.strokeColor,h.weight=b.strokeWidth+"px",h.opacity=b.strokeOpacity,h.endcap="butt"==b.strokeLinecap?"flat":b.strokeLinecap||"round",b.strokeDashstyle&&(h.dashstyle=this.dashStyle(b))):(a.stroked=!1,h&&(h.on=!1));"inherit"!=b.cursor&&null!=b.cursor&&(a.style.cursor=b.cursor);return a},graphicRotate:function(a,b,c,d){d=
d||a._style;var e=d.rotation||0,f,g;if(d.graphicWidth&&d.graphicHeight){g=Math.max(d.graphicWidth,d.graphicHeight);f=d.graphicWidth/d.graphicHeight;var h=Math.round(d.graphicWidth||g*f),k=Math.round(d.graphicHeight||g);a.style.width=h+"px";a.style.height=k+"px";var l=document.getElementById(a.id+"_image");l||(l=this.createNode("olv:imagedata",a.id+"_image"),a.appendChild(l));l.style.width=h+"px";l.style.height=k+"px";l.src=d.externalGraphic;l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";
l=e*Math.PI/180;e=Math.sin(l);l=Math.cos(l);e="progid:DXImageTransform.Microsoft.Matrix(M11="+l+",M12="+-e+",M21="+e+",M22="+l+",SizingMethod='auto expand')\n";(l=d.graphicOpacity||d.fillOpacity)&&1!=l&&(e+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+l+")\n");a.style.filter=e;e=new OpenLayers.Geometry.Point(-b,-c);h=(new OpenLayers.Bounds(0,0,h,k)).toGeometry();h.rotate(d.rotation,e);h=h.getBounds();a.style.left=Math.round(parseInt(a.style.left)+h.left)+"px";a.style.top=Math.round(parseInt(a.style.top)-
h.bottom)+"px"}else{var m=new Image;m.onreadystatechange=OpenLayers.Function.bind(function(){if("complete"==m.readyState||"interactive"==m.readyState)f=m.width/m.height,g=Math.max(2*d.pointRadius,d.graphicWidth||0,d.graphicHeight||0),b*=f,d.graphicWidth=g*f,d.graphicHeight=g,this.graphicRotate(a,b,c,d)},this);m.src=d.externalGraphic}},postDraw:function(a){a.style.visibility="visible";var b=a._style.fillColor,c=a._style.strokeColor;"none"==b&&a.fillcolor!=b&&(a.fillcolor=b);"none"==c&&a.strokecolor!=
c&&(a.strokecolor=c)},setNodeDimension:function(a,b){var c=b.getBounds();if(c){var d=this.getResolution(),c=new OpenLayers.Bounds((c.left-this.featureDx)/d-this.offset.x|0,c.bottom/d-this.offset.y|0,(c.right-this.featureDx)/d-this.offset.x|0,c.top/d-this.offset.y|0);a.style.left=c.left+"px";a.style.top=c.top+"px";a.style.width=c.getWidth()+"px";a.style.height=c.getHeight()+"px";a.coordorigin=c.left+" "+c.top;a.coordsize=c.getWidth()+" "+c.getHeight()}},dashStyle:function(a){a=a.strokeDashstyle;switch(a){case "solid":case "dot":case "dash":case "dashdot":case "longdash":case "longdashdot":return a;
default:return a=a.split(/[ ,]/),2==a.length?1*a[0]>=2*a[1]?"longdash":1==a[0]||1==a[1]?"dot":"dash":4==a.length?1*a[0]>=2*a[1]?"longdashdot":"dashdot":"solid"}},createNode:function(a,b){var c=document.createElement(a);b&&(c.id=b);c.unselectable="on";c.onselectstart=OpenLayers.Function.False;return c},nodeTypeCompare:function(a,b){var c=b,d=c.indexOf(":");-1!=d&&(c=c.substr(d+1));var e=a.nodeName,d=e.indexOf(":");-1!=d&&(e=e.substr(d+1));return c==e},createRenderRoot:function(){return this.nodeFactory(this.container.id+
"_vmlRoot","div")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"olv:group")},drawPoint:function(a,b){return this.drawCircle(a,b,1)},drawCircle:function(a,b,c){if(!isNaN(b.x)&&!isNaN(b.y)){var d=this.getResolution();a.style.left=((b.x-this.featureDx)/d-this.offset.x|0)-c+"px";a.style.top=(b.y/d-this.offset.y|0)-c+"px";b=2*c;a.style.width=b+"px";a.style.height=b+"px";return a}return!1},drawLineString:function(a,b){return this.drawLine(a,b,!1)},drawLinearRing:function(a,b){return this.drawLine(a,
b,!0)},drawLine:function(a,b,c){this.setNodeDimension(a,b);for(var d=this.getResolution(),e=b.components.length,f=Array(e),g,h,k=0;k<e;k++)g=b.components[k],h=(g.x-this.featureDx)/d-this.offset.x|0,g=g.y/d-this.offset.y|0,f[k]=" "+h+","+g+" l ";b=c?" x e":" e";a.path="m"+f.join("")+b;return a},drawPolygon:function(a,b){this.setNodeDimension(a,b);var c=this.getResolution(),d=[],e,f,g,h,k,l,m,n,p,q;e=0;for(f=b.components.length;e<f;e++){d.push("m");g=b.components[e].components;h=0===e;l=k=null;m=0;
for(n=g.length;m<n;m++)p=g[m],q=(p.x-this.featureDx)/c-this.offset.x|0,p=p.y/c-this.offset.y|0,q=" "+q+","+p,d.push(q),0==m&&d.push(" l"),h||(k?k!=q&&(l?l!=q&&(h=!0):l=q):k=q);d.push(h?" x ":" ")}d.push("e");a.path=d.join("");return a},drawRectangle:function(a,b){var c=this.getResolution();a.style.left=((b.x-this.featureDx)/c-this.offset.x|0)+"px";a.style.top=(b.y/c-this.offset.y|0)+"px";a.style.width=(b.width/c|0)+"px";a.style.height=(b.height/c|0)+"px";return a},drawText:function(a,b,c){var d=this.nodeFactory(a+
this.LABEL_ID_SUFFIX,"olv:rect"),e=this.nodeFactory(a+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),f=this.getResolution();d.style.left=((c.x-this.featureDx)/f-this.offset.x|0)+"px";d.style.top=(c.y/f-this.offset.y|0)+"px";d.style.flip="y";e.innerText=b.label;"inherit"!=b.cursor&&null!=b.cursor&&(e.style.cursor=b.cursor);b.fontColor&&(e.style.color=b.fontColor);b.fontOpacity&&(e.style.filter="alpha(opacity="+100*b.fontOpacity+")");b.fontFamily&&(e.style.fontFamily=b.fontFamily);b.fontSize&&(e.style.fontSize=
b.fontSize);b.fontWeight&&(e.style.fontWeight=b.fontWeight);b.fontStyle&&(e.style.fontStyle=b.fontStyle);!0===b.labelSelect&&(d._featureId=a,e._featureId=a,e._geometry=c,e._geometryClass=c.CLASS_NAME);e.style.whiteSpace="nowrap";e.inset="1px,0px,0px,0px";d.parentNode||(d.appendChild(e),this.textRoot.appendChild(d));b=b.labelAlign||"cm";1==b.length&&(b+="m");a=e.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[b.substr(0,1)];e=e.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[b.substr(1,1)];d.style.left=
parseInt(d.style.left)-a-1+"px";d.style.top=parseInt(d.style.top)+e+"px"},moveRoot:function(a){var b=this.map.getLayer(a.container.id);b instanceof OpenLayers.Layer.Vector.RootContainer&&(b=this.map.getLayer(this.container.id));b&&b.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);b&&b.redraw()},importSymbol:function(a){var b=this.container.id+"-"+a,c=this.symbolCache[b];if(c)return c;c=OpenLayers.Renderer.symbol[a];if(!c)throw Error(a+" is not a valid symbol name");
a=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);for(var d=["m"],e=0;e<c.length;e+=2){var f=c[e],g=c[e+1];a.left=Math.min(a.left,f);a.bottom=Math.min(a.bottom,g);a.right=Math.max(a.right,f);a.top=Math.max(a.top,g);d.push(f);d.push(g);0==e&&d.push("l")}d.push("x e");c=d.join(" ");d=(a.getWidth()-a.getHeight())/2;0<d?(a.bottom-=d,a.top+=d):(a.left+=d,a.right-=d);c={path:c,size:a.getWidth(),left:a.left,bottom:a.bottom};return this.symbolCache[b]=c},CLASS_NAME:"OpenLayers.Renderer.VML"});
OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:0.5,r:1,t:0,m:0.5,b:1};OpenLayers.Control.CacheRead=OpenLayers.Class(OpenLayers.Control,{fetchEvent:"tileloadstart",layers:null,autoActivate:!0,setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);var b,c=this.layers||a.layers;for(b=c.length-1;0<=b;--b)this.addLayer({layer:c[b]});if(!this.layers)a.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(a){a.layer.events.register(this.fetchEvent,this,this.fetch)},removeLayer:function(a){a.layer.events.unregister(this.fetchEvent,
this,this.fetch)},fetch:function(a){if(this.active&&window.localStorage&&a.tile instanceof OpenLayers.Tile.Image){var b=a.tile,c=b.url;!b.layer.crossOriginKeyword&&(OpenLayers.ProxyHost&&0===c.indexOf(OpenLayers.ProxyHost))&&(c=OpenLayers.Control.CacheWrite.urlMap[c]);if(c=window.localStorage.getItem("olCache_"+c))b.url=c,"tileerror"===a.type&&b.setImgSrc(c)}},destroy:function(){if(this.layers||this.map){var a,b=this.layers||this.map.layers;for(a=b.length-1;0<=a;--a)this.removeLayer({layer:b[a]})}this.map&&
this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheRead"});OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"});OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},gmlFormat:null,read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a.documentElement;if(b){var c=this["read_"+b.nodeName];a=c?c.call(this,b):(new OpenLayers.Format.GML(this.options?this.options:{})).read(a)}return a},read_msGMLOutput:function(a){var b=
[];if(a=this.getSiblingNodesByTagCriteria(a,this.layerIdentifier))for(var c=0,d=a.length;c<d;++c){var e=a[c],f=e.nodeName;e.prefix&&(f=f.split(":")[1]);f=f.replace(this.layerIdentifier,"");if(e=this.getSiblingNodesByTagCriteria(e,this.featureIdentifier))for(var g=0;g<e.length;g++){var h=e[g],k=this.parseGeometry(h),h=this.parseAttributes(h),h=new OpenLayers.Feature.Vector(k.geometry,h,null);h.bounds=k.bounds;h.type=f;b.push(h)}}return b},read_FeatureInfoResponse:function(a){var b=[];a=this.getElementsByTagNameNS(a,
"*","FIELDS");for(var c=0,d=a.length;c<d;c++){var e=a[c],f={},g,h=e.attributes.length;if(0<h)for(g=0;g<h;g++){var k=e.attributes[g];f[k.nodeName]=k.nodeValue}else for(e=e.childNodes,g=0,h=e.length;g<h;++g)k=e[g],3!=k.nodeType&&(f[k.getAttribute("name")]=k.getAttribute("value"));b.push(new OpenLayers.Feature.Vector(null,f,null))}return b},getSiblingNodesByTagCriteria:function(a,b){var c=[],d,e,f,g;if(a&&a.hasChildNodes()){d=a.childNodes;f=d.length;for(var h=0;h<f;h++){for(g=d[h];g&&1!=g.nodeType;)g=
g.nextSibling,h++;e=g?g.nodeName:"";0<e.length&&-1<e.indexOf(b)?c.push(g):(e=this.getSiblingNodesByTagCriteria(g,b),0<e.length&&(0==c.length?c=e:c.push(e)))}}return c},parseAttributes:function(a){var b={};if(1==a.nodeType){a=a.childNodes;for(var c=a.length,d=0;d<c;++d){var e=a[d];if(1==e.nodeType){var f=e.childNodes,e=e.prefix?e.nodeName.split(":")[1]:e.nodeName;0==f.length?b[e]=null:1==f.length&&(f=f[0],3==f.nodeType||4==f.nodeType)&&(f=f.nodeValue.replace(this.regExes.trimSpace,""),b[e]=f)}}}return b},
parseGeometry:function(a){this.gmlFormat||(this.gmlFormat=new OpenLayers.Format.GML);a=this.gmlFormat.parseFeature(a);var b,c=null;a&&(b=a.geometry&&a.geometry.clone(),c=a.bounds&&a.bounds.clone(),a.destroy());return{geometry:b,bounds:c}},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"});OpenLayers.Control.WMTSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,requestEncoding:"KVP",drillDown:!1,maxFeatures:10,clickCallback:"click",layers:null,queryVisible:!0,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handler:null,hoverRequest:null,pending:0,initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions));
!0===this.drillDown&&(this.hover=!1);this.hover?this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250})):(a={},a[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,a,this.handlerOptions.click||{}))},getInfoForClick:function(a){this.request(a.xy,{})},getInfoForHover:function(a){this.request(a.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&&(--this.pending,
0>=this.pending&&(OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),this.pending=0),this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){for(var a=this.layers||this.map.layers,b=[],c,d=a.length-1;0<=d&&(c=a[d],!(c instanceof OpenLayers.Layer.WMTS)||(c.requestEncoding!==this.requestEncoding||this.queryVisible&&!c.getVisibility())||(b.push(c),this.drillDown&&!this.hover));--d);return b},buildRequestOptions:function(a,b){var c=this.map.getLonLatFromPixel(b),d=a.getURL(new OpenLayers.Bounds(c.lon,
c.lat,c.lon,c.lat)),d=OpenLayers.Util.getParameters(d),c=a.getTileInfo(c);OpenLayers.Util.extend(d,{service:"WMTS",version:a.version,request:"GetFeatureInfo",infoFormat:this.infoFormat,i:c.i,j:c.j});OpenLayers.Util.applyDefaults(d,this.vendorParams);return{url:OpenLayers.Util.isArray(a.url)?a.url[0]:a.url,params:OpenLayers.Util.upperCaseObject(d),callback:function(c){this.handleResponse(b,c,a)},scope:this}},request:function(a,b){b=b||{};var c=this.findLayers();if(0<c.length){for(var d,e,f=0,g=c.length;f<
g;f++)e=c[f],d=this.events.triggerEvent("beforegetfeatureinfo",{xy:a,layer:e}),!1!==d&&(++this.pending,d=this.buildRequestOptions(e,a),d=OpenLayers.Request.GET(d),!0===b.hover&&(this.hoverRequest=d));0<this.pending&&OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait")}},handleResponse:function(a,b,c){--this.pending;0>=this.pending&&(OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),this.pending=0);if(b.status&&(200>b.status||300<=b.status))this.events.triggerEvent("exception",
{xy:a,request:b,layer:c});else{var d=b.responseXML;d&&d.documentElement||(d=b.responseText);var e,f;try{e=this.format.read(d)}catch(g){f=!0,this.events.triggerEvent("exception",{xy:a,request:b,error:g,layer:c})}f||this.events.triggerEvent("getfeatureinfo",{text:b.responseText,features:e,request:b,xy:a,layer:c})}},CLASS_NAME:"OpenLayers.Control.WMTSGetFeatureInfo"});OpenLayers.Protocol.CSW.v2_0_2=OpenLayers.Class(OpenLayers.Protocol,{formatOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);a.format||(this.format=new OpenLayers.Format.CSWGetRecords.v2_0_2(OpenLayers.Util.extend({},this.formatOptions)))},destroy:function(){this.options&&!this.options.format&&this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,
this.options||{});var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.format.write(a.params||a);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),params:a.params,headers:a.headers,data:c});return b},handleRead:function(a,b){if(b.callback){var c=a.priv;200<=c.status&&300>c.status?(a.data=this.parseData(c),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE;b.callback.call(b.scope,a)}},parseData:function(a){var b=
a.responseXML;b&&b.documentElement||(b=a.responseText);return!b||0>=b.length?null:this.format.read(b)},CLASS_NAME:"OpenLayers.Protocol.CSW.v2_0_2"});OpenLayers.Format.WCSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,{namespaces:{wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows/1.1"},errorProperty:"operationsMetadata",readers:{wcs:OpenLayers.Util.applyDefaults({Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,b){b.contentMetadata=[];this.readChildNodes(a,b.contentMetadata)},CoverageSummary:function(a,
b){var c={};this.readChildNodes(a,c);b.push(c)},Identifier:function(a,b){b.identifier=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},SupportedCRS:function(a,b){var c=this.getChildValue(a);c&&(b.supportedCRS||(b.supportedCRS=[]),b.supportedCRS.push(c))},SupportedFormat:function(a,b){var c=this.getChildValue(a);c&&(b.supportedFormat||(b.supportedFormat=[]),b.supportedFormat.push(c))}},OpenLayers.Format.WCSCapabilities.v1.prototype.readers.wcs),
ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1_1_0"});OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,intervals:[45,30,20,10,5,2,1,0.5,0.2,0.1,0.05,0.01,0.005,0.002,0.001],displayInLayerSwitcher:!0,visible:!0,numPoints:50,targetSize:200,layerName:null,labelled:!0,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:0.5},labelSymbolizer:{},gratLayer:null,initialize:function(a){a=a||{};a.layerName=a.layerName||OpenLayers.i18n("Graticule");OpenLayers.Control.prototype.initialize.apply(this,[a]);
this.labelSymbolizer.stroke=!1;this.labelSymbolizer.fill=!1;this.labelSymbolizer.label="${label}";this.labelSymbolizer.labelAlign="${labelAlign}";this.labelSymbolizer.labelXOffset="${xOffset}";this.labelSymbolizer.labelYOffset="${yOffset}"},destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments);this.gratLayer&&(this.gratLayer.destroy(),this.gratLayer=null)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.gratLayer){var a=new OpenLayers.Style({},
{rules:[new OpenLayers.Rule({symbolizer:{Point:this.labelSymbolizer,Line:this.lineSymbolizer}})]});this.gratLayer=new OpenLayers.Layer.Vector(this.layerName,{styleMap:new OpenLayers.StyleMap({"default":a}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher})}return this.div},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.addLayer(this.gratLayer),this.map.events.register("moveend",this,this.update),this.update(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,
arguments)?(this.map.events.unregister("moveend",this,this.update),this.map.removeLayer(this.gratLayer),!0):!1},update:function(){var a=this.map.getExtent();if(a){this.gratLayer.destroyFeatures();var b=new OpenLayers.Projection("EPSG:4326"),c=this.map.getProjectionObject(),d=this.map.getResolution();c.proj&&"longlat"==c.proj.projName&&(this.numPoints=1);var e=this.map.getCenter(),f=new OpenLayers.Pixel(e.lon,e.lat);OpenLayers.Projection.transform(f,c,b);for(var e=this.targetSize*d,e=e*e,g,d=0;d<this.intervals.length;++d){g=
this.intervals[d];var h=g/2,k=f.offset({x:-h,y:-h}),h=f.offset({x:h,y:h});OpenLayers.Projection.transform(k,b,c);OpenLayers.Projection.transform(h,b,c);if((k.x-h.x)*(k.x-h.x)+(k.y-h.y)*(k.y-h.y)<=e)break}f.x=Math.floor(f.x/g)*g;f.y=Math.floor(f.y/g)*g;var d=0,e=[f.clone()],h=f.clone(),l;do h=h.offset({x:0,y:g}),l=OpenLayers.Projection.transform(h.clone(),b,c),e.unshift(h);while(a.containsPixel(l)&&1E3>++d);h=f.clone();do h=h.offset({x:0,y:-g}),l=OpenLayers.Projection.transform(h.clone(),b,c),e.push(h);
while(a.containsPixel(l)&&1E3>++d);d=0;k=[f.clone()];h=f.clone();do h=h.offset({x:-g,y:0}),l=OpenLayers.Projection.transform(h.clone(),b,c),k.unshift(h);while(a.containsPixel(l)&&1E3>++d);h=f.clone();do h=h.offset({x:g,y:0}),l=OpenLayers.Projection.transform(h.clone(),b,c),k.push(h);while(a.containsPixel(l)&&1E3>++d);g=[];for(d=0;d<k.length;++d){l=k[d].x;for(var f=[],m=null,n=Math.min(e[0].y,90),h=Math.max(e[e.length-1].y,-90),p=(n-h)/this.numPoints,n=h,h=0;h<=this.numPoints;++h){var q=new OpenLayers.Geometry.Point(l,
n);q.transform(b,c);f.push(q);n+=p;q.y>=a.bottom&&!m&&(m=q)}this.labelled&&(m=new OpenLayers.Geometry.Point(m.x,a.bottom),l={value:l,label:this.labelled?OpenLayers.Util.getFormattedLonLat(l,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2},this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(m,l)));f=new OpenLayers.Geometry.LineString(f);g.push(new OpenLayers.Feature.Vector(f))}for(h=0;h<e.length;++h)if(n=e[h].y,!(-90>n||90<n)){f=[];d=k[0].x;p=(k[k.length-1].x-d)/this.numPoints;
l=d;m=null;for(d=0;d<=this.numPoints;++d)q=new OpenLayers.Geometry.Point(l,n),q.transform(b,c),f.push(q),l+=p,q.x<a.right&&(m=q);this.labelled&&(m=new OpenLayers.Geometry.Point(a.right,m.y),l={value:n,label:this.labelled?OpenLayers.Util.getFormattedLonLat(n,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2},this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(m,l)));f=new OpenLayers.Geometry.LineString(f);g.push(new OpenLayers.Feature.Vector(f))}this.gratLayer.addFeatures(g)}},CLASS_NAME:"OpenLayers.Control.Graticule"});OpenLayers.Console.warn("OpenLayers.Rico is deprecated");OpenLayers.Rico=OpenLayers.Rico||{};
OpenLayers.Rico.Corner={round:function(a,b){a=OpenLayers.Util.getElement(a);this._setOptions(b);var c=this.options.color;"fromElement"==this.options.color&&(c=this._background(a));var d=this.options.bgColor;"fromParent"==this.options.bgColor&&(d=this._background(a.offsetParent));this._roundCornersImpl(a,c,d)},changeColor:function(a,b){a.style.backgroundColor=b;for(var c=a.parentNode.getElementsByTagName("span"),d=0;d<c.length;d++)c[d].style.backgroundColor=b},changeOpacity:function(a,b){var c="alpha(opacity="+
100*b+")";a.style.opacity=b;a.style.filter=c;for(var d=a.parentNode.getElementsByTagName("span"),e=0;e<d.length;e++)d[e].style.opacity=b,d[e].style.filter=c},reRound:function(a,b){var c=a.parentNode.childNodes[2];a.parentNode.removeChild(a.parentNode.childNodes[0]);a.parentNode.removeChild(c);this.round(a.parentNode,b)},_roundCornersImpl:function(a,b,c){this.options.border&&this._renderBorder(a,c);this._isTopRounded()&&this._roundTopCorners(a,b,c);this._isBottomRounded()&&this._roundBottomCorners(a,
b,c)},_renderBorder:function(a,b){var c="1px solid "+this._borderColor(b);a.innerHTML="<div "+("style='border-left: "+c+";"+("border-right: "+c)+"'")+">"+a.innerHTML+"</div>"},_roundTopCorners:function(a,b,c){for(var d=this._createCorner(c),e=0;e<this.options.numSlices;e++)d.appendChild(this._createCornerSlice(b,c,e,"top"));a.style.paddingTop=0;a.insertBefore(d,a.firstChild)},_roundBottomCorners:function(a,b,c){for(var d=this._createCorner(c),e=this.options.numSlices-1;0<=e;e--)d.appendChild(this._createCornerSlice(b,
c,e,"bottom"));a.style.paddingBottom=0;a.appendChild(d)},_createCorner:function(a){var b=document.createElement("div");b.style.backgroundColor=this._isTransparent()?"transparent":a;return b},_createCornerSlice:function(a,b,c,d){var e=document.createElement("span"),f=e.style;f.backgroundColor=a;f.display="block";f.height="1px";f.overflow="hidden";f.fontSize="1px";a=this._borderColor(a,b);this.options.border&&0==c?(f.borderTopStyle="solid",f.borderTopWidth="1px",f.borderLeftWidth="0px",f.borderRightWidth=
"0px",f.borderBottomWidth="0px",f.height="0px",f.borderColor=a):a&&(f.borderColor=a,f.borderStyle="solid",f.borderWidth="0px 1px");this.options.compact||c!=this.options.numSlices-1||(f.height="2px");this._setMargin(e,c,d);this._setBorder(e,c,d);return e},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1};OpenLayers.Util.extend(this.options,a||{});this.options.numSlices=this.options.compact?2:4;this._isTransparent()&&(this.options.blend=
!1)},_whichSideTop:function(){return this._hasString(this.options.corners,"all","top")||0<=this.options.corners.indexOf("tl")&&0<=this.options.corners.indexOf("tr")?"":0<=this.options.corners.indexOf("tl")?"left":0<=this.options.corners.indexOf("tr")?"right":""},_whichSideBottom:function(){return this._hasString(this.options.corners,"all","bottom")||0<=this.options.corners.indexOf("bl")&&0<=this.options.corners.indexOf("br")?"":0<=this.options.corners.indexOf("bl")?"left":0<=this.options.corners.indexOf("br")?
"right":""},_borderColor:function(a,b){return"transparent"==a?b:this.options.border?this.options.border:this.options.blend?this._blend(b,a):""},_setMargin:function(a,b,c){b=this._marginSize(b);c="top"==c?this._whichSideTop():this._whichSideBottom();"left"==c?(a.style.marginLeft=b+"px",a.style.marginRight="0px"):"right"==c?(a.style.marginRight=b+"px",a.style.marginLeft="0px"):(a.style.marginLeft=b+"px",a.style.marginRight=b+"px")},_setBorder:function(a,b,c){b=this._borderSize(b);c="top"==c?this._whichSideTop():
this._whichSideBottom();"left"==c?(a.style.borderLeftWidth=b+"px",a.style.borderRightWidth="0px"):"right"==c?(a.style.borderRightWidth=b+"px",a.style.borderLeftWidth="0px"):(a.style.borderLeftWidth=b+"px",a.style.borderRightWidth=b+"px");!1!=this.options.border&&(a.style.borderLeftWidth=b+"px",a.style.borderRightWidth=b+"px")},_marginSize:function(a){if(this._isTransparent())return 0;var b=[5,3,2,1],c=[3,2,1,0],d=[2,1],e=[1,0];return this.options.compact&&this.options.blend?e[a]:this.options.compact?
d[a]:this.options.blend?c[a]:b[a]},_borderSize:function(a){var b=[5,3,2,1],c=[2,1,1,1],d=[1,0],e=[0,2,0,0];return this.options.compact&&(this.options.blend||this._isTransparent())?1:this.options.compact?d[a]:this.options.blend?c[a]:this.options.border?e[a]:this._isTransparent()?b[a]:0},_hasString:function(a){for(var b=1;b<arguments.length;b++)if(0<=a.indexOf(arguments[b]))return!0;return!1},_blend:function(a,b){var c=OpenLayers.Rico.Color.createFromHex(a);c.blend(OpenLayers.Rico.Color.createFromHex(b));
return c},_background:function(a){try{return OpenLayers.Rico.Color.createColorFromBackground(a).asHex()}catch(b){return"#ffffff"}},_isTransparent:function(){return"transparent"==this.options.color},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return 1==a.childNodes.length&&3==a.childNodes[0].nodeType}};OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,autoActivate:!0,clearOnDeactivate:!1,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:!1,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.registry=OpenLayers.Util.extend({moveend:this.getState},this.registry);a={trigger:OpenLayers.Function.bind(this.previousTrigger,
this),displayClass:this.displayClass+" "+this.displayClass+"Previous"};OpenLayers.Util.extend(a,this.previousOptions);this.previous=new OpenLayers.Control.Button(a);a={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next"};OpenLayers.Util.extend(a,this.nextOptions);this.next=new OpenLayers.Control.Button(a);this.clear()},onPreviousChange:function(a,b){a&&!this.previous.active?this.previous.activate():!a&&this.previous.active&&this.previous.deactivate()},
onNextChange:function(a,b){a&&!this.next.active?this.next.activate():!a&&this.next.active&&this.next.deactivate()},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this);this.previous.destroy();this.next.destroy();this.deactivate();for(var a in this)this[a]=null},setMap:function(a){this.map=a;this.next.setMap(a);this.previous.setMap(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.next.draw();this.previous.draw()},previousTrigger:function(){var a=this.previousStack.shift(),
b=this.previousStack.shift();void 0!=b?(this.nextStack.unshift(a),this.previousStack.unshift(b),this.restoring=!0,this.restore(b),this.restoring=!1,this.onNextChange(this.nextStack[0],this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)):this.previousStack.unshift(a);return b},nextTrigger:function(){var a=this.nextStack.shift();void 0!=a&&(this.previousStack.unshift(a),this.restoring=!0,this.restore(a),this.restoring=!1,this.onNextChange(this.nextStack[0],
this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1));return a},clear:function(){this.previousStack=[];this.previous.deactivate();this.nextStack=[];this.next.deactivate()},getState:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution(),projection:this.map.getProjectionObject(),units:this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units}},restore:function(a){var b,c;if(this.map.getProjectionObject()==
a.projection)c=this.map.getZoomForResolution(a.resolution),b=a.center;else{b=a.center.clone();b.transform(a.projection,this.map.getProjectionObject());c=a.units;var d=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;c=this.map.getZoomForResolution((c&&d?OpenLayers.INCHES_PER_UNIT[c]/OpenLayers.INCHES_PER_UNIT[d]:1)*a.resolution)}this.map.setCenter(b,c)},setListeners:function(){this.listeners={};for(var a in this.registry)this.listeners[a]=OpenLayers.Function.bind(function(){if(!this.restoring){var b=
this.registry[a].apply(this,arguments);this.previousStack.unshift(b);if(1<this.previousStack.length)this.onPreviousChange(this.previousStack[1],this.previousStack.length-1);this.previousStack.length>this.limit+1&&this.previousStack.pop();0<this.nextStack.length&&(this.nextStack=[],this.onNextChange(null,0))}return!0},this)},activate:function(){var a=!1;if(this.map&&OpenLayers.Control.prototype.activate.apply(this)){null==this.listeners&&this.setListeners();for(var b in this.listeners)this.map.events.register(b,
this,this.listeners[b]);a=!0;0==this.previousStack.length&&this.initStack()}return a},initStack:function(){this.map.getCenter()&&this.listeners.moveend()},deactivate:function(){var a=!1;if(this.map&&OpenLayers.Control.prototype.deactivate.apply(this)){for(var b in this.listeners)this.map.events.unregister(b,this,this.listeners[b]);this.clearOnDeactivate&&this.clear();a=!0}return a},CLASS_NAME:"OpenLayers.Control.NavigationHistory"});OpenLayers.Layer.UTFGrid=OpenLayers.Class(OpenLayers.Layer.XYZ,{isBaseLayer:!1,projection:new OpenLayers.Projection("EPSG:900913"),useJSONP:!1,tileClass:OpenLayers.Tile.UTFGrid,initialize:function(a){OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a.name,a.url,{},a]);this.tileOptions=OpenLayers.Util.extend({utfgridResolution:this.utfgridResolution},this.tileOptions)},createBackBuffer:function(){},clone:function(a){null==a&&(a=new OpenLayers.Layer.UTFGrid(this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getFeatureInfo:function(a){var b=null;(a=this.getTileData(a))&&a.tile&&(b=a.tile.getFeatureInfo(a.i,a.j));return b},getFeatureId:function(a){var b=null;a=this.getTileData(a);a.tile&&(b=a.tile.getFeatureId(a.i,a.j));return b},CLASS_NAME:"OpenLayers.Layer.UTFGrid"});OpenLayers.TileManager=OpenLayers.Class({cacheSize:256,tilesPerFrame:2,frameDelay:16,moveDelay:100,zoomDelay:200,maps:null,tileQueueId:null,tileQueue:null,tileCache:null,tileCacheIndex:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.maps=[];this.tileQueueId={};this.tileQueue={};this.tileCache={};this.tileCacheIndex=[]},addMap:function(a){if(!this._destroyed&&OpenLayers.Layer.Grid){this.maps.push(a);this.tileQueue[a.id]=[];for(var b=0,c=a.layers.length;b<c;++b)this.addLayer({layer:a.layers[b]});
a.events.on({move:this.move,zoomend:this.zoomEnd,changelayer:this.changeLayer,addlayer:this.addLayer,preremovelayer:this.removeLayer,scope:this})}},removeMap:function(a){if(!this._destroyed&&OpenLayers.Layer.Grid){window.clearTimeout(this.tileQueueId[a.id]);if(a.layers)for(var b=0,c=a.layers.length;b<c;++b)this.removeLayer({layer:a.layers[b]});a.events&&a.events.un({move:this.move,zoomend:this.zoomEnd,changelayer:this.changeLayer,addlayer:this.addLayer,preremovelayer:this.removeLayer,scope:this});
delete this.tileQueue[a.id];delete this.tileQueueId[a.id];OpenLayers.Util.removeItem(this.maps,a)}},move:function(a){this.updateTimeout(a.object,this.moveDelay,!0)},zoomEnd:function(a){this.updateTimeout(a.object,this.zoomDelay)},changeLayer:function(a){"visibility"!==a.property&&"params"!==a.property||this.updateTimeout(a.object,0)},addLayer:function(a){a=a.layer;if(a instanceof OpenLayers.Layer.Grid){a.events.on({addtile:this.addTile,retile:this.clearTileQueue,scope:this});var b,c,d;for(b=a.grid.length-
1;0<=b;--b)for(c=a.grid[b].length-1;0<=c;--c)d=a.grid[b][c],this.addTile({tile:d}),d.url&&!d.imgDiv&&this.manageTileCache({object:d})}},removeLayer:function(a){a=a.layer;if(a instanceof OpenLayers.Layer.Grid&&(this.clearTileQueue({object:a}),a.events&&a.events.un({addtile:this.addTile,retile:this.clearTileQueue,scope:this}),a.grid)){var b,c,d;for(b=a.grid.length-1;0<=b;--b)for(c=a.grid[b].length-1;0<=c;--c)d=a.grid[b][c],this.unloadTile({object:d})}},updateTimeout:function(a,b,c){window.clearTimeout(this.tileQueueId[a.id]);
var d=this.tileQueue[a.id];if(!c||d.length)this.tileQueueId[a.id]=window.setTimeout(OpenLayers.Function.bind(function(){this.drawTilesFromQueue(a);d.length&&this.updateTimeout(a,this.frameDelay)},this),b)},addTile:function(a){if(a.tile instanceof OpenLayers.Tile.Image)a.tile.events.on({beforedraw:this.queueTileDraw,beforeload:this.manageTileCache,loadend:this.addToCache,unload:this.unloadTile,scope:this});else this.removeLayer({layer:a.tile.layer})},unloadTile:function(a){a=a.object;a.events.un({beforedraw:this.queueTileDraw,
beforeload:this.manageTileCache,loadend:this.addToCache,unload:this.unloadTile,scope:this});OpenLayers.Util.removeItem(this.tileQueue[a.layer.map.id],a)},queueTileDraw:function(a){a=a.object;var b=!1,c=a.layer,d=c.getURL(a.bounds),e=this.tileCache[d];e&&"olTileImage"!==e.className&&(delete this.tileCache[d],OpenLayers.Util.removeItem(this.tileCacheIndex,d),e=null);!c.url||!c.async&&e||(b=this.tileQueue[c.map.id],~OpenLayers.Util.indexOf(b,a)||b.push(a),b=!0);return!b},drawTilesFromQueue:function(a){var b=
this.tileQueue[a.id],c=this.tilesPerFrame;for(a=a.zoomTween&&a.zoomTween.playing;!a&&b.length&&c;)b.shift().draw(!0),--c},manageTileCache:function(a){a=a.object;var b=this.tileCache[a.url];b&&(b.parentNode&&OpenLayers.Element.hasClass(b.parentNode,"olBackBuffer")&&(b.parentNode.removeChild(b),b.id=null),b.parentNode||(b.style.visibility="hidden",b.style.opacity=0,a.setImage(b),OpenLayers.Util.removeItem(this.tileCacheIndex,a.url),this.tileCacheIndex.push(a.url)))},addToCache:function(a){a=a.object;
this.tileCache[a.url]||OpenLayers.Element.hasClass(a.imgDiv,"olImageLoadError")||(this.tileCacheIndex.length>=this.cacheSize&&(delete this.tileCache[this.tileCacheIndex[0]],this.tileCacheIndex.shift()),this.tileCache[a.url]=a.imgDiv,this.tileCacheIndex.push(a.url))},clearTileQueue:function(a){a=a.object;for(var b=this.tileQueue[a.map.id],c=b.length-1;0<=c;--c)b[c].layer===a&&b.splice(c,1)},destroy:function(){for(var a=this.maps.length-1;0<=a;--a)this.removeMap(this.maps[a]);this.tileCacheIndex=this.tileCache=
this.tileQueueId=this.tileQueue=this.maps=null;this._destroyed=!0}});OpenLayers.Layer.ArcGISCache=OpenLayers.Class(OpenLayers.Layer.XYZ,{url:null,tileOrigin:null,tileSize:new OpenLayers.Size(256,256),useArcGISServer:!0,type:"png",useScales:!1,overrideDPI:!1,initialize:function(a,b,c){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);this.resolutions&&(this.serverResolutions=this.resolutions,this.maxExtent=this.getMaxExtentForResolution(this.resolutions[0]));if(this.layerInfo){var d=this.layerInfo,e=new OpenLayers.Bounds(d.fullExtent.xmin,d.fullExtent.ymin,
d.fullExtent.xmax,d.fullExtent.ymax);this.projection="EPSG:"+d.spatialReference.wkid;this.sphericalMercator=102100==d.spatialReference.wkid;this.units="esriFeet"==d.units?"ft":"m";if(d.tileInfo){this.tileSize=new OpenLayers.Size(d.tileInfo.width||d.tileInfo.cols,d.tileInfo.height||d.tileInfo.rows);this.tileOrigin=new OpenLayers.LonLat(d.tileInfo.origin.x,d.tileInfo.origin.y);var f=new OpenLayers.Geometry.Point(e.left,e.top),e=new OpenLayers.Geometry.Point(e.right,e.bottom);this.useScales?this.scales=
[]:this.resolutions=[];this.lods=[];for(var g in d.tileInfo.lods)if(d.tileInfo.lods.hasOwnProperty(g)){var h=d.tileInfo.lods[g];this.useScales?this.scales.push(h.scale):this.resolutions.push(h.resolution);var k=this.getContainingTileCoords(f,h.resolution);h.startTileCol=k.x;h.startTileRow=k.y;k=this.getContainingTileCoords(e,h.resolution);h.endTileCol=k.x;h.endTileRow=k.y;this.lods.push(h)}this.maxExtent=this.calculateMaxExtentWithLOD(this.lods[0]);this.serverResolutions=this.resolutions;this.overrideDPI&&
d.tileInfo.dpi&&(OpenLayers.DOTS_PER_INCH=d.tileInfo.dpi)}}},getContainingTileCoords:function(a,b){return new OpenLayers.Pixel(Math.max(Math.floor((a.x-this.tileOrigin.lon)/(this.tileSize.w*b)),0),Math.max(Math.floor((this.tileOrigin.lat-a.y)/(this.tileSize.h*b)),0))},calculateMaxExtentWithLOD:function(a){var b=this.tileOrigin.lon+a.startTileCol*this.tileSize.w*a.resolution,c=this.tileOrigin.lat-a.startTileRow*this.tileSize.h*a.resolution;return new OpenLayers.Bounds(b,c-(a.endTileRow-a.startTileRow+
1)*this.tileSize.h*a.resolution,b+(a.endTileCol-a.startTileCol+1)*this.tileSize.w*a.resolution,c)},calculateMaxExtentWithExtent:function(a,b){var c=new OpenLayers.Geometry.Point(a.left,a.top),d=new OpenLayers.Geometry.Point(a.right,a.bottom),c=this.getContainingTileCoords(c,b),d=this.getContainingTileCoords(d,b);return this.calculateMaxExtentWithLOD({resolution:b,startTileCol:c.x,startTileRow:c.y,endTileCol:d.x,endTileRow:d.y})},getUpperLeftTileCoord:function(a){var b=new OpenLayers.Geometry.Point(this.maxExtent.left,
this.maxExtent.top);return this.getContainingTileCoords(b,a)},getLowerRightTileCoord:function(a){var b=new OpenLayers.Geometry.Point(this.maxExtent.right,this.maxExtent.bottom);return this.getContainingTileCoords(b,a)},getMaxExtentForResolution:function(a){var b=this.getUpperLeftTileCoord(a),c=this.getLowerRightTileCoord(a),d=this.tileOrigin.lon+b.x*this.tileSize.w*a,e=this.tileOrigin.lat-b.y*this.tileSize.h*a;return new OpenLayers.Bounds(d,e-(c.y-b.y+1)*this.tileSize.h*a,d+(c.x-b.x+1)*this.tileSize.w*
a,e)},clone:function(a){null==a&&(a=new OpenLayers.Layer.ArcGISCache(this.name,this.url,this.options));return OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},initGriddedTiles:function(a){delete this._tileOrigin;OpenLayers.Layer.XYZ.prototype.initGriddedTiles.apply(this,arguments)},getMaxExtent:function(){var a=this.map.getResolution();return this.maxExtent=this.getMaxExtentForResolution(a)},getTileOrigin:function(){if(!this._tileOrigin){var a=this.getMaxExtent();this._tileOrigin=new OpenLayers.LonLat(a.left,
a.bottom)}return this._tileOrigin},getURL:function(a){var b=this.getResolution(),c=this.tileOrigin.lon+b*this.tileSize.w/2,d=this.tileOrigin.lat-b*this.tileSize.h/2;a=a.getCenterLonLat();c=Math.round(Math.abs((a.lon-c)/(b*this.tileSize.w)));d=Math.round(Math.abs((d-a.lat)/(b*this.tileSize.h)));a=this.map.getZoom();if(this.lods){if(b=this.lods[this.map.getZoom()],c<b.startTileCol||c>b.endTileCol||d<b.startTileRow||d>b.endTileRow)return null}else{var e=this.getUpperLeftTileCoord(b),b=this.getLowerRightTileCoord(b);
if(c<e.x||c>=b.x||d<e.y||d>=b.y)return null}b=this.url;e=""+c+d+a;OpenLayers.Util.isArray(b)&&(b=this.selectUrl(e,b));this.useArcGISServer?b+="/tile/${z}/${y}/${x}":(c="C"+OpenLayers.Number.zeroPad(c,8,16),d="R"+OpenLayers.Number.zeroPad(d,8,16),a="L"+OpenLayers.Number.zeroPad(a,2,10),b=b+"/${z}/${y}/${x}."+this.type);b=OpenLayers.String.format(b,{x:c,y:d,z:a});return OpenLayers.Util.urlAppend(b,OpenLayers.Util.getParameterString(this.params))},CLASS_NAME:"OpenLayers.Layer.ArcGISCache"});OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,drillDown:!1,maxFeatures:10,clickCallback:"click",output:"features",layers:null,queryVisible:!1,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handler:null,hoverRequest:null,initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions));
!0===this.drillDown&&(this.hover=!1);this.hover?this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250})):(a={},a[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,a,this.handlerOptions.click||{}))},getInfoForClick:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");this.request(a.xy,
{})},getInfoForHover:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy});this.request(a.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&&(this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){for(var a=this.layers||this.map.layers,b=[],c,d,e=a.length-1;0<=e;--e)c=a[e],c instanceof OpenLayers.Layer.WMS&&(!this.queryVisible||c.getVisibility())&&(d=OpenLayers.Util.isArray(c.url)?c.url[0]:c.url,!1!==this.drillDown||this.url||(this.url=d),(!0===this.drillDown||
this.urlMatches(d))&&b.push(c));return b},urlMatches:function(a){var b=OpenLayers.Util.isEquivalentUrl(this.url,a);if(!b&&this.layerUrls)for(var c=0,d=this.layerUrls.length;c<d;++c)if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[c],a)){b=!0;break}return b},buildWMSOptions:function(a,b,c,d){for(var e=[],f=[],g=0,h=b.length;g<h;g++)null!=b[g].params.LAYERS&&(e=e.concat(b[g].params.LAYERS),f=f.concat(this.getStyleNames(b[g])));b=b[0];g=this.map.getProjection();(h=b.projection)&&h.equals(this.map.getProjectionObject())&&
(g=h.getCode());d=OpenLayers.Util.extend({service:"WMS",version:b.params.VERSION,request:"GetFeatureInfo",exceptions:b.params.EXCEPTIONS,bbox:this.map.getExtent().toBBOX(null,b.reverseAxisOrder()),feature_count:this.maxFeatures,height:this.map.getSize().h,width:this.map.getSize().w,format:d,info_format:b.params.INFO_FORMAT||this.infoFormat},1.3<=parseFloat(b.params.VERSION)?{crs:g,i:parseInt(c.x),j:parseInt(c.y)}:{srs:g,x:parseInt(c.x),y:parseInt(c.y)});0!=e.length&&(d=OpenLayers.Util.extend({layers:e,
query_layers:e,styles:f},d));OpenLayers.Util.applyDefaults(d,this.vendorParams);return{url:a,params:OpenLayers.Util.upperCaseObject(d),callback:function(b){this.handleResponse(c,b,a)},scope:this}},getStyleNames:function(a){return a.params.STYLES?a.params.STYLES:OpenLayers.Util.isArray(a.params.LAYERS)?Array(a.params.LAYERS.length):a.params.LAYERS.replace(/[^,]/g,"")},request:function(a,b){var c=this.findLayers();if(0==c.length)this.events.triggerEvent("nogetfeatureinfo"),OpenLayers.Element.removeClass(this.map.viewPortDiv,
"olCursorWait");else if(b=b||{},!1===this.drillDown){var c=this.buildWMSOptions(this.url,c,a,c[0].params.FORMAT),d=OpenLayers.Request.GET(c);!0===b.hover&&(this.hoverRequest=d)}else{this._numRequests=this._requestCount=0;this.features=[];for(var d={},e,f=0,g=c.length;f<g;f++){var h=c[f];e=OpenLayers.Util.isArray(h.url)?h.url[0]:h.url;e in d?d[e].push(h):(this._numRequests++,d[e]=[h])}for(e in d)c=d[e],c=this.buildWMSOptions(e,c,a,c[0].params.FORMAT),OpenLayers.Request.GET(c)}},triggerGetFeatureInfo:function(a,
b,c){this.events.triggerEvent("getfeatureinfo",{text:a.responseText,features:c,request:a,xy:b});OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},handleResponse:function(a,b,c){var d=b.responseXML;d&&d.documentElement||(d=b.responseText);d=this.format.read(d);!1===this.drillDown?this.triggerGetFeatureInfo(b,a,d):(this._requestCount++,this._features="object"===this.output?(this._features||[]).concat({url:c,features:d}):(this._features||[]).concat(d),this._requestCount===this._numRequests&&
(this.triggerGetFeatureInfo(b,a,this._features.concat()),delete this._features,delete this._requestCount,delete this._numRequests))},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"});OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,{version:"1.3.0",CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"});OpenLayers.Format.SOSGetFeatureOfInterest=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",sa:"http://www.opengis.net/sampling/1.0",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd",defaultPrefix:"sos",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a){"string"==
typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={features:[]};this.readNode(a,b);a=[];for(var c=0,d=b.features.length;c<d;c++){var e=b.features[c];this.internalProjection&&(this.externalProjection&&e.components[0])&&e.components[0].transform(this.externalProjection,this.internalProjection);e=new OpenLayers.Feature.Vector(e.components[0],e.attributes);a.push(e)}return a},readers:{sa:{SamplingPoint:function(a,b){if(!b.attributes){var c=
{attributes:{}};b.features.push(c);b=c}b.attributes.id=this.getAttributeNS(a,this.namespaces.gml,"id");this.readChildNodes(a,b)},position:function(a,b){this.readChildNodes(a,b)}},gml:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,b){this.readChildNodes(a,b)},featureMember:function(a,b){var c={attributes:{}};b.features.push(c);this.readChildNodes(a,c)},name:function(a,b){b.attributes.name=this.getChildValue(a)},pos:function(a,b){this.externalProjection||(this.externalProjection=new OpenLayers.Projection(a.getAttribute("srsName")));
OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[a,b])}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{sos:{GetFeatureOfInterest:function(a){for(var b=this.createElementNSPlus("GetFeatureOfInterest",{attributes:{version:this.VERSION,service:"SOS","xsi:schemaLocation":this.schemaLocation}}),c=0,d=a.fois.length;c<d;c++)this.writeNode("FeatureOfInterestId",{foi:a.fois[c]},b);return b},FeatureOfInterestId:function(a){return this.createElementNSPlus("FeatureOfInterestId",{value:a.foi})}}},
CLASS_NAME:"OpenLayers.Format.SOSGetFeatureOfInterest"});OpenLayers.Format.SOSGetObservation=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows",gml:"http://www.opengis.net/gml",sos:"http://www.opengis.net/sos/1.0",ogc:"http://www.opengis.net/ogc",om:"http://www.opengis.net/om/1.0",sa:"http://www.opengis.net/sampling/1.0",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd",
defaultPrefix:"sos",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={measurements:[],observations:[]};this.readNode(a,b);return b},write:function(a){a=this.writeNode("sos:GetObservation",a);a.setAttribute("xmlns:om",this.namespaces.om);a.setAttribute("xmlns:ogc",this.namespaces.ogc);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,
[a])},readers:{om:{ObservationCollection:function(a,b){b.id=this.getAttributeNS(a,this.namespaces.gml,"id");this.readChildNodes(a,b)},member:function(a,b){this.readChildNodes(a,b)},Measurement:function(a,b){var c={};b.measurements.push(c);this.readChildNodes(a,c)},Observation:function(a,b){var c={};b.observations.push(c);this.readChildNodes(a,c)},samplingTime:function(a,b){var c={};b.samplingTime=c;this.readChildNodes(a,c)},observedProperty:function(a,b){b.observedProperty=this.getAttributeNS(a,this.namespaces.xlink,
"href");this.readChildNodes(a,b)},procedure:function(a,b){b.procedure=this.getAttributeNS(a,this.namespaces.xlink,"href");this.readChildNodes(a,b)},featureOfInterest:function(a,b){var c={features:[]};b.fois=[];b.fois.push(c);this.readChildNodes(a,c);for(var d=[],e=0,f=c.features.length;e<f;e++){var g=c.features[e];d.push(new OpenLayers.Feature.Vector(g.components[0],g.attributes))}c.features=d},result:function(a,b){var c={};b.result=c;""!==this.getChildValue(a)?(c.value=this.getChildValue(a),c.uom=
a.getAttribute("uom")):this.readChildNodes(a,c)}},sa:OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.sa,gml:OpenLayers.Util.applyDefaults({TimeInstant:function(a,b){var c={};b.timeInstant=c;this.readChildNodes(a,c)},timePosition:function(a,b){b.timePosition=this.getChildValue(a)}},OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.gml)},writers:{sos:{GetObservation:function(a){var b=this.createElementNSPlus("GetObservation",{attributes:{version:this.VERSION,service:"SOS"}});this.writeNode("offering",
a,b);a.eventTime&&this.writeNode("eventTime",a,b);for(var c in a.procedures)this.writeNode("procedure",a.procedures[c],b);for(var d in a.observedProperties)this.writeNode("observedProperty",a.observedProperties[d],b);a.foi&&this.writeNode("featureOfInterest",a.foi,b);this.writeNode("responseFormat",a,b);a.resultModel&&this.writeNode("resultModel",a,b);a.responseMode&&this.writeNode("responseMode",a,b);return b},featureOfInterest:function(a){var b=this.createElementNSPlus("featureOfInterest");this.writeNode("ObjectID",
a.objectId,b);return b},ObjectID:function(a){return this.createElementNSPlus("ObjectID",{value:a})},responseFormat:function(a){return this.createElementNSPlus("responseFormat",{value:a.responseFormat})},procedure:function(a){return this.createElementNSPlus("procedure",{value:a})},offering:function(a){return this.createElementNSPlus("offering",{value:a.offering})},observedProperty:function(a){return this.createElementNSPlus("observedProperty",{value:a})},eventTime:function(a){var b=this.createElementNSPlus("eventTime");
"latest"===a.eventTime&&this.writeNode("ogc:TM_Equals",a,b);return b},resultModel:function(a){return this.createElementNSPlus("resultModel",{value:a.resultModel})},responseMode:function(a){return this.createElementNSPlus("responseMode",{value:a.responseMode})}},ogc:{TM_Equals:function(a){var b=this.createElementNSPlus("ogc:TM_Equals");this.writeNode("ogc:PropertyName",{property:"urn:ogc:data:time:iso8601"},b);"latest"===a.eventTime&&this.writeNode("gml:TimeInstant",{value:"latest"},b);return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",
{value:a.property})}},gml:{TimeInstant:function(a){var b=this.createElementNSPlus("gml:TimeInstant");this.writeNode("gml:timePosition",a,b);return b},timePosition:function(a){return this.createElementNSPlus("gml:timePosition",{value:a.value})}}},CLASS_NAME:"OpenLayers.Format.SOSGetObservation"});OpenLayers.Control.UTFGrid=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,layers:null,defaultHandlerOptions:{delay:300,pixelTolerance:4,stopMove:!1,single:!0,"double":!1,stopSingle:!1,stopDouble:!1},handlerMode:"click",setHandler:function(a){this.handlerMode=a;this.resetHandler()},resetHandler:function(){this.handler&&(this.handler.deactivate(),this.handler.destroy(),this.handler=null);"hover"==this.handlerMode?this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.reset},
this.handlerOptions):"click"==this.handlerMode?this.handler=new OpenLayers.Handler.Click(this,{click:this.handleEvent},this.handlerOptions):"move"==this.handlerMode&&(this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.handleEvent},this.handlerOptions));return this.handler?!0:!1},initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||this.defaultHandlerOptions;OpenLayers.Control.prototype.initialize.apply(this,[a]);this.resetHandler()},handleEvent:function(a){if(null==
a)this.reset();else{var b=this.map.getLonLatFromPixel(a.xy);if(b){var c=this.findLayers();if(0<c.length){for(var d={},e,f,g=0,h=c.length;g<h;g++)e=c[g],f=OpenLayers.Util.indexOf(this.map.layers,e),d[f]=e.getFeatureInfo(b);this.callback(d,b,a.xy)}}}},callback:function(a){},reset:function(a){this.callback(null)},findLayers:function(){for(var a=this.layers||this.map.layers,b=[],c,d=a.length-1;0<=d;--d)c=a[d],c instanceof OpenLayers.Layer.UTFGrid&&b.push(c);return b},CLASS_NAME:"OpenLayers.Control.UTFGrid"});OpenLayers.Format.CQL=function(){function a(a){function b(){var a=e.pop();switch(a.type){case "LOGICAL":var c=b(),g=b();return new OpenLayers.Filter.Logical({filters:[g,c],type:f[a.text.toUpperCase()]});case "NOT":return a=b(),new OpenLayers.Filter.Logical({filters:[a],type:OpenLayers.Filter.Logical.NOT});case "BETWEEN":return e.pop(),g=b(),a=b(),c=b(),new OpenLayers.Filter.Comparison({property:c,lowerBoundary:a,upperBoundary:g,type:OpenLayers.Filter.Comparison.BETWEEN});case "COMPARISON":return g=
b(),c=b(),new OpenLayers.Filter.Comparison({property:c,value:g,type:d[a.text.toUpperCase()]});case "IS_NULL":return c=b(),new OpenLayers.Filter.Comparison({property:c,type:d[a.text.toUpperCase()]});case "VALUE":return(c=a.text.match(/^'(.*)'$/))?c[1].replace(/''/g,"'"):Number(a.text);case "SPATIAL":switch(a.text.toUpperCase()){case "BBOX":var a=b(),c=b(),g=b(),h=b(),k=b();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:k,value:OpenLayers.Bounds.fromArray([h,g,c,
a])});case "INTERSECTS":return g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:c,value:g});case "WITHIN":return g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.WITHIN,property:c,value:g});case "CONTAINS":return g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.CONTAINS,property:c,value:g});case "DWITHIN":return a=b(),g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,value:g,
property:c,distance:Number(a)})}case "GEOMETRY":return OpenLayers.Geometry.fromWKT(a.text);default:return a.text}}for(var c=[],e=[];a.length;){var g=a.shift();switch(g.type){case "PROPERTY":case "GEOMETRY":case "VALUE":e.push(g);break;case "COMPARISON":case "BETWEEN":case "IS_NULL":case "LOGICAL":for(var k=h[g.type];0<c.length&&h[c[c.length-1].type]<=k;)e.push(c.pop());c.push(g);break;case "SPATIAL":case "NOT":case "LPAREN":c.push(g);break;case "RPAREN":for(;0<c.length&&"LPAREN"!=c[c.length-1].type;)e.push(c.pop());
c.pop();0<c.length&&"SPATIAL"==c[c.length-1].type&&e.push(c.pop());case "COMMA":case "END":break;default:throw Error("Unknown token type "+g.type);}}for(;0<c.length;)e.push(c.pop());a=b();if(0<e.length){a="Remaining tokens after building AST: \n";for(c=e.length-1;0<=c;c--)a+=e[c].type+": "+e[c].text+"\n";throw Error(a);}return a}var b={PROPERTY:/^[_a-zA-Z]\w*/,COMPARISON:/^(=|<>|<=|<|>=|>|LIKE)/i,IS_NULL:/^IS NULL/i,COMMA:/^,/,LOGICAL:/^(AND|OR)/i,VALUE:/^('([^']|'')*'|\d+(\.\d*)?|\.\d+)/,LPAREN:/^\(/,
RPAREN:/^\)/,SPATIAL:/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,NOT:/^NOT/i,BETWEEN:/^BETWEEN/i,GEOMETRY:function(a){var b=/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(a);if(b){var c=a.length,b=a.indexOf("(",b[0].length);if(-1<b)for(var d=1;b<c&&0<d;)switch(b++,a.charAt(b)){case "(":d++;break;case ")":d--}return[a.substr(0,b+1)]}},END:/^$/},c={LPAREN:["GEOMETRY","SPATIAL","PROPERTY","VALUE","LPAREN"],RPAREN:["NOT","LOGICAL","END","RPAREN"],PROPERTY:["COMPARISON",
"BETWEEN","COMMA","IS_NULL"],BETWEEN:["VALUE"],IS_NULL:["END"],COMPARISON:["VALUE"],COMMA:["GEOMETRY","VALUE","PROPERTY"],VALUE:["LOGICAL","COMMA","RPAREN","END"],SPATIAL:["LPAREN"],LOGICAL:["NOT","VALUE","SPATIAL","PROPERTY","LPAREN"],NOT:["PROPERTY","LPAREN"],GEOMETRY:["COMMA","RPAREN"]},d={"=":OpenLayers.Filter.Comparison.EQUAL_TO,"<>":OpenLayers.Filter.Comparison.NOT_EQUAL_TO,"<":OpenLayers.Filter.Comparison.LESS_THAN,"<=":OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,">":OpenLayers.Filter.Comparison.GREATER_THAN,
">=":OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,LIKE:OpenLayers.Filter.Comparison.LIKE,BETWEEN:OpenLayers.Filter.Comparison.BETWEEN,"IS NULL":OpenLayers.Filter.Comparison.IS_NULL},e={},f={AND:OpenLayers.Filter.Logical.AND,OR:OpenLayers.Filter.Logical.OR},g={},h={RPAREN:3,LOGICAL:2,COMPARISON:1},k;for(k in d)d.hasOwnProperty(k)&&(e[d[k]]=k);for(k in f)f.hasOwnProperty(k)&&(g[f[k]]=k);return OpenLayers.Class(OpenLayers.Format,{read:function(d){var e=d;d=[];var f,g=["NOT","GEOMETRY","SPATIAL",
"PROPERTY","LPAREN"];do{a:{f=g;for(var h=void 0,g=void 0,k=f.length,h=0;h<k;h++){var g=f[h],s=b[g]instanceof RegExp?b[g].exec(e):(0,b[g])(e);if(s){f=s[0];e=e.substr(f.length).replace(/^\s*/,"");f={type:g,text:f,remainder:e};break a}}d="ERROR: In parsing: ["+e+"], expected one of: ";for(h=0;h<k;h++)g=f[h],d+="\n    "+g+": "+b[g];throw Error(d);}e=f.remainder;g=c[f.type];if("END"!=f.type&&!g)throw Error("No follows list for "+f.type);d.push(f)}while("END"!=f.type);d=a(d);this.keepData&&(this.data=d);
return d},write:function(a){if(a instanceof OpenLayers.Geometry)return a.toString();switch(a.CLASS_NAME){case "OpenLayers.Filter.Spatial":switch(a.type){case OpenLayers.Filter.Spatial.BBOX:return"BBOX("+a.property+","+a.value.toBBOX()+")";case OpenLayers.Filter.Spatial.DWITHIN:return"DWITHIN("+a.property+", "+this.write(a.value)+", "+a.distance+")";case OpenLayers.Filter.Spatial.WITHIN:return"WITHIN("+a.property+", "+this.write(a.value)+")";case OpenLayers.Filter.Spatial.INTERSECTS:return"INTERSECTS("+
a.property+", "+this.write(a.value)+")";case OpenLayers.Filter.Spatial.CONTAINS:return"CONTAINS("+a.property+", "+this.write(a.value)+")";default:throw Error("Unknown spatial filter type: "+a.type);}case "OpenLayers.Filter.Logical":if(a.type==OpenLayers.Filter.Logical.NOT)return"NOT ("+this.write(a.filters[0])+")";for(var b="(",c=!0,d=0;d<a.filters.length;d++)c?c=!1:b+=") "+g[a.type]+" (",b+=this.write(a.filters[d]);return b+")";case "OpenLayers.Filter.Comparison":return a.type==OpenLayers.Filter.Comparison.BETWEEN?
a.property+" BETWEEN "+this.write(a.lowerBoundary)+" AND "+this.write(a.upperBoundary):null!==a.value?a.property+" "+e[a.type]+" "+this.write(a.value):a.property+" "+e[a.type];case void 0:if("string"===typeof a)return"'"+a.replace(/'/g,"''")+"'";if("number"===typeof a)return String(a);default:throw Error("Can't encode: "+a.CLASS_NAME+" "+a);}},CLASS_NAME:"OpenLayers.Format.CQL"})}();OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,{layer:null,source:null,sourceOptions:null,tolerance:null,edge:!0,deferDelete:!1,mutual:!0,targetFilter:null,sourceFilter:null,handler:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.options=a||{};this.options.source&&this.setSource(this.options.source)},setSource:function(a){this.active?(this.deactivate(),this.handler&&(this.handler.destroy(),delete this.handler),this.source=a,this.activate()):this.source=
a},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a)if(!this.source)this.handler||(this.handler=new OpenLayers.Handler.Path(this,{done:function(a){this.onSketchComplete({feature:new OpenLayers.Feature.Vector(a)})}},{layerOptions:this.sourceOptions})),this.handler.activate();else if(this.source.events)this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this});return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this);
a&&this.source&&this.source.events&&this.source.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this});return a},onSketchComplete:function(a){this.feature=null;return!this.considerSplit(a.feature)},afterFeatureModified:function(a){a.modified&&"function"===typeof a.feature.geometry.split&&(this.feature=a.feature,this.considerSplit(a.feature))},removeByGeometry:function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c].geometry===b){a.splice(c,1);break}},
isEligible:function(a){return a.geometry?a.state!==OpenLayers.State.DELETE&&"function"===typeof a.geometry.split&&this.feature!==a&&(!this.targetFilter||this.targetFilter.evaluate(a.attributes)):!1},considerSplit:function(a){var b=!1,c=!1;if(!this.sourceFilter||this.sourceFilter.evaluate(a.attributes)){for(var d=this.layer&&this.layer.features||[],e,f,g=[],h=[],k=this.layer===this.source&&this.mutual,l={edge:this.edge,tolerance:this.tolerance,mutual:k},m=[a.geometry],n,p,q,r=0,s=d.length;r<s;++r)if(n=
d[r],this.isEligible(n)){p=[n.geometry];for(var t=0;t<m.length;++t){q=m[t];for(var u=0;u<p.length;++u)if(e=p[u],q.getBounds().intersectsBounds(e.getBounds())&&(e=q.split(e,l)))f=this.events.triggerEvent("beforesplit",{source:a,target:n}),!1!==f&&(k&&(f=e[0],1<f.length&&(f.unshift(t,1),Array.prototype.splice.apply(m,f),t+=f.length-3),e=e[1]),1<e.length&&(e.unshift(u,1),Array.prototype.splice.apply(p,e),u+=e.length-3))}p&&1<p.length&&(this.geomsToFeatures(n,p),this.events.triggerEvent("split",{original:n,
features:p}),Array.prototype.push.apply(g,p),h.push(n),c=!0)}m&&1<m.length&&(this.geomsToFeatures(a,m),this.events.triggerEvent("split",{original:a,features:m}),Array.prototype.push.apply(g,m),h.push(a),b=!0);if(b||c){if(this.deferDelete){d=[];r=0;for(s=h.length;r<s;++r)c=h[r],c.state===OpenLayers.State.INSERT?d.push(c):(c.state=OpenLayers.State.DELETE,this.layer.drawFeature(c));this.layer.destroyFeatures(d,{silent:!0});r=0;for(s=g.length;r<s;++r)g[r].state=OpenLayers.State.INSERT}else this.layer.destroyFeatures(h,
{silent:!0});this.layer.addFeatures(g,{silent:!0});this.events.triggerEvent("aftersplit",{source:a,features:g})}}return b},geomsToFeatures:function(a,b){var c=a.clone();delete c.geometry;for(var d,e=0,f=b.length;e<f;++e)d=c.clone(),d.geometry=b[e],d.state=OpenLayers.State.INSERT,b[e]=d},destroy:function(){this.active&&this.deactivate();OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Split"});OpenLayers.Layer.WMTS=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,version:"1.0.0",requestEncoding:"KVP",url:null,layer:null,matrixSet:null,style:null,format:"image/jpeg",tileOrigin:null,tileFullExtent:null,formatSuffix:null,matrixIds:null,dimensions:null,params:null,zoomOffset:0,serverResolutions:null,formatSuffixMap:{"image/png":"png","image/png8":"png","image/png24":"png","image/png32":"png",png:"png","image/jpeg":"jpg","image/jpg":"jpg",jpeg:"jpg",jpg:"jpg"},matrix:null,initialize:function(a){var b=
{url:!0,layer:!0,style:!0,matrixSet:!0},c;for(c in b)if(!(c in a))throw Error("Missing property '"+c+"' in layer configuration.");a.params=OpenLayers.Util.upperCaseObject(a.params);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a.name,a.url,a.params,a]);this.formatSuffix||(this.formatSuffix=this.formatSuffixMap[this.format]||this.format.split("/").pop());if(this.matrixIds&&(a=this.matrixIds.length)&&"string"===typeof this.matrixIds[0])for(b=this.matrixIds,this.matrixIds=Array(a),c=0;c<a;++c)this.matrixIds[c]=
{identifier:b[c]}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments)},updateMatrixProperties:function(){if(this.matrix=this.getMatrix())this.matrix.topLeftCorner&&(this.tileOrigin=this.matrix.topLeftCorner),this.matrix.tileWidth&&this.matrix.tileHeight&&(this.tileSize=new OpenLayers.Size(this.matrix.tileWidth,this.matrix.tileHeight)),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.top)),this.tileFullExtent||(this.tileFullExtent=
this.maxExtent)},moveTo:function(a,b,c){!b&&this.matrix||this.updateMatrixProperties();return OpenLayers.Layer.Grid.prototype.moveTo.apply(this,arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.WMTS(this.options));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getIdentifier:function(){return this.getServerZoom()},getMatrix:function(){var a;if(this.matrixIds&&0!==this.matrixIds.length)if("scaleDenominator"in this.matrixIds[0])for(var b=OpenLayers.METERS_PER_INCH*OpenLayers.INCHES_PER_UNIT[this.units]*
this.getServerResolution()/2.8E-4,c=Number.POSITIVE_INFINITY,d,e=0,f=this.matrixIds.length;e<f;++e)d=Math.abs(1-this.matrixIds[e].scaleDenominator/b),d<c&&(c=d,a=this.matrixIds[e]);else a=this.matrixIds[this.getIdentifier()];else a={identifier:this.getIdentifier()};return a},getTileInfo:function(a){var b=this.getServerResolution(),c=(a.lon-this.tileOrigin.lon)/(b*this.tileSize.w);a=(this.tileOrigin.lat-a.lat)/(b*this.tileSize.h);var b=Math.floor(c),d=Math.floor(a);return{col:b,row:d,i:Math.floor((c-
b)*this.tileSize.w),j:Math.floor((a-d)*this.tileSize.h)}},getURL:function(a){a=this.adjustBounds(a);var b="";if(!this.tileFullExtent||this.tileFullExtent.intersectsBounds(a)){a=a.getCenterLonLat();var c=this.getTileInfo(a);a=this.dimensions;var d,b=OpenLayers.Util.isArray(this.url)?this.selectUrl([this.version,this.style,this.matrixSet,this.matrix.identifier,c.row,c.col].join(),this.url):this.url;if("REST"===this.requestEncoding.toUpperCase())if(d=this.params,-1!==b.indexOf("{")){b=b.replace(/\{/g,
"${");c={style:this.style,Style:this.style,TileMatrixSet:this.matrixSet,TileMatrix:this.matrix.identifier,TileRow:c.row,TileCol:c.col};if(a){var e,f;for(f=a.length-1;0<=f;--f)e=a[f],c[e]=d[e.toUpperCase()]}b=OpenLayers.String.format(b,c)}else{e=this.version+"/"+this.layer+"/"+this.style+"/";if(a)for(f=0;f<a.length;f++)d[a[f]]&&(e=e+d[a[f]]+"/");e=e+this.matrixSet+"/"+this.matrix.identifier+"/"+c.row+"/"+c.col+"."+this.formatSuffix;b.match(/\/$/)||(b+="/");b+=e}else"KVP"===this.requestEncoding.toUpperCase()&&
(d={SERVICE:"WMTS",REQUEST:"GetTile",VERSION:this.version,LAYER:this.layer,STYLE:this.style,TILEMATRIXSET:this.matrixSet,TILEMATRIX:this.matrix.identifier,TILEROW:c.row,TILECOL:c.col,FORMAT:this.format},b=OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,[d]))}return b},mergeNewParams:function(a){if("KVP"===this.requestEncoding.toUpperCase())return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,[OpenLayers.Util.upperCaseObject(a)])},CLASS_NAME:"OpenLayers.Layer.WMTS"});OpenLayers.Protocol.SOS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol,{fois:null,formatOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);a.format||(this.format=new OpenLayers.Format.SOSGetFeatureOfInterest(this.formatOptions))},destroy:function(){this.options&&!this.options.format&&this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,this.options||
{});var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.format,c=OpenLayers.Format.XML.prototype.write.apply(c,[c.writeNode("sos:GetFeatureOfInterest",{fois:this.fois})]);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),data:c});return b},handleRead:function(a,b){if(b.callback){var c=a.priv;200<=c.status&&300>c.status?(a.features=this.parseFeatures(c),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE;
b.callback.call(b.scope,a)}},parseFeatures:function(a){var b=a.responseXML;b&&b.documentElement||(b=a.responseText);return!b||0>=b.length?null:this.format.read(b)},CLASS_NAME:"OpenLayers.Protocol.SOS.v1_0_0"});OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{jpeg:"jpg",gif:"gif",png:"png",png8:"png",png24:"png",dithered:"png"},DEFAULT_FORMAT:"jpeg",initialize:function(a,b,c,d){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments);this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||this.DEFAULT_FORMAT]},getURL:function(a){a=this.adjustBounds(a);var b=this.map.getResolution(),c=Math.round(1E4*this.map.getScale())/1E4,d=Math.round(a.left/b);a=
-Math.round(a.top/b);var b=Math.floor(d/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w,e=Math.floor(a/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h,c=["/",this.params.map,"/",c,"/",this.params.g.replace(/\s/g,"_"),"/def/t",e,"/l",b,"/t",a,"l",d,".",this.extension],d=this.url;OpenLayers.Util.isArray(d)&&(d=this.selectUrl(c.join(""),d));return d+c.join("")},CLASS_NAME:"OpenLayers.Layer.KaMapCache"});OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",initialize:function(a){OpenLayers.Protocol.WFS.v1.prototype.initialize.apply(this,arguments);this.outputFormat&&!this.readFormat&&("gml2"==this.outputFormat.toLowerCase()?this.readFormat=new OpenLayers.Format.GML.v2({featureType:this.featureType,featureNS:this.featureNS,geometryName:this.geometryName}):"json"==this.outputFormat.toLowerCase()&&(this.readFormat=new OpenLayers.Format.GeoJSON))},CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"});OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){b.srs[this.getChildValue(a)]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"});OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1_1,{version:"1.1.1",profile:"WMSC",readers:{wms:OpenLayers.Util.applyDefaults({VendorSpecificCapabilities:function(a,b){b.vendorSpecific={tileSets:[]};this.readChildNodes(a,b.vendorSpecific)},TileSet:function(a,b){var c={srs:{},bbox:{},resolutions:[]};this.readChildNodes(a,c);b.tileSets.push(c)},Resolutions:function(a,b){for(var c=this.getChildValue(a).split(" "),d=0,e=c.length;d<e;d++)""!=c[d]&&b.resolutions.push(parseFloat(c[d]))},
Width:function(a,b){b.width=parseInt(this.getChildValue(a))},Height:function(a,b){b.height=parseInt(this.getChildValue(a))},Layers:function(a,b){b.layers=this.getChildValue(a)},Styles:function(a,b){b.styles=this.getChildValue(a)}},OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC"});OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:!0,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.layerStates=[]},destroy:function(){this.clearLayersArray("base");this.clearLayersArray("data");this.map.events.un({buttonclick:this.onButtonClick,addlayer:this.redraw,changelayer:this.redraw,
removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):
this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(){OpenLayers.Control.prototype.draw.apply(this);this.loadContents();this.outsideViewport||this.minimizeControl();this.redraw();return this.div},onButtonClick:function(a){a=a.buttonElement;a===this.minimizeDiv?this.minimizeControl():a===this.maximizeDiv?this.maximizeControl():a._layerSwitcher===this.id&&(a["for"]&&(a=document.getElementById(a["for"])),a.disabled||("radio"==a.type?(a.checked=!0,this.map.setBaseLayer(this.map.getLayer(a._layer))):
(a.checked=!a.checked,this.updateMap())))},clearLayersArray:function(a){this[a+"LayersDiv"].innerHTML="";this[a+"Layers"]=[]},checkRedraw:function(){if(!this.layerStates.length||this.map.layers.length!=this.layerStates.length)return!0;for(var a=0,b=this.layerStates.length;a<b;a++){var c=this.layerStates[a],d=this.map.layers[a];if(c.name!=d.name||c.inRange!=d.inRange||c.id!=d.id||c.visibility!=d.visibility)return!0}return!1},redraw:function(){if(!this.checkRedraw())return this.div;this.clearLayersArray("base");
this.clearLayersArray("data");var a=!1,b=!1,c=this.map.layers.length;this.layerStates=Array(c);for(var d=0;d<c;d++){var e=this.map.layers[d];this.layerStates[d]={name:e.name,visibility:e.visibility,inRange:e.inRange,id:e.id}}var f=this.map.layers.slice();this.ascending||f.reverse();d=0;for(c=f.length;d<c;d++){var e=f[d],g=e.isBaseLayer;if(e.displayInLayerSwitcher){g?b=!0:a=!0;var h=g?e==this.map.baseLayer:e.getVisibility(),k=document.createElement("input"),l=OpenLayers.Util.createUniqueID(this.id+
"_input_");k.id=l;k.name=g?this.id+"_baseLayers":e.name;k.type=g?"radio":"checkbox";k.value=e.name;k.checked=h;k.defaultChecked=h;k.className="olButton";k._layer=e.id;k._layerSwitcher=this.id;g||e.inRange||(k.disabled=!0);h=document.createElement("label");h["for"]=k.id;OpenLayers.Element.addClass(h,"labelSpan olButton");h._layer=e.id;h._layerSwitcher=this.id;g||e.inRange||(h.style.color="gray");h.innerHTML=e.name;h.style.verticalAlign=g?"bottom":"baseline";l=document.createElement("br");(g?this.baseLayers:
this.dataLayers).push({layer:e,inputElem:k,labelSpan:h});e=g?this.baseLayersDiv:this.dataLayersDiv;e.appendChild(k);e.appendChild(h);e.appendChild(l)}}this.dataLbl.style.display=a?"":"none";this.baseLbl.style.display=b?"":"none";return this.div},updateMap:function(){for(var a=0,b=this.baseLayers.length;a<b;a++){var c=this.baseLayers[a];c.inputElem.checked&&this.map.setBaseLayer(c.layer,!1)}a=0;for(b=this.dataLayers.length;a<b;a++)c=this.dataLayers[a],c.layer.setVisibility(c.inputElem.checked)},maximizeControl:function(a){this.div.style.width=
"";this.div.style.height="";this.showControls(!1);null!=a&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.div.style.width="0px";this.div.style.height="0px";this.showControls(!0);null!=a&&OpenLayers.Event.stop(a)},showControls:function(a){this.maximizeDiv.style.display=a?"":"none";this.minimizeDiv.style.display=a?"none":"";this.layersDiv.style.display=a?"none":""},loadContents:function(){this.layersDiv=document.createElement("div");this.layersDiv.id=this.id+"_layersDiv";OpenLayers.Element.addClass(this.layersDiv,
"layersDiv");this.baseLbl=document.createElement("div");this.baseLbl.innerHTML=OpenLayers.i18n("Base Layer");OpenLayers.Element.addClass(this.baseLbl,"baseLbl");this.baseLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.baseLayersDiv,"baseLayersDiv");this.dataLbl=document.createElement("div");this.dataLbl.innerHTML=OpenLayers.i18n("Overlays");OpenLayers.Element.addClass(this.dataLbl,"dataLbl");this.dataLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.dataLayersDiv,
"dataLayersDiv");this.ascending?(this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv),this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv)):(this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv),this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv));this.div.appendChild(this.layersDiv);var a=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=
OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,null,a,"absolute");OpenLayers.Element.addClass(this.maximizeDiv,"maximizeDiv olButton");this.maximizeDiv.style.display="none";this.div.appendChild(this.maximizeDiv);a=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,null,a,"absolute");OpenLayers.Element.addClass(this.minimizeDiv,"minimizeDiv olButton");this.minimizeDiv.style.display=
"none";this.div.appendChild(this.minimizeDiv)},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"});OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{atom:"http://www.w3.org/2005/Atom",georss:"http://www.georss.org/georss"},feedTitle:"untitled",defaultEntryTitle:"untitled",gmlParser:null,xy:!1,read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));return this.parseFeatures(a)},write:function(a){var b;if(OpenLayers.Util.isArray(a)){b=this.createElementNSPlus("atom:feed");b.appendChild(this.createElementNSPlus("atom:title",{value:this.feedTitle}));
for(var c=0,d=a.length;c<d;c++)b.appendChild(this.buildEntryNode(a[c]))}else b=this.buildEntryNode(a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},buildContentNode:function(a){var b=this.createElementNSPlus("atom:content",{attributes:{type:a.type||null}});if(a.src)b.setAttribute("src",a.src);else if("text"==a.type||null==a.type)b.appendChild(this.createTextNode(a.value));else if("html"==a.type){if("string"!=typeof a.value)throw"HTML content must be in form of an escaped string";b.appendChild(this.createTextNode(a.value))}else"xhtml"==
a.type?b.appendChild(a.value):"xhtml"==a.type||a.type.match(/(\+|\/)xml$/)?b.appendChild(a.value):b.appendChild(this.createTextNode(a.value));return b},buildEntryNode:function(a){var b=a.attributes,c=b.atom||{},d=this.createElementNSPlus("atom:entry");if(c.authors)for(var e=OpenLayers.Util.isArray(c.authors)?c.authors:[c.authors],f=0,g=e.length;f<g;f++)d.appendChild(this.buildPersonConstructNode("author",e[f]));if(c.categories)for(var e=OpenLayers.Util.isArray(c.categories)?c.categories:[c.categories],
h,f=0,g=e.length;f<g;f++)h=e[f],d.appendChild(this.createElementNSPlus("atom:category",{attributes:{term:h.term,scheme:h.scheme||null,label:h.label||null}}));c.content&&d.appendChild(this.buildContentNode(c.content));if(c.contributors)for(e=OpenLayers.Util.isArray(c.contributors)?c.contributors:[c.contributors],f=0,g=e.length;f<g;f++)d.appendChild(this.buildPersonConstructNode("contributor",e[f]));a.fid&&d.appendChild(this.createElementNSPlus("atom:id",{value:a.fid}));if(c.links)for(e=OpenLayers.Util.isArray(c.links)?
c.links:[c.links],f=0,g=e.length;f<g;f++)h=e[f],d.appendChild(this.createElementNSPlus("atom:link",{attributes:{href:h.href,rel:h.rel||null,type:h.type||null,hreflang:h.hreflang||null,title:h.title||null,length:h.length||null}}));c.published&&d.appendChild(this.createElementNSPlus("atom:published",{value:c.published}));c.rights&&d.appendChild(this.createElementNSPlus("atom:rights",{value:c.rights}));(c.summary||b.description)&&d.appendChild(this.createElementNSPlus("atom:summary",{value:c.summary||
b.description}));d.appendChild(this.createElementNSPlus("atom:title",{value:c.title||b.title||this.defaultEntryTitle}));c.updated&&d.appendChild(this.createElementNSPlus("atom:updated",{value:c.updated}));a.geometry&&(b=this.createElementNSPlus("georss:where"),b.appendChild(this.buildGeometryNode(a.geometry)),d.appendChild(b));return d},initGmlParser:function(){this.gmlParser=new OpenLayers.Format.GML.v3({xy:this.xy,featureNS:"http://example.com#feature",internalProjection:this.internalProjection,
externalProjection:this.externalProjection})},buildGeometryNode:function(a){this.gmlParser||this.initGmlParser();return this.gmlParser.writeNode("feature:_geometry",a).firstChild},buildPersonConstructNode:function(a,b){var c=["uri","email"],d=this.createElementNSPlus("atom:"+a);d.appendChild(this.createElementNSPlus("atom:name",{value:b.name}));for(var e=0,f=c.length;e<f;e++)b[c[e]]&&d.appendChild(this.createElementNSPlus("atom:"+c[e],{value:b[c[e]]}));return d},getFirstChildValue:function(a,b,c,
d){return(a=this.getElementsByTagNameNS(a,b,c))&&0<a.length?this.getChildValue(a[0],d):d},parseFeature:function(a){var b={},c=null,d=null,e=null,f=this.namespaces.atom;this.parsePersonConstructs(a,"author",b);d=this.getElementsByTagNameNS(a,f,"category");0<d.length&&(b.categories=[]);for(var g=0,h=d.length;g<h;g++){c={};c.term=d[g].getAttribute("term");if(e=d[g].getAttribute("scheme"))c.scheme=e;if(e=d[g].getAttribute("label"))c.label=e;b.categories.push(c)}d=this.getElementsByTagNameNS(a,f,"content");
if(0<d.length){c={};if(e=d[0].getAttribute("type"))c.type=e;(e=d[0].getAttribute("src"))?c.src=e:("text"==c.type||"html"==c.type||null==c.type?c.value=this.getFirstChildValue(a,f,"content",null):"xhtml"==c.type||c.type.match(/(\+|\/)xml$/)?c.value=this.getChildEl(d[0]):c.value=this.getFirstChildValue(a,f,"content",null),b.content=c)}this.parsePersonConstructs(a,"contributor",b);b.id=this.getFirstChildValue(a,f,"id",null);d=this.getElementsByTagNameNS(a,f,"link");0<d.length&&(b.links=Array(d.length));
for(var k=["rel","type","hreflang","title","length"],g=0,h=d.length;g<h;g++){c={};c.href=d[g].getAttribute("href");for(var l=0,m=k.length;l<m;l++)(e=d[g].getAttribute(k[l]))&&(c[k[l]]=e);b.links[g]=c}if(c=this.getFirstChildValue(a,f,"published",null))b.published=c;if(c=this.getFirstChildValue(a,f,"rights",null))b.rights=c;if(c=this.getFirstChildValue(a,f,"summary",null))b.summary=c;b.title=this.getFirstChildValue(a,f,"title",null);b.updated=this.getFirstChildValue(a,f,"updated",null);c={title:b.title,
description:b.summary,atom:b};a=this.parseLocations(a)[0];a=new OpenLayers.Feature.Vector(a,c);a.fid=b.id;return a},parseFeatures:function(a){var b=[],c=this.getElementsByTagNameNS(a,this.namespaces.atom,"entry");0==c.length&&(c=[a]);a=0;for(var d=c.length;a<d;a++)b.push(this.parseFeature(c[a]));return b},parseLocations:function(a){var b=this.namespaces.georss,c={components:[]},d=this.getElementsByTagNameNS(a,b,"where");if(d&&0<d.length){this.gmlParser||this.initGmlParser();for(var e=0,f=d.length;e<
f;e++)this.gmlParser.readChildNodes(d[e],c)}c=c.components;if((d=this.getElementsByTagNameNS(a,b,"point"))&&0<d.length)for(e=0,f=d.length;e<f;e++){var g=OpenLayers.String.trim(d[e].firstChild.nodeValue).split(/\s+/);2!=g.length&&(g=OpenLayers.String.trim(d[e].firstChild.nodeValue).split(/\s*,\s*/));c.push(new OpenLayers.Geometry.Point(g[1],g[0]))}var h=this.getElementsByTagNameNS(a,b,"line");if(h&&0<h.length)for(var k,e=0,f=h.length;e<f;e++){d=OpenLayers.String.trim(h[e].firstChild.nodeValue).split(/\s+/);
k=[];for(var l=0,m=d.length;l<m;l+=2)g=new OpenLayers.Geometry.Point(d[l+1],d[l]),k.push(g);c.push(new OpenLayers.Geometry.LineString(k))}if((a=this.getElementsByTagNameNS(a,b,"polygon"))&&0<a.length)for(e=0,f=a.length;e<f;e++){d=OpenLayers.String.trim(a[e].firstChild.nodeValue).split(/\s+/);k=[];l=0;for(m=d.length;l<m;l+=2)g=new OpenLayers.Geometry.Point(d[l+1],d[l]),k.push(g);c.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(k)]))}if(this.internalProjection&&this.externalProjection)for(e=
0,f=c.length;e<f;e++)c[e]&&c[e].transform(this.externalProjection,this.internalProjection);return c},parsePersonConstructs:function(a,b,c){var d=[],e=this.namespaces.atom;a=this.getElementsByTagNameNS(a,e,b);for(var f=["uri","email"],g=0,h=a.length;g<h;g++){var k={};k.name=this.getFirstChildValue(a[g],e,"name",null);for(var l=0,m=f.length;l<m;l++){var n=this.getFirstChildValue(a[g],e,f[l],null);n&&(k[f[l]]=n)}d.push(k)}0<d.length&&(c[b+"s"]=d)},CLASS_NAME:"OpenLayers.Format.Atom"});OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,slideFactor:75,observeElement:null,draw:function(){this.handler=new OpenLayers.Handler.Keyboard(this,{keydown:this.defaultKeyPress},{observeElement:this.observeElement||document})},defaultKeyPress:function(a){var b,c=!0;b=OpenLayers.Event.element(a);if(!b||"INPUT"!=b.tagName&&"TEXTAREA"!=b.tagName&&"SELECT"!=b.tagName){switch(a.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,
0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:b=this.map.getSize();this.map.pan(0,-0.75*b.h);break;case 34:b=this.map.getSize();this.map.pan(0,0.75*b.h);break;case 35:b=this.map.getSize();this.map.pan(0.75*b.w,0);break;case 36:b=this.map.getSize();this.map.pan(-0.75*b.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();
break;default:c=!1}c&&OpenLayers.Event.stop(a)}},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"});OpenLayers.Format.WMTSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0,{version:"1.0.0",namespaces:{ows:"http://www.opengis.net/ows/1.1",wmts:"http://www.opengis.net/wmts/1.0",xlink:"http://www.w3.org/1999/xlink"},yx:null,defaultPrefix:"wmts",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a;a=OpenLayers.Util.extend({},OpenLayers.Format.WMTSCapabilities.prototype.yx);this.yx=OpenLayers.Util.extend(a,this.yx)},read:function(a){"string"==
typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);b.version=this.version;return b},readers:{wmts:{Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,b){b.contents={};b.contents.layers=[];b.contents.tileMatrixSets={};this.readChildNodes(a,b.contents)},Layer:function(a,b){var c={styles:[],formats:[],dimensions:[],tileMatrixSetLinks:[],layers:[]};this.readChildNodes(a,c);b.layers.push(c)},Style:function(a,
b){var c={};c.isDefault="true"===a.getAttribute("isDefault");this.readChildNodes(a,c);b.styles.push(c)},Format:function(a,b){b.formats.push(this.getChildValue(a))},TileMatrixSetLink:function(a,b){var c={};this.readChildNodes(a,c);b.tileMatrixSetLinks.push(c)},TileMatrixSet:function(a,b){if(b.layers){var c={matrixIds:[]};this.readChildNodes(a,c);b.tileMatrixSets[c.identifier]=c}else b.tileMatrixSet=this.getChildValue(a)},TileMatrix:function(a,b){var c={supportedCRS:b.supportedCRS};this.readChildNodes(a,
c);b.matrixIds.push(c)},ScaleDenominator:function(a,b){b.scaleDenominator=parseFloat(this.getChildValue(a))},TopLeftCorner:function(a,b){var c=this.getChildValue(a).split(" "),d;b.supportedCRS&&(d=b.supportedCRS.replace(/urn:ogc:def:crs:(\w+):.+:(\w+)$/,"urn:ogc:def:crs:$1::$2"),d=!!this.yx[d]);b.topLeftCorner=d?new OpenLayers.LonLat(c[1],c[0]):new OpenLayers.LonLat(c[0],c[1])},TileWidth:function(a,b){b.tileWidth=parseInt(this.getChildValue(a))},TileHeight:function(a,b){b.tileHeight=parseInt(this.getChildValue(a))},
MatrixWidth:function(a,b){b.matrixWidth=parseInt(this.getChildValue(a))},MatrixHeight:function(a,b){b.matrixHeight=parseInt(this.getChildValue(a))},ResourceURL:function(a,b){b.resourceUrl=b.resourceUrl||{};var c=a.getAttribute("resourceType");b.resourceUrls||(b.resourceUrls=[]);c=b.resourceUrl[c]={format:a.getAttribute("format"),template:a.getAttribute("template"),resourceType:c};b.resourceUrls.push(c)},WSDL:function(a,b){b.wsdl={};b.wsdl.href=a.getAttribute("xlink:href")},ServiceMetadataURL:function(a,
b){b.serviceMetadataUrl={};b.serviceMetadataUrl.href=a.getAttribute("xlink:href")},LegendURL:function(a,b){b.legend={};b.legend.href=a.getAttribute("xlink:href");b.legend.format=a.getAttribute("format")},Dimension:function(a,b){var c={values:[]};this.readChildNodes(a,c);b.dimensions.push(c)},Default:function(a,b){b["default"]=this.getChildValue(a)},Value:function(a,b){b.values.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities.v1_0_0"});
 
TRACK_CONSTANTS={IMG_PATH:"img/",POINTER_IMGS:{blue:'pointer_blue.png',red:'pointer_red.png',green:'pointer_green.png'},STOP_IMGS:{blue:'dot_blue.png',red:'dot_red.png',green:'dot_green.png'},DEF_THEME:"blue",FOUND_ZOOM:15,INI_ZOOM:10,MARKER_IMGS:{blue:'marker-blue.png',red:'marker-red.png',green:'marker-green.png'}} 
function NMEAStrToDegree(str){var DEGREE_DIGITS=2;var deg,min;if(str.length){str_source=str;while((str_source.substr(0,1)=='0')&&(str_source.length)){str_source=str_source.slice(1);}
if(!str_source.isNaN){deg=parseFloat(str_source.substr(0,DEGREE_DIGITS));}
if(str_source.length>DEGREE_DIGITS){str_source=str_source.slice(DEGREE_DIGITS);while((str_source.substr(0,1)=='0')&&(str_source.length)){str_source=str_source.slice(1);}
if(!str_source.isNaN)
var min=parseFloat(str_source);return deg+min/60.0;}}}
function ObjMapLayer(map,descr,defStyle){defStyle=defStyle||OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style['default']);var tmpStyle=OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style['temporary']);var styleMap=new OpenLayers.StyleMap({"default":defStyle,"temporary":tmpStyle});this.layer=new OpenLayers.Layer.Vector(descr,{styleMap:styleMap});this.map=map;this.map.addLayer(this.layer);}
ObjMapLayer.prototype.removeLayer=function(){this.map.removeLayer(this.layer);}
ObjMapLayer.prototype.getStyle=function(marker){var style_mark=OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style['default']);if(marker.image){var scale=((marker.imageScale==undefined)||(marker.imageScale<=0))?1:marker.imageScale;var img=new Image();img.src=marker.image;style_mark.externalGraphic=marker.image;if(scale!=1){style_mark.graphicHeight=Math.round(img.height*scale);style_mark.graphicWidth=Math.round(img.width*scale);}}
if(marker.getHint){style_mark.graphicTitle=marker.getHint();}
style_mark.rotation=(marker.imageRotate&&marker.heading>0)?marker.heading:0;return(style_mark);}
ObjMapLayer.prototype.removeFromLayer=function(featureArray){this.layer.removeFeatures(featureArray);}
ObjMapLayer.prototype.getMapPoint=function(lon,lat){return new OpenLayers.Geometry.Point(lon,lat).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());}
ObjMapLayer.prototype.getMapPointFromStr=function(lon,lat){return this.getMapPoint(NMEAStrToDegree(lon),NMEAStrToDegree(lat));}
ObjMapLayer.prototype.getLonLatPoint=function(lon,lat){return new OpenLayers.LonLat(lon,lat).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());}
ObjMapLayer.prototype.getLonLatPointFromStr=function(lon,lat){return this.getLonLatPoint(NMEAStrToDegree(lon),NMEAStrToDegree(lat));}
ObjMapLayer.prototype.moveMapToCoords=function(lon,lat,zoom){this.map.setCenter(new OpenLayers.LonLat(lon,lat).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject()),zoom);}
ObjMapLayer.prototype.moveMapToStrCoords=function(lon,lat,zoom){this.moveMapToCoords(NMEAStrToDegree(lon),NMEAStrToDegree(lat),zoom);} 
function GeoZones(options){this.m_drawComplete=options.drawComplete;options.featureOptions=options.featureOptions||{};GeoZones.superclass.constructor.call(this,options.map,options.objDescr);var self=this;if(options.points&&options.points.length){this.drawZoneOnCoords(options.points);}
if(options.doDraw){this.addDrawSupport(options);}}
extend(GeoZones,ObjMapLayer);GeoZones.prototype.m_drawControl;GeoZones.prototype.m_dragControl;GeoZones.prototype.m_polygonFeature;GeoZones.prototype.m_drawComplete;GeoZones.prototype.addDrawSupport=function(options){var self=this;this.m_drawControl=new OpenLayers.Control.DrawFeature(this.layer,options.featureType,{handlerOptions:options.featureOptions});this.map.addControl(this.m_drawControl);this.m_dragControl=new OpenLayers.Control.DragFeature(this.layer,{"onComplete":function(feature,pixel){self.drawComplete(feature,"drag");}});this.map.addControl(this.m_dragControl);this.layer.events.on({featuresadded:function(event){self.drawComplete(event.features[0],"draw");}});}
GeoZones.prototype.drawZoneOnCoords=function(points){if(points.length%2!=0){return;}
var pointList=[];for(var i=0;i<points.length;i+=2){pointList.push(this.getMapPoint(points[i],points[i+1]));}
var linearRing=new OpenLayers.Geometry.LinearRing(pointList);this.m_polygonFeature=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([linearRing]));this.layer.addFeatures(this.m_polygonFeature);}
GeoZones.prototype.activateDrawing=function(){this.deleteZone();this.enableDrawing(true);this.m_dragControl.deactivate();}
GeoZones.prototype.activateNavigation=function(){this.enableDrawing(false);this.m_dragControl.deactivate();}
GeoZones.prototype.activateDragging=function(){this.enableDrawing(false);this.m_dragControl.activate();}
GeoZones.prototype.enableDrawing=function(en){if(en){this.m_drawControl.activate();}
else{this.m_drawControl.deactivate();}}
GeoZones.prototype.makeBigger=function(){alert("bigger");}
GeoZones.prototype.makeSmaller=function(){alert("smaller");}
GeoZones.prototype.deleteZone=function(){this.layer.removeAllFeatures();if(this.m_drawComplete){this.m_drawComplete("");}}
GeoZones.prototype.drawComplete=function(feature,evType){var vertices=feature.geometry.getVertices();var coords_str="";for(var i=0;i<vertices.length;i++){var point=new OpenLayers.Geometry.Point(vertices[i]["x"],vertices[i]["y"]).transform(this.map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326"));coords_str+=(coords_str=="")?"":",";coords_str+=point["x"]+" "+point["y"];}
if(this.m_drawComplete){this.m_drawComplete(coords_str);}} 
function MarkerLayer(options){this.CURRENT_THEME=options.theme||TRACK_CONSTANTS.DEF_THEME;MarkerLayer.superclass.constructor.call(this,options);var self=this;this.m_evClick=function(e){var position=self.map.getLonLatFromPixel(e.xy);var feature=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(position.lon,position.lat),null,self.getMarkerStyle());self.layer.removeAllFeatures();self.layer.addFeatures([feature]);};}
extend(MarkerLayer,GeoZones);MarkerLayer.prototype.getMarkerStyle=function(){var style_mark=OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style['default']);style_mark.fillOpacity=1;style_mark.graphicOpacity=1;style_mark.graphicWidth=30;style_mark.graphicHeight=30;style_mark.externalGraphic=TRACK_CONSTANTS.IMG_PATH+TRACK_CONSTANTS.MARKER_IMGS[this.CURRENT_THEME];return style_mark;}
MarkerLayer.prototype.drawZoneOnCoords=function(points){if(points.length%2!=0){return;}
var feature=new OpenLayers.Feature.Vector(this.getMapPoint(points[0],points[1]),null,this.getMarkerStyle());this.layer.removeAllFeatures();this.layer.addFeatures([feature]);}
MarkerLayer.prototype.addDrawSupport=function(options){var self=this;this.m_dragControl=new OpenLayers.Control.DragFeature(this.layer,{"onComplete":function(feature,pixel){self.drawComplete(feature,"drag");}});this.map.addControl(this.m_dragControl);this.layer.events.on({featuresadded:function(event){self.drawComplete(event.features[0],"draw");}});this.enableDrawing(true);}
MarkerLayer.prototype.enableDrawing=function(en){if(en){this.map.events.register("click",null,this.m_evClick);}
else{this.map.events.unregister("click",null,this.m_evClick);}} 
function DrawingControl(id,options){options=options||{};this.m_onNavigate=options.onNavigate;this.m_onDraw=options.onDraw;this.m_onDrag=options.onDrag;this.m_onDelete=options.onDelete;DrawingControl.superclass.constructor.call(this,id,"div");this.m_group=new EditRadioGroup(id+"_control_group");this.addMoveControl();this.addDrawControl();this.addDragControl();this.addDeleteControl();this.addElement(this.m_group);}
extend(DrawingControl,ControlContainer);DrawingControl.prototype.DEL_CAPTION="Удалить";DrawingControl.prototype.DRAG_CAPTION="Перетащить";DrawingControl.prototype.DRAW_CAPTION="Рисовать";DrawingControl.prototype.MAVE_CAPTION="Перемещать карту";DrawingControl.prototype.addMoveControl=function(){var self=this;var id=this.getId();var ctrl=new EditRadio(id+"_navigate",{"descr":this.MAVE_CAPTION,"name":"map_contr","contClassName":"form-group "+get_bs_col()+"3","attrs":{"checked":"checked","id":id+"_navigate"},"events":{"click":function(){self.m_onNavigate();}}});this.m_group.addElement(ctrl);}
DrawingControl.prototype.addDragControl=function(){var self=this;var id=this.getId();var ctrl=new EditRadio(id+"_drag",{"descr":this.DRAG_CAPTION,"name":"map_contr","contClassName":"form-group "+get_bs_col()+"3","attrs":{"id":id+"_drag"},"events":{"click":function(){self.m_onDrag();}}});this.m_group.addElement(ctrl);}
DrawingControl.prototype.addDrawControl=function(){var self=this;var id=this.getId();var ctrl=new EditRadio(id+"_draw",{"descr":this.DRAW_CAPTION,"name":"map_contr","contClassName":"form-group "+get_bs_col()+"3","attrs":{"id":id+"_draw"},"events":{"click":function(){self.m_onDraw();}}});this.m_group.addElement(ctrl);}
DrawingControl.prototype.addDeleteControl=function(){var self=this;var id=this.getId();var ctrl=new Button(id+"_zone_delete",{"onClick":function(){self.m_onDelete();},"className":"btn btn-default "+get_bs_col()+"3","caption":this.DEL_CAPTION});this.m_group.addElement(ctrl);} 
function ZoneDrawingControl(id,options){ZoneDrawingControl.superclass.constructor.call(this,id,options);}
extend(ZoneDrawingControl,DrawingControl);ZoneDrawingControl.prototype.DEL_CAPTION="Удалить зону";ZoneDrawingControl.prototype.DRAG_CAPTION="Перетащить зону";ZoneDrawingControl.prototype.DRAW_CAPTION="Рисовать зону";ZoneDrawingControl.prototype.MAVE_CAPTION="Перемещать карту"; 
function MarkerSetControl(id,options){MarkerSetControl.superclass.constructor.call(this,id,options);}
extend(MarkerSetControl,DrawingControl);MarkerSetControl.prototype.DEL_CAPTION="Удалить маркер";MarkerSetControl.prototype.DRAG_CAPTION="Перетащить маркер";MarkerSetControl.prototype.DRAW_CAPTION="Установить маркер";MarkerSetControl.prototype.MAVE_CAPTION="Перемещать карту"; 
function VehicleLayer(map,options){options=options||{};VehicleLayer.superclass.constructor.call(this,map,this.LAYER_DESCR);this.m_vehicles=[];this.CURRENT_THEME=options.theme||TRACK_CONSTANTS.DEF_THEME;}
extend(VehicleLayer,ObjMapLayer);VehicleLayer.prototype.LAYER_DESCR="Объекты мониторинга";VehicleLayer.prototype.OBJ_POINTER_SCALE=1;VehicleLayer.prototype.TAIL_MARKER_CURSOR='pointer';VehicleLayer.prototype.TAIL_MARKER_OPACITY=1;VehicleLayer.prototype.TAIL_MARKER_POINT_RADIUS=12;VehicleLayer.prototype.CAR_MARKER_CURSOR='pointer';VehicleLayer.prototype.CAR_MARKER_OPACITY=0.7;VehicleLayer.prototype.CAR_CUR_MARKER_OPACITY=1;VehicleLayer.prototype.CAR_MARKER_POINT_RADIUS=12;VehicleLayer.prototype.flyToObjById=function(id,zoom){if(this.m_vehicles[id]==undefined){throw new Error('Object with id '+id+' not found!');}
this.moveMapToCoords(this.m_vehicles[id].head.lon,this.m_vehicles[id].head.lat,zoom||this.map.getZoom());}
VehicleLayer.prototype.addVehicle=function(mapMarker,tailMarkers,showPointer,current){var self=this;this.m_vehicles[mapMarker.id]={'head':mapMarker,'tail':tailMarkers,'pointerFeature':null,'currentObjFeature':null};var features=[];mapMarker.feature=new OpenLayers.Feature.Vector(this.getMapPoint(mapMarker.lon,mapMarker.lat),null,this.getCarStyle(mapMarker,current));mapMarker.feature.carId=mapMarker.id;features.push(mapMarker.feature);if(showPointer){this.m_vehicles[mapMarker.id].pointerFeature=new OpenLayers.Feature.Vector(this.getMapPoint(mapMarker.lon,mapMarker.lat),null,this.getPointerStyle(mapMarker.heading));features.push(this.m_vehicles[mapMarker.id].pointerFeature);}
if(current){this.setCurrentObj(mapMarker.id);}
if(tailMarkers!=undefined){for(var i=0;i<tailMarkers.length;i++){tailMarkers[i].feature=new OpenLayers.Feature.Vector(this.getMapPoint(tailMarkers[i].lon,tailMarkers[i].lat),null,this.getTailStyle(tailMarkers[i]));features.push(tailMarkers[i].feature);}}
this.layer.addFeatures(features);var onMarkerSelect=function(feature){if(feature.carId!=undefined){self.onCarSelect(feature.carId);}};var selectCtrl=new OpenLayers.Control.SelectFeature(this.layer,{hover:false,highlightOnly:false,renderIntent:"temporary",onSelect:onMarkerSelect});this.map.addControl(selectCtrl);selectCtrl.activate();}
VehicleLayer.prototype.removeVehicle=function(carMarkerId){if(this.m_vehicles[carMarkerId]!=undefined){var features=[];if(this.m_vehicles[carMarkerId].pointerFeature!=undefined){features.push(this.m_vehicles[carMarkerId].pointerFeature);}
if(this.m_vehicles[carMarkerId].head!=undefined){features.push(this.m_vehicles[carMarkerId].head.feature);}
if(this.m_vehicles[carMarkerId].tail!=undefined){for(var i=0;i<this.m_vehicles[carMarkerId].tail.length;i++){features.push(this.m_vehicles[carMarkerId].tail[i].feature);}}
this.removeFromLayer(features);if(this.m_vehicles[carMarkerId].tail!=undefined){for(var i=0;i<this.m_vehicles[carMarkerId].tail.length;i++){delete this.m_vehicles[carMarkerId].tail[i];}}
if(this.m_vehicles[carMarkerId].head!=undefined){delete this.m_vehicles[carMarkerId].head;}
if(this.m_vehicles[carMarkerId]!=undefined){delete this.m_vehicles[carMarkerId];}}}
VehicleLayer.prototype.getPointerStyle=function(direction){var style_mark=OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style['default']);if(this.OBJ_POINTER_SCALE!=1){var img=new Image();img.src=TRACK_CONSTANTS.IMG_PATH+TRACK_CONSTANTS.POINTER_IMGS[this.CURRENT_THEME];style_mark.graphicHeight=Math.round(img.height*this.OBJ_POINTER_SCALE);style_mark.graphicWidth=Math.round(img.width*this.OBJ_POINTER_SCALE);}
style_mark.externalGraphic=TRACK_CONSTANTS.IMG_PATH+TRACK_CONSTANTS.POINTER_IMGS[this.CURRENT_THEME];var x_offset,y_offset;if(direction<180){y_offset=-40;}
else{y_offset=-40;}
if(x_offset!=undefined){style_mark.graphicXOffset=x_offset;}
if(y_offset!=undefined){style_mark.graphicYOffset=y_offset;}
style_mark.rotation=direction;style_mark.graphicOpacity=this.CAR_MARKER_OPACITY;style_mark.pointRadius=this.CAR_MARKER_POINT_RADIUS;return(style_mark);}
VehicleLayer.prototype.getCarStyle=function(carMarker,current){var style_mark=this.getStyle(carMarker);style_mark.graphicOpacity=(current)?this.CAR_CUR_MARKER_OPACITY:this.CAR_MARKER_OPACITY;style_mark.cursor=this.CAR_MARKER_CURSOR;style_mark.label=carMarker.getLabel();if(style_mark.label!=undefined){style_mark.labelXOffset=14;style_mark.labelYOffset=14;style_mark.fontSize='12px';}
style_mark.pointRadius=this.CAR_MARKER_POINT_RADIUS;return(style_mark);}
VehicleLayer.prototype.getTailStyle=function(tailMarker){var style_mark=this.getStyle(tailMarker);style_mark.graphicOpacity=this.TAIL_MARKER_OPACITY;style_mark.cursor=this.TAIL_MARKER_CURSOR;style_mark.pointRadius=this.TAIL_MARKER_POINT_RADIUS;return(style_mark);}
VehicleLayer.prototype.setCurrentObj=function(id,zoom){if(this.m_vehicles[id]!=undefined){this.currentObj=id;this.flyToObjById(id,zoom);}}
VehicleLayer.prototype.removeAllVehicles=function(){for(var carMarkerId in this.m_vehicles){this.removeVehicle(carMarkerId);}} 
function MapCarMarker(attrs){for(var id in attrs){this[id]=attrs[id];}}
MapCarMarker.prototype.getHint=function(){return from_now_time_dif(DateHandler.dateObjFromSQL(this.period));}
MapCarMarker.prototype.getLabel=function(){return this.plate;}
MapCarMarker.prototype.getCallOut=function(){return'<div>!!!Checking!!!'+'</div>';}
function MapMoveMarker(attrs){for(var id in attrs){this[id]=attrs[id];}
this.image=TRACK_CONSTANTS.IMG_PATH+
TRACK_CONSTANTS.POINTER_IMGS[this.theme||TRACK_CONSTANTS.DEF_THEME];this.imageRotate=true;}
MapMoveMarker.prototype.getLabel=function(){if(this.showLabel&&this.ordNumber){return this.ordNumber;}}
MapMoveMarker.prototype.getHint=function(){return this.period_str+' ('+this.ordNumber+')';}
MapMoveMarker.prototype.getCallOut=function(){var addRow=function(name,val){return'<div class="call_out_row"><div class="call_out_cell">'+
name+':</div><div class="call_out_cell">'+val+'</div></div>';};res='<div class="call_out"><span class="call_out_header">Информация по точке</span>';res+=addRow('объект',this.plate);res+=addRow('направление',this.heading_str);res+=addRow('дата/время',this.period_str);res+=addRow('долгота',this.lon_str);res+=addRow('широта',this.lat_str);res+=addRow('скорость',this.speed+' км/ч');if(this.sensorFuelPresent){res+=addRow('уровень топлива',this.sensorFuelState);}
if(this.sensorEngPresent){res+=addRow('двигатель',this.engine_on_str);}
res+='</div>';return(res);}
function MapStopMarker(attrs){for(var id in attrs){this[id]=attrs[id];}
this.image=TRACK_CONSTANTS.IMG_PATH+
TRACK_CONSTANTS.STOP_IMGS["red"];this.imageRotate=false;}
extend(MapStopMarker,MapMoveMarker);function sec_dif_to_str(sec_dif){var days=0;var hours=0;var minutes=0;var secs=0;var minutes=Math.floor(sec_dif/60);if(minutes<60){secs=sec_dif-(minutes*60);}
else{hours=Math.floor(minutes/60);if(hours<60){minutes=minutes-(hours*60);secs=0;}
else{days=Math.floor(hours/24);hours=hours-(days*24);minutes=0;secs=0;}}
var res='';if(days>0){res=days+' дн.';}
if(hours>0){res+=(res=='')?'':' ';res+=hours+' чс.';}
if(minutes>0){res+=(res=='')?'':' ';res+=minutes+' мн.';}
if(secs>0){res+=(res=='')?'':' ';res+=secs+' сек.';}
return(res);}
function time_dif_to_str(dtime_start,dtime_end){return sec_dif_to_str(Math.floor((dtime_end.getTime()-dtime_start.getTime())/1000));}
function from_now_time_dif(dtime){var res=time_dif_to_str(dtime,new Date())+' назад';return(res);} 
function TrackLayer(map,options){options=options||{};var descr=(options.descr!=undefined)?this.LAYER_DESCR+options.descr:"маршрут";TrackLayer.superclass.constructor.call(this,map,descr);this.points=[];}
extend(TrackLayer,ObjMapLayer);TrackLayer.prototype.popUpWidth=200;TrackLayer.prototype.popUpHeight=100;TrackLayer.prototype.points;TrackLayer.prototype.popUp;TrackLayer.prototype.LAYER_DESCR='Путь для ';TrackLayer.prototype.clearMarkers=function(){var features=[];for(var i=0;i<this.points.length;i++){if(this.points[i].feature!=undefined){features.push(this.points[i].feature);}}
if(this.lineFeature!=undefined){features.push(this.lineFeature);}
if(features.length>0){this.removeFromLayer(features);}}
TrackLayer.prototype.getPointStyle=function(marker){var style_mark=this.getStyle(marker);style_mark.fillOpacity=1;style_mark.cursor='pointer';style_mark.labelXOffset=7;style_mark.labelYOffset=7;style_mark.fontSize='8px';return(style_mark);}
TrackLayer.prototype.addMarkers=function(markers){var self=this;this.clearMarkers();var features=[];this.points=markers;var line_style={strokeColor:"#0074FF",strokeWidth:2,pointRadius:6,pointerEvents:"visiblePainted"};var pointList=[];var point;for(var i=0;i<this.points.length;i++){point=this.getMapPoint(this.points[i].lon,this.points[i].lat);this.points[i].feature=new OpenLayers.Feature.Vector(point,null,this.getPointStyle(this.points[i]));pointList.push(point);this.points[i].feature.repId=i;features.push(this.points[i].feature);}
this.layer.addFeatures(features);this.lineFeature=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(pointList),null,line_style);this.layer.addFeatures(this.lineFeature);var onDataSelect=function(feature){if(feature.repId!=undefined){var popup=new OpenLayers.Popup.FramedCloud("repPointData",feature.geometry.getBounds().getCenterLonLat(),null,self.points[feature.repId].getCallOut(),null,true);feature.popup=popup;self.map.addPopup(popup);}};var onDataUnSelect=function(feature){if(feature.repId!=undefined){self.map.removePopup(feature.popup);feature.popup.destroy();feature.popup=null;}};var selectCtrl=new OpenLayers.Control.SelectFeature(this.layer,{hover:false,toggle:true,clickout:true,highlightOnly:false,renderIntent:"temporary",onSelect:onDataSelect,onUnselect:onDataUnSelect});this.map.addControl(selectCtrl);selectCtrl.activate();}
TrackLayer.prototype.flyToInd=function(ind){if(this.points!=undefined&&ind<this.points.length){var lonLat=this.getLonLatPoint(this.points[ind].lon,this.points[ind].lat);if(lonLat!=undefined){this.map.setCenter(lonLat,this.map.getZoom());}}}
TrackLayer.prototype.flyToStart=function(){this.flyToInd(0);}
TrackLayer.prototype.flyToEnd=function(){if(this.points!=undefined){this.flyToInd(this.points.length-1);}}
TrackLayer.prototype.zoomToCenter=function(xMax,xMin,yMax,yMin){this.map.setCenter(this.getLonLatPoint((xMax-xMin)/2,(yMax-yMin)/2),this.map.getZoom());var bounds=new OpenLayers.Bounds();bounds.extend(this.getLonLatPoint(xMax,yMax));bounds.extend(this.getLonLatPoint(xMin,yMin));bounds.toBBOX();this.map.zoomToExtent(bounds,true);} 
function Map_View(id,options){this.m_mapHeight=options.mapHeight||"500";this.m_mapWidth=options.mapWidth||(getViewportWidth()-10);this.CURRENT_THEME=options.theme||TRACK_CONSTANTS.DEF_THEME;Map_View.superclass.constructor.call(this,id,options);}
extend(Map_View,ViewDialog);Map_View.prototype.m_map;Map_View.prototype.m_layer;Map_View.prototype.m_zones;Map_View.prototype.map_control;Map_View.prototype.addMapControl=function(){this.map_control=new Control("map","div",{attrs:{style:"width:"+this.m_mapWidth+"px;height:"+this.m_mapHeight+"px;"}});this.addControl(this.map_control);}
Map_View.prototype.addFeatureControl=function(){}
Map_View.prototype.onGetData=function(resp){Map_View.superclass.onGetData.call(this,resp,this.m_isCopy);if(this.map_control){this.addFeatures();}}
Map_View.prototype.toDOM=function(parent){Map_View.superclass.toDOM.call(this,parent);if(this.map_control){var self=this;this.m_map=new OpenLayers.Map(this.map_control.m_node,{"controls":[]});this.map_control.setAttr("style","");this.m_layer=new OpenLayers.Layer.OSM();this.m_map.addLayer(this.m_layer);var zoom_bar=new OpenLayers.Control.PanZoomBar();this.m_map.addControl(zoom_bar);this.m_map.addControl(new OpenLayers.Control.LayerSwitcher());this.m_map.addControl(new OpenLayers.Control.ScaleLine());this.m_map.addControl(new OpenLayers.Control.Navigation());var controls=this.m_map.getControlsByClass('OpenLayers.Control.Navigation');for(var i=0;i<controls.length;++i){controls[i].disableZoomWheel();}
this.addFeatures();}}
Map_View.prototype.addFeatures=function(){} 
function MapZones_View(id,options){MapZones_View.superclass.constructor.call(this,id,options);}
extend(MapZones_View,Map_View);MapZones_View.prototype.addFeatureControl=function(){var self=this;this.m_zoneDrawing=new ZoneDrawingControl("map_drawing",{"onNavigate":function(){self.m_zones.activateNavigation();},"onDrag":function(){self.m_zones.activateDragging();},"onDraw":function(){self.m_zones.activateDrawing();},"onDelete":function(){self.m_zones.deleteZone();}});this.addControl(this.m_zoneDrawing);}
MapZones_View.prototype.addFeatures=function(){if(this.m_ctrlZoneStr){var zone_str=this.m_ctrlZoneStr.getAttr("old_zone");zone_str=(zone_str==undefined)?"":zone_str;zone_str=zone_str.split(" ").join(",");var zone_points=zone_str.split(",");zone_points.splice(zone_points.length-2,2);var self=this;this.m_zones=new GeoZones({"map":this.m_map,"objDescr":this.getZoneDescr(),"points":zone_points,"doDraw":true,"drawComplete":function(coordsStr){self.m_ctrlZoneStr.setValue(coordsStr);},"featureType":OpenLayers.Handler.Polygon});if(this.m_ctrlZoneCenterStr){var zone_center=this.m_ctrlZoneCenterStr.getValue().split(" ");var zoom;if(zone_center.length>=2){move_lon=zone_center[0];move_lat=zone_center[1];zoom=TRACK_CONSTANTS.FOUND_ZOOM;}
else{move_lon=NMEAStrToDegree(CONSTANT_VALS.map_default_lon);move_lat=NMEAStrToDegree(CONSTANT_VALS.map_default_lat);zoom=TRACK_CONSTANTS.INI_ZOOM;}
this.m_zones.moveMapToCoords(move_lon,move_lat,zoom);}}}
MapZones_View.prototype.getZoneDescr=function(){return"Геозона";} 
function Constant_Controller(servConnector){options={};options["listModelId"]="ConstantList_Model";options["objModelId"]="ConstantList_Model";Constant_Controller.superclass.constructor.call(this,"Constant_Controller",servConnector,options);this.add_set_value();this.addGetList();this.addGetObject();this.add_get_values();}
extend(Constant_Controller,ControllerDb);Constant_Controller.prototype.add_set_value=function(){var pm=this.addMethodById('set_value');pm.addParam(new FieldString("id"));pm.addParam(new FieldString("val"));}
Constant_Controller.prototype.addGetList=function(){Constant_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldString("id",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldText("descr",options));pm.addParam(new FieldText("val_descr",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("name");}
Constant_Controller.prototype.addGetObject=function(){Constant_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldString("id",options));}
Constant_Controller.prototype.add_get_values=function(){var pm=this.addMethodById('get_values');pm.addParam(new FieldString("id_list"));}
Constant_Controller.prototype.value_cache;Constant_Controller.prototype.readValues=function(struc){this.value_cache=this.value_cache||{};var pm=this.getPublicMethodById("get_values");var id_list="";for(var id in struc){if(this.value_cache[id]){struc[id]=this.value_cache[id];}
else{id_list+=(id_list=="")?"":",";id_list+=id;}}
if(id_list.length){pm.setParamValue("id_list",id_list);this.runPublicMethod("get_values",{},false,function(resp){var model=resp.getModelById("ConstantValueList_Model");model.setActive(true);while(model.getNextRow()){struc[model.getFieldById("id").getValue()]=model.getFieldById("val").getValue();}},this,null);}} 
function Enum_Controller(servConnector){options={};Enum_Controller.superclass.constructor.call(this,"Enum_Controller",servConnector,options);this.add_get_enum_list();}
extend(Enum_Controller,ControllerDb);Enum_Controller.prototype.add_get_enum_list=function(){var pm=this.addMethodById('get_enum_list');pm.addParam(new FieldString("id"));} 
function User_Controller(servConnector){options={};options["listModelId"]="UserList_Model";options["objModelId"]="UserDialog_Model";User_Controller.superclass.constructor.call(this,"User_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.addComplete();this.add_login();this.add_logout();this.add_login_html();this.add_logged();this.add_get_account();this.add_complete_from_1c();}
extend(User_Controller,ControllerDb);User_Controller.prototype.addInsert=function(){User_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="логин";var param=new FieldString("name",options);pm.addParam(param);options={};options["alias"]="ФИО";var param=new FieldString("name_full",options);pm.addParam(param);options={};options["alias"]="Приказ";var param=new FieldString("sign_order",options);pm.addParam(param);options={};options["alias"]="роль";param=new FieldEnum("role_id",options);options["values"]='admin,client,sales_manager,production,marketing,boss,representative';pm.addParam(param);options={};options["alias"]="эл.почта";var param=new FieldString("email",options);pm.addParam(param);options={};options["alias"]="пароль";var param=new FieldPassword("pwd",options);pm.addParam(param);options={};var param=new FieldString("cel_phone",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldString("tel_ext",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);options={};var param=new FieldString("ext_login",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
User_Controller.prototype.addUpdate=function(){User_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="логин";var param=new FieldString("name",options);pm.addParam(param);options={};options["alias"]="ФИО";var param=new FieldString("name_full",options);pm.addParam(param);options={};options["alias"]="Приказ";var param=new FieldString("sign_order",options);pm.addParam(param);options={};options["alias"]="роль";param=new FieldEnum("role_id",options);options["values"]='admin,client,sales_manager,production,marketing,boss,representative';pm.addParam(param);options={};options["alias"]="эл.почта";var param=new FieldString("email",options);pm.addParam(param);options={};options["alias"]="пароль";var param=new FieldPassword("pwd",options);pm.addParam(param);options={};var param=new FieldString("cel_phone",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldString("tel_ext",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);options={};var param=new FieldString("ext_login",options);pm.addParam(param);}
User_Controller.prototype.addDelete=function(){User_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
User_Controller.prototype.addGetList=function(){User_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name_full",options));pm.addParam(new FieldString("email",options));pm.addParam(new FieldString("role_descr",options));}
User_Controller.prototype.addGetObject=function(){User_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
User_Controller.prototype.addComplete=function(){User_Controller.superclass.addComplete.call(this);var options={};var pm=this.getComplete();pm.addParam(new Field("name",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("name");}
User_Controller.prototype.add_login=function(){var pm=this.addMethodById('login');pm.addParam(new FieldString("name"));pm.addParam(new FieldPassword("pwd"));}
User_Controller.prototype.add_logout=function(){var pm=this.addMethodById('logout');}
User_Controller.prototype.add_login_html=function(){var pm=this.addMethodById('login_html');pm.addParam(new FieldString("name"));pm.addParam(new FieldPassword("pwd"));}
User_Controller.prototype.add_logged=function(){var pm=this.addMethodById('logged');}
User_Controller.prototype.add_get_account=function(){var pm=this.addMethodById('get_account');}
User_Controller.prototype.add_complete_from_1c=function(){var pm=this.addMethodById('complete_from_1c');pm.addParam(new FieldString("pattern"));} 
function Client_Controller(servConnector){options={};options["listModelId"]="ClientList_Model";options["objModelId"]="ClientDialog_Model";Client_Controller.superclass.constructor.call(this,"Client_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.addComplete();this.add_get_unreg_list();this.add_get_unreg_client_list();this.add_get_user_list();this.add_get_contract_list();this.add_complete_from_1c();this.add_attrs_from_1c();this.add_register();this.add_check_on_user_name();this.add_check_on_inn();this.add_get_pop_firm();this.add_get_debts_on_firm();this.add_get_debt_list();this.add_refresh_debts();this.add_get_client_ext_contract_list();}
extend(Client_Controller,ControllerDb);Client_Controller.prototype.addInsert=function(){Client_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldText("name_full",options);pm.addParam(param);options={};var param=new FieldString("inn",options);pm.addParam(param);options={};var param=new FieldString("kpp",options);pm.addParam(param);options={};var param=new FieldText("addr_reg",options);pm.addParam(param);options={};var param=new FieldText("addr_mail",options);pm.addParam(param);options={};var param=new FieldBool("addr_mail_same_as_reg",options);pm.addParam(param);options={};var param=new FieldText("telephones",options);pm.addParam(param);options={};var param=new FieldString("ogrn",options);pm.addParam(param);options={};var param=new FieldString("okpo",options);pm.addParam(param);options={};var param=new FieldString("acc",options);pm.addParam(param);options={};var param=new FieldText("bank_name",options);pm.addParam(param);options={};var param=new FieldString("bank_code",options);pm.addParam(param);options={};var param=new FieldString("bank_acc",options);pm.addParam(param);options={};var param=new FieldBool("registered",options);pm.addParam(param);options={};param=new FieldEnum("pay_type",options);options["values"]='cash,in_advance,with_delay';pm.addParam(param);options={};var param=new FieldInt("pay_delay_days",options);pm.addParam(param);options={};var param=new FieldBool("pay_fix_to_dow",options);pm.addParam(param);options={};var param=new FieldString("pay_dow_days",options);pm.addParam(param);options={};var param=new FieldBool("pay_ban_on_debt_days",options);pm.addParam(param);options={};var param=new FieldInt("pay_debt_days",options);pm.addParam(param);options={};var param=new FieldBool("pay_ban_on_debt_sum",options);pm.addParam(param);options={};var param=new FieldFloat("pay_debt_sum",options);pm.addParam(param);options={};var param=new FieldBool("login_allowed",options);pm.addParam(param);options={};var param=new FieldBool("sms_on_order_change",options);pm.addParam(param);options={};var param=new FieldBool("email_sert",options);pm.addParam(param);options={};var param=new FieldBool("show_delivery_tab",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);options={};var param=new FieldInt("client_activity_id",options);pm.addParam(param);options={};var param=new FieldInt("def_firm_id",options);pm.addParam(param);options={};var param=new FieldInt("def_warehouse_id",options);pm.addParam(param);options={};var param=new FieldBool("deleted",options);pm.addParam(param);options={};var param=new FieldString("email",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldBool("is_supplier",options);pm.addParam(param);options={};var param=new FieldBool("is_carrier",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
Client_Controller.prototype.addUpdate=function(){Client_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldText("name_full",options);pm.addParam(param);options={};var param=new FieldString("inn",options);pm.addParam(param);options={};var param=new FieldString("kpp",options);pm.addParam(param);options={};var param=new FieldText("addr_reg",options);pm.addParam(param);options={};var param=new FieldText("addr_mail",options);pm.addParam(param);options={};var param=new FieldBool("addr_mail_same_as_reg",options);pm.addParam(param);options={};var param=new FieldText("telephones",options);pm.addParam(param);options={};var param=new FieldString("ogrn",options);pm.addParam(param);options={};var param=new FieldString("okpo",options);pm.addParam(param);options={};var param=new FieldString("acc",options);pm.addParam(param);options={};var param=new FieldText("bank_name",options);pm.addParam(param);options={};var param=new FieldString("bank_code",options);pm.addParam(param);options={};var param=new FieldString("bank_acc",options);pm.addParam(param);options={};var param=new FieldBool("registered",options);pm.addParam(param);options={};param=new FieldEnum("pay_type",options);options["values"]='cash,in_advance,with_delay';pm.addParam(param);options={};var param=new FieldInt("pay_delay_days",options);pm.addParam(param);options={};var param=new FieldBool("pay_fix_to_dow",options);pm.addParam(param);options={};var param=new FieldString("pay_dow_days",options);pm.addParam(param);options={};var param=new FieldBool("pay_ban_on_debt_days",options);pm.addParam(param);options={};var param=new FieldInt("pay_debt_days",options);pm.addParam(param);options={};var param=new FieldBool("pay_ban_on_debt_sum",options);pm.addParam(param);options={};var param=new FieldFloat("pay_debt_sum",options);pm.addParam(param);options={};var param=new FieldBool("login_allowed",options);pm.addParam(param);options={};var param=new FieldBool("sms_on_order_change",options);pm.addParam(param);options={};var param=new FieldBool("email_sert",options);pm.addParam(param);options={};var param=new FieldBool("show_delivery_tab",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);options={};var param=new FieldInt("client_activity_id",options);pm.addParam(param);options={};var param=new FieldInt("def_firm_id",options);pm.addParam(param);options={};var param=new FieldInt("def_warehouse_id",options);pm.addParam(param);options={};var param=new FieldBool("deleted",options);pm.addParam(param);options={};var param=new FieldString("email",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldBool("is_supplier",options);pm.addParam(param);options={};var param=new FieldBool("is_carrier",options);pm.addParam(param);}
Client_Controller.prototype.addDelete=function(){Client_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
Client_Controller.prototype.addGetList=function(){Client_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldText("occupation",options));pm.addParam(new FieldString("inn",options));pm.addParam(new FieldString("contract_descr",options));pm.addParam(new FieldString("contract_period",options));pm.addParam(new FieldString("terms",options));pm.addParam(new FieldBool("banned",options));pm.addParam(new FieldString("client_activity_descr",options));pm.addParam(new FieldBool("login_allowed",options));pm.addParam(new FieldInt("def_firm_id",options));pm.addParam(new FieldInt("def_warehouse_id",options));pm.addParam(new FieldFloat("def_debt",options));pm.addParam(new FieldFloat("debt_total",options));pm.addParam(new FieldBool("deleted",options));pm.addParam(new FieldString("deliv_add_cost_to_product",options));}
Client_Controller.prototype.addGetObject=function(){Client_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
Client_Controller.prototype.addComplete=function(){Client_Controller.superclass.addComplete.call(this);var options={};var pm=this.getComplete();pm.addParam(new FieldString("name",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("name");}
Client_Controller.prototype.add_get_unreg_list=function(){var pm=this.addMethodById('get_unreg_list');}
Client_Controller.prototype.add_get_unreg_client_list=function(){var pm=this.addMethodById('get_unreg_client_list');}
Client_Controller.prototype.add_get_user_list=function(){var pm=this.addMethodById('get_user_list');pm.addParam(new FieldInt("client_id"));}
Client_Controller.prototype.add_get_contract_list=function(){var pm=this.addMethodById('get_contract_list');pm.addParam(new FieldInt("client_id"));}
Client_Controller.prototype.add_complete_from_1c=function(){var pm=this.addMethodById('complete_from_1c');pm.addParam(new FieldString("pattern"));}
Client_Controller.prototype.add_attrs_from_1c=function(){var pm=this.addMethodById('attrs_from_1c');pm.addParam(new FieldString("name"));}
Client_Controller.prototype.add_register=function(){var pm=this.addMethodById('register');pm.addParam(new FieldString("name"));pm.addParam(new FieldString("inn"));pm.addParam(new FieldString("kpp"));pm.addParam(new FieldText("addr_reg"));pm.addParam(new FieldText("addr_mail"));pm.addParam(new FieldBool("addr_mail_same_as_reg"));pm.addParam(new FieldText("telephones"));pm.addParam(new FieldString("ogrn"));pm.addParam(new FieldString("okpo"));pm.addParam(new FieldString("acc"));pm.addParam(new FieldText("bank_name"));pm.addParam(new FieldString("bank_code"));pm.addParam(new FieldString("bank_acc"));pm.addParam(new FieldString("user_name_full"));pm.addParam(new FieldString("user_name"));pm.addParam(new FieldString("user_pwd"));pm.addParam(new FieldString("user_email"));pm.addParam(new FieldString("user_phone"));}
Client_Controller.prototype.add_check_on_user_name=function(){var pm=this.addMethodById('check_on_user_name');pm.addParam(new FieldString("user_name"));}
Client_Controller.prototype.add_check_on_inn=function(){var pm=this.addMethodById('check_on_inn');pm.addParam(new FieldString("inn"));}
Client_Controller.prototype.add_get_pop_firm=function(){var pm=this.addMethodById('get_pop_firm');pm.addParam(new FieldInt("client_id"));}
Client_Controller.prototype.add_get_debts_on_firm=function(){var pm=this.addMethodById('get_debts_on_firm');pm.addParam(new FieldInt("firm_id"));pm.addParam(new FieldInt("client_id"));}
Client_Controller.prototype.add_get_debt_list=function(){var pm=this.addMethodById('get_debt_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
Client_Controller.prototype.add_refresh_debts=function(){var pm=this.addMethodById('refresh_debts');}
Client_Controller.prototype.add_get_client_ext_contract_list=function(){var pm=this.addMethodById('get_client_ext_contract_list');pm.addParam(new FieldInt("firm_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));} 
function ClientUser_Controller(servConnector){options={};options["listModelId"]="ClientUserList_Model";options["objModelId"]="ClientUserList_Model";ClientUser_Controller.superclass.constructor.call(this,"ClientUser_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.add_reset_pwd();}
extend(ClientUser_Controller,ControllerDb);ClientUser_Controller.prototype.addInsert=function(){ClientUser_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="логин";var param=new FieldString("name",options);pm.addParam(param);options={};options["alias"]="ФИО";var param=new FieldString("name_full",options);pm.addParam(param);options={};options["alias"]="Приказ";var param=new FieldString("sign_order",options);pm.addParam(param);options={};options["alias"]="роль";param=new FieldEnum("role_id",options);options["values"]='admin,client,sales_manager,production,marketing,boss,representative';pm.addParam(param);options={};options["alias"]="эл.почта";var param=new FieldString("email",options);pm.addParam(param);options={};options["alias"]="пароль";var param=new FieldPassword("pwd",options);pm.addParam(param);options={};var param=new FieldString("cel_phone",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldString("tel_ext",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);options={};var param=new FieldString("ext_login",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
ClientUser_Controller.prototype.addUpdate=function(){ClientUser_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="логин";var param=new FieldString("name",options);pm.addParam(param);options={};options["alias"]="ФИО";var param=new FieldString("name_full",options);pm.addParam(param);options={};options["alias"]="Приказ";var param=new FieldString("sign_order",options);pm.addParam(param);options={};options["alias"]="роль";param=new FieldEnum("role_id",options);options["values"]='admin,client,sales_manager,production,marketing,boss,representative';pm.addParam(param);options={};options["alias"]="эл.почта";var param=new FieldString("email",options);pm.addParam(param);options={};options["alias"]="пароль";var param=new FieldPassword("pwd",options);pm.addParam(param);options={};var param=new FieldString("cel_phone",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldString("tel_ext",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);options={};var param=new FieldString("ext_login",options);pm.addParam(param);}
ClientUser_Controller.prototype.addDelete=function(){ClientUser_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ClientUser_Controller.prototype.addGetList=function(){ClientUser_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("client_id",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldString("name_full",options));pm.addParam(new FieldString("email",options));pm.addParam(new FieldString("cel_phone",options));}
ClientUser_Controller.prototype.addGetObject=function(){ClientUser_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
ClientUser_Controller.prototype.add_reset_pwd=function(){var pm=this.addMethodById('reset_pwd');pm.addParam(new Field("user_id"));} 
function ClientContract_Controller(servConnector){options={};options["listModelId"]="ClientContractList_Model";options["objModelId"]="ClientContractList_Model";ClientContract_Controller.superclass.constructor.call(this,"ClientContract_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ClientContract_Controller,ControllerDb);ClientContract_Controller.prototype.addInsert=function(){ClientContract_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};options["alias"]="Состояние";param=new FieldEnum("state",options);options["values"]='signed,not_signed';pm.addParam(param);options={};options["alias"]="Дата с";var param=new FieldDate("date_from",options);pm.addParam(param);options={};options["alias"]="Дата по";var param=new FieldDate("date_to",options);pm.addParam(param);options={};options["alias"]="номер";var param=new FieldString("number",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
ClientContract_Controller.prototype.addUpdate=function(){ClientContract_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};options["alias"]="Состояние";param=new FieldEnum("state",options);options["values"]='signed,not_signed';pm.addParam(param);options={};options["alias"]="Дата с";var param=new FieldDate("date_from",options);pm.addParam(param);options={};options["alias"]="Дата по";var param=new FieldDate("date_to",options);pm.addParam(param);options={};options["alias"]="номер";var param=new FieldString("number",options);pm.addParam(param);}
ClientContract_Controller.prototype.addDelete=function(){ClientContract_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ClientContract_Controller.prototype.addGetList=function(){ClientContract_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("client_id",options));pm.addParam(new FieldString("firm_descr",options));pm.addParam(new FieldString("state",options));pm.addParam(new FieldString("state_descr",options));pm.addParam(new FieldString("date_to_descr",options));}
ClientContract_Controller.prototype.addGetObject=function(){ClientContract_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function Firm_Controller(servConnector){options={};options["listModelId"]="FirmList_Model";options["objModelId"]="FirmList_Model";Firm_Controller.superclass.constructor.call(this,"Firm_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.add_get_firm_ext_bank_account_list();}
extend(Firm_Controller,ControllerDb);Firm_Controller.prototype.addInsert=function(){Firm_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);options={};var param=new FieldText("sert_header",options);pm.addParam(param);options={};var param=new FieldBool("nds",options);pm.addParam(param);options={};var param=new FieldBool("cash",options);pm.addParam(param);options={};var param=new FieldBool("deleted",options);pm.addParam(param);options={};var param=new FieldBool("order_no_carrier_print",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
Firm_Controller.prototype.addUpdate=function(){Firm_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);options={};var param=new FieldText("sert_header",options);pm.addParam(param);options={};var param=new FieldBool("nds",options);pm.addParam(param);options={};var param=new FieldBool("cash",options);pm.addParam(param);options={};var param=new FieldBool("deleted",options);pm.addParam(param);options={};var param=new FieldBool("order_no_carrier_print",options);pm.addParam(param);}
Firm_Controller.prototype.addDelete=function(){Firm_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
Firm_Controller.prototype.addGetList=function(){Firm_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldString("match_1c",options));pm.addParam(new FieldBool("nds",options));pm.addParam(new FieldBool("cash",options));pm.addParam(new FieldBool("deleted",options));pm.addParam(new FieldBool("order_no_carrier_print",options));}
Firm_Controller.prototype.addGetObject=function(){Firm_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
Firm_Controller.prototype.add_get_firm_ext_bank_account_list=function(){var pm=this.addMethodById('get_firm_ext_bank_account_list');pm.addParam(new FieldInt("firm_id"));pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));} 
function SaleStoreAddress_Controller(servConnector){options={};options["listModelId"]="SaleStoreAddress_Model";options["objModelId"]="SaleStoreAddress_Model";SaleStoreAddress_Controller.superclass.constructor.call(this,"SaleStoreAddress_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(SaleStoreAddress_Controller,ControllerDb);SaleStoreAddress_Controller.prototype.addInsert=function(){SaleStoreAddress_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Код";var param=new FieldString("code",options);pm.addParam(param);options={};options["alias"]="Наименование адреса";var param=new FieldText("name",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
SaleStoreAddress_Controller.prototype.addUpdate=function(){SaleStoreAddress_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Код";var param=new FieldString("code",options);pm.addParam(param);options={};options["alias"]="Наименование адреса";var param=new FieldText("name",options);pm.addParam(param);}
SaleStoreAddress_Controller.prototype.addDelete=function(){SaleStoreAddress_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
SaleStoreAddress_Controller.prototype.addGetList=function(){SaleStoreAddress_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("code",options));pm.addParam(new FieldText("name",options));}
SaleStoreAddress_Controller.prototype.addGetObject=function(){SaleStoreAddress_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function Product_Controller(servConnector){options={};options["listModelId"]="ProductList_Model";options["objModelId"]="ProductDialog_Model";Product_Controller.superclass.constructor.call(this,"Product_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.add_get_list_for_order();this.add_get_filter_list();}
extend(Product_Controller,ControllerDb);Product_Controller.prototype.addInsert=function(){Product_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldBool("mes_length_exists",options);pm.addParam(param);options={};var param=new FieldString("mes_length_name",options);pm.addParam(param);options={};var param=new FieldBool("mes_length_fix",options);pm.addParam(param);options={};var param=new FieldInt("mes_length_fix_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_length_min_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_length_max_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_length_def_val",options);pm.addParam(param);options={};var param=new FieldBool("mes_length_seq",options);pm.addParam(param);options={};var param=new FieldText("mes_length_vals",options);pm.addParam(param);options={};var param=new FieldBool("mes_width_exists",options);pm.addParam(param);options={};var param=new FieldString("mes_width_name",options);pm.addParam(param);options={};var param=new FieldBool("mes_width_fix",options);pm.addParam(param);options={};var param=new FieldInt("mes_width_fix_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_width_min_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_width_max_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_width_def_val",options);pm.addParam(param);options={};var param=new FieldBool("mes_width_seq",options);pm.addParam(param);options={};var param=new FieldText("mes_width_vals",options);pm.addParam(param);options={};var param=new FieldBool("mes_height_exists",options);pm.addParam(param);options={};var param=new FieldString("mes_height_name",options);pm.addParam(param);options={};var param=new FieldBool("mes_height_fix",options);pm.addParam(param);options={};var param=new FieldInt("mes_height_fix_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_height_min_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_height_max_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_height_def_val",options);pm.addParam(param);options={};var param=new FieldBool("mes_height_seq",options);pm.addParam(param);options={};var param=new FieldText("mes_height_vals",options);pm.addParam(param);options={};var param=new FieldInt("base_measure_unit_id",options);pm.addParam(param);options={};var param=new FieldInt("order_measure_unit_id",options);pm.addParam(param);options={};var param=new FieldFloat("base_measure_unit_vol_m",options);pm.addParam(param);options={};var param=new FieldFloat("base_measure_unit_weight_t",options);pm.addParam(param);options={};var param=new FieldString("pack_name",options);pm.addParam(param);options={};var param=new FieldBool("pack_default",options);pm.addParam(param);options={};var param=new FieldBool("pack_not_free",options);pm.addParam(param);options={};var param=new FieldBool("pack_full_package_only",options);pm.addParam(param);options={};var param=new FieldBool("extra_pay_for_abnormal_size",options);pm.addParam(param);options={};var param=new FieldBool("extra_pay_for_abn_size_always",options);pm.addParam(param);options={};var param=new FieldText("extra_pay_calc_formula",options);pm.addParam(param);options={};var param=new FieldText("warehouses_str",options);pm.addParam(param);options={};var param=new FieldString("lot_id",options);pm.addParam(param);options={};var param=new FieldString("lot_volume",options);pm.addParam(param);options={};var param=new FieldInt("sert_type_id",options);pm.addParam(param);options={};var param=new FieldString("name_for_1c",options);pm.addParam(param);options={};var param=new FieldInt("product_group_id",options);pm.addParam(param);options={};var param=new FieldText("fin_group",options);pm.addParam(param);options={};var param=new FieldText("analit_group",options);pm.addParam(param);options={};var param=new FieldBool("deleted",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
Product_Controller.prototype.addUpdate=function(){Product_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldBool("mes_length_exists",options);pm.addParam(param);options={};var param=new FieldString("mes_length_name",options);pm.addParam(param);options={};var param=new FieldBool("mes_length_fix",options);pm.addParam(param);options={};var param=new FieldInt("mes_length_fix_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_length_min_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_length_max_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_length_def_val",options);pm.addParam(param);options={};var param=new FieldBool("mes_length_seq",options);pm.addParam(param);options={};var param=new FieldText("mes_length_vals",options);pm.addParam(param);options={};var param=new FieldBool("mes_width_exists",options);pm.addParam(param);options={};var param=new FieldString("mes_width_name",options);pm.addParam(param);options={};var param=new FieldBool("mes_width_fix",options);pm.addParam(param);options={};var param=new FieldInt("mes_width_fix_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_width_min_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_width_max_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_width_def_val",options);pm.addParam(param);options={};var param=new FieldBool("mes_width_seq",options);pm.addParam(param);options={};var param=new FieldText("mes_width_vals",options);pm.addParam(param);options={};var param=new FieldBool("mes_height_exists",options);pm.addParam(param);options={};var param=new FieldString("mes_height_name",options);pm.addParam(param);options={};var param=new FieldBool("mes_height_fix",options);pm.addParam(param);options={};var param=new FieldInt("mes_height_fix_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_height_min_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_height_max_val",options);pm.addParam(param);options={};var param=new FieldInt("mes_height_def_val",options);pm.addParam(param);options={};var param=new FieldBool("mes_height_seq",options);pm.addParam(param);options={};var param=new FieldText("mes_height_vals",options);pm.addParam(param);options={};var param=new FieldInt("base_measure_unit_id",options);pm.addParam(param);options={};var param=new FieldInt("order_measure_unit_id",options);pm.addParam(param);options={};var param=new FieldFloat("base_measure_unit_vol_m",options);pm.addParam(param);options={};var param=new FieldFloat("base_measure_unit_weight_t",options);pm.addParam(param);options={};var param=new FieldString("pack_name",options);pm.addParam(param);options={};var param=new FieldBool("pack_default",options);pm.addParam(param);options={};var param=new FieldBool("pack_not_free",options);pm.addParam(param);options={};var param=new FieldBool("pack_full_package_only",options);pm.addParam(param);options={};var param=new FieldBool("extra_pay_for_abnormal_size",options);pm.addParam(param);options={};var param=new FieldBool("extra_pay_for_abn_size_always",options);pm.addParam(param);options={};var param=new FieldText("extra_pay_calc_formula",options);pm.addParam(param);options={};var param=new FieldText("warehouses_str",options);pm.addParam(param);options={};var param=new FieldString("lot_id",options);pm.addParam(param);options={};var param=new FieldString("lot_volume",options);pm.addParam(param);options={};var param=new FieldInt("sert_type_id",options);pm.addParam(param);options={};var param=new FieldString("name_for_1c",options);pm.addParam(param);options={};var param=new FieldInt("product_group_id",options);pm.addParam(param);options={};var param=new FieldText("fin_group",options);pm.addParam(param);options={};var param=new FieldText("analit_group",options);pm.addParam(param);options={};var param=new FieldBool("deleted",options);pm.addParam(param);}
Product_Controller.prototype.addDelete=function(){Product_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
Product_Controller.prototype.addGetList=function(){Product_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldBool("deleted",options));}
Product_Controller.prototype.addGetObject=function(){Product_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
Product_Controller.prototype.add_get_list_for_order=function(){var pm=this.addMethodById('get_list_for_order');pm.addParam(new FieldInt("warehouse_id"));}
Product_Controller.prototype.add_get_filter_list=function(){var pm=this.addMethodById('get_filter_list');} 
function ClientPriceList_Controller(servConnector){options={};options["listModelId"]="ClientPriceListList_Model";options["objModelId"]="ClientPriceListDialog_Model";ClientPriceList_Controller.superclass.constructor.call(this,"ClientPriceList_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.add_tune();this.add_print_price();}
extend(ClientPriceList_Controller,ControllerDb);ClientPriceList_Controller.prototype.addInsert=function(){ClientPriceList_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldInt("production_city_id",options);pm.addParam(param);options={};var param=new FieldBool("to_third_party_only",options);pm.addParam(param);options={};var param=new FieldBool("part_ship_do_not_change_price",options);pm.addParam(param);options={};var param=new FieldFloat("min_order_quant",options);pm.addParam(param);options={};var param=new FieldBool("default_price_list",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
ClientPriceList_Controller.prototype.addUpdate=function(){ClientPriceList_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldInt("production_city_id",options);pm.addParam(param);options={};var param=new FieldBool("to_third_party_only",options);pm.addParam(param);options={};var param=new FieldBool("part_ship_do_not_change_price",options);pm.addParam(param);options={};var param=new FieldFloat("min_order_quant",options);pm.addParam(param);options={};var param=new FieldBool("default_price_list",options);pm.addParam(param);}
ClientPriceList_Controller.prototype.addDelete=function(){ClientPriceList_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ClientPriceList_Controller.prototype.addGetList=function(){ClientPriceList_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));}
ClientPriceList_Controller.prototype.addGetObject=function(){ClientPriceList_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
ClientPriceList_Controller.prototype.add_tune=function(){var pm=this.addMethodById('tune');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldString("templ"));pm.addParam(new FieldString("field_sep"));}
ClientPriceList_Controller.prototype.add_print_price=function(){var pm=this.addMethodById('print_price');pm.addParam(new FieldInt("price_id"));pm.addParam(new FieldString("templ"));} 
function ProductionCity_Controller(servConnector){options={};options["listModelId"]="ProductionCityList_Model";options["objModelId"]="ProductionCityDialog_Model";ProductionCity_Controller.superclass.constructor.call(this,"ProductionCity_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ProductionCity_Controller,ControllerDb);ProductionCity_Controller.prototype.addInsert=function(){ProductionCity_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldGeomPolygon("zone",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
ProductionCity_Controller.prototype.addUpdate=function(){ProductionCity_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldGeomPolygon("zone",options);pm.addParam(param);}
ProductionCity_Controller.prototype.addDelete=function(){ProductionCity_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ProductionCity_Controller.prototype.addGetList=function(){ProductionCity_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("name");}
ProductionCity_Controller.prototype.addGetObject=function(){ProductionCity_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function ClientPriceListProduct_Controller(servConnector){options={};ClientPriceListProduct_Controller.superclass.constructor.call(this,"ClientPriceListProduct_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.add_get_obj();this.add_set_values();}
extend(ClientPriceListProduct_Controller,ControllerDb);ClientPriceListProduct_Controller.prototype.addInsert=function(){ClientPriceListProduct_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("price_list_id",options);pm.addParam(param);options={};var param=new FieldInt("product_id",options);pm.addParam(param);options={};var param=new FieldFloat("price",options);pm.addParam(param);options={};var param=new FieldFloat("discount_volume",options);pm.addParam(param);options={};var param=new FieldFloat("discount_total",options);pm.addParam(param);options={};var param=new FieldFloat("pack_price",options);pm.addParam(param);}
ClientPriceListProduct_Controller.prototype.addUpdate=function(){ClientPriceListProduct_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("price_list_id",options);pm.addParam(param);param=new FieldInt("old_price_list_id",{});pm.addParam(param);options={};var param=new FieldInt("product_id",options);pm.addParam(param);param=new FieldInt("old_product_id",{});pm.addParam(param);options={};var param=new FieldFloat("price",options);pm.addParam(param);options={};var param=new FieldFloat("discount_volume",options);pm.addParam(param);options={};var param=new FieldFloat("discount_total",options);pm.addParam(param);options={};var param=new FieldFloat("pack_price",options);pm.addParam(param);}
ClientPriceListProduct_Controller.prototype.addDelete=function(){ClientPriceListProduct_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("price_list_id",options));pm.addParam(new FieldInt("product_id",options));}
ClientPriceListProduct_Controller.prototype.addGetList=function(){ClientPriceListProduct_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();}
ClientPriceListProduct_Controller.prototype.add_get_obj=function(){var pm=this.addMethodById('get_obj');pm.addParam(new FieldInt("price_list_id"));pm.addParam(new FieldInt("product_id"));}
ClientPriceListProduct_Controller.prototype.add_set_values=function(){var pm=this.addMethodById('set_values');pm.addParam(new FieldString("price_list_ids"));pm.addParam(new FieldString("product_ids"));pm.addParam(new FieldString("vals"));} 
function DOCOrder_Controller(servConnector){options={};options["objModelId"]="DOCOrderDialog_Model";DOCOrder_Controller.superclass.constructor.call(this,"DOCOrder_Controller",servConnector,options);this.addInsert();this.addUpdate();this.add_divide();this.addDelete();this.add_get_new_list();this.add_get_current_list();this.add_get_current_for_representative_list();this.add_get_current_for_client_list();this.add_get_current_for_production_list();this.add_get_closed_list();this.addGetObject();this.add_get_cust_survey();this.add_get_divis();this.add_before_open();this.add_get_actions();this.add_get_print();this.add_download_print();this.add_get_print_check();this.add_set_ready();this.add_get_shipment();this.add_get_products_descr();this.add_cancel();this.add_cancel_last_state();this.add_get_history();this.add_pass_to_production();this.add_get_print_all();this.add_get_print_cnt();this.add_set_printed();this.add_set_shipped();this.add_get_ship_docs();this.add_print_ship_docs();this.add_set_paid();this.add_set_not_paid();this.add_paid_to_acc();this.add_set_paid_by_bank();this.add_paid_by_bank_to_acc();this.add_set_closed();this.add_print_order();this.add_ext_ship_exists();this.add_ext_invoice_exists();this.add_ext_order_exists();this.add_print_torg12();this.add_print_invoice();this.add_print_upd();this.add_print_ttn();this.add_print_passport();this.add_pay_orders_list();this.add_fill_cust_surv();this.add_set_cancel_cause();this.add_calc_totals();this.add_calc_quant();this.add_recalc_product_prices();this.add_calc_deliv_cost();this.add_get_pop_warehouse();this.add_get_children();this.add_get_cancel_cause();this.add_get_append_list();this.add_append();this.add_add_file();this.add_delete_file();this.add_get_file();this.add_get_files_list();this.add_get_nonegraphic_files_list();}
extend(DOCOrder_Controller,ControllerDb);DOCOrder_Controller.prototype.addInsert=function(){DOCOrder_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Дата пдч.";var param=new FieldDateTime("date_time",options);pm.addParam(param);options={};options["alias"]="Номер";var param=new FieldString("number",options);pm.addParam(param);options={};options["alias"]="Проведен";var param=new FieldBool("processed",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("gruzopoluchatel_id",options);pm.addParam(param);options={};var param=new FieldString("client_number",options);pm.addParam(param);options={};var param=new FieldDate("delivery_plan_date",options);pm.addParam(param);options={};var param=new FieldDateTime("delivery_fact_date",options);pm.addParam(param);options={};var param=new FieldDate("product_plan_date",options);pm.addParam(param);options={};var param=new FieldInt("client_user_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldText("sales_manager_comment",options);pm.addParam(param);options={};var param=new FieldText("client_comment",options);pm.addParam(param);options={};var param=new FieldText("marketing_comment",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_destination_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_type",options);options["values"]='by_supplier,by_client';pm.addParam(param);options={};var param=new FieldBool("deliv_to_third_party",options);pm.addParam(param);options={};var param=new FieldBool("deliv_send_sms",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldInt("deliv_period_id",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable_tel",options);pm.addParam(param);options={};var param=new FieldString("tel",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_count",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_total",options);pm.addParam(param);options={};var param=new FieldBool("deliv_total_edit",options);pm.addParam(param);options={};var param=new FieldFloat("total",options);pm.addParam(param);options={};var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldFloat("total_quant",options);pm.addParam(param);options={};var param=new FieldFloat("total_volume",options);pm.addParam(param);options={};var param=new FieldFloat("total_weight",options);pm.addParam(param);options={};var param=new FieldBool("printed",options);pm.addParam(param);options={};var param=new FieldString("ext_order_num",options);pm.addParam(param);options={};var param=new FieldString("ext_order_id",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_num",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_id",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_num",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_id",options);pm.addParam(param);options={};var param=new FieldDateTime("ext_invoice_date_time",options);pm.addParam(param);options={};var param=new FieldDateTime("cust_surv_date_time",options);pm.addParam(param);options={};var param=new FieldText("cust_surv_comment",options);pm.addParam(param);options={};var param=new FieldText("product_str",options);pm.addParam(param);options={};var param=new FieldInt("product_ids",options);pm.addParam(param);options={};var param=new FieldInt("submit_user_id",options);pm.addParam(param);options={};var param=new FieldBool("paid",options);pm.addParam(param);options={};var param=new FieldBool("paid_by_bank",options);pm.addParam(param);options={};var param=new FieldBool("acc_pko",options);pm.addParam(param);options={};var param=new FieldInt("city_route_distance",options);pm.addParam(param);options={};var param=new FieldInt("country_route_distance",options);pm.addParam(param);options={};var param=new FieldBool("destination_to_ttn",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_expenses",options);pm.addParam(param);options={};var param=new FieldBool("deliv_expenses_edit",options);pm.addParam(param);options={};var param=new FieldBool("deliv_pay_bank",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_ext_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_name",options);pm.addParam(param);options={};options["alias"]="Адрес магазина";var param=new FieldInt("sale_store_address_id",options);pm.addParam(param);options={};options["alias"]="Номер заказа";var param=new FieldText("order_num",options);pm.addParam(param);options={};options["alias"]="Номер партии";var param=new FieldText("batch_num",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrder_Controller.prototype.addUpdate=function(){DOCOrder_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Дата пдч.";var param=new FieldDateTime("date_time",options);pm.addParam(param);options={};options["alias"]="Номер";var param=new FieldString("number",options);pm.addParam(param);options={};options["alias"]="Проведен";var param=new FieldBool("processed",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("gruzopoluchatel_id",options);pm.addParam(param);options={};var param=new FieldString("client_number",options);pm.addParam(param);options={};var param=new FieldDate("delivery_plan_date",options);pm.addParam(param);options={};var param=new FieldDateTime("delivery_fact_date",options);pm.addParam(param);options={};var param=new FieldDate("product_plan_date",options);pm.addParam(param);options={};var param=new FieldInt("client_user_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldText("sales_manager_comment",options);pm.addParam(param);options={};var param=new FieldText("client_comment",options);pm.addParam(param);options={};var param=new FieldText("marketing_comment",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_destination_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_type",options);options["values"]='by_supplier,by_client';pm.addParam(param);options={};var param=new FieldBool("deliv_to_third_party",options);pm.addParam(param);options={};var param=new FieldBool("deliv_send_sms",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldInt("deliv_period_id",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable_tel",options);pm.addParam(param);options={};var param=new FieldString("tel",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_count",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_total",options);pm.addParam(param);options={};var param=new FieldBool("deliv_total_edit",options);pm.addParam(param);options={};var param=new FieldFloat("total",options);pm.addParam(param);options={};var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldFloat("total_quant",options);pm.addParam(param);options={};var param=new FieldFloat("total_volume",options);pm.addParam(param);options={};var param=new FieldFloat("total_weight",options);pm.addParam(param);options={};var param=new FieldBool("printed",options);pm.addParam(param);options={};var param=new FieldString("ext_order_num",options);pm.addParam(param);options={};var param=new FieldString("ext_order_id",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_num",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_id",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_num",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_id",options);pm.addParam(param);options={};var param=new FieldDateTime("ext_invoice_date_time",options);pm.addParam(param);options={};var param=new FieldDateTime("cust_surv_date_time",options);pm.addParam(param);options={};var param=new FieldText("cust_surv_comment",options);pm.addParam(param);options={};var param=new FieldText("product_str",options);pm.addParam(param);options={};var param=new FieldInt("product_ids",options);pm.addParam(param);options={};var param=new FieldInt("submit_user_id",options);pm.addParam(param);options={};var param=new FieldBool("paid",options);pm.addParam(param);options={};var param=new FieldBool("paid_by_bank",options);pm.addParam(param);options={};var param=new FieldBool("acc_pko",options);pm.addParam(param);options={};var param=new FieldInt("city_route_distance",options);pm.addParam(param);options={};var param=new FieldInt("country_route_distance",options);pm.addParam(param);options={};var param=new FieldBool("destination_to_ttn",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_expenses",options);pm.addParam(param);options={};var param=new FieldBool("deliv_expenses_edit",options);pm.addParam(param);options={};var param=new FieldBool("deliv_pay_bank",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_ext_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_name",options);pm.addParam(param);options={};options["alias"]="Адрес магазина";var param=new FieldInt("sale_store_address_id",options);pm.addParam(param);options={};options["alias"]="Номер заказа";var param=new FieldText("order_num",options);pm.addParam(param);options={};options["alias"]="Номер партии";var param=new FieldText("batch_num",options);pm.addParam(param);var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrder_Controller.prototype.add_divide=function(){var pm=this.addMethodById('divide');pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("main_doc_id"));pm.addParam(new FieldDate("delivery_plan_date"));pm.addParam(new FieldText("sales_manager_comment"));pm.addParam(new FieldInt("deliv_period_id"));pm.addParam(new FieldInt("deliv_vehicle_count"));pm.addParam(new FieldInt("deliv_cost_opt_id"));pm.addParam(new FieldFloat("deliv_total"));pm.addParam(new FieldBool("deliv_total_edit"));}
DOCOrder_Controller.prototype.addDelete=function(){DOCOrder_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
DOCOrder_Controller.prototype.add_get_new_list=function(){var pm=this.addMethodById('get_new_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_list=function(){var pm=this.addMethodById('get_current_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_representative_list=function(){var pm=this.addMethodById('get_current_for_representative_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_client_list=function(){var pm=this.addMethodById('get_current_for_client_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_production_list=function(){var pm=this.addMethodById('get_current_for_production_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_closed_list=function(){var pm=this.addMethodById('get_closed_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.addGetObject=function(){DOCOrder_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
DOCOrder_Controller.prototype.add_get_cust_survey=function(){var pm=this.addMethodById('get_cust_survey');pm.addParam(new FieldInt("id"));}
DOCOrder_Controller.prototype.add_get_divis=function(){var pm=this.addMethodById('get_divis');pm.addParam(new FieldInt("id"));pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_before_open=function(){var pm=this.addMethodById('before_open');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_get_actions=function(){var pm=this.addMethodById('get_actions');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print=function(){var pm=this.addMethodById('get_print');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_download_print=function(){var pm=this.addMethodById('download_print');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print_check=function(){var pm=this.addMethodById('get_print_check');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_set_ready=function(){var pm=this.addMethodById('set_ready');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_shipment=function(){var pm=this.addMethodById('get_shipment');pm.addParam(new FieldInt("id"));}
DOCOrder_Controller.prototype.add_get_products_descr=function(){var pm=this.addMethodById('get_products_descr');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_cancel=function(){var pm=this.addMethodById('cancel');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_cancel_last_state=function(){var pm=this.addMethodById('cancel_last_state');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_history=function(){var pm=this.addMethodById('get_history');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_pass_to_production=function(){var pm=this.addMethodById('pass_to_production');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print_all=function(){var pm=this.addMethodById('get_print_all');pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_get_print_cnt=function(){var pm=this.addMethodById('get_print_cnt');}
DOCOrder_Controller.prototype.add_set_printed=function(){var pm=this.addMethodById('set_printed');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_shipped=function(){var pm=this.addMethodById('set_shipped');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("deliv_vehicle_count"));pm.addParam(new FieldInt("driver_id"));pm.addParam(new FieldInt("vehicle_id"));pm.addParam(new FieldInt("deliv_destination_id"));pm.addParam(new FieldBool("destination_to_ttn"));pm.addParam(new FieldText("batch_num"));}
DOCOrder_Controller.prototype.add_get_ship_docs=function(){var pm=this.addMethodById('get_ship_docs');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_ship_docs=function(){var pm=this.addMethodById('print_ship_docs');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_paid=function(){var pm=this.addMethodById('set_paid');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_not_paid=function(){var pm=this.addMethodById('set_not_paid');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_paid_to_acc=function(){var pm=this.addMethodById('paid_to_acc');}
DOCOrder_Controller.prototype.add_set_paid_by_bank=function(){var pm=this.addMethodById('set_paid_by_bank');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_paid_by_bank_to_acc=function(){var pm=this.addMethodById('paid_by_bank_to_acc');}
DOCOrder_Controller.prototype.add_set_closed=function(){var pm=this.addMethodById('set_closed');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_order=function(){var pm=this.addMethodById('print_order');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_ship_exists=function(){var pm=this.addMethodById('ext_ship_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_invoice_exists=function(){var pm=this.addMethodById('ext_invoice_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_order_exists=function(){var pm=this.addMethodById('ext_order_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_torg12=function(){var pm=this.addMethodById('print_torg12');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_invoice=function(){var pm=this.addMethodById('print_invoice');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_upd=function(){var pm=this.addMethodById('print_upd');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_ttn=function(){var pm=this.addMethodById('print_ttn');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_passport=function(){var pm=this.addMethodById('print_passport');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_pay_orders_list=function(){var pm=this.addMethodById('pay_orders_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_fill_cust_surv=function(){var pm=this.addMethodById('fill_cust_surv');pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_set_cancel_cause=function(){var pm=this.addMethodById('set_cancel_cause');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldText("cause"));}
DOCOrder_Controller.prototype.add_calc_totals=function(){var pm=this.addMethodById('calc_totals');pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldInt("product_id"));pm.addParam(new FieldInt("mes_length"));pm.addParam(new FieldInt("mes_width"));pm.addParam(new FieldInt("mes_height"));pm.addParam(new FieldFloat("quant"));pm.addParam(new FieldInt("measure_unit_id"));pm.addParam(new FieldBool("pack"));pm.addParam(new FieldBool("pack_in_price"));pm.addParam(new FieldBool("deliv_to_third_party"));pm.addParam(new FieldBool("price_edit"));pm.addParam(new FieldBool("price_round"));pm.addParam(new FieldFloat("price"));}
DOCOrder_Controller.prototype.add_calc_quant=function(){var pm=this.addMethodById('calc_quant');pm.addParam(new FieldInt("product_id"));pm.addParam(new FieldInt("measure_unit_id"));pm.addParam(new FieldInt("mes_length"));pm.addParam(new FieldInt("mes_width"));pm.addParam(new FieldInt("mes_height"));pm.addParam(new FieldFloat("quant"));pm.addParam(new FieldInt("measure_unit_id_from"));}
DOCOrder_Controller.prototype.add_recalc_product_prices=function(){var pm=this.addMethodById('recalc_product_prices');pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldFloat("deliv_cost"));pm.addParam(new FieldBool("deliv_to_third_party"));pm.addParam(new FieldBool("deliv_add_cost_to_product"));}
DOCOrder_Controller.prototype.add_calc_deliv_cost=function(){var pm=this.addMethodById('calc_deliv_cost');pm.addParam(new FieldInt("cost_opt_id"));pm.addParam(new FieldInt("client_destination_id"));pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("include_route"));}
DOCOrder_Controller.prototype.add_get_pop_warehouse=function(){var pm=this.addMethodById('get_pop_warehouse');pm.addParam(new FieldInt("firm_id"));}
DOCOrder_Controller.prototype.add_get_children=function(){var pm=this.addMethodById('get_children');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_cancel_cause=function(){var pm=this.addMethodById('get_cancel_cause');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_append_list=function(){var pm=this.addMethodById('get_append_list');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_append=function(){var pm=this.addMethodById('append');pm.addParam(new FieldInt("target_doc_id"));pm.addParam(new FieldString("source_doc_id_list"));}
DOCOrder_Controller.prototype.add_add_file=function(){var pm=this.addMethodById('add_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldText("file_data"));pm.addParam(new FieldString("file_id"));}
DOCOrder_Controller.prototype.add_delete_file=function(){var pm=this.addMethodById('delete_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("file_id"));}
DOCOrder_Controller.prototype.add_get_file=function(){var pm=this.addMethodById('get_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("file_id"));pm.addParam(new FieldInt("inline"));}
DOCOrder_Controller.prototype.add_get_files_list=function(){var pm=this.addMethodById('get_files_list');pm.addParam(new FieldInt("doc_order_id"));}
DOCOrder_Controller.prototype.add_get_nonegraphic_files_list=function(){var pm=this.addMethodById('get_nonegraphic_files_list');pm.addParam(new FieldInt("doc_order_id"));} 
function DOCOrderDOCTProduct_Controller(servConnector){options={};options["listModelId"]="DOCOrderDOCTProductList_Model";options["objModelId"]="DOCOrderDOCTProductDialog_Model";DOCOrderDOCTProduct_Controller.superclass.constructor.call(this,"DOCOrderDOCTProduct_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.add_get_object_for_divis();}
extend(DOCOrderDOCTProduct_Controller,ControllerDb);DOCOrderDOCTProduct_Controller.prototype.addInsert=function(){DOCOrderDOCTProduct_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("view_id",options);pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);options={};options["alias"]="Продукция";var param=new FieldInt("product_id",options);pm.addParam(param);options={};var param=new FieldInt("mes_length",options);pm.addParam(param);options={};var param=new FieldInt("mes_width",options);pm.addParam(param);options={};var param=new FieldInt("mes_height",options);pm.addParam(param);options={};var param=new FieldInt("measure_unit_id",options);pm.addParam(param);options={};options["alias"]="Количество";var param=new FieldFloat("quant",options);pm.addParam(param);options={};var param=new FieldFloat("quant_confirmed",options);pm.addParam(param);options={};options["alias"]="Количество";var param=new FieldFloat("quant_base_measure_unit",options);pm.addParam(param);options={};var param=new FieldFloat("quant_confirmed_base_measure_unit",options);pm.addParam(param);options={};var param=new FieldFloat("volume",options);pm.addParam(param);options={};var param=new FieldFloat("weight",options);pm.addParam(param);options={};options["alias"]="Цена";var param=new FieldFloat("price",options);pm.addParam(param);options={};var param=new FieldBool("price_edit",options);pm.addParam(param);options={};var param=new FieldBool("price_round",options);pm.addParam(param);options={};options["alias"]="Сумма";var param=new FieldFloat("total",options);pm.addParam(param);options={};options["alias"]="Сумма";var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldBool("pack_exists",options);pm.addParam(param);options={};var param=new FieldBool("pack_in_price",options);pm.addParam(param);options={};var param=new FieldFloat("total_deliv",options);pm.addParam(param);options={};var param=new FieldFloat("total_no_deliv",options);pm.addParam(param);options={};var param=new FieldFloat("price_no_deliv",options);pm.addParam(param);var options={};pm.addParam(new FieldInt("warehouse_id",options));var options={};pm.addParam(new FieldInt("client_id",options));var options={};pm.addParam(new FieldBool("deliv_to_third_party",options));}
DOCOrderDOCTProduct_Controller.prototype.addUpdate=function(){DOCOrderDOCTProduct_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldString("view_id",options);pm.addParam(param);param=new FieldString("old_view_id",{});pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);param=new FieldInt("old_line_number",{});pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);options={};options["alias"]="Продукция";var param=new FieldInt("product_id",options);pm.addParam(param);options={};var param=new FieldInt("mes_length",options);pm.addParam(param);options={};var param=new FieldInt("mes_width",options);pm.addParam(param);options={};var param=new FieldInt("mes_height",options);pm.addParam(param);options={};var param=new FieldInt("measure_unit_id",options);pm.addParam(param);options={};options["alias"]="Количество";var param=new FieldFloat("quant",options);pm.addParam(param);options={};var param=new FieldFloat("quant_confirmed",options);pm.addParam(param);options={};options["alias"]="Количество";var param=new FieldFloat("quant_base_measure_unit",options);pm.addParam(param);options={};var param=new FieldFloat("quant_confirmed_base_measure_unit",options);pm.addParam(param);options={};var param=new FieldFloat("volume",options);pm.addParam(param);options={};var param=new FieldFloat("weight",options);pm.addParam(param);options={};options["alias"]="Цена";var param=new FieldFloat("price",options);pm.addParam(param);options={};var param=new FieldBool("price_edit",options);pm.addParam(param);options={};var param=new FieldBool("price_round",options);pm.addParam(param);options={};options["alias"]="Сумма";var param=new FieldFloat("total",options);pm.addParam(param);options={};options["alias"]="Сумма";var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldBool("pack_exists",options);pm.addParam(param);options={};var param=new FieldBool("pack_in_price",options);pm.addParam(param);options={};var param=new FieldFloat("total_deliv",options);pm.addParam(param);options={};var param=new FieldFloat("total_no_deliv",options);pm.addParam(param);options={};var param=new FieldFloat("price_no_deliv",options);pm.addParam(param);var options={};pm.addParam(new FieldInt("warehouse_id",options));var options={};pm.addParam(new FieldInt("client_id",options));var options={};pm.addParam(new FieldBool("deliv_to_third_party",options));}
DOCOrderDOCTProduct_Controller.prototype.addDelete=function(){DOCOrderDOCTProduct_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));}
DOCOrderDOCTProduct_Controller.prototype.addGetList=function(){DOCOrderDOCTProduct_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));pm.addParam(new FieldFloat("total_no_deliv",options));pm.addParam(new FieldFloat("price_no_deliv",options));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrderDOCTProduct_Controller.prototype.addGetObject=function(){DOCOrderDOCTProduct_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));}
DOCOrderDOCTProduct_Controller.prototype.add_get_object_for_divis=function(){var pm=this.addMethodById('get_object_for_divis');pm.addParam(new FieldInt("line_number"));pm.addParam(new FieldString("view_id"));} 
function DOCOrderDOCTCustSurvey_Controller(servConnector){options={};options["listModelId"]="DOCOrderDOCTCustSurveyList_Model";options["objModelId"]="DOCOrderDOCTCustSurveyList_Model";DOCOrderDOCTCustSurvey_Controller.superclass.constructor.call(this,"DOCOrderDOCTCustSurvey_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(DOCOrderDOCTCustSurvey_Controller,ControllerDb);DOCOrderDOCTCustSurvey_Controller.prototype.addInsert=function(){DOCOrderDOCTCustSurvey_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("view_id",options);pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);options={};var param=new FieldInt("customer_survey_question_id",options);pm.addParam(param);options={};var param=new FieldInt("points",options);pm.addParam(param);options={};var param=new FieldText("answer_comment",options);pm.addParam(param);}
DOCOrderDOCTCustSurvey_Controller.prototype.addUpdate=function(){DOCOrderDOCTCustSurvey_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldString("view_id",options);pm.addParam(param);param=new FieldString("old_view_id",{});pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);param=new FieldInt("old_line_number",{});pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);options={};var param=new FieldInt("customer_survey_question_id",options);pm.addParam(param);param=new FieldInt("old_customer_survey_question_id",{});pm.addParam(param);options={};var param=new FieldInt("points",options);pm.addParam(param);options={};var param=new FieldText("answer_comment",options);pm.addParam(param);}
DOCOrderDOCTCustSurvey_Controller.prototype.addDelete=function(){DOCOrderDOCTCustSurvey_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));pm.addParam(new FieldInt("customer_survey_question_id",options));}
DOCOrderDOCTCustSurvey_Controller.prototype.addGetList=function(){DOCOrderDOCTCustSurvey_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrderDOCTCustSurvey_Controller.prototype.addGetObject=function(){DOCOrderDOCTCustSurvey_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));} 
function Warehouse_Controller(servConnector){options={};options["listModelId"]="WarehouseList_Model";options["objModelId"]="WarehouseDialog_Model";Warehouse_Controller.superclass.constructor.call(this,"Warehouse_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.add_get_list_for_order();}
extend(Warehouse_Controller,ControllerDb);Warehouse_Controller.prototype.addInsert=function(){Warehouse_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);options={};var param=new FieldGeomPolygon("zone",options);pm.addParam(param);options={};var param=new FieldInt("production_city_id",options);pm.addParam(param);options={};var param=new FieldInt("default_firm_id",options);pm.addParam(param);options={};var param=new FieldFloat("near_road_lon",options);pm.addParam(param);options={};var param=new FieldFloat("near_road_lat",options);pm.addParam(param);options={};var param=new FieldText("address",options);pm.addParam(param);options={};var param=new FieldText("tel",options);pm.addParam(param);options={};var param=new FieldString("email",options);pm.addParam(param);options={};var param=new FieldBool("deleted",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
Warehouse_Controller.prototype.addUpdate=function(){Warehouse_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);options={};var param=new FieldGeomPolygon("zone",options);pm.addParam(param);options={};var param=new FieldInt("production_city_id",options);pm.addParam(param);options={};var param=new FieldInt("default_firm_id",options);pm.addParam(param);options={};var param=new FieldFloat("near_road_lon",options);pm.addParam(param);options={};var param=new FieldFloat("near_road_lat",options);pm.addParam(param);options={};var param=new FieldText("address",options);pm.addParam(param);options={};var param=new FieldText("tel",options);pm.addParam(param);options={};var param=new FieldString("email",options);pm.addParam(param);options={};var param=new FieldBool("deleted",options);pm.addParam(param);}
Warehouse_Controller.prototype.addDelete=function(){Warehouse_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
Warehouse_Controller.prototype.addGetList=function(){Warehouse_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldBool("deleted",options));}
Warehouse_Controller.prototype.addGetObject=function(){Warehouse_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
Warehouse_Controller.prototype.add_get_list_for_order=function(){var pm=this.addMethodById('get_list_for_order');pm.addParam(new FieldInt("product_id"));} 
function MeasureUnit_Controller(servConnector){options={};options["listModelId"]="MeasureUnitList_Model";options["objModelId"]="MeasureUnitDialog_Model";MeasureUnit_Controller.superclass.constructor.call(this,"MeasureUnit_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(MeasureUnit_Controller,ControllerDb);MeasureUnit_Controller.prototype.addInsert=function(){MeasureUnit_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("name_full",options);pm.addParam(param);options={};var param=new FieldBool("is_int",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
MeasureUnit_Controller.prototype.addUpdate=function(){MeasureUnit_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("name_full",options);pm.addParam(param);options={};var param=new FieldBool("is_int",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);}
MeasureUnit_Controller.prototype.addDelete=function(){MeasureUnit_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
MeasureUnit_Controller.prototype.addGetList=function(){MeasureUnit_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));}
MeasureUnit_Controller.prototype.addGetObject=function(){MeasureUnit_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function ProductMeasureUnit_Controller(servConnector){options={};options["listModelId"]="ProductMeasureUnitList_Model";options["objModelId"]="ProductMeasureUnitList_Model";ProductMeasureUnit_Controller.superclass.constructor.call(this,"ProductMeasureUnit_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ProductMeasureUnit_Controller,ControllerDb);ProductMeasureUnit_Controller.prototype.addInsert=function(){ProductMeasureUnit_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("product_id",options);pm.addParam(param);options={};var param=new FieldInt("measure_unit_id",options);pm.addParam(param);options={};var param=new FieldText("calc_formula",options);pm.addParam(param);options={};var param=new FieldBool("in_use",options);pm.addParam(param);}
ProductMeasureUnit_Controller.prototype.addUpdate=function(){ProductMeasureUnit_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("product_id",options);pm.addParam(param);param=new FieldInt("old_product_id",{});pm.addParam(param);options={};var param=new FieldInt("measure_unit_id",options);pm.addParam(param);param=new FieldInt("old_measure_unit_id",{});pm.addParam(param);options={};var param=new FieldText("calc_formula",options);pm.addParam(param);options={};var param=new FieldBool("in_use",options);pm.addParam(param);}
ProductMeasureUnit_Controller.prototype.addDelete=function(){ProductMeasureUnit_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("product_id",options));pm.addParam(new FieldInt("measure_unit_id",options));}
ProductMeasureUnit_Controller.prototype.addGetList=function(){ProductMeasureUnit_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("product_id",options));pm.addParam(new FieldString("product_descr",options));pm.addParam(new FieldInt("measure_unit_id",options));pm.addParam(new FieldString("measure_unit_descr",options));pm.addParam(new FieldText("calc_formula",options));}
ProductMeasureUnit_Controller.prototype.addGetObject=function(){ProductMeasureUnit_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("product_id",options));pm.addParam(new FieldInt("measure_unit_id",options));} 
function DeliveryPeriod_Controller(servConnector){options={};options["listModelId"]="DeliveryPeriod_Model";options["objModelId"]="DeliveryPeriod_Model";DeliveryPeriod_Controller.superclass.constructor.call(this,"DeliveryPeriod_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(DeliveryPeriod_Controller,ControllerDb);DeliveryPeriod_Controller.prototype.addInsert=function(){DeliveryPeriod_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
DeliveryPeriod_Controller.prototype.addUpdate=function(){DeliveryPeriod_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);}
DeliveryPeriod_Controller.prototype.addDelete=function(){DeliveryPeriod_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
DeliveryPeriod_Controller.prototype.addGetList=function(){DeliveryPeriod_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));}
DeliveryPeriod_Controller.prototype.addGetObject=function(){DeliveryPeriod_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function ProductCustomSizePrice_Controller(servConnector){options={};options["listModelId"]="ProductCustomSizePrice_Model";options["objModelId"]="ProductCustomSizePrice_Model";ProductCustomSizePrice_Controller.superclass.constructor.call(this,"ProductCustomSizePrice_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ProductCustomSizePrice_Controller,ControllerDb);ProductCustomSizePrice_Controller.prototype.addInsert=function(){ProductCustomSizePrice_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("product_id",options);pm.addParam(param);options={};var param=new FieldInt("category",options);pm.addParam(param);options={};var param=new FieldFloat("price",options);pm.addParam(param);options={};var param=new FieldFloat("quant",options);pm.addParam(param);}
ProductCustomSizePrice_Controller.prototype.addUpdate=function(){ProductCustomSizePrice_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("product_id",options);pm.addParam(param);param=new FieldInt("old_product_id",{});pm.addParam(param);options={};var param=new FieldInt("category",options);pm.addParam(param);param=new FieldInt("old_category",{});pm.addParam(param);options={};var param=new FieldFloat("price",options);pm.addParam(param);options={};var param=new FieldFloat("quant",options);pm.addParam(param);}
ProductCustomSizePrice_Controller.prototype.addDelete=function(){ProductCustomSizePrice_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("product_id",options));pm.addParam(new FieldInt("category",options));}
ProductCustomSizePrice_Controller.prototype.addGetList=function(){ProductCustomSizePrice_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("product_id",options));pm.addParam(new FieldInt("category",options));pm.addParam(new FieldFloat("price",options));pm.addParam(new FieldFloat("quant",options));}
ProductCustomSizePrice_Controller.prototype.addGetObject=function(){ProductCustomSizePrice_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("product_id",options));pm.addParam(new FieldInt("category",options));} 
function ProductWarehouse_Controller(servConnector){options={};options["listModelId"]="ProductWarehouseList_Model";options["objModelId"]="ProductWarehouseList_Model";ProductWarehouse_Controller.superclass.constructor.call(this,"ProductWarehouse_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ProductWarehouse_Controller,ControllerDb);ProductWarehouse_Controller.prototype.addInsert=function(){ProductWarehouse_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("product_id",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);}
ProductWarehouse_Controller.prototype.addUpdate=function(){ProductWarehouse_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("product_id",options);pm.addParam(param);param=new FieldInt("old_product_id",{});pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);param=new FieldInt("old_warehouse_id",{});pm.addParam(param);}
ProductWarehouse_Controller.prototype.addDelete=function(){ProductWarehouse_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("product_id",options));pm.addParam(new FieldInt("warehouse_id",options));}
ProductWarehouse_Controller.prototype.addGetList=function(){ProductWarehouse_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("product_id",options));pm.addParam(new FieldInt("warehouse_id",options));pm.addParam(new FieldString("warehouse_descr",options));}
ProductWarehouse_Controller.prototype.addGetObject=function(){ProductWarehouse_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("product_id",options));pm.addParam(new FieldInt("warehouse_id",options));} 
function CustomerSurveyQuestion_Controller(servConnector){options={};options["listModelId"]="CustomerSurveyQuestion_Model";options["objModelId"]="CustomerSurveyQuestion_Model";CustomerSurveyQuestion_Controller.superclass.constructor.call(this,"CustomerSurveyQuestion_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(CustomerSurveyQuestion_Controller,ControllerDb);CustomerSurveyQuestion_Controller.prototype.addInsert=function(){CustomerSurveyQuestion_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldText("question",options);pm.addParam(param);options={};var param=new FieldInt("max_points",options);pm.addParam(param);options={};var param=new FieldBool("in_use",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
CustomerSurveyQuestion_Controller.prototype.addUpdate=function(){CustomerSurveyQuestion_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldText("question",options);pm.addParam(param);options={};var param=new FieldInt("max_points",options);pm.addParam(param);options={};var param=new FieldBool("in_use",options);pm.addParam(param);}
CustomerSurveyQuestion_Controller.prototype.addDelete=function(){CustomerSurveyQuestion_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
CustomerSurveyQuestion_Controller.prototype.addGetList=function(){CustomerSurveyQuestion_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldText("question",options));pm.addParam(new FieldInt("max_points",options));pm.addParam(new FieldBool("in_use",options));}
CustomerSurveyQuestion_Controller.prototype.addGetObject=function(){CustomerSurveyQuestion_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function CustomerSurvey_Controller(servConnector){options={};options["listModelId"]="CustomerSurveyList_Model";options["objModelId"]="CustomerSurveyList_Model";CustomerSurvey_Controller.superclass.constructor.call(this,"CustomerSurvey_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(CustomerSurvey_Controller,ControllerDb);CustomerSurvey_Controller.prototype.addInsert=function(){CustomerSurvey_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();}
CustomerSurvey_Controller.prototype.addUpdate=function(){CustomerSurvey_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();}
CustomerSurvey_Controller.prototype.addDelete=function(){CustomerSurvey_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();}
CustomerSurvey_Controller.prototype.addGetList=function(){CustomerSurvey_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();}
CustomerSurvey_Controller.prototype.addGetObject=function(){CustomerSurvey_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();} 
function ProductionState_Controller(servConnector){options={};options["listModelId"]="ProductionState_Model";options["objModelId"]="ProductionState_Model";ProductionState_Controller.superclass.constructor.call(this,"ProductionState_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ProductionState_Controller,ControllerDb);ProductionState_Controller.prototype.addInsert=function(){ProductionState_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("ord",options);pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
ProductionState_Controller.prototype.addUpdate=function(){ProductionState_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("ord",options);pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);}
ProductionState_Controller.prototype.addDelete=function(){ProductionState_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ProductionState_Controller.prototype.addGetList=function(){ProductionState_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("ord",options));pm.addParam(new FieldString("name",options));}
ProductionState_Controller.prototype.addGetObject=function(){ProductionState_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function Report_Controller(servConnector){options={};Report_Controller.superclass.constructor.call(this,"Report_Controller",servConnector,options);this.add_production_load();this.add_naspunkt_cost();this.add_client_balance();this.add_sales();this.add_vehicle_stops();this.add_client_debts();}
extend(Report_Controller,ControllerDb);Report_Controller.prototype.add_production_load=function(){var pm=this.addMethodById('production_load');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldString("templ"));pm.addParam(new FieldString("field_sep"));}
Report_Controller.prototype.add_naspunkt_cost=function(){var pm=this.addMethodById('naspunkt_cost');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldString("templ"));pm.addParam(new FieldString("field_sep"));}
Report_Controller.prototype.add_client_balance=function(){var pm=this.addMethodById('client_balance');pm.addParam(new FieldDate("date_from"));pm.addParam(new FieldDate("date_to"));pm.addParam(new FieldInt("firm_id"));pm.addParam(new FieldString("file_type"));}
Report_Controller.prototype.add_sales=function(){var pm=this.addMethodById('sales');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldString("templ"));pm.addParam(new FieldString("groups"));pm.addParam(new FieldString("agg_fields"));pm.addParam(new FieldString("agg_types"));pm.addParam(new FieldString("field_sep"));}
Report_Controller.prototype.add_vehicle_stops=function(){var pm=this.addMethodById('vehicle_stops');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldString("templ"));pm.addParam(new FieldString("field_sep"));}
Report_Controller.prototype.add_client_debts=function(){var pm=this.addMethodById('client_debts');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldString("templ"));pm.addParam(new FieldString("field_sep"));} 
function ReportVariant_Controller(servConnector){options={};options["objModelId"]="ReportVariant_Model";ReportVariant_Controller.superclass.constructor.call(this,"ReportVariant_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ReportVariant_Controller,ControllerDb);ReportVariant_Controller.prototype.addInsert=function(){ReportVariant_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};param=new FieldEnum("report_type",options);options["values"]='sales';pm.addParam(param);options={};var param=new FieldText("name",options);pm.addParam(param);options={};var param=new FieldText("data",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
ReportVariant_Controller.prototype.addUpdate=function(){ReportVariant_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};param=new FieldEnum("report_type",options);options["values"]='sales';pm.addParam(param);options={};var param=new FieldText("name",options);pm.addParam(param);options={};var param=new FieldText("data",options);pm.addParam(param);}
ReportVariant_Controller.prototype.addDelete=function(){ReportVariant_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ReportVariant_Controller.prototype.addGetList=function(){ReportVariant_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();var options={};options["required"]=true;pm.addParam(new FieldString("report_type",options));}
ReportVariant_Controller.prototype.addGetObject=function(){ReportVariant_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function Delivery_Controller(servConnector){options={};Delivery_Controller.superclass.constructor.call(this,"Delivery_Controller",servConnector,options);this.add_unassigned_orders_list();this.add_assigned_orders_list();this.add_assigned_orders_for_client();this.add_add_extra_vehicle();this.add_extra_veh_select_list();this.add_delete_extra_vehicle();this.add_current_position_all();this.add_current_position_client();this.add_get_order_descr();this.add_assign_order_to_vehicle();this.add_remove_order();}
extend(Delivery_Controller,ControllerDb);Delivery_Controller.prototype.add_unassigned_orders_list=function(){var pm=this.addMethodById('unassigned_orders_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("all_orders"));pm.addParam(new FieldString("field_sep"));}
Delivery_Controller.prototype.add_assigned_orders_list=function(){var pm=this.addMethodById('assigned_orders_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldString("field_sep"));}
Delivery_Controller.prototype.add_assigned_orders_for_client=function(){var pm=this.addMethodById('assigned_orders_for_client');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldString("field_sep"));}
Delivery_Controller.prototype.add_add_extra_vehicle=function(){var pm=this.addMethodById('add_extra_vehicle');pm.addParam(new FieldDate("date"));pm.addParam(new FieldInt("vehicle_id"));}
Delivery_Controller.prototype.add_extra_veh_select_list=function(){var pm=this.addMethodById('extra_veh_select_list');pm.addParam(new FieldDate("date"));pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
Delivery_Controller.prototype.add_delete_extra_vehicle=function(){var pm=this.addMethodById('delete_extra_vehicle');pm.addParam(new FieldDate("date"));pm.addParam(new FieldInt("vehicle_id"));}
Delivery_Controller.prototype.add_current_position_all=function(){var pm=this.addMethodById('current_position_all');}
Delivery_Controller.prototype.add_current_position_client=function(){var pm=this.addMethodById('current_position_client');pm.addParam(new FieldDate("date"));}
Delivery_Controller.prototype.add_get_order_descr=function(){var pm=this.addMethodById('get_order_descr');pm.addParam(new FieldInt("doc_id"));}
Delivery_Controller.prototype.add_assign_order_to_vehicle=function(){var pm=this.addMethodById('assign_order_to_vehicle');pm.addParam(new FieldInt("order_id"));pm.addParam(new FieldInt("vehicle_id"));pm.addParam(new FieldInt("hour_id"));pm.addParam(new FieldDate("date"));}
Delivery_Controller.prototype.add_remove_order=function(){var pm=this.addMethodById('remove_order');pm.addParam(new FieldInt("order_id"));} 
function Driver_Controller(servConnector){options={};options["listModelId"]="DriverList_Model";options["objModelId"]="DriverList_Model";Driver_Controller.superclass.constructor.call(this,"Driver_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.addComplete();this.add_get_veh_attrs();}
extend(Driver_Controller,ControllerDb);Driver_Controller.prototype.addInsert=function(){Driver_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("drive_perm",options);pm.addParam(param);options={};var param=new FieldString("cel_phone",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
Driver_Controller.prototype.addUpdate=function(){Driver_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("drive_perm",options);pm.addParam(param);options={};var param=new FieldString("cel_phone",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);}
Driver_Controller.prototype.addDelete=function(){Driver_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
Driver_Controller.prototype.addGetList=function(){Driver_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldString("drive_perm",options));pm.addParam(new FieldString("cel_phone",options));pm.addParam(new FieldString("ext_id",options));pm.addParam(new FieldString("match_1c",options));}
Driver_Controller.prototype.addGetObject=function(){Driver_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
Driver_Controller.prototype.addComplete=function(){Driver_Controller.superclass.addComplete.call(this);var options={};var pm=this.getComplete();pm.addParam(new FieldString("name",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("name");}
Driver_Controller.prototype.add_get_veh_attrs=function(){var pm=this.addMethodById('get_veh_attrs');pm.addParam(new FieldInt("driver_id"));} 
function Vehicle_Controller(servConnector){options={};options["listModelId"]="VehicleList_Model";options["objModelId"]="VehicleDialog_Model";Vehicle_Controller.superclass.constructor.call(this,"Vehicle_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.add_get_select_list();this.addGetObject();this.addComplete();}
extend(Vehicle_Controller,ControllerDb);Vehicle_Controller.prototype.addInsert=function(){Vehicle_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("model",options);pm.addParam(param);options={};var param=new FieldString("plate",options);pm.addParam(param);options={};var param=new FieldInt("vol",options);pm.addParam(param);options={};var param=new FieldBool("employed",options);pm.addParam(param);options={};var param=new FieldFloat("load_weight_t",options);pm.addParam(param);options={};var param=new FieldInt("production_city_id",options);pm.addParam(param);options={};var param=new FieldInt("carrier_id",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldString("trailer_model",options);pm.addParam(param);options={};var param=new FieldString("trailer_plate",options);pm.addParam(param);options={};var param=new FieldString("tracker_id",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));var options={};pm.addParam(new FieldString("driver_descr",options));var options={};pm.addParam(new FieldString("driver_drive_perm",options));var options={};pm.addParam(new FieldString("driver_cel_phone",options));}
Vehicle_Controller.prototype.addUpdate=function(){Vehicle_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("model",options);pm.addParam(param);options={};var param=new FieldString("plate",options);pm.addParam(param);options={};var param=new FieldInt("vol",options);pm.addParam(param);options={};var param=new FieldBool("employed",options);pm.addParam(param);options={};var param=new FieldFloat("load_weight_t",options);pm.addParam(param);options={};var param=new FieldInt("production_city_id",options);pm.addParam(param);options={};var param=new FieldInt("carrier_id",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldString("trailer_model",options);pm.addParam(param);options={};var param=new FieldString("trailer_plate",options);pm.addParam(param);options={};var param=new FieldString("tracker_id",options);pm.addParam(param);var options={};pm.addParam(new FieldString("driver_descr",options));var options={};pm.addParam(new FieldString("driver_drive_perm",options));var options={};pm.addParam(new FieldString("driver_cel_phone",options));}
Vehicle_Controller.prototype.addDelete=function(){Vehicle_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
Vehicle_Controller.prototype.addGetList=function(){Vehicle_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("plate",options));pm.addParam(new FieldString("model",options));pm.addParam(new FieldInt("production_city_id",options));pm.addParam(new FieldString("production_city_descr",options));pm.addParam(new FieldInt("driver_id",options));pm.addParam(new FieldString("driver_descr",options));pm.addParam(new FieldBool("employed",options));pm.addParam(new FieldInt("vol",options));pm.addParam(new FieldFloat("load_weight_t",options));pm.addParam(new FieldString("vl_wt",options));pm.addParam(new FieldInt("carrier_id",options));pm.addParam(new FieldString("carrier_descr",options));pm.addParam(new FieldString("trailer_model",options));pm.addParam(new FieldString("trailer_plate",options));pm.addParam(new FieldString("driver_match_1c",options));}
Vehicle_Controller.prototype.add_get_select_list=function(){var pm=this.addMethodById('get_select_list');}
Vehicle_Controller.prototype.addGetObject=function(){Vehicle_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
Vehicle_Controller.prototype.addComplete=function(){Vehicle_Controller.superclass.addComplete.call(this);var options={};var pm=this.getComplete();pm.addParam(new FieldString("complete_descr",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("complete_descr");} 
function Carrier_Controller(servConnector){options={};options["listModelId"]="CarrierList_Model";options["objModelId"]="CarrierList_Model";Carrier_Controller.superclass.constructor.call(this,"Carrier_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(Carrier_Controller,ControllerDb);Carrier_Controller.prototype.addInsert=function(){Carrier_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
Carrier_Controller.prototype.addUpdate=function(){Carrier_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);}
Carrier_Controller.prototype.addDelete=function(){Carrier_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
Carrier_Controller.prototype.addGetList=function(){Carrier_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldInt("client_id",options));pm.addParam(new FieldString("client_name",options));}
Carrier_Controller.prototype.addGetObject=function(){Carrier_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function ClientDestination_Controller(servConnector){options={};options["listModelId"]="ClientDestinationList_Model";options["objModelId"]="ClientDestinationDialog_Model";ClientDestination_Controller.superclass.constructor.call(this,"ClientDestination_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.add_get_address_gps();this.add_complete_address();}
extend(ClientDestination_Controller,ControllerDb);ClientDestination_Controller.prototype.addInsert=function(){ClientDestination_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldText("value",options);pm.addParam(param);options={};var param=new FieldGeomPoint("zone_center",options);pm.addParam(param);options={};var param=new FieldFloat("near_road_lon",options);pm.addParam(param);options={};var param=new FieldFloat("near_road_lat",options);pm.addParam(param);options={};var param=new FieldText("region",options);pm.addParam(param);options={};var param=new FieldText("region_code",options);pm.addParam(param);options={};var param=new FieldText("raion",options);pm.addParam(param);options={};var param=new FieldText("raion_code",options);pm.addParam(param);options={};var param=new FieldText("gorod",options);pm.addParam(param);options={};var param=new FieldText("gorod_code",options);pm.addParam(param);options={};var param=new FieldText("naspunkt",options);pm.addParam(param);options={};var param=new FieldText("naspunkt_code",options);pm.addParam(param);options={};var param=new FieldText("ulitza",options);pm.addParam(param);options={};var param=new FieldText("ulitza_code",options);pm.addParam(param);options={};var param=new FieldText("dom",options);pm.addParam(param);options={};var param=new FieldText("korpus",options);pm.addParam(param);options={};var param=new FieldText("kvartira",options);pm.addParam(param);options={};var param=new FieldText("addr_index",options);pm.addParam(param);options={};var param=new FieldText("value",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));var options={};pm.addParam(new FieldInt("error_on_no_road",options));}
ClientDestination_Controller.prototype.addUpdate=function(){ClientDestination_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldText("value",options);pm.addParam(param);options={};var param=new FieldGeomPoint("zone_center",options);pm.addParam(param);options={};var param=new FieldFloat("near_road_lon",options);pm.addParam(param);options={};var param=new FieldFloat("near_road_lat",options);pm.addParam(param);options={};var param=new FieldText("region",options);pm.addParam(param);options={};var param=new FieldText("region_code",options);pm.addParam(param);options={};var param=new FieldText("raion",options);pm.addParam(param);options={};var param=new FieldText("raion_code",options);pm.addParam(param);options={};var param=new FieldText("gorod",options);pm.addParam(param);options={};var param=new FieldText("gorod_code",options);pm.addParam(param);options={};var param=new FieldText("naspunkt",options);pm.addParam(param);options={};var param=new FieldText("naspunkt_code",options);pm.addParam(param);options={};var param=new FieldText("ulitza",options);pm.addParam(param);options={};var param=new FieldText("ulitza_code",options);pm.addParam(param);options={};var param=new FieldText("dom",options);pm.addParam(param);options={};var param=new FieldText("korpus",options);pm.addParam(param);options={};var param=new FieldText("kvartira",options);pm.addParam(param);options={};var param=new FieldText("addr_index",options);pm.addParam(param);options={};var param=new FieldText("value",options);pm.addParam(param);}
ClientDestination_Controller.prototype.addDelete=function(){ClientDestination_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ClientDestination_Controller.prototype.addGetList=function(){ClientDestination_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("client_id",options));pm.addParam(new FieldText("address",options));pm.addParam(new FieldText("value",options));}
ClientDestination_Controller.prototype.addGetObject=function(){ClientDestination_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
ClientDestination_Controller.prototype.add_get_address_gps=function(){var pm=this.addMethodById('get_address_gps');pm.addParam(new FieldText("value"));pm.addParam(new FieldText("region"));pm.addParam(new FieldText("region_code"));pm.addParam(new FieldText("raion"));pm.addParam(new FieldText("raion_code"));pm.addParam(new FieldText("gorod"));pm.addParam(new FieldText("gorod_code"));pm.addParam(new FieldText("naspunkt"));pm.addParam(new FieldText("naspunkt_code"));pm.addParam(new FieldText("ulitza"));pm.addParam(new FieldText("ulitza_code"));pm.addParam(new FieldText("dom"));pm.addParam(new FieldText("korpus"));}
ClientDestination_Controller.prototype.add_complete_address=function(){var pm=this.addMethodById('complete_address');pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldText("address"));pm.addParam(new FieldInt("region"));} 
function Kladr_Controller(servConnector){options={};Kladr_Controller.superclass.constructor.call(this,"Kladr_Controller",servConnector,options);this.add_get_region_list();this.add_get_raion_list();this.add_get_naspunkt_list();this.add_get_gorod_list();this.add_get_ulitsa_list();this.add_get_from_naspunkt();this.add_get_prior_region_list();}
extend(Kladr_Controller,ControllerDb);Kladr_Controller.prototype.add_get_region_list=function(){var pm=this.addMethodById('get_region_list');pm.addParam(new FieldString("pattern"));}
Kladr_Controller.prototype.add_get_raion_list=function(){var pm=this.addMethodById('get_raion_list');pm.addParam(new FieldString("region_code"));pm.addParam(new FieldString("pattern"));}
Kladr_Controller.prototype.add_get_naspunkt_list=function(){var pm=this.addMethodById('get_naspunkt_list');pm.addParam(new FieldString("region_code"));pm.addParam(new FieldString("raion_code"));pm.addParam(new FieldString("pattern"));}
Kladr_Controller.prototype.add_get_gorod_list=function(){var pm=this.addMethodById('get_gorod_list');pm.addParam(new FieldString("region_code"));pm.addParam(new FieldString("raion_code"));pm.addParam(new FieldString("pattern"));}
Kladr_Controller.prototype.add_get_ulitsa_list=function(){var pm=this.addMethodById('get_ulitsa_list');pm.addParam(new FieldString("region_code"));pm.addParam(new FieldString("raion_code"));pm.addParam(new FieldString("naspunkt_code"));pm.addParam(new FieldString("gorod_code"));pm.addParam(new FieldString("pattern"));}
Kladr_Controller.prototype.add_get_from_naspunkt=function(){var pm=this.addMethodById('get_from_naspunkt');pm.addParam(new FieldString("region_code"));pm.addParam(new FieldString("pattern"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));}
Kladr_Controller.prototype.add_get_prior_region_list=function(){var pm=this.addMethodById('get_prior_region_list');} 
function SMSTemplate_Controller(servConnector){options={};options["listModelId"]="SMSTemplateList_Model";options["objModelId"]="SMSTemplateList_Model";SMSTemplate_Controller.superclass.constructor.call(this,"SMSTemplate_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(SMSTemplate_Controller,ControllerDb);SMSTemplate_Controller.prototype.addInsert=function(){SMSTemplate_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Тип SMS";param=new FieldEnum("sms_type",options);options["values"]='client_on_deliv,client_remind,client_deliv_remind,client_change_time,client_on_produced,client_on_leave_prod,driver_first_deliv,driver_new_deliv';pm.addParam(param);options={};options["alias"]="Шаблон";var param=new FieldText("template",options);pm.addParam(param);options={};options["alias"]="Комментарий";var param=new FieldText("comment_text",options);pm.addParam(param);options={};options["alias"]="Поля";var param=new FieldText("fields",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
SMSTemplate_Controller.prototype.addUpdate=function(){SMSTemplate_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Тип SMS";param=new FieldEnum("sms_type",options);options["values"]='client_on_deliv,client_remind,client_deliv_remind,client_change_time,client_on_produced,client_on_leave_prod,driver_first_deliv,driver_new_deliv';pm.addParam(param);options={};options["alias"]="Шаблон";var param=new FieldText("template",options);pm.addParam(param);options={};options["alias"]="Комментарий";var param=new FieldText("comment_text",options);pm.addParam(param);options={};options["alias"]="Поля";var param=new FieldText("fields",options);pm.addParam(param);}
SMSTemplate_Controller.prototype.addDelete=function(){SMSTemplate_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
SMSTemplate_Controller.prototype.addGetList=function(){SMSTemplate_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("sms_type",options));pm.addParam(new FieldString("sms_type_descr",options));pm.addParam(new FieldText("template",options));pm.addParam(new FieldText("fields",options));}
SMSTemplate_Controller.prototype.addGetObject=function(){SMSTemplate_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function EmailTemplate_Controller(servConnector){options={};options["listModelId"]="EmailTemplateList_Model";options["objModelId"]="EmailTemplateList_Model";EmailTemplate_Controller.superclass.constructor.call(this,"EmailTemplate_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(EmailTemplate_Controller,ControllerDb);EmailTemplate_Controller.prototype.addInsert=function(){EmailTemplate_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Тип email";param=new FieldEnum("email_type",options);options["values"]='new_account,reset_pwd,order,order_changed,order_wait_for_client,order_cancel,order_remind,shipment,balance_to_client,order_on_produced';pm.addParam(param);options={};options["alias"]="Шаблон";var param=new FieldText("template",options);pm.addParam(param);options={};options["alias"]="Комментарий";var param=new FieldText("comment_text",options);pm.addParam(param);options={};options["alias"]="Тема";var param=new FieldText("mes_subject",options);pm.addParam(param);options={};options["alias"]="Поля";var param=new FieldText("fields",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
EmailTemplate_Controller.prototype.addUpdate=function(){EmailTemplate_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Тип email";param=new FieldEnum("email_type",options);options["values"]='new_account,reset_pwd,order,order_changed,order_wait_for_client,order_cancel,order_remind,shipment,balance_to_client,order_on_produced';pm.addParam(param);options={};options["alias"]="Шаблон";var param=new FieldText("template",options);pm.addParam(param);options={};options["alias"]="Комментарий";var param=new FieldText("comment_text",options);pm.addParam(param);options={};options["alias"]="Тема";var param=new FieldText("mes_subject",options);pm.addParam(param);options={};options["alias"]="Поля";var param=new FieldText("fields",options);pm.addParam(param);}
EmailTemplate_Controller.prototype.addDelete=function(){EmailTemplate_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
EmailTemplate_Controller.prototype.addGetList=function(){EmailTemplate_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("email_type",options));pm.addParam(new FieldString("email_type_descr",options));pm.addParam(new FieldText("template",options));pm.addParam(new FieldText("fields",options));}
EmailTemplate_Controller.prototype.addGetObject=function(){EmailTemplate_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function DelivCost_Controller(servConnector){options={};options["listModelId"]="DelivCostList_Model";options["objModelId"]="DelivCostList_Model";DelivCost_Controller.superclass.constructor.call(this,"DelivCost_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(DelivCost_Controller,ControllerDb);DelivCost_Controller.prototype.addInsert=function(){DelivCost_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("production_city_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_cost_type",options);options["values"]='city,country';pm.addParam(param);options={};options["alias"]="Стоимость для контрагента";var param=new FieldFloat("cost",options);pm.addParam(param);options={};options["alias"]="Себестоимость";var param=new FieldFloat("cost2",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
DelivCost_Controller.prototype.addUpdate=function(){DelivCost_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("production_city_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_cost_type",options);options["values"]='city,country';pm.addParam(param);param=new FieldEnum("old_deliv_cost_type",{});pm.addParam(param);options={};options["alias"]="Стоимость для контрагента";var param=new FieldFloat("cost",options);pm.addParam(param);options={};options["alias"]="Себестоимость";var param=new FieldFloat("cost2",options);pm.addParam(param);}
DelivCost_Controller.prototype.addDelete=function(){DelivCost_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldEnum("deliv_cost_type",options));}
DelivCost_Controller.prototype.addGetList=function(){DelivCost_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("production_city_id",options));pm.addParam(new FieldString("production_city_descr",options));pm.addParam(new FieldInt("deliv_cost_opt",options));pm.addParam(new FieldString("deliv_cost_opt_descr",options));pm.addParam(new FieldString("deliv_cost_type",options));pm.addParam(new FieldString("deliv_cost_type_descr",options));pm.addParam(new FieldFloat("cost",options));pm.addParam(new FieldFloat("cost2",options));}
DelivCost_Controller.prototype.addGetObject=function(){DelivCost_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function DelivCostOpt_Controller(servConnector){options={};options["listModelId"]="DelivCostOptList_Model";options["objModelId"]="DelivCostOptList_Model";DelivCostOpt_Controller.superclass.constructor.call(this,"DelivCostOpt_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(DelivCostOpt_Controller,ControllerDb);DelivCostOpt_Controller.prototype.addInsert=function(){DelivCostOpt_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("volume_m",options);pm.addParam(param);options={};var param=new FieldFloat("weight_t",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
DelivCostOpt_Controller.prototype.addUpdate=function(){DelivCostOpt_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("volume_m",options);pm.addParam(param);options={};var param=new FieldFloat("weight_t",options);pm.addParam(param);}
DelivCostOpt_Controller.prototype.addDelete=function(){DelivCostOpt_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
DelivCostOpt_Controller.prototype.addGetList=function(){DelivCostOpt_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("volume_m",options));pm.addParam(new FieldFloat("weight_t",options));pm.addParam(new FieldString("descr",options));}
DelivCostOpt_Controller.prototype.addGetObject=function(){DelivCostOpt_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function Payment_Controller(servConnector){options={};Payment_Controller.superclass.constructor.call(this,"Payment_Controller",servConnector,options);this.add_get_schedule();this.add_get_def_debt_details();}
extend(Payment_Controller,ControllerDb);Payment_Controller.prototype.add_get_schedule=function(){var pm=this.addMethodById('get_schedule');pm.addParam(new FieldString("field_sep"));}
Payment_Controller.prototype.add_get_def_debt_details=function(){var pm=this.addMethodById('get_def_debt_details');pm.addParam(new FieldString("field_sep"));} 
function Holiday_Controller(servConnector){options={};options["listModelId"]="HolidayList_Model";options["objModelId"]="HolidayList_Model";Holiday_Controller.superclass.constructor.call(this,"Holiday_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(Holiday_Controller,ControllerDb);Holiday_Controller.prototype.addInsert=function(){Holiday_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldDate("date",options);pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);}
Holiday_Controller.prototype.addUpdate=function(){Holiday_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldDate("date",options);pm.addParam(param);param=new FieldDate("old_date",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);}
Holiday_Controller.prototype.addDelete=function(){Holiday_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldDate("date",options));}
Holiday_Controller.prototype.addGetList=function(){Holiday_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldDate("date",options));pm.addParam(new FieldString("date_str",options));pm.addParam(new FieldString("name",options));}
Holiday_Controller.prototype.addGetObject=function(){Holiday_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldDate("date",options));} 
function ClientDebtPeriod_Controller(servConnector){options={};options["listModelId"]="ClientDebtPeriodList_Model";options["objModelId"]="ClientDebtPeriod_Model";ClientDebtPeriod_Controller.superclass.constructor.call(this,"ClientDebtPeriod_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ClientDebtPeriod_Controller,ControllerDb);ClientDebtPeriod_Controller.prototype.addInsert=function(){ClientDebtPeriod_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("days_from",options);pm.addParam(param);options={};var param=new FieldInt("days_to",options);pm.addParam(param);}
ClientDebtPeriod_Controller.prototype.addUpdate=function(){ClientDebtPeriod_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("days_from",options);pm.addParam(param);param=new FieldInt("old_days_from",{});pm.addParam(param);options={};var param=new FieldInt("days_to",options);pm.addParam(param);}
ClientDebtPeriod_Controller.prototype.addDelete=function(){ClientDebtPeriod_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("days_from",options));}
ClientDebtPeriod_Controller.prototype.addGetList=function(){ClientDebtPeriod_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("days_from",options));pm.addParam(new FieldInt("days_to",options));pm.addParam(new FieldString("days_descr",options));}
ClientDebtPeriod_Controller.prototype.addGetObject=function(){ClientDebtPeriod_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("days_from",options));} 
function ClientPriceListClient_Controller(servConnector){options={};options["listModelId"]="ClientPriceListClientList_Model";ClientPriceListClient_Controller.superclass.constructor.call(this,"ClientPriceListClient_Controller",servConnector,options);this.addInsert();this.addDelete();this.addGetList();}
extend(ClientPriceListClient_Controller,ControllerDb);ClientPriceListClient_Controller.prototype.addInsert=function(){ClientPriceListClient_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("price_list_id",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
ClientPriceListClient_Controller.prototype.addDelete=function(){ClientPriceListClient_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ClientPriceListClient_Controller.prototype.addGetList=function(){ClientPriceListClient_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("price_list_id",options));pm.addParam(new FieldInt("client_id",options));} 
function DeliveryHour_Controller(servConnector){options={};options["listModelId"]="DeliveryHour_Model";options["objModelId"]="DeliveryHour_Model";DeliveryHour_Controller.superclass.constructor.call(this,"DeliveryHour_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(DeliveryHour_Controller,ControllerDb);DeliveryHour_Controller.prototype.addInsert=function(){DeliveryHour_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("h_from",options);pm.addParam(param);options={};var param=new FieldInt("h_to",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
DeliveryHour_Controller.prototype.addUpdate=function(){DeliveryHour_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("h_from",options);pm.addParam(param);options={};var param=new FieldInt("h_to",options);pm.addParam(param);}
DeliveryHour_Controller.prototype.addDelete=function(){DeliveryHour_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
DeliveryHour_Controller.prototype.addGetList=function(){DeliveryHour_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("h_from",options));pm.addParam(new FieldInt("h_to",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("h_from");}
DeliveryHour_Controller.prototype.addGetObject=function(){DeliveryHour_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function ClientActivity_Controller(servConnector){options={};options["listModelId"]="ClientActivityList_Model";options["objModelId"]="ClientActivity_Model";ClientActivity_Controller.superclass.constructor.call(this,"ClientActivity_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ClientActivity_Controller,ControllerDb);ClientActivity_Controller.prototype.addInsert=function(){ClientActivity_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
ClientActivity_Controller.prototype.addUpdate=function(){ClientActivity_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);}
ClientActivity_Controller.prototype.addDelete=function(){ClientActivity_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ClientActivity_Controller.prototype.addGetList=function(){ClientActivity_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldString("match_1c",options));}
ClientActivity_Controller.prototype.addGetObject=function(){ClientActivity_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function SertType_Controller(servConnector){options={};options["listModelId"]="SertType_Model";options["objModelId"]="SertType_Model";SertType_Controller.superclass.constructor.call(this,"SertType_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.add_set_xslt_pattern();this.add_get_xslt_pattern();this.add_check_pattern();}
extend(SertType_Controller,ControllerDb);SertType_Controller.prototype.addInsert=function(){SertType_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("xslt_pattern",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
SertType_Controller.prototype.addUpdate=function(){SertType_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("xslt_pattern",options);pm.addParam(param);}
SertType_Controller.prototype.addDelete=function(){SertType_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
SertType_Controller.prototype.addGetList=function(){SertType_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldString("xslt_pattern",options));}
SertType_Controller.prototype.addGetObject=function(){SertType_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
SertType_Controller.prototype.add_set_xslt_pattern=function(){var pm=this.addMethodById('set_xslt_pattern');pm.addParam(new FieldString("xslt_pattern"));}
SertType_Controller.prototype.add_get_xslt_pattern=function(){var pm=this.addMethodById('get_xslt_pattern');pm.addParam(new FieldInt("id"));}
SertType_Controller.prototype.add_check_pattern=function(){var pm=this.addMethodById('check_pattern');pm.addParam(new FieldInt("sert_type_id"));} 
function SertTypeAttr_Controller(servConnector){options={};options["listModelId"]="SertTypeAttr_Model";options["objModelId"]="SertTypeAttr_Model";SertTypeAttr_Controller.superclass.constructor.call(this,"SertTypeAttr_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(SertTypeAttr_Controller,ControllerDb);SertTypeAttr_Controller.prototype.addInsert=function(){SertTypeAttr_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("sert_type_id",options);pm.addParam(param);options={};var param=new FieldString("attr_text",options);pm.addParam(param);options={};var param=new FieldString("attr_val_norm",options);pm.addParam(param);options={};var param=new FieldString("attr_val",options);pm.addParam(param);options={};var param=new FieldFloat("attr_val_min",options);pm.addParam(param);options={};var param=new FieldFloat("attr_val_max",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
SertTypeAttr_Controller.prototype.addUpdate=function(){SertTypeAttr_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("sert_type_id",options);pm.addParam(param);options={};var param=new FieldString("attr_text",options);pm.addParam(param);options={};var param=new FieldString("attr_val_norm",options);pm.addParam(param);options={};var param=new FieldString("attr_val",options);pm.addParam(param);options={};var param=new FieldFloat("attr_val_min",options);pm.addParam(param);options={};var param=new FieldFloat("attr_val_max",options);pm.addParam(param);}
SertTypeAttr_Controller.prototype.addDelete=function(){SertTypeAttr_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
SertTypeAttr_Controller.prototype.addGetList=function(){SertTypeAttr_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("sert_type_id",options));pm.addParam(new FieldString("attr_text",options));pm.addParam(new FieldString("attr_val_norm",options));pm.addParam(new FieldString("attr_val",options));pm.addParam(new FieldFloat("attr_val_min",options));pm.addParam(new FieldFloat("attr_val_max",options));}
SertTypeAttr_Controller.prototype.addGetObject=function(){SertTypeAttr_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function TrackerServer_Controller(servConnector){options={};options["listModelId"]="TrackerServer_Model";options["objModelId"]="TrackerServer_Model";TrackerServer_Controller.superclass.constructor.call(this,"TrackerServer_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(TrackerServer_Controller,ControllerDb);TrackerServer_Controller.prototype.addInsert=function(){TrackerServer_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="IP адрес";var param=new FieldString("ip",options);pm.addParam(param);options={};options["alias"]="Описание";var param=new FieldString("name",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
TrackerServer_Controller.prototype.addUpdate=function(){TrackerServer_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="IP адрес";var param=new FieldString("ip",options);pm.addParam(param);options={};options["alias"]="Описание";var param=new FieldString("name",options);pm.addParam(param);}
TrackerServer_Controller.prototype.addDelete=function(){TrackerServer_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
TrackerServer_Controller.prototype.addGetList=function(){TrackerServer_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("ip",options));pm.addParam(new FieldString("name",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("id");}
TrackerServer_Controller.prototype.addGetObject=function(){TrackerServer_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function Tracker_Controller(servConnector){options={};options["listModelId"]="TrackerList_Model";options["objModelId"]="TrackerList_Model";Tracker_Controller.superclass.constructor.call(this,"Tracker_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(Tracker_Controller,ControllerDb);Tracker_Controller.prototype.addInsert=function(){Tracker_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("id",options);pm.addParam(param);options={};var param=new FieldInt("tracker_server_id",options);pm.addParam(param);options={};var param=new FieldString("sim_number",options);pm.addParam(param);options={};var param=new FieldString("sim_id",options);pm.addParam(param);}
Tracker_Controller.prototype.addUpdate=function(){Tracker_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldString("id",options);pm.addParam(param);param=new FieldString("old_id",{});pm.addParam(param);options={};var param=new FieldInt("tracker_server_id",options);pm.addParam(param);options={};var param=new FieldString("sim_number",options);pm.addParam(param);options={};var param=new FieldString("sim_id",options);pm.addParam(param);}
Tracker_Controller.prototype.addDelete=function(){Tracker_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldString("id",options));}
Tracker_Controller.prototype.addGetList=function(){Tracker_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldString("id",options));pm.addParam(new FieldInt("tracker_server_id",options));pm.addParam(new FieldString("tracker_server_descr",options));pm.addParam(new FieldString("sim_number",options));pm.addParam(new FieldString("sim_id",options));}
Tracker_Controller.prototype.addGetObject=function(){Tracker_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldString("id",options));} 
function UserWarehouse_Controller(servConnector){options={};options["listModelId"]="UserWarehouseList_Model";options["objModelId"]="UserWarehouseList_Model";UserWarehouse_Controller.superclass.constructor.call(this,"UserWarehouse_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(UserWarehouse_Controller,ControllerDb);UserWarehouse_Controller.prototype.addInsert=function(){UserWarehouse_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
UserWarehouse_Controller.prototype.addUpdate=function(){UserWarehouse_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);}
UserWarehouse_Controller.prototype.addDelete=function(){UserWarehouse_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
UserWarehouse_Controller.prototype.addGetList=function(){UserWarehouse_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("user_id",options));pm.addParam(new FieldInt("warehouse_id",options));pm.addParam(new FieldString("warehouse_descr",options));}
UserWarehouse_Controller.prototype.addGetObject=function(){UserWarehouse_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function SMSForSending_Controller(servConnector){options={};options["listModelId"]="SMSForSendingList_Model";SMSForSending_Controller.superclass.constructor.call(this,"SMSForSending_Controller",servConnector,options);this.addGetList();}
extend(SMSForSending_Controller,ControllerDb);SMSForSending_Controller.prototype.addGetList=function(){SMSForSending_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("tel",options));pm.addParam(new FieldText("body",options));pm.addParam(new FieldDateTime("date_time",options));pm.addParam(new FieldBool("sent",options));pm.addParam(new FieldDateTime("sent_date_time",options));pm.addParam(new FieldBool("delivered",options));pm.addParam(new FieldDateTime("delivered_date_time",options));pm.addParam(new FieldEnum("sms_type",options));pm.addParam(new FieldText("sms_id",options));} 
function MailForSending_Controller(servConnector){options={};options["listModelId"]="MailForSendingList_Model";MailForSending_Controller.superclass.constructor.call(this,"MailForSending_Controller",servConnector,options);this.addGetList();}
extend(MailForSending_Controller,ControllerDb);MailForSending_Controller.prototype.addGetList=function(){MailForSending_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldDateTime("date_time",options));pm.addParam(new FieldString("from_addr",options));pm.addParam(new FieldString("from_name",options));pm.addParam(new FieldString("to_addr",options));pm.addParam(new FieldString("to_name",options));pm.addParam(new FieldString("reply_addr",options));pm.addParam(new FieldString("reply_name",options));pm.addParam(new FieldText("body",options));pm.addParam(new FieldString("sender_addr",options));pm.addParam(new FieldString("subject",options));pm.addParam(new FieldBool("sent",options));pm.addParam(new FieldDateTime("sent_date_time",options));pm.addParam(new FieldText("send_error",options));pm.addParam(new FieldEnum("email_type",options));} 
function Holiday_Controller(servConnector){options={};options["listModelId"]="HolidayList_Model";options["objModelId"]="HolidayList_Model";Holiday_Controller.superclass.constructor.call(this,"Holiday_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(Holiday_Controller,ControllerDb);Holiday_Controller.prototype.addInsert=function(){Holiday_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldDate("date",options);pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);}
Holiday_Controller.prototype.addUpdate=function(){Holiday_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldDate("date",options);pm.addParam(param);param=new FieldDate("old_date",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);}
Holiday_Controller.prototype.addDelete=function(){Holiday_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldDate("date",options));}
Holiday_Controller.prototype.addGetList=function(){Holiday_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldDate("date",options));pm.addParam(new FieldString("date_str",options));pm.addParam(new FieldString("name",options));}
Holiday_Controller.prototype.addGetObject=function(){Holiday_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldDate("date",options));} 
function PPViewReport(id,options){PPViewReport.superclass.constructor.call(this,id,options);}
extend(PPViewReport,ViewReport); 
function ConstInline_View(id,options){options=options||{};ConstInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new EditString("ConstantList_Model_val",{"attrs":{"name":"val"}}),{"modelId":"ConstantList_Model","valueFieldId":"val_descr","keyFieldIds":null},{"valueFieldId":"val","keyFieldIds":null});}
extend(ConstInline_View,ViewInlineGridEditConst);function ConstDefStoreInline_View(id,options){options=options||{};ConstDefStoreInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new EditObject("ConstantList_Model_val",{"attrs":{"name":"val"},"methodId":"get_list","modelId":"StoreList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":["val_id"],"controller":new Store_Controller(options.connect),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":StoreList_View}),{"modelId":"ConstantList_Model","valueFieldId":"val_descr","keyFieldIds":null},{"valueFieldId":"val","keyFieldIds":null});}
extend(ConstDefStoreInline_View,ViewInlineGridEditConst); 
function ConstantList_View(id,options){options=options||{};options.title="Константы";ConstantList_View.superclass.constructor.call(this,id,options);var controller=new Constant_Controller(options.connect);var head=new GridHead();var row=new GridRow("ConstantList_row1");row.addElement(new GridDbHeadCell("ConstantList_col_id",{"visible":false,"readBind":{"valueFieldId":"id"},"keyCol":true}));row.addElement(new GridDbHeadCell("ConstantList_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));row.addElement(new GridDbHeadCell("ConstantList_col_descr",{"value":"Описание","readBind":{"valueFieldId":"descr"}}));row.addElement(new GridDbHeadCell("ConstantList_col_val",{"value":"Значение","readBind":{"valueFieldId":"val_descr"}}));head.addElement(row);this.addElement(new GridDbConst("ConstantList_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ConstantList_Model","editViewClasses":{"def_store":ConstDefStoreInline_View},"editInline":true,"pagination":null,"commandPanel":new GridCommands(null,{"noInsert":true,"noDelete":true,"noCopy":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":null,"winObj":options.winObj}));}
extend(ConstantList_View,ViewList); 
function ReportVariantList_View(id,options){options=options||{};ReportVariantList_View.superclass.constructor.call(this,id,options);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":options.readController,"readModelId":"ReportVariant_Model","editViewClass":ReportVariantInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"noPrint":true,"noRefresh":true,"noCopy":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj,"methParams":options.methParams}));}
extend(ReportVariantList_View,ViewList); 
function ReportVariantInline_View(id,options){options=options||{};ReportVariantInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":"ReportVariant_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":100,"size":50,"required":"required"}}),{"modelId":"ReportVariant_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});}
extend(ReportVariantInline_View,ViewInlineGridEdit); 
function UserDialog_View(id,options){options=options||{};options.readMethodId=options.readMethodId||this.DEF_READ_METH_ID;options.writeController=options.writeController||options.readController;UserDialog_View.superclass.constructor.call(this,id,options);var ctrl_cl="input-group "+get_bs_col();this.addDataControl(new EditNum("UserDialog_Model_id",{"labelCaption":"Код:","name":"id","attrs":{"disabled":"disabled","size":5},"noSelect":true,"editContClassName":ctrl_cl+"2"}),{"modelId":"UserDialog_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString("UserDialog_Model_name",{"labelCaption":"Логин:","name":"name","attrs":{"maxlength":100,"size":50,"required":"required"},"editContClassName":ctrl_cl+"4"}),{"modelId":"UserDialog_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});this.addDataControl(new EditString("UserDialog_Model_name_full",{"labelCaption":"ФИО:","name":"name_full","editContClassName":ctrl_cl+"4","attrs":{"maxlength":150,"size":80,"required":"required","title":"ФИО физического лица"}}),{"modelId":"UserDialog_Model","valueFieldId":"name_full","keyFieldIds":null},{"valueFieldId":"name_full","keyFieldIds":null});this.addDataControl(new EditSelectObject("UserDialog_Model_role_type",{"labelCaption":"Роль:","name":"","editContClassName":ctrl_cl+"4","methodId":"get_enum_list","modelId":"EnumList_Model","lookupValueFieldId":"descr","lookupKeyFieldIds":["id"],"keyFieldIds":["role_id"],"controller":new Enum_Controller(new ServConnector(HOST_NAME)),"noOpen":true,"listView":null,"noAutoRefresh":false,"methParams":{"id":"role_types"},"defaultId":"sales_manager"}),{"modelId":"UserDialog_Model","valueFieldId":"role_descr","keyFieldIds":["role_id"]},{"valueFieldId":null,"keyFieldIds":["role_id"]});this.addDataControl(new EditString("UserDialog_Model_ext_login",{"labelCaption":"Имя пользователя в 1с:","editContClassName":ctrl_cl+"4","name":"ext_login","attrs":{"maxlength":100,"size":50,"title":"Имя пользователя как оно задано в 1с"},"alwaysUpdate":true}),{"modelId":"UserDialog_Model","valueFieldId":"ext_login","keyFieldIds":null},{"valueFieldId":"ext_login","keyFieldIds":null});this.addDataControl(new EditString("UserDialog_Model_email",{"labelCaption":"Эл.почта:","name":"email","editContClassName":ctrl_cl+"4","attrs":{"maxlength":50,"size":20}}),{"modelId":"UserDialog_Model","valueFieldId":"email","keyFieldIds":null},{"valueFieldId":"email","keyFieldIds":null});this.addDataControl(new EditString("UserDialog_Model_tel_ext",{"labelCaption":"Внутр.номер телефона:","name":"tel_ext","editContClassName":ctrl_cl+"2","attrs":{"maxlength":4,"size":8}}),{"modelId":"UserDialog_Model","valueFieldId":"tel_ext","keyFieldIds":null},{"valueFieldId":"tel_ext","keyFieldIds":null});var sub_cont=new ControlContainer(uuid(),"div",{});this.m_warehouseList=new UserWarehouseList_View("UserWarehouseList",options);sub_cont.addElement(this.m_warehouseList);this.addControl(sub_cont);}
extend(UserDialog_View,ViewDialog);UserDialog_View.prototype.onGetData=function(resp){UserDialog_View.superclass.onGetData.call(this,resp);var id=this.getDataControl("UserDialog_Model_id").control.getAttr("old_id");if(id&&this.m_warehouseList){this.m_warehouseList.setUserId(id);this.m_warehouseList.m_grid.setEnabled(true);this.m_warehouseList.m_grid.onRefresh();}} 
function UserAccount_View(id,options){options=options||{};options.readMethodId="get_account";options.writeMethodId="update";var PWD_MIN_LEN=6;var contr=new User_Controller(new ServConnector(HOST_NAME));options.readController=contr;options.writeController=contr;UserAccount_View.superclass.constructor.call(this,id,options);var self=this;this.m_keyEvent=null;this.m_ctrlCancel=null;this.m_ctrlOk=null;var model="User_Model";var ctrl_cont_class="input-group "+get_bs_col()+"2";var label_class="control-label "+get_bs_col()+"3";var cont=new ControlContainer(id+"_panel","div",{});var ctrl=new Edit(id+"_id",{"name":"id","visible":false});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});cont.addElement(ctrl);var ctrl=new EditString(id+"_name",{"labelCaption":"Логин:","name":"name","editContClassName":ctrl_cont_class,"labelClassName":label_class,"attrs":{"maxlength":50,"size":20,"required":"required"}});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});cont.addElement(ctrl);var ctrl=new EditString(id+"_name_full",{"labelCaption":"ФИО:","name":"name_full","editContClassName":ctrl_cont_class,"labelClassName":label_class,"attrs":{"maxlength":100,"size":50,"required":"required"}});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"name_full","keyFieldIds":null},{"valueFieldId":"name_full","keyFieldIds":null});cont.addElement(ctrl);var ctrl=new EditString(id+"_email",{"labelCaption":"Эл.почта:","name":"email","editContClassName":ctrl_cont_class,"labelClassName":label_class,"attrs":{"maxlength":50,"size":20}});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"email","keyFieldIds":null},{"valueFieldId":"email","keyFieldIds":null});cont.addElement(ctrl);var ctrl=new EditCellPhone(id+"_cel_phone",{"labelCaption":"Номер телефона:","editContClassName":ctrl_cont_class,"labelClassName":label_class,"name":"cel_phone"});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"cel_phone","keyFieldIds":null},{"valueFieldId":"cel_phone","keyFieldIds":null});cont.addElement(ctrl);this.m_pwdCtrl=new EditPassword("UserDialog_Model_pwd",{"labelCaption":"Новый пароль:","name":"pwd","editContClassName":ctrl_cont_class,"labelClassName":label_class,"attrs":{"maxlength":50,"size":20,"required":"required"},"minLength":PWD_MIN_LEN});this.bindControl(this.m_pwdCtrl,{"modelId":model},{"valueFieldId":"pwd","keyFieldIds":null});cont.addElement(this.m_pwdCtrl);this.m_pwdConfCtrl=new EditPassword("pwd_conf",{"labelCaption":"Подтверждение:","name":"pwd_conf","editContClassName":ctrl_cont_class,"labelClassName":label_class,"attrs":{"maxlength":50,"size":20,"required":"required"},"minLength":PWD_MIN_LEN});cont.addElement(this.m_pwdConfCtrl);this.m_pwdConfInfCtrl=new Control("pwd_conf_inf","div",{"className":"error"});cont.addElement(this.m_pwdConfInfCtrl);cont.addElement(new Button(id+"btnOk",{"caption":"Изменить","onClick":function(){var pwd=self.m_pwdCtrl.getValue();var conf=self.m_pwdConfCtrl.getValue();if(pwd!=conf){self.m_pwdConfInfCtrl.setValue("Пароли отличаются");}
else{self.onClickOk();}},"className":"btn btn-default","attrs":{"title":"записать изменения и отправить эл.письмо пользователю"}}));this.addControl(cont);if(SERV_VARS.ROLE_ID=="admin"){var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"список пользователей","dataTarget":p_id,"attrs":{"title":"показать/скрыть пользователей"}}));var cont=new ControlContainer(p_id,"div",{"className":"collapse"});cont.addElement(new UserList_View("UserList_View"));cont_m.addElement(cont);this.addElement(cont_m);}}
extend(UserAccount_View,ViewDialog);UserAccount_View.prototype.toDOM=function(parent){var self=this;this.m_outCont=new ControlContainer(uuid(),"div",{className:"panel panel-primary"});this.m_outContBody=new ControlContainer(uuid(),"div",{className:"panel-body"});this.m_inCont=new ControlContainer(uuid(),"div",{className:"panel panel-default"});UserAccount_View.superclass.toDOM.call(this,this.m_inCont.m_node);this.m_inCont.toDOM(this.m_outContBody.m_node);this.m_outContBody.toDOM(this.m_outCont.m_node);this.m_outCont.toDOM(parent);var check_pwd=function(){var mes="";var pwd=self.m_pwdCtrl.getValue();var conf=self.m_pwdConfCtrl.getValue();if(pwd.length&&conf.length&&pwd!=conf){mes="Пароли отличаются";}
self.m_pwdConfInfCtrl.setValue(mes);}
this.m_pwdCtrl.m_node.onkeyup=check_pwd;this.m_pwdConfCtrl.m_node.onkeyup=check_pwd;this.readData(true);}
UserAccount_View.prototype.onClickOk=function(){this.writeData();this.readData(true);}
UserAccount_View.prototype.removeDOM=function(){UserAccount_View.superclass.removeDOM.call(this);this.m_inCont.removeDOM();this.m_outContBody.removeDOM();this.m_outCont.removeDOM();} 
function UserList_View(id,options){options=options||{};options.title="Пользователи";UserList_View.superclass.constructor.call(this,id,options);var controller=new User_Controller(new ServConnector(HOST_NAME));var head=new GridHead();var row=new GridRow("UserList_row1");row.addElement(new GridDbHeadCell("UserList_col_id",{"value":"Код","readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell("UserList_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));row.addElement(new GridDbHeadCell("UserList_col_role_descr",{"value":"Роль","readBind":{"valueFieldId":"role_descr"}}));row.addElement(new GridDbHeadCell("UserList_col_warehouse_descr",{"value":"Подразд.","readBind":{"valueFieldId":"warehouse_descr"}}));row.addElement(new GridDbHeadCellBool("UserList_col_match_1c",{"value":"Соотв.1с","readBind":{"valueFieldId":"match_1c"}}));head.addElement(row);this.addElement(new GridDb("grid_UserList",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"UserList_Model","editViewClass":UserDialog_View,"editInline":false,"pagination":null,"commandPanel":new GridCommands("UserListCommands",{"controller":controller}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(UserList_View,ViewList); 
function ClientRegisterViewDialog(id,options){options=options||{};options.tagName="div";ClientRegisterViewDialog.superclass.constructor.call(this,id,options);var self=this;this.m_ctrlOk=new Button(id+"btnOk",{"caption":"Зарегистрировать","onClick":function(){self.writeData();if(self.m_lastWriteResult){top.location.href=HOST_NAME+'index.php';}},"attrs":{"hint":"Зарегистрировать"},"className":"viewBtn"});}
extend(ClientRegisterViewDialog,ViewDialog);function ClientRegister_View(id,options){options=options||{};options.writeController=new Client_Controller(options.connect);options.insertMethodId="register";ClientRegister_View.superclass.constructor.call(this,id,options);var attrs={};ClientAttrs(attrs);var cont=new ControlContainer("p_org","div",{"className":"panel"});cont.addElement(new Control("p_org_l","span",{"value":"Организация","className":"panel_l"}));this.bindControl(attrs.name,{},{"valueFieldId":"name","keyFieldIds":null});cont.addElement(attrs.name);this.addControl(cont);var cont=new ControlContainer("p_attrs","div",{"className":"panel"});cont.addElement(new Control("p_attrs_l","span",{"value":"Реквизиты","className":"panel_l"}));var sub_cont=new ControlContainer("attrl_sub_l","div",{"className":"panel_left"});this.bindControl(attrs.inn,{},{"valueFieldId":"inn","keyFieldIds":null});sub_cont.addElement(attrs.inn);this.bindControl(attrs.kpp,{},{"valueFieldId":"kpp","keyFieldIds":null});sub_cont.addElement(attrs.kpp);this.m_addrRegCtrl=attrs.addr_reg;this.bindControl(this.m_addrRegCtrl,{},{"valueFieldId":"addr_reg","keyFieldIds":null});sub_cont.addElement(this.m_addrRegCtrl);this.bindControl(attrs.addr_mail_same_as_reg,{},{"valueFieldId":"addr_mail_same_as_reg","keyFieldIds":null});sub_cont.addElement(attrs.addr_mail_same_as_reg);this.m_addrMailCtrl=attrs.addr_mail;this.bindControl(attrs.addr_mail,{},{"valueFieldId":"addr_mail","keyFieldIds":null});sub_cont.addElement(attrs.addr_mail);this.bindControl(attrs.telephones,{},{"valueFieldId":"telephones","keyFieldIds":null});sub_cont.addElement(attrs.telephones);cont.addElement(sub_cont);var sub_cont=new ControlContainer("attrl_sub_r","div",{"className":"panel_right"});this.bindControl(attrs.acc,{},{"valueFieldId":"acc","keyFieldIds":null});sub_cont.addElement(attrs.acc);this.bindControl(attrs.bank_name,{},{"valueFieldId":"bank_name","keyFieldIds":null});sub_cont.addElement(attrs.bank_name);this.bindControl(attrs.bank_code,{},{"valueFieldId":"bank_code","keyFieldIds":null});sub_cont.addElement(attrs.bank_code);this.bindControl(attrs.bank_acc,{},{"valueFieldId":"bank_acc","keyFieldIds":null});sub_cont.addElement(attrs.bank_acc);this.bindControl(attrs.okpo,{},{"valueFieldId":"okpo","keyFieldIds":null});sub_cont.addElement(attrs.okpo);this.bindControl(attrs.ogrn,{},{"valueFieldId":"ogrn","keyFieldIds":null});sub_cont.addElement(attrs.ogrn);cont.addElement(sub_cont);this.addControl(cont);var cont=new ControlContainer("p_log","div",{"className":"panel"});cont.addElement(new Control("p_log_l","span",{"value":"Ответственный","className":"panel_l"}));var sub_cont=new ControlContainer("logl_l","div",{"className":"panel_left"});var ctrl=new EditString("Client_user_name_full",{"labelCaption":"ФИО:","name":"user_name_full","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":150,"size":70,"required":"required"}});this.bindControl(ctrl,{},{"valueFieldId":"user_name_full","keyFieldIds":null});sub_cont.addElement(ctrl);var ctrl=new EditString("Client_user_email",{"labelCaption":"email:","name":"user_email","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":50,"size":25,"required":"required"}});this.bindControl(ctrl,{},{"valueFieldId":"user_email","keyFieldIds":null});sub_cont.addElement(ctrl);var ctrl=new EditCellPhone("Client_user_phone",{"labelCaption":"Телефон:","name":"user_phone","attrs":{"size":25},"buttonClear":false,"tableLayout":false,"attrs":{"required":"required"}});this.bindControl(ctrl,{},{"valueFieldId":"user_phone","keyFieldIds":null});sub_cont.addElement(ctrl);cont.addElement(sub_cont);var sub_cont=new ControlContainer("logl_r","div",{"className":"panel_right"});var ctrl=new EditString("Client_user_name",{"labelCaption":"Логин:","name":"user_name","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":50,"size":25,"required":"required"}});this.bindControl(ctrl,{},{"valueFieldId":"user_name","keyFieldIds":null});sub_cont.addElement(ctrl);var ctrl=new EditPassword("Client_user_pwd",{"labelCaption":"Пароль:","name":"user_pwd","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":50,"size":25,"required":"required"}});this.bindControl(ctrl,{},{"valueFieldId":"user_pwd","keyFieldIds":null});sub_cont.addElement(ctrl);cont.addElement(sub_cont);this.addControl(cont);}
extend(ClientRegister_View,ClientRegisterViewDialog);ClientRegister_View.prototype.toDOM=function(parent){ClientRegister_View.superclass.toDOM.call(this,parent);var self=this;var ctrl_same_addr=this.getViewControl("Client_addr_mail_same_as_reg");EventHandler.addEvent(ctrl_same_addr.m_node,"click",function(){if(ctrl_same_addr.m_node.checked){self.m_addrMailCtrl.setValue("");}
self.m_addrMailCtrl.setEnabled(!ctrl_same_addr.m_node.checked);},true);var ctrl_inn=this.getViewControl("Client_inn");EventHandler.addEvent(ctrl_inn.m_node,"blur",function(){var inn=ctrl_inn.getValue();if(inn){ctrl_inn.setComment("");var contr=new Client_Controller(new ServConnector(HOST_NAME));contr.run("check_on_inn",{async:true,params:{"inn":inn},cont:self,err:function(resp,errCode,errStr){ctrl_inn.setComment(errStr);}});}});var ctrl_user_name=this.getViewControl("Client_user_name");EventHandler.addEvent(ctrl_user_name.m_node,"blur",function(){var user_name=ctrl_user_name.getValue();if(user_name){ctrl_user_name.setComment("");var contr=new Client_Controller(new ServConnector(HOST_NAME));contr.run("check_on_user_name",{async:true,params:{"user_name":user_name},cont:self,err:function(resp,errCode,errStr){ctrl_user_name.setComment(errStr);}});}});}
ClientRegister_View.prototype.onClickCancel=function(){this.getOnClose().call(this,0);} 
function Delivery_View(id,options){options=options||{};Delivery_View.superclass.constructor.call(this,id,options);var cont=new ControlContainer("deliv_filter","div",{"className":"panelf"});this.m_filter=new PeriodFilter("delivery_filter",{"period":"day","valueFieldId":"delivery_plan_date"});cont.addElement(this.m_filter);this.addElement(cont);var self=this;if(SERV_VARS.ROLE_ID!="client"){var cont=new ControlContainer("deliv_ass","div",{"className":"panel panel-default"});this.m_assOrderList=new DelivAssignedOrderList_View("DelivAssignedOrderList",{"filter":this.m_filter});cont.addElement(this.m_assOrderList);this.addElement(cont);var cont=new ControlContainer("deliv_unass","div",{"className":"panel panel-default"});this.m_unassOrderList=new DelivUnassignedOrderList_View("DelivUnassignedOrderList",{"filter":this.m_filter,"filterAllOrders":this.m_filterAllOrders});cont.addElement(this.m_unassOrderList);this.addElement(cont);var filter_refr_func=function(){self.m_assOrderList.m_grid.onRefresh();self.m_unassOrderList.m_grid.onRefresh();};this.m_filter.setOnRefresh(function(){self.m_assOrderList.m_grid.onRefresh();self.m_unassOrderList.m_grid.onRefresh();});this.m_assOrderList.m_grid.m_unassGrid=this.m_unassOrderList.m_grid;this.addMap();this.m_assOrderList.m_grid.m_map=this.m_map;this.m_unassOrderList.m_grid.m_map=this.m_map;this.m_filter.setClickContext(this);this.m_filter.setOnRefresh(filter_refr_func);}
else{var cont=new ControlContainer("deliv_ass","div",{"className":"panel panel-default"});this.m_assOrderList=new DelivAssignedOrderForClient_View("DelivAssignedOrderList",{"filter":this.m_filter});cont.addElement(this.m_assOrderList);this.addElement(cont);}}
extend(Delivery_View,ViewList);Delivery_View.prototype.addMap=function(){this.m_mapCont=new ControlContainer("deliv_map","div",{"className":"panel panel-default"});this.m_map=new DeliveryMap_View("map_cont",{"filter":this.m_filter});this.m_mapCont.addElement(this.m_map);this.addElement(this.m_mapCont);}
Delivery_View.prototype.toDOM=function(parent){Delivery_View.superclass.toDOM.call(this,parent);if(SERV_VARS.ROLE_ID=="client"){this.m_assOrderList.m_grid.m_deliveryView=this;this.m_assOrderList.m_grid.onRefresh();}} 
function DOCOrderList_View(id,options){options=options||{};DOCOrderList_View.superclass.constructor.call(this,id,options);var self=this;this.m_evToggleNewOrders=function(){self.toggleGridView(self.m_ctrlViewNewOrders,false);};this.m_evToggleOrders=function(){self.toggleGridView(self.m_ctrlViewOrders,true);};var cont=new ControlContainer("Orders_cmd","div",{"className":"panel_cmd"});cont.addElement(new CurrentDateTime("current_date",{"sync":true,"className":"text-right text-info"}));this.addElement(cont);if(SERV_VARS.ROLE_ID=="production"){this.addElement(new ControlContainer(id+"_warehouse","span",{"value":SERV_VARS.WAREHOUSE_DESCR,className:"text-right text-info"}));}
if(SERV_VARS.ROLE_ID=="sales_manager"||SERV_VARS.ROLE_ID=="boss"||SERV_VARS.ROLE_ID=="admin"||SERV_VARS.ROLE_ID=="representative"){var cont=new ControlContainer(id+"_cont_new_orders","div",{"className":"panel panel-default"});this.m_ctrlViewNewOrders=new DOCOrderNewList_View(id+"_DOCOrderNewList_View",{"client":(SERV_VARS.ROLE_ID!="client"),"className":(CONSTANT_VALS.newOrdersCallapsed)?"collapse":"","number":true,"noAutoRefresh":false,"refreshInterval":CONSTANT_VALS.db_controls_refresh_sec*1000,"warehouse":true,"total":true});cont.addElement(this.m_ctrlViewNewOrders);this.addElement(cont);}
if(SERV_VARS.ROLE_ID=="client"||SERV_VARS.ROLE_ID=="sales_manager"||SERV_VARS.ROLE_ID=="boss"||SERV_VARS.ROLE_ID=="admin"||SERV_VARS.ROLE_ID=="production"||SERV_VARS.ROLE_ID=="marketing"||SERV_VARS.ROLE_ID=="representative"){this.m_ctrlViewOrders=new DOCOrderCurrentList_View(id+"_DOCOrderCurrentList_View",{"client":(SERV_VARS.ROLE_ID!="client"),"products":true,"warehouse":true,"ext_ship_num":true,"delivery_fact_date":true,"number":(SERV_VARS.ROLE_ID!="client"),"client_number":(SERV_VARS.ROLE_ID=="client"),"paid":true,"printed":(SERV_VARS.ROLE_ID!="client"),"customer_survey_date":(SERV_VARS.ROLE_ID=="boss"||SERV_VARS.ROLE_ID=="admin"),"filter":true,"submit_user":(SERV_VARS.ROLE_ID=="sales_manager"||SERV_VARS.ROLE_ID=="boss"||SERV_VARS.ROLE_ID=="admin"||SERV_VARS.ROLE_ID=="production"||SERV_VARS.ROLE_ID=="representative"),"className":(CONSTANT_VALS.ordersCallapsed)?"collapse":"","noAutoRefresh":CONSTANT_VALS.ordersCallapsed,"refreshInterval":(CONSTANT_VALS.ordersCallapsed)?0:CONSTANT_VALS.db_controls_refresh_sec*1000,});var cont=new ControlContainer(id+"_cont_current_orders","div",{"className":"panel panel-default"});if(this.m_ctrlViewNewOrders){this.m_ctrlViewNewOrders.m_grid.m_currentGrid=this.m_ctrlViewOrders.m_grid;}
cont.addElement(this.m_ctrlViewOrders);this.addElement(cont);}}
extend(DOCOrderList_View,ViewList);DOCOrderList_View.prototype.toDOM=function(parent){DOCOrderList_View.superclass.toDOM.call(this,parent);if(SERV_VARS.ROLE_ID!="client"&&SERV_VARS.ROLE_ID!="production"){EventHandler.addEvent(nd("MainView_DOCOrderNewList_View_title"),"click",this.m_evToggleNewOrders);EventHandler.addEvent(nd("MainView_DOCOrderCurrentList_View_title"),"click",this.m_evToggleOrders);}}
DOCOrderList_View.prototype.removeDOM=function(){if(SERV_VARS.ROLE_ID!="client"&&SERV_VARS.ROLE_ID!="production"){EventHandler.removeEvent(nd("MainView_DOCOrderNewList_View_title"),"click",this.m_evToggleNewOrders);EventHandler.removeEvent(nd("MainView_DOCOrderCurrentList_View_title"),"click",this.m_evToggleOrders);}
DOCOrderList_View.superclass.removeDOM.call(this);}
DOCOrderList_View.prototype.toggleGridView=function(gridView,toggleAutoRefresh){var callapsed=DOMHandler.hasClass(gridView.m_node,"collapse");if(callapsed){DOMHandler.removeClass(gridView.m_node,"collapse");if(toggleAutoRefresh){gridView.m_grid.setRefreshInterval(CONSTANT_VALS.db_controls_refresh_sec*1000);gridView.m_grid.onRefresh();}}
else{if(toggleAutoRefresh){gridView.m_grid.setRefreshInterval(0);}
DOMHandler.addClass(gridView.m_node,"collapse");}
if(gridView.getId()=="MainView_DOCOrderCurrentList_View"){CONSTANT_VALS.ordersCallapsed=!callapsed;}
else{CONSTANT_VALS.newOrdersCallapsed=!callapsed;}} 
function PaymentList_View(id,options){options=options||{};PaymentList_View.superclass.constructor.call(this,id,options);if(SERV_VARS.CLIENT_PAYMENT_TYPE=="with_delay"){this.addElement(new PaySchedule_View("PaySchedule_View"));this.addElement(new PayDefDebt_View("PayDefDebt_View"));}
else{this.addElement(new PayOrderList_View("PayOrderList_View"));}
this.addElement(new RepClientBalance_View("RepClientBalance_View"));}
extend(PaymentList_View,ViewList); 
function RepSales_View(id,options){options=options||{};options.title="Формирование отчета";options.controller=Report_Controller;options.methodId="sales";options.reportType="sales";options.viewId="ViewHTMLXSLT";options.connect=options.connect;RepSales_View.superclass.constructor.call(this,id,options);var fields=[{"id":"client_descr","name":"Клиент","agg":false,"filtered":false,"filterControl":new EditList(id+"_client_id",{"editContClassName":"input-group","editViewControl":new ClientEditObject("doc_client_id",id+"_filter_client",true,{"editContClassName":"input-group "+get_bs_col()+"3","noOpen":true}),"filterSign":"incl"})},{"id":"client_login_allowed","name":"Работа через личный кабинет","agg":false,"filtered":false,"filterControl":new EditCheckBox(uuid(),{})},{"id":"client_activity_descr","name":"Вид деятельности","agg":false,"filtered":false,"filterControl":new EditList(id+"_client_id",{"editContClassName":"input-group","editViewControl":new ClientActivityEdit({"fieldId":"client_activity_descr","controlId":id+"_filter_client_activity_descr","inLine":true,"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"client_pay_type","name":"Условия оплаты","agg":false,"filtered":false,"filterControl":new EditList(id+"_client_pay_type",{"editContClassName":"input-group","editViewControl":new PayTypeEditObject("client_pay_type",id+"_filter_client_pay_type",true,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"client_pay_debt_days","name":"Максимальный допустипый срок просрочки","agg":false,"filtered":false,"filterControl":new EditList(id+"_client_pay_debt_days",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"client_pay_debt_sum","name":"Максимальная сумма просрочки","agg":false,"filtered":false,"filterControl":new EditList(id+"_client_pay_debt_sum",{"editContClassName":"input-group","editViewControl":new EditFloat(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"client_debt_period_days_descr","name":"Срок дебиторской задолженности","agg":false,"filtered":false,"filterControl":new EditList(id+"_client_debt_period_days_descr",{"editContClassName":"input-group","editViewControl":new ClientDebtPeriodEdit({"fieldId":"client_debt_period_days_descr","controlId":id+"_filter_client_debt_period_days_descr","inLine":true,"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"client_contracts_exist","name":"Наличие договоров","agg":false,"filtered":false,"filterControl":new EditCheckBox(uuid(),{})},{"id":"client_contract_end","name":"Ближайший срок окончания договоров","agg":false,"filtered":false,"filterControl":new EditDate(uuid(),{})},{"id":"doc_number","name":"№ заявки","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_number",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_date_time_descr","name":"Дата подачи","agg":false,"filtered":null,"filterControl":null},{"id":"doc_delivery_fact_date_descr","name":"Дата фактической отгрузки","agg":false,"filtered":null,"filterControl":null},{"id":"firm_descr","name":"Организация","agg":false,"filtered":false,"filterControl":new EditList(id+"_firm_descr",{"editContClassName":"input-group","editViewControl":new FirmEditObject("firm_descr",id+"_filter_firm_descr",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"production_city_descr","name":"Город отгрузки","agg":false,"filtered":false,"filterControl":new EditList(id+"_production_city_descr",{"editContClassName":"input-group","editViewControl":new ProductionCityEditObject("production_city_descr",id+"_filter_production_city_descr",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_delivery_plan_date","name":"Планируемая дата выполнения","agg":false,"filtered":false,"filterControl":new EditDate(uuid(),{})},{"id":"doc_in_time","name":"Своевременное выполнение","agg":false,"filtered":false,"filterControl":new EditCheckBox(uuid(),{})},{"id":"doc_user_descr","name":"Ответственный","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_user_descr",{"editContClassName":"input-group","editViewControl":new UserEditObject("doc_user_descr",id+"_filter_doc_user_descr",true,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_delivery_type_descr","name":"Тип доставки","agg":false,"filtered":false,"filterControl":new DelivTypeEditObject({fieldId:"doc_delivery_type_descr",controlId:"delivery_type",inLine:true})},{"id":"doc_deliv_to_third_party","name":"Доставка третьим лицам","agg":false,"filtered":false,"filterControl":new EditCheckBox(uuid(),{})},{"id":"doc_deliv_pay_bank","name":"Доставка по безнал.расч.","agg":false,"filtered":false,"filterControl":new EditCheckBox(uuid(),{})},{"id":"doc_deliv_destination_descr","name":"Адрес доставки","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_deliv_destination_descr",{"editContClassName":"input-group","editViewControl":new EditString(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_deliv_period","name":"Назначенное время доставки","agg":false,"filtered":null,"filterControl":new EditList(id+"_doc_user_descr",{"editContClassName":"input-group","editViewControl":new DeliveryPeriodEditObject("doc_deliv_period",id+"_filter_doc_deliv_period",true,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_warehouse_descr","name":"Склад отгрузки","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_user_descr",{"editContClassName":"input-group","editViewControl":new WarehouseEditObject("doc_warehouse_descr",id+"_filter_doc_warehouse_descr",true,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_driver_descr","name":"Водитель","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_vehicle_descr",{"editContClassName":"input-group","editViewControl":new DriverEditObject("doc_driver_id",id+"_filter_doc_driver_id",true,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_vehicle_descr","name":"ТС","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_vehicle_descr",{"editContClassName":"input-group","editViewControl":new VehicleEditObject({"fieldId":"doc_vehicle_descr","controlId":id+"_filter_doc_vehicle_descr","inLine":true,"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_ext_order_num","name":"Номер счета","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_ext_order_num",{"editContClassName":"input-group","editViewControl":new EditString(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_ext_ship_num","name":"Номер реализации","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_ext_ship_num",{"editContClassName":"input-group","editViewControl":new EditString(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_last_state","name":"Последний статус заявки","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_last_state",{"editContClassName":"input-group","editViewControl":new OrderStateEditObject("doc_last_state_id",id+"_filter_doc_last_state_id",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_state_date_time","name":"Дата статуса заявки","agg":false,"filtered":false,"filterControl":new EditDate(uuid())},{"id":"doc_state","name":"Статус заявки","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_state",{"editContClassName":"input-group","editViewControl":new OrderStateEditObject("doc_state_id",id+"_filter_doc_state_id",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_state_user","name":"Пользователь статуса заявки","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_state_user",{"editContClassName":"input-group","editViewControl":new UserEditObject("doc_state_user",id+"_filter_doc_state_user",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_sales_manager_comment","name":"Комментарий внутренний","agg":false,"filtered":false,"filterControl":new EditList(id+"_doc_sales_manager_comment",{"editContClassName":"input-group","editViewControl":new EditText(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doc_client_comment","name":"Комментарий общий","filtered":null,"agg":false,"filterControl":new EditList(id+"_doc_client_comment",{"editContClassName":"input-group","editViewControl":new EditText(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doct_product_descr","name":"Продукция","agg":false,"filtered":false,"filterControl":new EditList(id+"_doct_product_descr",{"editContClassName":"input-group","editViewControl":new ProductEditObject("doct_product_descr",id+"_filter_doct_product_descr",true,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doct_product_mes","name":"Размеры продукции (одно поле)","agg":false,"filtered":false,"filterControl":false},{"id":"doct_product_mes_length","name":"Длина продукции","agg":false,"filtered":false,"filterControl":new EditList(id+"_doct_product_mes_length",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doct_product_mes_width","name":"Ширина продукции ","agg":false,"filtered":false,"filterControl":new EditList(id+"_doct_product_mes_width",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doct_product_mes_height","name":"Высота продукции ","agg":false,"filtered":false,"filterControl":new EditList(id+"_doct_product_mes_height",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doct_base_measure_descr","name":"Базовая единица","agg":false,"filtered":null,"filterControl":new EditList(id+"_doc_user_descr",{"editContClassName":"input-group","editViewControl":new MeasureUnitEditObject("doct_base_measure_descr",id+"_filter_doct_base_measure_descr",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})},{"id":"doct_pack_exists","name":"Наличие упаковки","agg":false,"filtered":null,"filterControl":new EditCheckBox(uuid())},{"id":"doct_extra_price_category","name":"Категория наценки","agg":false,"filtered":false,"filterControl":new EditNum(uuid(),{})},{"id":"doc_city_route_distance","name":"Километраж доставки город","filtered":false,"filterControl":new EditList(id+"_doc_city_route_distance",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doc_country_route_distance","name":"Километраж доставки межгород","filtered":false,"filterControl":new EditList(id+"_doc_country_route_distance",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doc_coord_count","name":"Количество согласований","filterControl":new EditList(id+"_doc_coord_count",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doc_coord_time_sale_dep","name":"Время согласования ОП","filterControl":new EditList(id+"_doc_coord_time_sale_dep",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doc_coord_time_client","name":"Время согласования клиентом","filterControl":new EditList(id+"_doc_coord_time_client",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doct_quant","name":"Кол-во в базовых единицах","filtered":null,"filterControl":new EditList(id+"_doct_quant",{"editContClassName":"input-group","editViewControl":new EditFloat(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doct_weight","name":"Масса","filtered":null,"filterControl":new EditList(id+"_doct_weight",{"editContClassName":"input-group","editViewControl":new EditFloat(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doct_volume","name":"Объем","filtered":null,"filterControl":new EditList(id+"_doct_volume",{"editContClassName":"input-group","editViewControl":new EditFloat(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doct_total","name":"Стоимость продукции","filtered":null,"filterControl":new EditList(id+"_doct_total",{"editContClassName":"input-group","editViewControl":new EditMoney(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doc_deliv_total","name":"Стоимость доставки","filtered":null,"filterControl":new EditList(id+"_doc_deliv_total",{"editContClassName":"input-group","editViewControl":new EditMoney(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doc_deliv_expenses","name":"Затраты на доставку","filtered":null,"filterControl":new EditList(id+"_doc_deliv_expenses",{"editContClassName":"input-group","editViewControl":new EditMoney(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"client_debt_days","name":"Просроченная дебиторская задолженность (дни)","filtered":null,"filterControl":new EditList(id+"_client_debt_days",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"client_debt_total","name":"Просроченная дебиторская задолженность (стоимость)","filtered":null,"filterControl":new EditList(id+"_client_debt_total",{"editContClassName":"input-group","editViewControl":new EditFloat(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"}),"agg":true},{"id":"doc_customer_survey_points","name":"Баллы опроса","agg":true,"filtered":false,"filterControl":new EditList(id+"_doc_customer_survey_points",{"editContClassName":"input-group","editViewControl":new EditNum(uuid(),{"editContClassName":"input-group "+get_bs_col()+"3"}),"filterSign":"incl"})}];this.m_condFieldContainer=new RepCondFields(id+"_fields",{"fields":fields});this.m_groupFieldContainer=new RepGroupFields(id+"_groups",{"fields":fields});this.m_aggFieldContainer=new RepAggFields(id+"_agg_fields",{"fields":fields});var self=this;this.m_ctrlDataType=new EditSelect(id+"_date_type",{labelCaption:"Вид даты:",contClassName:"form-group",editContClassName:"input-group "+get_bs_col()+"4",events:{change:function(){var f=self.m_ctrlDataType.getValue();self.m_filter.setParamValue(self.m_ctrlPeriodFrom.getId(),"valueFieldId",f);self.m_filter.setParamValue(self.m_ctrlPeriodTo.getId(),"valueFieldId",f);}}});this.m_ctrlDataType.addElement(new EditSelectOption(id+"_date_type_date",{optionSelected:true,optionId:"doc_date_time",optionDescr:"Дата размещения"}));this.m_ctrlDataType.addElement(new EditSelectOption(id+"_date_type_deliv_date",{optionSelected:false,optionId:"doc_delivery_fact_date",optionDescr:"Дата отгрузки"}));var period=new EditPeriodDateTime(id+"_period");var d_mask="dd/mm/y hh:mmin:ss";this.m_ctrlPeriodFrom=period.getControlFrom();this.m_ctrlPeriodTo=period.getControlTo();this.m_ctrlPeriodFrom.setValue(DateHandler.dateToStr(DateHandler.getStartOfDate(new Date()),d_mask));this.m_ctrlPeriodTo.setValue(DateHandler.dateToStr(DateHandler.getEndOfDate(new Date()),d_mask));this.m_ctrlShippedOnly=new EditCheckBox(id+"_shipped_only",{"labelClassName":"control-label "+get_bs_col()+"4"+" readOnly","labelCaption":"Только отгруженные заявки:","attrs":{"title":"Включать в отчет либо только отгруженные, либо все заявки"},"checked":true});this.addFilterContainer([{"control":this.m_ctrlPeriodFrom,"filter":{"sign":"ge","valueFieldId":"doc_date_time"}},{"control":this.m_ctrlPeriodTo,"filter":{"sign":"le","valueFieldId":"doc_date_time"}},{"control":this.m_ctrlShippedOnly,"filter":{"sign":"e","valueFieldId":"doc_order_delivered"}}]);this.m_filterContainer.addElement(this.m_ctrlDataType);this.m_filterContainer.addElement(this.m_ctrlShippedOnly);this.addCmdFilter();this.addCmdMakeReport();this.addCmdPrint();this.addCmdExcel();this.addStoringControl(this.m_condFieldContainer);this.addStoringControl(this.m_groupFieldContainer);this.addStoringControl(this.m_aggFieldContainer);}
extend(RepSales_View,PPViewReport);RepSales_View.prototype.addExtraParams=function(struc){RepSales_View.superclass.addExtraParams.call(this,struc);struc.templ="RepSales";} 
function ClientList_View(id,options){options=options||{};options.title="Клиенты";ClientList_View.superclass.constructor.call(this,id,options);var controller=new Client_Controller(options.connect);var cont=new ControlContainer("p_reg_cl","div",{"className":"panel panel-default"});var filter=new GridFilter(uuid(),{"tagName":"div"});filter.addFilterControl(new EditList(id+"_client_id",{"labelCaption":"Список клиентов:","editContClassName":"input-group "+get_bs_col()+"3","editViewControl":new ClientEditObject("client_id",id+"_filter_client",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"})}),{"sign":"incl","keyFieldIds":["id"]});this.m_fastFilter=new GridFastFilter(id+"_fast_filter",{"tagName":"div","noSetControl":true,"noUnsetControl":true,"noToggleControl":true,"className":"row"});this.m_fastFilter.addFilterControl(new EditString(id+"_fast_filter_descr",{"labelCaption":"Наименование:","contClassName":get_bs_col()+"4"}),{"sign":"lk","valueFieldId":"name","r_wcards":"1","l_wcards":"1","icase":"1"});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));if(SERV_VARS.ROLE_ID=="admin"){row.addElement(new GridDbHeadCellBool(id+"_col_deleted",{"value":"Удален","readBind":{"valueFieldId":"deleted"}}));}
row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true,"sortable":true,"sort":"asc"}));row.addElement(new GridDbHeadCell(id+"_col_client_activity_descr",{"value":"Вид деят.","readBind":{"valueFieldId":"client_activity_descr"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_inn",{"value":"ИНН","readBind":{"valueFieldId":"inn"}}));row.addElement(new GridDbHeadCell(id+"_col_contract_descr",{"value":"Договор","readBind":{"valueFieldId":"contract_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_contract_period",{"value":"Срок дог.","readBind":{"valueFieldId":"contract_period"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_terms",{"value":"Условия","readBind":{"valueFieldId":"terms"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_debt",{"value":"Деб.задолж.","readBind":{"valueFieldId":"debt"},"colAttrs":{"align":"right"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_login_allowed",{"value":"Личн.каб.","readBind":{"valueFieldId":"login_allowed"},"assocImageArray":{"true":"img/bool/true.png","false":"img/bool/false.png"},"colAttrs":{"align":"center"},"sortable":true}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ClientList_Model","editViewClass":ClientDialog_View,"editInline":false,"editWinClass":WIN_CLASS,"pagination":new GridPagination(id+"_page",{"countPerPage":CONSTANT_VALS.grid_rows_per_page_count}),"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid","cmdColumnManager":true}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":CONSTANT_VALS.db_controls_refresh_sec*1000,"onSelect":options.onSelect,"rowSelect":true,"winObj":options.winObj,"fixedHeader":true,"attrs":{"name":"ClientList"}});cont.addElement(this.m_fastFilter);cont.addElement(this.m_grid);this.addElement(cont);var self=this;this.m_grid.m_filterComplete=function(struc){self.m_fastFilter.getParams(struc);}
this.m_fastFilter.setOnRefresh(this.m_grid.onRefresh);this.m_fastFilter.setClickContext(this.m_grid);var cont=new ControlContainer("unreg_cl_list_cont","div",{"className":"panel panel-default"});cont.addElement(new Control("unreg_cl_list","div",{"className":"panel-heading","value":"Незарегистрированные клиенты"}));var head=new GridHead();var row=new GridRow(id+"_unregCl_row1");row.addElement(new GridDbHeadCell(id+"_unregCl_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_unregCl_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);cont.addElement(new GridDb(id+"_unregCl_grid",{"head":head,"body":new GridBody(),"controller":new Client_Controller(new ServConnector(HOST_NAME)),"readModelId":"get_unreg_client_list","readMethodId":"get_unreg_client_list","editViewClass":ClientDialog_View,"editInline":false,"editWinClass":WIN_CLASS,"pagination":null,"commandPanel":new GridCommands(id+"_unregCl_cmd",{"noInsert":true,"noDelete":true,"tableId":id+"_unregCl_grid"}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":CONSTANT_VALS.db_controls_refresh_sec*1000,"onSelect":options.onSelect,"rowSelect":true,"winObj":options.winObj}));this.addElement(cont);}
extend(ClientList_View,ViewList);ClientList_View.prototype.getFormWidth=function(){return"1000";}
ClientList_View.prototype.getFormHeight=function(){return"600";}
ClientList_View.prototype.toDOM=function(parent){ClientList_View.superclass.toDOM.call(this,parent);this.m_fastFilter.setFocus();} 
function ClientSelectList_View(id,options){options=options||{};ClientSelectList_View.superclass.constructor.call(this,id,options);var controller=new Client_Controller(options.connect);var cont=new ControlContainer("p_cl","div",{"className":"panel"});var filter=null;this.m_fastFilter=new GridFastFilter(id+"_fast_filter",{"tagName":"div","noSetControl":true,"noUnsetControl":true,"noToggleControl":true,"className":"row"});this.m_fastFilter.addFilterControl(new EditString(id+"_fast_filter_descr",{"labelCaption":"Наименование:","contClassName":get_bs_col()+"4"}),{"sign":"lk","valueFieldId":"name","r_wcards":"1","l_wcards":"1","icase":"1"});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true,"sortable":true,"sort":"asc"}));row.addElement(new GridDbHeadCell(id+"_col_client_activity_descr",{"value":"Вид деят.","readBind":{"valueFieldId":"client_activity_descr"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_inn",{"value":"ИНН","readBind":{"valueFieldId":"inn"}}));row.addElement(new GridDbHeadCell(id+"_col_contract_descr",{"value":"Договор","readBind":{"valueFieldId":"contract_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_contract_period",{"value":"Срок дог.","readBind":{"valueFieldId":"contract_period"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_terms",{"value":"Условия","readBind":{"valueFieldId":"terms"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_debt",{"value":"Деб.задолж.","readBind":{"valueFieldId":"debt"},"colAttrs":{"align":"right"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_login_allowed",{"value":"Личн.каб.","readBind":{"valueFieldId":"login_allowed"},"assocImageArray":{"true":"img/bool/true.png","false":"img/bool/false.png"},"colAttrs":{"align":"center"},"sortable":true}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ClientList_Model","editViewClass":null,"editInline":null,"pagination":new GridPagination("page_ClientList",{"countPerPage":CONSTANT_VALS.grid_rows_per_page_count}),"commandPanel":new GridCommands(id+"_grid_cmd",{"noInsert":true,"noEdit":true,"noCopy":true,"noPrint":true,"noDelete":true}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"extraFields":options.extraFields});var self=this;this.m_grid.m_filterComplete=function(struc){self.m_fastFilter.getParams(struc);}
this.m_fastFilter.setOnRefresh(this.m_grid.onRefresh);this.m_fastFilter.setClickContext(this.m_grid);cont.addElement(this.m_fastFilter);cont.addElement(this.m_grid);this.addElement(cont);}
extend(ClientSelectList_View,ViewList);ClientSelectList_View.prototype.getFormWidth=function(){return"1250";}
ClientSelectList_View.prototype.getFormHeight=function(){return"600";}
ClientSelectList_View.prototype.toDOM=function(parent){ClientSelectList_View.superclass.toDOM.call(this,parent);this.m_fastFilter.setFocus();} 
function ClientDialog_View(id,options){options=options||{};options.tagName="div";options.className="panel";options.readMethodId=options.readMethodId||this.DEF_READ_METH_ID;options.writeController=options.writeController||options.readController;options.formCaption="Клиент";var self=this;ClientDialog_View.superclass.constructor.call(this,id,options);var model_id="ClientDialog_Model";options.enabled=false;this.m_evAddrMailSameAsRegClick=function(){var en=!(self.m_addrMailSameAsReg.getValue()=="true");self.m_addrMail.setEnabled(en);};this.m_evPayTypeClick=function(){var en=(self.m_payTypeCtrl.getValue()=="with_delay");self.m_payDelayDaysCtrl.setEnabled(en);self.m_payFixToDowCtrl.setEnabled(en);self.m_payDowCtrl.setEnabled(en);self.m_payBanOnDebtDaysCtrl.setEnabled(en);self.m_payDebtDaysCtrl.setEnabled(en);self.m_payBanOnDebtSumCtrl.setEnabled(en);self.m_payDebtSumCtrl.setEnabled(en);}
this.addDataControl(new Edit("ClientDialog_id",{"visible":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});var attrs={};ClientAttrs(attrs,this);this.bindControl(attrs.name,{"modelId":model_id,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});this.addControl(attrs.name);this.m_ctrlBind1cCont=new ControlContainer(uuid(),"div",{"className":"row","visible":false});this.m_ctrlBind1cCont.addElement(new Control(uuid(),"div",{"className":"bind_to_1c","value":"Связан с 1с"}));this.m_ctrlBind1cCont.addElement(new ButtonCtrl(uuid(),{"caption":"Очистить","onClick":function(){self.unbindClient();}}));this.addControl(this.m_ctrlBind1cCont);this.addDataControl(new EditCheckBox(id+"_deleted",{"labelCaption":"Удален:","name":"deleted","tableLayout":false}),{"modelId":model_id,"valueFieldId":"deleted","keyFieldIds":null},{"valueFieldId":"deleted","keyFieldIds":null,"modelId":model_id});this.addDataControl(new EditCheckBox("Client_is_supplier",{"labelCaption":"Поставщик:","name":"is_supplier","tableLayout":false}),{"modelId":model_id,"valueFieldId":"is_supplier","keyFieldIds":null},{"valueFieldId":"is_supplier","keyFieldIds":null,"modelId":model_id});this.addDataControl(new EditCheckBox("Client_is_carrier",{"labelCaption":"Перевозчик:","name":"is_carrier","tableLayout":false}),{"modelId":model_id,"valueFieldId":"is_carrier","keyFieldIds":null},{"valueFieldId":"is_carrier","keyFieldIds":null,"modelId":model_id});var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Ответственные лица","dataTarget":p_id,"attrs":{"title":"показать/скрыть ответственных лиц"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});this.m_userList=new ClientUserList_View(uuid(),{});cont.addElement(this.m_userList);cont_m.addElement(cont);this.addElement(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Реквизиты","dataTarget":p_id,"attrs":{"title":"показать/скрыть реквизиты"}}));var cont=new ControlContainer(p_id,"div",{className:("collapse"+(this.getIsNew()?" in":""))});var sub_cont=new ControlContainer("attrl_sub_l","div",{"className":get_bs_col()+"6"});sub_cont.addElement(new ButtonCtrl("fillFrom1c",{"caption":"Заполнить из 1с","onClick":function(){self.setTempDisabled();var contr=new Client_Controller(new ServConnector(HOST_NAME));contr.run("attrs_from_1c",{"async":false,"params":{"name":self.getDataControlValue("Client_name")},"func":function(resp){self.setTempEnabled();self.fillFrom1c(resp);},"err":function(resp,errCode,errStr){self.setTempEnabled();WindowMessage.show({"text":errStr,"type":WindowMessage.TP_ER});}});},"attrs":{"title":"заполнить все реквизиты клиента из базы 1с"}}));attrs["name_full"]=new EditString("Client_name_full",{"labelCaption":"Полное наименование:","name":"name_full","buttonClear":false,"tableLayout":false,"attrs":{"required":"required"}});this.bindControl(attrs.name_full,{"modelId":model_id,"valueFieldId":"name_full","keyFieldIds":null},{"valueFieldId":"name_full","keyFieldIds":null});sub_cont.addElement(attrs.name_full);this.m_ctrlInn=attrs.inn;this.bindControl(attrs.inn,{"modelId":model_id,"valueFieldId":"inn","keyFieldIds":null},{"valueFieldId":"inn","keyFieldIds":null});sub_cont.addElement(attrs.inn);this.bindControl(attrs.kpp,{"modelId":model_id,"valueFieldId":"kpp","keyFieldIds":null},{"valueFieldId":"kpp","keyFieldIds":null});sub_cont.addElement(attrs.kpp);this.m_addrReg=attrs.addr_reg;this.bindControl(attrs.addr_reg,{"modelId":model_id,"valueFieldId":"addr_reg","keyFieldIds":null},{"valueFieldId":"addr_reg","keyFieldIds":null});sub_cont.addElement(attrs.addr_reg);this.m_addrMailSameAsReg=attrs.addr_mail_same_as_reg;this.bindControl(attrs.addr_mail_same_as_reg,{"modelId":model_id,"valueFieldId":"addr_mail_same_as_reg","keyFieldIds":null},{"valueFieldId":"addr_mail_same_as_reg","keyFieldIds":null});sub_cont.addElement(attrs.addr_mail_same_as_reg);this.m_addrMail=attrs.addr_mail;this.bindControl(attrs.addr_mail,{"modelId":model_id,"valueFieldId":"addr_mail","keyFieldIds":null},{"valueFieldId":"addr_mail","keyFieldIds":null});sub_cont.addElement(attrs.addr_mail);this.bindControl(attrs.telephones,{"modelId":model_id,"valueFieldId":"telephones","keyFieldIds":null},{"valueFieldId":"telephones","keyFieldIds":null});sub_cont.addElement(attrs.telephones);this.bindControl(attrs.email,{"modelId":model_id,"valueFieldId":"email","keyFieldIds":null},{"valueFieldId":"email","keyFieldIds":null});sub_cont.addElement(attrs.email);var ctrl=new ClientActivityEdit({"fieldId":"client_activity_id","controlId":"Client_client_activity","inLine":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"client_activity_descr","keyFieldIds":["client_activity_id"]},{"valueFieldId":null,"keyFieldIds":["client_activity_id"]});sub_cont.addElement(ctrl);cont.addElement(sub_cont);var sub_cont=new ControlContainer("attrl_sub_r","div",{"className":get_bs_col()+"6"});this.bindControl(attrs.acc,{"modelId":model_id,"valueFieldId":"acc","keyFieldIds":null},{"valueFieldId":"acc","keyFieldIds":null});sub_cont.addElement(attrs.acc);this.bindControl(attrs.bank_name,{"modelId":model_id,"valueFieldId":"bank_name","keyFieldIds":null},{"valueFieldId":"bank_name","keyFieldIds":null});sub_cont.addElement(attrs.bank_name);this.bindControl(attrs.bank_code,{"modelId":model_id,"valueFieldId":"bank_code","keyFieldIds":null},{"valueFieldId":"bank_code","keyFieldIds":null});sub_cont.addElement(attrs.bank_code);this.bindControl(attrs.bank_acc,{"modelId":model_id,"valueFieldId":"bank_acc","keyFieldIds":null},{"valueFieldId":"bank_acc","keyFieldIds":null});sub_cont.addElement(attrs.bank_acc);this.bindControl(attrs.okpo,{"modelId":model_id,"valueFieldId":"okpo","keyFieldIds":null},{"valueFieldId":"okpo","keyFieldIds":null});sub_cont.addElement(attrs.okpo);this.bindControl(attrs.ogrn,{"modelId":model_id,"valueFieldId":"ogrn","keyFieldIds":null},{"valueFieldId":"ogrn","keyFieldIds":null});sub_cont.addElement(attrs.ogrn);cont.addElement(sub_cont);cont_m.addElement(cont);this.addControl(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Расчетные счета наших организаций","dataTarget":p_id,"attrs":{"title":"показать/скрыть расчетные счета"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});this.m_firmAccList=new ClientFirmBankAccountList_View(uuid(),{});cont.addElement(this.m_firmAccList);cont_m.addElement(cont);this.addElement(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Значения по умолчанию","dataTarget":p_id,"attrs":{"title":"показать/скрыть значения по умолчанию"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});var ctrl=new FirmEditObject("def_firm_id","def_firm",false,null,{"attrs":{}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"def_firm_descr","keyFieldIds":["def_firm_id"]},{"valueFieldId":null,"keyFieldIds":["def_firm_id"]});cont.addElement(ctrl);var ctrl=new WarehouseEditObject("def_warehouse_id","def_warehouse",false,null,{"attrs":{}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"def_warehouse_descr","keyFieldIds":["def_warehouse_id"]},{"valueFieldId":null,"keyFieldIds":["def_warehouse_id"]});cont.addElement(ctrl);var ctrl=new EditCheckBox("deliv_add_cost_to_product",{"labelCaption":"Включать стоимость доставки пропорционально в стоимость продукции:","name":"deliv_add_cost_to_product","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"deliv_add_cost_to_product","keyFieldIds":null},{"valueFieldId":"deliv_add_cost_to_product","keyFieldIds":null});cont.addElement(ctrl);cont_m.addElement(cont);this.addElement(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Условия работы","dataTarget":p_id,"attrs":{"title":"показать/скрыть условия работы"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});var sub_cont=new ControlContainer(uuid(),"div",{});this.m_contractList=new ClientContractList_View("ClientContractList",options);sub_cont.addElement(this.m_contractList);cont.addElement(sub_cont);var sub_cont=new ControlContainer("p_cl_cond_sub_l","div",{"className":get_bs_col()+"6"});this.m_payTypeCtrl=new PayTypeEditObject("pay_type","pay_type",false,"in_advance");this.bindControl(this.m_payTypeCtrl,{"modelId":model_id,"valueFieldId":"pay_type","keyFieldIds":["pay_type"]},{"valueFieldId":"pay_type","keyFieldIds":["pay_type"]});sub_cont.addElement(this.m_payTypeCtrl);this.m_payDelayDaysCtrl=new EditNum("Client_pay_delay_days",{"name":"pay_delay_days","labelCaption":"Отсрочка платежа (дней)","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":3}});this.bindControl(this.m_payDelayDaysCtrl,{"modelId":model_id,"valueFieldId":"pay_delay_days","keyFieldIds":null},{"valueFieldId":"pay_delay_days","keyFieldIds":null});sub_cont.addElement(this.m_payDelayDaysCtrl);var sub_sub_cont=new ControlContainer(uuid(),"div",{className:"form-group"});var sub_sub_sub_cont=new ControlContainer(uuid(),"div",{className:get_bs_col()+"4"});this.m_payFixToDowCtrl=new EditCheckBox("Client_pay_fix_to_dow",{"labelCaption":"Привязывать к дню недели:","name":"pay_fix_to_dow","labelAlign":"left","events":{"change":function(){self.setPayFixToDow(self.m_payFixToDowCtrl.getValue());}}});this.bindControl(this.m_payFixToDowCtrl,{"modelId":model_id,"valueFieldId":"pay_fix_to_dow","keyFieldIds":null},{"valueFieldId":"pay_fix_to_dow","keyFieldIds":null});sub_sub_sub_cont.addElement(this.m_payFixToDowCtrl);sub_sub_cont.addElement(sub_sub_sub_cont);var sub_sub_sub_cont=new ControlContainer(uuid(),"div",{className:get_bs_col()+"8"});this.m_payDowCtrl=new EditDow("Client_pay_dow_days",{"enabled":false,"days":[{"descr":"ПН","value":1},{"descr":"ВТ","value":2},{"descr":"СР","value":3},{"descr":"ЧТ","value":4},{"descr":"ПТ","value":5},],"multySelect":true,"winObj":options.winObj});this.bindControl(this.m_payDowCtrl,{"modelId":model_id,"valueFieldId":"pay_dow_days","keyFieldIds":null},{"valueFieldId":"pay_dow_days","keyFieldIds":null});sub_sub_sub_cont.addElement(this.m_payDowCtrl);sub_sub_cont.addElement(sub_sub_sub_cont);sub_cont.addElement(sub_sub_cont);var sub_sub_cont=new ControlContainer(uuid(),"div",{className:"form-group"});var sub_sub_sub_cont=new ControlContainer(uuid(),"div",{className:get_bs_col()+"10"});this.m_payBanOnDebtDaysCtrl=new EditCheckBox("Client_pay_ban_on_debt_days",{"labelCaption":"Запрет автоматической отгрузки при просрочке платежа на ","name":"pay_ban_on_debt_days","attrs":{}});this.bindControl(this.m_payBanOnDebtDaysCtrl,{"modelId":model_id,"valueFieldId":"pay_ban_on_debt_days","keyFieldIds":null},{"valueFieldId":"pay_ban_on_debt_days","keyFieldIds":null});sub_sub_sub_cont.addElement(this.m_payBanOnDebtDaysCtrl);sub_sub_cont.addElement(sub_sub_sub_cont);var sub_sub_sub_cont=new ControlContainer(uuid(),"div",{className:get_bs_col()+"2"});this.m_payDebtDaysCtrl=new EditNum("Client_pay_debt_days",{"name":"pay_debt_days","buttonClear":false,"attrs":{"maxlength":3}});this.bindControl(this.m_payDebtDaysCtrl,{"modelId":model_id,"valueFieldId":"pay_debt_days","keyFieldIds":null},{"valueFieldId":"pay_debt_days","keyFieldIds":null});sub_sub_sub_cont.addElement(this.m_payDebtDaysCtrl);sub_sub_sub_cont.addElement(new Control(uuid(),"span",{"value":"дн.",className:"form-control-static"}));sub_sub_cont.addElement(sub_sub_sub_cont);sub_cont.addElement(sub_sub_cont);var sub_sub_cont=new ControlContainer(uuid(),"div",{className:"form-group"});var sub_sub_sub_cont=new ControlContainer(uuid(),"div",{className:get_bs_col()+"10"});this.m_payBanOnDebtSumCtrl=new EditCheckBox("Client_pay_ban_on_debt_sum",{"labelCaption":"Запрет автоматической отгрузки при просрочке более ","name":"pay_ban_on_debt_sum","tableLayout":false,"labelAlign":"left","attrs":{}});this.bindControl(this.m_payBanOnDebtSumCtrl,{"modelId":model_id,"valueFieldId":"pay_ban_on_debt_sum","keyFieldIds":null},{"valueFieldId":"pay_ban_on_debt_sum","keyFieldIds":null});sub_sub_sub_cont.addElement(this.m_payBanOnDebtSumCtrl);sub_sub_cont.addElement(sub_sub_sub_cont);var sub_sub_sub_cont=new ControlContainer(uuid(),"div",{className:get_bs_col()+"2"});this.m_payDebtSumCtrl=new EditMoney("Client_pay_debt_days",{"name":"pay_debt_sum","buttonClear":false});this.bindControl(this.m_payDebtSumCtrl,{"modelId":model_id,"valueFieldId":"pay_debt_sum","keyFieldIds":null},{"valueFieldId":"pay_debt_sum","keyFieldIds":null});sub_sub_sub_cont.addElement(this.m_payDebtSumCtrl);sub_sub_sub_cont.addElement(new Control("ban_sm2_t","span",{"value":"руб.","className":"form-control-static"}));sub_sub_cont.addElement(sub_sub_sub_cont);sub_cont.addElement(sub_sub_cont);cont.addElement(sub_cont);var sub_cont=new ControlContainer("attrl_sub_r","div",{"className":get_bs_col()+"6"});this.m_btnPriceTune=new BtnPriceTune({});sub_cont.addElement(this.m_btnPriceTune);this.m_priceListList=new ClientPriceListClientList_View("ClientPriceListClientList",options);sub_cont.addElement(this.m_priceListList);var ctrl=new EditCheckBox("Client_login_allowed",{"labelCaption":"Работа через личный кабинет","tableLayout":false,"labelAlign":"left","name":"login_allowed"});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"login_allowed","keyFieldIds":null},{"valueFieldId":"login_allowed","keyFieldIds":null});sub_cont.addElement(ctrl);var ctrl=new EditCheckBox("Client_sms_on_order_change",{"labelCaption":"Отправлять SMS ответственному от клиента об изм.заявки","tableLayout":false,"labelAlign":"left","name":"sms_on_order_change"});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"login_allowed","keyFieldIds":null},{"valueFieldId":"sms_on_order_change","keyFieldIds":null});sub_cont.addElement(ctrl);var ctrl=new EditCheckBox("Client_email_sert",{"labelCaption":"Отправлять паспорт качества при каждой поставке","tableLayout":false,"labelAlign":"left","name":"email_sert"});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"login_allowed","keyFieldIds":null},{"valueFieldId":"email_sert","keyFieldIds":null});sub_cont.addElement(ctrl);var ctrl=new EditCheckBox("Client_show_delivery_tab",{"labelCaption":"Показывать отслеживание заявок","tableLayout":false,"labelAlign":"left","name":"show_delivery_tab"});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"login_allowed","keyFieldIds":null},{"valueFieldId":"show_delivery_tab","keyFieldIds":null});sub_cont.addElement(ctrl);cont.addElement(sub_cont);cont_m.addElement(cont);this.addControl(cont_m);this.m_ctrlSave=new ButtonCmd(id+"btnSave",{"caption":"Записать","onClick":function(){self.onClickSave();},"attrs":{"title":"Записать"}});}
extend(ClientDialog_View,ViewDialog);ClientDialog_View.prototype.onGetData=function(resp){ClientDialog_View.superclass.onGetData.call(this,resp);var id=this.getDataControl("ClientDialog_id").control.getAttr("old_id");if(id){this.m_userList.setClientId(id);this.m_userList.m_grid.setEnabled(true);this.m_userList.m_grid.onRefresh();this.m_contractList.setClientId(id);this.m_contractList.m_grid.setEnabled(true);this.m_contractList.m_grid.onRefresh();this.m_priceListList.setClientId(id);this.m_priceListList.m_grid.setEnabled(true);this.m_priceListList.m_grid.onRefresh();this.m_firmAccList.setClientId(id);this.m_firmAccList.m_grid.setEnabled(true);this.m_firmAccList.m_grid.onRefresh();var m=resp.getModelById("ClientDialog_Model",true);if(m.getNextRow()){this.m_registered=(m.getFieldValue("registered")=="true");if(!this.m_registered){this.m_ctrlOk.setCaption("Зарегистрировать");}
this.m_ctrlBind1cCont.setVisible(m.getFieldValue("ext_id"));}
this.m_ctrlInn.getButtons().getElement("Client_inn_btn_sel").m_clientId=id;}
this.m_evAddrMailSameAsRegClick();this.m_evPayTypeClick();}
ClientDialog_View.prototype.fillFrom1c=function(resp){var model=resp.getModelById("attrs_from_1c");model.setActive(true);if(model.getNextRow()){for(var f_id in model.m_fields){if(f_id=="found"){if(model.getFieldValue(f_id)=="0"){WindowMessage.show({"text":"Контрагента с данным наименованием в 1с не найден!","type":WindowMessage.TP_WARN});break;}}
else if(f_id=="is_supplier"||f_id=="is_carrier"){this.setDataControlValue("Client_"+f_id,(model.getFieldValue(f_id)=="1")?"true":"false");}
else{this.setDataControlValue("Client_"+f_id,model.getFieldValue(f_id));}}}}
ClientDialog_View.prototype.setMethodParams=function(pm,checkRes){ClientDialog_View.superclass.setMethodParams.call(this,pm,checkRes);if(!this.m_registered){checkRes.modif=true;}}
ClientDialog_View.prototype.toDOM=function(parent){ClientDialog_View.superclass.toDOM.call(this,parent);EventHandler.addEvent(this.m_addrMailSameAsReg.getNode(),"change",this.m_evAddrMailSameAsRegClick);EventHandler.addEvent(this.m_payTypeCtrl.getNode(),"change",this.m_evPayTypeClick);}
ClientDialog_View.prototype.removeDOM=function(){ClientDialog_View.superclass.removeDOM.call(this);EventHandler.removeEvent(this.m_addrMailSameAsReg.getNode(),"change",this.m_evAddrMailSameAsRegClick);EventHandler.removeEvent(this.m_payTypeCtrl.getNode(),"change",this.m_evPayTypeClick);}
ClientDialog_View.prototype.setPayFixToDow=function(v){this.m_payDowCtrl.setEnabled((v=="true")?true:false);}
ClientDialog_View.prototype.unbindClient=function(){var id=this.getDataControl("ClientDialog_id").control.getAttr("old_id");var self=this;var contr=new Client_Controller(new ServConnector(HOST_NAME));contr.run("update",{"params":{"old_id":id,"ext_id":""},"func":function(){WindowMessage.show({"text":"Связь с 1с разорвана.","type":WindowMessage.TP_NOTE});self.m_ctrlBind1cCont.setVisible(false);}});} 
function ClientUserList_View(id,options){options=options||{};options.viewContClassName="panel panel-default";ClientUserList_View.superclass.constructor.call(this,id,options);var controller=new ClientUser_Controller(new ServConnector(HOST_NAME));var filter=new ListFilter();filter.addFilter("client_id",{"sign":"e","keyFieldIds":["client_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_client_id",{"readBind":{"valueFieldId":"client_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name_full",{"value":"ФИО","readBind":{"valueFieldId":"name_full"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_email",{"value":"Email","readBind":{"valueFieldId":"email"}}));row.addElement(new GridDbHeadCell(id+"_col_cel_phone",{"value":"Телефон","readBind":{"valueFieldId":"cel_phone"}}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Логин","readBind":{"valueFieldId":"name"}}));row.addElement(new GridDbHeadSysCell(id+"_col_sys",{"value":"..."}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ClientUserList_Model","editViewClass":ClientUserInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid"}),"rowCommandPanelClass":ClientUserGridRowCommands,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":true,"methParams":{"client_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(ClientUserList_View,ViewList);ClientUserList_View.prototype.setClientId=function(id){this.m_grid.m_filter.m_params["client_id"].key=id;this.m_grid.m_methParams["client_id"]=id;this.m_grid.m_autoRefresh=true;} 
function ClientUserInline_View(id,options){options=options||{};ClientUserInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id"}),{"modelId":"ClientUserList_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new Edit(id+"_client_id",{"visible":false,"name":"client_id"}),{"modelId":"ClientUserList_Model","valueFieldId":"client_id","keyFieldIds":null},{"valueFieldId":"client_id","keyFieldIds":null});this.addDataControl(new EditString(id+"_name_full",{"attrs":{"maxlength":150,"size":50},"name":"name_full"}),{"modelId":"ClientUserList_Model","valueFieldId":"name_full","keyFieldIds":null},{"valueFieldId":"name_full","keyFieldIds":null});this.addDataControl(new EditString(id+"_email",{"attrs":{"maxlength":50,"size":15},"name":"email"}),{"modelId":"ClientUserList_Model","valueFieldId":"email","keyFieldIds":null},{"valueFieldId":"email","keyFieldIds":null});this.addDataControl(new EditCellPhone(id+"_cel_phone",{"name":"cel_phone"}),{"modelId":"ClientUserList_Model","valueFieldId":"cel_phone","keyFieldIds":null},{"valueFieldId":"cel_phone","keyFieldIds":null});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":50,"size":15},"name":"name"}),{"modelId":"ClientUserList_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});}
extend(ClientUserInline_View,ViewInlineGridEdit); 
function ClientFirmBankAccountList_View(id,options){options=options||{};options.viewContClassName="panel panel-default";ClientFirmBankAccountList_View.superclass.constructor.call(this,id,options);var controller=new ClientFirmBankAccount_Controller(new ServConnector(HOST_NAME));var filter=new ListFilter();filter.addFilter("client_id",{"sign":"e","keyFieldIds":["client_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_client_id",{"readBind":{"valueFieldId":"client_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_firm_id",{"readBind":{"valueFieldId":"firm_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_firm_descr",{"value":"Фирма","readBind":{"valueFieldId":"firm_descr"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_ext_bank_account_descr",{"value":"Расчетный счет","readBind":{"valueFieldId":"ext_bank_account_descr"}}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ClientFirmBankAccountList_Model","editViewClass":ClientFirmBankAccountInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid"}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":true,"methParams":{"client_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(ClientFirmBankAccountList_View,ViewList);ClientFirmBankAccountList_View.prototype.setClientId=function(id){this.m_grid.m_filter.m_params["client_id"].key=id;this.m_grid.m_methParams["client_id"]=id;this.m_grid.m_autoRefresh=true;} 
function ClientFirmBankAccountInline_View(id,options){options=options||{};ClientFirmBankAccountInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id"}),{"modelId":"ClientFirmBankAccountList_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new Edit(id+"_client_id",{"visible":false,"name":"client_id"}),{"modelId":"ClientFirmBankAccountList_Model","valueFieldId":"client_id","keyFieldIds":null},{"valueFieldId":"client_id","keyFieldIds":null});this.addDataControl(new Edit(id+"_firm_id",{"visible":false,"name":"firm_id"}),{"modelId":"ClientFirmBankAccountList_Model","valueFieldId":"firm_id","keyFieldIds":null},{"valueFieldId":"firm_id","keyFieldIds":null});this.addDataControl(new FirmEditObject("firm_descr",id+"_firm_descr",true,null,{"attrs":{},"name":"firm_descr"}),{"modelId":"ClientFirmBankAccountList_Model","valueFieldId":"firm_descr","keyFieldIds":["firm_id"]},{"valueFieldId":null,"keyFieldIds":["firm_id"]});this.addDataControl(new FirmExtBankAccountEdit({"fieldId":"ext_bank_account_id","controlId":id+"ext_bank_account_descr","mainView":this,"options":{},"inLine":true}),{"modelId":"ClientFirmBankAccountList_Model","valueFieldId":"ext_bank_account_descr","keyFieldIds":["ext_bank_account_id"]},{"valueFieldId":null,"keyFieldIds":["ext_bank_account_id"]});}
extend(ClientFirmBankAccountInline_View,ViewInlineGridEdit); 
function ClientContractList_View(id,options){options=options||{};options.title="Договоры контрагента";options.viewContClassName="panel panel-default";ClientContractList_View.superclass.constructor.call(this,id,options);var controller=new ClientContract_Controller(options.connect);var filter=new ListFilter();filter.addFilter("client_id",{"sign":"e","keyFieldIds":["client_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_client_id",{"readBind":{"valueFieldId":"client_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_firm_descr",{"value":"Организация","readBind":{"valueFieldId":"firm_descr"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_state_descr",{"value":"Состояние","readBind":{"valueFieldId":"state_descr"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_number",{"value":"Номер","readBind":{"valueFieldId":"number"},"colAttrs":{"align":"center"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_date_from_descr",{"value":"Дата","readBind":{"valueFieldId":"date_from_descr"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_date_to_descr",{"value":"Срок действия","readBind":{"valueFieldId":"date_to_descr"},"colAttrs":{"align":"center"}}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readMethodId":"get_list","readModelId":"ClientContractList_Model","editViewClass":ClientContractInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid"}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":true,"methParams":{"client_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(ClientContractList_View,ViewList);ClientContractList_View.prototype.setClientId=function(id){this.m_grid.m_filter.m_params["client_id"].key=id;this.m_grid.m_methParams["client_id"]=id;this.m_grid.m_autoRefresh=true;} 
function ClientContractInline_View(id,options){options=options||{};ClientContractInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id"}),{"modelId":"ClientContractList_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new Edit(id+"_client_id",{"visible":false,"name":"client_id"}),{"modelId":"ClientContractList_Model","valueFieldId":"client_id","keyFieldIds":null},{"valueFieldId":"client_id","keyFieldIds":null});if(!CONST_CONTROLS["firm"]){CONST_CONTROLS["firm"]=new FirmEditObject("firm_id",id+"_firm",true);}
else{CONST_CONTROLS.firm.setDefaultId();}
this.addDataControl(CONST_CONTROLS.firm,{"modelId":"ClientContractList_Model","valueFieldId":"firm_descr","keyFieldIds":["firm_id"]},{"valueFieldId":null,"keyFieldIds":["firm_id"]});if(!CONST_CONTROLS.contract_state){CONST_CONTROLS.contract_state=new ContractStateEditObject("state",id+"_state",true);}
else{CONST_CONTROLS.contract_state.setDefaultId();}
this.addDataControl(CONST_CONTROLS.contract_state,{"modelId":"ClientContractList_Model","valueFieldId":"state_descr","keyFieldIds":["state"]},{"valueFieldId":null,"keyFieldIds":["state"]});this.addDataControl(new EditString(id+"_number",{"name":"number","attrs":{"maxlength":"50","size":"10"}}),{"modelId":"ClientContractList_Model","valueFieldId":"number","keyFieldIds":null},{"valueFieldId":"number","keyFieldIds":null});this.addDataControl(new EditDate(id+"_date_from",{"name":"date_from","noSelect":true}),{"modelId":"ClientContractList_Model","valueFieldId":"date_from_descr","keyFieldIds":null},{"valueFieldId":"date_from","keyFieldIds":null});this.addDataControl(new EditDate(id+"_date_to",{"name":"date_to","noSelect":true}),{"modelId":"ClientContractList_Model","valueFieldId":"date_to_descr","keyFieldIds":null},{"valueFieldId":"date_to","keyFieldIds":null});}
extend(ClientContractInline_View,ViewInlineGridEdit); 
function UserWarehouseList_View(id,options){options=options||{};options.title="Склады пользователя";options.viewContClassName="panel panel-default";UserWarehouseList_View.superclass.constructor.call(this,id,options);var controller=new UserWarehouse_Controller(options.connect);var filter=new ListFilter();filter.addFilter("user_id",{"sign":"e","keyFieldIds":["user_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_user_id",{"readBind":{"valueFieldId":"user_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_warehouse_descr",{"value":"Склад","readBind":{"valueFieldId":"warehouse_descr"},"descrCol":true}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readMethodId":"get_list","readModelId":"UserWarehouseList_Model","editViewClass":UserWarehouseInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid"}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":true,"methParams":{"user_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(UserWarehouseList_View,ViewList);UserWarehouseList_View.prototype.setUserId=function(id){this.m_grid.m_filter.m_params["user_id"].key=id;this.m_grid.m_methParams["user_id"]=id;this.m_grid.m_autoRefresh=true;} 
function ClientExtContractList_View(id,options){options=options||{};options.title="Договоры контрагента";options.viewContClassName="panel panel-default";ClientExtContractList_View.superclass.constructor.call(this,id,options);var controller=options.readController;var filter=new ListFilter();filter.addFilter("client_id",{"sign":"e","keyFieldIds":["client_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_ext_id",{"readBind":{"valueFieldId":"ext_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readMethodId":"get_client_ext_contract_list","readModelId":"ClientExtContractList_Model","editViewClass":null,"editInline":null,"pagination":null,"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid","noInsert":true,"noEdit":true,"noCopy":true,"noDelete":true,"noExport":true}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":false,"enabled":options.enabled});this.addElement(this.m_grid);}
extend(ClientExtContractList_View,ViewList); 
function FirmExtBankAccountList_View(id,options){options=options||{};options.title="Расчетные счета организации";options.viewContClassName="panel panel-default";FirmExtBankAccountList_View.superclass.constructor.call(this,id,options);var controller=options.readController;var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_ext_id",{"readBind":{"valueFieldId":"ext_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Расчетный счет","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readMethodId":"get_firm_ext_bank_account_list","readModelId":"FirmExtBankAccountList_Model","editViewClass":null,"editInline":null,"pagination":null,"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid","noInsert":true,"noEdit":true,"noCopy":true,"noDelete":true,"noExport":true}),"rowCommandPanelClass":null,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":false,"enabled":options.enabled});this.addElement(this.m_grid);}
extend(FirmExtBankAccountList_View,ViewList); 
function UserWarehouseInline_View(id,options){options=options||{};UserWarehouseInline_View.superclass.constructor.call(this,id,options);var model_id="UserWarehouseList_Model";this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id"}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new Edit(id+"_user_id",{"visible":false,"name":"user_id"}),{"modelId":model_id,"valueFieldId":"user_id","keyFieldIds":null},{"valueFieldId":"user_id","keyFieldIds":null});this.addDataControl(new WarehouseEditObject("warehouse_id",id+"_warehouse",true),{"modelId":model_id,"valueFieldId":"warehouse_descr","keyFieldIds":["warehouse_id"]},{"valueFieldId":null,"keyFieldIds":["warehouse_id"]});}
extend(UserWarehouseInline_View,ViewInlineGridEdit); 
function FirmList_View(id,options){options=options||{};options.title="Организации";FirmList_View.superclass.constructor.call(this,id,options);var controller=new Firm_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCellBool(id+"_col_deleted",{"value":"Удален","readBind":{"valueFieldId":"deleted"}}));row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));row.addElement(new GridDbHeadCellBool(id+"_col_nds",{"value":"Есть НДС","readBind":{"valueFieldId":"nds"}}));row.addElement(new GridDbHeadCellBool(id+"_col_cash",{"value":"За нал.расчет","readBind":{"valueFieldId":"cash"}}));row.addElement(new GridDbHeadCellBool(id+"_col_match_1c",{"value":"Соответствует 1с","readBind":{"valueFieldId":"match_1c"}}));row.addElement(new GridDbHeadCellBool(id+"_col_order_no_carrier_print",{"value":"Если перевозчик не задан, обрабатывать как НАШИ АВТО","readBind":{"valueFieldId":"order_no_carrier_print"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"FirmList_Model","editViewClass":FirmInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(FirmList_View,ViewList); 
function FirmInline_View(id,options){options=options||{};FirmInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new EditCheckBox(id+"_deleted",{}),{"modelId":"FirmList_Model","valueFieldId":"deleted","keyFieldIds":null},{"valueFieldId":"deleted","keyFieldIds":null});this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":"FirmList_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":100,"size":50,"required":"required"},"alwaysUpdate":true}),{"modelId":"FirmList_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});this.addDataControl(new EditCheckBox(id+"_nds",{}),{"modelId":"FirmList_Model","valueFieldId":"nds","keyFieldIds":null},{"valueFieldId":"nds","keyFieldIds":null});this.addDataControl(new EditCheckBox(id+"_cash",{}),{"modelId":"FirmList_Model","valueFieldId":"cash","keyFieldIds":null},{"valueFieldId":"cash","keyFieldIds":null});this.addDataControl(new EditCheckBox(id+"_cash",{"enabled":false}),{"modelId":"FirmList_Model","valueFieldId":"match_1c","keyFieldIds":null},{"valueFieldId":"match_1c","keyFieldIds":null});this.addDataControl(new EditCheckBox(id+"_cash",{}),{"modelId":"FirmList_Model","valueFieldId":"order_no_carrier_print","keyFieldIds":null},{"valueFieldId":"order_no_carrier_print","keyFieldIds":null});}
extend(FirmInline_View,ViewInlineGridEdit); 
function SaleStoreAddressInline_View(id,options){options=options||{};SaleStoreAddressInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":"SaleStoreAddress_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString(id+"_code",{"attrs":{"maxlength":10,"size":5,"required":"required"},"alwaysUpdate":true}),{"modelId":"SaleStoreAddress_Model","valueFieldId":"code","keyFieldIds":null},{"valueFieldId":"code","keyFieldIds":null});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":100,"size":50,"required":"required"},"alwaysUpdate":true}),{"modelId":"SaleStoreAddress_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});}
extend(SaleStoreAddressInline_View,ViewInlineGridEdit); 
function DeliveryPeriodList_View(id,options){options=options||{};options.title="Периоды доставки";DeliveryPeriodList_View.superclass.constructor.call(this,id,options);var controller=new DeliveryPeriod_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"DeliveryPeriod_Model","editViewClass":DeliveryPeriodInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(DeliveryPeriodList_View,ViewList); 
function DeliveryPeriodInline_View(id,options){options=options||{};DeliveryPeriodInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":"DeliveryPeriod_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":50,"size":20,"required":"required"}}),{"modelId":"DeliveryPeriod_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});}
extend(DeliveryPeriodInline_View,ViewInlineGridEdit); 
function ClientPriceListList_View(id,options){options=options||{};options.title="Прайс листы контрагента";options.viewContClassName="panel panel-default";ClientPriceListList_View.superclass.constructor.call(this,id,options);var controller=new ClientPriceList_Controller(new ServConnector(HOST_NAME));var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_production_city_descr",{"value":"Город","readBind":{"valueFieldId":"production_city_descr"}}));row.addElement(new GridDbHeadCellBool(id+"_col_to_third_party_only",{"value":"Для трет.лиц","readBind":{"valueFieldId":"to_third_party_only"}}));row.addElement(new GridDbHeadCellBool(id+"_col_default_price_list",{"value":"По умолч.","readBind":{"valueFieldId":"default_price_list"}}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ClientPriceListList_Model","editViewClass":ClientPriceListDialog_View,"editInline":false,"pagination":null,"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid"}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":false,"methParams":{"client_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(ClientPriceListList_View,ViewList); 
function ClientPriceListDialog_View(id,options){options=options||{};ClientPriceListDialog_View.superclass.constructor.call(this,id,options);var cont=new ControlContainer("client_price_cont","div",{"className":"panel"});this.m_idCtrl=new Edit(id+"_id",{"visible":false,"name":"id"});this.bindControl(this.m_idCtrl,{"modelId":"ClientPriceListDialog_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});cont.addElement(this.m_idCtrl);var ctrl=new EditString(id+"_name",{"attrs":{"maxlength":100,"size":20,"required":"required"},"labelCaption":"Наименование:","name":"name"});this.bindControl(ctrl,{"modelId":"ClientPriceListDialog_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});cont.addElement(ctrl);options.enabled=false;this.m_productList=new ClientPriceListProductList_View("ClientPriceListProductList",options);cont.addElement(this.m_productList);if(!CONST_CONTROLS.pruductionCity){CONST_CONTROLS.pruductionCity=new ProductionCityEditObject("production_city_id",id+"_production_city",false);}
else{CONST_CONTROLS.pruductionCity.setDefaultId();}
this.bindControl(CONST_CONTROLS.pruductionCity,{"modelId":"ClientPriceListDialog_Model","valueFieldId":"production_city_descr","keyFieldIds":["production_city_id"]},{"valueFieldId":null,"keyFieldIds":["production_city_id"]});cont.addElement(CONST_CONTROLS.pruductionCity);var ctrl=new EditCheckBox(id+"_part_ship_do_not_change_price",{"labelCaption":"Неполная доставка не влияет на цену за базовую единицу","name":"part_ship_do_not_change_price"});this.bindControl(ctrl,{"modelId":"ClientPriceListDialog_Model","valueFieldId":"part_ship_do_not_change_price","keyFieldIds":null},{"valueFieldId":"part_ship_do_not_change_price","keyFieldIds":null});cont.addElement(ctrl);var ctrl=new EditNum(id+"_min_order_quant",{"name":"min_order_quant","buttonClear":false,"labelCaption":"Заказ не менее (м3):","attrs":{"maxlength":19,"size":"5","value":0}});this.bindControl(ctrl,{"modelId":"ClientPriceListDialog_Model","valueFieldId":"min_order_quant","keyFieldIds":null},{"valueFieldId":"min_order_quant","keyFieldIds":null});cont.addElement(ctrl);var ctrl=new EditCheckBox(id+"_to_third_party_only",{"labelCaption":"Только при доставке третьим лицам","name":"to_third_party_only"});this.bindControl(ctrl,{"modelId":"ClientPriceListDialog_Model","valueFieldId":"to_third_party_only","keyFieldIds":null},{"valueFieldId":"to_third_party_only","keyFieldIds":null});cont.addElement(ctrl);var ctrl=new EditCheckBox(id+"_default_price_list",{"labelCaption":"По умолчанию","name":"default_price_list"});this.bindControl(ctrl,{"modelId":"ClientPriceListDialog_Model","valueFieldId":"default_price_list","keyFieldIds":null},{"valueFieldId":"default_price_list","keyFieldIds":null});cont.addElement(ctrl);var self=this;this.m_printPriceBtn=new Button(id+"_print",{"caption":"Печать прайса","enabled":false,"onClick":function(){var contr=new ClientPriceList_Controller(new ServConnector(HOST_NAME));contr.run("print_price",{"async":true,"params":{"v":"ViewXSLT","templ":"PriceList","price_id":self.m_idCtrl.getValue()},"xml":false,"func":function(resp){WindowPrint.show({"content":resp,"close":false,"print":false});},"cont":this});},"attrs":{"title":"напечатать прайс"}});cont.addElement(this.m_printPriceBtn);this.addControl(cont);this.m_ctrlSave=new ButtonCmd(id+"btnSave",{"caption":"Записать","onClick":function(){self.onClickSave();},"attrs":{"title":"Записать"}});}
extend(ClientPriceListDialog_View,ViewDialog);ClientPriceListDialog_View.prototype.onGetData=function(resp){ClientPriceListDialog_View.superclass.onGetData.call(this,resp);var id=this.getDataControl(this.getId()+"_id").control.getAttr("old_id");this.m_productList.setPriceListId(id);this.m_productList.m_grid.onRefresh();this.m_productList.setEnabled(true);this.m_printPriceBtn.setEnabled(true);} 
function ClientPriceListClientList_View(id,options){options=options||{};options.title="Прайс листы клиента";ClientPriceListClientList_View.superclass.constructor.call(this,id,options);var controller=new ClientPriceListClient_Controller(new ServConnector(HOST_NAME));var filter=new ListFilter();filter.addFilter("client_id",{"sign":"e","keyFieldIds":["client_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_client_price_list_descr",{"value":"Наименование","readBind":{"valueFieldId":"client_price_list_descr"},"descrCol":true}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ClientPriceListClientList_Model","editViewClass":null,"editInline":true,"pagination":null,"commandPanel":new ClientPriceListClientGridCom(id+"_grid_cmd",{"tableId":id+"_grid"}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":true,"methParams":{"client_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(ClientPriceListClientList_View,ViewList);ClientPriceListClientList_View.prototype.setClientId=function(id){this.m_grid.m_filter.m_params["client_id"].key=id;this.m_grid.m_methParams["client_id"]=id;this.m_grid.m_autoRefresh=true;this.m_grid.getCommandPanel().client_id=id;} 
function ProductionCityDialog_View(id,options){options=options||{};options.readMethodId=options.readMethodId||this.DEF_READ_METH_ID;options.writeController=options.writeController||options.readController;options.noOk=true;options.noCancel=true;ProductionCityDialog_View.superclass.constructor.call(this,id,options);var model_id="ProductionCityDialog_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null,"modelId":"ProductionCity_Model"});var self=this;this.addDataControl(new EditString(id+"_name",{"labelCaption":"Наименование:","name":"name","tableLayout":false,"attrs":{"maxlength":100,"size":80,"required":"required"}}),{"modelId":model_id,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null,"modelId":"ProductionCity_Model"});this.m_ctrlZoneStr=new Edit(id+"_zone_str",{"visible":false,"name":"zone_str"});this.addDataControl(this.m_ctrlZoneStr,{"modelId":model_id,"valueFieldId":"zone_str","keyFieldIds":null},{"valueFieldId":"zone","keyFieldIds":null,"modelId":"Warehouse_Model"});this.m_ctrlZoneCenterStr=new Edit(id+"_zone_center_str",{"visible":false,"name":"zone_center_str"});this.addDataControl(this.m_ctrlZoneCenterStr,{"modelId":model_id,"valueFieldId":"zone_center_str","keyFieldIds":null},{"valueFieldId":"null","keyFieldIds":null});this.addControl(new ButtonCmd(uuid(),{"caption":"Записать","onClick":function(){self.onClickOk();},"attrs":{"title":"записать,закрыть"}}));this.addControl(new ButtonCmd(uuid(),{"caption":"Закрыть","onClick":function(){self.onCancel();},"attrs":{"title":"закрыть без сохранения"}}));this.addFeatureControl();this.addMapControl();}
extend(ProductionCityDialog_View,MapZones_View);ProductionCityDialog_View.prototype.getZoneDescr=function(){return"Город отгрузки";} 
function ProductionCityList_View(id,options){options=options||{};options.title="Города отгрузки";ProductionCityList_View.superclass.constructor.call(this,id,options);var controller=new ProductionCity_Controller(new ServConnector(HOST_NAME));var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"visible":false,"readBind":{"valueFieldId":"id"},"keyCol":true}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true,"sortable":true,"sort":"asc"}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ProductionCityList_Model","editViewClass":ProductionCityDialog_View,"editInline":false,"pagination":null,"commandPanel":new GridCommands(id+"_commands",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"asyncEditRead":false,"winObj":options.winObj}));}
extend(ProductionCityList_View,ViewList); 
function ClientPriceListProductList_View(id,options){options=options||{};options.title="Цены на продукцию";ClientPriceListProductList_View.superclass.constructor.call(this,id,options);var controller=new ClientPriceListProduct_Controller(new ServConnector(HOST_NAME));var filter=new ListFilter();filter.addFilter("price_list_id",{"sign":"e","keyFieldIds":["price_list_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_price_list_id",{"readBind":{"valueFieldId":"price_list_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_product_id",{"readBind":{"valueFieldId":"product_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_product_descr",{"value":"Продукция","readBind":{"valueFieldId":"product_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_measure_unit_descr",{"value":"Един.изм.","readBind":{"valueFieldId":"measure_unit_descr"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_price",{"value":"Цена","readBind":{"valueFieldId":"price"},"colAttrs":{"align":"right"}}));row.addElement(new GridDbHeadCell(id+"_discount_volume",{"value":"При объеме больше","readBind":{"valueFieldId":"discount_volume"},"colAttrs":{"align":"right"}}));row.addElement(new GridDbHeadCell(id+"_discount_total",{"value":"Скидка,руб","readBind":{"valueFieldId":"discount_total"},"colAttrs":{"align":"right"}}));row.addElement(new GridDbHeadCell(id+"_pack_price_descr",{"value":"Цена упаковки","readBind":{"valueFieldId":"pack_price_descr"},"colAttrs":{"align":"right"}}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readMethodId":"get_list","readModelId":"ClientPriceListProduct_Model","editViewClass":ClientPriceListProductInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid","noInsert":true}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":true,"methParams":{"price_list_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(ClientPriceListProductList_View,ViewList);ClientPriceListProductList_View.prototype.setPriceListId=function(id){this.m_grid.m_filter.m_params["price_list_id"].key=id;this.m_grid.m_methParams["price_list_id"]=id;this.m_grid.m_autoRefresh=true;} 
function ClientPriceListProductInline_View(id,options){options=options||{};options.readMethodId="get_obj";ClientPriceListProductInline_View.superclass.constructor.call(this,id,options);var model_id="ClientPriceListProduct_Model";this.addDataControl(new Control(id+"_price_list_id","span",{"visible":false,"name":"price_list_id"}),{"modelId":model_id,"valueFieldId":"price_list_id","keyFieldIds":null},{"valueFieldId":"price_list_id","keyFieldIds":null});this.addDataControl(new Control(id+"_product_id","span",{"visible":false,"name":"product_id"}),{"modelId":model_id,"valueFieldId":"product_id","keyFieldIds":null},{"valueFieldId":"product_id","keyFieldIds":null});this.addDataControl(new Control(id+"_prodict_descr","span",{"name":"product_descr","enabled":false}),{"modelId":model_id,"valueFieldId":"product_descr","keyFieldIds":null},{"valueFieldId":"product_descr","keyFieldIds":null});this.addDataControl(new Control(id+"_measure_unit_descr","span",{"name":"measure_unit_descr","enabled":false}),{"modelId":model_id,"valueFieldId":"measure_unit_descr","keyFieldIds":null},{"valueFieldId":"measure_unit_descr","keyFieldIds":null});this.addDataControl(new EditMoney(id+"_price",{"name":"price","alwaysUpdate":true}),{"modelId":model_id,"valueFieldId":"price_descr","keyFieldIds":null},{"valueFieldId":"price","keyFieldIds":null});this.addDataControl(new EditFloat(id+"_discount_volume",{"name":"discount_volume","attrs":{"maxlength":"19","size":"8"},"alwaysUpdate":true}),{"modelId":model_id,"valueFieldId":"discount_volume","keyFieldIds":null},{"valueFieldId":"discount_volume","keyFieldIds":null});this.addDataControl(new EditMoney(id+"_discount_total",{"name":"discount_total","alwaysUpdate":true}),{"modelId":model_id,"valueFieldId":"discount_total","keyFieldIds":null},{"valueFieldId":"discount_total","keyFieldIds":null});this.addDataControl(new EditMoney(id+"_pack_price",{"name":"pack_price","alwaysUpdate":true}),{"modelId":model_id,"valueFieldId":"pack_price_descr","keyFieldIds":null},{"valueFieldId":"pack_price","keyFieldIds":null});}
extend(ClientPriceListProductInline_View,ViewInlineGridEdit); 
function DOCOrderBaseList_View(id,options){options=options||{};DOCOrderBaseList_View.superclass.constructor.call(this,id,options);var controller=options.controller||new DOCOrder_Controller(new ServConnector(HOST_NAME));var self=this;var filter;if(options.filter){filter=new GridFilter(id+"_filter",{noUnsetControl:false});filter.addFilterControl(new EditString(id+"_filter_number",{"labelCaption":"№:","editContClassName":"input-group "+get_bs_col()+"1","winObj":this.m_winObj,"tableLayout":false}),{"sign":"e","valueFieldId":"number"});var date_time_period_ctrl=new EditPeriodDateTime(id+"_filter_date_time",{"labelCaptionFrom":"Период подачи:","labelCaptionTo":"-","tableLayout":false});filter.addFilterControl(date_time_period_ctrl.getControlFrom(),{"sign":"ge","valueFieldId":"date_time"});filter.addFilterControl(date_time_period_ctrl.getControlTo(),{"sign":"le","valueFieldId":"date_time"});filter.addFilterControl(new EditFloat(id+"_filter_total_quant",{"labelCaption":"Количество:","editContClassName":"input-group "+get_bs_col()+"1","winObj":this.m_winObj,"tableLayout":false,"precision":"4","attrs":{"maxlength":"19"}}),{"sign":"e","valueFieldId":"total_quant"});if(options.warehouse){filter.addFilterControl(new EditList(id+"_warehouse_id",{"labelCaption":"Список складов:","editContClassName":"input-group "+get_bs_col()+"3","editViewControl":new WarehouseEditObject("warehouse_id",id+"_filter_warehouse",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"})}),{"sign":"incl","valueFieldId":"warehouse_id"});}
if(options.state){filter.addFilterControl(new EditList(id+"_state",{"labelCaption":"Список статусов:","editContClassName":"input-group "+get_bs_col()+"3","editViewControl":new OrderStateEditObject("state",id+"_filter_state",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"})}),{"sign":"incl","keyFieldIds":["state"]});}
if(options.client){filter.addFilterControl(new EditList(id+"_client_id",{"labelCaption":"Список клиентов:","editContClassName":"input-group "+get_bs_col()+"3","editViewControl":new ClientEditObject("client_id",id+"_filter_client",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"})}),{"sign":"incl","keyFieldIds":["client_id"]});}
if(options.products){filter.addFilterControl(new EditList(id+"_products",{"labelCaption":"Список продукции:","editContClassName":"input-group "+get_bs_col()+"3","editViewControl":new ProductEditObject("product_ids",id+"_filter_products",true,null,{"editContClassName":"input-group "+get_bs_col()+"3"})}),{"sign":"overlap","keyFieldIds":["product_ids"]});}
if(options.ext_ship_num){filter.addFilterControl(new EditString(id+"_filter_ext_ship_num",{"labelCaption":"№ реализ.:","editContClassName":"input-group "+get_bs_col()+"1","winObj":this.m_winObj,"tableLayout":false,"attrs":{"maxlength":"11"}}),{"sign":"e","valueFieldId":"ext_ship_num"});}
if(options.delivery_fact_date){var delivery_fact_date_period_ctrl=new EditPeriodDateTime(id+"_filter_delivery_fact_date",{"labelCaptionFrom":"Период отгрузки:","labelCaptionTo":"-","tableLayout":false});filter.addFilterControl(delivery_fact_date_period_ctrl.getControlFrom(),{"sign":"ge","valueFieldId":"delivery_fact_date"});filter.addFilterControl(delivery_fact_date_period_ctrl.getControlTo(),{"sign":"le","valueFieldId":"delivery_fact_date"});}
if(options.client_number){}
if(options.printed){}
if(options.customer_survey_date){var customer_survey_date_period_ctrl=new EditPeriodDateTime(id+"_filter_cust_surv_date_time",{"labelCaptionFrom":"Период опроса:","labelCaptionTo":"-","tableLayout":false});filter.addFilterControl(customer_survey_date_period_ctrl.getControlFrom(),{"sign":"ge","valueFieldId":"cust_surv_date_time"});filter.addFilterControl(customer_survey_date_period_ctrl.getControlTo(),{"sign":"le","valueFieldId":"cust_surv_date_time"});}
var plan_date_period_ctrl=new EditPeriodDateTime(id+"_filter_plan_date",{"labelCaptionFrom":"Период планируемых дат выполнения:","labelCaptionTo":"-","tableLayout":false});filter.addFilterControl(plan_date_period_ctrl.getControlFrom(),{"sign":"ge","valueFieldId":"delivery_plan_date"});filter.addFilterControl(plan_date_period_ctrl.getControlTo(),{"sign":"le","valueFieldId":"delivery_plan_date"});}
if(options.fast_filter){this.m_fastFilter=new GridFastFilter(id+"_fast_filter",{"tagName":"div","noSetControl":true,"noUnsetControl":true,"noToggleControl":true,"className":"row"});this.m_fastFilter.addFilterControl(new EditRadioGroup(id+"_filter_current_all",{"className":get_bs_col()+"3","elements":[new EditRadio("current_all:current",{"descr":"Текущие","value":"true","name":"orders_type_filter","contClassName":get_bs_col()+"6","editContClassName":"input-group "+get_bs_col()+"1","labelClassName":get_bs_col()+"8","events":{"click":function(){self.m_fastFilter.refresh();}},"attrs":{"checked":"checked","initValue":"checked"}}),new EditRadio("current_all:all",{"descr":"Все","value":"undefined","name":"orders_type_filter","contClassName":get_bs_col()+"6","editContClassName":"input-group "+get_bs_col()+"1","labelClassName":get_bs_col()+"8","events":{"click":function(){self.m_fastFilter.refresh();}},"attrs":{"initValue":"false"}})]}),{"sign":"e","valueFieldId":"is_current"});this.m_fastFilter.addFilterControl(new EditString(id+"_fast_filter_number",{"labelCaption":"№:","contClassName":get_bs_col()+"2","winObj":this.m_winObj,"tableLayout":false}),{"sign":"lk","valueFieldId":"number","r_wcards":true});if(options.client){this.m_fastFilter.addFilterControl(new EditString(id+"_fast_filter_client_descr",{"labelCaption":"Клиент:","contClassName":get_bs_col()+"3"}),{"sign":"lk","valueFieldId":"client_descr","r_wcards":"1","l_wcards":"1","icase":"1"});}
this.m_fastFilter.addFilterControl(new EditDate(id+"_fast_filter_delivery_plan_date",{"labelCaption":"Дата вып.:","noClear":false,"editContClassName":"input-group "+get_bs_col()+"8","contClassName":get_bs_col()+"3","labelClassName":get_bs_col()+"4","enabled":false,"onSelected":function(){self.m_fastFilter.refresh();}}),{"sign":"e","valueFieldId":"delivery_plan_date"});}
var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));if(options.number){row.addElement(new GridDbHeadCell(id+"_col_number",{"value":"№","readBind":{"valueFieldId":"number"},"sortable":true,"colAttrs":{"align":"center"}}));}
row.addElement(new GridDbHeadCell(id+"_col_date_time_descr",{"value":"Дата пдч.","readBind":{"valueFieldId":"date_time_descr"},"sortable":true,"sort":"desc","sortCol":"date_time,number","colAttrs":{"align":"center","nowrap":"nowrap"}}));row.addElement(new GridDbHeadCell(id+"_col_client_id",{"readBind":{"valueFieldId":"client_id"},"visible":false}));if(options.client){row.addElement(new GridDbHeadCell(id+"_col_client_descr",{"value":"Клиент","readBind":{"valueFieldId":"client_descr"},"sortable":true,"colAttrs":{"nowrap":"nowrap"}}));}
row.addElement(new GridDbHeadCell(id+"_col_delivery_plan_date_descr",{"value":"Дата вып.","readBind":{"valueFieldId":"delivery_plan_date_descr"},"sortable":true,"sortCol":"delivery_plan_date,number","colAttrs":{"align":"center","nowrap":"nowrap"}}));row.addElement(new GridDbHeadCell(id+"_col_products_descr",{"value":"Продукция","readBind":{"valueFieldId":"products_descr"},"colAttrs":{"style":"max-width:5px;overflow:hidden;","nowrap":"nowrap"}}));row.addElement(new GridDbHeadCell(id+"_col_total_volume",{"value":"Кол-во,м3","readBind":{"valueFieldId":"total_quant"},"sortable":true,"colAttrs":{"align":"center"}}));if(options.warehouse){row.addElement(new GridDbHeadCell(id+"_col_warehouse_descr",{"value":"Завод","readBind":{"valueFieldId":"warehouse_descr"},"sortable":true,"sortCol":"warehouse_id,number","colAttrs":{"nowrap":"nowrap"}}));}
row.addElement(new GridDbHeadCell(id+"_col_address_descr",{"value":"Адрес доставки","readBind":{"valueFieldId":"address_descr"},"sortable":true,"sortCol":"address_descr","colAttrs":{"nowrap":"nowrap"}}));if(options.total){row.addElement(new GridDbHeadCell(id+"_col_total",{"value":"Сумма","readBind":{"valueFieldId":"total"},"colAttrs":{"align":"right"}}));}
if(options.state){row.addElement(new GridDbHeadCell(id+"_col_state_descr",{"value":"Статус","readBind":{"valueFieldId":"state_descr"},"sortable":true,"sortCol":"state,number","colAttrs":{"align":"center","style":"max-width:5px;overflow:hidden;","nowrap":"nowrap"}}));}
if(options.paid){row.addElement(new GridDbHeadCellBool(id+"_col_paid",{"value":"Оплач.","getDbValue":function(m,attrs){if(m.getFieldValue("paid")=="true"){attrs.paid="cash";return"Н";}
else if(m.getFieldValue("paid_by_bank")=="true"){attrs.paid="bank";return"Б";}},"readBind":{"valueFieldId":"paid"}}));}
row.addElement(new GridDbHeadCell(id+"_col_state",{"readBind":{"valueFieldId":"state"},"fieldValueToRowClass":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_behind_plan",{"readBind":{"valueFieldId":"behind_plan"},"fieldValueToRowClass":true,"visible":false}));if(options.ext_ship_num){row.addElement(new GridDbHeadCell(id+"_col_ext_order_num",{"value":"№ сч.","readBind":{"valueFieldId":"ext_order_num"},"sortable":true,"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_ext_ship_num",{"value":"№ реал.","readBind":{"valueFieldId":"ext_ship_num"},"sortable":true,"colAttrs":{"align":"center"}}));}
if(options.delivery_fact_date){row.addElement(new GridDbHeadCell(id+"_col_delivery_fact_date_descr",{"value":"Дата факт.отгр.","readBind":{"valueFieldId":"delivery_fact_date_descr"},"sortable":true,"colAttrs":{"align":"center","nowrap":"nowrap"}}));}
if(options.client_number){row.addElement(new GridDbHeadCell(id+"_col_client_number",{"value":"№ внутр.","readBind":{"valueFieldId":"client_number"},"sortable":true,"colAttrs":{"align":"center"}}));}
if(options.printed){row.addElement(new GridDbHeadCellBool(id+"_col_printed",{"value":"Печ.","readBind":{"valueFieldId":"printed"},"sortable":true,"colAttrs":{"align":"center"}}));}
if(options.customer_survey_date){row.addElement(new GridDbHeadCellBool(id+"_col_cust_surv_date_time_descr",{"value":"Опрос","readBind":{"valueFieldId":"cust_surv_date_time_descr"},"sortable":true,"sortCol":"cust_surv_date_time","colAttrs":{"align":"center"}}));}
if(options.submit_user){row.addElement(new GridDbHeadCellBool(id+"_col_submit_user_descr",{"value":"Ответств.","readBind":{"valueFieldId":"submit_user_descr"}}));}
head.addElement(row);this.m_grid=new DOCOrderGridDb(id+"_grid",{"head":head,"body":new GridBody(),"className":"orders","controller":controller,"readMethodId":options.readMethodId,"readModelId":options.readModelId,"editViewClass":DOCOrderDialog_View,"editInline":false,"pagination":options.pagination,"commandPanel":options.commands,"rowCommandPanelClass":null,"filter":filter,"refreshInterval":options.refreshInterval,"noAutoRefresh":options.noAutoRefresh,"onSelect":options.onSelect,"rowSelect":true,"fieldValueToRowClass":"state","fixedHeader":true,"attrs":{"name":options.name}});if(options.fast_filter){this.m_gridOrigToDOM=this.m_grid.toDOM;this.m_grid.toDOM=function(parent){self.m_fastFilter.toDOM(parent);self.m_gridOrigToDOM.call(self.m_grid,parent);}
this.m_gridOrigRemoveDOM=this.m_grid.removeDOM;this.m_grid.removeDOM=function(){self.m_fastFilter.removeDOM();self.m_gridOrigRemoveDOM.call(self.m_grid);}
this.m_grid.m_filterComplete=function(struc){self.m_fastFilter.getParams(struc);}
this.m_fastFilter.setOnRefresh(this.m_grid.onRefresh);this.m_fastFilter.setClickContext(this.m_grid);}
this.addElement(this.m_grid);}
extend(DOCOrderBaseList_View,ViewList); 
function DOCOrderNewList_View(id,options){options=options||{};options.title="Новые заявки";options.readModelId="DOCOrderNewList_Model";options.readMethodId="get_new_list";options.state=true;options.name="DOCOrderNewList_View";options.commands=new GridCommands(id+"_grid_cmd",{"noPrint":true,"noInsert":true,"cmdColumnManager":true});DOCOrderNewList_View.superclass.constructor.call(this,id,options);if(SERV_VARS.ROLE_ID=="sales_manager"||SERV_VARS.ROLE_ID=="admin"||SERV_VARS.ROLE_ID=="representative"){var btn;var popup_menu=new PopUpMenu();btn=new BtnAppendOrder({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnCancelLastState({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPassToProduction({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnSetClosed({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();options.commands.commandsToPopUp(popup_menu);this.m_grid.setPopUpMenu(popup_menu);}
this.m_gridOnGetData=this.m_grid.onGetData;var self=this;this.m_grid.onGetData=function(resp){self.m_gridOnGetData.call(self.m_grid,resp);var m=resp.getModelById("DOCOrderNewList_Model",true);var node;if(!self.m_cntCtrl){self.m_cntCtrl=new Control("MainView_DOCOrderNewList_View_cnt","mark",{"className":"badge"});self.m_cntCtrl.toDOM(nd("MainView_DOCOrderNewList_View_title"));self.m_prevCnt=m.getRowCount();}
var cnt=m.getRowCount();self.m_cntCtrl.setValue(cnt);if(cnt!=self.m_prevCnt){self.m_prevCnt=cnt;DOMHandler.addClass(self.m_cntCtrl.getNode(),"flashit")
setTimeout(function(){DOMHandler.removeClass(self.m_cntCtrl.getNode(),"flashit");},5000);}}}
extend(DOCOrderNewList_View,DOCOrderBaseList_View);DOCOrderNewList_View.prototype.m_cntCtrl;DOCOrderNewList_View.prototype.m_prevCnt; 
function DOCOrderCurrentList_View(id,options){options=options||{};options.title=options.title||"Текущие заявки";options.name=options.name||"DOCOrderCurrentList_View";options.fast_filter=true;options.state=true;var cmd_opts={"cmdColumnManager":true};if(SERV_VARS.ROLE_ID!="admin"){cmd_opts.noDelete=true;}
if(SERV_VARS.ROLE_ID=="client"){options.readModelId="DOCOrderCurrentForClientList_Model";options.readMethodId="get_current_for_client_list";}
else if(SERV_VARS.ROLE_ID=="production"){options.readModelId="DOCOrderCurrentForProductionList_Model";options.readMethodId="get_current_for_production_list";}
else{options.readModelId="DOCOrderCurrentList_Model";options.readMethodId=options.readMethodId||"get_current_list";}
cmd_opts.publicMethodId=options.readMethodId;options.pagination=new GridPagination(id+"_cont_all_orders_grid_pag",{"countPerPage":CONSTANT_VALS.grid_rows_per_page_count,"showPageCount":10}),options.commands=new GridCommands(id+"_grid_cmd",cmd_opts);DOCOrderCurrentList_View.superclass.constructor.call(this,id,options);var popup_menu=new PopUpMenu();if(SERV_VARS.ROLE_ID=="sales_manager"||SERV_VARS.ROLE_ID=="admin"||SERV_VARS.ROLE_ID=="representative"){var btn;btn=new BtnOrderDivis({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnAppendOrder({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnCancelLastState({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPassToProduction({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();btn=new BtnPrint({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintCheck({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();btn=new BtnSetPaid({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPaidToAcc({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();if(SERV_VARS.ROLE_ID=="admin"){btn=new BtnSetNotPaid({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);}
popup_menu.addSeparator();btn=new BtnSetPaidByBank({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPaidByBankToAcc({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();btn=new BtnSetClosed({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);if(SERV_VARS.ROLE_ID=="marketing"||SERV_VARS.ROLE_ID=="admin"){btn=new BtnCustomSurvey({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);}
popup_menu.addSeparator();btn=new BtnPrintOrder({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintTorg12({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintInvoice({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintUPD({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintTTN({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintShipDocs({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);}
else if(SERV_VARS.ROLE_ID=="production"){btn=new BtnPrint({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintAll({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintCheck({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();btn=new BtnSetReady({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnSetShipped({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();btn=new BtnCancelLastState({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);}
else if(SERV_VARS.ROLE_ID=="marketing"){btn=new BtnCustomSurvey({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);}
popup_menu.addSeparator();options.commands.commandsToPopUp(popup_menu);this.m_grid.setPopUpMenu(popup_menu);}
extend(DOCOrderCurrentList_View,DOCOrderBaseList_View); 
function DOCOrderProductionList_View(id,options){options=options||{};options.name="DOCOrderProductionList_View";options.readMethodId="get_current_for_representative_list";options.readModelId="DOCOrderCurrentForProductionList_Model";options.title="Заявки в производстве";options.fast_filter=true;options.client=true;options.products=true;options.warehouse=true;options.ext_ship_num=true;options.delivery_fact_date=true;options.number=true;options.client_number=true;options.paid=true;options.printed=true;options.customer_survey_date=false;options.filter=true;options.state=true;options.submit_user=true;options.className="";options.noAutoRefresh=CONSTANT_VALS.ordersCallapsed;options.refreshInterval=(CONSTANT_VALS.ordersCallapsed)?0:CONSTANT_VALS.db_controls_refresh_sec*1000;options.pagination=new GridPagination(id+"_cont_all_orders_grid_pag",{"countPerPage":CONSTANT_VALS.grid_rows_per_page_count,"showPageCount":10});var cmd_opts={"cmdColumnManager":true};cmd_opts.publicMethodId=options.readMethodId;options.commands=new GridCommands(id+"_grid_cmd",cmd_opts);DOCOrderProductionList_View.superclass.constructor.call(this,id,options);var popup_menu=new PopUpMenu();btn=new BtnPrint({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintAll({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintCheck({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();btn=new BtnSetReady({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnSetShipped({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();btn=new BtnCancelLastState({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();options.commands.commandsToPopUp(popup_menu);this.m_grid.setPopUpMenu(popup_menu);}
extend(DOCOrderProductionList_View,DOCOrderBaseList_View); 
function DOCOrderClosedList_View(id,options){options=options||{};options.title="Архив заявок";options.refreshInterval=0;options.number=true;options.products=true;options.readModelId="DOCOrderClosedList_Model";options.readMethodId="get_closed_list";options.commands=new GridCommands(id+"_grid_cmd",{"noInsert":true,"noDelete":true,"noCopy":false});DOCOrderClosedList_View.superclass.constructor.call(this,id,options);var btn;var popup_menu=new PopUpMenu();if(SERV_VARS.ROLE_ID=="marketing"||SERV_VARS.ROLE_ID=="admin"){btn=new BtnCustomSurvey({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);}
btn=new BtnPrintOrder({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintTorg12({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintInvoice({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintUPD({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintTTN({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);btn=new BtnPrintShipDocs({"grid":this.m_grid});options.commands.addElement(btn);popup_menu.addButton(btn);popup_menu.addSeparator();options.commands.commandsToPopUp(popup_menu);this.m_grid.setPopUpMenu(popup_menu);}
extend(DOCOrderClosedList_View,DOCOrderBaseList_View); 
function DOCOrderDialog_View(id,options){options=options||{};options.tagName="div";var self=this;this.m_beforeOpen=function(contr,isInsert,isCopy){var doc_id=0;self.m_productDetails.getGridControl().setViewId(self.m_viewId);if(!isInsert){doc_id=self.getDataControl(self.getId()+"_id").control.getValue();}
contr.run("before_open",{async:false,params:{"doc_id":doc_id,"view_id":self.m_viewId}});self.m_beforeOpenCalled=true;}
if(SERV_VARS.ROLE_ID=="sales_manager"||SERV_VARS.ROLE_ID=="representative"||SERV_VARS.ROLE_ID=="admin"){this.m_downloadPrintCtrl=new ButtonCmd(id+"btnCancel",{"caption":"Счет","onClick":function(){self.onDownloadOrder();},"attrs":{"title":"сохранить печатную форму счета в файл"}});options.cmdControls=[this.m_downloadPrintCtrl];}
else if(SERV_VARS.ROLE_ID=="production"||SERV_VARS.ROLE_ID=="representative"){this.m_ctrlSetShipped=new BtnSetShipped({"className":"btn btn-primary btn-cmd","enabled":false});options.cmdControls=[this.m_ctrlSetShipped];}
DOCOrderDialog_View.superclass.constructor.call(this,id,options);var model_id="DOCOrderDialog_Model";this.m_evClientUserSelected=function(){self.onClientUserSelected();};this.m_evWarehouseSelected=function(){self.onWarehouseSelected();};this.m_evFirmSelected=function(){self.onFirmSelected();};this.m_viewId=hex_md5(uuid());this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id","tableLayout":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});var cont_r;var bs_col=get_bs_col();cont_r=new ControlContainer(uuid(),"div",{"className":"row"});var ctrl_cont=new ControlContainer(uuid(),"div",{"className":bs_col+12});var ctrl=new Control(uuid(),"span",{"value":"Статус:","className":bs_col+2});ctrl_cont.addElement(ctrl);var ctrl=new Control(id+"_state","span",{"value":"Формирование новой заявки","className":"old_state_descr","enabled":"false"});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"state_descr","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});ctrl_cont.addElement(ctrl);cont_r.addElement(ctrl_cont);var ctrl_cont=new ControlContainer(uuid(),"div",{"className":bs_col+4});this.m_cancelCauseCtrl=new DOCOrderCancelCause("DocOrderCancelCause");ctrl_cont.addElement(this.m_cancelCauseCtrl);cont_r.addElement(ctrl_cont);var ctrl_cont=new ControlContainer(uuid(),"div",{"className":bs_col+4});this.m_childCtrl=new DocOrderChildren("DocOrderChildrenList");ctrl_cont.addElement(this.m_childCtrl);this.addElement(cont_r);cont_r=new ControlContainer(uuid(),"div",{"className":"row"});var cont=new ControlContainer(id+"_firm_panel","div",{"className":(bs_col+((SERV_VARS.ROLE_ID=="client")?"12":"6"))});if(SERV_VARS.ROLE_ID!="client"){var ctrl=new EditNum(id+"_number",{"labelCaption":"Номер:","name":"number","tableLayout":false,"buttonClear":false,"attrs":{"maxlength":5,"size":5,"disabled":"disabled","required":"required"}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"number","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});cont.addElement(ctrl);}
else{var ctrl=new EditString(id+"_client_number",{"labelCaption":"№ внутренний:","name":"client_number","tableLayout":false,"buttonClear":false,"attrs":{"maxlength":12,"size":5}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"client_number","keyFieldIds":null},{"valueFieldId":"client_number","keyFieldIds":null});cont.addElement(ctrl);}
var ctrl=new EditDate(id+"_delivery_plan_date",{"labelCaption":"Планируемая дата выполнения:","name":"delivery_plan_date","editContClassName":"input-group "+get_bs_col()+"6","buttonClear":false,"tableLayout":false,"attrs":{"required":"required"}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"delivery_plan_date_descr","keyFieldIds":null},{"valueFieldId":"delivery_plan_date","keyFieldIds":null});cont.addElement(ctrl);var firm_wh_vis=(SERV_VARS.ROLE_ID!="client");this.m_FirmCtrl=new FirmEditObject("firm_id",id+"_firm",false,null,{visible:firm_wh_vis,required:firm_wh_vis,events:{"change":function(){self.updateDebts();}}});this.bindControl(this.m_FirmCtrl,{"modelId":model_id,"valueFieldId":"firm_descr","keyFieldIds":["firm_id"]},{"valueFieldId":null,"keyFieldIds":["firm_id"]});cont.addElement(this.m_FirmCtrl);this.m_wareHCtrl=new OrderWarehouseEditObject("warehouse_id",id+"_warehouse",false,null,{visible:firm_wh_vis});this.bindControl(this.m_wareHCtrl,{"modelId":model_id,"valueFieldId":"warehouse_descr","keyFieldIds":["warehouse_id"]},{"valueFieldId":null,"keyFieldIds":["warehouse_id"]});cont.addElement(this.m_wareHCtrl);cont_r.addElement(cont);if(SERV_VARS.ROLE_ID!="client"){var cont=new ControlContainer(id+"_client_panel","div",{"className":bs_col+"6"});this.m_clientCtrl=new ClientEditObject("client_id",id+"_client",false,{"noOpen":true,"required":true,"onSelected":function(){self.onClientSelected(true);},"extraFields":["def_firm_id","def_warehouse_id","def_debt","debt_total","deliv_add_cost_to_product"],"winObj":options.winObj});this.bindControl(this.m_clientCtrl,{"modelId":model_id,"valueFieldId":"client_descr","keyFieldIds":["client_id"]},{"valueFieldId":null,"keyFieldIds":["client_id"]});cont.addElement(this.m_clientCtrl);this.m_clientContractCtrl=new ClientExtContractEdit({"fieldId":"client_contract_ext_id","controlId":(id+"client_contract_ext_id"),"contr":(new Client_Controller(new ServConnector(HOST_NAME))),"noOpen":true,"winObj":options.winObj,"mainView":this});this.bindControl(this.m_clientContractCtrl,{"modelId":model_id,"valueFieldId":"client_contract_name","keyFieldIds":["client_contract_ext_id"]},{"valueFieldId":null,"keyFieldIds":["client_contract_ext_id"]});cont.addElement(this.m_clientContractCtrl);this.m_gruzpolCtrl=new ClientEditObject("gruzopoluchatel_id",id+"_gruzopoluchatel",false,{"required":false,"labelCaption":"Грузополучатель:","noOpen":true,"onSelected":function(){self.onClientSelected(true);},"winObj":options.winObj});this.bindControl(this.m_gruzpolCtrl,{"modelId":model_id,"valueFieldId":"gruzopoluchatel_descr","keyFieldIds":["gruzopoluchatel_id"]},{"valueFieldId":null,"keyFieldIds":["gruzopoluchatel_id"]});cont.addElement(this.m_gruzpolCtrl);this.m_clientUserCtrl=new ClientUserEditObject("client_user_id",id+"_client_user",false);this.bindControl(this.m_clientUserCtrl,{"modelId":model_id,"valueFieldId":"client_user_descr","keyFieldIds":["client_user_id"]},{"valueFieldId":null,"keyFieldIds":["client_user_id"]});cont.addElement(this.m_clientUserCtrl);this.m_ClientUserTelCtrl=new EditString(id+"_client_user_tel",{"labelCaption":"Телефон:","name":"client_user_tel","buttonClear":false,"tableLayout":false,"attrs":{"disabled":"disabled","value":"<не задан сотрудник>"}});this.bindControl(this.m_ClientUserTelCtrl,{"modelId":model_id,"valueFieldId":"client_user_cel_phone","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});cont.addElement(this.m_ClientUserTelCtrl);this.m_debtInfCtrl=new Control(id+"_debt_inf","div",{"name":"debt_inf"});cont.addElement(this.m_debtInfCtrl);this.m_defDebtInfCtrl=new Control(id+"_def_debt_inf","div",{"name":"debt_inf"});cont.addElement(this.m_defDebtInfCtrl);cont_r.addElement(cont);}
this.addElement(cont_r);this.m_details=new ControlContainer(uuid(),"div",{"className":"row"});this.m_productDetails=new DOCOrderDOCTProductList_View("DOCOrderDOCTProductList",{"connect":new ServConnector(HOST_NAME),"errorControl":this.getErrorControl(),"warehouseCtrl":this.m_wareHCtrl,"afterRefresh":function(){self.refreshProdTotals();if(self.m_doCalcVehCount){self.calcVehicleCount();self.m_doCalcVehCount=false;}},"onModified":function(){self.m_doCalcVehCount=true;},"onDelete":function(){self.recalcPricesRefreshTotals();}});this.m_details.addElement(this.m_productDetails);this.addElement(this.m_details);var cont=new ControlContainer(uuid(),"div",{"className":"row DOCOrderTot"});var sub_cont=new ControlContainer(uuid(),"div",{className:bs_col+"6"});sub_cont.addElement(new Control(uuid(),"span",{"value":"Транспортировочный объем: "}));this.m_totVol=new Control(uuid(),"span");sub_cont.addElement(this.m_totVol);sub_cont.addElement(new Control(uuid(),"span",{"value":" м3"}));sub_cont.addElement(new Control("prod_tot_w","span",{"value":", масса груза: "}));this.m_totWt=new Control("prod_tot_wt","span");sub_cont.addElement(this.m_totWt);sub_cont.addElement(new Control("prod_tot_wt2","span",{"value":" т."}));cont.addElement(sub_cont);var sub_cont=new ControlContainer(uuid(),"div",{"className":bs_col+"6 text-right"});var sub_s_cont=new ControlContainer(uuid(),"div");sub_s_cont.addElement(new Control("prod_tot_r1","span",{"value":"Итого: "}));this.m_totSum=new Control("prod_tot_r2","span");sub_s_cont.addElement(this.m_totSum);sub_s_cont.addElement(new Control("prod_tot_r3","span",{"value":" руб."}));sub_cont.addElement(sub_s_cont);var sub_s_cont=new ControlContainer(uuid(),"div");sub_s_cont.addElement(new Control("prod_totp_r1","span",{"value":"Итого упаковка: "}));this.m_totSumPack=new Control("prod_totp_r2","span");sub_s_cont.addElement(this.m_totSumPack);sub_s_cont.addElement(new Control("prod_totp_r3","span",{"value":" руб."}));sub_cont.addElement(sub_s_cont);var sub_s_cont=new ControlContainer(uuid(),"div");sub_s_cont.addElement(new Control("prod_tot_r4","span",{"value":"Итого с доставкой и упак.: "}));this.m_totTotal=new Control("prod_tot_r5","span");sub_s_cont.addElement(this.m_totTotal);sub_s_cont.addElement(new Control("prod_tot_r6","span",{"value":" руб."}));sub_cont.addElement(sub_s_cont);cont.addElement(sub_cont);this.addControl(cont);var cont=new ControlContainer(uuid(),"div",{"className":"row"});this.m_clientDestCtrl=new ClientDestinationEdit2(id+"_deliv_destination",{"fieldId":"deliv_destination_id","winObj":options.winObj,"mainView":this,"options":{"onSelected":function(){if(!parseInt(self.m_clientDestCtrl.getAttr("fkey_deliv_destination_id"))){self.m_clientDestCtrl.setEnabled(false);var contr=new ClientDestination_Controller(new ServConnector(HOST_NAME));contr.run("insert",{"params":{"error_on_no_road":"1","client_id":self.m_clientCtrl.getAttr("fkey_client_id"),"value":self.m_clientDestCtrl.getValue()},"func":function(resp){if(resp.modelExists("InsertedId_Model")){var m=resp.getModelById("InsertedId_Model",true);if(m.getNextRow()){self.m_clientDestCtrl.setAttr("fkey_deliv_destination_id",m.getFieldValue("id"));DOMHandler.removeClass(self.m_clientDestCtrl.m_node,"error");self.calcDelivCost();}}
self.m_clientDestCtrl.setEnabled(true);},"err":function(resp,errCode,errStr){self.m_clientDestCtrl.setEnabled(true);window.showTempError(errStr,null,ERR_MSG_WAIT_MS);}});}
else{self.calcDelivCost();}}}});this.bindControl(this.m_clientDestCtrl,{"modelId":model_id,"valueFieldId":"deliv_destination_descr","keyFieldIds":["deliv_destination_id"]},{"valueFieldId":null,"keyFieldIds":["deliv_destination_id"]});cont.addElement(this.m_clientDestCtrl);this.m_saleStoreAddressCtrl=new SaleStoreAddressEditObject("sale_store_address_id",id+"_sale_store_address",false,null,{visible:true,required:false});this.bindControl(this.m_saleStoreAddressCtrl,{"modelId":model_id,"valueFieldId":"sale_store_address_descr","keyFieldIds":["sale_store_address_id"]},{"valueFieldId":null,"keyFieldIds":["sale_store_address_id"]});cont.addElement(this.m_saleStoreAddressCtrl);this.m_orderNum=new EditString(id+"_order_num",{"labelCaption":"№ заказа:","name":"order_num","tableLayout":false,"buttonClear":false,"attrs":{"maxlength":100,"size":20},"contClassName":"aaa"});this.bindControl(this.m_orderNum,{"modelId":model_id,"valueFieldId":"order_num","keyFieldIds":null},{"valueFieldId":"order_num","keyFieldIds":null});cont.addElement(this.m_orderNum);const_v=(SERV_VARS.ORDER_DESTINATION_TO_TTN=="t"?"true":"false");this.m_destination_to_ttn=new EditCheckBox(id+"_destination_to_ttn",{"labelCaption":"Переносить адрес доставки в ТТН","name":"destination_to_ttn","buttonClear":false,"labelAlign":"left","tableLayout":false,"checked":(SERV_VARS.ORDER_DESTINATION_TO_TTN=="t"?"true":"false"),"attrs":{}});this.bindControl(this.m_destination_to_ttn,{"modelId":model_id,"valueFieldId":"destination_to_ttn","keyFieldIds":null},{"valueFieldId":"destination_to_ttn","keyFieldIds":null});cont.addElement(this.m_destination_to_ttn);this.addControl(cont);var cont=new ControlContainer(id+"_deliv_panel","div",{"className":"row"});var sub_cont=new ControlContainer(uuid(),"div",{"className":bs_col+"6"});this.m_delivTypeCtrl=new DelivTypeEditObject({"fieldId":"deliv_type","controlId":id+"_deliv_type","inLine":false,"defaultId":"by_client","options":{"events":{"change":function(){self.changeDelivType();self.recalcPricesRefreshTotals();}}},});this.bindControl(this.m_delivTypeCtrl,{"modelId":model_id,"valueFieldId":"deliv_type_descr","keyFieldIds":["deliv_type"]},{"valueFieldId":null,"keyFieldIds":["deliv_type"]});sub_cont.addElement(this.m_delivTypeCtrl);this.m_toThirdPartyCtrl=new EditCheckBox(id+"_deliv_to_third_party",{"labelCaption":"Доставка третьему лицу","name":"deliv_to_third_party","buttonClear":false,"labelAlign":"left","tableLayout":false,"events":{"change":function(){self.setToThirdParty(self.m_toThirdPartyCtrl.getValue());self.recalcPricesRefreshTotals();}},"attrs":{}});this.bindControl(this.m_toThirdPartyCtrl,{"modelId":model_id,"valueFieldId":"deliv_to_third_party","keyFieldIds":null},{"valueFieldId":"deliv_to_third_party","keyFieldIds":null});sub_cont.addElement(this.m_toThirdPartyCtrl);this.m_DelivPeriodCtrl=new DeliveryPeriodEditObject("deliv_period",id+"_deliv_period",false,3);this.bindControl(this.m_DelivPeriodCtrl,{"modelId":model_id,"valueFieldId":"deliv_period_descr","keyFieldIds":["deliv_period_id"]},{"valueFieldId":null,"keyFieldIds":["deliv_period_id"]});sub_cont.addElement(this.m_DelivPeriodCtrl);var ctrl=new EditString(id+"_deliv_responsable",{"labelCaption":"Ответственный за прием товара:","name":"deliv_responsable","buttonClear":false,"tableLayout":false,"attrs":{"maxlength:":"50","size":"25"}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"deliv_responsable","keyFieldIds":null},{"valueFieldId":"deliv_responsable","keyFieldIds":null});sub_cont.addElement(ctrl);var ctrl=new EditCellPhone(id+"_deliv_responsable_tel",{"labelCaption":"Телефон:","name":"_deliv_responsable_tel","tableLayout":false,"attrs":{}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"deliv_responsable_tel","keyFieldIds":null},{"valueFieldId":"deliv_responsable_tel","keyFieldIds":null});sub_cont.addElement(ctrl);var ctrl=new EditString(id+"_tel",{"labelCaption":"Телефон:","name":"_tel","tableLayout":false,"attrs":{"maxlength":"15"}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"tel","keyFieldIds":null},{"valueFieldId":"tel","keyFieldIds":null});sub_cont.addElement(ctrl);cont.addElement(sub_cont);var sub_cont=new ControlContainer(uuid(),"div",{"className":bs_col+"6"});var ctrl=new EditCheckBox(id+"_deliv_send_sms",{"labelCaption":"Уведомлять перед отгрузкой","name":"deliv_send_sms","tableLayout":false,"buttonClear":false,"labelAlign":"left","attrs":{}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"deliv_send_sms","keyFieldIds":null},{"valueFieldId":"deliv_send_sms","keyFieldIds":null});sub_cont.addElement(ctrl);this.m_delivCostOptCtrl=new DelivCostOptEdit({"fieldId":"deliv_cost_opt_id","controlId":id+"_deliv_cost_opt","inLine":false,"options":{"events":{"change":function(){self.calcVehicleCount();}}}});this.bindControl(this.m_delivCostOptCtrl,{"modelId":model_id,"valueFieldId":"deliv_cost_opt_descr","keyFieldIds":["deliv_cost_opt_id"]},{"valueFieldId":null,"keyFieldIds":["deliv_cost_opt_id"]});sub_cont.addElement(this.m_delivCostOptCtrl);this.m_cityRouteDistanceCtrl=new Control(id+"_city_route_distance","div",{"name":"city_route_distance","visible":false});this.bindControl(this.m_cityRouteDistanceCtrl,{"modelId":model_id,"valueFieldId":"city_route_distance","keyFieldIds":null},{"valueFieldId":"city_route_distance","keyFieldIds":null});sub_cont.addElement(this.m_cityRouteDistanceCtrl);this.m_countryRouteDistanceCtrl=new Control(id+"_country_route_distance","div",{"name":"country_route_distance","visible":false});this.bindControl(this.m_countryRouteDistanceCtrl,{"modelId":model_id,"valueFieldId":"country_route_distance","keyFieldIds":null},{"valueFieldId":"country_route_distance","keyFieldIds":null});sub_cont.addElement(this.m_countryRouteDistanceCtrl);this.m_delivVehicleCntCtrl=new EditNum(id+"_deliv_vehicle_count",{"labelCaption":"Кол-во автомоб.:","name":"deliv_vehicle_count","tableLayout":false,"buttonClear":false,"attrs":{"maxlength":5,"size":5,"required":"required"},"events":{"keyup":function(){self.checkForVehicleCapacity();self.calcDelivCost();}}});this.bindControl(this.m_delivVehicleCntCtrl,{"modelId":model_id,"valueFieldId":"deliv_vehicle_count","keyFieldIds":null},{"valueFieldId":"deliv_vehicle_count","keyFieldIds":null});sub_cont.addElement(this.m_delivVehicleCntCtrl);this.m_vehicleCtrl=new VehicleEditObject({"fieldId":"vehicle_id","controlId":"vehicle","inLine":false,"options":{"attrs":{"fkey_vehicle_id":"vehicle_id"},"alwaysUpdate":true}});this.bindControl(this.m_vehicleCtrl,{"modelId":model_id,"valueFieldId":"vehicle_descr","keyFieldIds":["vehicle_id"]},{"modelId":model_id,"valueFieldId":null,"keyFieldIds":["vehicle_id"]});sub_cont.addElement(this.m_vehicleCtrl);this.m_delivCostComment=new Control(id+"_deliv_comment","div",{});sub_cont.addElement(this.m_delivCostComment);var opts={"labelCaption":"Стоимость доставки (руб.):","name":"deliv_total","tableLayout":false};var ctrl_class;if(SERV_VARS.ROLE_ID=="client"){ctrl_class=EditFloat;opts.enabled=false;}
else{ctrl_class=EditMoneyEditable;opts.onToggle=function(v){if(!v){self.calcDelivCost();}};var ctrl_edit=new Control(id+"_deliv_total_edit","div",{"name":"deliv_total_edit","tableLayout":false,"visible":false,"value":"false"});this.bindControl(ctrl_edit,{"modelId":model_id,"valueFieldId":"deliv_total_edit","keyFieldIds":null},{"valueFieldId":"deliv_total_edit","keyFieldIds":null});sub_cont.addElement(ctrl_edit);opts.editAllowedFieldCtrl=ctrl_edit;}
opts.events={"keyup":function(){self.calcDelivCost();}};this.m_delivCost=new ctrl_class(id+"_deliv_total",opts);this.bindControl(this.m_delivCost,{"modelId":model_id,"valueFieldId":"deliv_total","keyFieldIds":null},{"valueFieldId":"deliv_total","keyFieldIds":null});sub_cont.addElement(this.m_delivCost);if(SERV_VARS.ROLE_ID!="client"){var ctrl_edit=new Control(id+"_deliv_expenses_edit","div",{"name":"deliv_expenses_edit","tableLayout":false,"visible":false,"value":"false"});this.bindControl(ctrl_edit,{"modelId":model_id,"valueFieldId":"deliv_expenses_edit","keyFieldIds":null},{"valueFieldId":"deliv_expenses_edit","keyFieldIds":null});sub_cont.addElement(ctrl_edit);this.m_delivExpCtrl=new EditMoneyEditable(id+"_deliv_expenses",{"labelCaption":"Затраты на доставку (руб.):","name":"deliv_expenses","tableLayout":false,"editAllowedFieldCtrl":ctrl_edit});this.bindControl(this.m_delivExpCtrl,{"modelId":model_id,"valueFieldId":"deliv_expenses","keyFieldIds":null},{"valueFieldId":"deliv_expenses","keyFieldIds":null});sub_cont.addElement(this.m_delivExpCtrl);this.m_delivPayBank=new EditCheckBox(id+"_deliv_pay_bank",{"labelCaption":"Оплата за доставку по безналичному расчету","name":"deliv_pay_bank","buttonClear":false,"labelAlign":"left","tableLayout":false,"attrs":{}});this.bindControl(this.m_delivPayBank,{"modelId":model_id,"valueFieldId":"deliv_pay_bank","keyFieldIds":null},{"valueFieldId":"deliv_pay_bank","keyFieldIds":null});sub_cont.addElement(this.m_delivPayBank);}
this.m_delivAddToCostCtrl=new EditCheckBox(id+"_deliv_add_cost_to_product",{"labelCaption":"Включать стоимость доставки пропорционально в стоимость продукции","name":"deliv_add_cost_to_product","buttonClear":false,"labelAlign":"left","tableLayout":false,"attrs":{},"events":{"change":function(){self.recalcProductPrices();}}});this.bindControl(this.m_delivAddToCostCtrl,{"modelId":model_id,"valueFieldId":"deliv_add_cost_to_product","keyFieldIds":null},{"valueFieldId":"deliv_add_cost_to_product","keyFieldIds":null});sub_cont.addElement(this.m_delivAddToCostCtrl);cont.addElement(sub_cont);this.addElement(cont);var com_p_id=uuid();var cont=new ControlContainer(com_p_id,"div",{"className":"collapse in"});if(SERV_VARS.ROLE_ID!="client"){this.addElement(new ButtonToggle(uuid(),{"caption":"комментарии","dataTarget":com_p_id,"expanded":true,"attrs":{"title":"показать/скрыть комментарий"}}));var ctrl=new EditString(id+"_sales_manager_comment",{"labelCaption":"Комментарий внутр.:","name":"sales_manager_comment","buttonClear":false,"tableLayout":false,"attrs":{"size":"80"}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"sales_manager_comment","keyFieldIds":null},{"valueFieldId":"sales_manager_comment","keyFieldIds":null});cont.addElement(ctrl);}
var ctrl=new EditString(id+"_client_comment",{"labelCaption":"Комментарий:","name":"client_comment","buttonClear":false,"tableLayout":false,"attrs":{"size":"80"}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"client_comment","keyFieldIds":null},{"valueFieldId":"client_comment","keyFieldIds":null});cont.addElement(ctrl);this.addControl(cont);var const_man=new ConstantManager();var constants={"allowed_extesions":null};const_man.get(constants);var com_p_id=uuid();this.m_fileListCont=new ControlContainer(com_p_id,"div",{"className":"collapse in"});this.addElement(new ButtonToggle(uuid(),{"caption":"вложенные файлы","dataTarget":com_p_id,"expanded":true,"attrs":{"title":"показать/скрыть файлы"}}));this.m_fileList=new EditFile(id+"_file_list",{"multipleFiles":true,"showHref":false,"showPic":true,"onDeleteFile":function(fileId,callBack){self.deleteAttachment(fileId,callBack);},"onFileAdded":function(fileId){self.addAttachment(fileId);},"onDownload":function(fileId){self.downloadAttachment(fileId);},"allowedFileExtList":constants.allowed_extesions.getValue().split(",")});this.bindControl(this.m_fileList,{"modelId":model_id,"valueFieldId":"attachments","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.m_fileListCont.addElement(this.m_fileList);this.addControl(this.m_fileListCont);this.m_readOnly=false;}
extend(DOCOrderDialog_View,ViewDialog);DOCOrderDialog_View.prototype.m_detailContainer;DOCOrderDialog_View.prototype.m_readOnly;DOCOrderDialog_View.prototype.getDetailControl=function(controlId){return this.m_details.getElementById(controlId);}
DOCOrderDialog_View.prototype.readData=function(async,isCopy){DOCOrderDialog_View.superclass.readData.call(this,false,isCopy);}
DOCOrderDialog_View.prototype.setDebts=function(debtTotal,defDebt){if(this.m_defDebtInfCtrl&&!isNaN(debtTotal)&&debtTotal!=0){this.m_debtInfCtrl.setValue(((debtTotal>0)?"Долг контрагента ":"Наш долг ")+numberFormat((debtTotal<0)?-debtTotal:debtTotal,2,",","'")+" руб.");DOMHandler.setAttr(this.m_debtInfCtrl.getNode(),"class",(debtTotal>0)?"text-danger clientDebts":"text-info clientDebts");if(!isNaN(defDebt)&&defDebt){this.m_defDebtInfCtrl.setValue("Просроченный долг "+numberFormat(defDebt,2,",","'")+" руб.");DOMHandler.setAttr(this.m_defDebtInfCtrl.getNode(),"class","text-danger clientDebts");}
else{DOMHandler.setAttr(this.m_defDebtInfCtrl.getNode(),"class","hidden");}}
else if(this.m_defDebtInfCtrl){DOMHandler.setAttr(this.m_defDebtInfCtrl.getNode(),"class","hidden");DOMHandler.setAttr(this.m_debtInfCtrl.getNode(),"class","hidden");}}
DOCOrderDialog_View.prototype.setClientId=function(clientId,setPopFirm){this.setClientUserTel("");if(this.m_clientUserCtrl){this.m_clientUserCtrl.setClientId(clientId);this.m_clientUserCtrl.onRefresh();}
this.m_clientDestCtrl.setClientId(clientId);this.m_productDetails.setClientId(clientId);if(this.m_clientCtrl){this.setDebts(0,0);var def_firm=this.m_clientCtrl.getAttr("def_firm_id");var def_warehouse=this.m_clientCtrl.getAttr("def_warehouse_id");if(def_firm&&def_firm!="null"){this.m_FirmCtrl.setFieldId("firm_id",def_firm);var debt_total=parseFloat(this.m_clientCtrl.getAttr("debt_total"));if(!isNaN(debt_total)&&debt_total){this.setDebts(debt_total,parseFloat(this.m_clientCtrl.getAttr("def_debt")));}}
else if(!setPopFirm||this.m_FirmCtrl.getFieldValue()){this.updateDebts();}
if(def_warehouse&&def_warehouse!="null"){this.m_wareHCtrl.setFieldId("warehouse_id",def_warehouse);this.onWarehouseSelected();}
var add_cost_old_val=this.m_delivAddToCostCtrl.getValue();var add_cost_val=this.m_clientCtrl.getAttr("deliv_add_cost_to_product");if(add_cost_val&&add_cost_old_val!=add_cost_val){this.m_delivAddToCostCtrl.setValue(add_cost_val);this.recalcProductPrices();}}
if(setPopFirm&&!this.m_FirmCtrl.getFieldValue()){var self=this;var contr=new Client_Controller(new ServConnector(HOST_NAME));contr.run("get_pop_firm",{"params":{"client_id":clientId},"errControl":this.getErrorControl(),"func":function(resp){var m=resp.getModelById("get_pop_firm");m.setActive(true);if(m.getNextRow()){self.m_FirmCtrl.setValue(m.getFieldValue('firm_descr'));self.m_FirmCtrl.setFieldValue("id",m.getFieldValue('firm_id'));self.setDebts(parseFloat(m.getFieldValue('debt_total')),parseFloat(m.getFieldValue('def_debt')));self.onFirmSelected();}}});}}
DOCOrderDialog_View.prototype.onClientSelected=function(setPopFirm){var id=0;if(this.m_clientCtrl){id=this.m_clientCtrl.getAttr("fkey_client_id");}
this.setClientId(id,setPopFirm);}
DOCOrderDialog_View.prototype.setClientUserTel=function(tel){if(this.m_ClientUserTelCtrl){this.m_ClientUserTelCtrl.setValue(tel);}}
DOCOrderDialog_View.prototype.onClientUserSelected=function(){var ctrl=this.getDataControl(this.getId()+"_client_user").control;this.setClientUserTel(ctrl.getFieldAttr("cel_phone"));}
DOCOrderDialog_View.prototype.setToThirdParty=function(v){this.m_productDetails.setToThirdParty(v);}
DOCOrderDialog_View.prototype.setWarehouseId=function(id){this.m_productDetails.setWarehouseId(id);}
DOCOrderDialog_View.prototype.onWarehouseSelected=function(){this.setWarehouseId(this.m_wareHCtrl.getFieldValue());this.calcDelivCost();}
DOCOrderDialog_View.prototype.onFirmSelected=function(){var wh=this.m_wareHCtrl.getFieldValue();if(!wh){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));var self=this;contr.run("get_pop_warehouse",{"params":{"firm_id":this.m_FirmCtrl.getFieldValue()},"errControl":this.getErrorControl(),"func":function(resp){var m=resp.getModelById("get_pop_warehouse");m.setActive(true);if(m.getNextRow()){self.m_wareHCtrl.setValue(m.getFieldValue('warehouse_descr'));self.m_wareHCtrl.setFieldValue("id",m.getFieldValue('warehouse_id'));self.onWarehouseSelected();}}});}}
DOCOrderDialog_View.prototype.onGetData=function(resp){DOCOrderDialog_View.superclass.onGetData.call(this,resp,this.m_isCopy);if(this.m_saved){return;}
var id=this.getId();if(SERV_VARS.ROLE_ID!="client"){this.onClientSelected(false);var data_ctrl=this.getDataControl(id+"_client_user");if(data_ctrl){var ctrl=data_ctrl.control;ctrl.setFieldValue("client_user_id",ctrl.getAttr("fkey_client_user_id"));this.onClientUserSelected();}}
else{this.setClientId(0,false);}
this.updateDistanceInf();this.changeDelivType();this.m_clientContractCtrl.setEnabled(true);this.m_gruzpolCtrl.setEnabled(true);if(this.m_isCopy){var vh_n=this.m_vehicleCtrl.getNode();if(vh_n){vh_n.value="";vh_n.setAttribute("fkey_vehicle_id","");vh_n.setAttribute("last_fkey_vehicle_id","");}
if(this.m_delivTypeCtrl.getValue()=="by_client"){this.m_delivVehicleCntCtrl.setValue(0);}}
else{var m=resp.getModelById("head_history");m.setActive(true);while(m.getNextRow()){var f_id=m.getFieldValue("field");var p=f_id.indexOf("_id");if(p>=0){f_id=f_id.substring(0,p)}
if(!this.m_bindings[id+"_"+f_id]){continue;}
var ctrl=this.getDataControl(id+"_"+f_id);if(ctrl&&ctrl.control&&ctrl.control.m_node){DOMHandler.addClass(ctrl.control.m_node,"field_changed");ctrl.control.setAttr("old_field_val",m.getFieldValue("old_val"));}}
var m=resp.getModelById("DOCOrderDialog_Model",true);if(m.getNextRow()){this.m_curState=m.getFieldValue("state");var read_only_states=["producing","produced","shipped","loading","on_way","unloading","closed","canceled","canceled_by_sales_manager","canceled_by_client"];if(SERV_VARS.ROLE_ID=="client"){read_only_states.push("waiting_for_us");}
else{read_only_states.push("waiting_for_client");}
this.m_readOnly=($.inArray(this.m_curState,read_only_states)>=0);if(this.m_readOnly){this.setEnabled(false);this.m_ctrlCancel.setEnabled(true);this.m_ctrlOk.setEnabled(true);this.getViewControl(this.getId()+"_delivery_plan_date").setEnabled(true);if(SERV_VARS.ROLE_ID!="client"){this.getViewControl(this.getId()+"_sales_manager_comment").setEnabled(true);}
this.getViewControl(this.getId()+"_deliv_responsable_tel").setEnabled(true);this.getViewControl(this.getId()+"_tel").setEnabled(true);if(this.m_curState=="producing"||this.m_curState=="produced"||this.m_curState=="loading"||this.m_curState=="waiting_for_us"||this.m_curState=="waiting_for_client"){if(this.m_delivTypeCtrl.getValue()=="by_supplier"){this.m_vehicleCtrl.setEnabled(true);}
this.m_clientContractCtrl.setEnabled(true);this.m_gruzpolCtrl.setEnabled(true);}
this.m_clientDestCtrl.setEnabled(false);this.m_saleStoreAddressCtrl.setEnabled(false);this.m_orderNum.setEnabled(false);this.m_delivAddToCostCtrl.setEnabled(false);if(this.m_delivCost.setEditEnabled){this.m_delivCost.setEditEnabled(false);}
this.m_delivCostOptCtrl.setEnabled(false);}
else{var new_cap;if(SERV_VARS.ROLE_ID=="client"){if(this.m_curState=="waiting_for_client"){new_cap="Согласовать";}
else{new_cap="Изменить";}}
else{if(this.m_curState=="waiting_for_us"||this.m_curState=="new"){new_cap="Согласовать";}
else{new_cap="Изменить";}}
if(new_cap){this.m_ctrlOk.setCaption(new_cap);}}
if(this.m_curState=="shipped"&&m.getFieldValue("has_children")=="true"){this.m_childCtrl.setDocId(m.getFieldValue("id"));}
else if(this.m_curState=="canceled"||this.m_curState=="canceled_by_sales_manager"||this.m_curState=="canceled_by_client"){this.m_cancelCauseCtrl.setDocId(m.getFieldValue("id"));}
if(m.getFieldValue("deliv_total_edit")!="true"){this.m_delivCost.setEnabled(false);}
if(m.getFieldValue("deliv_expenses_edit")!="true"){this.m_delivExpCtrl.setEnabled(false);}
this.m_savedVehCount=toInt(m.getFieldValue("deliv_vehicle_count"));if(this.m_clientCtrl){this.setDebts(parseFloat(m.getFieldValue("debt_total")),parseFloat(m.getFieldValue("def_debt")));}
var attachments=m.getFieldValue("attachments");if(attachments&&attachments.length){this.m_fileList.setInitValue(CommonHelper.unserialize(attachments));this.m_fileList.toDOM(this.m_fileListCont.getNode());}}
if(this.m_downloadPrintCtrl){this.m_downloadPrintCtrl.setEnabled(true);}
if(this.m_ctrlSetShipped){this.m_ctrlSetShipped.setEnabled(true);this.m_ctrlSetShipped.m_keys={"id":m.getFieldValue("id")};this.m_ctrlSetShipped.m_grid=this.m_currentGrid;}}}
DOCOrderDialog_View.prototype.toDOM=function(parent){DOCOrderDialog_View.superclass.toDOM.call(this,parent);if(this.m_clientUserCtrl){EventHandler.addEvent(this.m_clientUserCtrl.getNode(),"change",this.m_evClientUserSelected);}
EventHandler.addEvent(this.m_wareHCtrl.getNode(),"change",this.m_evWarehouseSelected);EventHandler.addEvent(this.m_FirmCtrl.getNode(),"change",this.m_evFirmSelected);if(this.getIsNew()&&SERV_VARS.ROLE_ID=="client"){this.setClientId(0,true);}
else if(this.getIsNew()){this.m_clientCtrl.getNode().focus();}
this.setWarehouseId(this.m_wareHCtrl.getFieldValue());this.setToThirdParty(this.m_toThirdPartyCtrl.getValue());if(this.getEnabled())this.changeDelivType();}
DOCOrderDialog_View.prototype.removeDOM=function(){DOCOrderDialog_View.superclass.removeDOM.call(this);var self=this;if(this.m_clientUserCtrl){EventHandler.removeEvent(this.m_clientUserCtrl.getNode(),"change",this.m_evClientUserSelected);}
EventHandler.removeEvent(this.m_wareHCtrl.getNode(),"change",this.m_evWarehouseSelected);EventHandler.removeEvent(this.m_FirmCtrl.getNode(),"change",this.m_evFirmSelected);}
DOCOrderDialog_View.prototype.afterCopyData=function(){if(SERV_VARS.ROLE_ID!="client"){this.getDataControl(this.getId()+"_number").control.setValue("");}}
DOCOrderDialog_View.prototype.calcDelivCost=function(){this.m_delivCostComment.setValue("-");var do_calc_cost1=(!this.m_readOnly&&(SERV_VARS.ROLE_ID=="client"||this.getViewControlValue(this.getId()+"_deliv_total_edit")!="true"));var do_calc_cost2=(!this.m_readOnly&&(SERV_VARS.ROLE_ID=="client"||this.getViewControlValue(this.getId()+"_deliv_expenses_edit")!="true"));if(do_calc_cost1){this.m_delivCost.setValue("");}
if(do_calc_cost2){this.m_delivExpCtrl.setValue("");}
var wh_id=this.m_wareHCtrl.getFieldValue();var dest_id=this.m_clientDestCtrl.getFieldValue();var cost_opt_id=this.m_delivCostOptCtrl.getFieldValue();if(wh_id&&dest_id&&cost_opt_id){var former_state=this.m_wareHCtrl.getEnabled();if(former_state){this.m_wareHCtrl.setEnabled(false);this.m_delivCostOptCtrl.setEnabled(false);}
this.m_clientDestCtrl.setEnabled(false);this.m_saleStoreAddressCtrl.setEnabled(false);this.m_orderNum.setEnabled(false);this.getErrorControl().setValue("");var self=this;var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("calc_deliv_cost",{"params":{"warehouse_id":wh_id,"cost_opt_id":cost_opt_id,"client_destination_id":dest_id,"include_route":"0"},"err":function(resp,errCode,errStr){self.getErrorControl().setValue(errStr);self.refreshProdTotals();if(former_state){self.m_wareHCtrl.setEnabled(true);self.m_delivCostOptCtrl.setEnabled(true);}
self.m_clientDestCtrl.setEnabled(true);self.m_saleStoreAddressCtrl.setEnabled(true);self.m_orderNum.setEnabled(true);},"func":function(resp){var m=resp.getModelById("calc_deliv_cost");m.setActive(true);if(m.getNextRow()){self.m_cityRouteDistanceCtrl.setValue(parseFloat(m.getFieldValue("city_route_distance")));self.m_countryRouteDistanceCtrl.setValue(parseFloat(m.getFieldValue("country_route_distance")));self.updateDistanceInf();if(do_calc_cost1||do_calc_cost2){var v_cnt=self.m_delivVehicleCntCtrl.getValue();if(do_calc_cost1){self.m_delivCost.setValue(parseFloat(m.getFieldValue("total_cost")).toFixed(2)*v_cnt);}
if(do_calc_cost2){var cost2=0;var cost2_com="";if(do_calc_cost1){cost2=parseFloat(m.getFieldValue("total_cost2")).toFixed(2);}
else{var to_float=function(n){var r=parseFloat(n);return isNaN(r)?0:r;}
var country_cost2=to_float(m.getFieldValue("country_cost2"));var country_cost1=to_float(m.getFieldValue("country_cost"));var city_cost2=to_float(m.getFieldValue("city_cost2"));var city_cost1=to_float(m.getFieldValue("city_cost"));var dif=to_float(self.m_delivCost.getValue())-city_cost1;var distance_country=!country_cost1?0:(dif/(country_cost1?country_cost1:0));cost2=city_cost2+(distance_country*country_cost2);if(cost2>0&&cost2<city_cost2){self.m_delivExpCtrl.setComment();cost2_com="Меньше ставки по городу";}
else{if(cost2<=0){cost2=city_cost2;cost2_com="Ставка по городу";}}}
cost2=cost2*v_cnt;cost2=isNaN(cost2)?0:cost2;self.m_delivExpCtrl.setValue(parseFloat(cost2).toFixed(2));if(cost2_com.length){DOMHandler.addClass(self.m_delivExpCtrl.m_node,self.m_delivExpCtrl.INCORRECT_VAL_CLASS);}
else{DOMHandler.removeClass(self.m_delivExpCtrl.m_node,self.m_delivExpCtrl.INCORRECT_VAL_CLASS);}
self.m_delivExpCtrl.setComment(cost2_com);}
self.recalcPricesRefreshTotals();}
else{self.recalcPricesRefreshTotals();}
if(former_state){self.m_wareHCtrl.setEnabled(true);self.m_delivCostOptCtrl.setEnabled(true);}
self.m_clientDestCtrl.setEnabled(true);self.m_saleStoreAddressCtrl.setEnabled(true);self.m_orderNum.setEnabled(true);}}});}
else{this.recalcPricesRefreshTotals();}}
DOCOrderDialog_View.prototype.recalcPricesRefreshTotals=function(){if(this.m_delivAddToCostCtrl.getValue()=="true"){this.recalcProductPrices();}
else{this.refreshProdTotals();}}
DOCOrderDialog_View.prototype.recalcProductPrices=function(){if(this.m_readOnly){this.refreshProdTotals();return;}
var wh_id=this.m_wareHCtrl.getFieldValue();var cl_id;if(this.m_clientCtrl){cl_id=this.m_clientCtrl.getFieldValue();}
if(wh_id&&(!this.m_clientCtrl||cl_id)){this.m_wareHCtrl.setEnabled(false);if(this.m_clientCtrl){this.m_clientCtrl.setEnabled(false);}
this.getErrorControl().setValue("");var self=this;var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("recalc_product_prices",{"params":{"view_id":this.m_viewId,"warehouse_id":wh_id,"client_id":cl_id,"deliv_cost":this.m_delivCost.getValue(),"deliv_to_third_party":this.m_toThirdPartyCtrl.getValue(),"deliv_add_cost_to_product":this.m_delivAddToCostCtrl.getValue()},"err":function(resp,errCode,errStr){self.getErrorControl().setValue(errStr);self.m_wareHCtrl.setEnabled(true);if(self.m_clientCtrl){self.m_clientCtrl.setEnabled(true);}},"func":function(resp){self.m_productDetails.onRefresh(function(){self.refreshProdTotals();});self.m_wareHCtrl.setEnabled(true);if(self.m_clientCtrl){self.m_clientCtrl.setEnabled(true);}}});}
else{this.refreshProdTotals();}}
DOCOrderDialog_View.prototype.getModified=function(){var f_m=DOCOrderDialog_View.superclass.getModified.call(this);var t_m=this.m_productDetails.getGridControl().m_modified;return(f_m||t_m);}
DOCOrderDialog_View.prototype.setMethodParams=function(pm,checkRes){DOCOrderDialog_View.superclass.setMethodParams.call(this,pm,checkRes);if(this.m_productDetails.getGridControl().m_modified||(SERV_VARS.ROLE_ID=="client"&&this.m_curState=="waiting_for_client")||(SERV_VARS.ROLE_ID!="client"&&this.m_curState=="waiting_for_us")){checkRes.modif=true;}}
DOCOrderDialog_View.prototype.writeData=function(){var contr=this.getWriteController();if(!contr)return;contr.getPublicMethodById(this.getWriteMethodId()).setParamValue("view_id",this.m_viewId);contr.getPublicMethodById(this.getWriteMethodId()).setParamValue("client_contract_name",this.m_clientContractCtrl.getValue());DOCOrderDialog_View.superclass.writeData.call(this);}
DOCOrderDialog_View.prototype.onWriteOk=function(resp){DOCOrderDialog_View.superclass.onWriteOk.call(this,resp);this.m_productDetails.getGridControl().m_modified=false;if(this.m_currentGrid&&this.m_currentGrid.m_rendered){this.m_currentGrid.onRefresh();}}
DOCOrderDialog_View.prototype.refreshProdTotals=function(){var gr=this.m_productDetails.getGridControl();var rows=gr.getBody().getNode().getElementsByTagName("tr");var cells;var tot_sum=0;var tot_sum_pack=0;var tot_vol=0;var tot_wt=0;for(var ri=0;ri<rows.length;ri++){if(!cells){cells={};for(var ci=0;ci<rows[ri].cells.length;ci++){var id=DOMHandler.getAttr(rows[ri].cells[ci],"field_id");cells[id]=ci;}}
tot_sum+=toFloat(rows[ri].cells[cells.total].textContent);tot_sum_pack+=toFloat(rows[ri].cells[cells.total_pack].textContent);tot_vol+=toFloat(rows[ri].cells[cells.volume].textContent);tot_wt+=toFloat(rows[ri].cells[cells.weight].textContent);}
this.m_totVol.setValue(tot_vol.toFixed(3));this.m_totWt.setValue(tot_wt.toFixed(3));this.m_totSumPack.setValue(tot_sum_pack.toFixed(2));this.m_totSum.setValue(tot_sum.toFixed(2));if(this.m_delivAddToCostCtrl.getValue()=="false"){tot_sum+=toFloat(this.m_delivCost.getValue());}
tot_sum+=tot_sum_pack;this.m_totTotal.setValue(tot_sum.toFixed(2));}
DOCOrderDialog_View.prototype.getFormCaption=function(){return"Заявка";}
DOCOrderDialog_View.prototype.calcVehicleCount=function(){var ind=this.m_delivCostOptCtrl.m_node.selectedIndex;var sel_n=this.m_delivCostOptCtrl.m_node.options[ind];var v_max_vol=parseFloat(DOMHandler.getAttr(sel_n,"volume_m"));var v_max_wt=parseFloat(DOMHandler.getAttr(sel_n,"weight_t"));var vol=parseFloat(this.m_totVol.getValue());var wt=parseFloat(this.m_totWt.getValue());var vol_cnt=Math.ceil(vol/v_max_vol);var wt_cnt=Math.ceil(wt/v_max_wt);var cnt=(vol_cnt>wt_cnt)?vol_cnt:wt_cnt;cnt=toInt(cnt);this.m_delivVehicleCntCtrl.setValue(cnt);if(cnt>1){DOMHandler.addClass(this.m_delivVehicleCntCtrl.m_node,"veh_cnt_warn");}
else{DOMHandler.removeClass(this.m_delivVehicleCntCtrl.m_node,"veh_cnt_warn");}
this.m_savedVehCount=0;if(!this.m_oldVehicleCount||this.m_oldVehicleCount!=cnt){this.m_oldVehicleCount=cnt;this.checkForVehicleCapacity();}
this.calcDelivCost();}
DOCOrderDialog_View.prototype.updateDistanceInf=function(){var d1_m=parseFloat(this.m_cityRouteDistanceCtrl.getValue());var d1=Math.round(d1_m/1000);var d2_m=parseFloat(this.m_countryRouteDistanceCtrl.getValue());var d2=Math.round(d2_m/1000);var com="";if(d1>0){com="город ("+d1+"км.)";}
if(d2>0){com+=(com=="")?"":", ";com+="пригород ("+d2+"км.)";}
this.m_delivCostComment.setValue(com);}
DOCOrderDialog_View.prototype.changeDelivType=function(){var vis=(this.m_delivTypeCtrl.getValue()=="by_supplier");this.m_toThirdPartyCtrl.setEnabled(vis);this.m_delivCostOptCtrl.setEnabled(vis);if(SERV_VARS.ROLE_ID!="client"){this.m_delivPayBank.setEnabled(vis);}
this.m_delivAddToCostCtrl.setEnabled(vis);this.m_DelivPeriodCtrl.setEnabled(vis);this.m_clientDestCtrl.setEnabled(vis);this.m_saleStoreAddressCtrl.setEnabled(vis);this.m_orderNum.setEnabled(vis);this.m_vehicleCtrl.setEnabled(vis);if(vis){DOMHandler.addAttr(this.m_delivCostOptCtrl.getNode(),"required","required");DOMHandler.addAttr(this.m_clientDestCtrl.getNode(),"required","required");}
else{DOMHandler.removeAttr(this.m_delivCostOptCtrl.getNode(),"required");DOMHandler.removeAttr(this.m_clientDestCtrl.getNode(),"required");this.m_clientDestCtrl.resetValue();this.m_saleStoreAddressCtrl.resetValue();this.m_orderNum.resetValue();this.m_delivCostOptCtrl.resetValue();this.m_delivExpCtrl.resetValue();this.m_delivCost.resetValue();this.m_vehicleCtrl.resetValue();}}
DOCOrderDialog_View.prototype.getFormWidth=function(){return"1000";}
DOCOrderDialog_View.prototype.getFormHeight=function(){return((SERV_VARS.ROLE_ID=="client")?"700":"1010");}
DOCOrderDialog_View.prototype.doDownloadOrder=function(){var id=this.getDataControl(this.getId()+"_id").control.getValue();if(id){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));var meth=contr.getPublicMethodById("download_print");meth.setParamValue("doc_id",id);top.location.href=HOST_NAME+"index.php?"+
contr.getQueryString(contr.getPublicMethodById("download_print"));}}
DOCOrderDialog_View.prototype.onDownloadOrder=function(){var is_new=this.getIsNew();var self=this;if(this.getModified()&&!is_new){WindowQuestion.show({"text":"Для сохранения печатной формы, документ необходимо записать, продолжить?","callBack":function(res){if(res==WindowQuestion.RES_YES){self.writeData(false);if(self.m_lastWriteResult){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));self.m_beforeOpen(contr,false,false);self.doDownloadOrder();}}}});}
else{if(is_new){this.m_saved=true;this.onClickSave();if(!this.getIsNew()){setTimeout(function(){self.doDownloadOrder();},3000);}}
else{this.doDownloadOrder();}}}
DOCOrderDialog_View.prototype.updateDebts=function(){if(!this.m_clientCtrl){return;}
var cl_id=this.m_clientCtrl.getFieldValue();if(!cl_id){return;}
var f_id=this.m_FirmCtrl.getFieldValue();var self=this;var contr=new Client_Controller(new ServConnector(HOST_NAME));contr.run("get_debts_on_firm",{"params":{"client_id":cl_id,"firm_id":f_id},"err":function(resp,errCode,errStr){self.getErrorControl().setValue(errStr);},"func":function(resp){var m=resp.getModelById("get_debts_on_firm",true);var debt_total=0;var def_debt=0;if(m.getNextRow()){debt_total=parseFloat(m.getFieldValue("debt_total"));def_debt=parseFloat(m.getFieldValue("def_debt"));}
self.setDebts(debt_total,def_debt);}});}
DOCOrderDialog_View.prototype.checkForVehicleCapacity=function(){var vh_cnt=parseInt(this.m_delivVehicleCntCtrl.getValue());var ind=this.m_delivCostOptCtrl.m_node.selectedIndex;var sel_n=this.m_delivCostOptCtrl.m_node.options[ind];var v_max_vol=parseFloat(DOMHandler.getAttr(sel_n,"volume_m"))*vh_cnt;var v_max_wt=parseFloat(DOMHandler.getAttr(sel_n,"weight_t"))*vh_cnt;var vol=parseFloat(this.m_totVol.getValue());var wt=parseFloat(this.m_totWt.getValue());if(vol>v_max_vol){DOMHandler.addClass(this.m_delivVehicleCntCtrl.m_node,this.m_delivVehicleCntCtrl.INCORRECT_VAL_CLASS);this.m_delivVehicleCntCtrl.setComment("Объем продукции больше вместимости ТС!");}
else if(wt>v_max_wt){DOMHandler.addClass(this.m_delivVehicleCntCtrl.m_node,this.m_delivVehicleCntCtrl.INCORRECT_VAL_CLASS);this.m_delivVehicleCntCtrl.setComment("Масса продукции больше грузоподъемности ТС!");}
else{this.m_delivVehicleCntCtrl.setValid();this.m_delivVehicleCntCtrl.setComment("");}}
DOCOrderDialog_View.prototype.onCancel=function(){if(!nd("undefined_ClientDestinationDialog")){DOCOrderDialog_View.superclass.onCancel.call(this);}}
DOCOrderDialog_View.prototype.deleteAttachmentCont=function(fileId,callBack){var id=this.getDataControl(this.getId()+"_id").control.getValue();if(!id)return;(new DOCOrder_Controller(new ServConnector(HOST_NAME))).run("delete_file",{"params":{"doc_order_id":id,"file_id":fileId},"func":function(resp){if(callBack){callBack();}}});}
DOCOrderDialog_View.prototype.deleteAttachment=function(fileId,callBack){var self=this;WindowQuestion.show({"text":"Удалить файл?","cancel":false,"callBack":function(res){if(res==WindowQuestion.RES_YES){self.deleteAttachmentCont(fileId,callBack);}}});}
DOCOrderDialog_View.prototype.setAttachmentUploaded=function(fl,previewData){var n=document.getElementById(fl.file_id+"-pic");if(n){n.className="glyphicon glyphicon-ok";n.title="Файл прикреплен к заказу";}
var n=document.getElementById(fl.file_id+"-href");if(n){n.setAttribute("file_uploaded","true");}
var n=document.getElementById(fl.file_id+"-del");if(n){n.setAttribute("file_uploaded","true");}
fl.uploaded=true;var n=document.getElementById(fl.file_id+"-preview");if(n&&previewData){n.setAttribute("src","data:image/png;base64, "+previewData);var self=this;EventHandler.addEvent(n,"click",function(){self.downloadAttachment(fl.file_id);},false);}}
DOCOrderDialog_View.prototype.setAttachmentUploadError=function(fl){var n=document.getElementById(fl.file_id+"-pic");if(n){n.className="glyphicon glyphicon-remove";n.title="Ошибка загрузки файла";}}
DOCOrderDialog_View.prototype.addAttachmentCont=function(fl){var id=this.getDataControl(this.getId()+"_id").control.getValue();if(!id)return;var self=this;(new DOCOrder_Controller(new ServConnector(HOST_NAME))).run("add_file",{"get":false,"enctype":ServConnector.prototype.ENCTYPES.MULTIPART,"params":{"doc_order_id":id,"file_id":fl.file_id,"file_data":[fl]},"func":function(resp){if(resp.modelExists("Preview_Model")){var preview_data;var m=resp.getModelById("Preview_Model",true);if(m.getNextRow()){preview_data=m.getFieldValue("value");}
self.setAttachmentUploaded(fl,preview_data);}
self.m_clientDestCtrl.setEnabled(true);self.m_saleStoreAddressCtrl.setEnabled(true);self.m_orderNum.setEnabled(true);},"err":function(resp,errCode,errStr){self.setAttachmentUploadError(fl);throw new Error("Ошибка загрузки файла: "+errStr);}});}
DOCOrderDialog_View.prototype.addAttachment=function(fileId){var list=this.m_fileList.getFiles();if(!list||!list.length)return;var fl=list[list.length-1];var self=this;var is_new=this.getIsNew();if(!is_new){self.addAttachmentCont(fl);}
else{this.m_saved=true;this.onClickSave();if(!this.getIsNew()){setTimeout(function(){self.addAttachmentCont(fl);},3000);}}}
DOCOrderDialog_View.prototype.downloadAttachment=function(fileId){var id=this.getDataControl(this.getId()+"_id").control.getValue();if(!id)return;var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.getServConnector().openHref({"c":"DOCOrder_Controller","f":"get_file","inline":"1","doc_order_id":id,"file_id":fileId});} 
function DOCOrderDivisDialog_View(id,options){options=options||{};options.tagName="div";options.readMethodId="get_divis";options.insertMethodId="divide";DOCOrderDivisDialog_View.superclass.constructor.call(this,id,options);this.m_viewId=hex_md5(uuid());var self=this;var model_id="DOCOrderDivisDialog_Model";var cont=new ControlContainer(id+"_header","div",{"className":"panel"})
var ctrl=new EditDate(id+"_delivery_plan_date",{"labelCaption":"Планируемая дата выполнения:","name":"delivery_plan_date","buttonClear":false,"tableLayout":false,"attrs":{"required":"required"}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":null,"keyFieldIds":null},{"valueFieldId":"delivery_plan_date","keyFieldIds":null});cont.addElement(ctrl);var ctrl=new Edit(id+"_main_doc_id",{"visible":false,"name":"main_doc_id","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"main_doc_id","keyFieldIds":null},{"valueFieldId":"main_doc_id","keyFieldIds":null});cont.addElement(ctrl);this.m_DelivPeriodCtrl=new DeliveryPeriodEditObject("deliv_period",id+"_deliv_period",false,3);this.m_DelivPeriodCtrl.setRequired(true);this.bindControl(this.m_DelivPeriodCtrl,{"modelId":model_id,"valueFieldId":"deliv_period_descr","keyFieldIds":["deliv_period_id"]},{"valueFieldId":null,"keyFieldIds":["deliv_period_id"]});cont.addElement(this.m_DelivPeriodCtrl);this.m_delivCostOptCtrl=new DelivCostOptEdit({"fieldId":"deliv_cost_opt_id","controlId":id+"_deliv_cost_opt","inLine":false,"options":{"events":{"change":function(){self.calcVehicleCount();}}}});this.bindControl(this.m_delivCostOptCtrl,{"modelId":model_id,"valueFieldId":null,"keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":["deliv_cost_opt_id"]});cont.addElement(this.m_delivCostOptCtrl);this.m_delivVehicleCntCtrl=new EditNum(id+"_deliv_vehicle_count",{"labelCaption":"Кол-во автомоб.:","name":"deliv_vehicle_count","minValue":1,"maxValue":1,"tableLayout":false,"buttonClear":false,"attrs":{"maxlength":5,"size":5,"required":"required"}});this.bindControl(this.m_delivVehicleCntCtrl,{"modelId":model_id,"valueFieldId":null,"keyFieldIds":null},{"valueFieldId":"deliv_vehicle_count","keyFieldIds":null});cont.addElement(this.m_delivVehicleCntCtrl);var ctrl_edit=new Control(id+"_deliv_total_edit","div",{"name":"deliv_total_edit","tableLayout":false,"visible":false,"value":"false"});this.bindControl(ctrl_edit,{"modelId":model_id,"valueFieldId":"deliv_total_edit","keyFieldIds":null},{"valueFieldId":"deliv_total_edit","keyFieldIds":null});cont.addElement(ctrl_edit);this.m_delivCost=new EditMoneyEditable(id+"_deliv_total",{"labelCaption":"Стоимость доставки","name":"deliv_total","tableLayout":false,"editAllowedFieldCtrl":ctrl_edit});this.bindControl(this.m_delivCost,{"modelId":model_id,"valueFieldId":"deliv_total","keyFieldIds":null},{"valueFieldId":"deliv_total","keyFieldIds":null});cont.addElement(this.m_delivCost);cont.addElement(new Control("deliv_total_l","span",{"value":"руб."}));this.m_delivAddToCostCtrl=new EditCheckBox(id+"_deliv_add_cost_to_product",{"labelCaption":"Включать стоимость доставки пропорцилнально в стоимость продукции","name":"deliv_add_cost_to_product","enabled":false,"buttonClear":false,"labelAlign":"left","tableLayout":false,"attrs":{},});this.bindControl(this.m_delivAddToCostCtrl,{"modelId":model_id,"valueFieldId":"deliv_add_cost_to_product","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});cont.addElement(this.m_delivAddToCostCtrl);this.addControl(cont);var cont=new ControlContainer("table_panel","div",{"className":"panel"});this.m_productDetails=new DOCOrderDOCTDivisProductList_View("DOCOrderDOCTDivisProductList_View",{"connect":new ServConnector(HOST_NAME),"errorControl":this.getErrorControl(),"afterRefresh":function(){self.refreshProdTotals();}});this.addDetailControl(this.m_productDetails,cont);this.m_productDetails.getGridControl().setViewId(this.m_viewId);var sub_cont=new ControlContainer(id+"_prod_tot_l","div",{"className":"panel_left"});sub_cont.addElement(new Control("prod_tot_vl1","span",{"value":"Транспортировочный объем: "}));this.m_totVol=new Control("prod_tot_vol","span");sub_cont.addElement(this.m_totVol);sub_cont.addElement(new Control("prod_tot_vl2","span",{"value":" м3"}));sub_cont.addElement(new Control("prod_tot_w","span",{"value":", масса груза: "}));this.m_totWt=new Control("prod_tot_wt","span");sub_cont.addElement(this.m_totWt);sub_cont.addElement(new Control("prod_tot_wt2","span",{"value":" т."}));cont.addElement(sub_cont);var sub_cont=new ControlContainer(id+"_prod_tot_r","div",{"className":"panel_right"});sub_cont.addElement(new Control("prod_tot_r1","span",{"value":"Итого:"}));this.m_totSum=new Control("prod_tot_r2","span");sub_cont.addElement(this.m_totSum);sub_cont.addElement(new Control("prod_tot_r3","span",{"value":" руб."}));cont.addElement(sub_cont);var sub_cont=new ControlContainer(id+"_prod_totp_r","div",{"className":"panel_right"});sub_cont.addElement(new Control("prod_totp_r1","span",{"value":"Итого упаковка:"}));this.m_totSumPack=new Control("prod_totp_r2","span");sub_cont.addElement(this.m_totSumPack);sub_cont.addElement(new Control("prod_totp_r3","span",{"value":" руб."}));cont.addElement(sub_cont);var sub_cont=new ControlContainer(id+"_prod_tot_r2","div",{"className":"panel_right"});sub_cont.addElement(new Control("prod_tot_r4","span",{"value":"Итого с доставкой и упак.:"}));this.m_totTotal=new Control("prod_tot_r5","span");sub_cont.addElement(this.m_totTotal);sub_cont.addElement(new Control("prod_tot_r6","span",{"value":" руб."}));cont.addElement(sub_cont);this.addControl(cont);var cont=new ControlContainer("footer_panel","div",{"className":"panel"});var ctrl=new EditString(id+"_sales_manager_comment",{"labelCaption":"Комментарий внутр.:","name":"sales_manager_comment","buttonClear":false,"tableLayout":false,"attrs":{"size":"150"}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"sales_manager_comment","keyFieldIds":null},{"valueFieldId":"sales_manager_comment","keyFieldIds":null});cont.addElement(ctrl);this.addControl(cont);}
extend(DOCOrderDivisDialog_View,ViewDialog);DOCOrderDivisDialog_View.prototype.m_detailContainer;DOCOrderDivisDialog_View.prototype.addDetailControl=function(detailControl,panel){if(this.m_details==undefined){var detail_row=new ControlContainer(this.getId()+"_det_row","tr");var td=new ControlContainer(this.getId()+"_det_row","td",{"attrs":{"colspan":"2"}});detail_row.addElement(td);this.m_details=new ControlContainer(this.getId()+"_details","div",{"attrs":{"class":"tabber"}});td.addElement(this.m_details);panel.addElement(td);}
this.m_details.addElement(detailControl);}
DOCOrderDivisDialog_View.prototype.getDetailControl=function(controlId){return this.m_details.getElementById(controlId);}
DOCOrderDivisDialog_View.prototype.readData=function(async,isCopy){var contr=this.getReadController();contr.getPublicMethodById("get_divis").setParamValue("view_id",this.m_viewId);DOCOrderDivisDialog_View.superclass.readData.call(this,false,isCopy);}
DOCOrderDivisDialog_View.prototype.onClickSave=function(){var cmd_insert=this.getIsNew();if(cmd_insert){var contr=this.getWriteController();var meth_id=this.getWriteMethodId();var pm=contr.getPublicMethodById(meth_id);if(pm.paramExists(contr.PARAM_RET_ID)){pm.setParamValue(contr.PARAM_RET_ID,1);}}
this.writeData();this.readData(false);}
DOCOrderDivisDialog_View.prototype.refreshProdTotals=function(){var gr=this.m_productDetails.getGridControl();var rows=gr.getBody().getNode().getElementsByTagName("tr");var cells;var tot_sum=0;var tot_sum_pack=0;var tot_vol=0;var tot_wt=0;for(var ri=0;ri<rows.length;ri++){if(!cells){cells={};for(var ci=0;ci<rows[ri].cells.length;ci++){var id=DOMHandler.getAttr(rows[ri].cells[ci],"field_id");cells[id]=ci;}}
tot_sum+=toFloat(rows[ri].cells[cells.total].textContent);tot_sum_pack+=toFloat(rows[ri].cells[cells.total_pack].textContent);tot_vol+=toFloat(rows[ri].cells[cells.volume].textContent);tot_wt+=toFloat(rows[ri].cells[cells.weight].textContent);}
this.m_totVol.setValue(tot_vol.toFixed(3));this.m_totWt.setValue(tot_wt.toFixed(3));this.m_totSumPack.setValue(tot_sum_pack.toFixed(2));this.m_totSum.setValue(tot_sum.toFixed(2));if(this.m_delivTotal&&this.m_delivCost.m_editAllowedFieldCtrl.getValue()=="false"){var sm=Math.round(this.m_delivTotal/this.m_delivVhCount*100)/100;this.m_delivCost.setValue(sm.toFixed(2));}
if(this.m_delivAddToCostCtrl.getValue()=="false"){tot_sum+=toFloat(this.m_delivCost.getValue());}
tot_sum+=tot_sum_pack;this.m_totTotal.setValue(tot_sum.toFixed(2));this.calcVehicleCount();}
DOCOrderDivisDialog_View.prototype.calcVehicleCount=function(){var ind=this.m_delivCostOptCtrl.m_node.selectedIndex;var sel_n=this.m_delivCostOptCtrl.m_node.options[ind];var v_max_vol=parseFloat(DOMHandler.getAttr(sel_n,"volume_m"));var v_max_wt=parseFloat(DOMHandler.getAttr(sel_n,"weight_t"));var vol=parseFloat(this.m_totVol.getValue());var wt=parseFloat(this.m_totWt.getValue());var vol_cnt=Math.ceil(vol/v_max_vol);var wt_cnt=Math.ceil(wt/v_max_wt);var cnt=(vol_cnt>wt_cnt)?vol_cnt:wt_cnt;cnt=toInt(cnt);this.m_delivVehicleCntCtrl.setValue(cnt);if(cnt>1){DOMHandler.addClass(this.m_delivVehicleCntCtrl.m_node,"veh_cnt_warn");}
else{DOMHandler.removeClass(this.m_delivVehicleCntCtrl.m_node,"veh_cnt_warn");}}
DOCOrderDivisDialog_View.prototype.onGetData=function(resp){DOCOrderDivisDialog_View.superclass.onGetData.call(this,resp,this.m_isCopy);var m=resp.getModelById("DOCOrderDivisDialog_Model",true);if(m.getNextRow()){this.m_delivTotal=toFloat(m.getFieldValue("deliv_total"));this.m_delivVhCount=toFloat(m.getFieldValue("deliv_vehicle_count"));this.m_delivPrice=toFloat(m.getFieldValue("deliv_price"));if(this.m_delivTotal==0){this.m_delivCost.setVisible(false);this.m_delivAddToCostCtrl.setVisible(false);}
this.m_delivCost.setMaxValue(this.m_delivTotal);var state=m.getFieldValue("state");var allowed_states=["waiting_for_us","waiting_for_payment"];if(allowed_states.indexOf(state)<0){var self=this;window.showTempError("Документ в неверном статусе!",function(){self.setEnabled(false);if(self.m_ctrlCancel){self.m_ctrlCancel.setEnabled(true);}},ERR_MSG_WAIT_MS);}
var ts=(m.getFieldValue("deliv_type")=="by_supplier");this.m_delivCostOptCtrl.setRequired(ts);this.m_delivCostOptCtrl.setEnabled(ts);}}
DOCOrderDivisDialog_View.prototype.writeData=function(){var contr=this.getWriteController();if(!contr)return;contr.getPublicMethodById("divide").setParamValue("view_id",this.m_viewId);DOCOrderDivisDialog_View.superclass.writeData.call(this);} 
function DOCOrderCustSurveyDialog_View(id,options){options=options||{};options.tagName="div";options.readMethodId="get_cust_survey";DOCOrderCustSurveyDialog_View.superclass.constructor.call(this,id,options);var self=this;this.m_beforeOpen=function(contr,isInsert){var doc_id=0;self.m_questions.getGridControl().setViewId(self.m_viewId);if(!isInsert){doc_id=self.getDataControl(self.getId()+"_id").control.getValue();}
contr.run("before_open",{async:false,params:{"doc_id":doc_id,"view_id":self.m_viewId}});self.m_beforeOpenCalled=true;}
var model_id="DOCOrderCustSurveyDialog_Model";this.m_viewId=hex_md5(uuid());var cont=new ControlContainer("survey_header","div",{"className":"panel"})
var ctrl=new Edit(id+"_id",{"visible":false,"name":"id","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});cont.addElement(ctrl);var ctrl=new EditNum(id+"_number",{"enabled":false,"name":"number","labelCaption":"№ заявки:","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"number","keyFieldIds":null},{});cont.addElement(ctrl);var ctrl=new EditDateTime(id+"_cust_surv_date_time",{"value":DateHandler.dateToStr(null,"dd/mm/y hh:mmin"),"editMask":"$d$d/$d$d/$d$d $d$d:$d$d","ButtonKalendar":"dd/mm/y hh:mmin","labelCaption":"Дата опроса:","name":"cust_surv_date_time","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"cust_surv_date_time_descr","keyFieldIds":null},{"valueFieldId":"cust_surv_date_time","keyFieldIds":null});cont.addElement(ctrl);var ctrl=new Edit(id+"_client_descr",{"enabled":false,"name":"client_descr","labelCaption":"Заказчик:","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"client_descr","keyFieldIds":null},{});cont.addElement(ctrl);var ctrl=new Edit(id+"_client_user_descr",{"enabled":false,"name":"client_user_descr","labelCaption":"Ответственный:","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"client_user_descr","keyFieldIds":null},{});cont.addElement(ctrl);var ctrl=new Edit(id+"_client_user_cel_phone",{"enabled":false,"name":"client_user_cel_phone","labelCaption":"Телефон:","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"client_user_cel_phone","keyFieldIds":null},{});cont.addElement(ctrl);var ctrl=new Edit(id+"_deliv_responsable",{"enabled":false,"name":"deliv_responsable","labelCaption":"Ответственный за прием товара:","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"deliv_responsable","keyFieldIds":null},{});cont.addElement(ctrl);var ctrl=new Edit(id+"_deliv_responsable_tel",{"enabled":false,"name":"deliv_responsable_tel","labelCaption":"Телефон:","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"deliv_responsable_tel","keyFieldIds":null},{});cont.addElement(ctrl);this.addControl(cont);var cont=new ControlContainer("survey_table_panel","div",{"className":"panel"});cont.addElement(new Button(id+"_fill_surveys",{"caption":"Заполнить","attrs":{"title":"заполнить вопросами по умолчанию"},"onClick":function(){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));var m=contr.getPublicMethodById("fill_cust_surv");m.setParamValue("view_id",self.m_viewId);contr.run("fill_cust_surv",{"func":function(){self.m_questions.getGridControl().onRefresh();}});}}));this.m_questions=new DOCOrderDOCTCustSurveyList_View("DOCOrderDOCTCustSurveyList_View",{"connect":new ServConnector(HOST_NAME),"errorControl":this.getErrorControl()});this.addDetailControl(this.m_questions,cont);this.addControl(cont);var cont=new ControlContainer("survey_footer_panel","div",{"className":"panel","attrs":{"style":"padding-bottom:100px;"}});var ctrl=new EditText(id+"_cust_surv_comment",{"name":"cust_surv_comment","tableLayout":false,"labelCaption":"Комментарий:","editContClassName":"input-group "+get_bs_col()+"8","labelClassName":"control-label "+get_bs_col()+"2","rows":"5"});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"cust_surv_comment","keyFieldIds":null},{"valueFieldId":"cust_surv_comment","keyFieldIds":null});cont.addElement(ctrl);this.addControl(cont);}
extend(DOCOrderCustSurveyDialog_View,ViewDialog);DOCOrderCustSurveyDialog_View.prototype.m_detailContainer;DOCOrderCustSurveyDialog_View.prototype.addDetailControl=function(detailControl,panel){if(this.m_details==undefined){var detail_row=new ControlContainer(this.getId()+"_det_row","tr");var td=new ControlContainer(this.getId()+"_det_row","td",{"attrs":{"colspan":"2"}});detail_row.addElement(td);this.m_details=new ControlContainer(this.getId()+"_details","div",{"attrs":{"class":"tabber"}});td.addElement(this.m_details);panel.addElement(td);}
this.m_details.addElement(detailControl);}
DOCOrderCustSurveyDialog_View.prototype.getDetailControl=function(controlId){return this.m_details.getElementById(controlId);}
DOCOrderCustSurveyDialog_View.prototype.readData=function(async,isCopy){DOCOrderCustSurveyDialog_View.superclass.readData.call(this,false,isCopy);}
DOCOrderCustSurveyDialog_View.prototype.onClickSave=function(){var cmd_insert=this.getIsNew();if(cmd_insert){var contr=this.getWriteController();var meth_id=this.getWriteMethodId();var pm=contr.getPublicMethodById(meth_id);if(pm.paramExists(contr.PARAM_RET_ID)){pm.setParamValue(contr.PARAM_RET_ID,1);}}
this.writeData();this.readData(false);}
DOCOrderCustSurveyDialog_View.prototype.setMethodParams=function(pm,checkRes){DOCOrderCustSurveyDialog_View.superclass.setMethodParams.call(this,pm,checkRes);checkRes.modif=true;}
DOCOrderCustSurveyDialog_View.prototype.getFormWidth=function(){return"1200";}
DOCOrderCustSurveyDialog_View.prototype.getFormHeight=function(){return"1000";}
DOCOrderCustSurveyDialog_View.prototype.writeData=function(){var contr=this.getWriteController();if(!contr)return;contr.getPublicMethodById(this.getWriteMethodId()).setParamValue("view_id",this.m_viewId);DOCOrderCustSurveyDialog_View.superclass.writeData.call(this);} 
function DOCOrderShipmentDialog_View(id,options){options=options||{};options.tagName="div";options.readMethodId="get_shipment";options.writeMethodId="set_shipped";options.customWriteMethod=true;var self=this;this.m_beforeOpen=function(contr,isInsert){var doc_id=0;self.m_items.getGridControl().setViewId(self.m_viewId);self.m_batches.getGridControl().setViewId(self.m_viewId);if(!isInsert){doc_id=self.getDataControl(self.getId()+"_id").control.getValue();}
contr.run("before_open",{async:false,params:{"doc_id":doc_id,"view_id":self.m_viewId}});self.m_beforeOpenCalled=true;}
DOCOrderShipmentDialog_View.superclass.constructor.call(this,id,options);var model_id="DOCOrderShipmentDialog_Model";this.m_viewId=hex_md5(uuid());var cont=new ControlContainer(id+"_panel","div",{"className":"row"});this.m_idCtrl=new Edit(id+"_id",{"visible":false,"name":"id","tableLayout":false});this.bindControl(this.m_idCtrl,{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});cont.addElement(this.m_idCtrl);var ctrl=new EditNum(id+"_number",{"enabled":false,"editContClassName":"input-group "+get_bs_col()+"2","name":"number","labelCaption":"№ заявки:","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"number","keyFieldIds":null},{});cont.addElement(ctrl);this.m_clientCtrl=new Edit(id+"_client_descr",{"enabled":false,"editContClassName":"input-group "+get_bs_col()+"4","name":"client_descr","labelCaption":"Заказчик:","tableLayout":false});this.bindControl(this.m_clientCtrl,{"modelId":model_id,"valueFieldId":"client_descr","keyFieldIds":null},{});cont.addElement(this.m_clientCtrl);this.m_delivVehicleCountCtrl=new EditNum(id+"_deliv_vehicle_count",{"visible":false,"editContClassName":"input-group "+get_bs_col()+"4","name":"deliv_vehicle_count","labelCaption":"Кол-во автомоб.:","tableLayout":false,"alwaysUpdate":true});this.bindControl(this.m_delivVehicleCountCtrl,{"modelId":model_id,"valueFieldId":"deliv_vehicle_count","keyFieldIds":null},{"modelId":model_id,"valueFieldId":"deliv_vehicle_count","keyFieldIds":null});cont.addElement(this.m_delivVehicleCountCtrl);this.m_vehicleCtrl=new VehicleEditObject({"fieldId":"vehicle_id","controlId":"vehicle","inLine":false,"options":{"visible":false,"attrs":{"fkey_vehicle_id":"vehicle_id"},"alwaysUpdate":true}});this.bindControl(this.m_vehicleCtrl,{"modelId":model_id,"valueFieldId":"vehicle_descr","keyFieldIds":["vehicle_id"]},{"modelId":model_id,"valueFieldId":null,"keyFieldIds":["vehicle_id"]});cont.addElement(this.m_vehicleCtrl);this.m_clientDestCtrl=new ClientDestinationEdit2(id+"_deliv_destination",{"fieldId":"deliv_destination_id","winObj":options.winObj,"mainView":this,"options":{"visible":false,"attrs":{},"onSelected":function(){if(!parseInt(self.m_clientDestCtrl.getAttr("fkey_deliv_destination_id"))){self.m_clientDestCtrl.setEnabled(false);var contr=new ClientDestination_Controller(new ServConnector(HOST_NAME));contr.run("insert",{"params":{"error_on_no_road":"1","client_id":self.m_clientCtrl.getAttr("fkey_client_id"),"value":self.m_clientDestCtrl.getValue()},"func":function(resp){if(resp.modelExists("InsertedId_Model")){var m=resp.getModelById("InsertedId_Model",true);if(m.getNextRow()){self.m_clientDestCtrl.setAttr("fkey_deliv_destination_id",m.getFieldValue("id"));DOMHandler.removeClass(self.m_clientDestCtrl.m_node,"error");}}
self.m_clientDestCtrl.setEnabled(true);},"err":function(resp,errCode,errStr){self.m_clientDestCtrl.setEnabled(true);window.showTempError(errStr,null,ERR_MSG_WAIT_MS);}});}
else{}}}});this.bindControl(this.m_clientDestCtrl,{"modelId":model_id,"valueFieldId":"deliv_destination_descr","keyFieldIds":["deliv_destination_id"]},{"valueFieldId":null,"keyFieldIds":["deliv_destination_id"]});cont.addElement(this.m_clientDestCtrl);this.m_destinationToTTN=new EditCheckBox(id+"_destination_to_ttn",{"labelCaption":"Переносить адрес доставки в ТТН","name":"destination_to_ttn","buttonClear":false,"labelAlign":"left","tableLayout":false,"attrs":{},"visible":false,"alwaysUpdate":true});this.bindControl(this.m_destinationToTTN,{"modelId":model_id,"valueFieldId":"destination_to_ttn","keyFieldIds":null},{"valueFieldId":"destination_to_ttn","keyFieldIds":null});cont.addElement(this.m_destinationToTTN);this.addElement(cont);this.m_details=new ControlContainer(uuid(),"div",{"className":"row"});this.m_items=new DOCOrderDOCTShipmentList_View("DOCOrderDOCTShipmentList_View",{"connect":new ServConnector(HOST_NAME),"errorControl":this.getErrorControl(),"winObj":options.winObj});this.m_details.addElement(this.m_items);var com_p_id=uuid();var cont_batch=new ControlContainer(com_p_id,"div",{"className":"collapse"});this.m_batches=new DOCOrderDOCTProdBatchList_View("DOCOrderDOCTProdBatchList_View",{"connect":new ServConnector(HOST_NAME),"errorControl":this.getErrorControl(),"winObj":options.winObj,"getOrderId":function(){return self.getOrderId();}});cont_batch.addElement(this.m_batches);this.m_details.addElement(new ButtonToggle(uuid(),{"caption":"Партии продукции","dataTarget":com_p_id,"expanded":true,"attrs":{"title":"показать/скрыть партии"}}));this.m_details.addElement(cont_batch);this.addElement(this.m_details);}
extend(DOCOrderShipmentDialog_View,ViewDialog);DOCOrderShipmentDialog_View.prototype.m_detailContainer;DOCOrderShipmentDialog_View.prototype.getDetailControl=function(controlId){return this.m_details.getElementById(controlId);}
DOCOrderShipmentDialog_View.prototype.readData=function(async,isCopy){DOCOrderShipmentDialog_View.superclass.readData.call(this,false,isCopy);}
DOCOrderShipmentDialog_View.prototype.onClickSave=function(){var cmd_insert=this.getIsNew();if(cmd_insert){var contr=this.getWriteController();var meth_id=this.getWriteMethodId();var pm=contr.getPublicMethodById(meth_id);if(pm.paramExists(contr.PARAM_RET_ID)){pm.setParamValue(contr.PARAM_RET_ID,1);}}
this.writeData();this.readData(false);}
DOCOrderShipmentDialog_View.prototype.writeData=function(){var contr=this.getWriteController();if(!contr)return;contr.getPublicMethodById(this.getWriteMethodId()).setParamValue("view_id",this.m_viewId);DOCOrderShipmentDialog_View.superclass.writeData.call(this);}
DOCOrderShipmentDialog_View.prototype.setMethodParams=function(pm,checkRes){var contr=this.getWriteController();var m=contr.getPublicMethodById("set_shipped");m.setParamValue("doc_id",this.m_idCtrl.getValue());DOCOrderShipmentDialog_View.superclass.setMethodParams.call(this,pm,checkRes);checkRes.modif=true;}
DOCOrderShipmentDialog_View.prototype.onGetData=function(resp){DOCOrderShipmentDialog_View.superclass.onGetData.call(this,resp);var m=resp.getModelById("DOCOrderShipmentDialog_Model",true);if(m.getNextRow()){this.m_payType=m.getFieldValue("pay_type");if(m.getFieldValue("deliv_type")=="by_supplier"){this.m_delivVehicleCountCtrl.setVisible(true);this.m_vehicleCtrl.setVisible(true);this.m_destinationToTTN.setVisible(true);this.m_clientDestCtrl.setVisible(true);this.m_clientDestCtrl.setClientId(m.getFieldValue("client_id"));}}}
DOCOrderShipmentDialog_View.prototype.onWriteOk=function(resp){DOCOrderShipmentDialog_View.superclass.onWriteOk.call(this,resp);var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));if(this.m_payType=="cash"){contr.run("get_print_check",{"xml":false,"params":{"doc_id":this.m_idCtrl.getValue(),"v":"DOCOrderCheck"},"func":function(resp){WindowPrint.show({"content":resp,"print":true});},"cont":this});}
else{top.location.href=HOST_NAME+"index.php?"+
contr.getQueryString(contr.getPublicMethodById("get_ship_docs"))+"&doc_id="+this.m_idCtrl.getValue();}}
DOCOrderShipmentDialog_View.prototype.getFormWidth=function(){return"1000";}
DOCOrderShipmentDialog_View.prototype.getOrderId=function(){return this.getDataControl(this.getId()+"_id").control.getValue();} 
function DOCOrderDOCTProductList_View(id,options){options=options||{};DOCOrderDOCTProductList_View.superclass.constructor.call(this,id,options);var head=new GridHead();var row=new GridRowDOCT(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_product_descr",{"value":"Продукция","readBind":{"valueFieldId":"product_descr"}}));row.addElement(new GridDbHeadCellBool(id+"_col_pack_exists",{"value":"Упак.","readBind":{"valueFieldId":"pack_exists"}}));row.addElement(new GridDbHeadCell(id+"_col_measure_unit_descr",{"value":"Ед-ца","readBind":{"valueFieldId":"measure_unit_descr"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_quant",{"value":"Кол-во","readBind":{"valueFieldId":"quant"},"colAttrs":{"align":"right"}}));row.addElement(new GridDbHeadCell(id+"_col_price_descr",{"value":"Цена","readBind":{"valueFieldId":"price_descr"},"colAttrs":{"align":"right"}}));row.addElement(new GridDbHeadCell(id+"_col_total_descr",{"value":"Сумма","readBind":{"valueFieldId":"total_descr"},"colAttrs":{"align":"right"}}));row.addElement(new GridDbHeadCell(id+"_col_total",{"readBind":{"valueFieldId":"total"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_total_pack",{"readBind":{"valueFieldId":"total_pack"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_volume",{"readBind":{"valueFieldId":"volume"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_weight",{"readBind":{"valueFieldId":"weight"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_oper",{"readBind":{"valueFieldId":"oper"},"fieldValueToRowClass":true,"visible":false}));head.addElement(row);var grid=new GridDbDOCT(id+"_grid",{"head":head,"body":new GridBody(),"controller":new DOCOrderDOCTProduct_Controller(new ServConnector(HOST_NAME)),"readModelId":"DOCOrderDOCTProductList_Model","editViewClass":DOCOrderDOCTProductDialog_View,"editInline":false,"pagination":null,"commandPanel":new GridCommands(),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"editViewParams":{"warehouseCtrl":options.warehouseCtrl},"editWinClass":WIN_CLASS,"afterRefresh":options.afterRefresh,"onModified":options.onModified,"onDelete":options.onDelete});grid.onGetData=function(resp){GridDbDOCT.superclass.onGetData.call(this,resp);if(options.afterRefresh)options.afterRefresh();}
this.setGridControl(grid);}
extend(DOCOrderDOCTProductList_View,ViewDocumentDetail);DOCOrderDOCTProductList_View.prototype.setWarehouseId=function(id){this.getGridControl().setEditViewParam("warehouseId",id);}
DOCOrderDOCTProductList_View.prototype.setClientId=function(id){this.getGridControl().setEditViewParam("clientId",id);}
DOCOrderDOCTProductList_View.prototype.setToThirdParty=function(val){this.getGridControl().setEditViewParam("toThirdParty",val);}
DOCOrderDOCTProductList_View.prototype.setDelivAddToCost=function(val){this.getGridControl().setEditViewParam("delivAddToCost",val);}
DOCOrderDOCTProductList_View.prototype.setDelivTotal=function(val){this.getGridControl().setEditViewParam("delivTotal",val);}
DOCOrderDOCTProductList_View.prototype.getLineCount=function(){var b_n=this.getGridControl().getBody().m_node;if(b_n){return b_n.getElementsByTagName("tr").length;}}
DOCOrderDOCTProductList_View.prototype.onRefresh=function(callBack){this.getGridControl().onRefresh(callBack);} 
function DOCOrderDOCTDivisProductList_View(id,options){options=options||{};DOCOrderDOCTDivisProductList_View.superclass.constructor.call(this,id,options);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_view_id",{"readBind":{"valueFieldId":"view_id"},"keyCol":true,"visible":false,"attrs":{"rowspan":2}}));row.addElement(new GridDbHeadCell(id+"_col_line_number",{"value":"№","readBind":{"valueFieldId":"line_number"},"keyCol":true,"colAttrs":{"align":"center"},"attrs":{"rowspan":2}}));var row2=new GridRow(id+"_row2");var col_quant=new GridDbHeadCell(id+"_col_quant",{"value":"Кол-во","readBind":{"valueFieldId":"quant"},"colAttrs":{"align":"right"}});var col_mu=new GridDbHeadCell(id+"_col_measure_unit_descr",{"value":"Наим.","readBind":{"valueFieldId":"measure_unit_descr"},"colAttrs":{"align":"center"}});var col_price=new GridDbHeadCell(id+"_col_price_descr",{"value":"Цена","readBind":{"valueFieldId":"price_descr"},"colAttrs":{"align":"right"}});var col_doc_mu=new GridDbHeadCell(id+"_col_doc_measure_unit_descr",{"value":"Наим.","readBind":{"valueFieldId":"doc_measure_unit_descr"},"colAttrs":{"align":"center"}});var col_doc_quant=new GridDbHeadCell(id+"_col_doc_quant",{"value":"Кол-во","readBind":{"valueFieldId":"doc_quant"},"colAttrs":{"align":"right"}});row.addElement(new GridDbHeadCell(id+"_col_product_descr",{"value":"Продукция","readBind":{"valueFieldId":"product_descr"},"attrs":{"rowspan":"2"}}));row.addElement(new GridDbHeadCellBool(id+"_col_pack_exists",{"value":"Упак.","readBind":{"valueFieldId":"pack_exists"},"attrs":{"rowspan":"2"}}));row.addElement(new GridDbHeadCell("_col_base",{"value":"Базовая единица","attrs":{"colspan":3},"colSpanArray":[col_mu,col_quant,col_price]}));row.addElement(new GridDbHeadCell("_col_doc",{"value":"Единица док-та","attrs":{"colspan":2},"colSpanArray":[col_doc_mu,col_doc_quant]}));row.addElement(new GridDbHeadCell(id+"_col_total_descr",{"value":"Сумма","readBind":{"valueFieldId":"total_descr"},"colAttrs":{"align":"right"},"attrs":{"rowspan":"2"}}));row.addElement(new GridDbHeadCell(id+"_col_total",{"readBind":{"valueFieldId":"total"},"visible":false,"attrs":{"rowspan":"2"}}));row.addElement(new GridDbHeadCell(id+"_col_total_pack",{"readBind":{"valueFieldId":"total_pack"},"visible":false,"attrs":{"rowspan":"2"}}));row.addElement(new GridDbHeadCell(id+"_col_volume",{"readBind":{"valueFieldId":"volume"},"visible":false,"attrs":{"rowspan":"2"}}));row.addElement(new GridDbHeadCell(id+"_col_weight",{"readBind":{"valueFieldId":"weight"},"visible":false,"attrs":{"rowspan":"2"}}));row.addElement(new GridDbHeadCell(id+"_col_oper",{"readBind":{"valueFieldId":"oper"},"fieldValueToRowClass":true,"visible":false,"attrs":{"rowspan":"2"}}));row2.addElement(col_mu);row2.addElement(col_quant);row2.addElement(col_price);row2.addElement(col_doc_mu);row2.addElement(col_doc_quant);head.addElement(row);head.addElement(row2);var grid=new GridDbDOCT(id+"_grid",{"head":head,"body":new GridBody(),"controller":new DOCOrderDOCTProduct_Controller(new ServConnector(HOST_NAME)),"readModelId":"DOCOrderDOCTProductList_Model","editViewClass":DOCOrderDOCTDivisProductInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"noInsert":true,"noCopy":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"editViewParams":{"delivTotal":0},"editWinClass":null,"afterRefresh":options.afterRefresh});grid.onGetData=function(resp){GridDbDOCT.superclass.onGetData.call(this,resp);options.afterRefresh();}
this.setGridControl(grid);}
extend(DOCOrderDOCTDivisProductList_View,ViewDocumentDetail);DOCOrderDOCTDivisProductList_View.prototype.getLineCount=function(){var b_n=this.getGridControl().getBody().m_node;if(b_n){return b_n.getElementsByTagName("tr").length;}}
DOCOrderDOCTDivisProductList_View.prototype.onRefresh=function(){this.getGridControl().onRefresh();} 
function DOCOrderDOCTDivisProductInline_View(id,options){options=options||{};var model_id="DOCOrderDOCTProductDialog_Model";this.m_measureCheckText="";options.readMethodId="get_object_for_divis";options.readModelId=model_id;DOCOrderDOCTDivisProductInline_View.superclass.constructor.call(this,id,options);var self=this;this.addDataControl(new Control(id+"_product_id","span",{"name":"product_id","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"product_id","keyFieldIds":null},{"valueFieldId":"product_id","keyFieldIds":null});this.addDataControl(new Control(id+"_measure_unit_id","span",{"name":"measure_unit_id","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"measure_unit_id","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new Control(id+"_measure_unit_is_int","span",{"name":"measure_unit_is_int","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"measure_unit_is_int","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new Control(id+"_base_measure_unit_id","span",{"name":"base_measure_unit_id","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"base_measure_unit_id","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new Control(id+"_base_measure_unit_is_int","span",{"name":"base_measure_unit_is_int","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"base_measure_unit_is_int","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new Control(id+"_mes_length","span",{"name":"mes_length","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"mes_length","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new Control(id+"_mes_width","span",{"name":"mes_width","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"mes_width","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new Control(id+"_mes_height","span",{"name":"mes_height","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"mes_height","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new Edit(id+"_product_descr",{"name":"product_descr","enabled":false,"tableLayout":false,"attrs":{"size":"25"}}),{"modelId":model_id,"valueFieldId":"product_descr","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new Edit(id+"_pack_exists",{"name":"pack_exists","enabled":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":null,"keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new Edit(id+"_base_measure_unit_descr",{"name":"base_measure_unit_descr","tableLayout":false,"enabled":false,"attrs":{"size":"5"}}),{"modelId":model_id,"valueFieldId":"base_measure_unit_descr","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new EditFloat(id+"_quant_base_measure_unit",{"name":"quant_base_measure_unit","tableLayout":false,"attrs":{"size":"5"},"events":{"input":function(){self.onChangeBaseQuant();}}}),{"modelId":model_id,"valueFieldId":"quant_base_measure_unit","keyFieldIds":null},{"valueFieldId":"quant_base_measure_unit","keyFieldIds":null});this.addDataControl(new EditFloat(id+"_price",{"name":"price","tableLayout":false,"enabled":false,"attrs":{"size":"5"}}),{"modelId":model_id,"valueFieldId":"price","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new Edit(id+"_measure_unit_descr",{"name":"measure_unit_descr","tableLayout":false,"enabled":false,"attrs":{"size":"5"}}),{"modelId":model_id,"valueFieldId":"measure_unit_descr","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new EditFloat(id+"_quant",{"name":"quant","tableLayout":false,"attrs":{"size":"5"},"events":{"input":function(){self.onChangeDocQuant();}}}),{"modelId":model_id,"valueFieldId":"quant","keyFieldIds":null},{"valueFieldId":"quant","keyFieldIds":null});this.addDataControl(new EditFloat(id+"_total_descr",{"name":"total_descr","tableLayout":false,"enabled":false,"attrs":{"size":"5"}}),{"modelId":model_id,"valueFieldId":"total_descr","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});}
extend(DOCOrderDOCTDivisProductInline_View,ViewInlineGridEditDOCT);DOCOrderDOCTDivisProductInline_View.prototype.onChangeQuant=function(measureUnitId,measureUnitIsIntId,getQuantConfirmedId,setQuantConfirmedId,measureUnitFromId){var pref="DOCOrderDOCTDivisProductList_View_gridEditView_";var product_id=nd(pref+"product_id").getAttribute("old_product_id");var measure_unit_id=nd(pref+measureUnitId).getAttribute("old_"+measureUnitId);var measure_unit_is_int=nd(pref+measureUnitIsIntId).getAttribute("old_"+measureUnitIsIntId);var mes_length=nd(pref+"mes_length").getAttribute("old_mes_length");var mes_width=nd(pref+"mes_width").getAttribute("old_mes_width");var mes_height=nd(pref+"mes_height").getAttribute("old_mes_height");var quant=toFloat(nd(pref+getQuantConfirmedId).value);if(quant){var self=this;var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("calc_quant",{"async":true,"params":{"product_id":product_id,"mes_length":mes_length,"mes_width":mes_width,"mes_height":mes_height,"quant":quant,"measure_unit_id":measure_unit_id,"measure_unit_id_from":measureUnitFromId},"func":function(resp){var q_node=nd(pref+setQuantConfirmedId);q_node.m_isInt=measure_unit_is_int;var m=resp.getModelById("calc_quant");m.setActive(true);if(m.getNextRow()){q_node.value=m.getFieldValue("quant");}
self.m_measureCheckText="";var m=resp.getModelById("product_measure_units_check");m.setActive(true);while(m.getNextRow()){self.m_measureCheckText+=(self.m_measureCheckText!="")?", ":"Дробные значения для единиц: ";self.m_measureCheckText+=m.getFieldValue("measure_unit_descr")+" ("+
m.getFieldValue("quant")+")";}
self.getViewControl(pref+setQuantConfirmedId).setComment(self.m_measureCheckText);}});}
else{nd(pref+setQuantConfirmedId).value="0";}}
DOCOrderDOCTDivisProductInline_View.prototype.onChangeBaseQuant=function(){this.onChangeQuant("measure_unit_id","measure_unit_is_int","quant_base_measure_unit","quant","0");}
DOCOrderDOCTDivisProductInline_View.prototype.onChangeDocQuant=function(){this.onChangeQuant("base_measure_unit_id","base_measure_unit_is_int","quant","quant_base_measure_unit",nd("DOCOrderDOCTDivisProductList_View_gridEditView_measure_unit_id").getAttribute("old_measure_unit_id"));}
DOCOrderDOCTDivisProductInline_View.prototype.setMethodParams=function(pm,checkRes){DOCOrderDOCTDivisProductInline_View.superclass.setMethodParams.call(this,pm,checkRes);var quantCtrl=this.getViewControl("DOCOrderDOCTDivisProductList_View_gridEditView_quant");var er_text=this.m_measureCheckText;try{quantCtrl.validate(quantCtrl.getValue());}
catch(e){checkRes.incorrect_vals=true;er_text+=(er_text=="")?er_text:", ";er_text+=e.message;}
if(er_text!=""){checkRes.incorrect_vals=true;quantCtrl.setComment(er_text);}}
DOCOrderDOCTDivisProductInline_View.prototype.onGetData=function(resp){DOCOrderDOCTDivisProductInline_View.superclass.onGetData.call(this,resp);var m=resp.getModelById("DOCOrderDOCTProductDialog_Model",true);if(m.getNextRow()){this.getViewControl(this.getId()+"_quant_base_measure_unit").setMaxValue(m.getFieldValue("quant_orig"));this.getViewControl(this.getId()+"_quant").setMaxValue(m.getFieldValue("doc_quant_orig"));}} 
function DOCOrderDOCTProductDialog_View(id,options){options=options||{};options.readModelId="DOCOrderDOCTProductDialog_Model";options.tagName="div";options.formCaption="Продукция заявки";DOCOrderDOCTProductDialog_View.superclass.constructor.call(this,id,options);this.m_headWarehouseCtrl=options.params.warehouseCtrl;var self=this;this.m_evOnProdChange=function(e){e=EventHandler.fixMouseEvent(e);if(e.target.selectedIndex>=0){self.onProductSelected(e.target.options[e.target.selectedIndex].value);}};this.m_evOnWHChange=function(e){e=EventHandler.fixMouseEvent(e);if(e.target.selectedIndex>=0){self.onWarehouseSelected(e.target.options[e.target.selectedIndex].value);}};var cont=new ControlContainer("product_cont","div",{"className":"row"});var ctrl=new ProductForOrderEditObject({"fieldId":"product_id","controlId":id+"_product","inLine":false});this.bindControl(ctrl,{"modelId":"DOCOrderDOCTProductDialog_Model","valueFieldId":"product_descr","keyFieldIds":["product_id"]},{"valueFieldId":null,"keyFieldIds":["product_id"]});cont.addElement(ctrl);this.m_WarehouseCtrl=new OrderWarehouseEditObject("warehouse_id",id+"_warehouse",false,options.params.warehouseId);cont.addElement(this.m_WarehouseCtrl);this.addControl(cont);}
extend(DOCOrderDOCTProductDialog_View,ViewDialogGridEditDOCT);DOCOrderDOCTProductDialog_View.prototype.onProductSelected=function(productId){var old_wh_id=this.m_WarehouseCtrl.getFieldValue();this.m_WarehouseCtrl.setProductId(productId);this.m_WarehouseCtrl.onRefresh();var wh_f=false;for(var wh_id in this.m_WarehouseCtrl.m_elements){if(this.m_WarehouseCtrl.m_elements[wh_id].getOptionId()==old_wh_id){wh_f=true;break;}}
if(!wh_f){this.m_WarehouseCtrl.setByIndex(1);}
this.setWHouseWarn();this.m_params.warehouseId=this.m_WarehouseCtrl.getFieldValue();if(this.m_prodAttrCont){this.m_prodAttrCont.removeDOM();}
if(productId!="undefined"){var self=this;var contr=new Product_Controller(new ServConnector(HOST_NAME));contr.run("get_object",{"async":false,"params":{"id":productId},"func":function(resp){var model=resp.getModelById("ProductDialog_Model");model.setActive(true);if(model.getNextRow()){self.onGetProductAttrs(model);}},"errControl":this.getErrorControl()});}}
DOCOrderDOCTProductDialog_View.prototype.onGetProductAttrs=function(model){var model_id="DOCOrderDOCTProductDialog_Model";this.m_prodAttrCont=new ControlContainer("prod_param_cont","div",{"className":"row"});var panel_n_tag="h4";var cont=new ControlContainer(uuid(),"div",{"className":get_bs_col()+"4"});cont.addElement(new Control(uuid(),panel_n_tag,{value:"Размеры"}));var dimen_ids=["length","width","height"];var col_ind=0;var self=this;var id=this.getId();for(var ind=0;ind<dimen_ids.length;ind++){if(model.getFieldValue("mes_"+dimen_ids[ind]+"_exists")=="true"){var opts={"name":"mes_"+dimen_ids[ind],"tableLayout":false,"className":"form-control","labelCaption":model.getFieldValue("mes_"+dimen_ids[ind]+"_name")+", мм.:","minValue":model.getFieldValue("mes_"+dimen_ids[ind]+"_min_val"),"maxValue":model.getFieldValue("mes_"+dimen_ids[ind]+"_max_val"),"attrs":{"maxlength":"10","size":"5"},"events":{"input":function(){self.calcTotals();}}};var v=model.getFieldValue("mes_"+dimen_ids[ind]+"_def_val");if(v){opts.value=v;}
if(model.getFieldValue("mes_"+dimen_ids[ind]+"_fix")=="true"){opts.attrs=opts.attrs||{};opts.attrs["disabled"]="disabled";opts.attrs["value"]=model.getFieldValue("mes_"+dimen_ids[ind]+"_fix_val");}
var ctrl=new EditNum(id+"_mes_"+dimen_ids[ind],opts);this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"mes_"+dimen_ids[ind],"keyFieldIds":null},{"valueFieldId":"mes_"+dimen_ids[ind],"keyFieldIds":null});cont.addElement(ctrl);col_ind+=1;}}
this.m_prodAttrCont.addElement(cont);var cont=new ControlContainer("pack_cont","div",{"className":get_bs_col()+"4"});cont.addElement(new Control(uuid(),panel_n_tag,{"value":"Упаковка"}));var opts={"name":"pack_exists","labelCaption":model.getFieldValue("pack_name")+":","tableLayout":false,"labelAlign":"right"};this.m_packNotFree=true;if(model.getFieldValue("pack_not_free")=="false"){this.m_packNotFree=false;opts.checked="checked";opts.attrs=opts.attrs||{};opts.attrs.disabled="disabled";opts.events={"change":function(){self.evOnPackExistsChange();}};}
else{if(model.getFieldValue("pack_default")=="true"){opts.checked="checked";opts.attrs=opts.attrs||{};opts.attrs.disabled="disabled";opts.events={"change":function(){self.evOnPackExistsChange();}};}
else{opts.events={"change":function(){self.evOnPackExistsChange();self.calcTotals();}};}}
this.m_packCtrl=new EditCheckBox(id+"_pack_exists",opts);this.bindControl(this.m_packCtrl,{"modelId":model_id,"valueFieldId":"pack_exists","keyFieldIds":null},{"valueFieldId":"pack_exists","keyFieldIds":null});cont.addElement(this.m_packCtrl);if(!this.m_packNotFree){cont.addElement(new Control("","span",{"value":"Бесплатная упаковка."}));}
else{this.m_packInPriceCtrl=new EditCheckBox(id+"_pack_in_price",{"name":"pack_in_price","labelCaption":"Включать стоимость упаковки в цену:","tableLayout":false,"enabled":false,"labelAlign":"right","events":{"change":function(){self.calcTotals();}}});this.bindControl(this.m_packInPriceCtrl,{"modelId":model_id,"valueFieldId":"pack_in_price","keyFieldIds":null},{"valueFieldId":"pack_in_price","keyFieldIds":null});cont.addElement(this.m_packInPriceCtrl);}
this.m_prodAttrCont.addElement(cont);var cont=new ControlContainer("quant_cont","div",{"className":get_bs_col()+"4"});cont.addElement(new Control(uuid(),panel_n_tag,{"value":"Количество:"}));var sub_cont=new ControlContainer("quant_cont","div",{"className":"row"});this.m_quantCtrl=new DOCOrderQuantEdit(id+"_quant",{"name":"quant","tableLayout":false,"is_int":(model.getFieldValue("is_int")=="true"),"editContClassName":"input-group "+get_bs_col()+"6","attrs":{"maxlength":"19","required":"required"},"notZero":true,"events":{"input":function(){self.calcTotals();}}});this.bindControl(this.m_quantCtrl,{"modelId":model_id,"valueFieldId":"quant","keyFieldIds":null},{"valueFieldId":"quant","keyFieldIds":null});sub_cont.addElement(this.m_quantCtrl);var productId=model.getFieldValue("id");var ctrl=new ProductMeasureUnitEditObject({"fieldId":"measure_unit_id","controlId":id+"_measure_unit","inLine":true,"productId":productId,"options":{"winObj":this.m_winObj,"editContClassName":"input-group "+get_bs_col()+"6","events":{"change":function(){self.calcQuant();}}}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"measure_unit_descr","keyFieldIds":["measure_unit_id"]},{"valueFieldId":null,"keyFieldIds":["measure_unit_id"]});if(this.m_isNew){var base_measure_unit_id=model.getFieldValue("base_measure_unit_id");if(base_measure_unit_id!=undefined){ctrl.setFieldValue("id",base_measure_unit_id);ctrl.setValue(model.getFieldValue("base_measure_unit_descr"));}}
sub_cont.addElement(ctrl);cont.addElement(sub_cont);var sub_cont=new ControlContainer("total_cont","div",{className:"row"});var cl_lbl=get_bs_col()+"8";var cl_fl=get_bs_col()+"4 DOCOrderTot";var cont_quant=new ControlContainer("total_quant_cont","div",{className:"form-group"});cont_quant.addElement(new Control(uuid(),"Label",{"className":cl_lbl,"value":"Количество в базовых единицах, м3:"}))
this.m_totQuantCtrl=new Control(id+"_quant_base_measure_unit","span",{className:cl_fl});this.bindControl(this.m_totQuantCtrl,{"modelId":model_id,"valueFieldId":"quant_base_measure_unit","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});cont_quant.addElement(this.m_totQuantCtrl);sub_cont.addElement(cont_quant);var cont_vol=new ControlContainer("total_vol_cont","div",{className:"form-group"});cont_vol.addElement(new Control(uuid(),"Label",{"className":cl_lbl,"value":"Транспортировочный объем, м3:"}))
this.m_totVolCtrl=new Control(id+"_volume","span",{className:cl_fl});this.bindControl(this.m_totVolCtrl,{"modelId":model_id,"valueFieldId":"volume","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});cont_vol.addElement(this.m_totVolCtrl);sub_cont.addElement(cont_vol);var cont_w=new ControlContainer("total_w_cont","div",{className:"form-group"});cont_w.addElement(new Control(uuid(),"Label",{"className":cl_lbl,"value":"Масса, т.:"}))
this.m_totWeightCtrl=new Control(id+"_weight","span",{"className":cl_fl});this.bindControl(this.m_totWeightCtrl,{"modelId":model_id,"valueFieldId":"weight","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});cont_w.addElement(this.m_totWeightCtrl);sub_cont.addElement(cont_w);var def_money_en=false;if(SERV_VARS.ROLE_ID!="client"){def_money_en=true;this.m_priceEditCtrl=new EditCheckBox(id+"_price_edit",{"name":"price_edit","labelCaption":"Произвольная цена:","tableLayout":false,"enabled":true,"checked":def_money_en,"labelAlign":"right","events":{"change":function(){var v=(self.m_priceEditCtrl.getValue()=="true");self.m_totPriceCtrl.setEnabled(v);self.m_totSumCtrl.setEnabled(v);if(!v){self.m_priceEditted=false;self.calcTotals();}}}});this.bindControl(this.m_priceEditCtrl,{"modelId":model_id,"valueFieldId":"price_edit","keyFieldIds":null},{"valueFieldId":"price_edit","keyFieldIds":null});sub_cont.addElement(this.m_priceEditCtrl);this.m_priceRoundCtrl=new EditCheckBox(id+"_price_round",{"name":"price_round","labelCaption":"Округлять сумму","tableLayout":false,"enabled":true,"checked":def_money_en,"labelAlign":"right","events":{"change":function(){self.calcTotals();}}});this.bindControl(this.m_priceRoundCtrl,{"modelId":model_id,"valueFieldId":"price_round","keyFieldIds":null},{"valueFieldId":"price_round","keyFieldIds":null});sub_cont.addElement(this.m_priceRoundCtrl);}
this.m_totPriceCtrl=new EditMoney(id+"_price",{"labelCaption":"Цена, руб.:","name":"price","tableLayout":false,"enabled":def_money_en,"events":{"input":function(){var tot=toFloat(self.m_totPriceCtrl.getValue())*toFloat(self.m_totQuantCtrl.getValue());if(self.m_priceRoundCtrl.getValue()=="true"){tot=Math.ceil(tot);}
self.m_totSumCtrl.setValue(tot.toFixed(2));self.m_priceEditted=true;}}});this.bindControl(this.m_totPriceCtrl,{"modelId":model_id,"valueFieldId":"price_no_deliv","keyFieldIds":null},{"valueFieldId":"price_no_deliv","keyFieldIds":null});sub_cont.addElement(this.m_totPriceCtrl);this.m_totSumCtrl=new EditMoney(id+"_total",{"labelCaption":"Сумма, руб.:","enabled":def_money_en,"name":"total","tableLayout":false,"events":{"input":function(){var pr=toFloat(self.m_totSumCtrl.getValue())/toFloat(self.m_totQuantCtrl.getValue());pr=Math.round(pr*100)/100;self.m_totPriceCtrl.setValue(pr.toFixed(2));self.m_priceEditted=true;}}});this.bindControl(this.m_totSumCtrl,{"modelId":model_id,"valueFieldId":"total_no_deliv","keyFieldIds":null},{"valueFieldId":"total_no_deliv","keyFieldIds":null});sub_cont.addElement(this.m_totSumCtrl);cont.addElement(sub_cont);this.m_prodAttrCont.addElement(cont);this.m_prodAttrCont.toDOM(this.m_node);this.m_quantCtrl.getNode().focus();}
DOCOrderDOCTProductDialog_View.prototype.onWarehouseSelected=function(warehouseId){var ctrl=this.getDataControl(this.getId()+"_product").control;ctrl.setWarehouseId(warehouseId);ctrl.onRefresh();this.setWHouseWarn();this.m_params.warehouseId=warehouseId;this.calcTotals();}
DOCOrderDOCTProductDialog_View.prototype.toDOM=function(parent){DOCOrderDOCTProductDialog_View.superclass.toDOM.call(this,parent);EventHandler.addEvent(this.getDataControl(this.getId()+"_product").control.getNode(),"change",this.m_evOnProdChange);EventHandler.addEvent(this.m_WarehouseCtrl.getNode(),"change",this.m_evOnWHChange);}
DOCOrderDOCTProductDialog_View.prototype.removeDOM=function(){DOCOrderDOCTProductDialog_View.superclass.removeDOM.call(this);EventHandler.removeEvent(this.getDataControl(this.getId()+"_product").control.getNode(),"change",this.m_evOnProdChange);EventHandler.removeEvent(this.m_WarehouseCtrl.getNode(),"change",this.m_evOnWHChange);if(this.m_packCtrl){EventHandler.removeEvent(this.m_packCtrl.getNode(),"change",this.m_evOnPackExistsChange);}}
DOCOrderDOCTProductDialog_View.prototype.onGetData=function(resp,isNew){var model=resp.getModelById("DOCOrderDOCTProductDialog_Model");model.setActive(true);if(model.getNextRow()){var product_id=model.getFieldValue("product_id");this.onProductSelected(product_id);if(SERV_VARS.ROLE_ID!="client"){var pr_en=(model.getFieldValue("price_edit")=="true");this.m_totPriceCtrl.setEnabled(pr_en);this.m_totSumCtrl.setEnabled(pr_en);}
this.m_oldMeasureUnitId=model.getFieldValue("measure_unit_id");}
model.setRowBOF();DOCOrderDOCTProductDialog_View.superclass.onGetData.call(this,resp,isNew);}
DOCOrderDOCTProductDialog_View.prototype.onWriteOk=function(resp){DOCOrderDOCTProductDialog_View.superclass.onWriteOk.call(this,resp);this.m_headWarehouseCtrl.setByFieldId(this.m_WarehouseCtrl.getValue());}
DOCOrderDOCTProductDialog_View.prototype.calcTotals=function(){if(!this.m_packCtrl)return;var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));var id=this.getId();var par_pack=(this.m_packCtrl.getValue()=="true"&&this.m_packNotFree);var par_quant=parseFloat(this.getDataControlValue(id+"_quant"));var par_measure_unit_id=this.getDataControlValue(id+"_measure_unit");var par_client_id=this.m_params.clientId;var par_wh_id=this.m_params.warehouseId;var par_product_id=this.getDataControlValue(id+"_product");var par_mes_l=0;var par_mes_w=0;var par_mes_h=0;if(this.viewControlExists(id+"_mes_length")){par_mes_l=parseInt(this.getDataControlValue(id+"_mes_length"));}
if(this.viewControlExists(id+"_mes_width")){par_mes_w=parseInt(this.getDataControlValue(id+"_mes_width"));}
if(this.viewControlExists(id+"_mes_height")){par_mes_h=parseInt(this.getDataControlValue(id+"_mes_height"));}
if(!par_quant||(par_measure_unit_id=="undefined")||!par_wh_id||(!par_client_id&&SERV_VARS.ROLE_ID!="client")||!par_product_id){this.setTotals({"base_quant":0,"volume_m":0,"weight_m":0,"price":0,"total":0});}
else{var self=this;contr.run("calc_totals",{"async":true,"errControl":this.getErrorControl(),"params":{"warehouse_id":par_wh_id,"client_id":par_client_id,"product_id":par_product_id,"mes_length":par_mes_l,"mes_width":par_mes_w,"mes_height":par_mes_h,"quant":par_quant,"measure_unit_id":par_measure_unit_id,"pack":par_pack,"pack_in_price":(this.m_packNotFree)?this.getDataControlValue(id+"_pack_in_price"):"","deliv_to_third_party":this.m_params.toThirdParty,"price_edit":(SERV_VARS.ROLE_ID=="client"||(this.m_isNew&&!this.m_isCopy&&!this.m_priceEditted))?false:this.getDataControlValue(id+"_price_edit"),"price_round":this.getDataControlValue(id+"_price_round"),"price":this.m_totPriceCtrl.getValue()},"func":function(resp){var m=resp.getModelById("DOCOrder_Model");m.setActive(true);if(m.getNextRow()){self.setTotals({"base_quant":m.getFieldValue("base_quant"),"volume_m":m.getFieldValue("volume_m"),"weight_t":m.getFieldValue("weight_t"),"price":m.getFieldValue("price"),"total":m.getFieldValue("total")});}
self.measureUnitsCheck(resp);}});}}
DOCOrderDOCTProductDialog_View.prototype.setTotals=function(struc){this.m_totQuantCtrl.setValue(struc.base_quant);this.m_totVolCtrl.setValue(struc.volume_m);this.m_totWeightCtrl.setValue(struc.weight_t);this.m_totPriceCtrl.setValue(struc.price);this.m_totSumCtrl.setValue(struc.total);}
DOCOrderDOCTProductDialog_View.prototype.setMethodParams=function(pm,checkRes){DOCOrderDOCTProductDialog_View.superclass.setMethodParams.call(this,pm,checkRes);if(this.m_measureCheckText!=undefined&&this.m_measureCheckText!=""){checkRes.incorrect_vals=true;this.m_quantCtrl.setComment(this.m_measureCheckText);}
pm.setParamValue("warehouse_id",this.m_params.warehouseId);pm.setParamValue("client_id",this.m_params.clientId);pm.setParamValue("deliv_to_third_party",this.m_params.toThirdParty);}
DOCOrderDOCTProductDialog_View.prototype.evOnPackExistsChange=function(){if(this.m_packInPriceCtrl){var en;if(this.m_packCtrl.getValue()=="false"){this.m_packInPriceCtrl.setValue(false);en=false;}
else{en=true;}
this.m_packInPriceCtrl.setEnabled(en);}}
DOCOrderDOCTProductDialog_View.prototype.calcQuant=function(){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));var id=this.getId();var par_measure_unit_id=this.getDataControlValue(id+"_measure_unit");var par_product_id=this.getDataControlValue(id+"_product");var par_mes_l=parseInt(this.getDataControlValue(id+"_mes_length"));var par_mes_w=parseInt(this.getDataControlValue(id+"_mes_width"));var par_mes_h=parseInt(this.getDataControlValue(id+"_mes_height"));var par_base_quant=parseFloat(this.m_totQuantCtrl.getValue());if(par_base_quant&&(par_measure_unit_id!="undefined")&&par_product_id&&par_mes_l&&par_mes_w&&par_mes_h){var self=this;this.m_measureCheckText="";contr.run("calc_quant",{"async":true,"errControl":this.getErrorControl(),"params":{"product_id":par_product_id,"measure_unit_id":par_measure_unit_id,"mes_length":par_mes_l,"mes_width":par_mes_w,"mes_height":par_mes_h,"quant":par_base_quant},"func":function(resp){self.m_quantCtrl.m_isInt=(self.getDataControl(self.getId()+"_measure_unit").control.getFieldAttr("is_int")=="true");var m=resp.getModelById("calc_quant",true);if(m.getNextRow()){self.m_quantCtrl.setValue(m.getFieldValue("quant"));}
self.measureUnitsCheck(resp);self.m_oldMeasureUnitId=par_measure_unit_id;}});}}
DOCOrderDOCTProductDialog_View.prototype.measureUnitsCheck=function(resp){this.m_measureCheckText="";var m=resp.getModelById("product_measure_units_check");m.setActive(true);while(m.getNextRow()){this.m_measureCheckText+=(this.m_measureCheckText!="")?", ":"Дробные значения для единиц: ";this.m_measureCheckText+=m.getFieldValue("measure_unit_descr")+" ("+
m.getFieldValue("quant")+")";}
this.m_quantCtrl.setComment(this.m_measureCheckText);}
DOCOrderDOCTProductDialog_View.prototype.getFormWidth=function(){return"950";}
DOCOrderDOCTProductDialog_View.prototype.getFormHeight=function(){return"650";}
DOCOrderDOCTProductDialog_View.prototype.setWHouseWarn=function(){if(this.m_headWarehouseCtrl.getValue()!=this.m_WarehouseCtrl.getValue()){this.m_WarehouseCtrl.setComment("Продукция не соответствует складу в заявке.");DOMHandler.addClass(this.m_WarehouseCtrl.m_node,this.INCORRECT_VAL_CLASS);}
else{this.m_WarehouseCtrl.setValid();this.m_WarehouseCtrl.setComment("");}} 
function DOCOrderDOCTCustSurveyList_View(id,options){options=options||{};DOCOrderDOCTCustSurveyList_View.superclass.constructor.call(this,id,options);var head=new GridHead();var row=new GridRowDOCT(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_customer_survey_question_descr",{"value":"Вопрос","readBind":{"valueFieldId":"customer_survey_question_descr"}}));row.addElement(new GridDbHeadCellBool(id+"_col_points",{"value":"Баллы","readBind":{"valueFieldId":"points"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_answer_comment",{"value":"Комментарий","readBind":{"valueFieldId":"answer_comment"}}));head.addElement(row);this.setGridControl(new GridDbDOCT(id+"_grid",{"head":head,"body":new GridBody(),"controller":new DOCOrderDOCTCustSurvey_Controller(new ServConnector(HOST_NAME)),"readModelId":"DOCOrderDOCTCustSurveyList_Model","editViewClass":DOCOrderDOCTCustSurveyInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(null,{"noInsert":true,"noCopy":true,"noDelete":true,"noPrint":true,"noRefresh":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(DOCOrderDOCTCustSurveyList_View,ViewDocumentDetail); 
function DOCOrderDOCTCustSurveyInline_View(id,options){options=options||{};DOCOrderDOCTCustSurveyInline_View.superclass.constructor.call(this,id,options);var model="DOCOrderDOCTCustSurveyList_Model";this.addDataControl(new CustSurvQuesionEditObject("customer_survey_question_id",id+"_customer_survey_question",true),{"modelId":model,"valueFieldId":"customer_survey_question_descr","keyFieldIds":["customer_survey_question_id"]},{"valueFieldId":null,"keyFieldIds":["customer_survey_question_id"]});this.addDataControl(new EditNum(id+"_points",{"name":"points","attrs":{"maxlength":5,"size":2,"required":"required"}}),{"modelId":model,"valueFieldId":"points","keyFieldIds":null},{"valueFieldId":"points","keyFieldIds":null});this.addDataControl(new EditText(id+"_answer_comment",{"name":"answer_comment","rows":"3"}),{"modelId":model,"valueFieldId":"answer_comment","keyFieldIds":null},{"valueFieldId":"answer_comment","keyFieldIds":null});}
extend(DOCOrderDOCTCustSurveyInline_View,ViewInlineGridEditDOCT); 
function DOCOrderDOCTShipmentList_View(id,options){options=options||{};DOCOrderDOCTShipmentList_View.superclass.constructor.call(this,id,options);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_view_id",{"readBind":{"valueFieldId":"view_id"},"keyCol":true,"visible":false,"attrs":{"rowspan":2}}));row.addElement(new GridDbHeadCell(id+"_col_line_number",{"value":"№","readBind":{"valueFieldId":"line_number"},"keyCol":true,"colAttrs":{"align":"center"},"attrs":{"rowspan":2}}));var row2=new GridRow(id+"_row2");var col_mu=new GridDbHeadCell(id+"_col_measure_unit_descr",{"value":"Наим.","readBind":{"valueFieldId":"measure_unit_descr"},"colAttrs":{"align":"center"}});var col_quant=new GridDbHeadCell(id+"_col_quant",{"value":"Кол.","readBind":{"valueFieldId":"quant"},"colAttrs":{"align":"right"}});var col_quant_conf=new GridDbHeadCell(id+"_col_quant_confirmed_base_measure_unit",{"value":"Кол.отгр.","readBind":{"valueFieldId":"quant_confirmed_base_measure_unit"},"colAttrs":{"align":"right"}});var col_doc_mu=new GridDbHeadCell(id+"_col_doc_measure_unit_descr",{"value":"Наим.","readBind":{"valueFieldId":"doc_measure_unit_descr"},"colAttrs":{"align":"center"}});var col_doc_quant=new GridDbHeadCell(id+"_col_doc_quant",{"value":"Кол.","readBind":{"valueFieldId":"doc_quant"},"colAttrs":{"align":"right"}});var col_doc_quant_conf=new GridDbHeadCell(id+"_col_quant_confirmed_measure_unit",{"value":"Кол.отгр.","readBind":{"valueFieldId":"quant_confirmed_measure_unit"},"colAttrs":{"align":"right"}});row.addElement(new GridDbHeadCell(id+"_col_product_descr",{"value":"Продукция","readBind":{"valueFieldId":"product_descr"},"attrs":{"rowspan":"2"}}));row.addElement(new GridDbHeadCell("_col_base",{"value":"Базовая единица","attrs":{"colspan":3},"colSpanArray":[col_mu,col_quant,col_quant_conf]}));row.addElement(new GridDbHeadCell("_col_doc",{"value":"Единица док-та","attrs":{"colspan":3},"colSpanArray":[col_doc_mu,col_doc_quant,col_doc_quant_conf]}));row2.addElement(col_mu);row2.addElement(col_quant);row2.addElement(col_quant_conf);row2.addElement(col_doc_mu);row2.addElement(col_doc_quant);row2.addElement(col_doc_quant_conf);head.addElement(row);head.addElement(row2);this.setGridControl(new GridDbDOCT(id+"_grid",{"head":head,"body":new GridBody(),"controller":new DOCOrderDOCTProduct_Controller(new ServConnector(HOST_NAME)),"readModelId":"DOCOrderDOCTProductList_Model","editViewClass":DOCOrderDOCTShipmentInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"noInsert":true,"noCopy":true,"noDelete":true,"noPrint":true,"noRefresh":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(DOCOrderDOCTShipmentList_View,ViewDocumentDetail); 
function DOCOrderDOCTShipmentInline_View(id,options){options=options||{};var model_id="DOCOrderDOCTProductDialog_Model";this.m_measureCheckText="";options.readModelId=model_id;DOCOrderDOCTShipmentInline_View.superclass.constructor.call(this,id,options);var self=this;this.addDataControl(new Control(id+"_product_id","span",{"name":"product_id","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"product_id","keyFieldIds":null},{"valueFieldId":"product_id","keyFieldIds":null});this.addDataControl(new Control(id+"_measure_unit_id","span",{"name":"measure_unit_id","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"measure_unit_id","keyFieldIds":null},{"valueFieldId":"measure_unit_id","keyFieldIds":null});this.addDataControl(new Control(id+"_measure_unit_is_int","span",{"name":"measure_unit_is_int","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"measure_unit_is_int","keyFieldIds":null},{"valueFieldId":"measure_unit_is_int","keyFieldIds":null});this.addDataControl(new Control(id+"_base_measure_unit_id","span",{"name":"base_measure_unit_id","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"base_measure_unit_id","keyFieldIds":null},{"valueFieldId":"base_measure_unit_id","keyFieldIds":null});this.addDataControl(new Control(id+"_base_measure_unit_is_int","span",{"name":"base_measure_unit_is_int","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"base_measure_unit_is_int","keyFieldIds":null},{"valueFieldId":"base_measure_unit_is_int","keyFieldIds":null});this.addDataControl(new Control(id+"_mes_length","span",{"name":"mes_length","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"mes_length","keyFieldIds":null},{"valueFieldId":"mes_length","keyFieldIds":null});this.addDataControl(new Control(id+"_mes_width","span",{"name":"mes_width","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"mes_width","keyFieldIds":null},{"valueFieldId":"mes_width","keyFieldIds":null});this.addDataControl(new Control(id+"_mes_height","span",{"name":"mes_height","visible":false,"tableLayout":false}),{"modelId":model_id,"valueFieldId":"mes_height","keyFieldIds":null},{"valueFieldId":"mes_height","keyFieldIds":null});this.addDataControl(new Edit(id+"_product_descr",{"name":"product_descr","enabled":false,"tableLayout":false,"attrs":{"size":"25"}}),{"modelId":model_id,"valueFieldId":"product_descr","keyFieldIds":null},{"valueFieldId":"product_descr","keyFieldIds":null});this.addDataControl(new Edit(id+"_base_measure_unit_descr",{"name":"base_measure_unit_descr","tableLayout":false,"enabled":false,"attrs":{"size":"5"}}),{"modelId":model_id,"valueFieldId":"base_measure_unit_descr","keyFieldIds":null},{"valueFieldId":"base_measure_unit_descr","keyFieldIds":null});this.addDataControl(new EditFloat(id+"_quant_base_measure_unit",{"name":"quant_base_measure_unit","tableLayout":false,"precision":"9","enabled":false,"attrs":{"size":"10","maxlength":"20"}}),{"modelId":model_id,"valueFieldId":"quant_base_measure_unit","keyFieldIds":null},{"valueFieldId":"quant_base_measure_unit","keyFieldIds":null});this.addDataControl(new EditFloat(id+"_quant_confirmed_base_measure_unit",{"name":"quant_confirmed_base_measure_unit","precision":"9","tableLayout":false,"attrs":{"size":"10","maxlength":"20"},"events":{"input":function(){self.onChangeBaseQuant();},"focus":function(){$(this.getNode()).select();}}}),{"modelId":model_id,"valueFieldId":"quant_confirmed_base_measure_unit","keyFieldIds":null},{"valueFieldId":"quant_confirmed_base_measure_unit","keyFieldIds":null});this.addDataControl(new Edit(id+"_measure_unit_descr",{"name":"measure_unit_descr","tableLayout":false,"enabled":false,"attrs":{"size":"5"}}),{"modelId":model_id,"valueFieldId":"measure_unit_descr","keyFieldIds":null},{"valueFieldId":"measure_unit_descr","keyFieldIds":null});this.addDataControl(new EditFloat(id+"_quant",{"name":"quant","tableLayout":false,"enabled":false,"attrs":{"size":"5"}}),{"modelId":model_id,"valueFieldId":"quant","keyFieldIds":null},{"valueFieldId":"quant","keyFieldIds":null});this.m_quantCtrl=new DOCOrderQuantEdit(id+"_quant_confirmed_measure_unit",{"name":"quant_confirmed_measure_unit","tableLayout":false,"events":{"input":function(){self.onChangeDocQuant();},"focus":function(){$(this.getNode()).select();}},"attrs":{"size":"5"}});this.addDataControl(this.m_quantCtrl,{"modelId":model_id,"valueFieldId":"quant_confirmed_measure_unit","keyFieldIds":null},{"valueFieldId":"quant_confirmed","keyFieldIds":null});}
extend(DOCOrderDOCTShipmentInline_View,ViewInlineGridEditDOCT);DOCOrderDOCTShipmentInline_View.prototype.onChangeQuant=function(measureUnitId,measureUnitIsIntId,getQuantConfirmedId,setQuantConfirmedId,measureUnitFromId){var product_id=nd("DOCOrderDOCTShipmentList_View_gridEditView_product_id").getAttribute("old_product_id");var measure_unit_id=nd("DOCOrderDOCTShipmentList_View_gridEditView_"+measureUnitId).getAttribute("old_"+measureUnitId);var measure_unit_is_int=nd("DOCOrderDOCTShipmentList_View_gridEditView_"+measureUnitIsIntId).getAttribute("old_"+measureUnitIsIntId);var mes_length=nd("DOCOrderDOCTShipmentList_View_gridEditView_mes_length").getAttribute("old_mes_length");var mes_width=nd("DOCOrderDOCTShipmentList_View_gridEditView_mes_width").getAttribute("old_mes_width");var mes_height=nd("DOCOrderDOCTShipmentList_View_gridEditView_mes_height").getAttribute("old_mes_height");var quant=toFloat(nd("DOCOrderDOCTShipmentList_View_gridEditView_"+getQuantConfirmedId).value);if(quant){var self=this;var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("calc_quant",{"async":true,"params":{"product_id":product_id,"mes_length":mes_length,"mes_width":mes_width,"mes_height":mes_height,"quant":quant,"measure_unit_id":measure_unit_id,"measure_unit_id_from":measureUnitFromId},"func":function(resp){self.m_quantCtrl.m_isInt=measure_unit_is_int;var m=resp.getModelById("calc_quant");m.setActive(true);if(m.getNextRow()){nd("DOCOrderDOCTShipmentList_View_gridEditView_"+setQuantConfirmedId).value=m.getFieldValue("quant");}
self.m_measureCheckText="";var m=resp.getModelById("product_measure_units_check");m.setActive(true);while(m.getNextRow()){self.m_measureCheckText+=(self.m_measureCheckText!="")?", ":"Дробные значения для единиц: ";self.m_measureCheckText+=m.getFieldValue("measure_unit_descr")+" ("+
m.getFieldValue("quant")+")";}
self.m_quantCtrl.setComment(self.m_measureCheckText);}});}
else{nd("DOCOrderDOCTShipmentList_View_gridEditView_"+setQuantConfirmedId).value="0";}}
DOCOrderDOCTShipmentInline_View.prototype.onChangeBaseQuant=function(){this.onChangeQuant("measure_unit_id","measure_unit_is_int","quant_confirmed_base_measure_unit","quant_confirmed_measure_unit","0");}
DOCOrderDOCTShipmentInline_View.prototype.onChangeDocQuant=function(){this.onChangeQuant("base_measure_unit_id","base_measure_unit_is_int","quant_confirmed_measure_unit","quant_confirmed_base_measure_unit",nd("DOCOrderDOCTShipmentList_View_gridEditView_measure_unit_id").getAttribute("old_measure_unit_id"));}
DOCOrderDOCTShipmentInline_View.prototype.setMethodParams=function(pm,checkRes){DOCOrderDOCTShipmentInline_View.superclass.setMethodParams.call(this,pm,checkRes);var er_text=this.m_measureCheckText;try{this.m_quantCtrl.validate(this.m_quantCtrl.getValue());}
catch(e){checkRes.incorrect_vals=true;er_text+=(er_text=="")?er_text:", ";er_text+=e.message;}
if(er_text!=""){checkRes.incorrect_vals=true;this.m_quantCtrl.setComment(er_text);}}
DOCOrderDOCTShipmentInline_View.prototype.onGetData=function(resp){DOCOrderDOCTShipmentInline_View.superclass.onGetData.call(this,resp);var m=resp.getModelById("DOCOrderDOCTProductDialog_Model",true);if(m.getNextRow()){this.m_quantCtrl.m_isInteger=(m.getFieldValue("measure_unit_is_int")=="true");}} 
function DOCOrderCancel_View(id,options){options=options||{};options.writeController=new DOCOrder_Controller(new ServConnector(HOST_NAME));options.customWriteMethod=true;options.writeMethodId="set_cancel_cause";options.writeController.getPublicMethodById(options.writeMethodId).setParamValue("doc_id",options.doc_id);DOCOrderCancel_View.superclass.constructor.call(this,id,options);var cont=new ControlContainer(id+"_panel","div",{"className":"panel"});var ctrl=new EditText(id+"_cause",{"labelCaption":"Укажите причину отмены заявки:","name":"cause","rows":"5","attrs":{"maxlength":500,"required":"required"},"tableLayout":false});this.bindControl(ctrl,{"modelId":null,"valueFieldId":"cause","keyFieldIds":null},{"valueFieldId":"cause","keyFieldIds":null,"modelId":null});cont.addElement(ctrl);this.addControl(cont);}
extend(DOCOrderCancel_View,ViewDialog); 
function Catalogs_View(id,options){options=options||{};Catalogs_View.superclass.constructor.call(this,id,options);this.m_winObj=options.winObj;this.addItem({"caption":"Фирмы","viewClassId":FirmList_View,"id":"FirmList_View"});this.addItem({"caption":"Города отгрузки","viewClassId":ProductionCityList_View,"id":"ProductionCityList_View"});this.addItem({"caption":"Склады","viewClassId":WarehouseList_View,"id":"WarehouseList_View"});this.addItem({"caption":"Адреса магазинов","viewClassId":SaleStoreAddressList_View,"id":"SaleStoreAddressList_View"});this.addItem({"caption":"Прайсы","viewClassId":ClientPriceListList_View,"id":"ClientPriceListList_View"});this.addItem({"caption":"Опрос клиентов","viewClassId":CustomerSurveyQuestionList_View,"id":"CustomerSurveyQuestionList_View"});this.addItem({"caption":"Виды деятельности","viewClassId":ClientActivity_View,"id":"ClientActivity_View"});this.addItem({"caption":"Единицы измерения","viewClassId":MeasureUnitList_View,"id":"MeasureUnitList_View"});this.addItem({"caption":"Производственные стадии","viewClassId":ProductionStateList_View,"id":"ProductionStateList_View"});this.addItem({"caption":"Продукция","viewClassId":ProductList_View,"id":"ProductList_View"});this.addItem({"caption":"Номенкл.группы","viewClassId":ProductGroupList_View,"id":"ProductGroupList_View"});this.addItem({"caption":"Сертификаты","viewClassId":SertType_View,"id":"SertType_View"});this.addItem({"caption":"Сроки задолженности","viewClassId":ClientDebtPeriodList_View,"id":"DebtPeriodList_View"});this.addItem({"caption":"Периоды отгрузки","viewClassId":DeliveryPeriodList_View,"id":"DeliveryPeriodList_View"});this.addItem({"caption":"Часы доставки","viewClassId":DeliveryHour_View,"id":"DeliveryHour_View"});this.addItem({"caption":"Перевозчики","viewClassId":CarrierList_View,"id":"CarrierList_View"});this.addItem({"caption":"Водители","viewClassId":DriverList_View,"id":"DriverList_View"});this.addItem({"caption":"Автомобили","viewClassId":VehicleList_View,"id":"VehicleList_View"});this.addItem({"caption":"Ценовые категории","viewClassId":DelivCostOptList_View,"id":"DelivCostOptList_View"});this.addItem({"caption":"Тарифы по доставке","viewClassId":DelivCostList_View,"id":"DelivCostList_View"});this.addItem({"caption":"Расстояние до нас. пунктов","viewClassId":NaspunktList_View,"id":"NaspunktList_View"});this.addItem({"caption":"Стоимость доставки по нас.пунктам","viewClassId":RepNaspunktCost_View,"id":"RepNaspunktCost_View"});this.addItem({"caption":"ТТН","viewClassId":TTNAttrPair_View,"id":"TTNAttrPair_View"});this.addItem({"caption":"Порядок перевозчиков в ТТН","viewClassId":CarrierOrder_View,"id":"CarrierOrder_View"});this.addItem({"caption":"Серверы трекеров","viewClassId":TrackerServerList_View,"id":"TrackerServerList_View"});this.addItem({"caption":"Трекеры","viewClassId":TrackerList_View,"id":"TrackerList_View"});this.addItem({"caption":"Отчет по стоянкам","viewClassId":RepVehicleStop_View,"id":"RepVehicleStop_View"});this.addItem({"caption":"Шаблоны SMS","viewClassId":SMSTemplateList_View,"id":"SMSTemplateList_View"});this.addItem({"caption":"Шаблоны Email","viewClassId":EmailTemplateList_View,"id":"EmailTemplateList_View"});this.addItem({"caption":"SMS сообщения","viewClassId":SMSForSendingList_View,"id":"SMSForSendingList_View"});this.addItem({"caption":"EMail сообщения","viewClassId":MailForSendingList_View,"id":"MailForSendingList_View"});this.addItem({"caption":"Праздники","viewClassId":Holiday_View,"id":"Holiday_View"});this.addItem({"caption":"Константы","viewClassId":ConstantList_View,"id":"ConstantList_View"});this.addItem({"caption":"Долги клиентов","viewClassId":ClientDebt_View,"id":"ClientDebt_View"});this.addItem({"caption":"Долги клиентов (отчет)","viewClassId":RepClientDebts_View,"id":"RepClientDebts_View"});this.addItem({"caption":"ПКО","viewClassId":AccPKOList_View,"id":"AccPKOList_View"});}
extend(Catalogs_View,ViewMenu); 
function WarehouseList_View(id,options){options=options||{};options.title="Склады";WarehouseList_View.superclass.constructor.call(this,id,options);var controller=new Warehouse_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));if(SERV_VARS.ROLE_ID=="admin"){row.addElement(new GridDbHeadCellBool(id+"_col_deleted",{"value":"Удален","readBind":{"valueFieldId":"deleted"}}));}
row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_production_city_descr",{"value":"Город","readBind":{"valueFieldId":"production_city_descr"}}));row.addElement(new GridDbHeadCell(id+"_address",{"value":"Адрес","readBind":{"valueFieldId":"address"}}));row.addElement(new GridDbHeadCell(id+"_firm_descr",{"value":"Организация","readBind":{"valueFieldId":"firm_descr"}}));row.addElement(new GridDbHeadCellBool(id+"_on_map",{"value":"Объект на карте","readBind":{"valueFieldId":"on_map"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"WarehouseList_Model","editViewClass":WarehouseDialog_View,"editInline":false,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"asyncEditRead":false,"winObj":options.winObj}));}
extend(WarehouseList_View,ViewList); 
function SaleStoreAddressList_View(id,options){options=options||{};options.title="Адреса магазинов";SaleStoreAddressList_View.superclass.constructor.call(this,id,options);var controller=new SaleStoreAddress_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_code",{"value":"Код","readBind":{"valueFieldId":"code"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"SaleStoreAddress_Model","editViewClass":SaleStoreAddressInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(SaleStoreAddressList_View,ViewList); 
function WarehouseDialog_View(id,options){options=options||{};options.readMethodId=options.readMethodId||this.DEF_READ_METH_ID;options.writeController=options.writeController||options.readController;options.noOk=true;options.noCancel=true;WarehouseDialog_View.superclass.constructor.call(this,id,options);var model_id="WarehouseDialog_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null,"modelId":"Warehouse_Model"});this.addDataControl(new EditString(id+"_name",{"labelCaption":"Наименование:","name":"name","tableLayout":false,"attrs":{"maxlength":50,"size":30,"required":"required"}}),{"modelId":model_id,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null,"modelId":"Warehouse_Model"});this.addDataControl(new EditCheckBox(id+"_deleted",{"labelCaption":"Удален:","name":"name","tableLayout":false}),{"modelId":model_id,"valueFieldId":"deleted","keyFieldIds":null},{"valueFieldId":"deleted","keyFieldIds":null,"modelId":"Warehouse_Model"});this.addDataControl(new EditString(id+"_address",{"labelCaption":"Адрес:","name":"name","tableLayout":false,"attrs":{"maxlength":300,"size":100}}),{"modelId":model_id,"valueFieldId":"address","keyFieldIds":null},{"valueFieldId":"address","keyFieldIds":null,"modelId":"Warehouse_Model"});this.addDataControl(new EditString(id+"_tel",{"labelCaption":"Телефоны:","name":"name","tableLayout":false,"attrs":{"maxlength":100,"size":50}}),{"modelId":model_id,"valueFieldId":"tel","keyFieldIds":null},{"valueFieldId":"tel","keyFieldIds":null,"modelId":"Warehouse_Model"});this.addDataControl(new EditString(id+"_email",{"labelCaption":"Эл.почта:","name":"name","tableLayout":false,"attrs":{"maxlength":100,"size":50}}),{"modelId":model_id,"valueFieldId":"email","keyFieldIds":null},{"valueFieldId":"email","keyFieldIds":null,"modelId":"Warehouse_Model"});if(!CONST_CONTROLS.firm){CONST_CONTROLS.firm=new FirmEditObject("default_firm_id",id+"_default_firm",false);}
else{CONST_CONTROLS.firm.setDefaultId();}
this.addDataControl(CONST_CONTROLS.firm,{"modelId":model_id,"valueFieldId":"default_firm_descr","keyFieldIds":["default_firm_id"]},{"valueFieldId":null,"keyFieldIds":["default_firm_id"]});if(!CONST_CONTROLS.production_city){CONST_CONTROLS.production_city=new ProductionCityEditObject("production_city_id",id+"_production_city",false);}
else{CONST_CONTROLS.production_city.setDefaultId();}
this.addDataControl(CONST_CONTROLS.production_city,{"modelId":model_id,"valueFieldId":"production_city_descr","keyFieldIds":["production_city_id"]},{"valueFieldId":null,"keyFieldIds":["production_city_id"]});this.m_ctrlZoneStr=new Edit(id+"_zone_str",{"visible":false,"name":"zone_str"});this.addDataControl(this.m_ctrlZoneStr,{"modelId":model_id,"valueFieldId":"zone_str","keyFieldIds":null},{"valueFieldId":"zone","keyFieldIds":null,"modelId":"Warehouse_Model"});this.m_ctrlZoneCenterStr=new Edit(id+"_zone_center_str",{"visible":false,"name":"zone_center_str"});this.addDataControl(this.m_ctrlZoneCenterStr,{"modelId":model_id,"valueFieldId":"zone_center_str","keyFieldIds":null},{"valueFieldId":"null","keyFieldIds":null});var self=this;this.addControl(new ButtonCmd(uuid(),{"caption":"Записать","onClick":function(){self.onClickOk();},"attrs":{"title":"записать,закрыть"}}));this.addControl(new ButtonCmd(uuid(),{"caption":"Закрыть","onClick":function(){self.onCancel();},"attrs":{"title":"закрыть без сохранения"}}));this.addFeatureControl();this.addMapControl();}
extend(WarehouseDialog_View,MapZones_View);WarehouseDialog_View.prototype.getZoneDescr=function(){return"Склад отгрузки";} 
function ProductList_View(id,options){options=options||{};options.title="Продукция";ProductList_View.superclass.constructor.call(this,id,options);var controller=new Product_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_measure_unit_descr",{"value":"Баз.единица","readBind":{"valueFieldId":"measure_unit_descr"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_warehouses_descr",{"value":"Склады","readBind":{"valueFieldId":"warehouses_descr"}}));row.addElement(new GridDbHeadCellBool(id+"_deleted",{"value":"Удален","readBind":{"valueFieldId":"deleted"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ProductList_Model","editViewClass":ProductDialog_View,"editInline":false,"pagination":new GridPagination(id+"_page",{"countPerPage":CONSTANT_VALS.grid_rows_per_page_count}),"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(ProductList_View,ViewList); 
function ProductDialog_View(id,options){options=options||{};options.tagName="div";ProductDialog_View.superclass.constructor.call(this,id,options);options.enabled=false;var ctrl;var model_id="ProductDialog_Model";var self=this;this.m_idCtrl=new Edit(id+"_id",{"visible":false,"name":"id","tableLayout":false});this.addDataControl(this.m_idCtrl,{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});ctrl=new EditString(id+"_name",{"labelCaption":"Наименование:","name":"name","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":100,"size":100,"required":"required"}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});this.addControl(ctrl);ctrl=new EditString(id+"_name_for_1c",{"labelCaption":"Наименование для 1с:","name":"name_for_1c","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":100,"size":100,"required":"required"}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"name_for_1c","keyFieldIds":null},{"valueFieldId":"name_for_1c","keyFieldIds":null});this.addControl(ctrl);ctrl=new EditString(id+"_fin_group",{"labelCaption":"Группа финансового учета:","name":"fin_group","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":500,"size":100}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"fin_group","keyFieldIds":null},{"valueFieldId":"fin_group","keyFieldIds":null});this.addControl(ctrl);ctrl=new EditString(id+"_analit_group",{"labelCaption":"Группа аналитического учета:","name":"analit_group","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":500,"size":100}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"analit_group","keyFieldIds":null},{"valueFieldId":"analit_group","keyFieldIds":null});this.addControl(ctrl);this.addDataControl(new EditCheckBox(id+"_deleted",{"labelCaption":"Удален:","name":"name","tableLayout":false}),{"modelId":model_id,"valueFieldId":"deleted","keyFieldIds":null},{"valueFieldId":"deleted","keyFieldIds":null,"modelId":"Warehouse_Model"});var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Наименования для 1с","dataTarget":p_id,"attrs":{"title":"показать/скрыть наименования для 1с"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});this.m_product1cNameList=new Product1cNameList_View("Product1cNameList",options);cont.addElement(this.m_product1cNameList);cont_m.addElement(cont);this.addElement(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Склады отгрузки продукции","dataTarget":p_id,"attrs":{"title":"показать/скрыть склады отгрузки продукции"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});this.m_productWarehouseList=new ProductWarehouseList_View("ProductWarehouseList",options);cont.addElement(this.m_productWarehouseList);cont_m.addElement(cont);this.addElement(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Размеры продукции","dataTarget":p_id,"attrs":{"title":"показать/скрыть размеры продукции"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});var bs_col=get_bs_col();var dimen_table=new ControlContainer("dimen_table","table",{"className":"table"});var dimen_table_tr1=new ControlContainer("dimen_tr1","tr",{});dimen_table_tr1.addElement(new Control("dimen_tr1_td1","th",{"value":"Параметр","className":bs_col+"1"}));dimen_table_tr1.addElement(new Control("dimen_tr1_td2","th",{"value":"Название на форме","className":bs_col+"3"}));dimen_table_tr1.addElement(new Control("dimen_tr1_td3","th",{"value":"Фикс.знач.","className":bs_col+"1"}));dimen_table_tr1.addElement(new Control("dimen_tr1_td4","th",{"value":"Мин.знач.","className":bs_col+"1"}));dimen_table_tr1.addElement(new Control("dimen_tr1_td5","th",{"value":"Макс.знач.","className":bs_col+"1"}));dimen_table_tr1.addElement(new Control("dimen_tr1_td6","th",{"value":"Знач.по умолч.","className":bs_col+"1"}));dimen_table_tr1.addElement(new Control("dimen_tr1_td7","th",{"value":"Показыв. значения списком","className":bs_col+"1"}));dimen_table_tr1.addElement(new Control("dimen_tr1_td8","th",{"value":"Значения,разделенные ;","className":bs_col+"3"}));dimen_table.addElement(dimen_table_tr1);var dimen_ids=["length","width","height"];var dimen_names=["Длина","Ширина","Высота"];for(var ind=0;ind<dimen_ids.length;ind++){var row_ind=ind+2;dimen_table_tr=new ControlContainer("dimen_tr"+row_ind,"tr",{});ctrl=new EditCheckBox(id+"_mes_"+dimen_ids[ind]+"_exists",{"name":"mes_"+dimen_ids[ind]+"_exists","labelCaption":dimen_names[ind],"tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"mes_"+dimen_ids[ind]+"_exists","keyFieldIds":null},{"valueFieldId":"mes_"+dimen_ids[ind]+"_exists","keyFieldIds":null});var dimen_tr_td1=new ControlContainer("dimen_tr"+row_ind+"_td1","td",{"className":bs_col+"1"});dimen_tr_td1.addElement(ctrl);dimen_table_tr.addElement(dimen_tr_td1);ctrl=new EditString(id+"_mes_"+dimen_ids[ind]+"_name",{"name":"mes_"+dimen_ids[ind]+"_name","attrs":{"maxlength":"50"},"noClear":true,"tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"mes_"+dimen_ids[ind]+"_name","keyFieldIds":null},{"valueFieldId":"mes_"+dimen_ids[ind]+"_name","keyFieldIds":null});var dimen_tr_td2=new ControlContainer("dimen_tr"+row_ind+"_td2","td",{"className":bs_col+"3"});dimen_tr_td2.addElement(ctrl);dimen_table_tr.addElement(dimen_tr_td2);ctrl=new EditCheckBox(id+"_mes_"+dimen_ids[ind]+"_fix",{"name":"mes_"+dimen_ids[ind]+"_fix","tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"mes_"+dimen_ids[ind]+"_fix","keyFieldIds":null},{"valueFieldId":"mes_"+dimen_ids[ind]+"_fix","keyFieldIds":null});var ctrl2=new EditNum(id+"_mes_"+dimen_ids[ind]+"_fix_val",{"name":"mes_"+dimen_ids[ind]+"_fix_val","attrs":{"size":"5","maxlength":"3"},"tableLayout":false});this.bindControl(ctrl2,{"modelId":model_id,"valueFieldId":"mes_"+dimen_ids[ind]+"_fix_val","keyFieldIds":null},{"valueFieldId":"mes_"+dimen_ids[ind]+"_fix_val","keyFieldIds":null});var dimen_tr_td3=new ControlContainer("dimen_tr"+row_ind+"_td3","td",{"className":bs_col+"1"});dimen_tr_td3.addElement(ctrl);dimen_tr_td3.addElement(ctrl2);dimen_table_tr.addElement(dimen_tr_td3);ctrl=new EditNum(id+"_mes_"+dimen_ids[ind]+"_min_val",{"name":"mes_"+dimen_ids[ind]+"_min_val","attrs":{"maxlength":"10","size":"10"},"tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"mes_"+dimen_ids[ind]+"_min_val","keyFieldIds":null},{"valueFieldId":"mes_"+dimen_ids[ind]+"_min_val","keyFieldIds":null});var dimen_tr_td4=new ControlContainer("dimen_tr"+row_ind+"_td4","td",{"className":bs_col+"1"});dimen_tr_td4.addElement(ctrl);dimen_table_tr.addElement(dimen_tr_td4);ctrl=new EditNum(id+"_mes_"+dimen_ids[ind]+"_max_val",{"name":"mes_"+dimen_ids[ind]+"_max_val","attrs":{"maxlength":"10","size":"10"},"tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"mes_"+dimen_ids[ind]+"_max_val","keyFieldIds":null},{"valueFieldId":"mes_"+dimen_ids[ind]+"_max_val","keyFieldIds":null});var dimen_tr_td5=new ControlContainer("dimen_tr"+row_ind+"_td5","td",{"className":bs_col+"1"});dimen_tr_td5.addElement(ctrl);dimen_table_tr.addElement(dimen_tr_td5);ctrl=new EditNum(id+"_mes_"+dimen_ids[ind]+"_def_val",{"name":"mes_"+dimen_ids[ind]+"_def_val","attrs":{"maxlength":"10","size":"10"},"tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"mes_"+dimen_ids[ind]+"_def_val","keyFieldIds":null},{"valueFieldId":"mes_"+dimen_ids[ind]+"_def_val","keyFieldIds":null});var dimen_tr_td6=new ControlContainer("dimen_tr"+row_ind+"_td6","td",{"className":bs_col+"1"});dimen_tr_td6.addElement(ctrl);dimen_table_tr.addElement(dimen_tr_td6);ctrl=new EditCheckBox(id+"_mes_"+dimen_ids[ind]+"_seq",{"name":"mes_"+dimen_ids[ind]+"_seq","tableLayout":false,"events":{"change":function(){}}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"mes_"+dimen_ids[ind]+"_seq","keyFieldIds":null},{"valueFieldId":"mes_"+dimen_ids[ind]+"_seq","keyFieldIds":null});var dimen_tr_td7=new ControlContainer("dimen_tr"+row_ind+"_td7","td",{"className":bs_col+"1"});dimen_tr_td7.addElement(ctrl);dimen_table_tr.addElement(dimen_tr_td7);ctrl=new EditString(id+"_mes_"+dimen_ids[ind]+"_vals",{"name":"mes_"+dimen_ids[ind]+"_vals","tableLayout":false,"noClear":true});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"mes_"+dimen_ids[ind]+"_vals","keyFieldIds":null},{"valueFieldId":"mes_"+dimen_ids[ind]+"_vals","keyFieldIds":null});var dimen_tr_td8=new ControlContainer("dimen_tr"+row_ind+"_td8","td",{"className":bs_col+"3"});dimen_tr_td8.addElement(ctrl);dimen_table_tr.addElement(dimen_tr_td8);dimen_table.addElement(dimen_table_tr);}
cont.addElement(dimen_table);cont_m.addElement(cont);this.addControl(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Единицы продукции","dataTarget":p_id,"attrs":{"title":"показать/скрыть единицы продукции"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});ctrl=new MeasureUnitEditObject("base_measure_unit_id",id+"_measure_unit",false);ctrl.setDefaultId();this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"base_measure_unit_descr","keyFieldIds":["base_measure_unit_id"]},{"valueFieldId":null,"keyFieldIds":["base_measure_unit_id"]});cont.addElement(ctrl);var sub_cont=new ControlContainer("vol_sub_cont","div",{});ctrl=new EditFloat(id+"_base_measure_unit_vol_m",{"labelCaption":"Транспортировочный объем 1 базовой ед.:","name":"base_measure_unit_vol_m","precision":3,"buttonClear":false,"tableLayout":false,"winObj":this.m_winObj,"attrs":{"maxlength":10,"size":5}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"base_measure_unit_vol_m","keyFieldIds":null},{"valueFieldId":"base_measure_unit_vol_m","keyFieldIds":null});sub_cont.addElement(ctrl);cont.addElement(sub_cont);var sub_cont=new ControlContainer("weight_sub_cont","div",{});ctrl=new EditFloat(id+"_base_measure_unit_weight_t",{"labelCaption":"Масса 1 базовой ед., т.:","name":"base_measure_unit_weight_t","precision":3,"buttonClear":false,"tableLayout":false,"attrs":{"maxlength":19,"size":10}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"base_measure_unit_weight_t","keyFieldIds":null},{"valueFieldId":"base_measure_unit_weight_t","keyFieldIds":null});sub_cont.addElement(ctrl);cont.addElement(sub_cont);ctrl=new MeasureUnitEditObject("order_measure_unit_id",id+"_order_measure_unit",false,null,{"labelCaption":"Единица заявки:"});ctrl.setDefaultId();this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"order_measure_unit_descr","keyFieldIds":["order_measure_unit_id"]},{"valueFieldId":null,"keyFieldIds":["order_measure_unit_id"]});cont.addElement(ctrl);this.m_productMeasureUnitList=new ProductMeasureUnitList_View("ProductMeasureUnitList",options);cont.addElement(this.m_productMeasureUnitList);cont_m.addElement(cont);this.addControl(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Упаковка","dataTarget":p_id,"attrs":{"title":"показать/скрыть упаковку"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});ctrl=new EditString(id+"_pack_name",{"labelCaption":"Упаковка в пленку:","name":"pack_name","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":50,"size":25}});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"pack_name","keyFieldIds":null},{"valueFieldId":"pack_name","keyFieldIds":null});cont.addElement(ctrl);ctrl=new EditCheckBox(id+"_pack_default",{"labelCaption":"По умолчанию:","name":"pack_default","buttonClear":false,"tableLayout":false,"labelAlign":"left"});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"pack_default","keyFieldIds":null},{"valueFieldId":"pack_default","keyFieldIds":null});cont.addElement(ctrl);ctrl=new EditCheckBox(id+"_pack_not_free",{"labelCaption":"Упаковка платная:","name":"pack_not_free","buttonClear":false,"tableLayout":false,"labelAlign":"left"});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"pack_not_free","keyFieldIds":null},{"valueFieldId":"pack_not_free","keyFieldIds":null});cont.addElement(ctrl);sub_cont=new ControlContainer("pack_base_measure_unit_count_l","div",{});ctrl=new EditNum(id+"_pack_base_measure_unit_count",{"labelCaption":"Упаковка кратно, баз.ед.:","name":"pack_base_measure_unit_count","attrs":{"maxlength":"5","size":"2"},"buttonClear":false,"tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"pack_base_measure_unit_count","keyFieldIds":null},{"valueFieldId":"pack_base_measure_unit_count","keyFieldIds":null});sub_cont.addElement(ctrl);cont.addElement(sub_cont);cont_m.addElement(cont);this.addControl(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Наценка","dataTarget":p_id,"attrs":{"title":"показать/скрыть наценку"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});this.m_abnSizePriceCtrl=new EditCheckBox(id+"_extra_pay_for_abnormal_size",{"labelCaption":"Наценка за нестандартные размеры по алгоритму","name":"extra_pay_for_abnormal_size","buttonClear":false,"tableLayout":false,"events":{"change":function(){var en=(self.m_abnSizePriceCtrl.getValue()=="true");self.m_abnSizePriceAlwaysCtrl.setEnabled(en);if(!en){self.m_abnSizePriceAlwaysCtrl.setValue("false");}}}});this.bindControl(this.m_abnSizePriceCtrl,{"modelId":model_id,"valueFieldId":"extra_pay_for_abnormal_size","keyFieldIds":null},{"valueFieldId":"extra_pay_for_abnormal_size","keyFieldIds":null});cont.addElement(this.m_abnSizePriceCtrl);this.m_abnSizePriceAlwaysCtrl=new EditCheckBox(id+"_extra_pay_for_abn_size_always",{"labelCaption":"Наценка не зависит от размеров","name":"extra_pay_for_abn_size_always","buttonClear":false,"tableLayout":false,"enabled":false});this.bindControl(this.m_abnSizePriceAlwaysCtrl,{"modelId":model_id,"valueFieldId":"extra_pay_for_abn_size_always","keyFieldIds":null},{"valueFieldId":"extra_pay_for_abn_size_always","keyFieldIds":null});cont.addElement(this.m_abnSizePriceAlwaysCtrl);ctrl=new EditString(id+"_extra_pay_calc_formula",{"labelCaption":"Количество изделий в базовой единице","name":"extra_pay_calc_formula","buttonClear":false,"attrs":{"size":"80"},"tableLayout":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"extra_pay_calc_formula","keyFieldIds":null},{"valueFieldId":"extra_pay_calc_formula","keyFieldIds":null});cont.addElement(ctrl);var sub_cont=new ControlContainer(uuid(),"div",{});this.m_productCustomSizePriceList=new ProductCustomSizePriceList_View("productCustomSizePriceList",options);sub_cont.addElement(this.m_productCustomSizePriceList);cont.addElement(sub_cont);cont_m.addElement(cont);this.addControl(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var p_id=uuid();cont_m.addElement(new ButtonToggle(uuid(),{"caption":"Паспорт качества","dataTarget":p_id,"attrs":{"title":"показать/скрыть паспорт качества"}}));var cont=new ControlContainer(p_id,"div",{className:"collapse"});ctrl=new SertTypeEdit({"fieldId":"sert_type_id","controlId":id+"_sert_type","inLine":false});this.bindControl(ctrl,{"modelId":model_id,"valueFieldId":"sert_type_descr","keyFieldIds":["sert_type_id"]},{"valueFieldId":null,"keyFieldIds":["sert_type_id"]});cont.addElement(ctrl);cont_m.addElement(cont);this.addControl(cont_m);this.m_ctrlSave=new ButtonCmd(id+"btnSave",{"caption":"Записать","onClick":function(){self.onClickSave();},"attrs":{"title":"Записать"}});}
extend(ProductDialog_View,ViewDialog);ProductDialog_View.prototype.onGetData=function(resp){ClientDialog_View.superclass.onGetData.call(this,resp);var id=this.getDataControl("ProductList_View_gridEditView_id").control.getAttr("old_id");if(id){this.m_product1cNameList.setProductId(id);this.m_product1cNameList.m_grid.setEnabled(true);this.m_product1cNameList.m_grid.onRefresh();this.m_productWarehouseList.setProductId(id);this.m_productWarehouseList.m_grid.setEnabled(true);this.m_productWarehouseList.m_grid.onRefresh();this.m_productMeasureUnitList.setProductId(id);this.m_productMeasureUnitList.m_grid.setEnabled(true);this.m_productMeasureUnitList.m_grid.onRefresh();this.m_productCustomSizePriceList.setProductId(id);this.m_productCustomSizePriceList.m_grid.setEnabled(true);this.m_productCustomSizePriceList.m_grid.onRefresh();}} 
function MeasureUnitList_View(id,options){options=options||{};options.title="Единицы";MeasureUnitList_View.superclass.constructor.call(this,id,options);var controller=new MeasureUnit_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"MeasureUnitList_Model","editViewClass":MeasureUnitDialog_View,"editInline":false,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(MeasureUnitList_View,ViewList); 
function MeasureUnitDialog_View(id,options){options=options||{};MeasureUnitDialog_View.superclass.constructor.call(this,id,options);var model_id="MeasureUnitDialog_Model";this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id"}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":"25","size":10,"required":"required"},"labelCaption":"Наименование:","name":"name"}),{"modelId":model_id,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});this.addDataControl(new EditString(id+"_name_full",{"attrs":{"maxlength":"100","size":50,"disabled":"disabled"},"labelCaption":"Полное наименование:","name":"name_full"}),{"modelId":model_id,"valueFieldId":"name_full","keyFieldIds":null},{"valueFieldId":"name_full","keyFieldIds":null});this.addDataControl(new EditCheckBox(id+"_is_int",{"attrs":{},"labelCaption":"Только целое значение:","name":"is_int"}),{"modelId":model_id,"valueFieldId":"is_int","keyFieldIds":null},{"valueFieldId":"is_int","keyFieldIds":null});}
extend(MeasureUnitDialog_View,ViewDialog); 
function ProductMeasureUnitList_View(id,options){options=options||{};ProductMeasureUnitList_View.superclass.constructor.call(this,id,options);var controller=new ProductMeasureUnit_Controller(new ServConnector(HOST_NAME));var filter=new ListFilter();filter.addFilter("product_id",{"sign":"e","keyFieldIds":["product_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_product_id",{"readBind":{"valueFieldId":"product_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_measure_unit_id",{"readBind":{"valueFieldId":"measure_unit_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_measure_unit_descr",{"value":"Единица","readBind":{"valueFieldId":"measure_unit_descr"},"descrCol":true}));row.addElement(new GridDbHeadCellBool(id+"_col_in_use",{"value":"Используется","readBind":{"valueFieldId":"in_use"}}));row.addElement(new GridDbHeadCell(id+"_col_calc_formula",{"value":"Формула","readBind":{"valueFieldId":"calc_formula"}}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ProductMeasureUnit_Model","editViewClass":ProductMeasureUnitInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true,"noExport":true}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"noAutoRefresh":true,"methParams":{"product_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(ProductMeasureUnitList_View,ViewList);ProductMeasureUnitList_View.prototype.setProductId=function(id){this.m_grid.m_filter.m_params["product_id"].key=id;this.m_grid.m_methParams["product_id"]=id;this.m_grid.m_autoRefresh=true;} 
function ProductMeasureUnitInline_View(id,options){options=options||{};ProductMeasureUnitInline_View.superclass.constructor.call(this,id,options);var model_id="ProductMeasureUnit_Model";this.addDataControl(new Edit(id+"_product_id",{"name":"product_id","visible":false}),{"modelId":model_id,"valueFieldId":"product_id","keyFieldIds":null},{"valueFieldId":"product_id","keyFieldIds":null});this.addDataControl(new Edit(id+"_measure_unit_id",{"name":"measure_unit_id","visible":false}),{"modelId":model_id,"valueFieldId":"measure_unit_id","keyFieldIds":null},{"valueFieldId":"measure_unit_id","keyFieldIds":null});this.addDataControl(new Edit(id+"_measure_unit_descr",{"name":"measure_unit_descr","attrs":{"disabled":"disabled"}}),{"modelId":model_id,"valueFieldId":"measure_unit_descr","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new EditCheckBox(id+"_in_use",{"name":"in_use","alwaysUpdate":true}),{"modelId":model_id,"valueFieldId":"in_use","keyFieldIds":null},{"valueFieldId":"in_use","keyFieldIds":null});this.addDataControl(new EditString(id+"_calc_formula",{"attrs":{"maxlength":250,"size":50},"alwaysUpdate":true}),{"modelId":model_id,"valueFieldId":"calc_formula","keyFieldIds":null},{"valueFieldId":"calc_formula","keyFieldIds":null});}
extend(ProductMeasureUnitInline_View,ViewInlineGridEdit); 
function ProductCustomSizePriceList_View(id,options){options=options||{};ProductCustomSizePriceList_View.superclass.constructor.call(this,id,options);var controller=new ProductCustomSizePrice_Controller(new ServConnector(HOST_NAME));var filter=new ListFilter();filter.addFilter("product_id",{"sign":"e","keyFieldIds":["product_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_product_id",{"readBind":{"valueFieldId":"product_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_category",{"value":"Категория","readBind":{"valueFieldId":"category"},"keyCol":true,"descrCol":true,"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_quant",{"value":"При количестве больше","readBind":{"valueFieldId":"quant"},"colAttrs":{"align":"right"}}));row.addElement(new GridDbHeadCell(id+"_col_price",{"value":"Наценка, руб. за базовую единицу","readBind":{"valueFieldId":"price"},"colAttrs":{"align":"right"}}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ProductCustomSizePrice_Model","editViewClass":ProductCustomSizePriceInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true,"noExport":true}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"noAutoRefresh":true,"methParams":{"product_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(ProductCustomSizePriceList_View,ViewList);ProductCustomSizePriceList_View.prototype.setProductId=function(id){this.m_grid.m_filter.m_params["product_id"].key=id;this.m_grid.m_methParams["product_id"]=id;this.m_grid.m_autoRefresh=true;} 
function ProductCustomSizePriceInline_View(id,options){options=options||{};ProductCustomSizePriceInline_View.superclass.constructor.call(this,id,options);var model_id="ProductCustomSizePrice_Model";this.addDataControl(new Edit(id+"_product_id",{"name":"product_id","visible":false}),{"modelId":model_id,"valueFieldId":"product_id","keyFieldIds":null},{"valueFieldId":"product_id","keyFieldIds":null});this.addDataControl(new EditNum(id+"_category",{"name":"category","attrs":{"size":"5"}}),{"modelId":model_id,"valueFieldId":"category","keyFieldIds":null},{"valueFieldId":"category","keyFieldIds":null});this.addDataControl(new EditFloat(id+"_quant",{"attrs":{"maxlength":19,"size":5},"name":"quant"}),{"modelId":model_id,"valueFieldId":"quant","keyFieldIds":null},{"valueFieldId":"quant","keyFieldIds":null});this.addDataControl(new EditMoney(id+"_price",{"name":"price"}),{"modelId":model_id,"valueFieldId":"price","keyFieldIds":null},{"valueFieldId":"price","keyFieldIds":null});}
extend(ProductCustomSizePriceInline_View,ViewInlineGridEdit); 
function ProductWarehouseList_View(id,options){options=options||{};ProductWarehouseList_View.superclass.constructor.call(this,id,options);var controller=new ProductWarehouse_Controller(new ServConnector(HOST_NAME));var filter=new ListFilter();filter.addFilter("product_id",{"sign":"e","keyFieldIds":["product_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_product_id",{"readBind":{"valueFieldId":"product_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_warehouse_id",{"readBind":{"valueFieldId":"warehouse_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_warehouse_descr",{"value":"Наименование","readBind":{"valueFieldId":"warehouse_descr"},"descrCol":true}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ProductWarehouseList_Model","editViewClass":ProductWarehouseInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true,"noExport":true}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"noAutoRefresh":true,"methParams":{"product_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(ProductWarehouseList_View,ViewList);ProductWarehouseList_View.prototype.setProductId=function(id){this.m_grid.m_filter.m_params["product_id"].key=id;this.m_grid.m_methParams["product_id"]=id;this.m_grid.m_autoRefresh=true;} 
function Product1cNameList_View(id,options){options=options||{};options.title="Наименовния для 1с по организациям";options.viewContClassName="panel panel-default";Product1cNameList_View.superclass.constructor.call(this,id,options);var controller=new Product1cName_Controller(options.connect);var filter=new ListFilter();filter.addFilter("product_id",{"sign":"e","keyFieldIds":["product_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_product_id",{"readBind":{"valueFieldId":"product_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_firm_descr",{"value":"Фирма","readBind":{"valueFieldId":"firm_descr"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_name_for_1c",{"value":"Наименования для 1с","readBind":{"valueFieldId":"name_for_1c"},"descrCol":true}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readMethodId":"get_list","readModelId":"Product1cNameList_Model","editViewClass":Product1cNameInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid"}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":true,"methParams":{"product_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(Product1cNameList_View,ViewList);Product1cNameList_View.prototype.setProductId=function(id){console.log("setting product id="+id);this.m_grid.m_filter.m_params["product_id"].key=id;this.m_grid.m_methParams["product_id"]=id;this.m_grid.m_autoRefresh=true;} 
function Product1cNameInline_View(id,options){options=options||{};Product1cNameInline_View.superclass.constructor.call(this,id,options);var model_id="Product1cNameList_Model";this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id"}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new Edit(id+"_user_id",{"visible":false,"name":"product_id"}),{"modelId":model_id,"valueFieldId":"product_id","keyFieldIds":null},{"valueFieldId":"product_id","keyFieldIds":null});this.addDataControl(new FirmEditObject("firm_id",id+"_firm",true),{"modelId":model_id,"valueFieldId":"firm_descr","keyFieldIds":["firm_id"]},{"valueFieldId":null,"keyFieldIds":["firm_id"]});this.addDataControl(new EditString("name_for_1c",{"maxlength":"100"}),{"modelId":model_id,"valueFieldId":"name_for_1c","keyFieldIds":null},{"valueFieldId":"name_for_1c","keyFieldIds":null});}
extend(Product1cNameInline_View,ViewInlineGridEdit); 
function ProductWarehouseInline_View(id,options){options=options||{};ProductWarehouseInline_View.superclass.constructor.call(this,id,options);var model_id="ProductWarehouseList_Model";this.addDataControl(new Edit(id+"_product_id",{"name":"product_id","visible":false}),{"modelId":model_id,"valueFieldId":"product_id","keyFieldIds":null},{"valueFieldId":"product_id","keyFieldIds":null});this.addDataControl(new Edit(id+"_warehouse_id",{"name":"warehouse_id","visible":false}),{"modelId":model_id,"valueFieldId":"warehouse_id","keyFieldIds":null},{"valueFieldId":"warehouse_id","keyFieldIds":null});this.addDataControl(new WarehouseEditObject("product_warehouse_id",id+"product_warehouse",true),{"modelId":model_id,"valueFieldId":"warehouse_descr","keyFieldIds":["warehouse_id"]},{"valueFieldId":null,"keyFieldIds":["warehouse_id"]});}
extend(ProductWarehouseInline_View,ViewInlineGridEdit); 
function CustomerSurveyQuestionList_View(id,options){options=options||{};options.title="Список вопросов для опроса";CustomerSurveyQuestionList_View.superclass.constructor.call(this,id,options);var controller=new CustomerSurveyQuestion_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_question",{"value":"Вопрос","readBind":{"valueFieldId":"question"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_max_points",{"value":"Макс.кол-во баллов","readBind":{"valueFieldId":"max_points"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCellBool(id+"_col_in_use",{"value":"Активен","readBind":{"valueFieldId":"in_use"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"CustomerSurveyQuestion_Model","editViewClass":CustomerSurveyQuestionInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(CustomerSurveyQuestionList_View,ViewList); 
function CustomerSurveyQuestionInline_View(id,options){options=options||{};CustomerSurveyQuestionInline_View.superclass.constructor.call(this,id,options);var model_id="CustomerSurveyQuestion_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString(id+"_question",{"attrs":{"size":150,"required":"required"}}),{"modelId":model_id,"valueFieldId":"question","keyFieldIds":null},{"valueFieldId":"question","keyFieldIds":null});this.addDataControl(new EditNum(id+"_max_points",{"attrs":{"required":"required"}}),{"modelId":model_id,"valueFieldId":"max_points","keyFieldIds":null},{"valueFieldId":"max_points","keyFieldIds":null});this.addDataControl(new EditCheckBox(id+"_in_use",{}),{"modelId":model_id,"valueFieldId":"in_use","keyFieldIds":null},{"valueFieldId":"in_use","keyFieldIds":null});}
extend(CustomerSurveyQuestionInline_View,ViewInlineGridEdit); 
function ProductionStateList_View(id,options){options=options||{};options.title="Производственные этапы";ProductionStateList_View.superclass.constructor.call(this,id,options);var controller=new ProductionState_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_ord",{"value":"Код","readBind":{"valueFieldId":"ord"}}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ProductionState_Model","editViewClass":ProductionStateInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(ProductionStateList_View,ViewList); 
function ProductionStateInline_View(id,options){options=options||{};ProductionStateInline_View.superclass.constructor.call(this,id,options);var model_id="ProductionState_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditNum(id+"_ord",{"attrs":{"required":"required"}}),{"modelId":model_id,"valueFieldId":"ord","keyFieldIds":null},{"valueFieldId":"ord","keyFieldIds":null});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":100,"size":50,"required":"required"}}),{"modelId":model_id,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});}
extend(ProductionStateInline_View,ViewInlineGridEdit); 
function RepProductionLoad_View(id,options){options=options||{};options.controller=Report_Controller;options.methodId="production_load";options.viewId="ViewHTMLXSLT";options.connect=options.connect;options.reportControl=new Control(id+"_rep","div",{className:"panel panel-body"});RepProductionLoad_View.superclass.constructor.call(this,id,options);var period=new EditPeriodDate(id+"_period");period.getControlFrom().m_editContClassName="input-group "+get_bs_col()+"2";period.getControlTo().m_editContClassName="input-group "+get_bs_col()+"2";this.addFilterContainer([{"control":period.getControlFrom(),"filter":{"sign":"ge","valueFieldId":"delivery_plan_date"}},{"control":period.getControlTo(),"filter":{"sign":"le","valueFieldId":"delivery_plan_date"}},{"control":new EditList(id+"_warehouse_id",{"labelCaption":"Список складов:","editContClassName":"input-group "+get_bs_col()+"3","editViewControl":new WarehouseEditObject("warehouse_id","warehouse",true,null,{"attrs":{"required":"required"}})}),"filter":{"sign":"incl","valueFieldId":["warehouse_id"]}}]);this.addCmdMakeReport();this.addCmdPrint();}
extend(RepProductionLoad_View,PPViewReport);RepProductionLoad_View.prototype.addExtraParams=function(struc){RepProductionLoad_View.superclass.addExtraParams.call(this,struc);struc.templ="RepProductionLoad";} 
function RepClientDebts_View(id,options){options=options||{};options.controller=Report_Controller;options.methodId="client_debts";options.viewId="ViewHTMLXSLT";options.connect=options.connect;options.reportControl=new Control(id+"_rep","div",{className:"panel panel-body"});RepClientDebts_View.superclass.constructor.call(this,id,options);this.addFilterContainer([{"control":new EditList(id+"_firm_id_list",{"labelCaption":"Список фирм:","editContClassName":"input-group "+get_bs_col()+"3","editViewControl":new FirmEditObject("firm_id","firm",true,null,{"attrs":{"required":"required"}})}),"filter":{"sign":"any","valueFieldId":["firm_id"]}},{"control":new EditList(id+"_client_id_list",{"labelCaption":"Список клиентов:","editContClassName":"input-group "+get_bs_col()+"3","editViewControl":new ClientEditObject("client_id","client",true,{"attrs":{"required":"required"}})}),"filter":{"sign":"any","valueFieldId":["client_id"]}}]);this.addCmdMakeReport();this.addCmdExcel();this.addCmdPrint();}
extend(RepClientDebts_View,PPViewReport);RepClientDebts_View.prototype.addExtraParams=function(struc){RepClientDebts_View.superclass.addExtraParams.call(this,struc);struc.templ="RepClientDebts";} 
function RepPriceListTuning_View(id,options){options=options||{};options.controller=ClientPriceList_Controller;options.methodId="tune";options.viewId="ViewHTMLXSLT";options.connect=options.connect;options.reportControl=new Control(id+"_rep","div");RepPriceListTuning_View.superclass.constructor.call(this,id,options);var ctrl=new EditSelect(id+"_to_third_party_only",{labelCaption:"Для третьих лиц:"});ctrl.addElement(new EditSelectOption(id+"_to_third_party_only_null",{optionDescr:"для всех",optionId:"null",optionSelected:true}));ctrl.addElement(new EditSelectOption(id+"_to_third_party_only_true",{optionDescr:"только для третьих лиц",optionId:"true",optionSelected:false}));ctrl.addElement(new EditSelectOption(id+"_to_third_party_only_false",{optionDescr:"только не для третьих лиц",optionId:"false",optionSelected:false}));this.addFilterContainer([{"control":new ProductionCityEditObject("production_city_id",id+"_production_city",false),"filter":{"sign":"e","keyFieldIds":["production_city_id"]}},{"control":ctrl,"filter":{"sign":"e","valueFieldId":"to_third_party_only"}}]);this.addCmdMakeReport();this.addCmdExcel();var self=this;this.m_commandPanel.addElement(new ButtonCmd(id+"_btn_close",{"caption":"Закрыть","onClick":function(){self.getOnClose().call(this,1);}}));}
extend(RepPriceListTuning_View,ViewReport);RepPriceListTuning_View.prototype.addExtraParams=function(struc){struc.templ="RepPriceListTuning";}
RepPriceListTuning_View.prototype.makeReport=function(){RepPriceListTuning_View.superclass.makeReport.call(this,false);if(this.m_repResultOk){(new EditMoney("change_price_value",{"winObj":this.m_winObj,"attrs":{"value":"0"},"title":"изменить цену на данное значение"})).toDOM();(new ButtonCtrl("change_price_inc",{"winObj":this.m_winObj,"glyph":"glyphicon-plus","title":"увеличить","onClick":function(){self.changePrices(1);}})).toDOM();(new ButtonCtrl("change_price_dec",{"winObj":this.m_winObj,"glyph":"glyphicon-minus","title":"уменьшить","onClick":function(){self.changePrices(-1);}})).toDOM();var self=this;(new EditCheckBox("chb_h_price_name",{"winObj":this.m_winObj,"title":"отметить все прайсы","events":{"onChange":function(elem){var chb=DOMHandler.getElementsByAttr("chb_price_name",self.m_reportControl.m_node,"class",false);for(var i=0;i<chb.length;i++){chb[i].checked=elem.checked;var chb2=DOMHandler.getElementsByAttr("chb_price_val_price_"+chb[i].getAttribute("priceId"),self.m_reportControl.m_node,"class",false);for(var i=0;i<chb2.length;i++){chb2[i].checked=elem.checked;}}}}})).toDOM();var controls=DOMHandler.getElementsByAttr("chb_price_name",this.m_reportControl.m_node,"class",false);for(var i=0;i<controls.length;i++){(new EditCheckBox(controls[i].id,{"attrs":{"class":"chb_price_name","priceId":controls[i].getAttribute("priceId")},"winObj":this.m_winObj,"title":"отметить все цены по прайсу","events":{"onChange":function(elem){var chb=DOMHandler.getElementsByAttr("chb_price_val_price_"+elem.getAttribute("priceId"),self.m_reportControl.m_node,"class",false);for(var i=0;i<chb.length;i++){chb[i].checked=elem.checked;}}}})).toDOM();}
var controls=DOMHandler.getElementsByAttr("chb_product_descr",this.m_reportControl.m_node,"class",false);for(var i=0;i<controls.length;i++){(new EditCheckBox(controls[i].id,{"attrs":{"class":"chb_product_descr","productId":controls[i].getAttribute("productId")},"winObj":this.m_winObj,"title":"отметить всю продукцию","events":{"onChange":function(elem){var chb=DOMHandler.getElementsByAttr("chb_price_val_prod_"+elem.getAttribute("productId"),self.m_reportControl.m_node,"class",false);for(var i=0;i<chb.length;i++){chb[i].checked=elem.checked;}}}})).toDOM();}
var controls=DOMHandler.getElementsByAttr("chb_price_val",this.m_reportControl.m_node,"class",false);for(var i=0;i<controls.length;i++){(new EditCheckBox(controls[i].id,{"className":"chb_price_val chb_price_val_prod_"+controls[i].getAttribute("productId")+" "+"chb_price_val_price_"+controls[i].getAttribute("priceId"),"winObj":this.m_winObj,"title":"отметить для изменения"})).toDOM();}
(new ButtonCmd("change_price_update",{"winObj":this.m_winObj,"caption":"Записать","title":"сохранить измененные цены","onClick":function(){var vals="";var price_ids="";var product_ids="";var c=DOMHandler.getElementsByAttr("price_changed",self.m_reportControl.m_node,"class",false);for(var i=0;i<c.length;i++){v=c[i].getElementsByTagName("span");if(v&&v.length){var val_n=v[0].childNodes[0];vals+=(vals=="")?"":",";vals+=val_n.nodeValue;price_ids+=(price_ids=="")?"":",";price_ids+=v[0].getAttribute("priceId");product_ids+=(product_ids=="")?"":",";product_ids+=v[0].getAttribute("productId");}}
if(vals.length){var contr=new ClientPriceListProduct_Controller(new ServConnector(HOST_NAME));contr.run("set_values",{"async":true,"func":function(){var c=DOMHandler.getElementsByAttr("price_changed",self.m_reportControl.m_node,"class",false);for(var i=0;i<c.length;i++){DOMHandler.removeClass(c[i],"price_changed");}},"cont":this,"params":{"product_ids":product_ids,"price_list_ids":price_ids,"vals":vals}});}}})).toDOM();}}
RepPriceListTuning_View.prototype.changePrices=function(sign){var price_change=nd("change_price_value").value;price_change.replace(".00","");price_change=parseFloat(price_change);if(price_change){var chb=DOMHandler.getElementsByAttr("chb_price_val",this.m_reportControl.m_node,"class",false);for(var i=0;i<chb.length;i++){if(chb[i].checked){var v=chb[i].parentNode.getElementsByTagName("span");if(v&&v.length){var val_n=v[0].childNodes[0];var val=val_n.nodeValue.replace(".00","");val_n.nodeValue=(parseFloat(val)+price_change*sign).toFixed(2);if(v[0].getAttribute("oldVal")!=val_n.nodeValue){DOMHandler.addClass(chb[i].parentNode,"price_changed");}
else{DOMHandler.removeClass(chb[i].parentNode,"price_changed");}}}}}}
RepPriceListTuning_View.prototype.toDOM=function(parent){this.m_cont=new ControlContainer(this.getId()+"_panel","div",{"className":"panel"});this.m_cont.toDOM(parent);RepPriceListTuning_View.superclass.toDOM.call(this,this.m_cont.m_node);}
RepPriceListTuning_View.prototype.removeDOM=function(){RepPriceListTuning_View.superclass.removeDOM.call(this);this.m_cont.removeDOM();} 
function PayOrderList_View(id,options){options=options||{};options.title="Оплата счетов";PayOrderList_View.superclass.constructor.call(this,id,options);var controller=new DOCOrder_Controller(new ServConnector(HOST_NAME));var filter=new GridFilter(id+"_filter");var period=new EditPeriodQuater(id+"_period");filter.addFilterControl(period.getControlFrom(),{"sign":"ge","valueFieldId":"date_time"});filter.addFilterControl(period.getControlTo(),{"sign":"le","valueFieldId":"date_time"});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"value":"Код","readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_number",{"value":"Счет №","readBind":{"valueFieldId":"number"},"colAttrs":{"align":"center"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_date_time_descr",{"value":"Дата","readBind":{"valueFieldId":"date_time_descr"},"colAttrs":{"align":"center"},"sortable":true,"sort":"asc","sortCol":"date_time"}));row.addElement(new GridDbHeadCell(id+"_col_total_descr",{"value":"Сумма","readBind":{"valueFieldId":"total_descr"},"colAttrs":{"align":"right"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_firm_descr",{"value":"Организация","readBind":{"valueFieldId":"firm_descr"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_firm_id",{"readBind":{"valueFieldId":"firm_id"},"sortable":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_state_descr",{"value":"Статус","readBind":{"valueFieldId":"state_descr"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_state",{"readBind":{"valueFieldId":"state"},"visible":false,"fieldValueToRowClass":true}));head.addElement(row);var cont=new ControlContainer(this.getId()+"_panel","div",{"className":"panel"});cont.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"PayOrderList_Model","readMethodId":"pay_orders_list","editViewClass":null,"editInline":null,"pagination":new GridPagination(id+"_page",{"countPerPage":CONSTANT_VALS.grid_rows_per_page_count}),"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noInsert":true,"noEdit":true,"noDelete":true,"noCopy":true}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"asyncEditRead":false}));this.addElement(cont);}
extend(PayOrderList_View,ViewList); 
function RepClientBalance_View(id,options){options=options||{};options.noOk=true;options.noCancel=true;RepClientBalance_View.superclass.constructor.call(this,id,options);var cont=new ControlContainer(id+"_cont","fieldset");var model_id="_Model";this.m_periodCtrl=new PeriodFilter(id+"_period",{"period":"quater","valueFieldId":"date"});cont.addElement(this.m_periodCtrl);var bs_col=get_bs_col();this.m_firmCtrl=new FirmEditObject("firm_id",id+"_firm",false,null,{"attrs":{"required":"required"},"editContClassName":"input-group "+bs_col+"2","labelClassName":"control-label "+bs_col+"1"});cont.addElement(this.m_firmCtrl,{"modelId":model_id,"valueFieldId":"firm_id","keyFieldIds":null},{"valueFieldId":"firm_id","keyFieldIds":null});var self=this;cont.addElement(new ButtonCmd(id+"_submit",{"caption":"Акт сверки (pdf)","onClick":function(){self.submit("pdf");},"attrs":{"title":"сформировать акт сверки в формате pdf"}}));cont.addElement(new ButtonCmd(id+"_submit_xls",{"caption":"Акт сверки (excel)","onClick":function(){self.submit("xls");},"attrs":{"title":"сформировать акт сверки в формате excel"}}));this.addControl(cont);}
extend(RepClientBalance_View,ViewDialog);RepClientBalance_View.prototype.submit=function(file_type){this.m_firmCtrl.setComment("");this.getErrorControl().setValue("");var firm_id=this.m_firmCtrl.getFieldValue();if(!firm_id||firm_id=="undefined"){this.m_firmCtrl.setComment("Не выбрана фирма!");this.getErrorControl().setValue("Не выбрана фирма!");return;}
var contr=new Report_Controller(new ServConnector(HOST_NAME));var meth_id="client_balance";var checkRes={incorrect_vals:false,modif:false};var pm=contr.getPublicMethodById(meth_id);this.setMethodParams(pm,checkRes);pm.setParamValue("firm_id",firm_id);pm.setParamValue("date_from",DateHandler.dateToStr(this.m_periodCtrl.getDateFrom(),"dd/mm/y"));pm.setParamValue("date_to",DateHandler.dateToStr(this.m_periodCtrl.getDateTo(),"dd/mm/y"));pm.setParamValue("file_type",file_type);if(!checkRes.incorrect_vals){if(file_type=="pdf"){window.open(HOST_NAME+"index.php?"+contr.getQueryString(pm),"_blank","location=0,menubar=0,status=0,titlebar=0");}
else{top.location.href=HOST_NAME+"index.php?"+contr.getQueryString(pm);}}
else if(checkRes.incorrect_vals){}
else if(!checkRes.modif){this.onWriteOk();}} 
function PaySchedule_View(id,options){options=options||{};options.title="График платежей";options.controller=Payment_Controller;options.methodId="get_schedule";options.viewId="ClientPaySchedule";options.connect=options.connect;options.reportControl=new Control("PaySchedule","div");PaySchedule_View.superclass.constructor.call(this,id,options);this.m_waitControl=new WaitControl(id+"_wait");this.m_filter=null;this.makeReport(true);}
extend(PaySchedule_View,ViewReport);PaySchedule_View.prototype.toDOM=function(parent){this.m_cont=new ControlContainer(this.getId()+"_panel","div",{"className":"panel"});this.m_cont.toDOM(parent);PaySchedule_View.superclass.toDOM.call(this,this.m_cont.m_node);}
PaySchedule_View.prototype.removeDOM=function(){PaySchedule_View.superclass.removeDOM.call(this);this.m_cont.removeDOM();} 
function PayDefDebt_View(id,options){options=options||{};options.title="Просроченная задолженность";options.controller=Payment_Controller;options.methodId="get_def_debt_details";options.viewId="ClientDefDebt";options.connect=options.connect;options.reportControl=new Control("PayDefDebt","div");PayDefDebt_View.superclass.constructor.call(this,id,options);this.m_waitControl=new WaitControl(id+"_wait");this.m_filter=null;this.makeReport(true);}
extend(PayDefDebt_View,ViewReport);PayDefDebt_View.prototype.toDOM=function(parent){this.m_cont=new ControlContainer(this.getId()+"_panel","div",{"className":"panel"});this.m_cont.toDOM(parent);PayDefDebt_View.superclass.toDOM.call(this,this.m_cont.m_node);}
PayDefDebt_View.prototype.removeDOM=function(){PayDefDebt_View.superclass.removeDOM.call(this);this.m_cont.removeDOM();} 
function DelivAssignedOrderList_View(id,options){options=options||{};options.title="Распределение доставок";DelivAssignedOrderList_View.superclass.constructor.call(this,id,options);var controller=new Delivery_Controller(new ServConnector(HOST_NAME));this.m_grid=new DelivAssignedOrderGridDb(id+"_grid",{"head":new GridHead(),"body":new GridBody(),"controller":controller,"readMethodId":"assigned_orders_list","readModelId":"assigned_orders_list","editViewClass":null,"editInline":null,"pagination":null,"commandPanel":(SERV_VARS.ROLE_ID=="client")?null:new DelivAssignedOrderGridCommands(id+"_cmd",{"controller":controller}),"rowCommandPanelClass":null,"filter":options.filter,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj});this.m_grid.SELECTED_CLASS="selected_veh";this.addElement(this.m_grid);}
extend(DelivAssignedOrderList_View,ViewList); 
function DelivAssignedOrderForClient_View(id,options){options=options||{};options.title="Доставки клиента";DelivAssignedOrderForClient_View.superclass.constructor.call(this,id,options);var controller=new Delivery_Controller(new ServConnector(HOST_NAME));var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_order_id",{"readBind":{"valueFieldId":"order_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_order_descr",{"value":"Документ","readBind":{"valueFieldId":"order_descr"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_vh_descr",{"value":"ТС","readBind":{"valueFieldId":"vh_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_driver_descr",{"value":"Водитель","readBind":{"valueFieldId":"driver_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_deliv_hour_descr",{"value":"Время доставки","readBind":{"valueFieldId":"deliv_hour_descr"}}));head.addElement(row);this.m_grid=new DelivAssignedOrderForClientGridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readMethodId":"assigned_orders_for_client","readModelId":"assigned_orders_for_client","editViewClass":null,"editInline":null,"pagination":null,"commandPanel":null,"rowCommandPanelClass":null,"filter":options.filter,"refreshInterval":2*60*1000,"onSelect":options.onSelect,"winObj":options.winObj,"asyncEditRead":false,"noAutoRefresh":true});this.addElement(this.m_grid);}
extend(DelivAssignedOrderForClient_View,ViewList);function DelivAssignedOrderForClientGridDb(id,options){options=options||{};DelivAssignedOrderForClientGridDb.superclass.constructor.call(this,id,options);}
extend(DelivAssignedOrderForClientGridDb,GridDbDOC);DelivAssignedOrderForClientGridDb.prototype.onGetData=function(resp){DelivAssignedOrderForClientGridDb.superclass.onGetData.call(this,resp);this.m_autoRefresh=true;var n=this.getNode();var td=n.getElementsByTagName("td");if(td.length&&!this.m_deliveryView.m_map){this.m_deliveryView.addMap();this.m_deliveryView.m_mapCont.toDOM(this.m_deliveryView.getNode());}
else if(!td.length&&this.m_deliveryView.m_map){this.m_deliveryView.m_mapCont.removeDOM();delete this.m_deliveryView.m_map;}}
DelivAssignedOrderForClientGridDb.prototype.selectRow=function(newRow,oldRow){DelivAssignedOrderForClientGridDb.superclass.selectRow.call(this,newRow,oldRow);if(this.m_selectedRowKeys&&this.m_deliveryView.m_map){var id=json2obj(this.m_selectedRowKeys).id;this.m_deliveryView.m_map.setCurVehicleId(id);}} 
function DelivUnassignedOrderList_View(id,options){options=options||{};options.title="Нераспределенные доставки";DelivUnassignedOrderList_View.superclass.constructor.call(this,id,options);var self=this;this.m_fastFilter=new GridFastFilter(id+"_fast_filter",{"tagName":"div","noSetControl":true,"noUnsetControl":true,"noToggleControl":true,"className":"row"});this.m_allOrdersCtrl=new EditRadioGroup(id+"_filter_all_orders",{"className":get_bs_col()+"3","elements":[new EditRadio("all_orders:current",{"descr":"Текущие","value":"0","name":"all_orders","contClassName":get_bs_col()+"6","editContClassName":"input-group "+get_bs_col()+"1","labelClassName":get_bs_col()+"8","events":{"click":function(){self.m_fastFilter.refresh();}},"attrs":{"checked":"checked","initValue":"checked"}}),new EditRadio("current_all:all",{"descr":"Все","value":"1","name":"all_orders","contClassName":get_bs_col()+"6","editContClassName":"input-group "+get_bs_col()+"1","labelClassName":get_bs_col()+"8","events":{"click":function(){self.m_fastFilter.refresh();}},"attrs":{"initValue":"false"}})]});this.m_fastFilter.addFilterControl(this.m_allOrdersCtrl,{});this.m_fastFilter.addFilterControl(new EditString(id+"_fast_filter_number",{"labelCaption":"№:","contClassName":get_bs_col()+"2","winObj":this.m_winObj,"tableLayout":false}),{"sign":"lk","valueFieldId":"number","r_wcards":true});this.m_fastFilter.addFilterControl(new EditString(id+"_fast_filter_client_descr",{"labelCaption":"Клиент:","contClassName":get_bs_col()+"3"}),{"sign":"lk","valueFieldId":"client_descr","r_wcards":"1","l_wcards":"1","icase":"1"});this.m_fastFilter.addFilterControl(new EditDate(id+"_fast_filter_delivery_plan_date",{"labelCaption":"Дата вып.:","noClear":false,"editContClassName":"input-group "+get_bs_col()+"8","contClassName":get_bs_col()+"3","labelClassName":get_bs_col()+"4","enabled":false,"onSelected":function(){self.m_fastFilter.refresh();}}),{"sign":"e","valueFieldId":"delivery_plan_date"});this.addElement(this.m_fastFilter);var controller=new Delivery_Controller(new ServConnector(HOST_NAME));var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_number",{"value":"№","colAttrs":{"align":"center"},"readBind":{"valueFieldId":"number"}}));row.addElement(new GridDbHeadCell(id+"_col_delivery_plan_date_descr",{"value":"Дата","readBind":{"valueFieldId":"delivery_plan_date_descr"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_client_descr",{"value":"Клиент","readBind":{"valueFieldId":"client_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_warehouse_descr",{"value":"Место загрузки","readBind":{"valueFieldId":"warehouse_descr","sortable":true}}));row.addElement(new GridDbHeadCell(id+"_col_client_dest_descr",{"value":"Адрес доставки","readBind":{"valueFieldId":"client_dest_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_product_str",{"value":"Продукция","readBind":{"valueFieldId":"product_str"}}));row.addElement(new GridDbHeadCell(id+"_col_total_volume",{"value":"V,m3","readBind":{"valueFieldId":"total_volume"},"colAttrs":{"align":"right"}}));row.addElement(new GridDbHeadCell(id+"_col_total_weight",{"value":"m,т.","readBind":{"valueFieldId":"total_weight"},"colAttrs":{"align":"right"}}));head.addElement(row);this.m_grid=new DelivUnassignedOrderGridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readMethodId":"unassigned_orders_list","readModelId":"UnassignedOrderList_Model","editViewClass":null,"editInline":null,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noInsert":true,"noEdit":true,"noDelete":true,"noPrint":true,"noCopy":true}),"rowCommandPanelClass":null,"filter":options.filter,"refreshInterval":CONSTANT_VALS.db_controls_refresh_sec*1000,"onSelect":options.onSelect,"winObj":options.winObj,"filterAllOrders":this.m_filterAllOrders});this.m_grid.toDOM=function(parent){GridDb.superclass.toDOM.call(this,parent);var self=this;this.m_dropTarget=new DropTarget(this.m_node);this.m_dropTarget.accept=function(dragObject){this.onLeave();dragObject.hide();var vh_vm=toFloat(DOMHandler.getAttr(dragObject.element,"vol"));var vh_wt=toFloat(DOMHandler.getAttr(dragObject.element,"wt"));var td=DOMHandler.getParentByTagName(dragObject.element,"td");var cur_per_vm=toFloat(DOMHandler.getAttr(td,"totvol"));var cur_per_wt=toFloat(DOMHandler.getAttr(td,"totwt"));cur_per_vm=cur_per_vm-vh_vm;cur_per_wt=cur_per_wt-vh_wt;var per_perc_v=Math.round(cur_per_vm/vh_vm*100);var per_perc_w=Math.round(cur_per_wt/vh_wt*100);var per_perc=(per_perc_v>per_perc_w)?per_perc_v:per_perc_w;DOMHandler.setAttr(td,"totvol",cur_per_vm);DOMHandler.setAttr(td,"totwt",cur_per_wt);DOMHandler.setAttr(td,"load_percent_css",Math.round(per_perc/10)*10);var contr=new Delivery_Controller(new ServConnector(HOST_NAME));var meth_id="remove_order";var meth=contr.getPublicMethodById(meth_id);meth.setParamValue("order_id",dragObject.getFieldValue("id"));contr.run(meth_id,{"async":true,"func":function(resp){self.onRefresh();}});}}
this.m_grid.m_filterComplete=function(struc){if(self.m_allOrdersCtrl.getValue()=="1"){struc.fields=null;struc.signs=null;struc.vals=null;struc.icase=null;struc.field_sep="@";}
self.m_fastFilter.getParams(struc);}
this.m_fastFilter.setOnRefresh(this.m_grid.onRefresh);this.m_fastFilter.setClickContext(this.m_grid);this.addElement(this.m_grid);}
extend(DelivUnassignedOrderList_View,ViewList); 
function DeliveryMap_View(id,options){options=options||{};options.noOk=true;options.noCancel=true;DeliveryMap_View.superclass.constructor.call(this,id,options);this.m_controller=new Delivery_Controller(new ServConnector(HOST_NAME));this.addMapControl();this.m_winObj=options.winObj;}
extend(DeliveryMap_View,Map_View);DeliveryMap_View.prototype.m_curVehicleId;DeliveryMap_View.prototype.m_filter;DeliveryMap_View.prototype.setCurVehicleId=function(curVehicleId){this.m_curVehicleId=curVehicleId;this.m_vehicles.setCurrentObj(this.m_curVehicleId,TRACK_CONSTANTS.FOUND_ZOOM);}
DeliveryMap_View.prototype.refreshData=function(){var self=this;var meth;var params={};if(SERV_VARS.ROLE_ID=="client"){meth="current_position_client";params.date=DateHandler.dateToStr(new Date(),"dd/mm/yy");}
else{meth="current_position_all";}
this.m_controller.run(meth,{"params":params,"func":function(resp){self.onGetPosData(resp);}});}
DeliveryMap_View.prototype.toDOM=function(parent){DeliveryMap_View.superclass.toDOM.call(this,parent);this.m_vehicles=new VehicleLayer(this.m_map);this.m_vehicles.moveMapToCoords(NMEAStrToDegree(CONSTANT_VALS.map_default_lon),NMEAStrToDegree(CONSTANT_VALS.map_default_lat),TRACK_CONSTANTS.INI_ZOOM);this.refreshData();}
DeliveryMap_View.prototype.removeDOM=function(parent){if(this.m_interval){clearInterval(this.m_interval);this.m_interval=null;}
this.map_control.removeDOM();DeliveryMap_View.superclass.removeDOM.call(this,parent);}
DeliveryMap_View.prototype.onGetPosData=function(resp){var model=resp.getModelById("current_position_all",true);var id,marker;while(model.getNextRow()){marker=new MapCarMarker(model.getRow());marker.image=TRACK_CONSTANTS.IMG_PATH+TRACK_CONSTANTS.POINTER_IMGS[this.CURRENT_THEME];marker.imageScale=0.8;marker.imageRotate=true;this.m_vehicles.removeVehicle(marker.id);if(marker.period){this.m_vehicles.addVehicle(marker,null,false,false);}}
if(this.m_curVehicleId){this.m_vehicles.setCurrentObj(this.m_curVehicleId);}
if(!this.m_interval){var self=this;this.m_interval=setInterval(function(){self.refreshData();},5*1000);}} 
function DriverList_View(id,options){options=options||{};DriverList_View.superclass.constructor.call(this,id,options);var controller=new Driver_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"ФИО","readBind":{"valueFieldId":"name"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_drive_perm",{"value":"Вод.удост.","readBind":{"valueFieldId":"drive_perm"}}));row.addElement(new GridDbHeadCell(id+"_col_cel_phone",{"value":"Телефон","readBind":{"valueFieldId":"cel_phone"}}));row.addElement(new GridDbHeadCellBool(id+"_col_match_1c",{"value":"Соотв.1с","readBind":{"valueFieldId":"match_1c"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"DriverList_Model","editViewClass":DriverInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj,"extraFields":["match_1c"]}));}
extend(DriverList_View,ViewList);DriverList_View.prototype.getFormWidth=function(){return"1250";}
DriverList_View.prototype.getFormHeight=function(){return"600";} 
function DriverInline_View(id,options){options=options||{};DriverInline_View.superclass.constructor.call(this,id,options);var model="DriverList_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":100,"size":50,"required":"required"},"alwaysUpdate":true}),{"modelId":model,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});this.addDataControl(new EditString(id+"_drive_perm",{"attrs":{"maxlength":10,"size":5}}),{"modelId":model,"valueFieldId":"drive_perm","keyFieldIds":null},{"valueFieldId":"drive_perm","keyFieldIds":null});this.addDataControl(new EditCellPhone(id+"_cel_phone"),{"modelId":model,"valueFieldId":"cel_phone","keyFieldIds":null},{"valueFieldId":"cel_phone","keyFieldIds":null});this.addDataControl(new Control(id+"_cel_match_1c","div"),{"modelId":model,"valueFieldId":null,"keyFieldIds":null},{});}
extend(DriverInline_View,ViewInlineGridEdit); 
function CarrierList_View(id,options){options=options||{};CarrierList_View.superclass.constructor.call(this,id,options);var controller=new Carrier_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_client_id",{"readBind":{"valueFieldId":"client_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_client_descr",{"value":"Реквизиты","readBind":{"valueFieldId":"client_descr"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"CarrierList_Model","editViewClass":CarrierInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(CarrierList_View,ViewList); 
function CarrierInline_View(id,options){options=options||{};CarrierInline_View.superclass.constructor.call(this,id,options);var model="CarrierList_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":100,"size":50,"required":"required"}}),{"modelId":model,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});this.addDataControl(new Edit(id+"_client_id",{"name":"client_id","visible":false}),{"modelId":model,"valueFieldId":"client_id","keyFieldIds":null},{"valueFieldId":"client_id","keyFieldIds":null});this.addDataControl(new ClientEditObject("client_id",id+"_client",true),{"modelId":model,"valueFieldId":"client_descr","keyFieldIds":["client_id"]},{"valueFieldId":null,"keyFieldIds":["client_id"]});}
extend(CarrierInline_View,ViewInlineGridEdit); 
function TTNAttrPair_View(id,options){options=options||{};TTNAttrPair_View.superclass.constructor.call(this,id,options);var controller=new TTNAttrPair_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_firm",{"readBind":{"valueFieldId":"firm_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_firm_descr",{"value":"Фирма","readBind":{"valueFieldId":"firm_descr"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_warehouse",{"readBind":{"valueFieldId":"warehouse_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_warehouse_descr",{"value":"Склад","readBind":{"valueFieldId":"warehouse_descr"},"descrCol":true}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"TTNAttrPairList_Model","editViewClass":TTNAttrPairInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(TTNAttrPair_View,ViewList); 
function TTNAttrPairInline_View(id,options){options=options||{};CarrierInline_View.superclass.constructor.call(this,id,options);var model_id="TTNAttrPairList_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new Edit(id+"_firm_id",{"name":"firm_id","visible":false}),{"modelId":model_id,"valueFieldId":"firm_id","keyFieldIds":null},{"valueFieldId":"firm_id","keyFieldIds":null});this.addDataControl(new FirmEditObject("ttn_pair_firm_id",id+"ttn_pair_firm",true),{"modelId":model_id,"valueFieldId":"firm_descr","keyFieldIds":["firm_id"]},{"valueFieldId":null,"keyFieldIds":["firm_id"]});this.addDataControl(new Edit(id+"_warehouse_id",{"name":"warehouse_id","visible":false}),{"modelId":model_id,"valueFieldId":"warehouse_id","keyFieldIds":null},{"valueFieldId":"warehouse_id","keyFieldIds":null});this.addDataControl(new WarehouseEditObject("ttn_pair_warehouse_id",id+"ttn_pair_warehouse",true),{"modelId":model_id,"valueFieldId":"warehouse_descr","keyFieldIds":["warehouse_id"]},{"valueFieldId":null,"keyFieldIds":["warehouse_id"]});}
extend(TTNAttrPairInline_View,ViewInlineGridEdit); 
function CarrierOrder_View(id,options){options=options||{};CarrierOrder_View.superclass.constructor.call(this,id,options);var controller=new CarrierOrder_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_carrier",{"readBind":{"valueFieldId":"carrier_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_carrier_descr",{"value":"Перевозчик","readBind":{"valueFieldId":"carrier_descr"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_driver",{"readBind":{"valueFieldId":"driver_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_driver_descr",{"value":"Водитель","readBind":{"valueFieldId":"driver_descr"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_vehicle",{"readBind":{"valueFieldId":"vehicle_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_vehicle_descr",{"value":"ТС","readBind":{"valueFieldId":"vehicle_descr"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_ord",{"value":"Порядок","readBind":{"valueFieldId":"ord"}}));head.addElement(row);var gr=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"CarrierOrderList_Model","editViewClass":CarrierOrderInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj,});gr.onGetDataSetRowClass=function(m,cl){if(m.getFieldValue("today_ord")=="true"){return"todayOrd";}}
this.addElement(gr);}
extend(CarrierOrder_View,ViewList); 
function CarrierOrderInline_View(id,options){options=options||{};CarrierInline_View.superclass.constructor.call(this,id,options);var model_id="CarrierOrderList_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new Edit(id+"_carrier_id",{"name":"carrier_id","visible":false}),{"modelId":model_id,"valueFieldId":"carrier_id","keyFieldIds":null},{"valueFieldId":"carrier_id","keyFieldIds":null});this.addDataControl(new CarrierEditObject("carrier",id+"_carrier",true),{"modelId":model_id,"valueFieldId":"carrier_descr","keyFieldIds":["carrier_id"]},{"valueFieldId":null,"keyFieldIds":["carrier_id"]});this.addDataControl(new Edit(id+"_driver_id",{"name":"driver_id","visible":false}),{"modelId":model_id,"valueFieldId":"driver_id","keyFieldIds":null},{"valueFieldId":"driver_id","keyFieldIds":null});this.addDataControl(new DriverEditObject("driver_id",id+"_driver",true),{"modelId":model_id,"valueFieldId":"driver_descr","keyFieldIds":["driver_id"]},{"valueFieldId":null,"keyFieldIds":["driver_id"]});this.addDataControl(new Edit(id+"_vehicle_id",{"name":"vehicle_id","visible":false}),{"modelId":model_id,"valueFieldId":"vehicle_id","keyFieldIds":null},{"valueFieldId":"vehicle_id","keyFieldIds":null});this.addDataControl(new VehicleEditObject({fieldId:"vehicle_id",controlId:id+"_vehicle",inLine:true}),{"modelId":model_id,"valueFieldId":"vehicle_descr","keyFieldIds":["vehicle_id"]},{"valueFieldId":null,"keyFieldIds":["vehicle_id"]});this.addDataControl(new EditNum(id+"_ord",{"name":"ord"}),{"modelId":model_id,"valueFieldId":"ord","keyFieldIds":null},{"valueFieldId":"ord","keyFieldIds":null});}
extend(CarrierOrderInline_View,ViewInlineGridEdit); 
function VehicleList_View(id,options){options=options||{};VehicleList_View.superclass.constructor.call(this,id,options);this.m_fastFilter=new GridFastFilter(id+"_fast_filter",{"tagName":"div","noSetControl":true,"noUnsetControl":true,"noToggleControl":true,"className":"row"});this.m_fastFilter.addFilterControl(new EditString(id+"_fast_filter_descr",{"labelCaption":"Водитель:","contClassName":get_bs_col()+"4"}),{"sign":"lk","valueFieldId":"driver_descr","r_wcards":"1","l_wcards":"1","icase":"1"});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_driver_descr",{"value":"Водитель","readBind":{"valueFieldId":"driver_descr"},"sortable":true,"sort":"asc"}));row.addElement(new GridDbHeadCell(id+"_col_plate",{"value":"Гос.номер","readBind":{"valueFieldId":"plate"},"descrCol":true,"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_vl_wt",{"value":"V/M","readBind":{"valueFieldId":"vl_wt"}}));row.addElement(new GridDbHeadCell(id+"_col_production_city_descr",{"value":"Город","readBind":{"valueFieldId":"production_city_descr","sortable":true}}));row.addElement(new GridDbHeadCellBool(id+"_col_employed",{"value":"Пост.","readBind":{"valueFieldId":"employed","sortable":true}}));row.addElement(new GridDbHeadCell(id+"_col_carrier_descr",{"value":"Перевозчик","readBind":{"valueFieldId":"carrier_descr","sortable":true}}));row.addElement(new GridDbHeadCellBool(id+"_col_driver_match_1c",{"value":"1с","readBind":{"valueFieldId":"driver_match_1c","sortable":true}}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":options.controller||new Vehicle_Controller(new ServConnector(HOST_NAME)),"readModelId":options.model||"VehicleList_Model","readMethodId":options.method||"get_list","editViewClass":VehicleDialog_View,"editInline":false,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj});this.addElement(this.m_fastFilter);this.addElement(this.m_grid);var self=this;this.m_grid.m_filterComplete=function(struc){self.m_fastFilter.getParams(struc);}
this.m_fastFilter.setOnRefresh(this.m_grid.onRefresh);this.m_fastFilter.setClickContext(this.m_grid);}
extend(VehicleList_View,ViewList);VehicleList_View.prototype.getFormWidth=function(){return"1000";}
VehicleList_View.prototype.toDOM=function(parent){VehicleList_View.superclass.toDOM.call(this,parent);this.m_fastFilter.setFocus();} 
function VehicleDialog_View(id,options){options=options||{};VehicleDialog_View.superclass.constructor.call(this,id,options);var model="VehicleDialog_Model";var self=this;var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var cont=new ControlContainer(uuid(),"div",{className:get_bs_col()+"6"});var ctrl=new EditNum(id+"_id",{"attrs":{"disabled":"disabled"},"labelCaption":"Код:"});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});cont.addElement(ctrl);this.m_plateCtrl=new EditString(id+"_plate",{"attrs":{"maxlength":20,"size":8,"required":"required"},"labelCaption":"Рег.номер:","name":"plate"});this.bindControl(this.m_plateCtrl,{"modelId":model,"valueFieldId":"plate","keyFieldIds":null},{"valueFieldId":"plate","keyFieldIds":null});cont.addElement(this.m_plateCtrl);ctrl=new EditString(id+"_model",{"attrs":{"maxlength":50},"labelCaption":"Модель:","name":"model"});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"model","keyFieldIds":null},{"valueFieldId":"model","keyFieldIds":null});cont.addElement(ctrl);ctrl=new EditNum(id+"_vol",{"attrs":{"maxlength":5},"labelCaption":"Объем:","name":"vol"});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"vol","keyFieldIds":null},{"valueFieldId":"vol","keyFieldIds":null});cont.addElement(ctrl);ctrl=new EditFloat(id+"_load_weight_t",{"precision":"2","attrs":{"maxlength":8,"size":4},"labelCaption":"Грузоподъемность:","name":"load_weight_t"});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"load_weight_t","keyFieldIds":null},{"valueFieldId":"load_weight_t","keyFieldIds":null});cont.addElement(ctrl);ctrl=new ProductionCityEditObject("production_city_id","production_city",false);this.bindControl(ctrl,{"modelId":model,"valueFieldId":"production_city_descr","keyFieldIds":["production_city_id"]},{"modelId":model,"valueFieldId":null,"keyFieldIds":["production_city_id"]});cont.addElement(ctrl);this.addControl(cont);var cont=new ControlContainer(uuid(),"div",{className:get_bs_col()+"6"});ctrl=new EditCheckBox(id+"_employed",{"labelCaption":"Постоянное ТС:","name":"employed","labelAlign":"left"});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"employed","keyFieldIds":null},{"valueFieldId":"employed","keyFieldIds":null});cont.addElement(ctrl);this.m_carrierCtrl=new CarrierEditObject("carrier_id","carrier",false);this.bindControl(this.m_carrierCtrl,{"modelId":model,"valueFieldId":"carrier_descr","keyFieldIds":["carrier_id"]},{"modelId":model,"valueFieldId":null,"keyFieldIds":["carrier_id"]});cont.addElement(this.m_carrierCtrl);ctrl=new EditString(id+"_driver_descr",{"attrs":{"maxlength":150},"labelCaption":"ФИО водителя:","name":"driver_descr"});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"driver_descr","keyFieldIds":null},{"valueFieldId":"driver_descr","keyFieldIds":null});cont.addElement(ctrl);ctrl=new EditString(id+"_driver_drive_perm",{"attrs":{"maxlength":20},"labelCaption":"Вод.удост.водителя:","name":"driver_drive_perm"});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"driver_drive_perm","keyFieldIds":null},{"valueFieldId":"driver_drive_perm","keyFieldIds":null});cont.addElement(ctrl);ctrl=new EditCellPhone(id+"_driver_cel_phone",{"labelCaption":"Сот.тел.водителя:","name":"driver_cel_phone"});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"driver_cel_phone","keyFieldIds":null},{"valueFieldId":"driver_cel_phone","keyFieldIds":null});cont.addElement(ctrl);this.m_getAttrsBtn=new ButtonCtrl(id+":btn_get_attrs",{"caption":"Заполнить из 1с","enabled":false,"onClick":function(){self.getDriverAttrs();}});cont.addElement(this.m_getAttrsBtn);this.m_match1CCtrl=new Control(id+":match_1c","span",{});cont.addElement(this.m_match1CCtrl);ctrl=new DelivCostOptEdit({"fieldId":"deliv_cost_opt_id","controlId":"deliv_cost_opt","inLine":false});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"deliv_cost_opt_descr","keyFieldIds":["deliv_cost_opt_id"]},{"modelId":model,"valueFieldId":null,"keyFieldIds":["deliv_cost_opt_id"]});cont.addElement(ctrl);this.m_trailerPlateCtrl=new EditString(id+"_trailer_plate",{"attrs":{"maxlength":20,"size":8},"labelCaption":"Рег.номер прицепа:","name":"trailer_plate"});this.bindControl(this.m_trailerPlateCtrl,{"modelId":model,"valueFieldId":"trailer_plate","keyFieldIds":null},{"valueFieldId":"trailer_plate","keyFieldIds":null});cont.addElement(this.m_trailerPlateCtrl);this.m_trailerModelCtrl=new EditString(id+"_trailer_model",{"attrs":{"maxlength":50,"size":20},"labelCaption":"Модель прицепа:","name":"trailer_model"});this.bindControl(this.m_trailerModelCtrl,{"modelId":model,"valueFieldId":"trailer_model","keyFieldIds":null},{"valueFieldId":"trailer_model","keyFieldIds":null});cont.addElement(this.m_trailerModelCtrl);cont_m.addElement(cont);this.addControl(cont_m);var cont_m=new ControlContainer(uuid(),"div",{className:"row"});var cont=new ControlContainer("tracker_cont","div",{className:get_bs_col()+"6"});var ctrl=new TrackerEdit({fieldId:"tracker_id","controlId":id+"_tracker","inline":false});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"tracker_id","keyFieldIds":["tracker_id"]},{"valueFieldId":null,"keyFieldIds":["tracker_id"]});cont.addElement(ctrl);ctrl=new EditDateTime(id+"_last_tracker_data",{"enabled":false,"editContClassName":"input-group "+get_bs_col()+"4","labelCaption":"Последние данные:"});this.bindControl(ctrl,{"modelId":model,"valueFieldId":"last_tracker_data","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});cont.addElement(ctrl);cont_m.addElement(cont);this.addElement(cont_m);}
extend(VehicleDialog_View,ViewDialog);VehicleDialog_View.prototype.getDriverAttrs=function(){var dr_id=this.m_driverCtrl.getFieldValue();if(!dr_id||dr_id=="undefined"||dr_id=="null")return;this.m_getAttrsBtn.setEnabled(false);var self=this;var contr=new Driver_Controller(new ServConnector(HOST_NAME));contr.run("get_veh_attrs",{"params":{"driver_id":dr_id},"err":function(resp,errCode,errStr){self.getErrorControl().setValue(errStr);self.m_getAttrsBtn.setEnabled(true);},"func":function(resp){var m=resp.getModelById("get_veh_attrs",true);if(m.getNextRow()){self.m_getAttrsBtn.setEnabled(true);self.m_carrierCtrl.setValue(m.getFieldValue('carrier_descr'));self.m_carrierCtrl.setFieldValue("id",m.getFieldValue('carrier_id'));self.m_trailerModelCtrl.setValue(m.getFieldValue('trailer_model'));self.m_trailerPlateCtrl.setValue(m.getFieldValue('trailer_plate'));self.m_plateCtrl.setValue(m.getFieldValue('plate'));}}});}
VehicleDialog_View.prototype.setMatch1C=function(v){this.m_getAttrsBtn.setEnabled(v);this.m_match1CCtrl.setValue((v)?" Водитель связан с 1с":" Нет связи водиетля с 1с");if(!v){this.m_match1CCtrl.setAttr("class","text-danger");}
else{this.m_match1CCtrl.setAttr("class","text-success");}}
VehicleDialog_View.prototype.onGetData=function(resp){VehicleDialog_View.superclass.onGetData.call(this,resp);var match1c=false;var m=resp.getModelById("VehicleDialog_Model",true);if(m.getNextRow()){match1c=(m.getFieldValue("match_1c")=="true");}
this.setMatch1C(match1c);}
VehicleDialog_View.prototype.onDriverSelected=function(){this.setMatch1C((this.m_driverCtrl.getAttr("match_1c")=="true"));}
VehicleDialog_View.prototype.onDriverInserted=function(){var dr_id=this.m_driverCtrl.getFieldValue("driver_id");if(!dr_id)return;DOMHandler.removeClass(this.m_driverCtrl.getNode(),"error");var self=this;var contr=new Driver_Controller(new ServConnector(HOST_NAME));contr.getPublicMethodById("get_object");contr.run("get_object",{"params":{"id":dr_id},"func":function(resp){var m=resp.getModelById("DriverList_Model",true);if(m.getNextRow()){self.m_driverCtrl.setAttr("match_1c",m.getFieldValue("match_1c"));self.onDriverSelected();if(m.getFieldValue("match_1c")=="true"){self.getDriverAttrs();}}}});} 
function DelivExtraVehSelectList_View(id,options){options=options||{};options.title="Дополнительные автомобили";options.controller=new Delivery_Controller(new ServConnector(HOST_NAME));options.method="extra_veh_select_list";options.model="extra_veh_select_list";DelivExtraVehSelectList_View.superclass.constructor.call(this,id,options);}
extend(DelivExtraVehSelectList_View,VehicleList_View);DelivExtraVehSelectList_View.prototype.setDate=function(date){var contr=this.getElementById(this.getId()+"_grid").getController();var pm=contr.getPublicMethodById("extra_veh_select_list");pm.setParamValue("date",date);} 
function ClientDestinationDialog_View(id,options){options=options||{};options.readMethodId=options.readMethodId||this.DEF_READ_METH_ID;options.writeController=options.writeController||options.readController;options.mapHeight="500";options.mapWidth=getViewportWidth()-10;options.noOk=true;options.noCancel=true;ClientDestinationDialog_View.superclass.constructor.call(this,id,options);var model_r="ClientDestinationDialog_Model";var model_w="ClientDestination_Model";var self=this;this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id"}),{"modelId":model_r,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null,"modelId":model_w});this.addDataControl(new Edit(id+"_client_id",{"visible":false,"name":"client_id","value":options.clientId}),{"modelId":model_r,"valueFieldId":"client_id","keyFieldIds":null},{"valueFieldId":"client_id","keyFieldIds":null,"modelId":model_w});this.m_ctrlZoneCenterStr=new Edit(id+"_zone_center_str",{"visible":false,"name":"zone_center_str"});this.addDataControl(this.m_ctrlZoneCenterStr,{"modelId":model_r,"valueFieldId":"zone_center_str","keyFieldIds":null},{"valueFieldId":"zone_center","keyFieldIds":null});var cont=new ControlContainer(this.m_id+"_addr_panel","div",{"className":"form-group"});var cont_val=new ControlContainer(this.m_id+"_val_cont","div",{"className":"input-group col-lg-12"});this.m_ctrlValue=new EditString(id+"_value",{"name":"value","value":(options.addressValue)?options.addressValue:"","className":"form-control addressEdit","attrs":{"fkey_deliv_destination_id":options.delivDestinationId}});var contr=new ClientDestination_Controller(new ServConnector(HOST_NAME));contr.getPublicMethodById("complete_address").setParamValue("client_id",options.clientId);this.m_ctrlValue.m_autoComplete=new actbAJX({"controller":contr,"modelId":"DelivAddress_Model","lookupValueFieldId":"address","methodId":"complete_address","lookupKeyFieldIds":["address"],"keyFieldIds":null,"minLengthForQuery":"1","patternParamId":"address","ic":null,"mid":null,"onSelected":null,"extraFields":null,"resultFieldId":"address","resultFieldIdsToAttr":["is_old"],"queryDelay":500,"fullTextSearch":true});actb(this.m_ctrlValue.m_node,this.m_ctrlValue.m_winObj,this.m_ctrlValue.m_autoComplete);this.addDataControl(this.m_ctrlValue,{"modelId":model_r,"valueFieldId":"value","keyFieldIds":null},{"valueFieldId":"value","keyFieldIds":null});cont_val.addElement(this.m_ctrlValue);cont.addElement(cont_val);this.m_btnFind=new ButtonCtrl(id+"btnFind",{"caption":"Найти объект на карте","onClick":function(){self.getAddressGPS();},"attrs":{"title":"Найти объект на карте по адресу"}});cont.addElement(this.m_btnFind);this.addControl(cont);this.addControl(new ButtonCmd(uuid(),{"caption":"Записать","onClick":function(){self.onClickOk();},"attrs":{"title":"записать,закрыть"}}));this.addControl(new ButtonCmd(uuid(),{"caption":"Закрыть","onClick":function(){self.onCancel();},"attrs":{"title":"закрыть без сохранения"}}));this.addFeatureControl();this.addMapControl();}
extend(ClientDestinationDialog_View,Map_View);ClientDestinationDialog_View.prototype.onWriteOk=function(resp){ClientDestinationDialog_View.superclass.onWriteOk.call(this,resp);if(resp.modelExists("InsertedId_Model")){var m=resp.getModelById("InsertedId_Model",true);if(m.getNextRow()){this.m_lastInsertedId=m.getFieldValue("id");}}}
ClientDestinationDialog_View.prototype.addFeatureControl=function(){var self=this;this.m_markerSet=new MarkerSetControl("map_drawing",{"className":"form-group","onNavigate":function(){self.m_markerLayer.activateNavigation();},"onDrag":function(){self.m_markerLayer.activateDragging();},"onDraw":function(){self.m_markerLayer.activateDrawing();},"onDelete":function(){self.m_markerLayer.deleteZone();}});this.addControl(this.m_markerSet);}
ClientDestinationDialog_View.prototype.addFeatures=function(){var point=this.m_ctrlZoneCenterStr.getValue().split(" ");var self=this;this.m_markerLayer=new MarkerLayer({"map":this.m_map,"objDescr":"Объект для доставки","points":null,"doDraw":true,"drawComplete":function(coordsStr){self.m_ctrlZoneCenterStr.setValue(coordsStr);},"featureType":OpenLayers.Handler.Point});var lon,lat,zoom;if(point.length>=2){lon=point[0];lat=point[1];zoom=TRACK_CONSTANTS.FOUND_ZOOM;this.m_markerLayer.drawZoneOnCoords(point);}
else{lon=NMEAStrToDegree(CONSTANT_VALS.map_default_lon);lat=NMEAStrToDegree(CONSTANT_VALS.map_default_lat);zoom=TRACK_CONSTANTS.INI_ZOOM;}
this.m_markerLayer.moveMapToCoords(lon,lat,zoom);}
ClientDestinationDialog_View.prototype.getAddressGPS=function(){var self=this;this.setEnabled(false);this.setGlobalWait(true);var contr=new ClientDestination_Controller(new ServConnector(HOST_NAME));contr.run("get_address_gps",{"async":true,"params":{"value":this.m_ctrlValue.getValue()},"func":function(resp){var model=resp.getModelById("gps");model.setActive(true);if(model.getNextRow()){var lon=model.getFieldValue("lon");var lat=model.getFieldValue("lat");var point=[lon,lat];self.m_markerLayer.deleteZone();self.m_markerLayer.drawZoneOnCoords(point);self.m_markerLayer.moveMapToCoords(lon,lat,TRACK_CONSTANTS.FOUND_ZOOM);}
self.setEnabled(true);self.setGlobalWait(false);},"err":function(resp,errCode,errStr){self.setEnabled(true);self.setGlobalWait(false);WindowMessage.show({"text":errStr});}});}
ClientDestinationDialog_View.prototype.toDOM=function(parent){ClientDestinationDialog_View.superclass.toDOM.call(this,parent);this.m_ctrlValue.getNode().focus();} 
function SMSTemplateList_View(id,options){options=options||{};options.title="Шаблоны CMC";SMSTemplateList_View.superclass.constructor.call(this,id,options);var controller=new SMSTemplate_Controller(options.connect);var head=new GridHead();var row=new GridRow("Driver_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"value":"Код","readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_sms_type_descr",{"value":"Тип","readBind":{"valueFieldId":"sms_type_descr"},"sortable":true,"sort":"asc"}));row.addElement(new GridDbHeadCell(id+"_comment_text",{"value":"Описание","readBind":{"valueFieldId":"comment_text"}}));row.addElement(new GridDbHeadCell(id+"_col_template",{"value":"Шаблон","readBind":{"valueFieldId":"template"}}));row.addElement(new GridDbHeadCell(id+"_col_fields",{"value":"Поля","readBind":{"valueFieldId":"fields"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"SMSTemplateList_Model","editViewClass":SMSTemplateListInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"noInsert":true,"noCopy":true,"noDelete":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"noExport":true}));}
extend(SMSTemplateList_View,ViewList); 
function SMSTemplateListInline_View(id,options){options=options||{};SMSTemplateListInline_View.superclass.constructor.call(this,id,options);var model_id="SMSTemplateList_Model";this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id"}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null,"modelId":model_id});if(!CONST_CONTROLS.sms_type){CONST_CONTROLS.sms_type=new SMSTypeEditObject("sms_type",id+"_sms_type",true);}
else{CONST_CONTROLS.sms_type.setDefaultId();}
this.addDataControl(CONST_CONTROLS.sms_type,{"modelId":model_id,"valueFieldId":"sms_type_descr","keyFieldIds":["sms_type"]},{"valueFieldId":null,"keyFieldIds":["sms_type"]});this.addDataControl(new EditString(id+"_comment_text",{"attrs":{"size":80},"enabled":false}),{"modelId":model_id,"valueFieldId":"comment_text","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null,"modelId":null});this.addDataControl(new EditText(id+"_template",{"attrs":{"maxlength":250,"size":120,"rows":3}}),{"modelId":model_id,"valueFieldId":"template","keyFieldIds":null},{"valueFieldId":"template","keyFieldIds":null,"modelId":model_id});this.addDataControl(new Control(id+"_fields","span"),{"modelId":model_id,"valueFieldId":"fields","keyFieldIds":null},{"valueFieldId":"fields","keyFieldIds":null,"modelId":model_id});}
extend(SMSTemplateListInline_View,ViewInlineGridEdit); 
function EmailTemplateList_View(id,options){options=options||{};options.title="Шаблоны эл.писем";EmailTemplateList_View.superclass.constructor.call(this,id,options);var controller=new EmailTemplate_Controller(options.connect);var head=new GridHead();var row=new GridRow("Driver_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"value":"Код","readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_email_type_descr",{"value":"Тип","readBind":{"valueFieldId":"email_type_descr"},"sortable":true,"sort":"asc"}));row.addElement(new GridDbHeadCell(id+"_col_mes_subject",{"value":"Тема","readBind":{"valueFieldId":"mes_subject"}}));row.addElement(new GridDbHeadCell(id+"_comment_text",{"value":"Описание","readBind":{"valueFieldId":"comment_text"}}));row.addElement(new GridDbHeadCell(id+"_col_template",{"value":"Шаблон","readBind":{"valueFieldId":"template"}}));row.addElement(new GridDbHeadCell(id+"_col_fields",{"value":"Поля","readBind":{"valueFieldId":"fields"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"EmailTemplateList_Model","editViewClass":EmailTemplateListInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"noInsert":true,"noCopy":true,"noDelete":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"noExport":true}));}
extend(EmailTemplateList_View,ViewList); 
function EmailTemplateListInline_View(id,options){options=options||{};EmailTemplateListInline_View.superclass.constructor.call(this,id,options);var model_id="EmailTemplateList_Model";this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id"}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null,"modelId":model_id});if(!CONST_CONTROLS.Email_type){CONST_CONTROLS.Email_type=new EmailTypeEditObject("Email_type",id+"_Email_type",true);}
else{CONST_CONTROLS.Email_type.setDefaultId();}
this.addDataControl(CONST_CONTROLS.Email_type,{"modelId":model_id,"valueFieldId":"email_type_descr","keyFieldIds":["email_type"]},{"valueFieldId":null,"keyFieldIds":["email_type"]});this.addDataControl(new EditString(id+"_mes_subject",{"attrs":{"size":50,"maxlength":"200"}}),{"modelId":model_id,"valueFieldId":"mes_subject","keyFieldIds":null},{"valueFieldId":"mes_subject","keyFieldIds":null,"modelId":null});this.addDataControl(new Control(id+"_comment_text","span"),{"modelId":model_id,"valueFieldId":"comment_text","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null,"modelId":null});this.addDataControl(new EditText(id+"_template",{"attrs":{"maxlength":250,"size":200,"rows":3}}),{"modelId":model_id,"valueFieldId":"template","keyFieldIds":null},{"valueFieldId":"template","keyFieldIds":null,"modelId":model_id});this.addDataControl(new Control(id+"_fields","span"),{"modelId":model_id,"valueFieldId":"fields","keyFieldIds":null},{"valueFieldId":"fields","keyFieldIds":null,"modelId":model_id});}
extend(EmailTemplateListInline_View,ViewInlineGridEdit); 
function DelivCostList_View(id,options){options=options||{};options.title="Тарифы по доставке";DelivCostList_View.superclass.constructor.call(this,id,options);var controller=new DelivCost_Controller(new ServConnector(HOST_NAME));var filter=new GridFilter();filter.addFilterControl(new ProductionCityEditObject("production_city_id",id+"_filter_production_city",false),{"sign":"e","valueFieldId":"production_city_id"});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_production_city_descr",{"value":"Город","readBind":{"valueFieldId":"production_city_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_deliv_cost_opt_descr",{"value":"Категория цены","readBind":{"valueFieldId":"deliv_cost_opt_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_deliv_cost_type_descr",{"value":"Тип","readBind":{"valueFieldId":"deliv_cost_type_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_cost",{"value":"Цена","readBind":{"valueFieldId":"cost"}}));row.addElement(new GridDbHeadCell(id+"_col_cost2",{"value":"Себест.","readBind":{"valueFieldId":"cost2"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"DelivCostList_Model","editViewClass":DelivCostInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(DelivCostList_View,ViewList); 
function DelivCostInline_View(id,options){options=options||{};DelivCostInline_View.superclass.constructor.call(this,id,options);var model_id="DelivCostList_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new ProductionCityEditObject("production_city_id",id+"_production_city",true),{"modelId":model_id,"valueFieldId":"production_city_descr","keyFieldIds":["production_city_id"]},{"valueFieldId":null,"keyFieldIds":["production_city_id"]});this.addDataControl(new DelivCostOptEdit({fieldId:"deliv_cost_opt_id",controlId:id+"_deliv_cost_opt",inLine:true}),{"modelId":model_id,"valueFieldId":"deliv_cost_opt_descr","keyFieldIds":["deliv_cost_opt_id"]},{"valueFieldId":null,"keyFieldIds":["deliv_cost_opt_id"]});this.addDataControl(new DelivCostEditObject({"fieldId":"deliv_cost_type","controlId":id+"_deliv_cost_type","inLine":true}),{"modelId":model_id,"valueFieldId":"deliv_cost_type_descr","keyFieldIds":["deliv_cost_type"]},{"valueFieldId":null,"keyFieldIds":["deliv_cost_type"]});this.addDataControl(new EditMoney(id+"_cost",{"attrs":{"required":"required"}}),{"modelId":model_id,"valueFieldId":"cost","keyFieldIds":null},{"valueFieldId":"cost","keyFieldIds":null});this.addDataControl(new EditMoney(id+"_cost2",{"attrs":{"required":"required"}}),{"modelId":model_id,"valueFieldId":"cost2","keyFieldIds":null},{"valueFieldId":"cost2","keyFieldIds":null});}
extend(DelivCostInline_View,ViewInlineGridEdit); 
function DelivCostOptList_View(id,options){options=options||{};options.title="Ценовые категории.";DelivCostOptList_View.superclass.constructor.call(this,id,options);var controller=new DelivCostOpt_Controller(new ServConnector(HOST_NAME));var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"visible":false,"keyCol":true}));row.addElement(new GridDbHeadCell(id+"_col_descr",{"value":"Наименование","readBind":{"valueFieldId":"descr"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_volume_m",{"value":"Объем,м3","readBind":{"valueFieldId":"volume_m"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_weight_t",{"value":"Груз-ть,т","readBind":{"valueFieldId":"weight_t"},"colAttrs":{"align":"center"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"DelivCostOptList_Model","editViewClass":DelivCostOptInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(DelivCostOptList_View,ViewList); 
function DelivCostOptInline_View(id,options){options=options||{};DelivCostOptInline_View.superclass.constructor.call(this,id,options);var model_id="DelivCostOptList_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new Edit(id+"_descr",{"name":"descr","enabled":false}),{"modelId":model_id,"valueFieldId":"descr","keyFieldIds":null},{"valueFieldId":null,"keyFieldIds":null});this.addDataControl(new EditNum(id+"_volume_m",{"name":"volume_m"}),{"modelId":model_id,"valueFieldId":"volume_m","keyFieldIds":null},{"valueFieldId":"volume_m","keyFieldIds":null});this.addDataControl(new EditFloat(id+"_weight_t",{"name":"weight_t","precision":"2","attrs":{"maxlength":"15"}}),{"modelId":model_id,"valueFieldId":"weight_t","keyFieldIds":null},{"valueFieldId":"weight_t","keyFieldIds":null});}
extend(DelivCostOptInline_View,ViewInlineGridEdit); 
function ClientDebtPeriodList_View(id,options){options=options||{};options.title="Периоды задолженности";ClientDebtPeriodList_View.superclass.constructor.call(this,id,options);var controller=new ClientDebtPeriod_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_days_from",{"value":"От","readBind":{"valueFieldId":"days_from"},"keyCol":true,"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_days_to",{"value":"До","readBind":{"valueFieldId":"days_to"},"colAttrs":{"align":"center"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ClientDebtPeriodList_Model","editViewClass":ClientDebtPeriodInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(ClientDebtPeriodList_View,ViewList); 
function ClientDebtPeriodInline_View(id,options){options=options||{};ClientDebtPeriodInline_View.superclass.constructor.call(this,id,options);var model="ClientDebtPeriod_Model";this.addDataControl(new EditNum(id+"_days_from",{"name":"days_from"}),{"modelId":model,"valueFieldId":"days_from","keyFieldIds":null},{"valueFieldId":"days_from","keyFieldIds":null});this.addDataControl(new EditNum(id+"_days_to",{"name":"days_to"}),{"modelId":model,"valueFieldId":"days_to","keyFieldIds":null},{"valueFieldId":"days_to","keyFieldIds":null});}
extend(ClientDebtPeriodInline_View,ViewInlineGridEdit); 
function DeliveryHour_View(id,options){options=options||{};options.title="Часы доставки";DeliveryHour_View.superclass.constructor.call(this,id,options);var controller=new DeliveryHour_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_h_from",{"value":"С","readBind":{"valueFieldId":"h_from"},"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_h_to",{"value":"По","readBind":{"valueFieldId":"h_to"},"colAttrs":{"align":"center"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"DeliveryHour_Model","editViewClass":DeliveryHourInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(DeliveryHour_View,ViewList); 
function DeliveryHourInline_View(id,options){options=options||{};DeliveryHourInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":"DeliveryHour_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditNum(id+"_h_from",{"attrs":{"maxlength":2,"size":3,"required":"required"}}),{"modelId":"DeliveryHour_Model","valueFieldId":"h_from","keyFieldIds":null},{"valueFieldId":"h_from","keyFieldIds":null});this.addDataControl(new EditNum(id+"_h_to",{"attrs":{"maxlength":2,"size":3,"required":"required"}}),{"modelId":"DeliveryHour_Model","valueFieldId":"h_to","keyFieldIds":null},{"valueFieldId":"h_to","keyFieldIds":null});}
extend(DeliveryHourInline_View,ViewInlineGridEdit); 
function ClientActivity_View(id,options){options=options||{};options.title="Виды деятельности";ClientActivity_View.superclass.constructor.call(this,id,options);var controller=new ClientActivity_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"}}));row.addElement(new GridDbHeadCellBool(id+"_col_match_1c",{"value":"Соответствует 1с","readBind":{"valueFieldId":"match_1c"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ClientActivityList_Model","editViewClass":ClientActivityInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"noPrint":true,"noCopy":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(ClientActivity_View,ViewList); 
function ClientActivityInline_View(id,options){options=options||{};ClientActivityInline_View.superclass.constructor.call(this,id,options);var model="ClientActivity_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":50,"size":25,"required":"required"}}),{"modelId":model,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});}
extend(ClientActivityInline_View,ViewInlineGridEdit); 
function SertType_View(id,options){options=options||{};options.title="Сертификаты";SertType_View.superclass.constructor.call(this,id,options);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Описание","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":new SertType_Controller(new ServConnector(HOST_NAME)),"readModelId":"SertType_Model","readMethodId":"get_list","editViewClass":SertTypeDialog_View,"editInline":false,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(SertType_View,ViewList); 
function SertTypeDialog_View(id,options){options=options||{};options.tagName="div";SertTypeDialog_View.superclass.constructor.call(this,id,options);var model="SertType_Model";this.addDataControl(new EditNum(id+"_id",{"visible":false,"tableLayout":false,}),{"modelId":model,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":25,"size":50,"required":"required"},"labelCaption":"Описание:","tableLayout":false,"name":"name"}),{"modelId":model,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});var sub_cont=new ControlContainer(uuid(),"div",{"className":"panel_all"});sub_cont.addElement(new Control(null,"span",{"value":"Атрибуты"}));this.m_attrList=new SertTypeAttr_View("SertTypeAttr",options);sub_cont.addElement(this.m_attrList);this.addElement(sub_cont);this.m_ctrlXSLTPattern=new EditString(id+"_xslt_pattern",{"labelCaption":"Шаблон паспорта качества:","name":"xslt_pattern","buttonClear":false,"attrs":{"size":"20"},"tableLayout":false,"enabled":false});this.bindControl(this.m_ctrlXSLTPattern,{"modelId":model,"valueFieldId":"xslt_pattern","keyFieldIds":null},{"valueFieldId":"xslt_pattern","keyFieldIds":null});this.addElement(this.m_ctrlXSLTPattern);var meth_set="set_xslt_pattern";var meth_get="get_xslt_pattern";var contr=new SertType_Controller(new ServConnector(HOST_NAME));var pm_set=contr.getPublicMethodById(meth_set);pm_set.setParamValue("c","SertType_Controller");pm_set.setParamValue("f",meth_set);this.m_pm_get=contr.getPublicMethodById(meth_get);this.m_pm_get.setParamValue("c","SertType_Controller");this.m_pm_get.setParamValue("f",meth_get);var self=this;ctrl=new FileLoader(id+"_fileLoader",{"controller":contr,"getMethodId":meth_get,"methodId":meth_set,"files":{"file1":{"caption":"Загрузка шаблона:","name":"xslt_pattern"}},"onFileUploadEnd":function(resp){var m=resp.getModelById("xslt_pattern",true);if(m.getNextRow()){self.m_ctrlXSLTPattern.setValue(m.getFieldValue("xslt_pattern"));}}});this.addElement(ctrl);this.addElement(new Button(id+"_btn_check_pattern",{caption:"Проверить шалон",attrs:{"title":"срегенировать файл по шаблону для проверки"},onClick:function(){var id=self.getDataControlValue(self.getId()+"_id");if(id){var contr=new SertType_Controller(new ServConnector(HOST_NAME));var q_params=contr.getQueryString(contr.getPublicMethodById("check_pattern"))+"&sert_type_id="+id;top.location.href=HOST_NAME+"index.php?"+q_params;}}}));}
extend(SertTypeDialog_View,ViewDialog);SertTypeDialog_View.prototype.onGetData=function(resp){SertTypeDialog_View.superclass.onGetData.call(this,resp);var m=resp.getModelById("SertType_Model",true);if(m.getNextRow()){var id=m.getFieldValue("id");this.m_pm_get.setParamValue("id",id);this.m_attrList.setSertTypeId(id);this.m_attrList.m_grid.setEnabled(true);this.m_attrList.m_grid.onRefresh();}} 
function SertTypeAttr_View(id,options){options=options||{};SertTypeAttr_View.superclass.constructor.call(this,id,options);var controller=new SertTypeAttr_Controller(options.connect);var filter=new ListFilter();filter.addFilter("sert_type_id",{"sign":"e","keyFieldIds":["sert_type_id"]});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_sert_type_id",{"readBind":{"valueFieldId":"sert_type_id"},"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_attr_text",{"value":"Атрибут","readBind":{"valueFieldId":"attr_text"}}));row.addElement(new GridDbHeadCell(id+"_col_attr_val",{"value":"Значение","readBind":{"valueFieldId":"attr_val"}}));row.addElement(new GridDbHeadCell(id+"_col_attr_val_norm",{"value":"Норма","readBind":{"valueFieldId":"attr_val_norm"}}));row.addElement(new GridDbHeadCell(id+"_col_attr_val_min",{"value":"Знач.от","readBind":{"valueFieldId":"attr_val_min"}}));row.addElement(new GridDbHeadCell(id+"_col_attr_val_max",{"value":"Знач.до","readBind":{"valueFieldId":"attr_val_max"}}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readMethodId":"get_list","readModelId":"SertTypeAttr_Model","editViewClass":SertTypeAttrInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_grid_cmd",{"tableId":id+"_grid"}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"rowSelect":true,"noAutoRefresh":true,"methParams":{"sert_type_id":null},"enabled":options.enabled});this.addElement(this.m_grid);}
extend(SertTypeAttr_View,ViewList);SertTypeAttr_View.prototype.setSertTypeId=function(id){this.m_grid.m_filter.m_params["sert_type_id"].key=id;this.m_grid.m_methParams["sert_type_id"]=id;this.m_grid.m_autoRefresh=true;} 
function SertTypeAttrInline_View(id,options){options=options||{};SertTypeAttrInline_View.superclass.constructor.call(this,id,options);var model="SertTypeAttr_Model";this.addDataControl(new Edit(id+"_id",{"visible":false,"name":"id"}),{"modelId":model,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new Edit(id+"_sert_type_id",{"visible":false,"name":"sert_type_id"}),{"modelId":model,"valueFieldId":"sert_type_id","keyFieldIds":null},{"valueFieldId":"sert_type_id","keyFieldIds":null});this.addDataControl(new EditString(id+"_attr_text",{"name":"attr_text","attrs":{"maxlength":"250","size":"50"}}),{"modelId":model,"valueFieldId":"attr_text","keyFieldIds":null},{"valueFieldId":"attr_text","keyFieldIds":null});this.addDataControl(new EditString(id+"_attr_val",{"name":"attr_val","attrs":{"maxlength":"50","size":"20"}}),{"modelId":model,"valueFieldId":"attr_val","keyFieldIds":null},{"valueFieldId":"attr_val","keyFieldIds":null});this.addDataControl(new EditString(id+"_attr_val_norm",{"name":"attr_val_norm","attrs":{"maxlength":"50","size":"20"}}),{"modelId":model,"valueFieldId":"attr_val_norm","keyFieldIds":null},{"valueFieldId":"attr_val_norm","keyFieldIds":null});this.addDataControl(new EditFloat(id+"_attr_val_min",{"name":"attr_val_min","precision":4,"attrs":{"maxlength":"15","size":"15"}}),{"modelId":model,"valueFieldId":"attr_val_min","keyFieldIds":null},{"valueFieldId":"attr_val_min","keyFieldIds":null});this.addDataControl(new EditFloat(id+"_attr_val_max",{"name":"attr_val_max","precision":4,"attrs":{"maxlength":"15","size":"15"}}),{"modelId":model,"valueFieldId":"attr_val_max","keyFieldIds":null},{"valueFieldId":"attr_val_max","keyFieldIds":null});}
extend(SertTypeAttrInline_View,ViewInlineGridEdit); 
function TrackerServerList_View(id,options){options=options||{};options.title="Серверы трекеров";TrackerServerList_View.superclass.constructor.call(this,id,options);var controller=new TrackerServer_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_ip",{"value":"IP","readBind":{"valueFieldId":"ip"}}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"TrackerServer_Model","editViewClass":TrackerServerInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(TrackerServerList_View,ViewList); 
function TrackerServerInline_View(id,options){options=options||{};TrackerServerInline_View.superclass.constructor.call(this,id,options);var model_id="TrackerServer_Model";this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString(id+"_ip",{"attrs":{"maxlength":"15","size":12,"required":"required"}}),{"modelId":model_id,"valueFieldId":"ip","keyFieldIds":null},{"valueFieldId":"ip","keyFieldIds":null});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":"50","size":20,"required":"required"}}),{"modelId":model_id,"valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});}
extend(TrackerServerInline_View,ViewInlineGridEdit); 
function TrackerList_View(id,options){options=options||{};options.title="Трекеры";TrackerList_View.superclass.constructor.call(this,id,options);var controller=new Tracker_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"value":"Идентификатор","readBind":{"valueFieldId":"id"},"keyCol":true,}));row.addElement(new GridDbHeadCell(id+"_col_tracker_server_descr",{"value":"Сервер","readBind":{"valueFieldId":"tracker_server_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_sim_number",{"value":"Номер SIM карты","readBind":{"valueFieldId":"sim_number"}}));row.addElement(new GridDbHeadCell(id+"_col_sim_id",{"value":"Идентификатор SIM карты","readBind":{"valueFieldId":"sim_id"}}));row.addElement(new GridDbHeadCell(id+"_col_last_tracker_data",{"value":"Данные","readBind":{"valueFieldId":"last_tracker_data"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"TrackerList_Model","editViewClass":TrackerInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(TrackerList_View,ViewList); 
function TrackerInline_View(id,options){options=options||{};TrackerInline_View.superclass.constructor.call(this,id,options);var model_id="TrackerList_Model";this.addDataControl(new EditString(id+"_id",{"name":"id","attrs":{"size":"10","maxlength":"15"}}),{"modelId":model_id,"valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null});this.addDataControl(new TrackServerEdit({"fieldId":"tracker_server_id","inLine":false,"controlId":id+"_tracker_server"}),{"modelId":model_id,"valueFieldId":"tracker_server_descr","keyFieldIds":null},{"valueFieldId":"tracker_server_id","keyFieldIds":null});this.addDataControl(new EditCellPhone(id+"_sim_number",{"attrs":{}}),{"modelId":model_id,"valueFieldId":"sim_number","keyFieldIds":null},{"valueFieldId":"sim_number","keyFieldIds":null});this.addDataControl(new EditString(id+"_sim_id",{"attrs":{"maxlength":"36","size":20}}),{"modelId":model_id,"valueFieldId":"sim_id","keyFieldIds":null},{"valueFieldId":"sim_id","keyFieldIds":null});}
extend(TrackerInline_View,ViewInlineGridEdit); 
function SMSForSendingList_View(id,options){options=options||{};options.title="СМС сообщения";SMSForSendingList_View.superclass.constructor.call(this,id,options);var controller=new SMSForSending_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_date_time_descr",{"value":"Дата","readBind":{"valueFieldId":"date_time_descr"},"sortable":true,"sort":"desc","sortCol":"date_time","colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_sms_type_descr",{"value":"Тип","readBind":{"valueFieldId":"sms_type_descr"},"sortable":true,"sortCol":"sms_type","colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_tel",{"value":"Телефон","readBind":{"valueFieldId":"tel"},"sortable":true,"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_body",{"value":"Текст","readBind":{"valueFieldId":"body"}}));row.addElement(new GridDbHeadCell(id+"_col_sent_date_time_descr",{"value":"Отправка","readBind":{"valueFieldId":"sent_date_time_descr"},"sortable":true,"sortCol":"sent_date_time","colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"delivered_date_time_descr",{"value":"Доставка","readBind":{"valueFieldId":"delivered_date_time_descr"},"sortable":true,"sortCol":"delivered_date_time","colAttrs":{"align":"center"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"SMSForSendingList_Model","editViewClass":null,"editInline":null,"pagination":new GridPagination(id+"_page",{"countPerPage":CONSTANT_VALS.grid_rows_per_page_count}),"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true,"noInsert":true,"noEdit":true,"noCopy":true,"noDelete":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"asyncEditRead":true,"winObj":options.winObj}));}
extend(SMSForSendingList_View,ViewList); 
function MailForSendingList_View(id,options){options=options||{};options.title="СМС сообщения";MailForSendingList_View.superclass.constructor.call(this,id,options);var controller=new MailForSending_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_date_time_descr",{"value":"Дата","readBind":{"valueFieldId":"date_time_descr"},"sortable":true,"sort":"desc","sortCol":"date_time","colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_email_type_descr",{"value":"Тип","readBind":{"valueFieldId":"email_type_descr"},"sortable":true,"sortCol":"email_type","colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_to_addr",{"value":"Получатель","readBind":{"valueFieldId":"to_addr"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_body",{"value":"Содержание","readBind":{"valueFieldId":"body"}}));row.addElement(new GridDbHeadCell(id+"_col_sent_date_time_descr",{"value":"Отправка","readBind":{"valueFieldId":"sent_date_time_descr"},"sortable":true,"sortCol":"sent_date_time","colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_send_error",{"value":"Ошибки отправки","readBind":{"valueFieldId":"send_error"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"MailForSendingList_Model","editViewClass":null,"editInline":null,"pagination":new GridPagination(id+"_page",{"countPerPage":CONSTANT_VALS.grid_rows_per_page_count}),"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true,"noInsert":true,"noEdit":true,"noCopy":true,"noDelete":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"asyncEditRead":true,"winObj":options.winObj}));}
extend(MailForSendingList_View,ViewList); 
function ProductGroupList_View(id,options){options=options||{};options.title="Номенклатурные группы";ProductGroupList_View.superclass.constructor.call(this,id,options);var controller=new ProductGroup_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));row.addElement(new GridDbHeadCellBool(id+"_col_match_1c",{"value":"Соответствует 1с","readBind":{"valueFieldId":"match_1c"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ProductGroupList_Model","editViewClass":ProductGroupInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(ProductGroupList_View,ViewList); 
function ProductGroupInline_View(id,options){options=options||{};ProductGroupInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":"ProductGroupList_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":100,"size":50,"required":"required"},"alwaysUpdate":true}),{"modelId":"FirmList_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});}
extend(ProductGroupInline_View,ViewInlineGridEdit); 
function Holiday_View(id,options){options=options||{};options.title="Праздники";Holiday_View.superclass.constructor.call(this,id,options);var controller=new Holiday_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_date",{"readBind":{"valueFieldId":"date"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_date",{"value":"Дата","readBind":{"valueFieldId":"date_str"}}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"HolidayList_Model","editViewClass":HolidayInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noPrint":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(Holiday_View,ViewList); 
function HolidayInline_View(id,options){options=options||{};ProductGroupInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new EditDate(id+"_id",{"name":"date"}),{"modelId":"HolidayList_Model","valueFieldId":"date","keyFieldIds":null},{"valueFieldId":"date_str","keyFieldIds":["date"]});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":100,"size":50}}),{"modelId":"HolidayList_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});}
extend(HolidayInline_View,ViewInlineGridEdit); 
function ClientDebt_View(id,options){options=options||{};options.title="Долги клиентов";ClientDebt_View.superclass.constructor.call(this,id,options);var controller=new Client_Controller(new ServConnector(HOST_NAME));var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"value":"Код","readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_firm_descr",{"value":"Фирма","readBind":{"valueFieldId":"firm_descr"},"colAttrs":{"align":"center"},"sortable":true,"sortCol":"firm_id","sort":"asc"}));row.addElement(new GridDbHeadCell(id+"_col_client_descr",{"value":"Клиент","readBind":{"valueFieldId":"client_descr"},"colAttrs":{"align":"center"},"sortable":true,"sortCol":"client_id"}));row.addElement(new GridDbHeadCell(id+"_col_client_debt_period_days_descr",{"value":"Период просрочки","readBind":{"valueFieldId":"client_debt_period_days_descr"},"colAttrs":{"align":"center"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_days",{"value":"Дней просрочки","readBind":{"valueFieldId":"days"},"colAttrs":{"align":"center"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_def_debt",{"value":"Просроченный долг","readBind":{"valueFieldId":"def_debt"},"colAttrs":{"align":"center"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_debt_total",{"value":"Долг всего","readBind":{"valueFieldId":"debt_total"},"colAttrs":{"align":"center"},"sortable":true}));row.addElement(new GridDbHeadCell(id+"_col_update_date_descr",{"value":"Дата обновления","readBind":{"valueFieldId":"update_date_descr"},"colAttrs":{"align":"center"}}));head.addElement(row);var cmd=new GridCommands(id+"_grid_cmd",{"noInsert":true,"noEdit":true,"noCopy":true,"noDelete":true,"noRefresh":true});this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"readMethodId":"get_debt_list","controller":controller,"readModelId":"ClientDebtList_Model","editViewClass":null,"editInline":null,"pagination":null,"commandPanel":cmd,"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj});cmd.addElement(new BtnRefreshClientDebts({"grid":this.m_grid}));this.addElement(this.m_grid);}
extend(ClientDebt_View,ViewList); 
function NaspunktList_View(id,options){options=options||{};options.title="Организации";NaspunktList_View.superclass.constructor.call(this,id,options);var controller=new Naspunkt_Controller(options.connect);var filter=new GridFilter(uuid(),{"tagName":"div"});filter.addFilterControl(new ProductionCityEditObject("city_id","city",false),{"sign":"e","valueFieldId":"city_id"});var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_city_descr",{"value":"Город","readBind":{"valueFieldId":"city_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_name",{"value":"Наименование","readBind":{"valueFieldId":"name"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_distance",{"value":"Расстояние","readBind":{"valueFieldId":"distance"},"colAttrs":{"aligne":"right"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"NaspunktList_Model","editViewClass":NaspunktInline_View,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller}),"rowCommandPanelClass":null,"filter":filter,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(NaspunktList_View,ViewList); 
function NaspunktInline_View(id,options){options=options||{};NaspunktInline_View.superclass.constructor.call(this,id,options);this.addDataControl(new Edit(id+"_id",{"name":"id","visible":false}),{"modelId":"NaspunktList_Model","valueFieldId":"id","keyFieldIds":null},{"valueFieldId":"id","keyFieldIds":null},{"autoFillOnInsert":true});this.addDataControl(new ProductionCityEditObject("city_id",id+"_city",true),{"modelId":"NaspunktList_Model","valueFieldId":"city_descr","keyFieldIds":["city_id"]},{"valueFieldId":null,"keyFieldIds":["city_id"]});this.addDataControl(new EditString(id+"_name",{"attrs":{"maxlength":100,"required":"required"}}),{"modelId":"NaspunktList_Model","valueFieldId":"name","keyFieldIds":null},{"valueFieldId":"name","keyFieldIds":null});this.addDataControl(new EditNum(id+"_distance",{"attrs":{"maxlength":5,"required":"required",}}),{"modelId":"NaspunktList_Model","valueFieldId":"distance","keyFieldIds":null},{"valueFieldId":"distance","keyFieldIds":null});}
extend(NaspunktInline_View,ViewInlineGridEdit); 
function RepNaspunktCost_View(id,options){options=options||{};options.controller=Report_Controller;options.methodId="naspunkt_cost";options.viewId="ViewHTMLXSLT";options.connect=options.connect;options.reportControl=new Control(id+"_rep","div",{className:"panel panel-body"});RepNaspunktCost_View.superclass.constructor.call(this,id,options);this.m_cityCtrl=new ProductionCityEditObject("city_id",id+"_city",false,null,{"editContClassName":"input-group "+get_bs_col()+"2"});this.addFilterContainer([{"control":this.m_cityCtrl,"filter":{"sign":"e","keyFieldIds":["city_id"]}}]);this.addCmdMakeReport();}
extend(RepNaspunktCost_View,PPViewReport);RepNaspunktCost_View.prototype.addExtraParams=function(struc){RepNaspunktCost_View.superclass.addExtraParams.call(this,struc);struc.templ="RepNaspunktCost";}
RepNaspunktCost_View.prototype.makeReport=function(async){if(this.m_cityCtrl.getValue()=="undefined"){this.onError(null,"","Не выбран город!");return;}
RepNaspunktCost_View.superclass.makeReport.call(this,async);} 
function AccPKOList_View(id,options){options=options||{};options.title="ПКО";AccPKOList_View.superclass.constructor.call(this,id,options);var controller=new AccPKO_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_id",{"readBind":{"valueFieldId":"id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_date_time_descr",{"value":"Дата","readBind":{"valueFieldId":"date_time_descr"},"descrCol":true,"sortable":true,"sort":"desc","sortCol":"date_time"}));row.addElement(new GridDbHeadCell(id+"_col_acc_pko_type_descr",{"value":"Тип","readBind":{"valueFieldId":"acc_pko_type_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_order_list",{"value":"Номера заявок","readBind":{"valueFieldId":"order_list"}}));row.addElement(new GridDbHeadCell(id+"_col_total",{"value":"Сумма","colAttrs":{"align":"right"},"readBind":{"valueFieldId":"total"}}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"AccPKOList_Model","editViewClass":WarehouseDialog_View,"editInline":false,"pagination":new GridPagination(id+":page",{"countPerPage":CONSTANT_VALS.grid_rows_per_page_count}),"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noInsert":true,"noEdit":true,"noDelete":true,"noCopy":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"asyncEditRead":false,"winObj":options.winObj}));}
extend(AccPKOList_View,ViewList); 
function RepVehicleStop_View(id,options){options=options||{};options.controller=Report_Controller;options.methodId="vehicle_stops";options.viewId="ViewHTMLXSLT";options.connect=options.connect;options.reportControl=new Control(id+"_rep","div",{className:"panel panel-body"});RepVehicleStop_View.superclass.constructor.call(this,id,options);var period=new EditPeriodDateTime(id+"_period");period.getControlFrom().m_editContClassName="input-group "+get_bs_col()+"2";period.getControlTo().m_editContClassName="input-group "+get_bs_col()+"2";var d1=new Date();d1.setHours(0,0,0,0);var d2=new Date();d2.setHours(23,59,59,0);period.getControlFrom().setValue(DateHandler.dateToStr(d1,"dd/mm/y hh:mmin:ss"));period.getControlTo().setValue(DateHandler.dateToStr(d2,"dd/mm/y hh:mmin:ss"));this.addFilterContainer([{"control":period.getControlFrom(),"filter":{"sign":"ge","valueFieldId":"date_time"}},{"control":period.getControlTo(),"filter":{"sign":"le","valueFieldId":"date_time"}},{"control":new EditList(id+"_vehicle_list",{"labelCaption":"Список ТС:","editContClassName":"input-group "+get_bs_col()+"3","editViewControl":new VehicleEditObject({"fieldId":"vh_id_list","controlId":"vehicle_list","inLine":true,"id":id+"_edit","attrs":{"required":"required"}})}),"filter":{"sign":"incl","valueFieldId":["vh_id_list"]}},{"control":new EditTime(id+"_duration",{"editContClassName":"input-group "+get_bs_col()+"2","labelCaption":"Длительность стоянок:","editMask":"$d$d:$d$d","attrs":{"maxlength":"5"},"value":"00:10"}),"filter":{"sign":"e","valueFieldId":"duration"}}]);this.addCmdMakeReport();}
extend(RepVehicleStop_View,PPViewReport);RepVehicleStop_View.prototype.addExtraParams=function(struc){RepVehicleStop_View.superclass.addExtraParams.call(this,struc);struc.templ="RepVehicleStop";} 
function DOCOrderAppend_View(id,options){options=options||{};DOCOrderAppend_View.superclass.constructor.call(this,id.options);this.m_onClose=options.onClose;var controller=new DOCOrder_Controller(new ServConnector(HOST_NAME));var pm=controller.getPublicMethodById("get_append_list");pm.setParamValue("doc_id",options.doc_id);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_doc_id",{"readBind":{"valueFieldId":"doc_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_selected",{"value":"Выб","readBind":{"valueFieldId":"selected"},"colAttrs":{"align":"center"},"colControlContainer":{"objectClass":EditCheckBox,"objectOptions":{"attrs":{"selectForJoin":"1"}}}}));row.addElement(new GridDbHeadCell(id+"_col_doc_number",{"value":"№","readBind":{"valueFieldId":"doc_number"},"descrCol":true,"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_firm_descr",{"value":"Фирма","readBind":{"valueFieldId":"firm_descr"}}));row.addElement(new GridDbHeadCell(id+"_col_doc_total",{"value":"Сумма","readBind":{"valueFieldId":"doc_total"},"colAttrs":{"align":"right"}}));head.addElement(row);this.m_grid=new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readMethodId":"get_append_list","readModelId":"DOCOrderAppendList_Model","editViewClass":null,"editInline":true,"pagination":null,"commandPanel":null,"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj});this.addElement(this.m_grid);var self=this;this.addElement(new ButtonCmd(id+"btnOk",{"caption":"Выбрать","onClick":function(){var n=self.m_grid.getBody().getNode();var list=DOMHandler.getElementsByAttr("1",n,"selectForJoin",false,"input");var id_list="";for(var i=0;i<list.length;i++){if(list[i].checked){var row=DOMHandler.getParentByTagName(list[i],"tr");var keys=json2obj(row.getAttribute("key_values"));id_list+=(id_list=="")?"":",";id_list+=keys.doc_id;}}
self.m_onClose(true,id_list);},"attrs":{"title":"выбрать для объединения"}}));this.addElement(new ButtonCmd(id+"btnCancel",{"caption":"Отмена","onClick":function(){self.m_selectRes=false;self.m_onClose(false);},"attrs":{"title":"отказаться от объединения"}}));}
extend(DOCOrderAppend_View,ViewList); 
function ProdBatch1CList_View(id,options){options=options||{};options.title="Партии продукции";ProdBatch1CList_View.superclass.constructor.call(this,id,options);var controller=new ProdBatch_Controller(options.connect);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_ext_id",{"readBind":{"valueFieldId":"ext_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_batch_descr",{"value":"Партия","colAttrs":{"align":"left"},"readBind":{"valueFieldId":"batch_descr"},"descrCol":true}));head.addElement(row);this.addElement(new GridDb(id+"_grid",{"head":head,"body":new GridBody(),"controller":controller,"readModelId":"ProdBatch1CList_Model","readMethodId":"get_list","editViewClass":null,"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"controller":controller,"noInsert":true,"noEdit":true,"noDelete":true,"noCopy":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"asyncEditRead":false,"winObj":options.winObj}));}
extend(ProdBatch1CList_View,ViewList); 
function DOCOrderDOCTProdBatchList_View(id,options){options=options||{};DOCOrderDOCTProdBatchList_View.superclass.constructor.call(this,id,options);var head=new GridHead();var row=new GridRow(id+"_row1");row.addElement(new GridDbHeadCell(id+"_col_view_id",{"readBind":{"valueFieldId":"view_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_line_number",{"value":"№","readBind":{"valueFieldId":"line_number"},"keyCol":true,"colAttrs":{"align":"center"}}));row.addElement(new GridDbHeadCell(id+"_col_ext_id",{"readBind":{"valueFieldId":"ext_id"},"keyCol":false,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_batch_descr",{"value":"Партия","readBind":{"valueFieldId":"batch_descr"},"descrCol":true}));head.addElement(row);this.m_getOrderId=options.getOrderId;let self=this;this.setGridControl(new GridDbDOCT(id+"_grid",{"head":head,"body":new GridBody(),"controller":new DOCOrderDOCTProdBatch_Controller(new ServConnector(HOST_NAME)),"readModelId":"DOCOrderDOCTProdBatchList_Model","editViewClass":DOCOrderDOCTProdBatchInline_View,"editViewParams":{"getOrderId":function(){return self.m_getOrderId();}},"editInline":true,"pagination":null,"commandPanel":new GridCommands(id+"_cmd",{"noInsert":false,"noCopy":true,"noDelete":false,"noPrint":true,"noRefresh":true}),"rowCommandPanelClass":null,"filter":null,"refreshInterval":0,"onSelect":options.onSelect,"winObj":options.winObj}));}
extend(DOCOrderDOCTProdBatchList_View,ViewDocumentDetail);DOCOrderDOCTProdBatchList_View.prototype.setOrderId=function(orderId){this.m_orderId=orderId;} 
function DOCOrderDOCTProdBatchInline_View(id,options){options=options||{};var model_id="DOCOrderDOCTProdBatchList_Model";options.readModelId=model_id;DOCOrderDOCTProdBatchInline_View.superclass.constructor.call(this,id,options);var self=this;this.m_prodBatchCtrl=new ProdBatchEdit({"fieldId":"ext_id","controlId":(id+"batch"),"noOpen":true,"winObj":options.winObj,"mainView":this,"inLine":true,"orderId":options.params.getOrderId()});this.addDataControl(this.m_prodBatchCtrl,{"modelId":model_id,"valueFieldId":"batch_descr","keyFieldIds":["ext_id"]},{"valueFieldId":null,"keyFieldIds":["ext_id"]});}
extend(DOCOrderDOCTProdBatchInline_View,ViewInlineGridEditDOCT); 
function NewClientInf_View(id,options){options=options||{};options.value=options.clientName;options.className="new_client_ref";this.m_clientId=options.clientId;this.m_clientName=options.clientName;NewClientInf_View.superclass.constructor.call(this,id,"a",options);}
extend(NewClientInf_View,ControlContainer);NewClientInf_View.prototype.toDOM=function(parent){NewClientInf_View.superclass.toDOM.call(this,parent);var self=this;EventHandler.addEvent(this.m_node,"click",function(){self.m_winObj=new WindowFormDD({"title":self.m_clientName,"width":self.WIN_WIDTH,"height":self.WIN_HEIGHT,});var controller=new Client_Controller(new ServConnector(HOST_NAME));var view=new ClientDialog_View("ClientDialog_View",{"onClose":function(res){self.m_winObj.close();},"readController":controller,"readModelId":"get_object","connect":controller.getServConnector(),"winObj":self.m_winObj});view.setReadIdValue("id",self.m_clientId);view.readData();self.m_winObj.open();view.toDOM(self.m_winObj.getContentParent());self.m_winObj.setFocus();},true);}
NewClientInf_View.prototype.WIN_WIDTH=600;NewClientInf_View.prototype.WIN_HEIGHT=1200;function UnregClientCheck(checkIntervalSec){this.check();var self=this;this.m_intervalObj=setInterval(function(){self.check();},((checkIntervalSec<this.CHECK_MIN_SEC)?this.CHECK_MIN_SEC:checkIntervalSec)*1000);}
UnregClientCheck.prototype.WIN_WIDTH=300;UnregClientCheck.prototype.WIN_HEIGHT=100;UnregClientCheck.prototype.CHECK_MIN_SEC=30;UnregClientCheck.prototype.get_win_pos_top=function(){return getViewportHeight()-this.WIN_HEIGHT-50;}
UnregClientCheck.prototype.get_win_pos_left=function(){return"0";}
UnregClientCheck.prototype.check=function(){var con=new ServConnector(HOST_NAME);var contr=new Client_Controller(con);var self=this;contr.run("get_unreg_list",{"async":true,"func":function(resp){self.onGetData(resp)},"err":this.onError});}
UnregClientCheck.prototype.onGetData=function(resp){var m=resp.getModelById("get_unreg_list");m.setActive(true);if(m.getRowCount()==0){if(this.m_content)this.m_content.removeDOM();if(this.m_win)this.m_win.close();}
else{if(!this.m_win){var self=this;this.m_win=new WindowFormDD({"top":this.get_win_pos_top(),"left":this.get_win_pos_left(),"onBeforeClose":function(){self.m_closed=true;return true;}});this.m_win.setCaption("Новый клиент");this.m_win.setWidth(this.WIN_WIDTH);this.m_win.setHeight(this.WIN_HEIGHT);this.m_content=new ControlContainer("ureg_client_check","div");this.m_closed=true;}
else{this.m_content.removeDOM();this.m_content.clear();}
while(m.getNextRow()){var id=m.getFieldValue("id");this.m_content.addElement(new NewClientInf_View("new_client_"+id,{"clientId":id,"clientName":m.getFieldValue("name")}));}
if(this.m_closed){this.m_win.open();this.m_closed=false;}
this.m_content.toDOM(this.m_win.getContentParent());this.m_win.setFocus();}}
UnregClientCheck.prototype.onError=function(resp,erCode,erStr){} 
function ClientAttrs(attrs,formContext){attrs["name"]=new EditString("Client_name",{"labelCaption":"Наименование:","name":"name","buttonClear":false,"tableLayout":false,"attrs":{"maxlength":150,"size":70,"required":"required"}});attrs["inn"]=new EditNum("Client_inn",{"labelCaption":"ИНН:","name":"inn","buttonSelect":new ButtonOrgSearch("Client_inn_btn_sel",{"viewContext":formContext,"checkIfExists":"1"}),"buttonClear":false,"tableLayout":false,"minLength":10,"attrs":{"maxlength":12,"size":20,"required":"required"}});attrs["kpp"]=new EditNum("Client_kpp",{"labelCaption":"КПП:","name":"kpp","buttonSelect":false,"buttonClear":false,"tableLayout":false,"attrs":{"maxlength":10,"size":20}});attrs["addr_reg"]=new EditString("Client_addr_reg",{"labelCaption":"Адрес юридический:","name":"addr_reg","buttonClear":false,"tableLayout":false,"attrs":{"size":70,"required":"required"}}),attrs["addr_mail_same_as_reg"]=new EditCheckBox("Client_addr_mail_same_as_reg",{"labelCaption":"Фактический адрес совпадает с юридическим","name":"addr_mail_same_as_reg","labelAlign":"left","tableLayout":false,"attrs":{"checked":"checked"}});attrs["addr_mail"]=new EditString("Client_addr_mail",{"labelCaption":"Адрес фактический:","name":"addr_mail","buttonClear":false,"tableLayout":false,"attrs":{"size":70,"disabled":"disabled"}});attrs["telephones"]=new EditString("Client_telephones",{"labelCaption":"Телефоны:","name":"telephones","buttonClear":false,"tableLayout":false,"attrs":{"size":20,"required":"required"}});attrs["email"]=new EditString("Client_email",{"labelCaption":"Эл.почта:","name":"email","buttonClear":false,"tableLayout":false,"attrs":{"size":50,"required":"required"}});attrs["acc"]=new EditNum("Client_acc",{"labelCaption":"Расчетный счет:","name":"acc","buttonClear":false,"tableLayout":false,"fixedLength":true,"attrs":{"maxlength":20,"size":20,"required":"required"}});attrs["bank_name"]=new EditString("Client_bank_name",{"labelCaption":"Банк:","name":"bank_name","buttonClear":false,"tableLayout":false,"attrs":{"size":70,"required":"required"}});attrs["bank_code"]=new EditObject("Client_bank_code",{"labelCaption":"БИК:","name":"bank_code","buttonClear":false,"tableLayout":false,"fixedLength":true,"attrs":{"maxlength":9,"size":20,"required":"required","placeholder":"Введите БИК для поиска"},"methodId":"complete","modelId":"BankList_Model","lookupValueFieldId":"bik","lookupKeyFieldIds":["bik"],"keyFieldIds":["bank_code"],"controller":new Bank_Controller(new ServConnector(HOST_NAME)),"minLengthForQuery":2,"noSelect":true,"extraFields":["korshet","name"],"buttonSelect":new ButtonCtrl("Client_bank_code_btn_sel",{"glyph":"glyphicon-search","title":"Найти по БИК","onClick":function(){var node=nd("Client_bank_code");if(!node.value||!node.value.length){throw new Error("Не задан параметр поиска!");}
var contr=new Bank_Controller(new ServConnector(HOST_NAME));var self=this;contr.run("get_object",{"params":{"bik":node.value},"func":function(resp){var m=resp.getModelById("BankList_Model",true);if(m.getNextRow()){nd("Client_bank_name").value=m.getFieldValue("name");nd("Client_bank_acc").value=m.getFieldValue("korshet");node.setAttribute("fkey_bank_code",node.value);DOMHandler.removeClass(node,"error");attrs["bank_code"].setValid();attrs["bank_code"].setComment("");}
else{nd("Client_bank_name").value="";nd("Client_bank_acc").value="";node.setAttribute("fkey_bank_code","");if(!DOMHandler.hasClass(node,"error")){DOMHandler.addClass(node,"error");}
if(!DOMHandler.hasClass(node,"incorrect_val")){DOMHandler.addClass(node,"incorrect_val");}
attrs["bank_code"].setComment("Банк не найден!");}}});}}),"onSelected":function(node){nd("Client_bank_acc").value=DOMHandler.getAttr(node,"korshet");nd("Client_bank_name").value=DOMHandler.getAttr(node,"name");}});attrs["bank_acc"]=new EditNum("Client_bank_acc",{"labelCaption":"Корр. счет:","name":"bank_acc","buttonClear":false,"tableLayout":false,"fixedLength":true,"attrs":{"maxlength":20,"size":20,"required":"required"}});attrs["okpo"]=new EditNum("Client_okpo",{"labelCaption":"ОКПО:","name":"okpo","buttonSelect":false,"buttonClear":false,"tableLayout":false,"attrs":{"maxlength":20,"size":20}});attrs["ogrn"]=new EditNum("Client_ogrn",{"labelCaption":"ОГРН:","name":"ogrn","buttonSelect":false,"buttonClear":false,"tableLayout":false,"attrs":{"maxlength":15,"size":20}});} 
function ClientUserGridRowCommands(id,options){options=options||{};options.onClickDelete=null;options.onClickEdit=null;ClientUserGridRowCommands.superclass.constructor.call(this,id,options);this.setElementById("reset_pwd",new Button(null,{"caption":"Новый пароль","onClick":function(){WindowQuestion.show({"text":"Пользователю будет назначен новый пароль, продолжить?",callBack:function(res){if(res==WindowQuestion.RES_YES){var contr=new ClientUser_Controller(new ServConnector(HOST_NAME));contr.run("reset_pwd",{"params":{"user_id":options.keys["id"]},"func":function(){window.showTempNote("Пользователю отправлен новый пароль.",null,ERR_MSG_WAIT_MS);}});}}})},"attrs":{"title":"отправить на почту новый пароль"}}));}
extend(ClientUserGridRowCommands,GridRowCommands); 
function FirmEditObject(fieldId,controlId,inLine,defaultId,opts){var contr=new Firm_Controller(new ServConnector(HOST_NAME))
var pm=contr.getPublicMethodById(contr.METH_GET_LIST);pm.setParamValue(contr.PARAM_COND_FIELDS,"deleted");pm.setParamValue(contr.PARAM_COND_VALS,"false");pm.setParamValue(contr.PARAM_COND_SGNS,"e");options={"tableLayout":false,"methodId":"get_list","modelId":"FirmList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":contr,"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":FirmList_View,"defaultId":(defaultId==undefined)?"undefined":defaultId};for(var opt in opts){options[opt]=opts[opt];}
options.attrs=options.attrs||{};if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Организация:";}
FirmEditObject.superclass.constructor.call(this,controlId,options);}
extend(FirmEditObject,EditSelectObject);function ContractStateEditObject(fieldId,controlId,inLine,defaultId){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_enum_list","modelId":"EnumList_Model","lookupValueFieldId":"descr","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new Enum_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":null,"methParams":{"id":"contract_states"},"defaultId":(defaultId==undefined)?"undefined":defaultId};if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Состояние:";}
ContractStateEditObject.superclass.constructor.call(this,controlId,options);}
extend(ContractStateEditObject,EditSelectObject);function ProductionCityEditObject(fieldId,controlId,inLine,defaultId,opts){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_list","modelId":"ProductionCityList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new ProductionCity_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":ProductionCityList_View,"defaultId":(defaultId==undefined)?"undefined":defaultId};opts=opts||{};for(var opt in opts){options[opt]=opts[opt];}
if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Город отгрузки:";}
ProductionCityEditObject.superclass.constructor.call(this,controlId,options);}
extend(ProductionCityEditObject,EditSelectObject);function MeasureUnitEditObject(fieldId,controlId,inLine,defaultId,opts){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_list","modelId":"MeasureUnitList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new MeasureUnit_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":MeasureUnitList_View,"defaultId":(defaultId==undefined)?"undefined":defaultId};opts=opts||{};for(var opt in opts){options[opt]=opts[opt];}
if((inLine==undefined||(inLine!=undefined&&!inLine))&&!options.labelCaption){options.labelCaption="Базовая единица:";}
MeasureUnitEditObject.superclass.constructor.call(this,controlId,options);}
extend(MeasureUnitEditObject,EditSelectObject);function ProductMeasureUnitEditObject(opts){var contr=new ProductMeasureUnit_Controller(new ServConnector(HOST_NAME));var pm=contr.getPublicMethodById(contr.METH_GET_LIST);pm.setParamValue(contr.PARAM_COND_FIELDS,"product_id,in_use");pm.setParamValue(contr.PARAM_COND_SGNS,"e,e");pm.setParamValue(contr.PARAM_COND_VALS,opts.productId+",true");options={"attrs":{"required":"required"},"name":opts.fieldId,"tableLayout":false,"methodId":"get_list","modelId":"ProductMeasureUnit_Model","lookupValueFieldId":"measure_unit_descr","lookupKeyFieldIds":["measure_unit_id"],"keyFieldIds":[opts.fieldId],"controller":contr,"objectView":null,"noSelect":false,"noOpen":true,"listView":ProductMeasureUnitList_View,"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Единица:";}
ProductMeasureUnitEditObject.superclass.constructor.call(this,opts.controlId,options);}
extend(ProductMeasureUnitEditObject,EditSelectObject);function ClientEditObject(fieldId,controlId,inLine,opts){opts=opts||{};options={"methodId":"complete","tableLayout":false,"modelId":"ClientComplete_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new Client_Controller(new ServConnector(HOST_NAME)),"minLengthForQuery":1,"mid":"1","objectView":ClientDialog_View,"noSelect":false,"noOpen":opts.noOpen||false,"listView":ClientSelectList_View,"value":opts.descr,"attrs":{"fkey_client_id":opts.id||""}};if(opts.required===true||opts.required==undefined){options.attrs.required="required";}
for(var opt in opts){options[opt]=opts[opt];}
if((inLine==undefined||(inLine!=undefined&&!inLine))&&options.labelCaption==undefined){options["labelCaption"]="Заказчик:";}
ClientEditObject.superclass.constructor.call(this,controlId,options);}
extend(ClientEditObject,EditObject);function ProductEditObject(fieldId,controlId,inLine,defaultId,opts){var contr=new Product_Controller(new ServConnector(HOST_NAME));var pm=contr.getPublicMethodById(contr.METH_GET_LIST);pm.setParamValue(contr.PARAM_COND_FIELDS,"deleted");pm.setParamValue(contr.PARAM_COND_VALS,"false");pm.setParamValue(contr.PARAM_COND_SGNS,"e");options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_list","modelId":"ProductList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":contr,"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":ProductList_View,"defaultId":(defaultId==undefined)?"undefined":defaultId,"editContClassName":"input-group "+get_bs_col()+"3"};opts=opts||{};for(var opt in opts){options[opt]=opts[opt];}
if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Продукция:";}
ProductEditObject.superclass.constructor.call(this,controlId,options);}
extend(ProductEditObject,EditSelectObject);function ProductForFilterEditObject(fieldId,controlId,inLine,defaultId){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_filter_list","modelId":"ProductFilterList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new Product_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":ProductList_View,"defaultId":(defaultId==undefined)?"undefined":defaultId,"editContClassName":"input-group "+get_bs_col()+"3"};if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Продукция:";}
ProductForFilterEditObject.superclass.constructor.call(this,controlId,options);}
extend(ProductForFilterEditObject,EditSelectObject);function DelivTypeEditObject(opts){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_enum_list","modelId":"EnumList_Model","lookupValueFieldId":"descr","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":new Enum_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":null,"methParams":{"id":"delivery_types"},"defaultId":(opts.defaultId==undefined)?"by_supplier":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Вид доставки:";}
DelivTypeEditObject.superclass.constructor.call(this,opts.controlId,options);}
extend(DelivTypeEditObject,EditSelectObject);function DeliveryPeriodEditObject(fieldId,controlId,inLine,defaultId,opts){options={"tableLayout":false,"methodId":"get_list","modelId":"DeliveryPeriod_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new DeliveryPeriod_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":DeliveryPeriodList_View,"defaultId":(defaultId==undefined)?"undefined":defaultId};opts=opts||{};for(var opt in opts){options[opt]=opts[opt];}
if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Период:";}
DeliveryPeriodEditObject.superclass.constructor.call(this,controlId,options);}
extend(DeliveryPeriodEditObject,EditSelectObject);function WarehouseEditObject(fieldId,controlId,inLine,defaultId,opts){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_list","modelId":"WarehouseList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new Warehouse_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":WarehouseList_View,"defaultId":(defaultId==undefined)?"undefined":defaultId};for(var opt in opts){options[opt]=opts[opt];}
if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Склад:";}
WarehouseEditObject.superclass.constructor.call(this,controlId,options);}
extend(WarehouseEditObject,EditSelectObject);function OrderWarehouseEditObject(fieldId,controlId,inLine,defaultId,opts){var contr=new Warehouse_Controller(new ServConnector(HOST_NAME));this.m_pm=contr.getPublicMethodById("get_list_for_order");this.m_pm.setParamValue("product_id","0");options={"tableLayout":false,"methodId":"get_list_for_order","modelId":"WarehouseList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":contr,"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":WarehouseList_View,"defaultId":(defaultId==undefined)?"undefined":defaultId};for(var opt in opts){options[opt]=opts[opt];}
options.attrs=options.attrs||{};options.attrs.required="required";if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Склад:";}
OrderWarehouseEditObject.superclass.constructor.call(this,controlId,options);}
extend(OrderWarehouseEditObject,EditSelectObject);OrderWarehouseEditObject.prototype.setProductId=function(productId){this.m_pm.setParamValue("product_id",productId);}
function ClientUserEditObject(fieldId,controlId,inLine,defaultId,opts){var contr=new ClientUser_Controller(new ServConnector(HOST_NAME));this.m_pm=contr.getPublicMethodById(contr.METH_GET_LIST);this.m_pm.setParamValue(contr.PARAM_COND_FIELDS,"client_id");this.m_pm.setParamValue(contr.PARAM_COND_SGNS,"e");this.m_paramId=contr.PARAM_COND_VALS;options={"tableLayout":false,"methodId":"get_list","modelId":"ClientUserList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":contr,"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":ClientUserList_View,"defaultId":(defaultId==undefined)?"undefined":defaultId,"noAutoRefresh":true};opts=opts||{};for(var opt in opts){options[opt]=opts[opt];}
if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Ответственный:";}
ClientUserEditObject.superclass.constructor.call(this,controlId,options);}
extend(ClientUserEditObject,EditSelectObject);ClientUserEditObject.prototype.setClientId=function(clientId){this.m_pm.setParamValue(this.m_paramId,clientId);}
function ProductForOrderEditObject(opts){var contr=new Product_Controller(new ServConnector(HOST_NAME));this.m_pm=contr.getPublicMethodById("get_list_for_order");this.m_pm.setParamValue("warehouse_id","0");var pm=contr.getPublicMethodById("get_list");pm.setParamValue(contr.PARAM_COND_FIELDS,"deleted");pm.setParamValue(contr.PARAM_COND_VALS,"false");pm.setParamValue(contr.PARAM_COND_SGNS,"e");options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_list","modelId":"ProductList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":contr,"objectView":null,"noSelect":false,"noOpen":true,"listView":ProductList_View,"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Продукция:";}
ProductForOrderEditObject.superclass.constructor.call(this,opts.controlId,options);}
extend(ProductForOrderEditObject,EditSelectObject);ProductForOrderEditObject.prototype.setWarehouseId=function(warehouseId){this.m_pm.setParamValue("warehouse_id",warehouseId);}
function OrderStateEditObject(fieldId,controlId,inLine,defaultId,opts){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_enum_list","modelId":"EnumList_Model","lookupValueFieldId":"descr","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new Enum_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":null,"methParams":{"id":"order_states"},"defaultId":(defaultId==undefined)?"undefined":defaultId};for(var opt in opts){options[opt]=opts[opt];}
if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Статус:";}
OrderStateEditObject.superclass.constructor.call(this,controlId,options);}
extend(OrderStateEditObject,EditSelectObject);function UserEditObject(fieldId,controlId,inLine,defaultId,opts){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_list","modelId":"UserList_Model","lookupValueFieldId":"name_full","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new User_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":UserList_View,"defaultId":(defaultId==undefined)?"undefined":defaultId};opts=opts||{};for(var opt in opts){options[opt]=opts[opt];}
if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Пользователь:";}
UserEditObject.superclass.constructor.call(this,controlId,options);}
extend(UserEditObject,EditSelectObject);function CustSurvQuesionEditObject(fieldId,controlId,inLine,defaultId){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_list","modelId":"CustomerSurveyQuestion_Model","lookupValueFieldId":null,"lookupKeyFieldIds":null,"keyFieldIds":[fieldId],"controller":new CustomerSurveyQuestion_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":true,"noOpen":true,"winObj":this.m_winObj,"listView":null,"defaultId":(defaultId==undefined)?"undefined":defaultId,"enabled":false,"buttonClear":false};if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Вопрос:";}
CustSurvQuesionEditObject.superclass.constructor.call(this,controlId,options);}
extend(CustSurvQuesionEditObject,EditObject);function DriverEditObject(fieldId,controlId,inLine,opts){opts=opts||{};options={"methodId":"complete","tableLayout":false,"modelId":"DriverList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new Driver_Controller(new ServConnector(HOST_NAME)),"minLengthForQuery":1,"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":DriverList_View,"value":opts.descr,"attrs":{"required":"required","fkey_driver_id":opts.id||""}};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Водитель:";}
DriverEditObject.superclass.constructor.call(this,controlId,options);}
extend(DriverEditObject,EditObject);function CarrierEditObject(fieldId,controlId,inLine,opts){opts=opts||{};options={"methodId":"get_list","tableLayout":false,"modelId":"CarrierList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new Carrier_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":CarrierList_View,"value":opts.descr,"attrs":{"required":"required","fkey_carrier_id":opts.id||""}};if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Перевозчик:";}
CarrierEditObject.superclass.constructor.call(this,controlId,options);}
extend(CarrierEditObject,EditSelectObject);function PayTypeEditObject(fieldId,controlId,inLine,defaultId,opts){opts=opts||{};options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_enum_list","modelId":"EnumList_Model","lookupValueFieldId":"descr","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new Enum_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":null,"methParams":{"id":"payment_types"},"defaultId":(defaultId==undefined)?"undefined":defaultId};for(var opt in opts){options[opt]=opts[opt];}
if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Условия оплаты:";}
PayTypeEditObject.superclass.constructor.call(this,controlId,options);}
extend(PayTypeEditObject,EditSelectObject);function DelivCostEditObject(opts){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_enum_list","modelId":"EnumList_Model","lookupValueFieldId":"descr","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":new Enum_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":null,"methParams":{"id":"deliv_cost_types"},"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Тип:";}
DelivCostEditObject.superclass.constructor.call(this,opts.controlId,options);}
extend(DelivCostEditObject,EditSelectObject);function SMSTypeEditObject(fieldId,controlId,inLine,defaultId){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_enum_list","modelId":"EnumList_Model","lookupValueFieldId":"descr","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new Enum_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":null,"methParams":{"id":"sms_types"},"defaultId":(defaultId==undefined)?"undefined":defaultId};if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Тип:";}
SMSTypeEditObject.superclass.constructor.call(this,controlId,options);}
extend(SMSTypeEditObject,EditSelectObject);function EmailTypeEditObject(fieldId,controlId,inLine,defaultId){options={"attrs":{"required":"required"},"tableLayout":false,"methodId":"get_enum_list","modelId":"EnumList_Model","lookupValueFieldId":"descr","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":new Enum_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":null,"methParams":{"id":"email_types"},"defaultId":(defaultId==undefined)?"undefined":defaultId};if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Тип:";}
EmailTypeEditObject.superclass.constructor.call(this,controlId,options);}
extend(EmailTypeEditObject,EditSelectObject);function DelivCostOptEdit(opts){options={"attrs":{"required":"required"},"tableLayout":true,"methodId":"get_list","modelId":"DelivCostOptList_Model","lookupValueFieldId":"descr","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":new DelivCostOpt_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":DelivCostOptList_View,"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Ценовая категория ТС:";}
DelivCostOptEdit.superclass.constructor.call(this,opts.controlId,options);}
extend(DelivCostOptEdit,EditSelectObject);function VehicleListEdit(opts){options={"tableLayout":false,"methodId":"get_select_list","modelId":"VehicleSelectList_Model","lookupValueFieldId":"descr","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":new Vehicle_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":VehicleList_View,"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="ТС:";}
VehicleListEdit.superclass.constructor.call(this,opts.controlId,options);}
extend(VehicleListEdit,EditSelectObject);function ClientActivityEdit(opts){options={"tableLayout":false,"methodId":"get_list","modelId":"ClientActivityList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":new ClientActivity_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":ClientActivity_View,"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Вид деятельности:";}
ClientActivityEdit.superclass.constructor.call(this,opts.controlId,options);}
extend(ClientActivityEdit,EditSelectObject);function SertTypeEdit(opts){options={"tableLayout":false,"methodId":"get_list","modelId":"SertType_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":new SertType_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":SertType_View,"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Сертификат:";}
SertTypeEdit.superclass.constructor.call(this,opts.controlId,options);}
extend(SertTypeEdit,EditSelectObject);function TrackServerEdit(opts){options={"tableLayout":false,"methodId":"get_list","modelId":"TrackerServer_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":new TrackerServer_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":TrackerServerList_View,"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Сервер:";}
TrackServerEdit.superclass.constructor.call(this,opts.controlId,options);}
extend(TrackServerEdit,EditSelectObject);function TrackerEdit(opts){options={"tableLayout":false,"methodId":"get_list","modelId":"TrackerList_Model","lookupValueFieldId":"id","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":new Tracker_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":TrackerList_View,"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Трекер:";}
TrackerEdit.superclass.constructor.call(this,opts.controlId,options);}
extend(TrackerEdit,EditSelectObject);function VehicleEditObject(opts){opts=opts||{};options={"methodId":"complete","tableLayout":false,"modelId":"VehicleSelectList_Model","lookupValueFieldId":"complete_descr","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":new Vehicle_Controller(new ServConnector(HOST_NAME)),"minLengthForQuery":1,"ic":"1","mid":"1","objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":VehicleList_View,"value":opts.descr,"attrs":{"required":"required","fkey_vehicle_id":opts.id||""}};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Автомобиль:";}
VehicleEditObject.superclass.constructor.call(this,opts.controlId,options);}
extend(VehicleEditObject,EditObject);function ProductGroupEdit(opts){options={"tableLayout":false,"methodId":"get_list","modelId":"ProductGroupList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"controller":new ProductGroup_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":ProductGroupList_View,"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Номенкл.группа:";}
ProductGroupEdit.superclass.constructor.call(this,opts.controlId,options);}
extend(ProductGroupEdit,EditSelectObject);function ClientDebtPeriodEdit(opts){options={"tableLayout":false,"methodId":"get_list","modelId":"ClientDebtPeriodList_Model","lookupValueFieldId":"days_descr","lookupKeyFieldIds":["days_from"],"keyFieldIds":[opts.fieldId],"controller":new ClientDebtPeriod_Controller(new ServConnector(HOST_NAME)),"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":ClientDebtPeriodList_View,"defaultId":(opts.defaultId==undefined)?"undefined":opts.defaultId};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Период долга:";}
ClientDebtPeriodEdit.superclass.constructor.call(this,opts.controlId,options);}
extend(ClientDebtPeriodEdit,EditSelectObject);function ClientExtContractEdit(opts){options={"methodId":"complete","tableLayout":false,"modelId":"ClientExtContractList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["ext_id"],"keyFieldIds":[opts.fieldId],"noAutoComplete":true,"winObj":this.m_winObj,"listView":ClientExtContractList_View,"attrs":{"fkey_vehicle_id":opts.id||""},"buttonSelect":new ButtonSelectObject(opts.controlId+'_btn_select',{"controller":new Client_Controller(new ServConnector(HOST_NAME)),"modelId":"ClientExtContractList_Model","listView":ClientExtContractList_View,"keyFieldIds":[opts.fieldId],"lookupKeyFieldIds":["ext_id"],"onSelected":null,"multySelect":false,"extraFields":null,"controlId":opts.controlId,"methParams":{"client_id":null,"firm_id":null},"onBeforeViewCreate":function(){var pm=this.m_controller.getPublicMethodById("get_client_ext_contract_list");pm.setParamValue("client_id",opts.mainView.m_clientCtrl.getAttr("fkey_client_id"));pm.setParamValue("firm_id",opts.mainView.m_FirmCtrl.getFieldValue());}})};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Договор:";}
ClientExtContractEdit.superclass.constructor.call(this,opts.controlId,options);this.setAttr("disabled","disabled");}
extend(ClientExtContractEdit,EditObject);ClientExtContractEdit.prototype.setEnabled=function(enabled){if(this.m_label){this.m_label.setEnabled(enabled);}
if(this.m_buttons){this.m_buttons.setEnabled(enabled);}}
function FirmExtBankAccountEdit(opts){options={"methodId":"complete","tableLayout":false,"modelId":"FirmExtBankAccountList_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["ext_id"],"keyFieldIds":[opts.fieldId],"winObj":this.m_winObj,"listView":FirmExtBankAccountList_View,"attrs":{"fkey_ext_bank_account_id":opts.controlId||""},"buttonSelect":new ButtonSelectObject(opts.controlId+'_btn_select',{"controller":new Firm_Controller(new ServConnector(HOST_NAME)),"modelId":"FirmExtBankAccountList_Model","listView":FirmExtBankAccountList_View,"keyFieldIds":[opts.fieldId],"lookupKeyFieldIds":["ext_id"],"multySelect":false,"extraFields":null,"controlId":opts.controlId,"methParams":{"firm_id":null},"onBeforeViewCreate":function(){var firm_ctrl=opts.mainView.m_dataControls[opts.mainView.getId()+"_firm_descr"];var pm=this.m_controller.getPublicMethodById("get_firm_ext_bank_account_list");pm.setParamValue("firm_id",firm_ctrl.getValue());},"onSelected":function(keys,descrs,extraFields){var m_id=(opts.mainView.getIsNew())?opts.mainView.m_insertMethId:opts.mainView.m_updateMethId;opts.mainView.setWriteMethodId();var contr=opts.mainView.getWriteController();contr.getPublicMethodById(m_id).setParamValue("ext_bank_account_descr",descrs["name"]);}}),"noAutoComplete":false};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Счет:";}
FirmExtBankAccountEdit.superclass.constructor.call(this,opts.controlId,options);}
extend(FirmExtBankAccountEdit,EditObject);FirmExtBankAccountEdit.prototype.setEnabled=function(enabled){if(this.m_label){this.m_label.setEnabled(enabled);}
if(this.m_buttons){this.m_buttons.setEnabled(enabled);}}
function SaleStoreAddressEditObject(fieldId,controlId,inLine,defaultId,opts){var contr=new SaleStoreAddress_Controller(new ServConnector(HOST_NAME))
var pm=contr.getPublicMethodById(contr.METH_GET_LIST);options={"tableLayout":false,"methodId":"get_list","modelId":"SaleStoreAddress_Model","lookupValueFieldId":"name","lookupKeyFieldIds":["id"],"keyFieldIds":[fieldId],"controller":contr,"objectView":null,"noSelect":false,"noOpen":true,"winObj":this.m_winObj,"listView":SaleStoreAddressList_View,"contClassName":"aaa","defaultId":(defaultId==undefined)?"undefined":defaultId};for(var opt in opts){options[opt]=opts[opt];}
options.attrs=options.attrs||{};if(inLine==undefined||(inLine!=undefined&&!inLine)){options["labelCaption"]="Адрес магазина:";}
SaleStoreAddressEditObject.superclass.constructor.call(this,controlId,options);}
extend(SaleStoreAddressEditObject,EditSelectObject); 
function ChildForm(options){options=options||{};options.title=options.title||{};var content='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">'+'<html>'+'<head>'+'<meta http-equiv="content-type" content="text/html; charset=UTF-8">';content+='<link rel="stylesheet" href="'+HOST_NAME+'css/bootstrap.min.css?'+SERV_VARS.VERSION+'" type="text/css"/>';content+='<link rel="stylesheet" href="'+HOST_NAME+'css/bootstrap-theme.min.css?'+SERV_VARS.VERSION+'" type="text/css"/>';content+='<link rel="stylesheet" href="'+HOST_NAME+'css/bootstrap-datepicker.standalone.min.css?'+SERV_VARS.VERSION+'" type="text/css"/>';content+='<link rel="stylesheet" href="'+HOST_NAME+'css/style.css?'+SERV_VARS.VERSION+'" type="text/css"/>';content+='<link rel="stylesheet" href="'+HOST_NAME+'css/dhtmlwindow.css?'+SERV_VARS.VERSION+'" type="text/css"/>';content+='<title>'+options.title+'</title>'+'</head>'+'<body>'+'<div id="content"></div>'+'<div id="footer"></div>'+'<div id="waiting">'+'<div>Загрузка библиотек...</div>'+'<img src="img/common/wait.gif" alt="загрузка"/>'+'</div>';content+='<script src="'+HOST_NAME+'js/jquery-1.11.3.min.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/bootstrap.min.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/bootstrap-datepicker.min.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/bootstrap-datepicker.ru.min.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/jquery.stickytableheaders.min.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/JSLib/Keyboard.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/JSLib/Textbox.Common.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/JSLib/String.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/JSLib/Textbox.Restriction.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/JSLib/Textbox.MaskEdit.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/JSLib/Textbox.Trim.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/JSLib/Textbox.Tip.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/common/functions.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/common/DateHandler.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/common/DOMHandler.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/common/EventHandler.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ControllerDb.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/Field.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldSys.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldString.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldInt.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldBool.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldFloat.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldDate.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldDateTime.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldDate.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldTime.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldEnum.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldText.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldPassword.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldGeomPoint.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/FieldGeomPolygon.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/DataSource.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/Model.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ModelSingleRow.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ModelServResponse.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/PublicMethod.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ServConnector.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ServResponse.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/Validator.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ValidatorInt.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ValidatorString.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ValidatorFloat.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ValidatorDate.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ValidatorBool.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ValidatorTime.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ValidatorDateTime.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ValidatorCellPhone.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ListFilter.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/core/ListGroupper.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/WindowForm.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/DynamicDrive/windowfiles/dhtmlwindowBS.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/WindowFormDD.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/WindowQuestion.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/WindowMessage.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/WindowPrint.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/Control.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ControlContainer.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/MaskEdit.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/Kalendar.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/Calculator.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/Label.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/LabelField.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/Button.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonCtrl.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonCmd.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonToggle.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonCalc.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonClear.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonExpToExcel.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonExpToPDF.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonKalendar.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonOpen.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonSelect.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonSelectObject.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonClearObject.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonOpenObject.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ButtonPrint.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/Edit.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditString.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/actb.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditObject.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditDate.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditCellPhone.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditDateTime.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditTime.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditNum.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditFloat.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditMoney.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditText.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditSelect.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditSelectOption.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditRadio.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditRadioGroup.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditCheckBox.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditHTML.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditPassword.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditSelectObject.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditPeriod.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditPeriodDate.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditPeriodMonth.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditPeriodQuater.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditReportVariant.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/EditDow.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ViewDialog.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ViewList.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ViewDocument.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ViewDocumentDetail.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ViewInlineGridEdit.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ViewInlineGridEditDOCT.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ViewDialogGridEditDOCT.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ViewReport.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ViewMenu.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/Grid.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridRowCommands.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridRowCommandsDOC.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridRowCommandsConst.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridCommands.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridPagination.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridDb.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridDbDOC.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridDbDOCT.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridDbConst.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ViewInlineGridEditConst.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridDbMasterDetail.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridHead.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridFoot.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridBody.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridRow.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridFootRow.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridRowDOC.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridRowDOCT.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridCell.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridFootCell.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridCellStepInc.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridHeadCell.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridDbHeadCell.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridDbHeadCellBool.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridDbHeadSysCell.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridFilter.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GridFilterDocument.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/GroupFields.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/PopUpMenu.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/PeriodFilter.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/RepBaseFields.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/RepCondFields.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/RepAggFields.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/RepGroupFields.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/RepGroupFields_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/RepFieldsCommands.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/TabMenuItem.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/MenuItem.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/WaitControl.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ErrorControl.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/ToolTip.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/CurrentDateTime.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/Kladr_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/FileLoader.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controlsBS/WindowFormModalBS.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/OpenLayers/OpenLayers.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/TrackConstants.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/ObjMapLayer.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/GeoZones.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/MarkerLayer.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/DrawingControl.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/ZoneDrawingControl.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/MarkerSetControl.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/VehicleLayer.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/Markers.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/TrackLayer.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/Map_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/map/MapZones_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Constant_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Enum_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/User_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Client_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ClientUser_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ClientContract_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Firm_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Product_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ClientPriceList_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ProductionCity_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ClientPriceListProduct_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/DOCOrder_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/DOCOrderDOCTProduct_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/DOCOrderDOCTCustSurvey_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Warehouse_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/MeasureUnit_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ProductMeasureUnit_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/DeliveryPeriod_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ProductCustomSizePrice_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ProductWarehouse_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/CustomerSurveyQuestion_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/CustomerSurvey_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ProductionState_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Report_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ReportVariant_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Delivery_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Driver_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Vehicle_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Carrier_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ClientDestination_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Kladr_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/SMSTemplate_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/EmailTemplate_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/DelivCost_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/DelivCostOpt_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Payment_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Holiday_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ClientDebtPeriod_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ClientPriceListClient_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/DeliveryHour_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ClientActivity_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/SertType_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/SertTypeAttr_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/TrackerServer_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Tracker_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/UserWarehouse_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/SMSForSending_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/MailForSending_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/Holiday_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/PPViewReport.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ConstantInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ConstantList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ReportVariantList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ReportVariantInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/UserDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/UserAccount_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/UserList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientRegister_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/Delivery_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/PaymentList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/RepSales_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientSelectList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientUserList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientUserInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientContractList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientContractInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/UserWarehouseList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/UserWarehouseInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/FirmList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/FirmInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DeliveryPeriodList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DeliveryPeriodInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientPriceListList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientPriceListDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientPriceListClientList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductionCityDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductionCityList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientPriceListProductList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientPriceListProductInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderBaseList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderNewList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderCurrentList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderClosedList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderDivisDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderCustomSurveyDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderShipmentDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderDOCTProductList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderDOCTDivisProductList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderDOCTDivisProductInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderDOCTProductDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderDOCTCustSurveyList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderDOCTCustSurveyInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderDOCTShipmentList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderDOCTShipmentInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DOCOrderCancel_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/Catalogs_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/WarehouseList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/WarehouseDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/MeasureUnitList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/MeasureUnitDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductMeasureUnitList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductMeasureUnitInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductCustomSizePriceList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductCustomSizePriceInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductWarehouseList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductWarehouseInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/CustomerSurveyQuestionList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/CustomerSurveyQuestionInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductionStateList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductionStateInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/RepProductionLoad_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/RepPriceListTuning_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/PayOrderList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/RepClientBalance_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/PaySchedule_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/PayDefDebt_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DelivAssignedOrderList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DelivAssignedOrderForClient_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DelivUnassignedOrderList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DeliveryMap_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DriverList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DriverInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/CarrierList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/CarrierInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/VehicleList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/VehicleDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DelivExtraVehSelectList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientDestinationDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/SMSTemplateList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/SMSTemplateListInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/EmailTemplateList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/EmailTemplateListInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DelivCostList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DelivCostInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DelivCostOptList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DelivCostOptInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientDebtPeriodList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientDebtPeriodInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DeliveryHour_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/DeliveryHourInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientActivity_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ClientActivityInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/SertType_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/SertTypeDialog_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/SertTypeAttr_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/SertTypeAttrInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/TrackerServerList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/TrackerServerInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/TrackerList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/TrackerInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/SMSForSendingList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/MailForSendingList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductGroupList_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/ProductGroupInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/Holiday_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/views/HolidayInline_View.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/UnregClientCheck.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/ClientAttrs.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/ClientUserGridRowCommands.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/EditObjects.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/ChildForm.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/DOCOrderGridDb.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnCancelLastState.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPassToProduction.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnUpdatePaid.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnSetPaid.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnSetNotPaid.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPaidToAcc.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrint.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrintCheck.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrintDoc.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrintOrder.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrintPassport.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrintInvoice.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrintTorg12.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrintTTN.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrintShipDocs.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrintUPD.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPrintAll.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnSetReady.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnSetClosed.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnSetShipped.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnSetClosed.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnCustomSurvey.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnOrderDivis.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnOrderSetFilter.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnOrderUnsetFilter.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnCancelOrder.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnCatalogs.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/BtnPriceTune.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/EditPeriodDateTime.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/CustomGridFilter.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/DelivAssignedOrderGridDb.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/DelivAssignedOrderGridCommands.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/DelivUnassignedOrderGridDb.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/ClientDestinationEdit.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/EditMoneyEditable.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/ClientPriceListClientGridCom.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/DOCOrderQuantEdit.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/DOCOrderChildren.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/custom_controls/DOCOrderCancelCause.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/DragnDrop/DragObject.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/DragnDrop/DropTarget.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/DragnDrop/dragMaster.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/extra/DragnDrop/helpers.js?'+SERV_VARS.VERSION+'"></script>';content+='<script src="'+HOST_NAME+'js/controllers/ProductGroup_Controller.js?'+SERV_VARS.VERSION+'"></script>';content+='<script>'+'var dv = document.getElementById("waiting");'+'if (dv!==null){'+'dv.parentNode.removeChild(dv);}'+'</script>'+'</body></html>';options.location=options.location||"0";options.menuBar=options.menuBar||"0";options.scrollBars=options.scrollBars||"1";options.center=(options.center==undefined)?true:options.center;options.status=options.status||"0";options.titleBar=options.titleBar||"0";options.content=content;ChildForm.superclass.constructor.call(this,options);}
extend(ChildForm,WindowForm);ChildForm.prototype.getContentParent=function(){return $("content",this.m_WindowForm.document);} 
function DOCOrderGridDb(id,options){options=options||{};DOCOrderGridDb.superclass.constructor.call(this,id,options);this.m_prodDescr={};}
extend(DOCOrderGridDb,GridDbDOC);DOCOrderGridDb.prototype.DETAIL_WAIT=500;DOCOrderGridDb.prototype.onGetData=function(resp){DOCOrderGridDb.superclass.onGetData.call(this,resp);this.m_toolTips={};this.m_colorToolTips={};var self=this;var cells=DOMHandler.getElementsByAttr("number",this.m_node,"field_id",false);for(var i=0;i<cells.length;i++){if(cells[i].nodeName.toLowerCase()=="td"){this.m_colorToolTips[i]=new ToolTip({"node":cells[i],"wait":1,"onHover":function(event){this.popup('<div><span class="color-sample behind_plan">&nbsp;&nbsp;&nbsp;</span> - опаздание</div>'+'<div><span class="color-sample waiting_for_us">&nbsp;&nbsp;&nbsp;</span> - согласование Полимерпласт</div>'+'<div><span class="color-sample waiting_for_client">&nbsp;&nbsp;&nbsp;</span> - на согласовании у клиента</div>'+'<div><span class="color-sample waiting_for_payment">&nbsp;&nbsp;&nbsp;</span> - ожидает оплаты материалов</div>'+'<div><span class="color-sample producing">&nbsp;&nbsp;&nbsp;</span> - в производстве</div>'+'<div><span class="color-sample produced">&nbsp;&nbsp;&nbsp;</span> - готова</div>'+'<div><span class="color-sample shipped">&nbsp;&nbsp;&nbsp;</span> - отгружена</div>'+'<div><span class="color-sample loading">&nbsp;&nbsp;&nbsp;</span> - на погрузке</div>'+'<div><span class="color-sample on_way">&nbsp;&nbsp;&nbsp;</span> - доставка клиенту</div>'+'<div><span class="color-sample unloading">&nbsp;&nbsp;&nbsp;</span> - разгрузка у клиента</div>',{"title":"Расшифровка статусов","className":"OrderInfPopOver"});}});}}
var cells=DOMHandler.getElementsByAttr("products_descr",this.m_node,"field_id",false);for(var i=0;i<cells.length;i++){if(cells[i].nodeName.toLowerCase()=="td"){this.m_toolTips[i]=new ToolTip({"node":cells[i],"wait":this.DETAIL_WAIT,"onHover":function(event){event=EventHandler.fixMouseEvent(event);if(event.target.parentNode){var keys=json2obj(event.target.parentNode.getAttribute("key_values"));if(keys){var tip=this;if(self.m_prodDescr[keys["id"]]){tip.popup(self.m_prodDescr[keys["id"]],{"title":"Данные по заявке","className":"OrderInfPopOver"});return;}
var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));var meth_id="get_products_descr";var meth=contr.getPublicMethodById(meth_id);meth.setParamValue("doc_id",keys["id"]);contr.run(meth_id,{"async":true,"func":function(resp){var driver_descr;var vehicle_descr;var content="<table class='table table-striped'>";var model=resp.getModelById("DOCOrder_Model");model.setActive(true);while(model.getNextRow()){content+="<tr class='row'>"+"<td>"+model.getFieldValue("product_descr")+"</td>"+"<td>"+model.getFieldValue("base_quant")+"</td>"+"<td>"+model.getFieldValue("base_measure_unit_descr")+"</td>"+"<td>"+model.getFieldValue("quant")+"</td>"+"<td>"+model.getFieldValue("measure_unit_descr")+"</td>";content+="<td>";if(model.getFieldValue("pack_exists")=="true"){if(model.getFieldValue("pack_in_price")=="true"){content+="Упаковка в цене";}}
content+="</td>";driver_descr=model.getFieldValue("driver_descr");vehicle_descr=model.getFieldValue("vehicle_descr");content+="</tr>";i++;}
content+="</table>";if(driver_descr){content+="<div>Отгрузка: ";content+="<span>"+driver_descr+"</span>";content+=" <span>, "+vehicle_descr+"</span>";content+="</div>";}
self.m_prodDescr[keys["id"]]=content;tip.popup(content,{"title":"Данные по заявке","className":"OrderInfPopOver"});},"xml":true,"errControl":self.getErrorControl()})}}}});}}}
DOCOrderGridDb.prototype.initEditViewObj=function(contr){DOCOrderGridDb.superclass.initEditViewObj.call(this,contr);this.m_editViewObj.m_currentGrid=this.m_currentGrid;var tt_n=nd("tt");if(tt_n){DOMHandler.removeNode(tt_n);}}
DOCOrderGridDb.prototype.onRefresh=function(){DOCOrderGridDb.superclass.onRefresh.call(this);this.m_prodDescr={};} 
function BtnCancelLastState(options){var id=uuid();options.caption="Отменить 1 действие";options.attrs={"title":"отменить последнее действие"};options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){var self=this;WindowQuestion.show({"text":"Отменить последнее действие?","callBack":function(){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("cancel_last_state",{"async":true,"params":{"doc_id":keys["id"]},"func":function(){options.grid.getErrorControl().setValue("Последнее действие отменено!");options.grid.onRefresh();},"cont":self,"errControl":options.grid.getErrorControl()});}});}};BtnCancelLastState.superclass.constructor.call(this,id,options);}
extend(BtnCancelLastState,Button); 
function BtnPassToProduction(options){var id=uuid();options.caption="В производство";options.attrs={"title":"передать заявку в производство"};this.m_grid=options.grid;var self=this;options.onClick=function(){var keys=self.m_grid.getSelectedNodeKeys();if(keys){self.setEnabled(false);WindowQuestion.show({"text":"Передать заявку в производство?","callBack":function(r){self.setEnabled(true);if(r==WindowQuestion.RES_YES){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("pass_to_production",{"async":true,"params":{"doc_id":keys["id"]},"func":function(){self.m_grid.getErrorControl().setValue("Заявка передана в производство!");self.m_grid.onRefresh();},"cont":this,"err":function(resp,errCode,errStr){self.m_grid.getErrorControl().setValue(errStr);}});}}});}};BtnPassToProduction.superclass.constructor.call(this,id,options);}
extend(BtnPassToProduction,Button);BtnPassToProduction.prototype.m_grid; 
function BtnUpdatePaid(id,options){var self=this;options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){self.setEnabled(false);var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run(options.methodId,{"async":true,"xml":true,"params":{"doc_id":keys["id"]},"func":function(resp){window.showTempNote(options.resultText,function(){self.setEnabled(true);options.grid.onRefresh();},ERR_MSG_WAIT_MS);},"cont":this,"err":function(resp,errCode,errStr){window.showTempError(errStr,function(){self.setEnabled(true);},ERR_MSG_WAIT_MS);}});}};BtnUpdatePaid.superclass.constructor.call(this,id,options);}
extend(BtnUpdatePaid,Button); 
function BtnSetPaid(options){options.methodId="set_paid";options.caption="Оплата (нал)";options.attrs=options.attrs||{};options.attrs.title="Установить признак оплаты (наличный расчет)";options.resultText="Установлен признак оплаты по наличному расчету.";BtnSetPaid.superclass.constructor.call(this,"btn_set_paid",options);}
extend(BtnSetPaid,BtnUpdatePaid); 
function BtnSetPaidByBank(options){options.methodId="set_paid_by_bank";options.caption="Оплата (карта)";options.attrs=options.attrs||{};options.attrs.title="Установить признак оплаты (карта)";options.resultText="Установлен признак оплаты по картам.";BtnSetPaidByBank.superclass.constructor.call(this,"btn_set_paid_by_bank",options);}
extend(BtnSetPaidByBank,BtnUpdatePaid); 
function BtnSetNotPaid(options){options.methodId="set_not_paid";options.caption="Отменить оплату";options.attrs=options.attrs||{};options.attrs.title="Отменить оплату";options.resultText="Отменена оплата по любому виды расчетов";BtnSetNotPaid.superclass.constructor.call(this,"btn_set_not_paid",options);}
extend(BtnSetNotPaid,BtnUpdatePaid); 
function BtnPaidToAcc(options){id=uuid();options.caption="ПКО (нал)";options.attrs=options.attrs||{};options.attrs.title="Создать ПКО по оплаченным заявкам (наличный расчет)";var self=this;options.onClick=function(){self.setEnabled(false);var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("paid_to_acc",{"async":true,"xml":true,"func":function(resp){var m=resp.getModelById("paid_to_acc",true);if(m.getNextRow()){window.showTempNote(m.getFieldValue("mes"),function(){self.setEnabled(true);},ERR_MSG_WAIT_MS);}},"cont":this,"err":function(resp,errCode,errStr){self.setEnabled(true);window.showTempError(errStr,null,ERR_MSG_WAIT_MS);}});};BtnPaidToAcc.superclass.constructor.call(this,id,options);}
extend(BtnPaidToAcc,Button); 
function BtnPaidByBankToAcc(options){id=uuid();options.caption="ПКО (карта)";options.attrs=options.attrs||{};options.attrs.title="Создать ПКО по оплаченным заявкам (карта)";var self=this;options.onClick=function(){self.setEnabled(false);var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("paid_by_bank_to_acc",{"async":true,"xml":true,"func":function(resp){var m=resp.getModelById("paid_to_acc",true);if(m.getNextRow()){window.showTempNote(m.getFieldValue("mes"),function(){self.setEnabled(true);},ERR_MSG_WAIT_MS);}},"cont":this,"err":function(resp,errCode,errStr){self.setEnabled(true);window.showTempError(errStr,null,ERR_MSG_WAIT_MS);}});};BtnPaidByBankToAcc.superclass.constructor.call(this,id,options);}
extend(BtnPaidByBankToAcc,Button); 
function BtnPrint(options){var id=uuid();options.caption="Печать";options.attrs={"title":"распечатать заявку (для склада)"};options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){var self=this;var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("get_print",{"async":true,"xml":false,"params":{"doc_id":keys["id"],"v":"DOCOrder"},"func":function(resp){WindowPrint.show({"content":resp,"print":true});contr.run("get_nonegraphic_files_list",{"async":true,"params":{"doc_order_id":keys["id"],"v":"ViewXML"},"func":function(resp){var att_m=resp.getModelById("FileList_Model",true);var offset=0;var h=$(window).width()/3*2;var left=$(window).width()/2;var w=left-20;while(att_m.getNextRow()){var file_inf=CommonHelper.unserialize(att_m.getFieldValue("file_inf"));contr.getServConnector().openHref({"c":"DOCOrder_Controller","f":"get_file","inline":"1","doc_order_id":keys["id"],"file_id":file_inf.id},"location=0,menubar=0,status=0,titlebar=0,top="+(50+offset)+",left="+(left+offset)+",width="+w+",height="+h);offset=offset+100;}}});},"cont":this,"errControl":options.grid.getErrorControl()});}};BtnPrint.superclass.constructor.call(this,id,options);}
extend(BtnPrint,Button); 
function BtnPrintCheck(options){var id=uuid();options.caption="Чек";options.attrs={"title":"распечатать заявку"};options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("get_print_check",{"async":true,"xml":false,"params":{"doc_id":keys["id"],"v":"DOCOrderCheck"},"func":function(resp){WindowPrint.show({"content":resp,"print":true});},"cont":this,"errControl":options.grid.getErrorControl()});}};BtnPrintCheck.superclass.constructor.call(this,id,options);}
extend(BtnPrintCheck,Button); 
function BtnPrintDoc(id,options){options.attrs={"title":options.title};var self=this;options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){self.setEnabled(false);let contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run(options.checkMethodId,{"params":{"doc_id":keys["id"]},"func":function(){let q_params=contr.getQueryString(contr.getPublicMethodById(options.methodId))+"&doc_id="+keys["id"];window.open(HOST_NAME+"index.php?"+q_params,"_blank","location=0,menubar=0,status=0,titlebar=0");self.setEnabled(true);},"err":function(resp,errCode,str){window.showTempError(str,function(){self.setEnabled(true);},ERR_MSG_WAIT_MS);}});}};BtnPrintDoc.superclass.constructor.call(this,id,options);}
extend(BtnPrintDoc,Button); 
function BtnPrintOrder(options){options=options||{};options.caption="Счет";options.title="распечатать счет";options.methodId="print_order";options.checkMethodId="ext_order_exists";BtnPrintOrder.superclass.constructor.call(this,"btn_print_order",options);}
extend(BtnPrintOrder,BtnPrintDoc); 
function BtnPrintPassport(options){options=options||{};options.caption="Паспорта";options.title="распечатать паспорт качества";options.methodId="print_passport";options.checkMethodId="ext_ship_exists";BtnPrintPassport.superclass.constructor.call(this,"btn_print_passport",options);}
extend(BtnPrintPassport,BtnPrintDoc); 
function BtnPrintInvoice(options){options=options||{};options.caption="Счет-фактура";options.title="распечатать счет-фактуру";options.methodId="print_invoice";options.checkMethodId="ext_invoice_exists";BtnPrintInvoice.superclass.constructor.call(this,"btn_print_invoice",options);}
extend(BtnPrintInvoice,BtnPrintDoc); 
function BtnPrintTorg12(options){options=options||{};options.caption="Торг-12";options.title="распечатать Торг-12";options.methodId="print_torg12";options.checkMethodId="ext_ship_exists";BtnPrintTorg12.superclass.constructor.call(this,"btn_print_torg12",options);}
extend(BtnPrintTorg12,BtnPrintDoc); 
function BtnPrintTTN(options){options=options||{};options.caption="ТТН";options.title="распечатать ТТН";options.methodId="print_ttn";options.checkMethodId="ext_ship_exists";BtnPrintTTN.superclass.constructor.call(this,"btn_print_ttn",options);}
extend(BtnPrintTTN,BtnPrintDoc); 
function BtnPrintShipDocs(options){options=options||{};options.caption="УПД+ТТН";options.title="распечатать отгрузочные документы (УПД,ТТН)";var self=this;options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){self.setEnabled(false);var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("ext_ship_exists",{"params":{"doc_id":keys["id"]},"func":function(){var q_params=contr.getQueryString(contr.getPublicMethodById("print_upd"))+"&doc_id="+keys["id"];window.open(HOST_NAME+"index.php?"+q_params,"_blank","location=0,menubar=0,status=0,titlebar=0");var q_params=contr.getQueryString(contr.getPublicMethodById("print_ttn"))+"&doc_id="+keys["id"];window.open(HOST_NAME+"index.php?"+q_params,"_blank","location=0,menubar=0,status=0,titlebar=0");self.setEnabled(true);},"err":function(resp,errCode,str){window.showTempError(str,function(){self.setEnabled(true);},ERR_MSG_WAIT_MS);}});}};BtnPrintShipDocs.superclass.constructor.call(this,"btn_print_ship_docs",options);}
extend(BtnPrintShipDocs,Button); 
function BtnPrintUPD(options){options=options||{};options.caption="УПД";options.title="распечатать УПД";options.methodId="print_upd";options.checkMethodId="ext_ship_exists";BtnPrintUPD.superclass.constructor.call(this,"btn_print_upd",options);}
extend(BtnPrintUPD,BtnPrintDoc); 
function BtnPrintAll(options){var id=uuid();options.caption="Печать всех нерасп.";options.attrs={"title":"распечатать все нераспечатанные заявки"};options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("get_print_cnt",{"async":true,"func":function(resp){var m=resp.getModelById("get_print_cnt",true);if(m.getNextRow()&&m.getFieldValue("cnt")=="0"){WindowMessage.show({type:WindowMessage.TP_NOTE,text:"Все документы распечатаны!"});}
else{contr.run("get_print_all",{"async":true,"xml":false,"params":{"v":"DOCOrder"},"func":function(resp){WindowPrint.show({"content":resp,"print":true});},"cont":this,"errControl":options.grid.getErrorControl()});}},"cont":this,"errControl":options.grid.getErrorControl()});}};BtnPrintAll.superclass.constructor.call(this,id,options);}
extend(BtnPrintAll,Button); 
function BtnSetReady(options){var id=uuid();options.caption="Готова";options.attrs={"title":"перевести заявку в статус 'выполнена'"};options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("set_ready",{"async":true,"xml":true,"params":{"doc_id":keys["id"]},"func":function(resp){window.showTempNote("Заявка переведена в статус 'выполнена'.",function(){options.grid.onRefresh();},ERR_MSG_WAIT_MS);},"cont":this,"errControl":options.grid.getErrorControl()});}};BtnSetReady.superclass.constructor.call(this,id,options);}
extend(BtnSetReady,Button); 
function BtnSetClosed(options){var id=uuid();options.caption="В архив";options.attrs={"title":"перевести заявку в статус 'закрыта' или 'выполнена'"};options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("set_closed",{"async":true,"xml":true,"params":{"doc_id":keys["id"]},"func":function(resp){window.showTempNote("Заявка переведена в статус 'закрыта' или 'выполнена'.",function(){options.grid.onRefresh();},ERR_MSG_WAIT_MS);},"cont":this,"errControl":options.grid.getErrorControl()});}};BtnSetClosed.superclass.constructor.call(this,id,options);}
extend(BtnSetClosed,Button); 
function BtnSetShipped(options){var id=uuid();options.caption="Отгружена";options.attrs={"title":"перевести заявку в статус 'отгружена'"};this.m_grid=options.grid;this.m_keys=options.keys;var self=this;options.onClick=function(){if(self.m_grid){self.m_keys=self.m_grid.getSelectedNodeKeys();}
else{}
if(self.m_keys){self.m_extForm=new WIN_CLASS({"title":"Отгрузка","width":"900","height":"500"});self.m_extForm.open();self.m_extCtrl=new DOCOrderShipmentDialog_View("DOCOrderShipmentDialog_View",{"winObj":self.m_extForm,"readController":new DOCOrder_Controller(new ServConnector(HOST_NAME)),"onClose":function(){self.m_extForm.close();delete self.m_extForm;if(options.grid)options.grid.onRefresh();}});for(var key_id in self.m_keys){self.m_extCtrl.setReadIdValue(key_id,self.m_keys[key_id]);}
self.m_extCtrl.readData(true);self.m_extCtrl.m_beforeOpen(new DOCOrder_Controller(new ServConnector(HOST_NAME)),false);self.m_extCtrl.toDOM(self.m_extForm.getContentParent());self.m_extForm.setFocus();}};BtnSetShipped.superclass.constructor.call(this,id,options);}
extend(BtnSetShipped,Button); 
function BtnSetClosed(options){var id=uuid();options.caption="В архив";options.attrs={"title":"перевести заявку в статус 'закрыта' или 'выполнена'"};options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("set_closed",{"async":true,"xml":true,"params":{"doc_id":keys["id"]},"func":function(resp){window.showTempNote("Заявка переведена в статус 'закрыта' или 'выполнена'.",function(){options.grid.onRefresh();},ERR_MSG_WAIT_MS);},"cont":this,"errControl":options.grid.getErrorControl()});}};BtnSetClosed.superclass.constructor.call(this,id,options);}
extend(BtnSetClosed,Button); 
function BtnCustomSurvey(options){var self=this;var id=uuid();options.caption="Опрос";options.attrs={"title":"внести данные об опросе клиента"};options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){self.m_extCtrl=new DOCOrderCustSurveyDialog_View("DOCOrderCustSurveyDialog_View",{"winObj":self.m_extForm,"readController":new DOCOrder_Controller(new ServConnector(HOST_NAME)),"onClose":function(){self.m_extForm.close();delete self.m_extForm;}});self.m_extForm=new WIN_CLASS({"title":"Опрос клиента","width":self.m_extCtrl.getFormWidth(),"height":self.m_extCtrl.getFormHeight(),"onBeforeClose":function(){var r=true;if(self.m_extForm.m_closeMode==0&&self.m_extCtrl.onCancel){self.m_extCtrl.setOnClose(null);r=self.m_extCtrl.onCancel.call(self.m_extCtrl);}
options.grid.onRefresh();return r;}});self.m_extForm.open();for(var key_id in keys){self.m_extCtrl.setReadIdValue(key_id,keys[key_id]);}
self.m_extCtrl.readData(true);self.m_extCtrl.m_beforeOpen(new DOCOrder_Controller(new ServConnector(HOST_NAME)),false);self.m_extCtrl.toDOM(self.m_extForm.getContentParent());self.m_extForm.setFocus();}};BtnCustomSurvey.superclass.constructor.call(this,id,options);}
extend(BtnCustomSurvey,Button); 
function BtnOrderDivis(options){var self=this;var id=uuid();options.caption="Разделить";options.attrs={"title":"разделить заявку"};options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){self.m_extCtrl=new DOCOrderDivisDialog_View("DOCOrderDivisDialog_View",{"winObj":self.m_extForm,"readController":new DOCOrder_Controller(new ServConnector(HOST_NAME)),"onClose":function(){if(options.grid.m_prodDescr&&options.grid.m_prodDescr[keys["id"]]){options.grid.m_prodDescr[keys["id"]]=undefined;}
self.m_extForm.close();delete self.m_extForm;}});self.m_extForm=new WIN_CLASS({"title":"Деление заявки","width":"900","height":"500","onBeforeClose":function(){var r=true;if(self.m_extForm.m_closeMode==0&&self.m_extCtrl.onCancel){self.m_extCtrl.setOnClose(null);r=self.m_extCtrl.onCancel.call(self.m_extCtrl);}
options.grid.onRefresh();return r;}});self.m_extForm.open();for(var key_id in keys){self.m_extCtrl.setReadIdValue(key_id,keys[key_id]);}
self.m_extCtrl.readData(true,true);self.m_extCtrl.toDOM(self.m_extForm.getContentParent());self.m_extForm.setFocus();}};BtnOrderDivis.superclass.constructor.call(this,id,options);}
extend(BtnOrderDivis,Button); 
function BtnOrderSetFilter(options){var id=uuid();options.caption="Фильтр";options.attrs={"title":"открыть фильтр"};options.onClick=function(){options.grid.getFilter().open();};BtnOrderSetFilter.superclass.constructor.call(this,id,options);}
extend(BtnOrderSetFilter,Button); 
function BtnOrderUnsetFilter(options){var id=uuid();options.caption="Сбросить";options.attrs={"title":"сбросить фильтр"};options.onClick=function(){var f=options.grid.getFilter();f.unset();};BtnOrderUnsetFilter.superclass.constructor.call(this,id,options);}
extend(BtnOrderUnsetFilter,Button); 
function BtnCancelOrder(options){var id="btn_order_cancel";options.caption="Отменить";options.attrs={"title":"отменить заявку"};var self=this;options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){self.setEnabled(false);WindowQuestion.show({"text":"Отменить заявку?","callBack":function(res){self.doCancel(res);}});}};this.m_grid=options.grid;BtnCancelOrder.superclass.constructor.call(this,id,options);}
extend(BtnCancelOrder,Button);BtnCancelOrder.prototype.doCancel=function(res){if(res==WindowQuestion.RES_YES){this.m_extForm=new WindowFormModalDD({"caption":"Отмена заявки"});this.m_extCtrl=new DOCOrderCancel_View("DOCOrderCancel",{"doc_id":keys["id"],"winObj":this.m_extForm,"onClose":function(res){if(res==1){this.m_grid.onRefresh();}
this.m_extForm.close();delete this.m_extForm;},"winObj":this.m_extForm});this.m_extForm.open();this.m_extCtrl.toDOM(this.m_extForm.getContentParent());this.m_extForm.setFocus();}
this.setEnabled(true);} 
function BtnAppendOrder(options){var id=uuid();options.caption="Присоединить";options.attrs={"title":"присоединить к данной заявке другие"};this.m_grid=options.grid;var self=this;options.onClick=function(){var keys=self.m_grid.getSelectedNodeKeys();if(keys&&keys.id){self.selectAppend(keys.id);}};BtnAppendOrder.superclass.constructor.call(this,id,options);}
extend(BtnAppendOrder,Button);BtnAppendOrder.prototype.selectAppend=function(docId){this.m_docId=docId;var self=this;this.m_extCtrl=new DOCOrderAppend_View("DOCOrderAppend_View",{"winObj":this.m_extForm,"onClose":function(res,idList){self.m_extForm.close();delete self.m_extForm;if(res&&idList.length){self.append(self.m_docId,idList);}},"doc_id":docId});this.m_extForm=new WindowFormModalBS({"title":"Объединение заявок","width":this.m_extCtrl.getFormWidth(),"height":this.m_extCtrl.getFormHeight(),"onBeforeClose":function(){var r=true;if(self.m_extForm.m_closeMode==0&&self.m_extCtrl.onCancel){self.m_extCtrl.setOnClose(null);r=self.m_extCtrl.onCancel.call(self.m_extCtrl);}
return r;}});this.m_extForm.open();this.m_extCtrl.toDOM(this.m_extForm.getContentParent());this.m_extForm.setFocus();}
BtnAppendOrder.prototype.append=function(targetDocId,sourceDocList){var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));var self=this;contr.run("append",{"params":{"target_doc_id":targetDocId,"source_doc_id_list":sourceDocList},"err":function(resp,errCode,errStr){self.m_grid.getErrorControl().setValue(errStr);},"func":function(resp){window.showTempNote("Присоединение выполнено.",function(){self.m_grid.onRefresh();},ERR_MSG_WAIT_MS);}});} 
function BtnCatalogs(options){var self=this;var id="btn_order_new";options.caption="Справочники";options.onClick=function(){self.m_extForm=new WIN_CLASS({"caption":"Справочники","width":getViewportWidth()-20,"height":getViewportHeight()+200,"onBeforeClose":function(){self.m_extCtrl.m_itemClose.call(self.m_extCtrl);}});self.m_extForm.open();self.m_extCtrl=new Catalogs_View("Catalogs_View",{"winObj":self.m_extForm});self.m_extCtrl.toDOM(self.m_extForm.getContentParent());self.m_extForm.setFocus();};BtnCatalogs.superclass.constructor.call(this,id,options);}
extend(BtnCatalogs,Button); 
function BtnPriceTune(options){options=options||{};var self=this;var id=uuid();options.caption="Пересчет прайсов";options.attrs={"title":"открыть пересчет прайсов"};options.onClick=function(){self.m_extForm=new WIN_CLASS({"title":"Пересчет прайсов","height":"600","width":"1000","top":"0","centerLeft":true});self.m_extForm.open();self.m_extCtrl=new RepPriceListTuning_View("RepPriceListTuning_View",{"winObj":self.m_extForm,"clientId":self.m_clientId,"clientDescr":self.m_clientDescr,"onClose":function(m){self.m_extForm.m_closeMode=m;self.m_extForm.close();delete self.m_extForm;}});self.m_extCtrl.toDOM(self.m_extForm.getContentParent());self.m_extForm.setFocus();};BtnPriceTune.superclass.constructor.call(this,id,options);}
extend(BtnPriceTune,Button); 
function EditPeriodDateTime(id,options){options=options||{};var date_mask="dd/mm/y";var time_mask=" hh:mmin:ss";var d_opts={};d_opts.value="";d_opts.labelCaption=options.labelCaptionFrom||this.LABEL_FROM;d_opts.attrs=options.attrs||{};d_opts.attrs.required=d_opts.attrs.required||"required";d_opts.tableLayout=options.tableLayout;d_opts.contClassName="form-group";options.controlFrom=new EditDateTime(id+"_from",d_opts);var d_opts={};d_opts.value="";d_opts.labelCaption=options.labelCaptionTo||this.LABEL_TO;d_opts.attrs=options.attrs||{};d_opts.attrs.required=d_opts.attrs.required||"required";d_opts.tableLayout=options.tableLayout;d_opts.contClassName="form-group";options.controlTo=new EditDateTime(id+"_to",d_opts);EditPeriodDateTime.superclass.constructor.call(this,id,options);}
extend(EditPeriodDateTime,EditPeriod); 
function CustomGridFilter(id,options){options=options||{};options.tagName="div";options.noUnsetControl=false;CustomGridFilter.superclass.constructor.call(this,id,options);var self=this;this.addCommandControl(new Button("filter_close",{"className":"viewBtn","caption":"Закрыть","title":"закрыть","onClick":function(){if(self.m_win){self.removeDOM();self.m_win.close();delete self.m_win;}}}));}
extend(CustomGridFilter,GridFilter);CustomGridFilter.prototype.WIN_WIDTH=500;CustomGridFilter.prototype.WIN_HEIGHT=500;CustomGridFilter.prototype.toDOM=function(parent){}
CustomGridFilter.prototype.removeDOM=function(){}
CustomGridFilter.prototype.open=function(){this.m_win=new WindowFormDD({"top":"0","centerLeft":true});this.m_win.setCaption("Фильтр");this.m_win.setWidth(this.WIN_WIDTH);this.m_win.setHeight(this.WIN_HEIGHT);this.m_win.open();var cont=new ControlContainer("order_filter","div",{"className":"panel"})
CustomGridFilter.superclass.toDOM.call(this,cont.m_node);cont.toDOM(this.m_win.getContentParent());this.m_win.setFocus();}
CustomGridFilter.prototype.unset=function(){this.m_unsetControl.m_onClick();} 
function DelivAssignedOrderGridDb(id,options){options=options||{};DelivAssignedOrderGridDb.superclass.constructor.call(this,id,options);}
extend(DelivAssignedOrderGridDb,GridDbDOC);DelivAssignedOrderGridDb.prototype.onGetData=function(resp){this.m_orderAct={};var id=this.getId();var model=resp.getModelById(this.getReadModelId());model.setActive(true);var head_cells={};var model_head=resp.getModelById("periods");model_head.setActive(true);head=this.getHead();head.removeDOM();head.clear();var row=new GridRow(id+"_head_row1");row.addElement(new GridDbHeadCell(id+"_col_vh_id",{"readBind":{"valueFieldId":"vh_id"},"keyCol":true,"visible":false}));row.addElement(new GridDbHeadCell(id+"_col_vh_descr",{"value":"ТС","readBind":{"valueFieldId":"vh_descr"},"descrCol":true}));row.addElement(new GridDbHeadCell(id+"_col_vh_state_descr",{"value":"Статус","readBind":{"valueFieldId":"vh_state_descr"}}));var period_list=[];while(model_head.getNextRow()){var per_id=model_head.getFieldValue("id");var per_name=model_head.getFieldValue("name");period_list.push({"id":per_id,"h_to":model_head.getFieldValue("h_to")});row.addElement(new GridDbHeadCell(id+"_col_period_"+per_id,{"value":per_name}));}
head.addElement(row);head.toDOM(this.m_node);head.getFields(head_cells);var dt=this.getFilter().m_filter.getParamValue("from","descr").substring(0,10);DOMHandler.addAttr(this.m_node,"date",dt);var body=this.getBody();body.removeDOM();body.clear();var row;var cur_vh_city_id,cur_vh_id,cur_per_id;var r_ind=0;var r_id_pref=this.getId()+"_row_";var cur_period_cell,cur_per_vm,cur_per_wt;var vh_wt,vh_vol;while(model.getNextRow()){var vh_city_id=model.getFieldValue("vh_city_id");var vh_id=model.getFieldValue("vh_id");var vh_wt=model.getFieldValue("vh_wt");var vh_vm=model.getFieldValue("vh_vm");var per_id=model.getFieldValue("per_id");var order_inf={"id":model.getFieldValue("o_id"),"number":model.getFieldValue("o_number"),"warehouse_descr":model.getFieldValue("o_warehouse_descr"),"client_descr":model.getFieldValue("o_client_descr"),"client_dest_descr":model.getFieldValue("o_client_dest_descr"),"product_str":model.getFieldValue("o_product_str"),"vm":toFloat(model.getFieldValue("o_vm")),"wt":toFloat(model.getFieldValue("o_wt")),"state":model.getFieldValue("o_state")}
if(cur_vh_city_id!=vh_city_id){row=new GridRow(r_id_pref+r_ind,{"className":"deliv_store_city unselectable"});row.addElement(new GridCell(r_id_pref+r_ind+"_0",{"visible":false}));row.addElement(new GridCell(r_id_pref+r_ind+"_1",{"value":model.getFieldValue("vh_city_descr"),"attrs":{"colspan":period_list.length+2}}));body.addElement(row);cur_vh_city_id=vh_city_id;r_ind++;}
if(cur_vh_id!=vh_id){var row_class=(r_ind%2==0)?"even":"odd";row=new GridRow(r_id_pref+r_ind,{"className":row_class,"attrs":{"maxVol":vh_vm,"maxWt":vh_wt}});row.addElement(new GridCell(r_id_pref+r_ind+"_0",{"value":vh_id,"visible":false}));row.addElement(new GridCell(r_id_pref+r_ind+"_1",{"value":model.getFieldValue("vh_descr")}));row.addElement(new GridCell(r_id_pref+r_ind+"_2",{"value":model.getFieldValue("vh_state_descr")}));row.setAttr("key_values",array2json({"id":vh_id}));body.setElementById("row_"+r_ind,row);cur_vh_id=vh_id;cur_per_vm=0;cur_per_wt=0;}
if(cur_per_id!=per_id){cur_period_cell=new GridDropCell(uuid(),{"className":"deliv_period","grid":this,"grid_unass":this.m_unassGrid,"attrs":{"totVol":"0","totWt":"0","maxVol":vh_vm,"maxWt":vh_wt,"period_id":per_id,"h_to":model.getFieldValue("per_h_to")}});row.addElement(cur_period_cell);cur_per_vm=0;cur_per_wt=0;cur_per_id=per_id;}
if(order_inf.id){var perc_v=Math.round(order_inf.vm/vh_vm*100);var perc_w=Math.round(order_inf.wt/vh_wt*100);var order_percent=(perc_v>perc_w)?perc_v:perc_w;var self=this;var cont=new Control(uuid(),"div",{"className":"deliv_order "+order_inf.state,"value":order_inf.number+" ("+order_percent+"%)","events":{"click":function(e){e=EventHandler.fixMouseEvent(e);var order_inf=DOMHandler.getAttr(e.target,"order_inf");if(order_inf){var vals=json2obj(order_inf);self.openOrder(vals.id);}}},"attrs":{"order_inf":array2json(order_inf),"style":"width:"+order_percent+"%","vol":order_inf.vm,"wt":order_inf.wt,"old_per_cell_id":cur_period_cell.getId()}});cur_per_vm+=order_inf.vm;cur_per_wt+=order_inf.wt;var per_perc_v=Math.round(cur_per_vm/vh_vm*100);var per_perc_w=Math.round(cur_per_wt/vh_wt*100);var per_perc=(per_perc_v>per_perc_w)?per_perc_v:per_perc_w;cur_period_cell.setAttr("load_percent_css",Math.round(per_perc/10)*10);cur_period_cell.setAttr("totVol",cur_per_vm);cur_period_cell.setAttr("totWt",cur_per_wt);cur_period_cell.addElement(cont);this.m_orderAct[order_inf.number]={};this.m_orderAct[order_inf.number].drag=new DragObject(cont.m_node);this.m_orderAct[order_inf.number].drag.m_cont=cont;this.m_orderAct[order_inf.number].drag.tip=new OrderDescr(cont.m_node);this.m_orderAct[order_inf.number].drag.getFieldValue=function(field){var o_inf=json2obj(this.m_cont.getAttr("order_inf"));return o_inf[field];}
this.m_orderAct[order_inf.number].drag.onDragStart=function(offset){DragObject.prototype.onDragStart.call(this,offset);DOMHandler.addClass(this.element,"dragging");this.m_wait=this.tip.getWait();this.tip.setWait(0);this.tip.remove();}
this.m_orderAct[order_inf.number].drag.onDragFail=function(dropObject){DragObject.prototype.onDragFail.call(this);DOMHandler.removeClass(this.element,"dragging");if(dropObject){DOMHandler.removeClass(dropObject.element,"uponMe");}
this.tip.setWait(this.m_wait);}
this.m_orderAct[order_inf.number].drag.onDragSuccess=function(){DragObject.prototype.onDragSuccess.call(this);DOMHandler.removeClass(this.element,"dragging");}}
r_ind++;}
body.toDOM(this.m_node);if(this.m_navigate){this.setSelection();}}
DelivAssignedOrderGridDb.prototype.filterToDOM=function(parent){}
DelivAssignedOrderGridDb.prototype.openOrder=function(docId){if(this.m_map){DOMHandler.addClass(this.m_map.getNode(),"hidden");}
this.setGlobalWait(true);var con=new ServConnector(HOST_NAME);var contr=new DOCOrder_Controller(con);var self=this;if(!this.m_orderView)this.m_orderView={};if(!this.m_orderWin)this.m_orderWin={};if(this.m_orderView[docId]){this.getErrorControl().setValue("Заявка уже редактируется!");return;}
this.m_orderView[docId]=new DOCOrderDialog_View(this.getId()+"EditView:"+docId,{"onClose":function(res){self.m_orderView[docId].removeDOM();delete self.m_orderView[docId];self.m_orderWin[docId].m_closeMode=res;self.m_orderWin[docId].close();delete self.m_orderWin[docId];if(self.m_map){exists=false;for(var w in self.m_orderWin){if(self.m_orderWin[w]){exists=true;break;}}
if(!exists)DOMHandler.removeClass(self.m_map.getNode(),"hidden");}},"readController":contr,"readModelId":"DOCOrderDialog_Model","connect":con,"errorControl":this.getErrorControl(),"winObj":this.m_winObj});var pm=contr.getPublicMethodById("get_object");this.m_orderView[docId].setReadIdValue("id",docId);this.m_orderWin[docId]=new WIN_CLASS({"view":this.m_orderView[docId],"title":this.m_orderView[docId].getFormCaption()+":Редактирование","width":this.m_orderView[docId].getFormWidth(),"height":this.m_orderView[docId].getFormHeight()});this.m_orderWin[docId].open();this.m_orderView[docId].readData(true);this.m_orderView[docId].m_beforeOpen(contr,false,false);this.m_orderView[docId].toDOM(this.m_orderWin[docId].getContentParent());this.setGlobalWait(false);}
DelivAssignedOrderGridDb.prototype.selectRow=function(newRow,oldRow){DelivAssignedOrderGridDb.superclass.selectRow.call(this,newRow,oldRow);if(this.m_selectedRowKeys&&this.m_map){var id=json2obj(this.m_selectedRowKeys).id;this.m_map.setCurVehicleId(id);}}
function GridDropCell(id,options){this.m_grid=options.grid;this.m_grid_unass=options.grid_unass;GridDropCell.superclass.constructor.call(this,id,options);}
extend(GridDropCell,GridCell);GridDropCell.prototype.toDOM=function(parent){GridDropCell.superclass.toDOM.call(this,parent);var self=this;this.m_dropTarget=new DropTarget(this.m_node);this.m_dropTarget.accept=function(dragObject){var order_inf={"id":dragObject.getFieldValue("id"),"number":dragObject.getFieldValue("number"),"warehouse_descr":dragObject.getFieldValue("warehouse_descr"),"client_descr":dragObject.getFieldValue("client_descr"),"client_dest_descr":dragObject.getFieldValue("client_dest_descr"),"product_str":dragObject.getFieldValue("product_str"),"vm":toFloat(dragObject.getFieldValue("vm")),"wt":toFloat(dragObject.getFieldValue("wt")),"delivery_plan_date_descr":dragObject.getFieldValue("delivery_plan_date_descr")}
var veh_node=DOMHandler.getParentByTagName(self.m_node,"tr");var tb_node=DOMHandler.getParentByTagName(veh_node,"table");var veh_keys=json2obj(DOMHandler.getAttr(veh_node,"key_values"));var maxvol=toFloat(DOMHandler.getAttr(veh_node,"maxvol"));var maxwt=toFloat(DOMHandler.getAttr(veh_node,"maxwt"));var period_id=toInt(DOMHandler.getAttr(self.m_node,"period_id"));var period_h_to=toInt(DOMHandler.getAttr(self.m_node,"h_to"));var totvol=toFloat(DOMHandler.getAttr(self.m_node,"totvol"))+order_inf.total_volume;var totwt=toFloat(DOMHandler.getAttr(self.m_node,"totwt"))+order_inf.total_weight;var dt_str=DOMHandler.getAttr(tb_node,"date");var now=new Date();var now_h=now.getHours();now.setHours(0,0,0,0);var dt=DateHandler.strToDate(dt_str);var plan_d=dragObject.getFieldValue("delivery_plan_date_descr");if(plan_d){if(DateHandler.strToDate(plan_d).getTime()!=dt.getTime()){window.showTempError("Планируемая дата отличается!",null,ERR_MSG_WAIT_MS);}}
var er_text;if(dt<now){er_text="Нельзя разместить заявку на прошедшую дату!";}
else if(maxvol<order_inf.vm){er_text="Заявка не проходит по объему!";}
else if(maxwt<order_inf.wt){er_text="Заявка не проходит по весу!";}
if(er_text){window.showTempError(er_text,null,ERR_MSG_WAIT_MS);return false;}
var contr=new Delivery_Controller(new ServConnector(HOST_NAME));var meth_id="assign_order_to_vehicle";var meth=contr.getPublicMethodById(meth_id);meth.setParamValue("order_id",order_inf.id);meth.setParamValue("vehicle_id",veh_keys.id);meth.setParamValue("hour_id",period_id);meth.setParamValue("date",dt_str);selfself=this;contr.run(meth_id,{"async":false,"func":function(resp){selfself.onLeave();dragObject.hide();self.m_grid.onRefresh();self.m_grid_unass.onRefresh();self.m_assignRes=true;},"err":function(resp,errCode,errStr){window.showTempError(errStr,null,ERR_MSG_WAIT_MS);self.m_assignRes=false;}});return this.m_assignRes;};this.m_dropTarget.canAccept=function(){return true;}}
function OrderDescr(node){options={};options.node=node;options.wait=100;options.onHover=function(event){event=EventHandler.fixMouseEvent(event);if(event.target){var order_inf=json2obj(DOMHandler.getAttr(event.target,"order_inf"));var tip=this;var content="<table>"+"<tr><td>Номер:</td><td>"+order_inf.number+"</td></tr>"+"<tr><td>Клиент:</td><td>"+order_inf.client_descr+"</td></tr>"+"<tr><td>Склад:</td><td>"+order_inf.warehouse_descr+"</td></tr>"+"<tr><td>Адрес:</td><td>"+order_inf.client_dest_descr+"</td></tr>"+"<tr><td>Продукция:</td><td>"+order_inf.product_str+"</td></tr>"+"<tr><td>Объем,м3:</td><td>"+order_inf.vm+"</td></tr>"+"<tr><td>Масса,т:</td><td>"+order_inf.wt+"</td></tr>"+"</table>";tip.popup(content,{"width":500});}}
OrderDescr.superclass.constructor.call(this,options);}
extend(OrderDescr,ToolTip); 
function DelivAssignedOrderGridCommands(id,options){options=options||{};options.noInsert=false;options.noCopy=true;options.noPrint=true;options.noExport=true;options.noEdit=true;DelivAssignedOrderGridCommands.superclass.constructor.call(this,id,options);}
extend(DelivAssignedOrderGridCommands,GridCommands);DelivAssignedOrderGridCommands.prototype.IMG="img/cat/cat_new.png";DelivAssignedOrderGridCommands.prototype.addInsert=function(){var self=this;this.setElementById(this.getId()+"_insert",new ButtonSelectObject(null,{"glyph":"glyphicon-plus","listView":DelivExtraVehSelectList_View,"methodId":"extra_veh_select_list","modelId":"extra_veh_select_list","onBeforeSelect":function(selView){var d=DateHandler.dateToStr(self.m_clickContext.getFilter().getDate(),"dd/mm/yy");self.m_date=d;selView.setDate(d);},"onSelected":function(keys,descrs){var contr=new Delivery_Controller(new ServConnector(HOST_NAME));contr.run("add_extra_vehicle",{"func":function(){self.m_clickContext.onRefresh();},"params":{"vehicle_id":keys["id"],"date":self.m_date}});},"attrs":{"title":"добавить ТС"}}));}
DelivAssignedOrderGridCommands.prototype.addDelete=function(){var self=this;this.setElementById(this.getId()+"_select",new ButtonCtrl(null,{"glyph":"glyphicon-remove","onClick":function(){var k=json2obj(self.m_clickContext.m_selectedRowKeys);if(k){var d=DateHandler.dateToStr(self.m_clickContext.getFilter().getDate(),"dd/mm/yy");var contr=new Delivery_Controller(new ServConnector(HOST_NAME));contr.run("delete_extra_vehicle",{"func":function(){self.m_clickContext.onRefresh();},"params":{"vehicle_id":k.id,"date":d}});}},"attrs":{"title":"удалить ТС"}}));} 
function DelivUnassignedOrderGridRow(id,options){options=options||{};console.log("DelivUnassignedOrderGridRow")
var self=this;options.events={"dblclick":function(e){e=EventHandler.fixMouseEvent(e);var tr=DOMHandler.getParentByTagName(e.target,"TR");if(tr){var key_values=json2obj(tr.getAttribute("key_values"));self.m_grid.openOrder(key_values.id);}}}
DelivUnassignedOrderGridRow.superclass.constructor.call(this,id,options);}
extend(DelivUnassignedOrderGridRow,GridRow);DelivUnassignedOrderGridRow.prototype.toDOM=function(parent){DelivUnassignedOrderGridRow.superclass.toDOM.call(this,parent);var self=this;this.m_dragObject=new DragObject(this.m_node);this.m_dragObject.getFieldValue=function(fieldId){var res=DOMHandler.getElementsByAttr(fieldId,self.getNode(),"field_id",true,"td");return(res.length&&res[0].childNodes.length)?res[0].childNodes[0].nodeValue:null;}
this.m_dragObject.onDragStart=function(offset){DragObject.prototype.onDragStart.call(this,offset);DOMHandler.addClass(this.element,"dragging_order");}
this.m_dragObject.onDragFail=function(dropObject){DragObject.prototype.onDragFail.call(this);DOMHandler.removeClass(this.element,"dragging_order");if(dropObject){DOMHandler.removeClass(dropObject.element,"uponMe");}}}
function DelivUnassignedOrderGridDb(id,options){options=options||{};DelivUnassignedOrderGridDb.superclass.constructor.call(this,id,options);}
extend(DelivUnassignedOrderGridDb,GridDbDOC);DelivUnassignedOrderGridDb.prototype.filterToDOM=function(parent){}
DelivUnassignedOrderGridDb.prototype.getGridRowClass=function(row,model){return DelivUnassignedOrderGridRow;}
DelivUnassignedOrderGridDb.prototype.openOrder=function(docId){if(this.m_map){DOMHandler.addClass(this.m_map.getNode(),"hidden");}
this.setGlobalWait(true);var con=new ServConnector(HOST_NAME);var contr=new DOCOrder_Controller(con);var self=this;if(!this.m_orderView)this.m_orderView={};if(!this.m_orderWin)this.m_orderWin={};if(this.m_orderView[docId]){this.getErrorControl().setValue("Заявка уже редактируется!");return;}
this.m_orderView[docId]=new DOCOrderDialog_View(this.getId()+"EditView:"+docId,{"onClose":function(res){self.m_orderView[docId].removeDOM();delete self.m_orderView[docId];self.m_orderWin[docId].m_closeMode=res;self.m_orderWin[docId].close();delete self.m_orderWin[docId];if(self.m_map){exists=false;for(var w in self.m_orderWin){if(self.m_orderWin[w]){exists=true;break;}}
if(!exists)DOMHandler.removeClass(self.m_map.getNode(),"hidden");}},"readController":contr,"readModelId":"DOCOrderDialog_Model","connect":con,"errorControl":this.getErrorControl(),"winObj":this.m_winObj});var pm=contr.getPublicMethodById("get_object");this.m_orderView[docId].setReadIdValue("id",docId);this.m_orderWin[docId]=new WIN_CLASS({"view":this.m_orderView[docId],"title":this.m_orderView[docId].getFormCaption()+":Редактирование","width":this.m_orderView[docId].getFormWidth(),"height":this.m_orderView[docId].getFormHeight()});this.m_orderWin[docId].open();this.m_orderView[docId].readData(true);this.m_orderView[docId].m_beforeOpen(contr,false,false);this.m_orderView[docId].toDOM(this.m_orderWin[docId].getContentParent());this.setGlobalWait(false);} 
function ClientDestinationEdit2(id,opts){var contr=new ClientDestination_Controller(new ServConnector(HOST_NAME));this.m_pm=contr.getPublicMethodById("complete_address");this.m_paramId="client_id";this.m_pm.setParamValue(this.m_paramId,options.clientId);this.m_mainView=opts.mainView;options={"attrs":(opts.options.attrs!=undefined)?opts.options.attrs:{"required":"required"},"visible":(opts.options.visible!=undefined)?opts.options.visible:true,"noSelect":true,"noOpen":true,"tableLayout":false,"methodId":"complete_address","modelId":"DelivAddress_Model","lookupValueFieldId":"address","lookupKeyFieldIds":["id"],"keyFieldIds":[opts.fieldId],"resultFieldId":"address","controller":contr,"minLengthForQuery":"1","patternParamId":"address","ic":null,"mid":null,"onSelected":opts.options.onSelected,"extraFields":null,"resultFieldIdsToAttr":["is_old"],"queryDelay":500,"fullTextSearch":true,"className":"form-control addressEdit","acUpdateInputOnCursor":true,"objectView":null,"noOpen":true,"contClassName":"aaa","winObj":opts.winObj};if(opts.inLine==undefined||(opts.inLine!=undefined&&!inLine)){options["labelCaption"]="Адрес доставки:";}
var self=this;this.m_btnEdit=new ButtonCtrl(id+"_edit_btn",{"glyph":"glyphicon-pencil","attrs":{"title":"изменить адрес"},"enabled":false,"onClick":function(){var id=self.getFieldValue();self.openForm((id&&id!="0")?{"id":id}:null);}});this.m_btnDelete=new ButtonCtrl(id+"_del_btn",{"glyph":"glyphicon-trash","attrs":{"title":"удалить адрес"},"enabled":false,"onClick":function(){var id=self.getAttr("fkey_deliv_destination_id");if(id&&id!="undefined"){WindowQuestion.show({"winObj":self.m_winObj,"text":"Удалить адрес клиента?","callBack":function(r){if(r==WindowQuestion.RES_YES){var contr=new ClientDestination_Controller(new ServConnector(HOST_NAME));contr.getPublicMethodById("delete").setParamValue("id",id);contr.run("delete",{"func":function(){self.setAttr("fkey_deliv_destination_id","");self.setValue("");self.setFocus();}});}}})}}});ClientDestinationEdit2.superclass.constructor.call(this,id,options);this.m_buttons.addElement(this.m_btnEdit);this.m_buttons.addElement(this.m_btnDelete);}
extend(ClientDestinationEdit2,EditObject);ClientDestinationEdit2.prototype.setClientId=function(clientId){this.m_pm.setParamValue(this.m_paramId,clientId);this.setEnabled(true);}
ClientDestinationEdit2.prototype.openForm=function(keys){var self=this;this.m_extForm=new WIN_CLASS(this.getId()+"_dest_edit",{"caption":"Адрес клиента","top":0,"left":0,"width":getViewportWidth()-10,"height":getViewportHeight(),"noMinimize":true,"resizable":false});this.m_extView=new ClientDestinationDialog_View(this.m_id+"_ClientDestinationDialog",{"winObj":this.m_extForm,"readController":new ClientDestination_Controller(new ServConnector(HOST_NAME)),"clientId":this.m_pm.getParamValue(this.m_paramId),"addressValue":this.m_node.value,"delivDestinationId":(keys)?keys.id:"0","onClose":function(res){var n_val=self.m_extView.m_ctrlValue.getValue();self.setValue(n_val);if(self.m_extView.m_lastInsertedId){self.setAttr("fkey_deliv_destination_id",self.m_extView.m_lastInsertedId);DOMHandler.removeClass(self.m_node,"error");}
if(self.m_extView.m_lastInsertedId||res){self.m_mainView.calcDelivCost();}
self.m_extView.removeDOM();delete self.m_extView;self.m_extForm.m_closeMode=res;self.m_extForm.close();delete self.m_extForm;self.setFocus();}});this.m_extView.setWinObj(this.m_extForm);this.m_extForm.m_view=this.m_extView;this.m_extForm.open();this.m_extView.toDOM(this.m_extForm.getContentParent());this.m_extForm.setFocus();var vwrite_m="insert";if(keys&&keys.id){this.m_extView.setReadIdValue("id",keys.id);vwrite_m="update";this.m_extView.readData(true);}
this.m_extView.setWriteMethodId(vwrite_m);}
ClientDestinationEdit2.prototype.setEnabled=function(val){ClientDestinationEdit2.superclass.setEnabled.call(this,val);this.m_btnEdit.setEnabled(val);this.m_btnDelete.setEnabled(val);if(this.m_regSelectNode&&val){this.m_regSelectNode.removeAttribute("disabled");}
else if(this.m_regSelectNode){this.m_regSelectNode.setAttribute("disabled","disabled");}}
ClientDestinationEdit2.prototype.addRegion=function(code,descr){var opt=document.createElement("OPTION");opt.setAttribute("value",code);opt.appendChild(document.createTextNode(descr));this.m_regSelectNode.appendChild(opt);}
ClientDestinationEdit2.prototype.toDOMCont=function(){for(var i=0;i<window.prior_regions.length;i++){this.addRegion(window.prior_regions[i].code,window.prior_regions[i]["name"]);}
this.addRegion("0","* Все регионы");var sel_cont=document.createElement("DIV");sel_cont.className="input-group-btn";sel_cont.appendChild(this.m_regSelectNode);this.m_node.parentNode.insertBefore(sel_cont,this.m_node);this.m_pm.setParamValue("region",this.m_regSelectNode.value);var self=this;EventHandler.addEvent(this.m_regSelectNode,"change",function(e){self.m_pm.setParamValue("region",self.m_regSelectNode.value);self.m_regSelectNode.focus();});}
ClientDestinationEdit2.prototype.toDOM=function(parent){ClientDestinationEdit2.superclass.toDOM.call(this,parent);var opt;this.m_regSelectNode=document.createElement("SELECT");this.m_regSelectNode.setAttribute("style","width:100px;");this.m_regSelectNode.setAttribute("disabled","disabled");this.m_regSelectNode.className="form-control";if(!window.prior_regions){var self=this;(new Kladr_Controller(new ServConnector(HOST_NAME))).run("get_prior_region_list",{"async":true,"func":function(resp){window.prior_regions=[];var m=resp.getModelById("Kladr_Model");m.setActive(true);while(m.getNextRow()){window.prior_regions.push({"code":m.getFieldById("code").getValue(),"name":m.getFieldById("name").getValue()});}
self.toDOMCont();}});}
else{this.toDOMCont();}} 
function EditMoneyEditable(id,options){options=options||{};this.m_onToggle=options.onToggle;this.m_editAllowedFieldCtrl=options.editAllowedFieldCtrl;EditMoneyEditable.superclass.constructor.call(this,id,options);var self=this;this.m_btnEdit=new ButtonCtrl(id+"_btn_edit",{"attrs":{"title":"разрешить редактирование"},"glyph":"glyphicon-pencil","onClick":function(){self.toggleEdit();}});this.m_buttons.addElement(this.m_btnEdit);}
extend(EditMoneyEditable,EditMoney);EditMoneyEditable.prototype.toggleEdit=function(){var val_b=true
var val_s="true";if(this.m_editAllowedFieldCtrl.getValue()=="true"){val_b=false;val_s="false";}
this.m_editAllowedFieldCtrl.setValue(val_s);this.setEnabled(val_b);if(val_b){this.m_node.focus();}
if(this.m_onToggle){this.m_onToggle(val_b);}}
EditMoneyEditable.prototype.toDOM=function(parent){EditMoneyEditable.superclass.toDOM.call(this,parent);if(this.m_editAllowedFieldCtrl.getValue()=="false"){this.setEnabled(false);}}
EditMoneyEditable.prototype.setEnabled=function(en){EditMoneyEditable.superclass.setEnabled.call(this,en);if(this.m_btnEdit){this.m_btnEdit.setEnabled(true);}}
EditMoneyEditable.prototype.setEditEnabled=function(en){this.m_btnEdit.setEnabled(en);} 
function ClientPriceListClientGridCom(id,options){options=options||{};options.noInsert=false;options.noPrint=true;options.noExport=true;options.noEdit=true;options.noCopy=true;options.noRefresh=true;ClientPriceListClientGridCom.superclass.constructor.call(this,id,options);}
extend(ClientPriceListClientGridCom,GridCommands);ClientPriceListClientGridCom.prototype.addInsert=function(){var self=this;this.setElementById(this.getId()+"_insert",new ButtonSelectObject(uuid(),{"glyph":"glyphicon-plus","listView":ClientPriceListList_View,"methodId":"get_list","modelId":"ClientPriceListList_Model","onSelected":function(keys,descrs){var contr=new ClientPriceListClient_Controller(new ServConnector(HOST_NAME));contr.run("insert",{"func":function(){self.m_clickContext.onRefresh();},"params":{"client_id":self.client_id,"price_list_id":keys["id"]}});},"attrs":{"title":"добавить прайс"}}));} 
function DOCOrderQuantEdit(id,options){options=options||{};this.m_isInteger=false;this.m_precision=4;DOCOrderQuantEdit.superclass.constructor.call(this,id,options);}
extend(DOCOrderQuantEdit,EditFloat);DOCOrderQuantEdit.prototype.validate=function(val){if(this.m_isInteger&&Math.round(val)!=val){this.setNotValid("Только целое значение!");}
return DOCOrderQuantEdit.superclass.validate.call(this,val);} 
function DocOrderChildren(id,options){DocOrderChildren.superclass.constructor.call(this,id,"div",options);}
extend(DocOrderChildren,ControlContainer);DocOrderChildren.prototype.setDocId=function(docId){this.m_docId=docId;}
DocOrderChildren.prototype.toDOM=function(parent){DocOrderChildren.superclass.toDOM.call(this,parent);var self=this;var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("get_children",{params:{doc_id:this.m_docId},func:function(resp){var m=resp.getModelById("get_children",true);self.m_cont=null;while(m.getNextRow()){if(!self.m_cont){self.m_cont=new ControlContainer(self.m_id+"_cont","div");self.m_cont.addElement(new Control(self.m_id+"_t1","span",{value:"Неполная отгрузка."}));self.m_cont.addElement(new Control(self.m_id+"_t2","span",{value:"Связный документ:"}));self.m_children=new ControlContainer(self.m_id+"_list","ul");}
self.m_children.addElement(new Control(uuid(),"li",{value:"№"+m.getFieldValue("number"),className:"doc_order_rest",events:{onClick:function(){alert("Open Order! "+m.getFieldValue("id"));}}}));}
if(self.m_cont){self.m_cont.addElement(self.m_children);self.m_cont.toDOM(self.m_node);}}});} 
function DOCOrderCancelCause(id,options){DOCOrderCancelCause.superclass.constructor.call(this,id,"div",options);}
extend(DOCOrderCancelCause,ControlContainer);DOCOrderCancelCause.prototype.setDocId=function(docId){this.m_docId=docId;}
DOCOrderCancelCause.prototype.toDOM=function(parent){DOCOrderCancelCause.superclass.toDOM.call(this,parent);var self=this;var contr=new DOCOrder_Controller(new ServConnector(HOST_NAME));contr.run("get_cancel_cause",{params:{doc_id:this.m_docId},func:function(resp){var m=resp.getModelById("get_cancel_cause",true);self.m_cont=null;if(m.getNextRow()){self.m_cont=new ControlContainer(self.m_id+"_cont","div",{"className":"doc_order_cancel_cause"});self.m_cont.addElement(new Control(self.m_id+"_t1","span",{value:"Причина отмены: "+m.getFieldValue("cause")}));self.m_cont.toDOM(self.m_node);}}});} 
function BtnRefreshClientDebts(options){var id=uuid();options.caption="Обновить из 1с";options.attrs={"title":"Обновить долги из базы 1с"};options.onClick=function(){var keys=options.grid.getSelectedNodeKeys();if(keys){var contr=new Client_Controller(new ServConnector(HOST_NAME));contr.run("refresh_debts",{"async":true,"xml":true,"func":function(resp){window.showTempNote("Данные по долгам обновлены.",function(){options.grid.onRefresh();},ERR_MSG_WAIT_MS);},"cont":this,"errControl":options.grid.getErrorControl()});}};BtnRefreshClientDebts.superclass.constructor.call(this,id,options);}
extend(BtnRefreshClientDebts,Button); 
function EditFile(id,options){options=options||{};this.m_onDownload=options.onDownload;this.m_onDeleteFile=options.onDeleteFile;this.m_multipleFiles=(options.multipleFiles!=undefined)?options.multipleFiles:false;this.m_onFileAdded=options.onFileAdded;this.m_onFileSigAdded=options.onFileSigAdded;this.m_onFileDeleted=options.onFileDeleted;this.m_allowedFileExtList=(options.allowedFileExtList!=undefined&&CommonHelper.isArray(options.allowedFileExtList))?options.allowedFileExtList:null;this.m_allowedFileTypeList=(options.allowedFileTypeList!=undefined&&CommonHelper.isArray(options.allowedFileTypeList))?options.allowedFileTypeList:null;this.m_showHref=(options.showHref!=undefined)?options.showHref:true;this.m_showPic=(options.showPic!=undefined)?options.showPic:false;this.setContTagName(options.contTagName||"DIV");this.m_files=[];var self=this;var init_val;if(options.value){init_val=options.value;options.value=undefined;}
options.addElement=function(){this.m_ctrlFileCont=new ControlContainer(id+"_file_cont",this.getContTagName())
this.addElement(this.m_ctrlFileCont);if(options.labelCaption){this.addElement(new Control(id+":label","LABEL",{"value":options.labelCaption,"className":options.labelClassName}));}
var file_ctrl_opts={"attrs":{"type":"file","style":"display:none;"},"events":{"change":function(){self.fileAdded();}}}
if(this.m_multipleFiles){file_ctrl_opts.attrs=file_ctrl_opts.attrs||{};file_ctrl_opts.attrs.multiple="multiple";}
this.m_ctrlFile=new Control(id+"_file","INPUT",file_ctrl_opts)
this.addElement(this.m_ctrlFile);this.addElement(new ButtonCtrl(id+":add",{"glyph":"glyphicon-plus","title":"Выбрать файл","onClick":function(){$(self.m_ctrlFile.getNode()).click();}}));}
EditFile.superclass.constructor.call(this,id,"DIV",options);if(init_val){this.setInitValue(init_val);}}
extend(EditFile,ControlContainer);EditFile.prototype.getContTagName=function(){return this.m_contTagName;}
EditFile.prototype.setContTagName=function(v){this.m_contTagName=v;}
EditFile.prototype.getValue=function(){return this.m_files.length?this.m_files:null;}
EditFile.prototype.getFiles=function(){return this.m_files;}
EditFile.prototype.setValue=function(v){this.m_files=[];this.m_ctrlFile.getNode().value="";if(v&&!CommonHelper.isArray(v)&&v.id&&v.name&&v.size){var el=v;v=[el];}
if(v&&CommonHelper.isArray(v)){this.m_ctrlFileCont.clear();for(var i=0;i<v.length;i++){v[i].uploaded=true;this.addFile(v[i],true);}
this.m_ctrlFileCont.toDOM(this.m_node);}
this.m_modified=false;}
EditFile.prototype.setInitValue=function(v){this.setValue(v);}
EditFile.prototype.deleteFileFromDOM=function(fileId){var cont=this.m_ctrlFileCont;if(this.m_multipleFiles){for(var i=0;i<this.m_files.length;i++){if(this.m_files[i]&&this.m_files[i].file_id&&this.m_files[i].file_id==fileId){delete this.m_files[i];this.m_files[i]=undefined;break;}}
cont.delElement(fileId);cont.delElement(fileId+"-href");cont.delElement(fileId+"-del");if(this.m_showPic){cont.delElement(fileId+"-preview");}}
else{this.m_files=[];cont.clear();}
cont.toDOM();if(this.m_onFileDeleted)this.m_onFileDeleted();}
EditFile.prototype.getModified=function(){return this.m_modified;}
EditFile.prototype.setValid=function(){}
EditFile.prototype.reset=function(){this.setValue(null);this.m_ctrlFileCont.clear();this.m_ctrlFileCont.toDOM();}
EditFile.prototype.setEnabled=function(v){EditFile.superclass.setEnabled.call(this,v);var hrefs=DOMHandler.getElementsByAttr("true",this.m_node,"download_href",false);for(var i=0;i<hrefs.length;i++){DOMHandler.delAttr(hrefs[i],"disabled");}}
EditFile.prototype.fileAdded=function(){var fl_list=this.m_ctrlFile.getNode().files;if(!this.m_multipleFiles&&fl_list.length>1){throw new Error(this.ER_MULTIPLE_FILES_NOT_ALLOWED);}
if(!this.m_multipleFiles){this.m_files=[];}
if(this.m_allowedFileExtList){var ext_ar=fl_list[fl_list.length-1].name.split(".");if(!ext_ar.length||ext_ar.length<2){throw new Error(this.ER_EXT_NOT_DEFINED);}
if(CommonHelper.inArray(ext_ar[ext_ar.length-1].toLowerCase(),this.m_allowedFileExtList)==-1){throw new Error(CommonHelper.format(this.ER_EXT_NOT_ALLOWED,ext_ar[ext_ar.length-1]));}}
if(this.m_allowedFileTypeList&&fl_list[fl_list.length-1].type){if(CommonHelper.inArray(fl_list[fl_list.length-1].type,this.m_allowedFileTypeList)==-1){throw new Error(CommonHelper.format(this.ER_TYPE_NOT_ALLOWED,fl_list[fl_list.length-1].type));}}
var ctrls_to_add={};for(var fi=0;fi<fl_list.length;fi++){var fl=fl_list[fi];fl.file_id=CommonHelper.uniqid();this.m_files.push(fl);ctrls_to_add[fl.name]={"id":fl.file_id,"name":fl.name,"size":fl.size,"file_uploaded":false,"file_signed":false,"signatures":[]};}
for(var n in ctrls_to_add){this.addFile(ctrls_to_add[n]);if(this.m_onFileAdded){this.m_onFileAdded();}}
this.m_ctrlFileCont.toDOM();this.m_modified=true;}
EditFile.prototype.addFile=function(fileInf){var cont=this.m_ctrlFileCont;if(!this.m_multipleFiles){cont.clear();}
var file_template_opts={"file_uploaded":fileInf.uploaded,"file_not_uploaded":!fileInf.uploaded,"file_deletable":(this.m_onDeleteFile)?true:false,"name":fileInf.name,"file_size_formatted":CommonHelper.byteFormat(fileInf.size)};CommonHelper.merge(file_template_opts,this.m_fileInfTemplateOptions||{});var file_opts={"attrs":{"class":"orderAttachCont"}};var file_ctrl=new ControlContainer(fileInf.id,"DIV",file_opts);file_ctrl.isFileControl=true;var self=this;if(this.m_showHref){file_ctrl.addElement(new Button(fileInf.id+"-href",{"attrs":{"class":"","download_href":"true","file_id":fileInf.id,"file_uploaded":fileInf.uploaded},"onClick":function(e){e.preventDefault();if(this.getAttr("file_uploaded")=="true"){self.m_onDownload(this.getAttr("file_id"));}}}));}
if(this.m_onDeleteFile){file_ctrl.addElement(new Button(fileInf.id+"-del",{"caption":"X","attrs":{"file_id":fileInf.id,"file_uploaded":fileInf.uploaded,"title":"Удалить файл"},"onClick":function(){if(this.getAttr("file_uploaded")=="true"){var file_id=this.getAttr("file_id");self.m_onDeleteFile(file_id,function(){self.m_modified=false;self.deleteFileFromDOM(file_id);});}
else{self.deleteFileFromDOM(this.getAttr("file_id"));}}}));}
if(this.m_showPic){file_ctrl.addElement(new Control(fileInf.id+"-preview","img",{"attrs":{"style":"cursor:pointer;","title":"Скачать файл","src":"data:image/png;base64, "+fileInf.dataBase64},"events":{"click":function(){self.m_onDownload(fileInf.id);}}}));}
cont.addElement(file_ctrl);} 
EditFile.prototype.ER_NO_SIG="Файл с данными для этой ЭЦП не найден!";EditFile.prototype.ER_MULTIPLE_FILES_NOT_ALLOWED="Загрузка нескольких файлов запрещена!"; 
function ProdBatchEdit(opts){let contr=new ProdBatch_Controller(new ServConnector(HOST_NAME));contr.getPublicMethodById("complete_from_1c").setParamValue("doc_order_id",opts.orderId);options={"methodId":"complete_from_1c","tableLayout":false,"modelId":"ProdBatch1CList_Model","lookupValueFieldId":"batch_descr","patternParamId":"pattern","lookupKeyFieldIds":["ext_id"],"controller":contr,"minLengthForQuery":"1","ic":"1","mid":"1","keyFieldIds":[opts.fieldId],"winObj":this.m_winObj,"listView":ProdBatch1CList_View,"attrs":{"fkey_ext_id":"ext_id"},"buttonSelect":new ButtonSelectObject(opts.controlId+'_btn_select',{"controller":contr,"modelId":"ProdBatch1CList_Model","listView":ProdBatch1CList_View,"keyFieldIds":["ext_id"],"lookupKeyFieldIds":["ext_id"],"multySelect":false,"extraFields":null,"controlId":opts.controlId,"methParams":{"doc_order_id":null},"onBeforeViewCreate":function(){},"onSelected":function(keys,descrs,extraFields){let methId=(opts.mainView.getIsNew())?opts.mainView.m_insertMethId:opts.mainView.m_updateMethId;opts.mainView.setWriteMethodId(methId);var contr=opts.mainView.getWriteController();contr.getPublicMethodById(methId).setParamValue("batch_descr",descrs["batch_descr"]);}}),"onSelected":function(input){let methId=(opts.mainView.getIsNew())?opts.mainView.m_insertMethId:opts.mainView.m_updateMethId;opts.mainView.setWriteMethodId(methId);var contr=opts.mainView.getWriteController();contr.getPublicMethodById(methId).setParamValue("batch_descr",input.value);},"noAutoComplete":true};opts.options=opts.options||{};for(var opt in opts.options){options[opt]=opts.options[opt];}
if(opts.inLine==undefined||(opts.inLine!=undefined&&!opts.inLine)){options["labelCaption"]="Партия:";}
ProdBatchEdit.superclass.constructor.call(this,opts.controlId,options);}
extend(ProdBatchEdit,EditObject); 
function DragObject(element){element.dragObject=this;this.element=element;dragMaster.makeDraggable(element);}
DragObject.prototype.rememberPosition;DragObject.prototype.mouseOffset;DragObject.prototype.onDragStart=function(offset){var s=this.element.style;this.rememberPosition={top:s.top,left:s.left,position:s.position};s.position="absolute";this.mouseOffset=offset;}
DragObject.prototype.hide=function(){this.element.style.display="none";}
DragObject.prototype.show=function(){this.element.style.display="";}
DragObject.prototype.onDragMove=function(x,y){this.element.style.top=y-this.mouseOffset.y+"px";this.element.style.left=x-this.mouseOffset.x+"px";}
DragObject.prototype.onDragSuccess=function(dropTarget){}
DragObject.prototype.onDragFail=function(){var s=this.element.style;s.top=this.rememberPosition.top;s.left=this.rememberPosition.left;s.position=this.rememberPosition.position;}
DragObject.prototype.toString=function(){return element.id;} 
function DropTarget(element){this.element=element;element.dropTarget=this;}
DropTarget.prototype.CLASS_NAME='uponMe';DropTarget.prototype.canAccept=function(dragObject){return true;}
DropTarget.prototype.accept=function(dragObject){this.onLeave();dragObject.hide();alert("Акцептор '"+this+"': принял объект '"+dragObject+"'");return true;}
DropTarget.prototype.onLeave=function(){DOMHandler.removeClass(this.element,this.CLASS_NAME);}
DropTarget.prototype.onEnter=function(){DOMHandler.addClass(this.element,this.CLASS_NAME);}
DropTarget.prototype.toString=function(){return this.element.id;} 
var dragMaster=(function(){var dragObject;var mouseDownAt;var currentDropTarget;function mouseDown(e){e=fixEvent(e);if(e.which!=1)return;mouseDownAt={x:e.pageX,y:e.pageY,element:this}
addDocumentEventHandlers();return false;}
function mouseMove(e){e=fixEvent(e);if(mouseDownAt){if(Math.abs(mouseDownAt.x-e.pageX)<5&&Math.abs(mouseDownAt.y-e.pageY)<5){return false;}
var elem=mouseDownAt.element;dragObject=elem.dragObject;var mouseOffset=getMouseOffset(elem,mouseDownAt.x,mouseDownAt.y)
mouseDownAt=null
dragObject.onDragStart(mouseOffset);}
dragObject.onDragMove(e.pageX,e.pageY);var newTarget=getCurrentTarget(e);if(currentDropTarget!=newTarget){if(currentDropTarget){currentDropTarget.onLeave()}
if(newTarget){newTarget.onEnter();}
currentDropTarget=newTarget;}
return false;}
function mouseUp(){if(!dragObject){mouseDownAt=null;}else{if(currentDropTarget&&currentDropTarget.accept(dragObject)){dragObject.onDragSuccess(currentDropTarget);}else{dragObject.onDragFail(currentDropTarget);}
dragObject=null;}
removeDocumentEventHandlers();}
function getMouseOffset(target,x,y){var docPos=getOffset(target)
return{x:x-docPos.left,y:y-docPos.top}}
function getCurrentTarget(e){if(navigator.userAgent.match('MSIE')||navigator.userAgent.match('Gecko')){var x=e.clientX,y=e.clientY}else{var x=e.pageX,y=e.pageY}
dragObject.hide()
var elem=document.elementFromPoint(x,y)
dragObject.show()
while(elem){if(elem.dropTarget&&elem.dropTarget.canAccept(dragObject)){return elem.dropTarget}
elem=elem.parentNode}
return null}
function addDocumentEventHandlers(){document.onmousemove=mouseMove
document.onmouseup=mouseUp
document.ondragstart=document.body.onselectstart=function(){return false}}
function removeDocumentEventHandlers(){document.onmousemove=document.onmouseup=document.ondragstart=document.body.onselectstart=null}
return{makeDraggable:function(element){element.onmousedown=mouseDown}}}()) 
function fixEvent(e){e=e||window.event
if(e.pageX==null&&e.clientX!=null){var html=document.documentElement
var body=document.body
e.pageX=e.clientX+(html&&html.scrollLeft||body&&body.scrollLeft||0)-(html.clientLeft||0)
e.pageY=e.clientY+(html&&html.scrollTop||body&&body.scrollTop||0)-(html.clientTop||0)}
if(!e.which&&e.button){e.which=e.button&1?1:(e.button&2?3:(e.button&4?2:0))}
return e}
function getOffset(elem){if(elem.getBoundingClientRect){return getOffsetRect(elem)}else{return getOffsetSum(elem)}}
function getOffsetRect(elem){var box=elem.getBoundingClientRect()
var body=document.body
var docElem=document.documentElement
var scrollTop=window.pageYOffset||docElem.scrollTop||body.scrollTop
var scrollLeft=window.pageXOffset||docElem.scrollLeft||body.scrollLeft
var clientTop=docElem.clientTop||body.clientTop||0
var clientLeft=docElem.clientLeft||body.clientLeft||0
var top=box.top+scrollTop-clientTop
var left=box.left+scrollLeft-clientLeft
return{top:Math.round(top),left:Math.round(left)}}
function getOffsetSum(elem){var top=0,left=0
while(elem){top=top+parseInt(elem.offsetTop)
left=left+parseInt(elem.offsetLeft)
elem=elem.offsetParent}
return{top:top,left:left}} 
function ProductGroup_Controller(servConnector){options={};options["listModelId"]="ProductGroupList_Model";options["objModelId"]="ProductGroupList_Model";ProductGroup_Controller.superclass.constructor.call(this,"ProductGroup_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ProductGroup_Controller,ControllerDb);ProductGroup_Controller.prototype.addInsert=function(){ProductGroup_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
ProductGroup_Controller.prototype.addUpdate=function(){ProductGroup_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldString("ext_id",options);pm.addParam(param);}
ProductGroup_Controller.prototype.addDelete=function(){ProductGroup_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ProductGroup_Controller.prototype.addGetList=function(){ProductGroup_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldString("match_1c",options));}
ProductGroup_Controller.prototype.addGetObject=function(){ProductGroup_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}  
function Naspunkt_Controller(servConnector){options={};options["listModelId"]="NaspunktList_Model";options["objModelId"]="NaspunktList_Model";Naspunkt_Controller.superclass.constructor.call(this,"Naspunkt_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(Naspunkt_Controller,ControllerDb);Naspunkt_Controller.prototype.addInsert=function(){Naspunkt_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("city_id",options);pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldInt("distance",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
Naspunkt_Controller.prototype.addUpdate=function(){Naspunkt_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("city_id",options);pm.addParam(param);options={};var param=new FieldString("name",options);pm.addParam(param);options={};var param=new FieldInt("distance",options);pm.addParam(param);}
Naspunkt_Controller.prototype.addDelete=function(){Naspunkt_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
Naspunkt_Controller.prototype.addGetList=function(){Naspunkt_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("city_id",options));pm.addParam(new FieldString("city_descr",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldInt("distance",options));}
Naspunkt_Controller.prototype.addGetObject=function(){Naspunkt_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function AccPKO_Controller(servConnector){options={};options["listModelId"]="AccPKOList_Model";options["objModelId"]="AccPKOList_Model";AccPKO_Controller.superclass.constructor.call(this,"AccPKO_Controller",servConnector,options);this.addGetList();this.addGetObject();}
extend(AccPKO_Controller,ControllerDb);AccPKO_Controller.prototype.addGetList=function(){AccPKO_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldDateTime("date_time",options));pm.addParam(new FieldString("date_time_descr",options));pm.addParam(new FieldEnum("acc_pko_type",options));pm.addParam(new FieldString("acc_pko_type_descr",options));pm.addParam(new FieldFloat("total",options));pm.addParam(new FieldText("order_list",options));}
AccPKO_Controller.prototype.addGetObject=function(){AccPKO_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function TemplateParam_Controller(servConnector){options={};options["listModelId"]="TemplateParamList_Model";TemplateParam_Controller.superclass.constructor.call(this,"TemplateParam_Controller",servConnector,options);this.addGetList();this.add_set_value();}
extend(TemplateParam_Controller,ControllerDb);TemplateParam_Controller.prototype.addGetList=function(){TemplateParam_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldString("template",options));pm.addParam(new FieldString("param",options));pm.addParam(new FieldText("val",options));}
TemplateParam_Controller.prototype.add_set_value=function(){var pm=this.addMethodById('set_value');pm.addParam(new FieldString("template"));pm.addParam(new FieldString("param"));pm.addParam(new FieldText("val"));} 
function TTNAttrPair_Controller(servConnector){options={};options["listModelId"]="TTNAttrPairList_Model";options["objModelId"]="TTNAttrPairList_Model";TTNAttrPair_Controller.superclass.constructor.call(this,"TTNAttrPair_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(TTNAttrPair_Controller,ControllerDb);TTNAttrPair_Controller.prototype.addInsert=function(){TTNAttrPair_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Фирма";var param=new FieldInt("firm_id",options);pm.addParam(param);options={};options["alias"]="Склад";var param=new FieldInt("warehouse_id",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
TTNAttrPair_Controller.prototype.addUpdate=function(){TTNAttrPair_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Фирма";var param=new FieldInt("firm_id",options);pm.addParam(param);options={};options["alias"]="Склад";var param=new FieldInt("warehouse_id",options);pm.addParam(param);}
TTNAttrPair_Controller.prototype.addDelete=function(){TTNAttrPair_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
TTNAttrPair_Controller.prototype.addGetList=function(){TTNAttrPair_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("firm_id",options));pm.addParam(new FieldString("firm_descr",options));pm.addParam(new FieldInt("warehouse_id",options));pm.addParam(new FieldString("warehouse_descr",options));}
TTNAttrPair_Controller.prototype.addGetObject=function(){TTNAttrPair_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function CarrierOrder_Controller(servConnector){options={};options["listModelId"]="CarrierOrderList_Model";options["objModelId"]="CarrierOrderList_Model";CarrierOrder_Controller.superclass.constructor.call(this,"CarrierOrder_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(CarrierOrder_Controller,ControllerDb);CarrierOrder_Controller.prototype.addInsert=function(){CarrierOrder_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Перевозчик код";var param=new FieldInt("carrier_id",options);pm.addParam(param);options={};options["alias"]="Водитель код";var param=new FieldInt("driver_id",options);pm.addParam(param);options={};options["alias"]="ТС код";var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};options["alias"]="Порядок";var param=new FieldInt("ord",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
CarrierOrder_Controller.prototype.addUpdate=function(){CarrierOrder_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Перевозчик код";var param=new FieldInt("carrier_id",options);pm.addParam(param);options={};options["alias"]="Водитель код";var param=new FieldInt("driver_id",options);pm.addParam(param);options={};options["alias"]="ТС код";var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};options["alias"]="Порядок";var param=new FieldInt("ord",options);pm.addParam(param);}
CarrierOrder_Controller.prototype.addDelete=function(){CarrierOrder_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
CarrierOrder_Controller.prototype.addGetList=function(){CarrierOrder_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("carrier_id",options));pm.addParam(new FieldString("carrier_descr",options));pm.addParam(new FieldInt("driver_id",options));pm.addParam(new FieldString("driver_descr",options));pm.addParam(new FieldInt("vehicle_id",options));pm.addParam(new FieldString("vehicle_descr",options));pm.addParam(new FieldInt("ord",options));pm.addParam(new FieldInt("today_ord",options));}
CarrierOrder_Controller.prototype.addGetObject=function(){CarrierOrder_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function ConstantList_Model(options){var id='ConstantList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldString("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.descr=new FieldText("descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.val_descr=new FieldText("val_descr",filed_options);ConstantList_Model.superclass.constructor.call(this,id,options);}
extend(ConstantList_Model,Model); 
function Firm_Model(options){var id='Firm_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sert_header=new FieldText("sert_header",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.nds=new FieldBool("nds",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cash=new FieldBool("cash",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.deleted=new FieldBool("deleted",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.order_no_carrier_print=new FieldBool("order_no_carrier_print",filed_options);Firm_Model.superclass.constructor.call(this,id,options);}
extend(Firm_Model,Model); 
function FirmList_Model(options){var id='FirmList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.match_1c=new FieldString("match_1c",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.nds=new FieldBool("nds",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cash=new FieldBool("cash",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deleted=new FieldBool("deleted",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.order_no_carrier_print=new FieldBool("order_no_carrier_print",filed_options);FirmList_Model.superclass.constructor.call(this,id,options);}
extend(FirmList_Model,Model); 
function ClientActivity_Model(options){var id='ClientActivity_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);ClientActivity_Model.superclass.constructor.call(this,id,options);}
extend(ClientActivity_Model,Model); 
function ClientActivityList_Model(options){var id='ClientActivityList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.alias='Код';filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Наименование';filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Соответствие 1с';filed_options.autoInc=false;options.fields.match_1c=new FieldString("match_1c",filed_options);ClientActivityList_Model.superclass.constructor.call(this,id,options);}
extend(ClientActivityList_Model,Model); 
function Client_Model(options){var id='Client_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);options.fields.name.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name_full=new FieldText("name_full",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.inn=new FieldString("inn",filed_options);options.fields.inn.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.kpp=new FieldString("kpp",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.addr_reg=new FieldText("addr_reg",filed_options);options.fields.addr_reg.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.addr_mail=new FieldText("addr_mail",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.addr_mail_same_as_reg=new FieldBool("addr_mail_same_as_reg",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.telephones=new FieldText("telephones",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ogrn=new FieldString("ogrn",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.okpo=new FieldString("okpo",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.acc=new FieldString("acc",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.bank_name=new FieldText("bank_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.bank_code=new FieldString("bank_code",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.bank_acc=new FieldString("bank_acc",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.registered=new FieldBool("registered",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pay_type=new FieldEnum("pay_type",filed_options);filed_options.enumValues='cash,in_advance,with_delay';var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pay_delay_days=new FieldInt("pay_delay_days",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.pay_fix_to_dow=new FieldBool("pay_fix_to_dow",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pay_dow_days=new FieldString("pay_dow_days",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.pay_ban_on_debt_days=new FieldBool("pay_ban_on_debt_days",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.pay_debt_days=new FieldInt("pay_debt_days",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.pay_ban_on_debt_sum=new FieldBool("pay_ban_on_debt_sum",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pay_debt_sum=new FieldFloat("pay_debt_sum",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.login_allowed=new FieldBool("login_allowed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.sms_on_order_change=new FieldBool("sms_on_order_change",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.email_sert=new FieldBool("email_sert",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.show_delivery_tab=new FieldBool("show_delivery_tab",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_activity_id=new FieldInt("client_activity_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.def_firm_id=new FieldInt("def_firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.def_warehouse_id=new FieldInt("def_warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.deleted=new FieldBool("deleted",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.email=new FieldString("email",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_add_cost_to_product=new FieldBool("deliv_add_cost_to_product",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.is_supplier=new FieldBool("is_supplier",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.is_carrier=new FieldBool("is_carrier",filed_options);Client_Model.superclass.constructor.call(this,id,options);}
extend(Client_Model,Model); 
function ClientList_Model(options){var id='ClientList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.occupation=new FieldText("occupation",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.inn=new FieldString("inn",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.contract_descr=new FieldString("contract_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.contract_period=new FieldString("contract_period",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.terms=new FieldString("terms",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.banned=new FieldBool("banned",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_activity_descr=new FieldString("client_activity_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.login_allowed=new FieldBool("login_allowed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.def_firm_id=new FieldInt("def_firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.def_warehouse_id=new FieldInt("def_warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.def_debt=new FieldFloat("def_debt",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.debt_total=new FieldFloat("debt_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deleted=new FieldBool("deleted",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_add_cost_to_product=new FieldString("deliv_add_cost_to_product",filed_options);ClientList_Model.superclass.constructor.call(this,id,options);}
extend(ClientList_Model,Model); 
function ClientDialog_Model(options){var id='ClientDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name_full=new FieldString("name_full",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.occupation=new FieldText("occupation",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.inn=new FieldString("inn",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.banned=new FieldBool("banned",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.def_firm_id=new FieldInt("def_firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.def_warehouse_id=new FieldInt("def_warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deleted=new FieldBool("deleted",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.email=new FieldString("email",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_add_cost_to_product=new FieldBool("deliv_add_cost_to_product",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.is_supplier=new FieldBool("is_supplier",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.is_carrier=new FieldBool("is_carrier",filed_options);ClientDialog_Model.superclass.constructor.call(this,id,options);}
extend(ClientDialog_Model,Model); 
function ClientComplete_Model(options){var id='ClientComplete_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_add_cost_to_product=new FieldString("deliv_add_cost_to_product",filed_options);ClientComplete_Model.superclass.constructor.call(this,id,options);}
extend(ClientComplete_Model,Model); 
function ClientContract_Model(options){var id='ClientContract_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);options.fields.client_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);options.fields.firm_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Состояние';filed_options.autoInc=false;options.fields.state=new FieldEnum("state",filed_options);filed_options.enumValues='signed,not_signed';options.fields.state.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата с';filed_options.autoInc=false;options.fields.date_from=new FieldDate("date_from",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата по';filed_options.autoInc=false;options.fields.date_to=new FieldDate("date_to",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='номер';filed_options.autoInc=false;options.fields.number=new FieldString("number",filed_options);ClientContract_Model.superclass.constructor.call(this,id,options);}
extend(ClientContract_Model,Model); 
function ClientContractList_Model(options){var id='ClientContractList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_descr=new FieldString("firm_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state=new FieldString("state",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state_descr=new FieldString("state_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_to_descr=new FieldString("date_to_descr",filed_options);ClientContractList_Model.superclass.constructor.call(this,id,options);}
extend(ClientContractList_Model,Model); 
function ClientDestination_Model(options){var id='ClientDestination_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);options.fields.client_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.value=new FieldText("value",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.zone_center=new FieldGeomPoint("zone_center",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.near_road_lon=new FieldFloat("near_road_lon",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.near_road_lat=new FieldFloat("near_road_lat",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.region=new FieldText("region",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.region_code=new FieldText("region_code",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.raion=new FieldText("raion",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.raion_code=new FieldText("raion_code",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.gorod=new FieldText("gorod",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.gorod_code=new FieldText("gorod_code",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.naspunkt=new FieldText("naspunkt",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.naspunkt_code=new FieldText("naspunkt_code",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ulitza=new FieldText("ulitza",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ulitza_code=new FieldText("ulitza_code",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.dom=new FieldText("dom",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.korpus=new FieldText("korpus",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.kvartira=new FieldText("kvartira",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.addr_index=new FieldText("addr_index",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.value=new FieldText("value",filed_options);ClientDestination_Model.superclass.constructor.call(this,id,options);}
extend(ClientDestination_Model,Model); 
function ClientDestinationList_Model(options){var id='ClientDestinationList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.address=new FieldText("address",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.value=new FieldText("value",filed_options);ClientDestinationList_Model.superclass.constructor.call(this,id,options);}
extend(ClientDestinationList_Model,Model); 
function ClientDestinationDialog_Model(options){var id='ClientDestinationDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.zone_center_str=new FieldString("zone_center_str",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.value=new FieldText("value",filed_options);ClientDestinationDialog_Model.superclass.constructor.call(this,id,options);}
extend(ClientDestinationDialog_Model,Model); 
function ProductionCity_Model(options){var id='ProductionCity_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.zone=new FieldGeomPolygon("zone",filed_options);ProductionCity_Model.superclass.constructor.call(this,id,options);}
extend(ProductionCity_Model,Model); 
function ProductionCityList_Model(options){var id='ProductionCityList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);ProductionCityList_Model.superclass.constructor.call(this,id,options);}
extend(ProductionCityList_Model,Model); 
function ProductionCityDialog_Model(options){var id='ProductionCityDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.zone=new FieldString("zone",filed_options);ProductionCityDialog_Model.superclass.constructor.call(this,id,options);}
extend(ProductionCityDialog_Model,Model); 
function Warehouse_Model(options){var id='Warehouse_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.zone=new FieldGeomPolygon("zone",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.production_city_id=new FieldInt("production_city_id",filed_options);options.fields.production_city_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.default_firm_id=new FieldInt("default_firm_id",filed_options);options.fields.default_firm_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.near_road_lon=new FieldFloat("near_road_lon",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.near_road_lat=new FieldFloat("near_road_lat",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.address=new FieldText("address",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tel=new FieldText("tel",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.email=new FieldString("email",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.deleted=new FieldBool("deleted",filed_options);Warehouse_Model.superclass.constructor.call(this,id,options);}
extend(Warehouse_Model,Model); 
function WarehouseList_Model(options){var id='WarehouseList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deleted=new FieldBool("deleted",filed_options);WarehouseList_Model.superclass.constructor.call(this,id,options);}
extend(WarehouseList_Model,Model); 
function WarehouseDialog_Model(options){var id='WarehouseDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_id=new FieldString("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_descr=new FieldString("firm_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.production_city_id=new FieldString("production_city_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.production_city_descr=new FieldString("production_city_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.zone_str=new FieldString("zone_str",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.zone_center_str=new FieldString("zone_center_str",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deleted=new FieldBool("deleted",filed_options);WarehouseDialog_Model.superclass.constructor.call(this,id,options);}
extend(WarehouseDialog_Model,Model); 
function User_Model(options){var id='User_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='логин';filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);options.fields.name.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='ФИО';filed_options.autoInc=false;options.fields.name_full=new FieldString("name_full",filed_options);options.fields.name_full.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Приказ';filed_options.autoInc=false;options.fields.sign_order=new FieldString("sign_order",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='роль';filed_options.autoInc=false;options.fields.role_id=new FieldEnum("role_id",filed_options);filed_options.enumValues='admin,client,sales_manager,production,marketing,boss,representative';var filed_options={};filed_options.primaryKey=false;filed_options.alias='эл.почта';filed_options.autoInc=false;options.fields.email=new FieldString("email",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='пароль';filed_options.autoInc=false;options.fields.pwd=new FieldPassword("pwd",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cel_phone=new FieldString("cel_phone",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tel_ext=new FieldString("tel_ext",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_login=new FieldString("ext_login",filed_options);User_Model.superclass.constructor.call(this,id,options);}
extend(User_Model,Model); 
function UserList_Model(options){var id='UserList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name_full=new FieldString("name_full",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.email=new FieldString("email",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.role_descr=new FieldString("role_descr",filed_options);UserList_Model.superclass.constructor.call(this,id,options);}
extend(UserList_Model,Model); 
function UserDialog_Model(options){var id='UserDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.alias='Код';filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Логин';filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='ФИО';filed_options.autoInc=false;options.fields.name_full=new FieldString("name_full",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Эл.почта';filed_options.autoInc=false;options.fields.email=new FieldString("email",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.role_descr=new FieldString("role_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.role_id=new FieldString("role_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Телефон';filed_options.autoInc=false;options.fields.cel_phone=new FieldString("cel_phone",filed_options);UserDialog_Model.superclass.constructor.call(this,id,options);}
extend(UserDialog_Model,Model); 
function ClientUserList_Model(options){var id='ClientUserList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name_full=new FieldString("name_full",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.email=new FieldString("email",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cel_phone=new FieldString("cel_phone",filed_options);ClientUserList_Model.superclass.constructor.call(this,id,options);}
extend(ClientUserList_Model,Model); 
function MeasureUnit_Model(options){var id='MeasureUnit_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name_full=new FieldString("name_full",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.is_int=new FieldBool("is_int",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);MeasureUnit_Model.superclass.constructor.call(this,id,options);}
extend(MeasureUnit_Model,Model); 
function MeasureUnitList_Model(options){var id='MeasureUnitList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);MeasureUnitList_Model.superclass.constructor.call(this,id,options);}
extend(MeasureUnitList_Model,Model); 
function MeasureUnitDialog_Model(options){var id='MeasureUnitDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name_full=new FieldString("name_full",filed_options);MeasureUnitDialog_Model.superclass.constructor.call(this,id,options);}
extend(MeasureUnitDialog_Model,Model); 
function DeliveryPeriod_Model(options){var id='DeliveryPeriod_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);DeliveryPeriod_Model.superclass.constructor.call(this,id,options);}
extend(DeliveryPeriod_Model,Model); 
function Driver_Model(options){var id='Driver_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.drive_perm=new FieldString("drive_perm",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cel_phone=new FieldString("cel_phone",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);Driver_Model.superclass.constructor.call(this,id,options);}
extend(Driver_Model,Model); 
function DriverList_Model(options){var id='DriverList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.drive_perm=new FieldString("drive_perm",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cel_phone=new FieldString("cel_phone",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.match_1c=new FieldString("match_1c",filed_options);DriverList_Model.superclass.constructor.call(this,id,options);}
extend(DriverList_Model,Model); 
function Carrier_Model(options){var id='Carrier_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);options.fields.client_id.setRequired(true);Carrier_Model.superclass.constructor.call(this,id,options);}
extend(Carrier_Model,Model); 
function CarrierList_Model(options){var id='CarrierList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);options.fields.client_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_name=new FieldString("client_name",filed_options);CarrierList_Model.superclass.constructor.call(this,id,options);}
extend(CarrierList_Model,Model); 
function TrackerServer_Model(options){var id='TrackerServer_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='IP адрес';filed_options.autoInc=false;options.fields.ip=new FieldString("ip",filed_options);options.fields.ip.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Описание';filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);TrackerServer_Model.superclass.constructor.call(this,id,options);}
extend(TrackerServer_Model,Model); 
function Tracker_Model(options){var id='Tracker_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldString("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tracker_server_id=new FieldInt("tracker_server_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sim_number=new FieldString("sim_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sim_id=new FieldString("sim_id",filed_options);Tracker_Model.superclass.constructor.call(this,id,options);}
extend(Tracker_Model,Model); 
function TrackerList_Model(options){var id='TrackerList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.alias='Идентификатор';filed_options.autoInc=false;options.fields.id=new FieldString("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tracker_server_id=new FieldInt("tracker_server_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сервер';filed_options.autoInc=false;options.fields.tracker_server_descr=new FieldString("tracker_server_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Номер SIM';filed_options.autoInc=false;options.fields.sim_number=new FieldString("sim_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Идентификатор SIM';filed_options.autoInc=false;options.fields.sim_id=new FieldString("sim_id",filed_options);TrackerList_Model.superclass.constructor.call(this,id,options);}
extend(TrackerList_Model,Model); 
function Vehicle_Model(options){var id='Vehicle_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.model=new FieldString("model",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.plate=new FieldString("plate",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.vol=new FieldInt("vol",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.employed=new FieldBool("employed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.load_weight_t=new FieldFloat("load_weight_t",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.production_city_id=new FieldInt("production_city_id",filed_options);options.fields.production_city_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.carrier_id=new FieldInt("carrier_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.driver_id=new FieldInt("driver_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_cost_opt_id=new FieldInt("deliv_cost_opt_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.trailer_model=new FieldString("trailer_model",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.trailer_plate=new FieldString("trailer_plate",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tracker_id=new FieldString("tracker_id",filed_options);Vehicle_Model.superclass.constructor.call(this,id,options);}
extend(Vehicle_Model,Model); 
function VehicleList_Model(options){var id='VehicleList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.alias='Код';filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Гос.номер';filed_options.autoInc=false;options.fields.plate=new FieldString("plate",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Модель';filed_options.autoInc=false;options.fields.model=new FieldString("model",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Город код';filed_options.autoInc=false;options.fields.production_city_id=new FieldInt("production_city_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Город';filed_options.autoInc=false;options.fields.production_city_descr=new FieldString("production_city_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Водитель код';filed_options.autoInc=false;options.fields.driver_id=new FieldInt("driver_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Водитель';filed_options.autoInc=false;options.fields.driver_descr=new FieldString("driver_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Постоянный';filed_options.autoInc=false;options.fields.employed=new FieldBool("employed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Объем';filed_options.autoInc=false;options.fields.vol=new FieldInt("vol",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Грузоподъемность';filed_options.autoInc=false;options.fields.load_weight_t=new FieldFloat("load_weight_t",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='объем/грузоподъемность';filed_options.autoInc=false;options.fields.vl_wt=new FieldString("vl_wt",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Перевозчник';filed_options.autoInc=false;options.fields.carrier_id=new FieldInt("carrier_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Перевозчник';filed_options.autoInc=false;options.fields.carrier_descr=new FieldString("carrier_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Модель прицепа';filed_options.autoInc=false;options.fields.trailer_model=new FieldString("trailer_model",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Номер прицепа';filed_options.autoInc=false;options.fields.trailer_plate=new FieldString("trailer_plate",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Водитель связан с 1с';filed_options.autoInc=false;options.fields.driver_match_1c=new FieldString("driver_match_1c",filed_options);VehicleList_Model.superclass.constructor.call(this,id,options);}
extend(VehicleList_Model,Model); 
function VehicleDialog_Model(options){var id='VehicleDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.alias='Код';filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Гос.номер';filed_options.autoInc=false;options.fields.plate=new FieldString("plate",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Модель';filed_options.autoInc=false;options.fields.model=new FieldString("model",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Город код';filed_options.autoInc=false;options.fields.production_city_id=new FieldInt("production_city_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Город';filed_options.autoInc=false;options.fields.production_city_descr=new FieldString("production_city_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Водитель код';filed_options.autoInc=false;options.fields.driver_id=new FieldInt("driver_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Водитель';filed_options.autoInc=false;options.fields.driver_descr=new FieldString("driver_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Постоянный';filed_options.autoInc=false;options.fields.employed=new FieldBool("employed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Объем';filed_options.autoInc=false;options.fields.vol=new FieldInt("vol",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Грузоподъемность';filed_options.autoInc=false;options.fields.load_weight_t=new FieldFloat("load_weight_t",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='объем/грузоподъемность';filed_options.autoInc=false;options.fields.vl_wt=new FieldString("vl_wt",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Перевозчник';filed_options.autoInc=false;options.fields.carrier_id=new FieldInt("carrier_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Перевозчник';filed_options.autoInc=false;options.fields.carrier_descr=new FieldString("carrier_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Модель прицепа';filed_options.autoInc=false;options.fields.trailer_model=new FieldString("trailer_model",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Номер прицепа';filed_options.autoInc=false;options.fields.trailer_plate=new FieldString("trailer_plate",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Трекер';filed_options.autoInc=false;options.fields.tracker_id=new FieldString("tracker_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Данные с трекера';filed_options.autoInc=false;options.fields.last_tracker_data=new FieldString("last_tracker_data",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.match_1c=new FieldBool("match_1c",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.driver_drive_perm=new FieldString("driver_drive_perm",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.driver_cel_phone=new FieldString("driver_cel_phone",filed_options);VehicleDialog_Model.superclass.constructor.call(this,id,options);}
extend(VehicleDialog_Model,Model); 
function VehicleSelectList_Model(options){var id='VehicleSelectList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.alias='Код';filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Автомобиль';filed_options.autoInc=false;options.fields.descr=new FieldString("descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Гос.номер';filed_options.autoInc=false;options.fields.plate=new FieldString("plate",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Автомобиль';filed_options.autoInc=false;options.fields.complete_descr=new FieldString("complete_descr",filed_options);VehicleSelectList_Model.superclass.constructor.call(this,id,options);}
extend(VehicleSelectList_Model,Model); 
function SatisfSurveyItem_Model(options){var id='SatisfSurveyItem_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.item=new FieldText("item",filed_options);SatisfSurveyItem_Model.superclass.constructor.call(this,id,options);}
extend(SatisfSurveyItem_Model,Model); 
function SertType_Model(options){var id='SertType_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.xslt_pattern=new FieldString("xslt_pattern",filed_options);SertType_Model.superclass.constructor.call(this,id,options);}
extend(SertType_Model,Model); 
function SertTypeAttr_Model(options){var id='SertTypeAttr_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sert_type_id=new FieldInt("sert_type_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attr_text=new FieldString("attr_text",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attr_val_norm=new FieldString("attr_val_norm",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attr_val=new FieldString("attr_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attr_val_min=new FieldFloat("attr_val_min",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attr_val_max=new FieldFloat("attr_val_max",filed_options);SertTypeAttr_Model.superclass.constructor.call(this,id,options);}
extend(SertTypeAttr_Model,Model); 
function SertTypeAttrList_Model(options){var id='SertTypeAttrList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sert_type_id=new FieldInt("sert_type_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sert_type_descr=new FieldString("sert_type_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attr_text=new FieldString("attr_text",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attr_val_norm=new FieldString("attr_val_norm",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attr_val=new FieldString("attr_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attr_val_min=new FieldFloat("attr_val_min",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attr_val_max=new FieldFloat("attr_val_max",filed_options);SertTypeAttrList_Model.superclass.constructor.call(this,id,options);}
extend(SertTypeAttrList_Model,Model); 
function ProductGroup_Model(options){var id='ProductGroup_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);ProductGroup_Model.superclass.constructor.call(this,id,options);}
extend(ProductGroup_Model,Model); 
function ProductGroupList_Model(options){var id='ProductGroupList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Наименование';filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Соответствие 1с';filed_options.autoInc=false;options.fields.match_1c=new FieldString("match_1c",filed_options);ProductGroupList_Model.superclass.constructor.call(this,id,options);}
extend(ProductGroupList_Model,Model); 
function Product_Model(options){var id='Product_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length_exists=new FieldBool("mes_length_exists",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length_name=new FieldString("mes_length_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length_fix=new FieldBool("mes_length_fix",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length_fix_val=new FieldInt("mes_length_fix_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length_min_val=new FieldInt("mes_length_min_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length_max_val=new FieldInt("mes_length_max_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length_def_val=new FieldInt("mes_length_def_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length_seq=new FieldBool("mes_length_seq",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length_vals=new FieldText("mes_length_vals",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width_exists=new FieldBool("mes_width_exists",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width_name=new FieldString("mes_width_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width_fix=new FieldBool("mes_width_fix",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width_fix_val=new FieldInt("mes_width_fix_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width_min_val=new FieldInt("mes_width_min_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width_max_val=new FieldInt("mes_width_max_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width_def_val=new FieldInt("mes_width_def_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width_seq=new FieldBool("mes_width_seq",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width_vals=new FieldText("mes_width_vals",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height_exists=new FieldBool("mes_height_exists",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height_name=new FieldString("mes_height_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height_fix=new FieldBool("mes_height_fix",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height_fix_val=new FieldInt("mes_height_fix_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height_min_val=new FieldInt("mes_height_min_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height_max_val=new FieldInt("mes_height_max_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height_def_val=new FieldInt("mes_height_def_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height_seq=new FieldBool("mes_height_seq",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height_vals=new FieldText("mes_height_vals",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.base_measure_unit_id=new FieldInt("base_measure_unit_id",filed_options);options.fields.base_measure_unit_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.order_measure_unit_id=new FieldInt("order_measure_unit_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.base_measure_unit_vol_m=new FieldFloat("base_measure_unit_vol_m",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.base_measure_unit_weight_t=new FieldFloat("base_measure_unit_weight_t",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_name=new FieldString("pack_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_default=new FieldBool("pack_default",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_not_free=new FieldBool("pack_not_free",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_full_package_only=new FieldBool("pack_full_package_only",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.extra_pay_for_abnormal_size=new FieldBool("extra_pay_for_abnormal_size",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.extra_pay_for_abn_size_always=new FieldBool("extra_pay_for_abn_size_always",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.extra_pay_calc_formula=new FieldText("extra_pay_calc_formula",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouses_str=new FieldText("warehouses_str",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.lot_id=new FieldString("lot_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.lot_volume=new FieldString("lot_volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sert_type_id=new FieldInt("sert_type_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name_for_1c=new FieldString("name_for_1c",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_group_id=new FieldInt("product_group_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.fin_group=new FieldText("fin_group",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.analit_group=new FieldText("analit_group",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.deleted=new FieldBool("deleted",filed_options);Product_Model.superclass.constructor.call(this,id,options);}
extend(Product_Model,Model); 
function ProductList_Model(options){var id='ProductList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deleted=new FieldBool("deleted",filed_options);ProductList_Model.superclass.constructor.call(this,id,options);}
extend(ProductList_Model,Model); 
function ProductFilterList_Model(options){var id='ProductFilterList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);ProductFilterList_Model.superclass.constructor.call(this,id,options);}
extend(ProductFilterList_Model,Model); 
function ProductDialog_Model(options){var id='ProductDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);ProductDialog_Model.superclass.constructor.call(this,id,options);}
extend(ProductDialog_Model,Model); 
function ProductCustomSizePrice_Model(options){var id='ProductCustomSizePrice_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.category=new FieldInt("category",filed_options);options.fields.category.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price=new FieldFloat("price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant=new FieldFloat("quant",filed_options);ProductCustomSizePrice_Model.superclass.constructor.call(this,id,options);}
extend(ProductCustomSizePrice_Model,Model); 
function ProductMeasureUnit_Model(options){var id='ProductMeasureUnit_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.measure_unit_id=new FieldInt("measure_unit_id",filed_options);options.fields.measure_unit_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.calc_formula=new FieldText("calc_formula",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.in_use=new FieldBool("in_use",filed_options);ProductMeasureUnit_Model.superclass.constructor.call(this,id,options);}
extend(ProductMeasureUnit_Model,Model); 
function ProductMeasureUnitList_Model(options){var id='ProductMeasureUnitList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_descr=new FieldString("product_descr",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.measure_unit_id=new FieldInt("measure_unit_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.measure_unit_descr=new FieldString("measure_unit_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.calc_formula=new FieldText("calc_formula",filed_options);ProductMeasureUnitList_Model.superclass.constructor.call(this,id,options);}
extend(ProductMeasureUnitList_Model,Model); 
function ProductWarehouse_Model(options){var id='ProductWarehouse_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);options.fields.warehouse_id.setRequired(true);ProductWarehouse_Model.superclass.constructor.call(this,id,options);}
extend(ProductWarehouse_Model,Model); 
function ProductWarehouseList_Model(options){var id='ProductWarehouseList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);options.fields.warehouse_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_descr=new FieldString("warehouse_descr",filed_options);ProductWarehouseList_Model.superclass.constructor.call(this,id,options);}
extend(ProductWarehouseList_Model,Model); 
function DOCOrder_Model(options){var id='DOCOrder_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата пдч.';filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Номер';filed_options.autoInc=false;options.fields.number=new FieldString("number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Проведен';filed_options.autoInc=false;options.fields.processed=new FieldBool("processed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.gruzopoluchatel_id=new FieldInt("gruzopoluchatel_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_number=new FieldString("client_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_plan_date=new FieldDate("delivery_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_fact_date=new FieldDateTime("delivery_fact_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_plan_date=new FieldDate("product_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_user_id=new FieldInt("client_user_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.user_id=new FieldInt("user_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sales_manager_comment=new FieldText("sales_manager_comment",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_comment=new FieldText("client_comment",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.marketing_comment=new FieldText("marketing_comment",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_destination_id=new FieldInt("deliv_destination_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_type=new FieldEnum("deliv_type",filed_options);filed_options.enumValues='by_supplier,by_client';options.fields.deliv_type.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_to_third_party=new FieldBool("deliv_to_third_party",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_send_sms=new FieldBool("deliv_send_sms",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_add_cost_to_product=new FieldBool("deliv_add_cost_to_product",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_period_id=new FieldInt("deliv_period_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_responsable=new FieldString("deliv_responsable",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_responsable_tel=new FieldString("deliv_responsable_tel",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tel=new FieldString("tel",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_vehicle_id=new FieldInt("deliv_vehicle_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_cost_opt_id=new FieldInt("deliv_cost_opt_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_vehicle_count=new FieldInt("deliv_vehicle_count",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_total=new FieldFloat("deliv_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_total_edit=new FieldBool("deliv_total_edit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.total_pack=new FieldFloat("total_pack",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_quant=new FieldFloat("total_quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_volume=new FieldFloat("total_volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_weight=new FieldFloat("total_weight",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.printed=new FieldBool("printed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_order_num=new FieldString("ext_order_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_order_id=new FieldString("ext_order_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_ship_num=new FieldString("ext_ship_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_ship_id=new FieldString("ext_ship_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_invoice_num=new FieldString("ext_invoice_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_invoice_id=new FieldString("ext_invoice_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_invoice_date_time=new FieldDateTime("ext_invoice_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cust_surv_date_time=new FieldDateTime("cust_surv_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cust_surv_comment=new FieldText("cust_surv_comment",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_str=new FieldText("product_str",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_ids=new FieldInt("product_ids",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.submit_user_id=new FieldInt("submit_user_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.paid=new FieldBool("paid",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.paid_by_bank=new FieldBool("paid_by_bank",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.acc_pko=new FieldBool("acc_pko",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.city_route_distance=new FieldInt("city_route_distance",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.country_route_distance=new FieldInt("country_route_distance",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.destination_to_ttn=new FieldBool("destination_to_ttn",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_expenses=new FieldFloat("deliv_expenses",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_expenses_edit=new FieldBool("deliv_expenses_edit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_pay_bank=new FieldBool("deliv_pay_bank",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.driver_id=new FieldInt("driver_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.vehicle_id=new FieldInt("vehicle_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_contract_ext_id=new FieldString("client_contract_ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_contract_name=new FieldString("client_contract_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Адрес магазина';filed_options.autoInc=false;options.fields.sale_store_address_id=new FieldInt("sale_store_address_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Номер заказа';filed_options.autoInc=false;options.fields.order_num=new FieldText("order_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Номер партии';filed_options.autoInc=false;options.fields.batch_num=new FieldText("batch_num",filed_options);DOCOrder_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrder_Model,Model); 
function DOCOrderLink_Model(options){var id='DOCOrderLink_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.main_doc_id=new FieldInt("main_doc_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.child_doc_id=new FieldInt("child_doc_id",filed_options);DOCOrderLink_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderLink_Model,Model); 
function DOCOrderState_Model(options){var id='DOCOrderState_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_orders_id=new FieldInt("doc_orders_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state=new FieldEnum("state",filed_options);filed_options.enumValues='new,waiting_for_us,waiting_for_client,waiting_for_payment,producing,produced,shipped,loading,on_way,unloading,closed,canceled,canceled_by_sales_manager,canceled_by_client';var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.user_id=new FieldInt("user_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tracker_id=new FieldString("tracker_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_zone=new FieldGeometry("client_zone",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.production_zone=new FieldGeometry("production_zone",filed_options);DOCOrderState_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderState_Model,Model); 
function DOCOrderHeadHistory_Model(options){var id='DOCOrderHeadHistory_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_orders_states_id=new FieldInt("doc_orders_states_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.field=new FieldText("field",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.old_val=new FieldText("old_val",filed_options);DOCOrderHeadHistory_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderHeadHistory_Model,Model); 
function DOCOrderProductHistory_Model(options){var id='DOCOrderProductHistory_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_orders_states_id=new FieldInt("doc_orders_states_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.fields=new FieldText("fields",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.oper=new FieldString("oper",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.old_vals=new FieldText("old_vals",filed_options);DOCOrderProductHistory_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderProductHistory_Model,Model); 
function DOCOrderProdPassport_Model(options){var id='DOCOrderProdPassport_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_order_id=new FieldInt("doc_order_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.content=new FieldText("content",filed_options);DOCOrderProdPassport_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderProdPassport_Model,Model); 
function DOCOrderNewList_Model(options){var id='DOCOrderNewList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.number=new FieldString("number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time_descr=new FieldString("date_time_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_plan_date=new FieldDateTime("delivery_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_plan_date_descr=new FieldString("delivery_plan_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_plan_date=new FieldDateTime("product_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_plan_date_descr=new FieldString("product_plan_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.address_descr=new FieldString("address_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_descr=new FieldString("warehouse_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.products_descr=new FieldString("products_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_ids=new FieldString("product_ids",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_descr=new FieldString("total_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_quant=new FieldFloat("total_quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state=new FieldString("state",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state_descr=new FieldString("state_descr",filed_options);DOCOrderNewList_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderNewList_Model,Model); 
function DOCOrderCurrentList_Model(options){var id='DOCOrderCurrentList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.number=new FieldString("number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time_descr=new FieldString("date_time_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_plan_date=new FieldDateTime("product_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_plan_date_descr=new FieldString("product_plan_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.address_descr=new FieldString("address_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_descr=new FieldString("warehouse_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.products_descr=new FieldString("products_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_ids=new FieldInt("product_ids",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_descr=new FieldString("total_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_quant=new FieldFloat("total_quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state=new FieldString("state",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state_descr=new FieldString("state_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_order_num=new FieldString("ext_order_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_ship_num=new FieldString("ext_ship_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_fact_date=new FieldDateTime("delivery_fact_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_fact_date_descr=new FieldString("delivery_fact_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_plan_date=new FieldDateTime("delivery_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_plan_date_descr=new FieldString("delivery_plan_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_number=new FieldString("client_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.printed=new FieldString("printed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cust_surv_date_time=new FieldString("cust_surv_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cust_surv_date_time_descr=new FieldString("cust_surv_date_time_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_volume=new FieldString("total_volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.is_current=new FieldBool("is_current",filed_options);DOCOrderCurrentList_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderCurrentList_Model,Model); 
function DOCOrderCurrentForClientList_Model(options){var id='DOCOrderCurrentForClientList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.number=new FieldString("number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time_descr=new FieldString("date_time_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_plan_date=new FieldDateTime("product_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_plan_date_descr=new FieldString("product_plan_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.address_descr=new FieldString("address_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_descr=new FieldString("warehouse_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.products_descr=new FieldString("products_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_ids=new FieldString("product_ids",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_descr=new FieldString("total_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_quant=new FieldFloat("total_quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_volume=new FieldFloat("total_volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state=new FieldString("state",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state_descr=new FieldString("state_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_ship_num=new FieldString("ext_ship_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_fact_date=new FieldDateTime("delivery_fact_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_fact_date_descr=new FieldString("delivery_fact_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_number=new FieldString("client_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.printed=new FieldString("printed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.customer_survey_date=new FieldString("customer_survey_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.customer_survey_date_descr=new FieldString("customer_survey_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.is_current=new FieldBool("is_current",filed_options);DOCOrderCurrentForClientList_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderCurrentForClientList_Model,Model); 
function DOCOrderCurrentForProductionList_Model(options){var id='DOCOrderCurrentForProductionList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.number=new FieldString("number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time_descr=new FieldString("date_time_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_plan_date=new FieldDateTime("delivery_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_plan_date_descr=new FieldString("delivery_plan_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.address_descr=new FieldString("address_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_descr=new FieldString("warehouse_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.products_descr=new FieldString("products_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_ids=new FieldString("product_ids",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_descr=new FieldString("total_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_quant=new FieldFloat("total_quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state=new FieldString("state",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state_descr=new FieldString("state_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_ship_num=new FieldString("ext_ship_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_fact_date=new FieldDateTime("delivery_fact_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_fact_date_descr=new FieldString("delivery_fact_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_number=new FieldString("client_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.printed=new FieldString("printed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cust_surv_date_time=new FieldString("cust_surv_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cust_surv_date_time=new FieldString("cust_surv_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.is_current=new FieldBool("is_current",filed_options);DOCOrderCurrentForProductionList_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderCurrentForProductionList_Model,Model); 
function DOCOrderClosedList_Model(options){var id='DOCOrderClosedList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.number=new FieldString("number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time_descr=new FieldString("date_time_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_plan_date=new FieldDateTime("product_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_plan_date_descr=new FieldString("product_plan_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.address_descr=new FieldString("address_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_descr=new FieldString("warehouse_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_fact_date=new FieldDateTime("delivery_fact_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_ship_num=new FieldString("ext_ship_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.products_descr=new FieldString("products_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_ids=new FieldString("product_ids",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_descr=new FieldString("total_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_quant=new FieldFloat("total_quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state=new FieldString("state",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state_descr=new FieldString("state_descr",filed_options);DOCOrderClosedList_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderClosedList_Model,Model); 
function DOCOrderDialog_Model(options){var id='DOCOrderDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.def_debt=new FieldFloat("def_debt",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.debt_total=new FieldFloat("debt_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.vehicle_id=new FieldInt("vehicle_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.vehicle_descr=new FieldString("vehicle_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.attachments=new FieldJSONB("attachments",filed_options);DOCOrderDialog_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDialog_Model,Model); 
function DOCOrderDivisDialog_Model(options){var id='DOCOrderDivisDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.main_doc_id=new FieldInt("main_doc_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_plan_date=new FieldDate("delivery_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sales_manager_comment=new FieldText("sales_manager_comment",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_period_id=new FieldInt("deliv_period_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_vehicle_count=new FieldInt("deliv_vehicle_count",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_cost_opt_id=new FieldInt("deliv_cost_opt_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state=new FieldString("state",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_total=new FieldString("deliv_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_total_edit=new FieldString("deliv_total_edit",filed_options);DOCOrderDivisDialog_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDivisDialog_Model,Model); 
function DOCOrderCustSurveyDialog_Model(options){var id='DOCOrderCustSurveyDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);DOCOrderCustSurveyDialog_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderCustSurveyDialog_Model,Model); 
function DOCOrderShipmentDialog_Model(options){var id='DOCOrderShipmentDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);DOCOrderShipmentDialog_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderShipmentDialog_Model,Model); 
function ClientPriceList_Model(options){var id='ClientPriceList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.production_city_id=new FieldInt("production_city_id",filed_options);options.fields.production_city_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.to_third_party_only=new FieldBool("to_third_party_only",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.part_ship_do_not_change_price=new FieldBool("part_ship_do_not_change_price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.min_order_quant=new FieldFloat("min_order_quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.default_price_list=new FieldBool("default_price_list",filed_options);ClientPriceList_Model.superclass.constructor.call(this,id,options);}
extend(ClientPriceList_Model,Model); 
function ClientPriceListList_Model(options){var id='ClientPriceListList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);ClientPriceListList_Model.superclass.constructor.call(this,id,options);}
extend(ClientPriceListList_Model,Model); 
function ClientPriceListDialog_Model(options){var id='ClientPriceListDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);ClientPriceListDialog_Model.superclass.constructor.call(this,id,options);}
extend(ClientPriceListDialog_Model,Model); 
function ClientPriceListProduct_Model(options){var id='ClientPriceListProduct_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.price_list_id=new FieldInt("price_list_id",filed_options);options.fields.price_list_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price=new FieldFloat("price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.discount_volume=new FieldFloat("discount_volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.discount_total=new FieldFloat("discount_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_price=new FieldFloat("pack_price",filed_options);ClientPriceListProduct_Model.superclass.constructor.call(this,id,options);}
extend(ClientPriceListProduct_Model,Model); 
function ClientPriceListClient_Model(options){var id='ClientPriceListClient_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_list_id=new FieldInt("price_list_id",filed_options);options.fields.price_list_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);options.fields.client_id.setRequired(true);ClientPriceListClient_Model.superclass.constructor.call(this,id,options);}
extend(ClientPriceListClient_Model,Model); 
function ClientPriceListClientList_Model(options){var id='ClientPriceListClientList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_list_id=new FieldInt("price_list_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);options.fields.client_id.setRequired(true);ClientPriceListClientList_Model.superclass.constructor.call(this,id,options);}
extend(ClientPriceListClientList_Model,Model); 
function ClientPriceListClientSelect_Model(options){var id='ClientPriceListClientSelect_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);options.fields.client_id.setRequired(true);ClientPriceListClientSelect_Model.superclass.constructor.call(this,id,options);}
extend(ClientPriceListClientSelect_Model,Model); 
function DOCOrderDOCTProduct_Model(options){var id='DOCOrderDOCTProduct_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.login_id=new FieldInt("login_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Продукция';filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length=new FieldInt("mes_length",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width=new FieldInt("mes_width",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height=new FieldInt("mes_height",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.measure_unit_id=new FieldInt("measure_unit_id",filed_options);options.fields.measure_unit_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant=new FieldFloat("quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant_confirmed=new FieldFloat("quant_confirmed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant_base_measure_unit=new FieldFloat("quant_base_measure_unit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant_confirmed_base_measure_unit=new FieldFloat("quant_confirmed_base_measure_unit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.volume=new FieldFloat("volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.weight=new FieldFloat("weight",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Цена';filed_options.autoInc=false;options.fields.price=new FieldFloat("price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_edit=new FieldBool("price_edit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_round=new FieldBool("price_round",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total_pack=new FieldFloat("total_pack",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_exists=new FieldBool("pack_exists",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_in_price=new FieldBool("pack_in_price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_deliv=new FieldFloat("total_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.total_no_deliv=new FieldFloat("total_no_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.price_no_deliv=new FieldFloat("price_no_deliv",filed_options);DOCOrderDOCTProduct_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProduct_Model,Model); 
function DOCOrderDOCTProductList_Model(options){var id='DOCOrderDOCTProductList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_no_deliv=new FieldFloat("total_no_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_no_deliv=new FieldFloat("price_no_deliv",filed_options);DOCOrderDOCTProductList_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProductList_Model,Model); 
function DOCOrderDOCTProductDialog_Model(options){var id='DOCOrderDOCTProductDialog_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);DOCOrderDOCTProductDialog_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProductDialog_Model,Model); 
function DOCOrderDOCTFProduct_Model(options){var id='DOCOrderDOCTFProduct_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_id=new FieldInt("doc_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Продукция';filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length=new FieldInt("mes_length",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width=new FieldInt("mes_width",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height=new FieldInt("mes_height",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.measure_unit_id=new FieldInt("measure_unit_id",filed_options);options.fields.measure_unit_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant=new FieldFloat("quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant_confirmed=new FieldFloat("quant_confirmed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant_base_measure_unit=new FieldFloat("quant_base_measure_unit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant_confirmed_base_measure_unit=new FieldFloat("quant_confirmed_base_measure_unit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.volume=new FieldFloat("volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.weight=new FieldFloat("weight",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Цена';filed_options.autoInc=false;options.fields.price=new FieldFloat("price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Цена без доставки';filed_options.autoInc=false;options.fields.price_no_deliv=new FieldFloat("price_no_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_edit=new FieldBool("price_edit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_round=new FieldBool("price_round",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Упаковка';filed_options.autoInc=false;options.fields.total_pack=new FieldFloat("total_pack",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_exists=new FieldBool("pack_exists",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_in_price=new FieldBool("pack_in_price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_deliv=new FieldFloat("total_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.total_no_deliv=new FieldFloat("total_no_deliv",filed_options);DOCOrderDOCTFProduct_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTFProduct_Model,Model); 
function DOCOrderDOCTCustSurvey_Model(options){var id='DOCOrderDOCTCustSurvey_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.login_id=new FieldInt("login_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.customer_survey_question_id=new FieldInt("customer_survey_question_id",filed_options);options.fields.customer_survey_question_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.points=new FieldInt("points",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.answer_comment=new FieldText("answer_comment",filed_options);DOCOrderDOCTCustSurvey_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTCustSurvey_Model,Model); 
function DOCOrderDOCTCustSurveyList_Model(options){var id='DOCOrderDOCTCustSurveyList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);DOCOrderDOCTCustSurveyList_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTCustSurveyList_Model,Model); 
function DOCOrderDOCTFCustSurvey_Model(options){var id='DOCOrderDOCTFCustSurvey_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_id=new FieldInt("doc_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.customer_survey_question_id=new FieldInt("customer_survey_question_id",filed_options);options.fields.customer_survey_question_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.points=new FieldInt("points",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.answer_comment=new FieldText("answer_comment",filed_options);DOCOrderDOCTFCustSurvey_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTFCustSurvey_Model,Model); 
function OrderChange_Model(options){var id='OrderChange_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_order_id=new FieldInt("doc_order_id",filed_options);options.fields.doc_order_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.field=new FieldString("field",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.old_value=new FieldText("old_value",filed_options);OrderChange_Model.superclass.constructor.call(this,id,options);}
extend(OrderChange_Model,Model); 
function CustomerSurveyQuestion_Model(options){var id='CustomerSurveyQuestion_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.question=new FieldText("question",filed_options);options.fields.question.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.max_points=new FieldInt("max_points",filed_options);options.fields.max_points.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.in_use=new FieldBool("in_use",filed_options);CustomerSurveyQuestion_Model.superclass.constructor.call(this,id,options);}
extend(CustomerSurveyQuestion_Model,Model); 
function ProductionState_Model(options){var id='ProductionState_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ord=new FieldInt("ord",filed_options);options.fields.ord.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);ProductionState_Model.superclass.constructor.call(this,id,options);}
extend(ProductionState_Model,Model); 
function DeliveryHour_Model(options){var id='DeliveryHour_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.h_from=new FieldInt("h_from",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.h_to=new FieldInt("h_to",filed_options);DeliveryHour_Model.superclass.constructor.call(this,id,options);}
extend(DeliveryHour_Model,Model); 
function DeliveryVehicle_Model(options){var id='DeliveryVehicle_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.deliv_date=new FieldDate("deliv_date",filed_options);options.fields.deliv_date.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.vehicle_id=new FieldInt("vehicle_id",filed_options);options.fields.vehicle_id.setRequired(true);DeliveryVehicle_Model.superclass.constructor.call(this,id,options);}
extend(DeliveryVehicle_Model,Model); 
function Delivery_Model(options){var id='Delivery_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.vehicle_id=new FieldInt("vehicle_id",filed_options);options.fields.vehicle_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_order_id=new FieldInt("doc_order_id",filed_options);options.fields.doc_order_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_hour_id=new FieldInt("delivery_hour_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.closed=new FieldBool("closed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_date=new FieldDate("deliv_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.added_date_time=new FieldDateTime("added_date_time",filed_options);Delivery_Model.superclass.constructor.call(this,id,options);}
extend(Delivery_Model,Model); 
function DeliveryExtraVehicle_Model(options){var id='DeliveryExtraVehicle_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.vehicle_id=new FieldInt("vehicle_id",filed_options);options.fields.vehicle_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.date=new FieldDate("date",filed_options);options.fields.date.setRequired(true);DeliveryExtraVehicle_Model.superclass.constructor.call(this,id,options);}
extend(DeliveryExtraVehicle_Model,Model); 
function DeliveryDeletedVehicle_Model(options){var id='DeliveryDeletedVehicle_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.vehicle_id=new FieldInt("vehicle_id",filed_options);options.fields.vehicle_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.date=new FieldDate("date",filed_options);options.fields.date.setRequired(true);DeliveryDeletedVehicle_Model.superclass.constructor.call(this,id,options);}
extend(DeliveryDeletedVehicle_Model,Model); 
function VehicleState_Model(options){var id='VehicleState_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.vehicle_id=new FieldInt("vehicle_id",filed_options);options.fields.vehicle_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);options.fields.date_time.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.state=new FieldEnum("state",filed_options);filed_options.enumValues='at_base,at_load,to_base,at_client,to_client,free';var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tracker=new FieldString("tracker",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.to_client_zone=new FieldGeometry("to_client_zone",filed_options);VehicleState_Model.superclass.constructor.call(this,id,options);}
extend(VehicleState_Model,Model); 
function MailForSending_Model(options){var id='MailForSending_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.from_addr=new FieldString("from_addr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.from_name=new FieldString("from_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.to_addr=new FieldString("to_addr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.to_name=new FieldString("to_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.reply_addr=new FieldString("reply_addr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.reply_name=new FieldString("reply_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.body=new FieldText("body",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sender_addr=new FieldString("sender_addr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.subject=new FieldString("subject",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.sent=new FieldBool("sent",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sent_date_time=new FieldDateTime("sent_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.email_type=new FieldEnum("email_type",filed_options);filed_options.enumValues='new_account,reset_pwd,order,order_changed,order_wait_for_client,order_cancel,order_remind,shipment,balance_to_client,order_on_produced';var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.send_error=new FieldText("send_error",filed_options);MailForSending_Model.superclass.constructor.call(this,id,options);}
extend(MailForSending_Model,Model); 
function MailForSendingList_Model(options){var id='MailForSendingList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.from_addr=new FieldString("from_addr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.from_name=new FieldString("from_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.to_addr=new FieldString("to_addr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.to_name=new FieldString("to_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.reply_addr=new FieldString("reply_addr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.reply_name=new FieldString("reply_name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.body=new FieldText("body",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sender_addr=new FieldString("sender_addr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.subject=new FieldString("subject",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.sent=new FieldBool("sent",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sent_date_time=new FieldDateTime("sent_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.send_error=new FieldText("send_error",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.email_type=new FieldEnum("email_type",filed_options);filed_options.enumValues='new_account,reset_pwd,order,order_changed,order_wait_for_client,order_cancel,order_remind,shipment,balance_to_client,order_on_produced';MailForSendingList_Model.superclass.constructor.call(this,id,options);}
extend(MailForSendingList_Model,Model); 
function MailForSendingAttachment_Model(options){var id='MailForSendingAttachment_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mail_for_sending_id=new FieldInt("mail_for_sending_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.file_name=new FieldString("file_name",filed_options);MailForSendingAttachment_Model.superclass.constructor.call(this,id,options);}
extend(MailForSendingAttachment_Model,Model); 
function SMSForSending_Model(options){var id='SMSForSending_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tel=new FieldString("tel",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.body=new FieldText("body",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.sent=new FieldBool("sent",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sent_date_time=new FieldDateTime("sent_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.delivered=new FieldBool("delivered",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivered_date_time=new FieldDateTime("delivered_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sms_type=new FieldEnum("sms_type",filed_options);filed_options.enumValues='client_on_deliv,client_remind,client_deliv_remind,client_change_time,client_on_produced,client_on_leave_prod,driver_first_deliv,driver_new_deliv';var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sms_id=new FieldText("sms_id",filed_options);SMSForSending_Model.superclass.constructor.call(this,id,options);}
extend(SMSForSending_Model,Model); 
function SMSForSendingList_Model(options){var id='SMSForSendingList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tel=new FieldString("tel",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.body=new FieldText("body",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.sent=new FieldBool("sent",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sent_date_time=new FieldDateTime("sent_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.delivered=new FieldBool("delivered",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivered_date_time=new FieldDateTime("delivered_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sms_type=new FieldEnum("sms_type",filed_options);filed_options.enumValues='client_on_deliv,client_remind,client_deliv_remind,client_change_time,client_on_produced,client_on_leave_prod,driver_first_deliv,driver_new_deliv';var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sms_id=new FieldText("sms_id",filed_options);SMSForSendingList_Model.superclass.constructor.call(this,id,options);}
extend(SMSForSendingList_Model,Model); 
function RepProductionLoad_Model(options){var id='RepProductionLoad_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата отгрузки';filed_options.autoInc=false;options.fields.delivery_plan_date=new FieldDate("delivery_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата отгрузки';filed_options.autoInc=false;options.fields.delivery_plan_date_descr=new FieldString("delivery_plan_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Продукция';filed_options.autoInc=false;options.fields.product_descr=new FieldString("product_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant=new FieldFloat("quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);RepProductionLoad_Model.superclass.constructor.call(this,id,options);}
extend(RepProductionLoad_Model,Model); 
function RepSale_Model(options){var id='RepSale_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.alias='Код заказа';filed_options.autoInc=false;options.fields.doc_id=new FieldInt("doc_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата подачи';filed_options.autoInc=false;options.fields.doc_date_time=new FieldDateTime("doc_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата отгрузки';filed_options.autoInc=false;options.fields.doc_delivery_fact_date=new FieldDateTime("doc_delivery_fact_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_order_delivered=new FieldBool("doc_order_delivered",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_client_id=new FieldInt("doc_client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Заказчик';filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_login_allowed=new FieldBool("client_login_allowed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_activity_descr=new FieldString("client_activity_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_pay_type=new FieldString("client_pay_type",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_pay_debt_days=new FieldString("client_pay_debt_days",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_pay_ban_on_debt_days=new FieldString("client_pay_ban_on_debt_days",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_pay_debt_sum=new FieldString("client_pay_debt_sum",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_debt_period_days_descr=new FieldString("client_debt_period_days_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_debt_days=new FieldString("client_debt_days",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_debt_total=new FieldString("client_debt_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_contracts_exist=new FieldBool("client_contracts_exist",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_contract_end=new FieldString("client_contract_end",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Номер заказа';filed_options.autoInc=false;options.fields.doc_number=new FieldString("doc_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Фирма';filed_options.autoInc=false;options.fields.firm_descr=new FieldString("firm_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Последний статус';filed_options.autoInc=false;options.fields.doc_last_state=new FieldString("doc_last_state",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Город отгрузки';filed_options.autoInc=false;options.fields.production_city_descr=new FieldString("production_city_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_delivery_plan_date=new FieldString("doc_delivery_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_in_time=new FieldBool("doc_in_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_user_id=new FieldString("doc_user_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Пользователь';filed_options.autoInc=false;options.fields.doc_user_descr=new FieldString("doc_user_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_overlimit=new FieldBool("doc_overlimit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_delivery_type_descr=new FieldString("doc_delivery_type_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_deliv_to_third_party=new FieldBool("doc_deliv_to_third_party",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_deliv_destination_descr=new FieldString("doc_deliv_destination_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_deliv_period=new FieldString("doc_deliv_period",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_warehouse_id=new FieldString("doc_warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_warehouse_descr=new FieldString("doc_warehouse_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_driver_id=new FieldString("doc_driver_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_driver_descr=new FieldString("doc_driver_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_vehicle_id=new FieldString("doc_vehicle_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_vehicle_descr=new FieldString("doc_vehicle_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_ext_order_num=new FieldString("doc_ext_order_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_ext_ship_num=new FieldString("doc_ext_ship_num",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_state=new FieldString("doc_state",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_state_id=new FieldString("doc_state_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_state_date_time=new FieldString("doc_state_date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_state_user=new FieldString("doc_state_user",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_sales_manager_comment=new FieldString("doc_sales_manager_comment",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_client_comment=new FieldString("doc_client_comment",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_customer_survey_question=new FieldString("doc_customer_survey_question",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Стоимость доставки';filed_options.autoInc=false;options.fields.doc_deliv_total=new FieldString("doc_deliv_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doct_product_descr=new FieldString("doct_product_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doct_product_mes=new FieldString("doct_product_mes",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doct_product_mes_length=new FieldString("doct_product_mes_length",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doct_product_mes_width=new FieldString("doct_product_mes_width",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doct_product_mes_height=new FieldString("doct_product_mes_height",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doct_base_measure_id=new FieldString("doct_base_measure_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doct_base_measure_descr=new FieldString("doct_base_measure_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doct_pack_exists=new FieldBool("doct_pack_exists",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Киллометраж доставки город';filed_options.autoInc=false;options.fields.doc_city_route_distance=new FieldString("doc_city_route_distance",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Киллометраж доставки межгород';filed_options.autoInc=false;options.fields.doc_country_route_distance=new FieldString("doc_country_route_distance",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество согласований';filed_options.autoInc=false;options.fields.doc_coord_count=new FieldInt("doc_coord_count",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Время согласования ОП';filed_options.autoInc=false;options.fields.doc_coord_time_sale_dep=new FieldString("doc_coord_time_sale_dep",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Время согласования ОП';filed_options.autoInc=false;options.fields.doc_coord_time_client=new FieldString("doc_coord_time_client",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Кол-во в базовых единицах';filed_options.autoInc=false;options.fields.doct_quant=new FieldString("doct_quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Масса';filed_options.autoInc=false;options.fields.doct_weight=new FieldString("doct_weight",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Объем';filed_options.autoInc=false;options.fields.doct_volume=new FieldString("doct_volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Стоимость продукции';filed_options.autoInc=false;options.fields.doct_total=new FieldString("doct_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Просроченная дебиторская задолженность (дни)';filed_options.autoInc=false;options.fields.client_debt_days=new FieldString("client_debt_days",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Просроченная дебиторская задолженность (стоимость)';filed_options.autoInc=false;options.fields.client_debt_total=new FieldString("client_debt_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Баллы опроса';filed_options.autoInc=false;options.fields.doc_customer_survey_points=new FieldString("doc_customer_survey_points",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Затраты на доставку';filed_options.autoInc=false;options.fields.doc_deliv_expenses=new FieldString("doc_deliv_expenses",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doct_extra_price_category=new FieldInt("doct_extra_price_category",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sys_level_val=new FieldString("sys_level_val",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sys_level_count=new FieldString("sys_level_count",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sys_level_col_count=new FieldString("sys_level_col_count",filed_options);RepSale_Model.superclass.constructor.call(this,id,options);}
extend(RepSale_Model,Model); 
function RepPriceListTuning_Model(options){var id='RepPriceListTuning_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.alias='Код клиента';filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Наименование клиента';filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Код города';filed_options.autoInc=false;options.fields.production_city_id=new FieldInt("production_city_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Наименование города';filed_options.autoInc=false;options.fields.production_city_descr=new FieldString("production_city_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Для третьих лиц';filed_options.autoInc=false;options.fields.to_third_party_only=new FieldBool("to_third_party_only",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Наименование прайса';filed_options.autoInc=false;options.fields.price_list_descr=new FieldString("price_list_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Наименование продукции';filed_options.autoInc=false;options.fields.product_descr=new FieldString("product_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Цена';filed_options.autoInc=false;options.fields.product_descr=new FieldFloat("product_descr",filed_options);RepPriceListTuning_Model.superclass.constructor.call(this,id,options);}
extend(RepPriceListTuning_Model,Model); 
function PayOrderList_Model(options){var id='PayOrderList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.alias='Код заявки';filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Клиент код';filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Номер заявки';filed_options.autoInc=false;options.fields.number=new FieldString("number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата заявки';filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата заявки';filed_options.autoInc=false;options.fields.date_time_descr=new FieldString("date_time_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total_descr=new FieldString("total_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Организация код';filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Организация';filed_options.autoInc=false;options.fields.firm_descr=new FieldString("firm_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Статус код';filed_options.autoInc=false;options.fields.state=new FieldString("state",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Статус';filed_options.autoInc=false;options.fields.state_descr=new FieldString("state_descr",filed_options);PayOrderList_Model.superclass.constructor.call(this,id,options);}
extend(PayOrderList_Model,Model); 
function ClientDebtPeriod_Model(options){var id='ClientDebtPeriod_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.days_from=new FieldInt("days_from",filed_options);options.fields.days_from.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.days_to=new FieldInt("days_to",filed_options);options.fields.days_to.setRequired(true);ClientDebtPeriod_Model.superclass.constructor.call(this,id,options);}
extend(ClientDebtPeriod_Model,Model); 
function ClientDebtPeriodList_Model(options){var id='ClientDebtPeriodList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.days_from=new FieldInt("days_from",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.days_to=new FieldInt("days_to",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.days_descr=new FieldString("days_descr",filed_options);ClientDebtPeriodList_Model.superclass.constructor.call(this,id,options);}
extend(ClientDebtPeriodList_Model,Model); 
function ReportVariant_Model(options){var id='ReportVariant_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.user_id=new FieldInt("user_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.report_type=new FieldEnum("report_type",filed_options);filed_options.enumValues='sales';options.fields.report_type.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldText("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.data=new FieldText("data",filed_options);ReportVariant_Model.superclass.constructor.call(this,id,options);}
extend(ReportVariant_Model,Model); 
function ReportVariantList_Model(options){var id='ReportVariantList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldText("name",filed_options);ReportVariantList_Model.superclass.constructor.call(this,id,options);}
extend(ReportVariantList_Model,Model); 
function DOCOrderCancelCause_Model(options){var id='DOCOrderCancelCause_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_id=new FieldInt("doc_id",filed_options);options.fields.doc_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cause=new FieldText("cause",filed_options);options.fields.cause.setRequired(true);DOCOrderCancelCause_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderCancelCause_Model,Model); 
function SMSTemplate_Model(options){var id='SMSTemplate_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Тип SMS';filed_options.autoInc=false;options.fields.sms_type=new FieldEnum("sms_type",filed_options);filed_options.enumValues='client_on_deliv,client_remind,client_deliv_remind,client_change_time,client_on_produced,client_on_leave_prod,driver_first_deliv,driver_new_deliv';options.fields.sms_type.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Шаблон';filed_options.autoInc=false;options.fields.template=new FieldText("template",filed_options);options.fields.template.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Комментарий';filed_options.autoInc=false;options.fields.comment_text=new FieldText("comment_text",filed_options);options.fields.comment_text.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Поля';filed_options.autoInc=false;options.fields.fields=new FieldText("fields",filed_options);options.fields.fields.setRequired(true);SMSTemplate_Model.superclass.constructor.call(this,id,options);}
extend(SMSTemplate_Model,Model); 
function SMSTemplateList_Model(options){var id='SMSTemplateList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sms_type=new FieldString("sms_type",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.sms_type_descr=new FieldString("sms_type_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.template=new FieldText("template",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.fields=new FieldText("fields",filed_options);SMSTemplateList_Model.superclass.constructor.call(this,id,options);}
extend(SMSTemplateList_Model,Model); 
function EmailTemplate_Model(options){var id='EmailTemplate_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Тип email';filed_options.autoInc=false;options.fields.email_type=new FieldEnum("email_type",filed_options);filed_options.enumValues='new_account,reset_pwd,order,order_changed,order_wait_for_client,order_cancel,order_remind,shipment,balance_to_client,order_on_produced';options.fields.email_type.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Шаблон';filed_options.autoInc=false;options.fields.template=new FieldText("template",filed_options);options.fields.template.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Комментарий';filed_options.autoInc=false;options.fields.comment_text=new FieldText("comment_text",filed_options);options.fields.comment_text.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Тема';filed_options.autoInc=false;options.fields.mes_subject=new FieldText("mes_subject",filed_options);options.fields.mes_subject.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Поля';filed_options.autoInc=false;options.fields.fields=new FieldText("fields",filed_options);options.fields.fields.setRequired(true);EmailTemplate_Model.superclass.constructor.call(this,id,options);}
extend(EmailTemplate_Model,Model); 
function EmailTemplateList_Model(options){var id='EmailTemplateList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.email_type=new FieldString("email_type",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.email_type_descr=new FieldString("email_type_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.template=new FieldText("template",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.fields=new FieldText("fields",filed_options);EmailTemplateList_Model.superclass.constructor.call(this,id,options);}
extend(EmailTemplateList_Model,Model); 
function DelivDistanceCache_Model(options){var id='DelivDistanceCache_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);options.fields.warehouse_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.client_destination_id=new FieldInt("client_destination_id",filed_options);options.fields.client_destination_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.city_route=new FieldGeomPolygon("city_route",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.city_route_distance=new FieldInt("city_route_distance",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.country_route=new FieldGeomPolygon("country_route",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.country_route_distance=new FieldInt("country_route_distance",filed_options);DelivDistanceCache_Model.superclass.constructor.call(this,id,options);}
extend(DelivDistanceCache_Model,Model); 
function DelivCostOpt_Model(options){var id='DelivCostOpt_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.volume_m=new FieldInt("volume_m",filed_options);options.fields.volume_m.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.weight_t=new FieldFloat("weight_t",filed_options);options.fields.weight_t.setRequired(true);DelivCostOpt_Model.superclass.constructor.call(this,id,options);}
extend(DelivCostOpt_Model,Model); 
function DelivCostOptList_Model(options){var id='DelivCostOptList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.volume_m=new FieldInt("volume_m",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.weight_t=new FieldFloat("weight_t",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.descr=new FieldString("descr",filed_options);DelivCostOptList_Model.superclass.constructor.call(this,id,options);}
extend(DelivCostOptList_Model,Model); 
function DelivCost_Model(options){var id='DelivCost_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.production_city_id=new FieldInt("production_city_id",filed_options);options.fields.production_city_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_cost_opt_id=new FieldInt("deliv_cost_opt_id",filed_options);options.fields.deliv_cost_opt_id.setRequired(true);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.deliv_cost_type=new FieldEnum("deliv_cost_type",filed_options);filed_options.enumValues='city,country';options.fields.deliv_cost_type.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Стоимость для контрагента';filed_options.autoInc=false;options.fields.cost=new FieldFloat("cost",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Себестоимость';filed_options.autoInc=false;options.fields.cost2=new FieldFloat("cost2",filed_options);DelivCost_Model.superclass.constructor.call(this,id,options);}
extend(DelivCost_Model,Model); 
function DelivCostList_Model(options){var id='DelivCostList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.production_city_id=new FieldInt("production_city_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Город';filed_options.autoInc=false;options.fields.production_city_descr=new FieldString("production_city_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_cost_opt=new FieldInt("deliv_cost_opt",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Ценовая категория';filed_options.autoInc=false;options.fields.deliv_cost_opt_descr=new FieldString("deliv_cost_opt_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_cost_type=new FieldString("deliv_cost_type",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Город/межгород';filed_options.autoInc=false;options.fields.deliv_cost_type_descr=new FieldString("deliv_cost_type_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Цена';filed_options.autoInc=false;options.fields.cost=new FieldFloat("cost",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Себестоимость';filed_options.autoInc=false;options.fields.cost2=new FieldFloat("cost2",filed_options);DelivCostList_Model.superclass.constructor.call(this,id,options);}
extend(DelivCostList_Model,Model); 
function ClientPaySchedule_Model(options){var id='ClientPaySchedule_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_id=new FieldInt("doc_id",filed_options);options.fields.doc_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pay_date=new FieldDate("pay_date",filed_options);options.fields.pay_date.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);options.fields.firm_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);options.fields.client_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);ClientPaySchedule_Model.superclass.constructor.call(this,id,options);}
extend(ClientPaySchedule_Model,Model); 
function ClientPayScheduleList_Model(options){var id='ClientPayScheduleList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date=new FieldDate("date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата';filed_options.autoInc=false;options.fields.date_descr=new FieldString("date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Организация';filed_options.autoInc=false;options.fields.firm_descr=new FieldString("firm_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Клиент';filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);ClientPayScheduleList_Model.superclass.constructor.call(this,id,options);}
extend(ClientPayScheduleList_Model,Model); 
function ClientDebt_Model(options){var id='ClientDebt_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_debt_period_days_from=new FieldInt("client_debt_period_days_from",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.def_debt=new FieldFloat("def_debt",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.debt_total=new FieldFloat("debt_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.days=new FieldInt("days",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.update_date=new FieldDate("update_date",filed_options);ClientDebt_Model.superclass.constructor.call(this,id,options);}
extend(ClientDebt_Model,Model); 
function ClientDebtList_Model(options){var id='ClientDebtList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Организация';filed_options.autoInc=false;options.fields.firm_descr=new FieldString("firm_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Контрагент';filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_debt_period_days_from=new FieldInt("client_debt_period_days_from",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Период задолженности';filed_options.autoInc=false;options.fields.client_debt_period_days_descr=new FieldString("client_debt_period_days_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Просроченная задолженность';filed_options.autoInc=false;options.fields.def_debt=new FieldFloat("def_debt",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Долг всего';filed_options.autoInc=false;options.fields.debt_total=new FieldFloat("debt_total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дней просроченного долга';filed_options.autoInc=false;options.fields.days=new FieldInt("days",filed_options);ClientDebtList_Model.superclass.constructor.call(this,id,options);}
extend(ClientDebtList_Model,Model); 
function RepClientDebtList_Model(options){var id='RepClientDebtList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Организация';filed_options.autoInc=false;options.fields.firm_descr=new FieldString("firm_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Контрагент';filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Отгружено, не оплачено';filed_options.autoInc=false;options.fields.shipped_not_payed=new FieldFloat("shipped_not_payed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Оплачено, не отгружено';filed_options.autoInc=false;options.fields.not_shipped_payed=new FieldFloat("not_shipped_payed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.balance=new FieldFloat("balance",filed_options);RepClientDebtList_Model.superclass.constructor.call(this,id,options);}
extend(RepClientDebtList_Model,Model); 
function UserWarehouse_Model(options){var id='UserWarehouse_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.user_id=new FieldInt("user_id",filed_options);options.fields.user_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);options.fields.warehouse_id.setRequired(true);UserWarehouse_Model.superclass.constructor.call(this,id,options);}
extend(UserWarehouse_Model,Model); 
function UserWarehouseList_Model(options){var id='UserWarehouseList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.user_id=new FieldInt("user_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.warehouse_descr=new FieldString("warehouse_descr",filed_options);UserWarehouseList_Model.superclass.constructor.call(this,id,options);}
extend(UserWarehouseList_Model,Model); 
function Holiday_Model(options){var id='Holiday_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.date=new FieldDate("date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);Holiday_Model.superclass.constructor.call(this,id,options);}
extend(Holiday_Model,Model); 
function HolidayList_Model(options){var id='HolidayList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.date=new FieldDate("date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_str=new FieldString("date_str",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);HolidayList_Model.superclass.constructor.call(this,id,options);}
extend(HolidayList_Model,Model); 
function TelPrefix_Model(options){var id='TelPrefix_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);TelPrefix_Model.superclass.constructor.call(this,id,options);}
extend(TelPrefix_Model,Model); 
function Naspunkt_Model(options){var id='Naspunkt_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.city_id=new FieldInt("city_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.distance=new FieldInt("distance",filed_options);Naspunkt_Model.superclass.constructor.call(this,id,options);}
extend(Naspunkt_Model,Model); 
function NaspunktList_Model(options){var id='NaspunktList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.city_id=new FieldInt("city_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Город';filed_options.autoInc=false;options.fields.city_descr=new FieldString("city_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Наименование';filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Расстояние (км.)';filed_options.autoInc=false;options.fields.distance=new FieldInt("distance",filed_options);NaspunktList_Model.superclass.constructor.call(this,id,options);}
extend(NaspunktList_Model,Model); 
function NaspunktCostList_Model(options){var id='NaspunktCostList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.city_id=new FieldInt("city_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Город';filed_options.autoInc=false;options.fields.city_descr=new FieldString("city_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Наименование';filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.deliv_cost_opt_id=new FieldInt("deliv_cost_opt_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Категория';filed_options.autoInc=false;options.fields.deliv_cost_opt_descr=new FieldString("deliv_cost_opt_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Расстояние (км.)';filed_options.autoInc=false;options.fields.distance=new FieldInt("distance",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Стоимость';filed_options.autoInc=false;options.fields.cost=new FieldFloat("cost",filed_options);NaspunktCostList_Model.superclass.constructor.call(this,id,options);}
extend(NaspunktCostList_Model,Model); 
function DOCOrderPrintSeq_Model(options){var id='DOCOrderPrintSeq_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_id=new FieldInt("doc_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.cnt=new FieldInt("cnt",filed_options);DOCOrderPrintSeq_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderPrintSeq_Model,Model); 
function AccPKO_Model(options){var id='AccPKO_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.acc_pko_type=new FieldEnum("acc_pko_type",filed_options);filed_options.enumValues='cash,bank';var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.order_list=new FieldText("order_list",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.order_ids=new FieldText("order_ids",filed_options);AccPKO_Model.superclass.constructor.call(this,id,options);}
extend(AccPKO_Model,Model); 
function AccPKOList_Model(options){var id='AccPKOList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата';filed_options.autoInc=false;options.fields.date_time_descr=new FieldString("date_time_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.acc_pko_type=new FieldEnum("acc_pko_type",filed_options);filed_options.enumValues='cash,bank';var filed_options={};filed_options.primaryKey=false;filed_options.alias='Тип ПКО';filed_options.autoInc=false;options.fields.acc_pko_type_descr=new FieldString("acc_pko_type_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Заявки';filed_options.autoInc=false;options.fields.order_list=new FieldText("order_list",filed_options);AccPKOList_Model.superclass.constructor.call(this,id,options);}
extend(AccPKOList_Model,Model); 
function VehicleStopList_Model(options){var id='VehicleStopList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.vh_id=new FieldInt("vh_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.vh_id_list=new FieldString("vh_id_list",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='ТС';filed_options.autoInc=false;options.fields.vh_descr=new FieldString("vh_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата';filed_options.autoInc=false;options.fields.date_time_descr=new FieldString("date_time_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Продолжит.стоянки';filed_options.autoInc=false;options.fields.duration=new FieldString("duration",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Адрес';filed_options.autoInc=false;options.fields.address=new FieldString("address",filed_options);VehicleStopList_Model.superclass.constructor.call(this,id,options);}
extend(VehicleStopList_Model,Model); 
function TemplateParam_Model(options){var id='TemplateParam_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.template=new FieldString("template",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Пользователь';filed_options.autoInc=false;options.fields.user_id=new FieldInt("user_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.param=new FieldString("param",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.val=new FieldText("val",filed_options);TemplateParam_Model.superclass.constructor.call(this,id,options);}
extend(TemplateParam_Model,Model); 
function TemplateParamList_Model(options){var id='TemplateParamList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.template=new FieldString("template",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.param=new FieldString("param",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.val=new FieldText("val",filed_options);TemplateParamList_Model.superclass.constructor.call(this,id,options);}
extend(TemplateParamList_Model,Model); 
function UnassignedOrderList_Model(options){var id='UnassignedOrderList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Номер';filed_options.autoInc=false;options.fields.number=new FieldString("number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Дата';filed_options.autoInc=false;options.fields.date_time=new FieldDateTime("date_time",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.delivery_plan_date=new FieldDateTime("delivery_plan_date",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Плановая дата выпуска';filed_options.autoInc=false;options.fields.delivery_plan_date_descr=new FieldDateTime("delivery_plan_date_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Клиент';filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Склад';filed_options.autoInc=false;options.fields.warehouse_descr=new FieldString("warehouse_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Адрес';filed_options.autoInc=false;options.fields.client_dest_descr=new FieldString("client_dest_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Продукция';filed_options.autoInc=false;options.fields.product_str=new FieldString("product_str",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Объем';filed_options.autoInc=false;options.fields.total_volume=new FieldFloat("total_volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Вес';filed_options.autoInc=false;options.fields.total_weight=new FieldFloat("total_weight",filed_options);UnassignedOrderList_Model.superclass.constructor.call(this,id,options);}
extend(UnassignedOrderList_Model,Model); 
function TTNAttrPair_Model(options){var id='TTNAttrPair_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Фирма';filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Склад';filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);TTNAttrPair_Model.superclass.constructor.call(this,id,options);}
extend(TTNAttrPair_Model,Model); 
function TTNAttrPairList_Model(options){var id='TTNAttrPairList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Фирма код';filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Фирма';filed_options.autoInc=false;options.fields.firm_descr=new FieldString("firm_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Склад код';filed_options.autoInc=false;options.fields.warehouse_id=new FieldInt("warehouse_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Склад код';filed_options.autoInc=false;options.fields.warehouse_descr=new FieldString("warehouse_descr",filed_options);TTNAttrPairList_Model.superclass.constructor.call(this,id,options);}
extend(TTNAttrPairList_Model,Model); 
function CarrierOrder_Model(options){var id='CarrierOrder_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Перевозчик код';filed_options.autoInc=false;options.fields.carrier_id=new FieldInt("carrier_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Водитель код';filed_options.autoInc=false;options.fields.driver_id=new FieldInt("driver_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='ТС код';filed_options.autoInc=false;options.fields.vehicle_id=new FieldInt("vehicle_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Порядок';filed_options.autoInc=false;options.fields.ord=new FieldInt("ord",filed_options);CarrierOrder_Model.superclass.constructor.call(this,id,options);}
extend(CarrierOrder_Model,Model); 
function CarrierOrderList_Model(options){var id='CarrierOrderList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Перевозчик код';filed_options.autoInc=false;options.fields.carrier_id=new FieldInt("carrier_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Перевозчик';filed_options.autoInc=false;options.fields.carrier_descr=new FieldString("carrier_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Водитель код';filed_options.autoInc=false;options.fields.driver_id=new FieldInt("driver_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Водитель';filed_options.autoInc=false;options.fields.driver_descr=new FieldString("driver_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='ТС код';filed_options.autoInc=false;options.fields.vehicle_id=new FieldInt("vehicle_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='ТС';filed_options.autoInc=false;options.fields.vehicle_descr=new FieldString("vehicle_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Порядок';filed_options.autoInc=false;options.fields.ord=new FieldInt("ord",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='На сегодня';filed_options.autoInc=false;options.fields.today_ord=new FieldInt("today_ord",filed_options);CarrierOrderList_Model.superclass.constructor.call(this,id,options);}
extend(CarrierOrderList_Model,Model); 
function ClientSearch_Controller(servConnector){options={};ClientSearch_Controller.superclass.constructor.call(this,"ClientSearch_Controller",servConnector,options);this.add_search();}
extend(ClientSearch_Controller,ControllerDb);ClientSearch_Controller.prototype.add_search=function(){var pm=this.addMethodById('search');pm.addParam(new FieldString("query"));pm.addParam(new FieldInt("checkIfExists"));pm.addParam(new FieldInt("client_id"));} 
function Bank_Controller(servConnector){options={};options["listModelId"]="BankList_Model";options["objModelId"]="BankList_Model";Bank_Controller.superclass.constructor.call(this,"Bank_Controller",servConnector,options);this.addGetList();this.addGetObject();this.addComplete();}
extend(Bank_Controller,ControllerDb);Bank_Controller.prototype.addGetList=function(){Bank_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldString("bik",options));pm.addParam(new FieldString("codegr",options));pm.addParam(new FieldString("gr_descr",options));pm.addParam(new FieldString("name",options));pm.addParam(new FieldString("korshet",options));pm.addParam(new FieldString("adres",options));pm.addParam(new FieldString("gor",options));pm.addParam(new FieldInt("tgoup",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("codegr,bik");}
Bank_Controller.prototype.addGetObject=function(){Bank_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldString("bik",options));}
Bank_Controller.prototype.addComplete=function(){Bank_Controller.superclass.addComplete.call(this);var options={};var pm=this.getComplete();pm.addParam(new FieldString("bik",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("bik");} 
function BankList_Model(options){var id='BankList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.alias='БИК';filed_options.autoInc=false;options.fields.bik=new FieldString("bik",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.codegr=new FieldString("codegr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Регион';filed_options.autoInc=false;options.fields.gr_descr=new FieldString("gr_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Наименование';filed_options.autoInc=false;options.fields.name=new FieldString("name",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Кoр.счет';filed_options.autoInc=false;options.fields.korshet=new FieldString("korshet",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Адрес';filed_options.autoInc=false;options.fields.adres=new FieldString("adres",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Город';filed_options.autoInc=false;options.fields.gor=new FieldString("gor",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.tgoup=new FieldInt("tgoup",filed_options);BankList_Model.superclass.constructor.call(this,id,options);}
extend(BankList_Model,Model); 
function ClientFirmBankAccount_Model(options){var id='ClientFirmBankAccount_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Клиент код';filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Фирма код';filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Ссылка 1с на р/счет контрагента';filed_options.autoInc=false;options.fields.ext_bank_account_id=new FieldString("ext_bank_account_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Расчетный счет';filed_options.autoInc=false;options.fields.ext_bank_account_descr=new FieldText("ext_bank_account_descr",filed_options);ClientFirmBankAccount_Model.superclass.constructor.call(this,id,options);}
extend(ClientFirmBankAccount_Model,Model); 
function ClientFirmBankAccountList_Model(options){var id='ClientFirmBankAccountList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Клиент код';filed_options.autoInc=false;options.fields.client_id=new FieldInt("client_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Клиент';filed_options.autoInc=false;options.fields.client_descr=new FieldString("client_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Фирма код';filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Фирма';filed_options.autoInc=false;options.fields.firm_descr=new FieldString("firm_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Ссылка 1с на р/счет контрагента';filed_options.autoInc=false;options.fields.ext_bank_account_id=new FieldString("ext_bank_account_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Расчетный счет';filed_options.autoInc=false;options.fields.ext_bank_account_descr=new FieldText("ext_bank_account_descr",filed_options);ClientFirmBankAccountList_Model.superclass.constructor.call(this,id,options);}
extend(ClientFirmBankAccountList_Model,Model); 
function ClientFirmBankAccount_Controller(servConnector){options={};options["listModelId"]="ClientFirmBankAccountList_Model";options["objModelId"]="ClientFirmBankAccountList_Model";ClientFirmBankAccount_Controller.superclass.constructor.call(this,"ClientFirmBankAccount_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(ClientFirmBankAccount_Controller,ControllerDb);ClientFirmBankAccount_Controller.prototype.addInsert=function(){ClientFirmBankAccount_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Клиент код";var param=new FieldInt("client_id",options);pm.addParam(param);options={};options["alias"]="Фирма код";var param=new FieldInt("firm_id",options);pm.addParam(param);options={};options["alias"]="Ссылка 1с на р/счет контрагента";var param=new FieldString("ext_bank_account_id",options);pm.addParam(param);options={};options["alias"]="Расчетный счет";var param=new FieldText("ext_bank_account_descr",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
ClientFirmBankAccount_Controller.prototype.addUpdate=function(){ClientFirmBankAccount_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Клиент код";var param=new FieldInt("client_id",options);pm.addParam(param);options={};options["alias"]="Фирма код";var param=new FieldInt("firm_id",options);pm.addParam(param);options={};options["alias"]="Ссылка 1с на р/счет контрагента";var param=new FieldString("ext_bank_account_id",options);pm.addParam(param);options={};options["alias"]="Расчетный счет";var param=new FieldText("ext_bank_account_descr",options);pm.addParam(param);}
ClientFirmBankAccount_Controller.prototype.addDelete=function(){ClientFirmBankAccount_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
ClientFirmBankAccount_Controller.prototype.addGetList=function(){ClientFirmBankAccount_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("client_id",options));pm.addParam(new FieldString("client_descr",options));pm.addParam(new FieldInt("firm_id",options));pm.addParam(new FieldString("firm_descr",options));pm.addParam(new FieldString("ext_bank_account_id",options));pm.addParam(new FieldText("ext_bank_account_descr",options));pm.getParamById(this.PARAM_ORD_FIELDS).setValue("client_id,firm_descr");}
ClientFirmBankAccount_Controller.prototype.addGetObject=function(){ClientFirmBankAccount_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function Product1cName_Model(options){var id='Product1cName_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);options.fields.firm_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name_for_1c=new FieldString("name_for_1c",filed_options);options.fields.name_for_1c.setRequired(true);Product1cName_Model.superclass.constructor.call(this,id,options);}
extend(Product1cName_Model,Model); 
function Product1cNameList_Model(options){var id='Product1cNameList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_id=new FieldInt("firm_id",filed_options);options.fields.firm_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.firm_descr=new FieldString("firm_descr",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.name_for_1c=new FieldString("name_for_1c",filed_options);Product1cNameList_Model.superclass.constructor.call(this,id,options);}
extend(Product1cNameList_Model,Model); 
function Product1cName_Controller(servConnector){options={};options["listModelId"]="Product1cNameList_Model";options["objModelId"]="Product1cNameList_Model";Product1cName_Controller.superclass.constructor.call(this,"Product1cName_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(Product1cName_Controller,ControllerDb);Product1cName_Controller.prototype.addInsert=function(){Product1cName_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldInt("product_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldString("name_for_1c",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));}
Product1cName_Controller.prototype.addUpdate=function(){Product1cName_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};var param=new FieldInt("product_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldString("name_for_1c",options);pm.addParam(param);}
Product1cName_Controller.prototype.addDelete=function(){Product1cName_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
Product1cName_Controller.prototype.addGetList=function(){Product1cName_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldInt("id",options));pm.addParam(new FieldInt("product_id",options));pm.addParam(new FieldInt("firm_id",options));pm.addParam(new FieldString("firm_descr",options));pm.addParam(new FieldString("name_for_1c",options));}
Product1cName_Controller.prototype.addGetObject=function(){Product1cName_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));} 
function DocOrderAttachment_Model(options){var id='DocOrderAttachment_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.id=new FieldString("id",filed_options);options.fields.id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.date_time=new FieldDateTimeTZ("date_time",filed_options);options.fields.date_time.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.doc_order_id=new FieldInt("doc_order_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.file_inf=new FieldJSONB("file_inf",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.file_data=new FieldText("file_data",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.preview_data=new FieldText("preview_data",filed_options);DocOrderAttachment_Model.superclass.constructor.call(this,id,options);}
extend(DocOrderAttachment_Model,Model); 
function SaleStoreAddress_Model(options){var id='SaleStoreAddress_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=true;options.fields.id=new FieldInt("id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Код';filed_options.autoInc=false;options.fields.code=new FieldString("code",filed_options);options.fields.code.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Наименование адреса';filed_options.autoInc=false;options.fields.name=new FieldText("name",filed_options);options.fields.name.setRequired(true);SaleStoreAddress_Model.superclass.constructor.call(this,id,options);}
extend(SaleStoreAddress_Model,Model); 
function ProdBatch_Controller(servConnector){options={};ProdBatch_Controller.superclass.constructor.call(this,"ProdBatch_Controller",servConnector,options);this.addGetList();this.add_complete_from_1c();}
extend(ProdBatch_Controller,ControllerDb);ProdBatch_Controller.prototype.addGetList=function(){ProdBatch_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();var options={};pm.addParam(new FieldInt("doc_order_id",options));}
ProdBatch_Controller.prototype.add_complete_from_1c=function(){var pm=this.addMethodById('complete_from_1c');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("pattern"));} 
function ProdBatch_Controller(servConnector){options={};ProdBatch_Controller.superclass.constructor.call(this,"ProdBatch_Controller",servConnector,options);this.addGetList();this.add_complete_from_1c();}
extend(ProdBatch_Controller,ControllerDb);ProdBatch_Controller.prototype.addGetList=function(){ProdBatch_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();var options={};pm.addParam(new FieldInt("doc_order_id",options));}
ProdBatch_Controller.prototype.add_complete_from_1c=function(){var pm=this.addMethodById('complete_from_1c');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("pattern"));} 
function DOCOrderDOCTProdBatch_Model(options){var id='DOCOrderDOCTProdBatch_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.login_id=new FieldInt("login_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Ссылка 1с';filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Description 1с';filed_options.autoInc=false;options.fields.batch_descr=new FieldText("batch_descr",filed_options);DOCOrderDOCTProdBatch_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProdBatch_Model,Model); 
function DOCOrderDOCTProdBatch_Model(options){var id='DOCOrderDOCTProdBatch_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.login_id=new FieldInt("login_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Ссылка 1с';filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Description 1с';filed_options.autoInc=false;options.fields.batch_descr=new FieldText("batch_descr",filed_options);DOCOrderDOCTProdBatch_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProdBatch_Model,Model); 
function DOCOrderDOCTProdBatchList_Model(options){var id='DOCOrderDOCTProdBatchList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Ссылка 1с';filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Description 1с';filed_options.autoInc=false;options.fields.batch_descr=new FieldText("batch_descr",filed_options);DOCOrderDOCTProdBatchList_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProdBatchList_Model,Model); 
function DOCOrderDOCTFProdBatch_Model(options){var id='DOCOrderDOCTFProdBatch_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_id=new FieldInt("doc_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.batch_descr=new FieldText("batch_descr",filed_options);options.fields.batch_descr.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);options.fields.ext_id.setRequired(true);DOCOrderDOCTFProdBatch_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTFProdBatch_Model,Model); 
function DOCOrderDOCTProdBatch_Controller(servConnector){options={};options["listModelId"]="DOCOrderDOCTProdBatchList_Model";options["objModelId"]="DOCOrderDOCTProdBatchList_Model";DOCOrderDOCTProdBatch_Controller.superclass.constructor.call(this,"DOCOrderDOCTProdBatch_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(DOCOrderDOCTProdBatch_Controller,ControllerDb);DOCOrderDOCTProdBatch_Controller.prototype.addInsert=function(){DOCOrderDOCTProdBatch_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("view_id",options);pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);options={};options["alias"]="Ссылка 1с";var param=new FieldString("ext_id",options);pm.addParam(param);options={};options["alias"]="Description 1с";var param=new FieldText("batch_descr",options);pm.addParam(param);}
DOCOrderDOCTProdBatch_Controller.prototype.addUpdate=function(){DOCOrderDOCTProdBatch_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldString("view_id",options);pm.addParam(param);param=new FieldString("old_view_id",{});pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);param=new FieldInt("old_line_number",{});pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);param=new FieldInt("old_login_id",{});pm.addParam(param);options={};options["alias"]="Ссылка 1с";var param=new FieldString("ext_id",options);pm.addParam(param);options={};options["alias"]="Description 1с";var param=new FieldText("batch_descr",options);pm.addParam(param);}
DOCOrderDOCTProdBatch_Controller.prototype.addDelete=function(){DOCOrderDOCTProdBatch_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));pm.addParam(new FieldInt("login_id",options));}
DOCOrderDOCTProdBatch_Controller.prototype.addGetList=function(){DOCOrderDOCTProdBatch_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));pm.addParam(new FieldString("ext_id",options));pm.addParam(new FieldText("batch_descr",options));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrderDOCTProdBatch_Controller.prototype.addGetObject=function(){DOCOrderDOCTProdBatch_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));} 
function DOCOrderDOCTProdBatch_Controller(servConnector){options={};options["listModelId"]="DOCOrderDOCTProdBatchList_Model";options["objModelId"]="DOCOrderDOCTProdBatchList_Model";DOCOrderDOCTProdBatch_Controller.superclass.constructor.call(this,"DOCOrderDOCTProdBatch_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(DOCOrderDOCTProdBatch_Controller,ControllerDb);DOCOrderDOCTProdBatch_Controller.prototype.addInsert=function(){DOCOrderDOCTProdBatch_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("view_id",options);pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);options={};options["alias"]="Ссылка 1с";var param=new FieldString("ext_id",options);pm.addParam(param);options={};options["alias"]="Description 1с";var param=new FieldText("batch_descr",options);pm.addParam(param);}
DOCOrderDOCTProdBatch_Controller.prototype.addUpdate=function(){DOCOrderDOCTProdBatch_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldString("view_id",options);pm.addParam(param);param=new FieldString("old_view_id",{});pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);param=new FieldInt("old_line_number",{});pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);param=new FieldInt("old_login_id",{});pm.addParam(param);options={};options["alias"]="Ссылка 1с";var param=new FieldString("ext_id",options);pm.addParam(param);options={};options["alias"]="Description 1с";var param=new FieldText("batch_descr",options);pm.addParam(param);}
DOCOrderDOCTProdBatch_Controller.prototype.addDelete=function(){DOCOrderDOCTProdBatch_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));pm.addParam(new FieldInt("login_id",options));}
DOCOrderDOCTProdBatch_Controller.prototype.addGetList=function(){DOCOrderDOCTProdBatch_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));pm.addParam(new FieldString("ext_id",options));pm.addParam(new FieldText("batch_descr",options));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrderDOCTProdBatch_Controller.prototype.addGetObject=function(){DOCOrderDOCTProdBatch_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));} 
function DOCOrderDOCTProdBatch_Model(options){var id='DOCOrderDOCTProdBatch_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.login_id=new FieldInt("login_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Ссылка 1с';filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Description 1с';filed_options.autoInc=false;options.fields.batch_descr=new FieldText("batch_descr",filed_options);DOCOrderDOCTProdBatch_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProdBatch_Model,Model); 
function DOCOrderDOCTProdBatchList_Model(options){var id='DOCOrderDOCTProdBatchList_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Ссылка 1с';filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Description 1с';filed_options.autoInc=false;options.fields.batch_descr=new FieldText("batch_descr",filed_options);DOCOrderDOCTProdBatchList_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProdBatchList_Model,Model); 
function DOCOrderDOCTFProdBatch_Model(options){var id='DOCOrderDOCTFProdBatch_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_id=new FieldInt("doc_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.batch_descr=new FieldText("batch_descr",filed_options);options.fields.batch_descr.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);options.fields.ext_id.setRequired(true);DOCOrderDOCTFProdBatch_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTFProdBatch_Model,Model); 
function ProdBatch_Controller(servConnector){options={};ProdBatch_Controller.superclass.constructor.call(this,"ProdBatch_Controller",servConnector,options);this.addGetList();this.add_complete_from_1c();}
extend(ProdBatch_Controller,ControllerDb);ProdBatch_Controller.prototype.addGetList=function(){ProdBatch_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();var options={};pm.addParam(new FieldInt("doc_order_id",options));}
ProdBatch_Controller.prototype.add_complete_from_1c=function(){var pm=this.addMethodById('complete_from_1c');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("pattern"));} 
function ProdBatch_Controller(servConnector){options={};ProdBatch_Controller.superclass.constructor.call(this,"ProdBatch_Controller",servConnector,options);this.addGetList();this.add_complete_from_1c();}
extend(ProdBatch_Controller,ControllerDb);ProdBatch_Controller.prototype.addGetList=function(){ProdBatch_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();var options={};pm.addParam(new FieldInt("doc_order_id",options));}
ProdBatch_Controller.prototype.add_complete_from_1c=function(){var pm=this.addMethodById('complete_from_1c');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("pattern"));} 
function DOCOrderDOCTProdBatch_Model(options){var id='DOCOrderDOCTProdBatch_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.login_id=new FieldInt("login_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Ссылка 1с';filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Description 1с';filed_options.autoInc=false;options.fields.batch_descr=new FieldText("batch_descr",filed_options);DOCOrderDOCTProdBatch_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProdBatch_Model,Model); 
function DOCOrderDOCTProdBatch_Controller(servConnector){options={};options["listModelId"]="DOCOrderDOCTProdBatchList_Model";options["objModelId"]="DOCOrderDOCTProdBatchList_Model";DOCOrderDOCTProdBatch_Controller.superclass.constructor.call(this,"DOCOrderDOCTProdBatch_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();}
extend(DOCOrderDOCTProdBatch_Controller,ControllerDb);DOCOrderDOCTProdBatch_Controller.prototype.addInsert=function(){DOCOrderDOCTProdBatch_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("view_id",options);pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);options={};options["alias"]="Ссылка 1с";var param=new FieldString("ext_id",options);pm.addParam(param);options={};options["alias"]="Description 1с";var param=new FieldText("batch_descr",options);pm.addParam(param);}
DOCOrderDOCTProdBatch_Controller.prototype.addUpdate=function(){DOCOrderDOCTProdBatch_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldString("view_id",options);pm.addParam(param);param=new FieldString("old_view_id",{});pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);param=new FieldInt("old_line_number",{});pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);param=new FieldInt("old_login_id",{});pm.addParam(param);options={};options["alias"]="Ссылка 1с";var param=new FieldString("ext_id",options);pm.addParam(param);options={};options["alias"]="Description 1с";var param=new FieldText("batch_descr",options);pm.addParam(param);}
DOCOrderDOCTProdBatch_Controller.prototype.addDelete=function(){DOCOrderDOCTProdBatch_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));pm.addParam(new FieldInt("login_id",options));}
DOCOrderDOCTProdBatch_Controller.prototype.addGetList=function(){DOCOrderDOCTProdBatch_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));pm.addParam(new FieldString("ext_id",options));pm.addParam(new FieldText("batch_descr",options));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrderDOCTProdBatch_Controller.prototype.addGetObject=function(){DOCOrderDOCTProdBatch_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));} 
function DOCOrder_Controller(servConnector){options={};options["objModelId"]="DOCOrderDialog_Model";DOCOrder_Controller.superclass.constructor.call(this,"DOCOrder_Controller",servConnector,options);this.addInsert();this.addUpdate();this.add_divide();this.addDelete();this.add_get_new_list();this.add_get_current_list();this.add_get_current_for_representative_list();this.add_get_current_for_client_list();this.add_get_current_for_production_list();this.add_get_closed_list();this.addGetObject();this.add_get_cust_survey();this.add_get_divis();this.add_before_open();this.add_get_actions();this.add_get_print();this.add_download_print();this.add_get_print_check();this.add_set_ready();this.add_get_shipment();this.add_get_products_descr();this.add_cancel();this.add_cancel_last_state();this.add_get_history();this.add_pass_to_production();this.add_get_print_all();this.add_get_print_cnt();this.add_set_printed();this.add_set_shipped();this.add_get_ship_docs();this.add_print_ship_docs();this.add_set_paid();this.add_set_not_paid();this.add_paid_to_acc();this.add_set_paid_by_bank();this.add_paid_by_bank_to_acc();this.add_set_closed();this.add_print_order();this.add_ext_ship_exists();this.add_ext_invoice_exists();this.add_ext_order_exists();this.add_print_torg12();this.add_print_invoice();this.add_print_upd();this.add_print_ttn();this.add_print_passport();this.add_pay_orders_list();this.add_fill_cust_surv();this.add_set_cancel_cause();this.add_calc_totals();this.add_calc_quant();this.add_recalc_product_prices();this.add_calc_deliv_cost();this.add_get_pop_warehouse();this.add_get_children();this.add_get_cancel_cause();this.add_get_append_list();this.add_append();this.add_add_file();this.add_delete_file();this.add_get_file();this.add_get_files_list();this.add_get_nonegraphic_files_list();}
extend(DOCOrder_Controller,ControllerDb);DOCOrder_Controller.prototype.addInsert=function(){DOCOrder_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Дата пдч.";var param=new FieldDateTime("date_time",options);pm.addParam(param);options={};options["alias"]="Номер";var param=new FieldString("number",options);pm.addParam(param);options={};options["alias"]="Проведен";var param=new FieldBool("processed",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("gruzopoluchatel_id",options);pm.addParam(param);options={};var param=new FieldString("client_number",options);pm.addParam(param);options={};var param=new FieldDate("delivery_plan_date",options);pm.addParam(param);options={};var param=new FieldDateTime("delivery_fact_date",options);pm.addParam(param);options={};var param=new FieldDate("product_plan_date",options);pm.addParam(param);options={};var param=new FieldInt("client_user_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldText("sales_manager_comment",options);pm.addParam(param);options={};var param=new FieldText("client_comment",options);pm.addParam(param);options={};var param=new FieldText("marketing_comment",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_destination_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_type",options);options["values"]='by_supplier,by_client';pm.addParam(param);options={};var param=new FieldBool("deliv_to_third_party",options);pm.addParam(param);options={};var param=new FieldBool("deliv_send_sms",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldInt("deliv_period_id",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable_tel",options);pm.addParam(param);options={};var param=new FieldString("tel",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_count",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_total",options);pm.addParam(param);options={};var param=new FieldBool("deliv_total_edit",options);pm.addParam(param);options={};var param=new FieldFloat("total",options);pm.addParam(param);options={};var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldFloat("total_quant",options);pm.addParam(param);options={};var param=new FieldFloat("total_volume",options);pm.addParam(param);options={};var param=new FieldFloat("total_weight",options);pm.addParam(param);options={};var param=new FieldBool("printed",options);pm.addParam(param);options={};var param=new FieldString("ext_order_num",options);pm.addParam(param);options={};var param=new FieldString("ext_order_id",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_num",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_id",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_num",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_id",options);pm.addParam(param);options={};var param=new FieldDateTime("ext_invoice_date_time",options);pm.addParam(param);options={};var param=new FieldDateTime("cust_surv_date_time",options);pm.addParam(param);options={};var param=new FieldText("cust_surv_comment",options);pm.addParam(param);options={};var param=new FieldText("product_str",options);pm.addParam(param);options={};var param=new FieldInt("product_ids",options);pm.addParam(param);options={};var param=new FieldInt("submit_user_id",options);pm.addParam(param);options={};var param=new FieldBool("paid",options);pm.addParam(param);options={};var param=new FieldBool("paid_by_bank",options);pm.addParam(param);options={};var param=new FieldBool("acc_pko",options);pm.addParam(param);options={};var param=new FieldInt("city_route_distance",options);pm.addParam(param);options={};var param=new FieldInt("country_route_distance",options);pm.addParam(param);options={};var param=new FieldBool("destination_to_ttn",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_expenses",options);pm.addParam(param);options={};var param=new FieldBool("deliv_expenses_edit",options);pm.addParam(param);options={};var param=new FieldBool("deliv_pay_bank",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_ext_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_name",options);pm.addParam(param);options={};options["alias"]="Адрес магазина";var param=new FieldInt("sale_store_address_id",options);pm.addParam(param);options={};options["alias"]="Номер заказа";var param=new FieldText("order_num",options);pm.addParam(param);options={};options["alias"]="Номер партии";var param=new FieldText("batch_num",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrder_Controller.prototype.addUpdate=function(){DOCOrder_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Дата пдч.";var param=new FieldDateTime("date_time",options);pm.addParam(param);options={};options["alias"]="Номер";var param=new FieldString("number",options);pm.addParam(param);options={};options["alias"]="Проведен";var param=new FieldBool("processed",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("gruzopoluchatel_id",options);pm.addParam(param);options={};var param=new FieldString("client_number",options);pm.addParam(param);options={};var param=new FieldDate("delivery_plan_date",options);pm.addParam(param);options={};var param=new FieldDateTime("delivery_fact_date",options);pm.addParam(param);options={};var param=new FieldDate("product_plan_date",options);pm.addParam(param);options={};var param=new FieldInt("client_user_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldText("sales_manager_comment",options);pm.addParam(param);options={};var param=new FieldText("client_comment",options);pm.addParam(param);options={};var param=new FieldText("marketing_comment",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_destination_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_type",options);options["values"]='by_supplier,by_client';pm.addParam(param);options={};var param=new FieldBool("deliv_to_third_party",options);pm.addParam(param);options={};var param=new FieldBool("deliv_send_sms",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldInt("deliv_period_id",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable_tel",options);pm.addParam(param);options={};var param=new FieldString("tel",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_count",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_total",options);pm.addParam(param);options={};var param=new FieldBool("deliv_total_edit",options);pm.addParam(param);options={};var param=new FieldFloat("total",options);pm.addParam(param);options={};var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldFloat("total_quant",options);pm.addParam(param);options={};var param=new FieldFloat("total_volume",options);pm.addParam(param);options={};var param=new FieldFloat("total_weight",options);pm.addParam(param);options={};var param=new FieldBool("printed",options);pm.addParam(param);options={};var param=new FieldString("ext_order_num",options);pm.addParam(param);options={};var param=new FieldString("ext_order_id",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_num",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_id",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_num",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_id",options);pm.addParam(param);options={};var param=new FieldDateTime("ext_invoice_date_time",options);pm.addParam(param);options={};var param=new FieldDateTime("cust_surv_date_time",options);pm.addParam(param);options={};var param=new FieldText("cust_surv_comment",options);pm.addParam(param);options={};var param=new FieldText("product_str",options);pm.addParam(param);options={};var param=new FieldInt("product_ids",options);pm.addParam(param);options={};var param=new FieldInt("submit_user_id",options);pm.addParam(param);options={};var param=new FieldBool("paid",options);pm.addParam(param);options={};var param=new FieldBool("paid_by_bank",options);pm.addParam(param);options={};var param=new FieldBool("acc_pko",options);pm.addParam(param);options={};var param=new FieldInt("city_route_distance",options);pm.addParam(param);options={};var param=new FieldInt("country_route_distance",options);pm.addParam(param);options={};var param=new FieldBool("destination_to_ttn",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_expenses",options);pm.addParam(param);options={};var param=new FieldBool("deliv_expenses_edit",options);pm.addParam(param);options={};var param=new FieldBool("deliv_pay_bank",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_ext_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_name",options);pm.addParam(param);options={};options["alias"]="Адрес магазина";var param=new FieldInt("sale_store_address_id",options);pm.addParam(param);options={};options["alias"]="Номер заказа";var param=new FieldText("order_num",options);pm.addParam(param);options={};options["alias"]="Номер партии";var param=new FieldText("batch_num",options);pm.addParam(param);var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrder_Controller.prototype.add_divide=function(){var pm=this.addMethodById('divide');pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("main_doc_id"));pm.addParam(new FieldDate("delivery_plan_date"));pm.addParam(new FieldText("sales_manager_comment"));pm.addParam(new FieldInt("deliv_period_id"));pm.addParam(new FieldInt("deliv_vehicle_count"));pm.addParam(new FieldInt("deliv_cost_opt_id"));pm.addParam(new FieldFloat("deliv_total"));pm.addParam(new FieldBool("deliv_total_edit"));}
DOCOrder_Controller.prototype.addDelete=function(){DOCOrder_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
DOCOrder_Controller.prototype.add_get_new_list=function(){var pm=this.addMethodById('get_new_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_list=function(){var pm=this.addMethodById('get_current_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_representative_list=function(){var pm=this.addMethodById('get_current_for_representative_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_client_list=function(){var pm=this.addMethodById('get_current_for_client_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_production_list=function(){var pm=this.addMethodById('get_current_for_production_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_closed_list=function(){var pm=this.addMethodById('get_closed_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.addGetObject=function(){DOCOrder_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
DOCOrder_Controller.prototype.add_get_cust_survey=function(){var pm=this.addMethodById('get_cust_survey');pm.addParam(new FieldInt("id"));}
DOCOrder_Controller.prototype.add_get_divis=function(){var pm=this.addMethodById('get_divis');pm.addParam(new FieldInt("id"));pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_before_open=function(){var pm=this.addMethodById('before_open');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_get_actions=function(){var pm=this.addMethodById('get_actions');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print=function(){var pm=this.addMethodById('get_print');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_download_print=function(){var pm=this.addMethodById('download_print');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print_check=function(){var pm=this.addMethodById('get_print_check');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_set_ready=function(){var pm=this.addMethodById('set_ready');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_shipment=function(){var pm=this.addMethodById('get_shipment');pm.addParam(new FieldInt("id"));}
DOCOrder_Controller.prototype.add_get_products_descr=function(){var pm=this.addMethodById('get_products_descr');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_cancel=function(){var pm=this.addMethodById('cancel');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_cancel_last_state=function(){var pm=this.addMethodById('cancel_last_state');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_history=function(){var pm=this.addMethodById('get_history');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_pass_to_production=function(){var pm=this.addMethodById('pass_to_production');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print_all=function(){var pm=this.addMethodById('get_print_all');pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_get_print_cnt=function(){var pm=this.addMethodById('get_print_cnt');}
DOCOrder_Controller.prototype.add_set_printed=function(){var pm=this.addMethodById('set_printed');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_shipped=function(){var pm=this.addMethodById('set_shipped');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("deliv_vehicle_count"));pm.addParam(new FieldInt("driver_id"));pm.addParam(new FieldInt("vehicle_id"));pm.addParam(new FieldInt("deliv_destination_id"));pm.addParam(new FieldBool("destination_to_ttn"));pm.addParam(new FieldText("batch_num"));}
DOCOrder_Controller.prototype.add_get_ship_docs=function(){var pm=this.addMethodById('get_ship_docs');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_ship_docs=function(){var pm=this.addMethodById('print_ship_docs');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_paid=function(){var pm=this.addMethodById('set_paid');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_not_paid=function(){var pm=this.addMethodById('set_not_paid');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_paid_to_acc=function(){var pm=this.addMethodById('paid_to_acc');}
DOCOrder_Controller.prototype.add_set_paid_by_bank=function(){var pm=this.addMethodById('set_paid_by_bank');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_paid_by_bank_to_acc=function(){var pm=this.addMethodById('paid_by_bank_to_acc');}
DOCOrder_Controller.prototype.add_set_closed=function(){var pm=this.addMethodById('set_closed');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_order=function(){var pm=this.addMethodById('print_order');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_ship_exists=function(){var pm=this.addMethodById('ext_ship_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_invoice_exists=function(){var pm=this.addMethodById('ext_invoice_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_order_exists=function(){var pm=this.addMethodById('ext_order_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_torg12=function(){var pm=this.addMethodById('print_torg12');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_invoice=function(){var pm=this.addMethodById('print_invoice');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_upd=function(){var pm=this.addMethodById('print_upd');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_ttn=function(){var pm=this.addMethodById('print_ttn');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_passport=function(){var pm=this.addMethodById('print_passport');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_pay_orders_list=function(){var pm=this.addMethodById('pay_orders_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_fill_cust_surv=function(){var pm=this.addMethodById('fill_cust_surv');pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_set_cancel_cause=function(){var pm=this.addMethodById('set_cancel_cause');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldText("cause"));}
DOCOrder_Controller.prototype.add_calc_totals=function(){var pm=this.addMethodById('calc_totals');pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldInt("product_id"));pm.addParam(new FieldInt("mes_length"));pm.addParam(new FieldInt("mes_width"));pm.addParam(new FieldInt("mes_height"));pm.addParam(new FieldFloat("quant"));pm.addParam(new FieldInt("measure_unit_id"));pm.addParam(new FieldBool("pack"));pm.addParam(new FieldBool("pack_in_price"));pm.addParam(new FieldBool("deliv_to_third_party"));pm.addParam(new FieldBool("price_edit"));pm.addParam(new FieldBool("price_round"));pm.addParam(new FieldFloat("price"));}
DOCOrder_Controller.prototype.add_calc_quant=function(){var pm=this.addMethodById('calc_quant');pm.addParam(new FieldInt("product_id"));pm.addParam(new FieldInt("measure_unit_id"));pm.addParam(new FieldInt("mes_length"));pm.addParam(new FieldInt("mes_width"));pm.addParam(new FieldInt("mes_height"));pm.addParam(new FieldFloat("quant"));pm.addParam(new FieldInt("measure_unit_id_from"));}
DOCOrder_Controller.prototype.add_recalc_product_prices=function(){var pm=this.addMethodById('recalc_product_prices');pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldFloat("deliv_cost"));pm.addParam(new FieldBool("deliv_to_third_party"));pm.addParam(new FieldBool("deliv_add_cost_to_product"));}
DOCOrder_Controller.prototype.add_calc_deliv_cost=function(){var pm=this.addMethodById('calc_deliv_cost');pm.addParam(new FieldInt("cost_opt_id"));pm.addParam(new FieldInt("client_destination_id"));pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("include_route"));}
DOCOrder_Controller.prototype.add_get_pop_warehouse=function(){var pm=this.addMethodById('get_pop_warehouse');pm.addParam(new FieldInt("firm_id"));}
DOCOrder_Controller.prototype.add_get_children=function(){var pm=this.addMethodById('get_children');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_cancel_cause=function(){var pm=this.addMethodById('get_cancel_cause');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_append_list=function(){var pm=this.addMethodById('get_append_list');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_append=function(){var pm=this.addMethodById('append');pm.addParam(new FieldInt("target_doc_id"));pm.addParam(new FieldString("source_doc_id_list"));}
DOCOrder_Controller.prototype.add_add_file=function(){var pm=this.addMethodById('add_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldText("file_data"));pm.addParam(new FieldString("file_id"));}
DOCOrder_Controller.prototype.add_delete_file=function(){var pm=this.addMethodById('delete_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("file_id"));}
DOCOrder_Controller.prototype.add_get_file=function(){var pm=this.addMethodById('get_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("file_id"));pm.addParam(new FieldInt("inline"));}
DOCOrder_Controller.prototype.add_get_files_list=function(){var pm=this.addMethodById('get_files_list');pm.addParam(new FieldInt("doc_order_id"));}
DOCOrder_Controller.prototype.add_get_nonegraphic_files_list=function(){var pm=this.addMethodById('get_nonegraphic_files_list');pm.addParam(new FieldInt("doc_order_id"));} 
function DOCOrderDOCTProduct_Model(options){var id='DOCOrderDOCTProduct_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.login_id=new FieldInt("login_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Продукция';filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length=new FieldInt("mes_length",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width=new FieldInt("mes_width",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height=new FieldInt("mes_height",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.measure_unit_id=new FieldInt("measure_unit_id",filed_options);options.fields.measure_unit_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant=new FieldFloat("quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant_confirmed=new FieldFloat("quant_confirmed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant_base_measure_unit=new FieldFloat("quant_base_measure_unit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant_confirmed_base_measure_unit=new FieldFloat("quant_confirmed_base_measure_unit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.volume=new FieldFloat("volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.weight=new FieldFloat("weight",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Цена';filed_options.autoInc=false;options.fields.price=new FieldFloat("price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_edit=new FieldBool("price_edit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_round=new FieldBool("price_round",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total_pack=new FieldFloat("total_pack",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_exists=new FieldBool("pack_exists",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_in_price=new FieldBool("pack_in_price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_deliv=new FieldFloat("total_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.total_no_deliv=new FieldFloat("total_no_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.price_no_deliv=new FieldFloat("price_no_deliv",filed_options);DOCOrderDOCTProduct_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProduct_Model,Model); 
function DOCOrderDOCTFProduct_Model(options){var id='DOCOrderDOCTFProduct_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_id=new FieldInt("doc_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Продукция';filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length=new FieldInt("mes_length",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width=new FieldInt("mes_width",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height=new FieldInt("mes_height",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.measure_unit_id=new FieldInt("measure_unit_id",filed_options);options.fields.measure_unit_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant=new FieldFloat("quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant_confirmed=new FieldFloat("quant_confirmed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant_base_measure_unit=new FieldFloat("quant_base_measure_unit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant_confirmed_base_measure_unit=new FieldFloat("quant_confirmed_base_measure_unit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.volume=new FieldFloat("volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.weight=new FieldFloat("weight",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Цена';filed_options.autoInc=false;options.fields.price=new FieldFloat("price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Цена без доставки';filed_options.autoInc=false;options.fields.price_no_deliv=new FieldFloat("price_no_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_edit=new FieldBool("price_edit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_round=new FieldBool("price_round",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Упаковка';filed_options.autoInc=false;options.fields.total_pack=new FieldFloat("total_pack",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_exists=new FieldBool("pack_exists",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_in_price=new FieldBool("pack_in_price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_deliv=new FieldFloat("total_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.total_no_deliv=new FieldFloat("total_no_deliv",filed_options);DOCOrderDOCTFProduct_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTFProduct_Model,Model); 
function DOCOrder_Controller(servConnector){options={};options["objModelId"]="DOCOrderDialog_Model";DOCOrder_Controller.superclass.constructor.call(this,"DOCOrder_Controller",servConnector,options);this.addInsert();this.addUpdate();this.add_divide();this.addDelete();this.add_get_new_list();this.add_get_current_list();this.add_get_current_for_representative_list();this.add_get_current_for_client_list();this.add_get_current_for_production_list();this.add_get_closed_list();this.addGetObject();this.add_get_cust_survey();this.add_get_divis();this.add_before_open();this.add_get_actions();this.add_get_print();this.add_download_print();this.add_get_print_check();this.add_set_ready();this.add_get_shipment();this.add_get_products_descr();this.add_cancel();this.add_cancel_last_state();this.add_get_history();this.add_pass_to_production();this.add_get_print_all();this.add_get_print_cnt();this.add_set_printed();this.add_set_shipped();this.add_get_ship_docs();this.add_print_ship_docs();this.add_set_paid();this.add_set_not_paid();this.add_paid_to_acc();this.add_set_paid_by_bank();this.add_paid_by_bank_to_acc();this.add_set_closed();this.add_print_order();this.add_ext_ship_exists();this.add_ext_invoice_exists();this.add_ext_order_exists();this.add_print_torg12();this.add_print_invoice();this.add_print_upd();this.add_print_ttn();this.add_print_passport();this.add_pay_orders_list();this.add_fill_cust_surv();this.add_set_cancel_cause();this.add_calc_totals();this.add_calc_quant();this.add_recalc_product_prices();this.add_calc_deliv_cost();this.add_get_pop_warehouse();this.add_get_children();this.add_get_cancel_cause();this.add_get_append_list();this.add_append();this.add_add_file();this.add_delete_file();this.add_get_file();this.add_get_files_list();this.add_get_nonegraphic_files_list();}
extend(DOCOrder_Controller,ControllerDb);DOCOrder_Controller.prototype.addInsert=function(){DOCOrder_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Дата пдч.";var param=new FieldDateTime("date_time",options);pm.addParam(param);options={};options["alias"]="Номер";var param=new FieldString("number",options);pm.addParam(param);options={};options["alias"]="Проведен";var param=new FieldBool("processed",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("gruzopoluchatel_id",options);pm.addParam(param);options={};var param=new FieldString("client_number",options);pm.addParam(param);options={};var param=new FieldDate("delivery_plan_date",options);pm.addParam(param);options={};var param=new FieldDateTime("delivery_fact_date",options);pm.addParam(param);options={};var param=new FieldDate("product_plan_date",options);pm.addParam(param);options={};var param=new FieldInt("client_user_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldText("sales_manager_comment",options);pm.addParam(param);options={};var param=new FieldText("client_comment",options);pm.addParam(param);options={};var param=new FieldText("marketing_comment",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_destination_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_type",options);options["values"]='by_supplier,by_client';pm.addParam(param);options={};var param=new FieldBool("deliv_to_third_party",options);pm.addParam(param);options={};var param=new FieldBool("deliv_send_sms",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldInt("deliv_period_id",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable_tel",options);pm.addParam(param);options={};var param=new FieldString("tel",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_count",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_total",options);pm.addParam(param);options={};var param=new FieldBool("deliv_total_edit",options);pm.addParam(param);options={};var param=new FieldFloat("total",options);pm.addParam(param);options={};var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldFloat("total_quant",options);pm.addParam(param);options={};var param=new FieldFloat("total_volume",options);pm.addParam(param);options={};var param=new FieldFloat("total_weight",options);pm.addParam(param);options={};var param=new FieldBool("printed",options);pm.addParam(param);options={};var param=new FieldString("ext_order_num",options);pm.addParam(param);options={};var param=new FieldString("ext_order_id",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_num",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_id",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_num",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_id",options);pm.addParam(param);options={};var param=new FieldDateTime("ext_invoice_date_time",options);pm.addParam(param);options={};var param=new FieldDateTime("cust_surv_date_time",options);pm.addParam(param);options={};var param=new FieldText("cust_surv_comment",options);pm.addParam(param);options={};var param=new FieldText("product_str",options);pm.addParam(param);options={};var param=new FieldInt("product_ids",options);pm.addParam(param);options={};var param=new FieldInt("submit_user_id",options);pm.addParam(param);options={};var param=new FieldBool("paid",options);pm.addParam(param);options={};var param=new FieldBool("paid_by_bank",options);pm.addParam(param);options={};var param=new FieldBool("acc_pko",options);pm.addParam(param);options={};var param=new FieldInt("city_route_distance",options);pm.addParam(param);options={};var param=new FieldInt("country_route_distance",options);pm.addParam(param);options={};var param=new FieldBool("destination_to_ttn",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_expenses",options);pm.addParam(param);options={};var param=new FieldBool("deliv_expenses_edit",options);pm.addParam(param);options={};var param=new FieldBool("deliv_pay_bank",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_ext_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_name",options);pm.addParam(param);options={};options["alias"]="Адрес магазина";var param=new FieldInt("sale_store_address_id",options);pm.addParam(param);options={};options["alias"]="Номер заказа";var param=new FieldText("order_num",options);pm.addParam(param);options={};options["alias"]="Номер партии";var param=new FieldText("batch_num",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrder_Controller.prototype.addUpdate=function(){DOCOrder_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Дата пдч.";var param=new FieldDateTime("date_time",options);pm.addParam(param);options={};options["alias"]="Номер";var param=new FieldString("number",options);pm.addParam(param);options={};options["alias"]="Проведен";var param=new FieldBool("processed",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("gruzopoluchatel_id",options);pm.addParam(param);options={};var param=new FieldString("client_number",options);pm.addParam(param);options={};var param=new FieldDate("delivery_plan_date",options);pm.addParam(param);options={};var param=new FieldDateTime("delivery_fact_date",options);pm.addParam(param);options={};var param=new FieldDate("product_plan_date",options);pm.addParam(param);options={};var param=new FieldInt("client_user_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldText("sales_manager_comment",options);pm.addParam(param);options={};var param=new FieldText("client_comment",options);pm.addParam(param);options={};var param=new FieldText("marketing_comment",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_destination_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_type",options);options["values"]='by_supplier,by_client';pm.addParam(param);options={};var param=new FieldBool("deliv_to_third_party",options);pm.addParam(param);options={};var param=new FieldBool("deliv_send_sms",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldInt("deliv_period_id",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable_tel",options);pm.addParam(param);options={};var param=new FieldString("tel",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_count",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_total",options);pm.addParam(param);options={};var param=new FieldBool("deliv_total_edit",options);pm.addParam(param);options={};var param=new FieldFloat("total",options);pm.addParam(param);options={};var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldFloat("total_quant",options);pm.addParam(param);options={};var param=new FieldFloat("total_volume",options);pm.addParam(param);options={};var param=new FieldFloat("total_weight",options);pm.addParam(param);options={};var param=new FieldBool("printed",options);pm.addParam(param);options={};var param=new FieldString("ext_order_num",options);pm.addParam(param);options={};var param=new FieldString("ext_order_id",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_num",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_id",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_num",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_id",options);pm.addParam(param);options={};var param=new FieldDateTime("ext_invoice_date_time",options);pm.addParam(param);options={};var param=new FieldDateTime("cust_surv_date_time",options);pm.addParam(param);options={};var param=new FieldText("cust_surv_comment",options);pm.addParam(param);options={};var param=new FieldText("product_str",options);pm.addParam(param);options={};var param=new FieldInt("product_ids",options);pm.addParam(param);options={};var param=new FieldInt("submit_user_id",options);pm.addParam(param);options={};var param=new FieldBool("paid",options);pm.addParam(param);options={};var param=new FieldBool("paid_by_bank",options);pm.addParam(param);options={};var param=new FieldBool("acc_pko",options);pm.addParam(param);options={};var param=new FieldInt("city_route_distance",options);pm.addParam(param);options={};var param=new FieldInt("country_route_distance",options);pm.addParam(param);options={};var param=new FieldBool("destination_to_ttn",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_expenses",options);pm.addParam(param);options={};var param=new FieldBool("deliv_expenses_edit",options);pm.addParam(param);options={};var param=new FieldBool("deliv_pay_bank",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_ext_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_name",options);pm.addParam(param);options={};options["alias"]="Адрес магазина";var param=new FieldInt("sale_store_address_id",options);pm.addParam(param);options={};options["alias"]="Номер заказа";var param=new FieldText("order_num",options);pm.addParam(param);options={};options["alias"]="Номер партии";var param=new FieldText("batch_num",options);pm.addParam(param);var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrder_Controller.prototype.add_divide=function(){var pm=this.addMethodById('divide');pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("main_doc_id"));pm.addParam(new FieldDate("delivery_plan_date"));pm.addParam(new FieldText("sales_manager_comment"));pm.addParam(new FieldInt("deliv_period_id"));pm.addParam(new FieldInt("deliv_vehicle_count"));pm.addParam(new FieldInt("deliv_cost_opt_id"));pm.addParam(new FieldFloat("deliv_total"));pm.addParam(new FieldBool("deliv_total_edit"));}
DOCOrder_Controller.prototype.addDelete=function(){DOCOrder_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
DOCOrder_Controller.prototype.add_get_new_list=function(){var pm=this.addMethodById('get_new_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_list=function(){var pm=this.addMethodById('get_current_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_representative_list=function(){var pm=this.addMethodById('get_current_for_representative_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_client_list=function(){var pm=this.addMethodById('get_current_for_client_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_production_list=function(){var pm=this.addMethodById('get_current_for_production_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_closed_list=function(){var pm=this.addMethodById('get_closed_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.addGetObject=function(){DOCOrder_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
DOCOrder_Controller.prototype.add_get_cust_survey=function(){var pm=this.addMethodById('get_cust_survey');pm.addParam(new FieldInt("id"));}
DOCOrder_Controller.prototype.add_get_divis=function(){var pm=this.addMethodById('get_divis');pm.addParam(new FieldInt("id"));pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_before_open=function(){var pm=this.addMethodById('before_open');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_get_actions=function(){var pm=this.addMethodById('get_actions');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print=function(){var pm=this.addMethodById('get_print');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_download_print=function(){var pm=this.addMethodById('download_print');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print_check=function(){var pm=this.addMethodById('get_print_check');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_set_ready=function(){var pm=this.addMethodById('set_ready');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_shipment=function(){var pm=this.addMethodById('get_shipment');pm.addParam(new FieldInt("id"));}
DOCOrder_Controller.prototype.add_get_products_descr=function(){var pm=this.addMethodById('get_products_descr');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_cancel=function(){var pm=this.addMethodById('cancel');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_cancel_last_state=function(){var pm=this.addMethodById('cancel_last_state');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_history=function(){var pm=this.addMethodById('get_history');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_pass_to_production=function(){var pm=this.addMethodById('pass_to_production');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print_all=function(){var pm=this.addMethodById('get_print_all');pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_get_print_cnt=function(){var pm=this.addMethodById('get_print_cnt');}
DOCOrder_Controller.prototype.add_set_printed=function(){var pm=this.addMethodById('set_printed');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_shipped=function(){var pm=this.addMethodById('set_shipped');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("deliv_vehicle_count"));pm.addParam(new FieldInt("driver_id"));pm.addParam(new FieldInt("vehicle_id"));pm.addParam(new FieldInt("deliv_destination_id"));pm.addParam(new FieldBool("destination_to_ttn"));pm.addParam(new FieldText("batch_num"));}
DOCOrder_Controller.prototype.add_get_ship_docs=function(){var pm=this.addMethodById('get_ship_docs');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_ship_docs=function(){var pm=this.addMethodById('print_ship_docs');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_paid=function(){var pm=this.addMethodById('set_paid');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_not_paid=function(){var pm=this.addMethodById('set_not_paid');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_paid_to_acc=function(){var pm=this.addMethodById('paid_to_acc');}
DOCOrder_Controller.prototype.add_set_paid_by_bank=function(){var pm=this.addMethodById('set_paid_by_bank');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_paid_by_bank_to_acc=function(){var pm=this.addMethodById('paid_by_bank_to_acc');}
DOCOrder_Controller.prototype.add_set_closed=function(){var pm=this.addMethodById('set_closed');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_order=function(){var pm=this.addMethodById('print_order');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_ship_exists=function(){var pm=this.addMethodById('ext_ship_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_invoice_exists=function(){var pm=this.addMethodById('ext_invoice_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_order_exists=function(){var pm=this.addMethodById('ext_order_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_torg12=function(){var pm=this.addMethodById('print_torg12');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_invoice=function(){var pm=this.addMethodById('print_invoice');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_upd=function(){var pm=this.addMethodById('print_upd');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_ttn=function(){var pm=this.addMethodById('print_ttn');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_passport=function(){var pm=this.addMethodById('print_passport');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_pay_orders_list=function(){var pm=this.addMethodById('pay_orders_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_fill_cust_surv=function(){var pm=this.addMethodById('fill_cust_surv');pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_set_cancel_cause=function(){var pm=this.addMethodById('set_cancel_cause');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldText("cause"));}
DOCOrder_Controller.prototype.add_calc_totals=function(){var pm=this.addMethodById('calc_totals');pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldInt("product_id"));pm.addParam(new FieldInt("mes_length"));pm.addParam(new FieldInt("mes_width"));pm.addParam(new FieldInt("mes_height"));pm.addParam(new FieldFloat("quant"));pm.addParam(new FieldInt("measure_unit_id"));pm.addParam(new FieldBool("pack"));pm.addParam(new FieldBool("pack_in_price"));pm.addParam(new FieldBool("deliv_to_third_party"));pm.addParam(new FieldBool("price_edit"));pm.addParam(new FieldBool("price_round"));pm.addParam(new FieldFloat("price"));}
DOCOrder_Controller.prototype.add_calc_quant=function(){var pm=this.addMethodById('calc_quant');pm.addParam(new FieldInt("product_id"));pm.addParam(new FieldInt("measure_unit_id"));pm.addParam(new FieldInt("mes_length"));pm.addParam(new FieldInt("mes_width"));pm.addParam(new FieldInt("mes_height"));pm.addParam(new FieldFloat("quant"));pm.addParam(new FieldInt("measure_unit_id_from"));}
DOCOrder_Controller.prototype.add_recalc_product_prices=function(){var pm=this.addMethodById('recalc_product_prices');pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldFloat("deliv_cost"));pm.addParam(new FieldBool("deliv_to_third_party"));pm.addParam(new FieldBool("deliv_add_cost_to_product"));}
DOCOrder_Controller.prototype.add_calc_deliv_cost=function(){var pm=this.addMethodById('calc_deliv_cost');pm.addParam(new FieldInt("cost_opt_id"));pm.addParam(new FieldInt("client_destination_id"));pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("include_route"));}
DOCOrder_Controller.prototype.add_get_pop_warehouse=function(){var pm=this.addMethodById('get_pop_warehouse');pm.addParam(new FieldInt("firm_id"));}
DOCOrder_Controller.prototype.add_get_children=function(){var pm=this.addMethodById('get_children');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_cancel_cause=function(){var pm=this.addMethodById('get_cancel_cause');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_append_list=function(){var pm=this.addMethodById('get_append_list');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_append=function(){var pm=this.addMethodById('append');pm.addParam(new FieldInt("target_doc_id"));pm.addParam(new FieldString("source_doc_id_list"));}
DOCOrder_Controller.prototype.add_add_file=function(){var pm=this.addMethodById('add_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldText("file_data"));pm.addParam(new FieldString("file_id"));}
DOCOrder_Controller.prototype.add_delete_file=function(){var pm=this.addMethodById('delete_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("file_id"));}
DOCOrder_Controller.prototype.add_get_file=function(){var pm=this.addMethodById('get_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("file_id"));pm.addParam(new FieldInt("inline"));}
DOCOrder_Controller.prototype.add_get_files_list=function(){var pm=this.addMethodById('get_files_list');pm.addParam(new FieldInt("doc_order_id"));}
DOCOrder_Controller.prototype.add_get_nonegraphic_files_list=function(){var pm=this.addMethodById('get_nonegraphic_files_list');pm.addParam(new FieldInt("doc_order_id"));} 
function DOCOrderDOCTProduct_Model(options){var id='DOCOrderDOCTProduct_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.view_id=new FieldString("view_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.login_id=new FieldInt("login_id",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Продукция';filed_options.autoInc=false;options.fields.product_id=new FieldInt("product_id",filed_options);options.fields.product_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_length=new FieldInt("mes_length",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_width=new FieldInt("mes_width",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.mes_height=new FieldInt("mes_height",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.measure_unit_id=new FieldInt("measure_unit_id",filed_options);options.fields.measure_unit_id.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant=new FieldFloat("quant",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant_confirmed=new FieldFloat("quant_confirmed",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Количество';filed_options.autoInc=false;options.fields.quant_base_measure_unit=new FieldFloat("quant_base_measure_unit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.quant_confirmed_base_measure_unit=new FieldFloat("quant_confirmed_base_measure_unit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.volume=new FieldFloat("volume",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.weight=new FieldFloat("weight",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Цена';filed_options.autoInc=false;options.fields.price=new FieldFloat("price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_edit=new FieldBool("price_edit",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.price_round=new FieldBool("price_round",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total=new FieldFloat("total",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.alias='Сумма';filed_options.autoInc=false;options.fields.total_pack=new FieldFloat("total_pack",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_exists=new FieldBool("pack_exists",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.pack_in_price=new FieldBool("pack_in_price",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.total_deliv=new FieldFloat("total_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.total_no_deliv=new FieldFloat("total_no_deliv",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.defValue=true;filed_options.autoInc=false;options.fields.price_no_deliv=new FieldFloat("price_no_deliv",filed_options);DOCOrderDOCTProduct_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTProduct_Model,Model); 
function DOCOrderDOCTProduct_Controller(servConnector){options={};options["listModelId"]="DOCOrderDOCTProductList_Model";options["objModelId"]="DOCOrderDOCTProductDialog_Model";DOCOrderDOCTProduct_Controller.superclass.constructor.call(this,"DOCOrderDOCTProduct_Controller",servConnector,options);this.addInsert();this.addUpdate();this.addDelete();this.addGetList();this.addGetObject();this.add_get_object_for_divis();}
extend(DOCOrderDOCTProduct_Controller,ControllerDb);DOCOrderDOCTProduct_Controller.prototype.addInsert=function(){DOCOrderDOCTProduct_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};var param=new FieldString("view_id",options);pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);options={};options["alias"]="Продукция";var param=new FieldInt("product_id",options);pm.addParam(param);options={};var param=new FieldInt("mes_length",options);pm.addParam(param);options={};var param=new FieldInt("mes_width",options);pm.addParam(param);options={};var param=new FieldInt("mes_height",options);pm.addParam(param);options={};var param=new FieldInt("measure_unit_id",options);pm.addParam(param);options={};options["alias"]="Количество";var param=new FieldFloat("quant",options);pm.addParam(param);options={};var param=new FieldFloat("quant_confirmed",options);pm.addParam(param);options={};options["alias"]="Количество";var param=new FieldFloat("quant_base_measure_unit",options);pm.addParam(param);options={};var param=new FieldFloat("quant_confirmed_base_measure_unit",options);pm.addParam(param);options={};var param=new FieldFloat("volume",options);pm.addParam(param);options={};var param=new FieldFloat("weight",options);pm.addParam(param);options={};options["alias"]="Цена";var param=new FieldFloat("price",options);pm.addParam(param);options={};var param=new FieldBool("price_edit",options);pm.addParam(param);options={};var param=new FieldBool("price_round",options);pm.addParam(param);options={};options["alias"]="Сумма";var param=new FieldFloat("total",options);pm.addParam(param);options={};options["alias"]="Сумма";var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldBool("pack_exists",options);pm.addParam(param);options={};var param=new FieldBool("pack_in_price",options);pm.addParam(param);options={};var param=new FieldFloat("total_deliv",options);pm.addParam(param);options={};var param=new FieldFloat("total_no_deliv",options);pm.addParam(param);options={};var param=new FieldFloat("price_no_deliv",options);pm.addParam(param);var options={};pm.addParam(new FieldInt("warehouse_id",options));var options={};pm.addParam(new FieldInt("client_id",options));var options={};pm.addParam(new FieldBool("deliv_to_third_party",options));}
DOCOrderDOCTProduct_Controller.prototype.addUpdate=function(){DOCOrderDOCTProduct_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldString("view_id",options);pm.addParam(param);param=new FieldString("old_view_id",{});pm.addParam(param);options={};var param=new FieldInt("line_number",options);pm.addParam(param);param=new FieldInt("old_line_number",{});pm.addParam(param);options={};var param=new FieldInt("login_id",options);pm.addParam(param);options={};options["alias"]="Продукция";var param=new FieldInt("product_id",options);pm.addParam(param);options={};var param=new FieldInt("mes_length",options);pm.addParam(param);options={};var param=new FieldInt("mes_width",options);pm.addParam(param);options={};var param=new FieldInt("mes_height",options);pm.addParam(param);options={};var param=new FieldInt("measure_unit_id",options);pm.addParam(param);options={};options["alias"]="Количество";var param=new FieldFloat("quant",options);pm.addParam(param);options={};var param=new FieldFloat("quant_confirmed",options);pm.addParam(param);options={};options["alias"]="Количество";var param=new FieldFloat("quant_base_measure_unit",options);pm.addParam(param);options={};var param=new FieldFloat("quant_confirmed_base_measure_unit",options);pm.addParam(param);options={};var param=new FieldFloat("volume",options);pm.addParam(param);options={};var param=new FieldFloat("weight",options);pm.addParam(param);options={};options["alias"]="Цена";var param=new FieldFloat("price",options);pm.addParam(param);options={};var param=new FieldBool("price_edit",options);pm.addParam(param);options={};var param=new FieldBool("price_round",options);pm.addParam(param);options={};options["alias"]="Сумма";var param=new FieldFloat("total",options);pm.addParam(param);options={};options["alias"]="Сумма";var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldBool("pack_exists",options);pm.addParam(param);options={};var param=new FieldBool("pack_in_price",options);pm.addParam(param);options={};var param=new FieldFloat("total_deliv",options);pm.addParam(param);options={};var param=new FieldFloat("total_no_deliv",options);pm.addParam(param);options={};var param=new FieldFloat("price_no_deliv",options);pm.addParam(param);var options={};pm.addParam(new FieldInt("warehouse_id",options));var options={};pm.addParam(new FieldInt("client_id",options));var options={};pm.addParam(new FieldBool("deliv_to_third_party",options));}
DOCOrderDOCTProduct_Controller.prototype.addDelete=function(){DOCOrderDOCTProduct_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));}
DOCOrderDOCTProduct_Controller.prototype.addGetList=function(){DOCOrderDOCTProduct_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));pm.addParam(new FieldFloat("total_no_deliv",options));pm.addParam(new FieldFloat("price_no_deliv",options));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrderDOCTProduct_Controller.prototype.addGetObject=function(){DOCOrderDOCTProduct_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldString("view_id",options));pm.addParam(new FieldInt("line_number",options));}
DOCOrderDOCTProduct_Controller.prototype.add_get_object_for_divis=function(){var pm=this.addMethodById('get_object_for_divis');pm.addParam(new FieldInt("line_number"));pm.addParam(new FieldString("view_id"));} 
function ProdBatch_Controller(servConnector){options={};ProdBatch_Controller.superclass.constructor.call(this,"ProdBatch_Controller",servConnector,options);this.addGetList();this.add_complete_from_1c();}
extend(ProdBatch_Controller,ControllerDb);ProdBatch_Controller.prototype.addGetList=function(){ProdBatch_Controller.superclass.addGetList.call(this);var options={};var pm=this.getGetList();var options={};pm.addParam(new FieldInt("doc_order_id",options));}
ProdBatch_Controller.prototype.add_complete_from_1c=function(){var pm=this.addMethodById('complete_from_1c');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("pattern"));} 
function DOCOrderDOCTFProdBatch_Model(options){var id='DOCOrderDOCTFProdBatch_Model';options=options||{};options.fields={};var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.doc_id=new FieldInt("doc_id",filed_options);var filed_options={};filed_options.primaryKey=true;filed_options.autoInc=false;options.fields.line_number=new FieldInt("line_number",filed_options);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.batch_descr=new FieldText("batch_descr",filed_options);options.fields.batch_descr.setRequired(true);var filed_options={};filed_options.primaryKey=false;filed_options.autoInc=false;options.fields.ext_id=new FieldString("ext_id",filed_options);options.fields.ext_id.setRequired(true);DOCOrderDOCTFProdBatch_Model.superclass.constructor.call(this,id,options);}
extend(DOCOrderDOCTFProdBatch_Model,Model); 
function DOCOrder_Controller(servConnector){options={};options["objModelId"]="DOCOrderDialog_Model";DOCOrder_Controller.superclass.constructor.call(this,"DOCOrder_Controller",servConnector,options);this.addInsert();this.addUpdate();this.add_divide();this.addDelete();this.add_get_new_list();this.add_get_current_list();this.add_get_current_for_representative_list();this.add_get_current_for_client_list();this.add_get_current_for_production_list();this.add_get_closed_list();this.addGetObject();this.add_get_cust_survey();this.add_get_divis();this.add_before_open();this.add_get_actions();this.add_get_print();this.add_download_print();this.add_get_print_check();this.add_set_ready();this.add_get_shipment();this.add_get_products_descr();this.add_cancel();this.add_cancel_last_state();this.add_get_history();this.add_pass_to_production();this.add_get_print_all();this.add_get_print_cnt();this.add_set_printed();this.add_set_shipped();this.add_get_ship_docs();this.add_print_ship_docs();this.add_set_paid();this.add_set_not_paid();this.add_paid_to_acc();this.add_set_paid_by_bank();this.add_paid_by_bank_to_acc();this.add_set_closed();this.add_print_order();this.add_ext_ship_exists();this.add_ext_invoice_exists();this.add_ext_order_exists();this.add_print_torg12();this.add_print_invoice();this.add_print_upd();this.add_print_ttn();this.add_print_passport();this.add_pay_orders_list();this.add_fill_cust_surv();this.add_set_cancel_cause();this.add_calc_totals();this.add_calc_quant();this.add_recalc_product_prices();this.add_calc_deliv_cost();this.add_get_pop_warehouse();this.add_get_children();this.add_get_cancel_cause();this.add_get_append_list();this.add_append();this.add_add_file();this.add_delete_file();this.add_get_file();this.add_get_files_list();this.add_get_nonegraphic_files_list();}
extend(DOCOrder_Controller,ControllerDb);DOCOrder_Controller.prototype.addInsert=function(){DOCOrder_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Дата пдч.";var param=new FieldDateTime("date_time",options);pm.addParam(param);options={};options["alias"]="Номер";var param=new FieldString("number",options);pm.addParam(param);options={};options["alias"]="Проведен";var param=new FieldBool("processed",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("gruzopoluchatel_id",options);pm.addParam(param);options={};var param=new FieldString("client_number",options);pm.addParam(param);options={};var param=new FieldDate("delivery_plan_date",options);pm.addParam(param);options={};var param=new FieldDateTime("delivery_fact_date",options);pm.addParam(param);options={};var param=new FieldDate("product_plan_date",options);pm.addParam(param);options={};var param=new FieldInt("client_user_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldText("sales_manager_comment",options);pm.addParam(param);options={};var param=new FieldText("client_comment",options);pm.addParam(param);options={};var param=new FieldText("marketing_comment",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_destination_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_type",options);options["values"]='by_supplier,by_client';pm.addParam(param);options={};var param=new FieldBool("deliv_to_third_party",options);pm.addParam(param);options={};var param=new FieldBool("deliv_send_sms",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldInt("deliv_period_id",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable_tel",options);pm.addParam(param);options={};var param=new FieldString("tel",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_count",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_total",options);pm.addParam(param);options={};var param=new FieldBool("deliv_total_edit",options);pm.addParam(param);options={};var param=new FieldFloat("total",options);pm.addParam(param);options={};var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldFloat("total_quant",options);pm.addParam(param);options={};var param=new FieldFloat("total_volume",options);pm.addParam(param);options={};var param=new FieldFloat("total_weight",options);pm.addParam(param);options={};var param=new FieldBool("printed",options);pm.addParam(param);options={};var param=new FieldString("ext_order_num",options);pm.addParam(param);options={};var param=new FieldString("ext_order_id",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_num",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_id",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_num",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_id",options);pm.addParam(param);options={};var param=new FieldDateTime("ext_invoice_date_time",options);pm.addParam(param);options={};var param=new FieldDateTime("cust_surv_date_time",options);pm.addParam(param);options={};var param=new FieldText("cust_surv_comment",options);pm.addParam(param);options={};var param=new FieldText("product_str",options);pm.addParam(param);options={};var param=new FieldInt("product_ids",options);pm.addParam(param);options={};var param=new FieldInt("submit_user_id",options);pm.addParam(param);options={};var param=new FieldBool("paid",options);pm.addParam(param);options={};var param=new FieldBool("paid_by_bank",options);pm.addParam(param);options={};var param=new FieldBool("acc_pko",options);pm.addParam(param);options={};var param=new FieldInt("city_route_distance",options);pm.addParam(param);options={};var param=new FieldInt("country_route_distance",options);pm.addParam(param);options={};var param=new FieldBool("destination_to_ttn",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_expenses",options);pm.addParam(param);options={};var param=new FieldBool("deliv_expenses_edit",options);pm.addParam(param);options={};var param=new FieldBool("deliv_pay_bank",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_ext_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_name",options);pm.addParam(param);options={};options["alias"]="Адрес магазина";var param=new FieldInt("sale_store_address_id",options);pm.addParam(param);options={};options["alias"]="Номер заказа";var param=new FieldText("order_num",options);pm.addParam(param);options={};options["alias"]="Номер партии";var param=new FieldText("batch_num",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrder_Controller.prototype.addUpdate=function(){DOCOrder_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Дата пдч.";var param=new FieldDateTime("date_time",options);pm.addParam(param);options={};options["alias"]="Номер";var param=new FieldString("number",options);pm.addParam(param);options={};options["alias"]="Проведен";var param=new FieldBool("processed",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("gruzopoluchatel_id",options);pm.addParam(param);options={};var param=new FieldString("client_number",options);pm.addParam(param);options={};var param=new FieldDate("delivery_plan_date",options);pm.addParam(param);options={};var param=new FieldDateTime("delivery_fact_date",options);pm.addParam(param);options={};var param=new FieldDate("product_plan_date",options);pm.addParam(param);options={};var param=new FieldInt("client_user_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldText("sales_manager_comment",options);pm.addParam(param);options={};var param=new FieldText("client_comment",options);pm.addParam(param);options={};var param=new FieldText("marketing_comment",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_destination_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_type",options);options["values"]='by_supplier,by_client';pm.addParam(param);options={};var param=new FieldBool("deliv_to_third_party",options);pm.addParam(param);options={};var param=new FieldBool("deliv_send_sms",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldInt("deliv_period_id",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable_tel",options);pm.addParam(param);options={};var param=new FieldString("tel",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_count",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_total",options);pm.addParam(param);options={};var param=new FieldBool("deliv_total_edit",options);pm.addParam(param);options={};var param=new FieldFloat("total",options);pm.addParam(param);options={};var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldFloat("total_quant",options);pm.addParam(param);options={};var param=new FieldFloat("total_volume",options);pm.addParam(param);options={};var param=new FieldFloat("total_weight",options);pm.addParam(param);options={};var param=new FieldBool("printed",options);pm.addParam(param);options={};var param=new FieldString("ext_order_num",options);pm.addParam(param);options={};var param=new FieldString("ext_order_id",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_num",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_id",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_num",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_id",options);pm.addParam(param);options={};var param=new FieldDateTime("ext_invoice_date_time",options);pm.addParam(param);options={};var param=new FieldDateTime("cust_surv_date_time",options);pm.addParam(param);options={};var param=new FieldText("cust_surv_comment",options);pm.addParam(param);options={};var param=new FieldText("product_str",options);pm.addParam(param);options={};var param=new FieldInt("product_ids",options);pm.addParam(param);options={};var param=new FieldInt("submit_user_id",options);pm.addParam(param);options={};var param=new FieldBool("paid",options);pm.addParam(param);options={};var param=new FieldBool("paid_by_bank",options);pm.addParam(param);options={};var param=new FieldBool("acc_pko",options);pm.addParam(param);options={};var param=new FieldInt("city_route_distance",options);pm.addParam(param);options={};var param=new FieldInt("country_route_distance",options);pm.addParam(param);options={};var param=new FieldBool("destination_to_ttn",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_expenses",options);pm.addParam(param);options={};var param=new FieldBool("deliv_expenses_edit",options);pm.addParam(param);options={};var param=new FieldBool("deliv_pay_bank",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_ext_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_name",options);pm.addParam(param);options={};options["alias"]="Адрес магазина";var param=new FieldInt("sale_store_address_id",options);pm.addParam(param);options={};options["alias"]="Номер заказа";var param=new FieldText("order_num",options);pm.addParam(param);options={};options["alias"]="Номер партии";var param=new FieldText("batch_num",options);pm.addParam(param);var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrder_Controller.prototype.add_divide=function(){var pm=this.addMethodById('divide');pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("main_doc_id"));pm.addParam(new FieldDate("delivery_plan_date"));pm.addParam(new FieldText("sales_manager_comment"));pm.addParam(new FieldInt("deliv_period_id"));pm.addParam(new FieldInt("deliv_vehicle_count"));pm.addParam(new FieldInt("deliv_cost_opt_id"));pm.addParam(new FieldFloat("deliv_total"));pm.addParam(new FieldBool("deliv_total_edit"));}
DOCOrder_Controller.prototype.addDelete=function(){DOCOrder_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
DOCOrder_Controller.prototype.add_get_new_list=function(){var pm=this.addMethodById('get_new_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_list=function(){var pm=this.addMethodById('get_current_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_representative_list=function(){var pm=this.addMethodById('get_current_for_representative_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_client_list=function(){var pm=this.addMethodById('get_current_for_client_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_production_list=function(){var pm=this.addMethodById('get_current_for_production_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_closed_list=function(){var pm=this.addMethodById('get_closed_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.addGetObject=function(){DOCOrder_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
DOCOrder_Controller.prototype.add_get_cust_survey=function(){var pm=this.addMethodById('get_cust_survey');pm.addParam(new FieldInt("id"));}
DOCOrder_Controller.prototype.add_get_divis=function(){var pm=this.addMethodById('get_divis');pm.addParam(new FieldInt("id"));pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_before_open=function(){var pm=this.addMethodById('before_open');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_get_actions=function(){var pm=this.addMethodById('get_actions');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print=function(){var pm=this.addMethodById('get_print');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_download_print=function(){var pm=this.addMethodById('download_print');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print_check=function(){var pm=this.addMethodById('get_print_check');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_set_ready=function(){var pm=this.addMethodById('set_ready');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_shipment=function(){var pm=this.addMethodById('get_shipment');pm.addParam(new FieldInt("id"));}
DOCOrder_Controller.prototype.add_get_products_descr=function(){var pm=this.addMethodById('get_products_descr');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_cancel=function(){var pm=this.addMethodById('cancel');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_cancel_last_state=function(){var pm=this.addMethodById('cancel_last_state');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_history=function(){var pm=this.addMethodById('get_history');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_pass_to_production=function(){var pm=this.addMethodById('pass_to_production');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print_all=function(){var pm=this.addMethodById('get_print_all');pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_get_print_cnt=function(){var pm=this.addMethodById('get_print_cnt');}
DOCOrder_Controller.prototype.add_set_printed=function(){var pm=this.addMethodById('set_printed');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_shipped=function(){var pm=this.addMethodById('set_shipped');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("deliv_vehicle_count"));pm.addParam(new FieldInt("driver_id"));pm.addParam(new FieldInt("vehicle_id"));pm.addParam(new FieldInt("deliv_destination_id"));pm.addParam(new FieldBool("destination_to_ttn"));pm.addParam(new FieldText("batch_num"));}
DOCOrder_Controller.prototype.add_get_ship_docs=function(){var pm=this.addMethodById('get_ship_docs');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_ship_docs=function(){var pm=this.addMethodById('print_ship_docs');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_paid=function(){var pm=this.addMethodById('set_paid');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_not_paid=function(){var pm=this.addMethodById('set_not_paid');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_paid_to_acc=function(){var pm=this.addMethodById('paid_to_acc');}
DOCOrder_Controller.prototype.add_set_paid_by_bank=function(){var pm=this.addMethodById('set_paid_by_bank');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_paid_by_bank_to_acc=function(){var pm=this.addMethodById('paid_by_bank_to_acc');}
DOCOrder_Controller.prototype.add_set_closed=function(){var pm=this.addMethodById('set_closed');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_order=function(){var pm=this.addMethodById('print_order');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_ship_exists=function(){var pm=this.addMethodById('ext_ship_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_invoice_exists=function(){var pm=this.addMethodById('ext_invoice_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_order_exists=function(){var pm=this.addMethodById('ext_order_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_torg12=function(){var pm=this.addMethodById('print_torg12');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_invoice=function(){var pm=this.addMethodById('print_invoice');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_upd=function(){var pm=this.addMethodById('print_upd');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_ttn=function(){var pm=this.addMethodById('print_ttn');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_passport=function(){var pm=this.addMethodById('print_passport');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_pay_orders_list=function(){var pm=this.addMethodById('pay_orders_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_fill_cust_surv=function(){var pm=this.addMethodById('fill_cust_surv');pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_set_cancel_cause=function(){var pm=this.addMethodById('set_cancel_cause');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldText("cause"));}
DOCOrder_Controller.prototype.add_calc_totals=function(){var pm=this.addMethodById('calc_totals');pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldInt("product_id"));pm.addParam(new FieldInt("mes_length"));pm.addParam(new FieldInt("mes_width"));pm.addParam(new FieldInt("mes_height"));pm.addParam(new FieldFloat("quant"));pm.addParam(new FieldInt("measure_unit_id"));pm.addParam(new FieldBool("pack"));pm.addParam(new FieldBool("pack_in_price"));pm.addParam(new FieldBool("deliv_to_third_party"));pm.addParam(new FieldBool("price_edit"));pm.addParam(new FieldBool("price_round"));pm.addParam(new FieldFloat("price"));}
DOCOrder_Controller.prototype.add_calc_quant=function(){var pm=this.addMethodById('calc_quant');pm.addParam(new FieldInt("product_id"));pm.addParam(new FieldInt("measure_unit_id"));pm.addParam(new FieldInt("mes_length"));pm.addParam(new FieldInt("mes_width"));pm.addParam(new FieldInt("mes_height"));pm.addParam(new FieldFloat("quant"));pm.addParam(new FieldInt("measure_unit_id_from"));}
DOCOrder_Controller.prototype.add_recalc_product_prices=function(){var pm=this.addMethodById('recalc_product_prices');pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldFloat("deliv_cost"));pm.addParam(new FieldBool("deliv_to_third_party"));pm.addParam(new FieldBool("deliv_add_cost_to_product"));}
DOCOrder_Controller.prototype.add_calc_deliv_cost=function(){var pm=this.addMethodById('calc_deliv_cost');pm.addParam(new FieldInt("cost_opt_id"));pm.addParam(new FieldInt("client_destination_id"));pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("include_route"));}
DOCOrder_Controller.prototype.add_get_pop_warehouse=function(){var pm=this.addMethodById('get_pop_warehouse');pm.addParam(new FieldInt("firm_id"));}
DOCOrder_Controller.prototype.add_get_children=function(){var pm=this.addMethodById('get_children');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_cancel_cause=function(){var pm=this.addMethodById('get_cancel_cause');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_append_list=function(){var pm=this.addMethodById('get_append_list');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_append=function(){var pm=this.addMethodById('append');pm.addParam(new FieldInt("target_doc_id"));pm.addParam(new FieldString("source_doc_id_list"));}
DOCOrder_Controller.prototype.add_add_file=function(){var pm=this.addMethodById('add_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldText("file_data"));pm.addParam(new FieldString("file_id"));}
DOCOrder_Controller.prototype.add_delete_file=function(){var pm=this.addMethodById('delete_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("file_id"));}
DOCOrder_Controller.prototype.add_get_file=function(){var pm=this.addMethodById('get_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("file_id"));pm.addParam(new FieldInt("inline"));}
DOCOrder_Controller.prototype.add_get_files_list=function(){var pm=this.addMethodById('get_files_list');pm.addParam(new FieldInt("doc_order_id"));}
DOCOrder_Controller.prototype.add_get_nonegraphic_files_list=function(){var pm=this.addMethodById('get_nonegraphic_files_list');pm.addParam(new FieldInt("doc_order_id"));} 
function DOCOrder_Controller(servConnector){options={};options["objModelId"]="DOCOrderDialog_Model";DOCOrder_Controller.superclass.constructor.call(this,"DOCOrder_Controller",servConnector,options);this.addInsert();this.addUpdate();this.add_divide();this.addDelete();this.add_get_new_list();this.add_get_current_list();this.add_get_current_for_representative_list();this.add_get_current_for_client_list();this.add_get_current_for_production_list();this.add_get_closed_list();this.addGetObject();this.add_get_cust_survey();this.add_get_divis();this.add_before_open();this.add_get_actions();this.add_get_print();this.add_download_print();this.add_get_print_check();this.add_set_ready();this.add_get_shipment();this.add_get_products_descr();this.add_cancel();this.add_cancel_last_state();this.add_get_history();this.add_pass_to_production();this.add_get_print_all();this.add_get_print_cnt();this.add_set_printed();this.add_set_shipped();this.add_get_ship_docs();this.add_print_ship_docs();this.add_set_paid();this.add_set_not_paid();this.add_paid_to_acc();this.add_set_paid_by_bank();this.add_paid_by_bank_to_acc();this.add_set_closed();this.add_print_order();this.add_ext_ship_exists();this.add_ext_invoice_exists();this.add_ext_order_exists();this.add_print_torg12();this.add_print_invoice();this.add_print_upd();this.add_print_ttn();this.add_print_passport();this.add_pay_orders_list();this.add_fill_cust_surv();this.add_set_cancel_cause();this.add_calc_totals();this.add_calc_quant();this.add_recalc_product_prices();this.add_calc_deliv_cost();this.add_get_pop_warehouse();this.add_get_children();this.add_get_cancel_cause();this.add_get_append_list();this.add_append();this.add_add_file();this.add_delete_file();this.add_get_file();this.add_get_files_list();this.add_get_nonegraphic_files_list();}
extend(DOCOrder_Controller,ControllerDb);DOCOrder_Controller.prototype.addInsert=function(){DOCOrder_Controller.superclass.addInsert.call(this);var param;var options;var pm=this.getInsert();options={};options["alias"]="Дата пдч.";var param=new FieldDateTime("date_time",options);pm.addParam(param);options={};options["alias"]="Номер";var param=new FieldString("number",options);pm.addParam(param);options={};options["alias"]="Проведен";var param=new FieldBool("processed",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("gruzopoluchatel_id",options);pm.addParam(param);options={};var param=new FieldString("client_number",options);pm.addParam(param);options={};var param=new FieldDate("delivery_plan_date",options);pm.addParam(param);options={};var param=new FieldDateTime("delivery_fact_date",options);pm.addParam(param);options={};var param=new FieldDate("product_plan_date",options);pm.addParam(param);options={};var param=new FieldInt("client_user_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldText("sales_manager_comment",options);pm.addParam(param);options={};var param=new FieldText("client_comment",options);pm.addParam(param);options={};var param=new FieldText("marketing_comment",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_destination_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_type",options);options["values"]='by_supplier,by_client';pm.addParam(param);options={};var param=new FieldBool("deliv_to_third_party",options);pm.addParam(param);options={};var param=new FieldBool("deliv_send_sms",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldInt("deliv_period_id",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable_tel",options);pm.addParam(param);options={};var param=new FieldString("tel",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_count",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_total",options);pm.addParam(param);options={};var param=new FieldBool("deliv_total_edit",options);pm.addParam(param);options={};var param=new FieldFloat("total",options);pm.addParam(param);options={};var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldFloat("total_quant",options);pm.addParam(param);options={};var param=new FieldFloat("total_volume",options);pm.addParam(param);options={};var param=new FieldFloat("total_weight",options);pm.addParam(param);options={};var param=new FieldBool("printed",options);pm.addParam(param);options={};var param=new FieldString("ext_order_num",options);pm.addParam(param);options={};var param=new FieldString("ext_order_id",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_num",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_id",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_num",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_id",options);pm.addParam(param);options={};var param=new FieldDateTime("ext_invoice_date_time",options);pm.addParam(param);options={};var param=new FieldDateTime("cust_surv_date_time",options);pm.addParam(param);options={};var param=new FieldText("cust_surv_comment",options);pm.addParam(param);options={};var param=new FieldText("product_str",options);pm.addParam(param);options={};var param=new FieldInt("product_ids",options);pm.addParam(param);options={};var param=new FieldInt("submit_user_id",options);pm.addParam(param);options={};var param=new FieldBool("paid",options);pm.addParam(param);options={};var param=new FieldBool("paid_by_bank",options);pm.addParam(param);options={};var param=new FieldBool("acc_pko",options);pm.addParam(param);options={};var param=new FieldInt("city_route_distance",options);pm.addParam(param);options={};var param=new FieldInt("country_route_distance",options);pm.addParam(param);options={};var param=new FieldBool("destination_to_ttn",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_expenses",options);pm.addParam(param);options={};var param=new FieldBool("deliv_expenses_edit",options);pm.addParam(param);options={};var param=new FieldBool("deliv_pay_bank",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_ext_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_name",options);pm.addParam(param);options={};options["alias"]="Адрес магазина";var param=new FieldInt("sale_store_address_id",options);pm.addParam(param);options={};options["alias"]="Номер заказа";var param=new FieldText("order_num",options);pm.addParam(param);options={};options["alias"]="Номер партии";var param=new FieldText("batch_num",options);pm.addParam(param);pm.addParam(new FieldInt("ret_id",{}));var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrder_Controller.prototype.addUpdate=function(){DOCOrder_Controller.superclass.addUpdate.call(this);var param;var options;var pm=this.getUpdate();options={};var param=new FieldInt("id",options);pm.addParam(param);param=new FieldInt("old_id",{});pm.addParam(param);options={};options["alias"]="Дата пдч.";var param=new FieldDateTime("date_time",options);pm.addParam(param);options={};options["alias"]="Номер";var param=new FieldString("number",options);pm.addParam(param);options={};options["alias"]="Проведен";var param=new FieldBool("processed",options);pm.addParam(param);options={};var param=new FieldInt("client_id",options);pm.addParam(param);options={};var param=new FieldInt("gruzopoluchatel_id",options);pm.addParam(param);options={};var param=new FieldString("client_number",options);pm.addParam(param);options={};var param=new FieldDate("delivery_plan_date",options);pm.addParam(param);options={};var param=new FieldDateTime("delivery_fact_date",options);pm.addParam(param);options={};var param=new FieldDate("product_plan_date",options);pm.addParam(param);options={};var param=new FieldInt("client_user_id",options);pm.addParam(param);options={};var param=new FieldInt("firm_id",options);pm.addParam(param);options={};var param=new FieldInt("user_id",options);pm.addParam(param);options={};var param=new FieldText("sales_manager_comment",options);pm.addParam(param);options={};var param=new FieldText("client_comment",options);pm.addParam(param);options={};var param=new FieldText("marketing_comment",options);pm.addParam(param);options={};var param=new FieldInt("warehouse_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_destination_id",options);pm.addParam(param);options={};param=new FieldEnum("deliv_type",options);options["values"]='by_supplier,by_client';pm.addParam(param);options={};var param=new FieldBool("deliv_to_third_party",options);pm.addParam(param);options={};var param=new FieldBool("deliv_send_sms",options);pm.addParam(param);options={};var param=new FieldBool("deliv_add_cost_to_product",options);pm.addParam(param);options={};var param=new FieldInt("deliv_period_id",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable",options);pm.addParam(param);options={};var param=new FieldString("deliv_responsable_tel",options);pm.addParam(param);options={};var param=new FieldString("tel",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_cost_opt_id",options);pm.addParam(param);options={};var param=new FieldInt("deliv_vehicle_count",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_total",options);pm.addParam(param);options={};var param=new FieldBool("deliv_total_edit",options);pm.addParam(param);options={};var param=new FieldFloat("total",options);pm.addParam(param);options={};var param=new FieldFloat("total_pack",options);pm.addParam(param);options={};var param=new FieldFloat("total_quant",options);pm.addParam(param);options={};var param=new FieldFloat("total_volume",options);pm.addParam(param);options={};var param=new FieldFloat("total_weight",options);pm.addParam(param);options={};var param=new FieldBool("printed",options);pm.addParam(param);options={};var param=new FieldString("ext_order_num",options);pm.addParam(param);options={};var param=new FieldString("ext_order_id",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_num",options);pm.addParam(param);options={};var param=new FieldString("ext_ship_id",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_num",options);pm.addParam(param);options={};var param=new FieldString("ext_invoice_id",options);pm.addParam(param);options={};var param=new FieldDateTime("ext_invoice_date_time",options);pm.addParam(param);options={};var param=new FieldDateTime("cust_surv_date_time",options);pm.addParam(param);options={};var param=new FieldText("cust_surv_comment",options);pm.addParam(param);options={};var param=new FieldText("product_str",options);pm.addParam(param);options={};var param=new FieldInt("product_ids",options);pm.addParam(param);options={};var param=new FieldInt("submit_user_id",options);pm.addParam(param);options={};var param=new FieldBool("paid",options);pm.addParam(param);options={};var param=new FieldBool("paid_by_bank",options);pm.addParam(param);options={};var param=new FieldBool("acc_pko",options);pm.addParam(param);options={};var param=new FieldInt("city_route_distance",options);pm.addParam(param);options={};var param=new FieldInt("country_route_distance",options);pm.addParam(param);options={};var param=new FieldBool("destination_to_ttn",options);pm.addParam(param);options={};var param=new FieldFloat("deliv_expenses",options);pm.addParam(param);options={};var param=new FieldBool("deliv_expenses_edit",options);pm.addParam(param);options={};var param=new FieldBool("deliv_pay_bank",options);pm.addParam(param);options={};var param=new FieldInt("driver_id",options);pm.addParam(param);options={};var param=new FieldInt("vehicle_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_ext_id",options);pm.addParam(param);options={};var param=new FieldString("client_contract_name",options);pm.addParam(param);options={};options["alias"]="Адрес магазина";var param=new FieldInt("sale_store_address_id",options);pm.addParam(param);options={};options["alias"]="Номер заказа";var param=new FieldText("order_num",options);pm.addParam(param);options={};options["alias"]="Номер партии";var param=new FieldText("batch_num",options);pm.addParam(param);var options={};options["required"]=true;pm.addParam(new FieldString("view_id",options));}
DOCOrder_Controller.prototype.add_divide=function(){var pm=this.addMethodById('divide');pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("main_doc_id"));pm.addParam(new FieldDate("delivery_plan_date"));pm.addParam(new FieldText("sales_manager_comment"));pm.addParam(new FieldInt("deliv_period_id"));pm.addParam(new FieldInt("deliv_vehicle_count"));pm.addParam(new FieldInt("deliv_cost_opt_id"));pm.addParam(new FieldFloat("deliv_total"));pm.addParam(new FieldBool("deliv_total_edit"));}
DOCOrder_Controller.prototype.addDelete=function(){DOCOrder_Controller.superclass.addDelete.call(this);var options={"required":true};var pm=this.getDelete();pm.addParam(new FieldInt("id",options));}
DOCOrder_Controller.prototype.add_get_new_list=function(){var pm=this.addMethodById('get_new_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_list=function(){var pm=this.addMethodById('get_current_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_representative_list=function(){var pm=this.addMethodById('get_current_for_representative_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_client_list=function(){var pm=this.addMethodById('get_current_for_client_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_current_for_production_list=function(){var pm=this.addMethodById('get_current_for_production_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_get_closed_list=function(){var pm=this.addMethodById('get_closed_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.addGetObject=function(){DOCOrder_Controller.superclass.addGetObject.call(this);var options={};var pm=this.getGetObject();pm.addParam(new FieldInt("id",options));}
DOCOrder_Controller.prototype.add_get_cust_survey=function(){var pm=this.addMethodById('get_cust_survey');pm.addParam(new FieldInt("id"));}
DOCOrder_Controller.prototype.add_get_divis=function(){var pm=this.addMethodById('get_divis');pm.addParam(new FieldInt("id"));pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_before_open=function(){var pm=this.addMethodById('before_open');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_get_actions=function(){var pm=this.addMethodById('get_actions');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print=function(){var pm=this.addMethodById('get_print');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_download_print=function(){var pm=this.addMethodById('download_print');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print_check=function(){var pm=this.addMethodById('get_print_check');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_set_ready=function(){var pm=this.addMethodById('set_ready');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_shipment=function(){var pm=this.addMethodById('get_shipment');pm.addParam(new FieldInt("id"));}
DOCOrder_Controller.prototype.add_get_products_descr=function(){var pm=this.addMethodById('get_products_descr');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_cancel=function(){var pm=this.addMethodById('cancel');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_cancel_last_state=function(){var pm=this.addMethodById('cancel_last_state');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_history=function(){var pm=this.addMethodById('get_history');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_pass_to_production=function(){var pm=this.addMethodById('pass_to_production');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_print_all=function(){var pm=this.addMethodById('get_print_all');pm.addParam(new FieldString("templ"));}
DOCOrder_Controller.prototype.add_get_print_cnt=function(){var pm=this.addMethodById('get_print_cnt');}
DOCOrder_Controller.prototype.add_set_printed=function(){var pm=this.addMethodById('set_printed');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_shipped=function(){var pm=this.addMethodById('set_shipped');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("deliv_vehicle_count"));pm.addParam(new FieldInt("driver_id"));pm.addParam(new FieldInt("vehicle_id"));pm.addParam(new FieldInt("deliv_destination_id"));pm.addParam(new FieldBool("destination_to_ttn"));pm.addParam(new FieldText("batch_num"));}
DOCOrder_Controller.prototype.add_get_ship_docs=function(){var pm=this.addMethodById('get_ship_docs');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_ship_docs=function(){var pm=this.addMethodById('print_ship_docs');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_paid=function(){var pm=this.addMethodById('set_paid');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_set_not_paid=function(){var pm=this.addMethodById('set_not_paid');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_paid_to_acc=function(){var pm=this.addMethodById('paid_to_acc');}
DOCOrder_Controller.prototype.add_set_paid_by_bank=function(){var pm=this.addMethodById('set_paid_by_bank');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_paid_by_bank_to_acc=function(){var pm=this.addMethodById('paid_by_bank_to_acc');}
DOCOrder_Controller.prototype.add_set_closed=function(){var pm=this.addMethodById('set_closed');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_order=function(){var pm=this.addMethodById('print_order');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_ship_exists=function(){var pm=this.addMethodById('ext_ship_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_invoice_exists=function(){var pm=this.addMethodById('ext_invoice_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_ext_order_exists=function(){var pm=this.addMethodById('ext_order_exists');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_torg12=function(){var pm=this.addMethodById('print_torg12');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_invoice=function(){var pm=this.addMethodById('print_invoice');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_upd=function(){var pm=this.addMethodById('print_upd');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_ttn=function(){var pm=this.addMethodById('print_ttn');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_print_passport=function(){var pm=this.addMethodById('print_passport');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_pay_orders_list=function(){var pm=this.addMethodById('pay_orders_list');pm.addParam(new FieldString("cond_fields"));pm.addParam(new FieldString("cond_vals"));pm.addParam(new FieldString("cond_sgns"));pm.addParam(new FieldString("cond_ic"));pm.addParam(new FieldInt("from"));pm.addParam(new FieldInt("count"));pm.addParam(new FieldString("ord_fields"));pm.addParam(new FieldString("ord_directs"));pm.addParam(new FieldString("field_sep"));}
DOCOrder_Controller.prototype.add_fill_cust_surv=function(){var pm=this.addMethodById('fill_cust_surv');pm.addParam(new FieldString("view_id"));}
DOCOrder_Controller.prototype.add_set_cancel_cause=function(){var pm=this.addMethodById('set_cancel_cause');pm.addParam(new FieldInt("doc_id"));pm.addParam(new FieldText("cause"));}
DOCOrder_Controller.prototype.add_calc_totals=function(){var pm=this.addMethodById('calc_totals');pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldInt("product_id"));pm.addParam(new FieldInt("mes_length"));pm.addParam(new FieldInt("mes_width"));pm.addParam(new FieldInt("mes_height"));pm.addParam(new FieldFloat("quant"));pm.addParam(new FieldInt("measure_unit_id"));pm.addParam(new FieldBool("pack"));pm.addParam(new FieldBool("pack_in_price"));pm.addParam(new FieldBool("deliv_to_third_party"));pm.addParam(new FieldBool("price_edit"));pm.addParam(new FieldBool("price_round"));pm.addParam(new FieldFloat("price"));}
DOCOrder_Controller.prototype.add_calc_quant=function(){var pm=this.addMethodById('calc_quant');pm.addParam(new FieldInt("product_id"));pm.addParam(new FieldInt("measure_unit_id"));pm.addParam(new FieldInt("mes_length"));pm.addParam(new FieldInt("mes_width"));pm.addParam(new FieldInt("mes_height"));pm.addParam(new FieldFloat("quant"));pm.addParam(new FieldInt("measure_unit_id_from"));}
DOCOrder_Controller.prototype.add_recalc_product_prices=function(){var pm=this.addMethodById('recalc_product_prices');pm.addParam(new FieldString("view_id"));pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("client_id"));pm.addParam(new FieldFloat("deliv_cost"));pm.addParam(new FieldBool("deliv_to_third_party"));pm.addParam(new FieldBool("deliv_add_cost_to_product"));}
DOCOrder_Controller.prototype.add_calc_deliv_cost=function(){var pm=this.addMethodById('calc_deliv_cost');pm.addParam(new FieldInt("cost_opt_id"));pm.addParam(new FieldInt("client_destination_id"));pm.addParam(new FieldInt("warehouse_id"));pm.addParam(new FieldInt("include_route"));}
DOCOrder_Controller.prototype.add_get_pop_warehouse=function(){var pm=this.addMethodById('get_pop_warehouse');pm.addParam(new FieldInt("firm_id"));}
DOCOrder_Controller.prototype.add_get_children=function(){var pm=this.addMethodById('get_children');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_cancel_cause=function(){var pm=this.addMethodById('get_cancel_cause');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_get_append_list=function(){var pm=this.addMethodById('get_append_list');pm.addParam(new FieldInt("doc_id"));}
DOCOrder_Controller.prototype.add_append=function(){var pm=this.addMethodById('append');pm.addParam(new FieldInt("target_doc_id"));pm.addParam(new FieldString("source_doc_id_list"));}
DOCOrder_Controller.prototype.add_add_file=function(){var pm=this.addMethodById('add_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldText("file_data"));pm.addParam(new FieldString("file_id"));}
DOCOrder_Controller.prototype.add_delete_file=function(){var pm=this.addMethodById('delete_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("file_id"));}
DOCOrder_Controller.prototype.add_get_file=function(){var pm=this.addMethodById('get_file');pm.addParam(new FieldInt("doc_order_id"));pm.addParam(new FieldString("file_id"));pm.addParam(new FieldInt("inline"));}
DOCOrder_Controller.prototype.add_get_files_list=function(){var pm=this.addMethodById('get_files_list');pm.addParam(new FieldInt("doc_order_id"));}
DOCOrder_Controller.prototype.add_get_nonegraphic_files_list=function(){var pm=this.addMethodById('get_nonegraphic_files_list');pm.addParam(new FieldInt("doc_order_id"));}